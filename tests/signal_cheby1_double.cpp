/*
 * Copyright (c) Marcus Holland-Moritz
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 */

#include <array>
#include <vector>

#include "embedded/signal/butterworth.h"
#include "embedded/signal/chebyshev.h"
#include "embedded/signal/filter.h"

#include <gtest/gtest.h>
#include <gmock/gmock.h>

using namespace embedded::signal;

namespace {

template <typename F1, typename F2>
constexpr bool almost_equal(F1 a, F2 b) noexcept {
  return (a < b ? b - a : a - b) / (b < 0 ? -b : b) < 1e-13;
}

template <typename T>
std::vector<typename T::value_type> impulse_response(T& filter, size_t len) {
    typename T::value_type x{1};
    std::vector<typename T::value_type> y;
    y.resize(len);
    for (size_t i = 0; i < len; ++i) {
        y[i] = filter(x);
        x = 0;
    }
    return y;
}

}

TEST(signal_generated, cheby1_lowpass_1_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<1>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.2655982920737682), "design.b()[0] == 0.2655982920737682");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.2655982920737682));
    static_assert(almost_equal(design.b()[1], 0.2655982920737682), "design.b()[1] == 0.2655982920737682");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.2655982920737682));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.46880341585246366), "design.a()[1] == -0.46880341585246366");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.46880341585246366));
    std::cout << "max_deviation(cheby1,lowpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.2655982920737682, 0.3901116786425311, 0.18288568751155718, 0.08573743501594426,
      0.040194002401903295, 0.018843085622794395, 0.00883370290516646, 0.004141270096567868,
      0.0019414415672386787, 0.0009101544383994531, 0.0004266835096749443,
      0.0002000306868235316, 9.377506925818601e-05, 4.3962072790038954e-05,
      2.060956989192491e-05, 9.661836764584488e-06, 4.529502078646124e-06,
      2.1234460465801373e-06, 9.95478760015178e-07, 4.666838431036904e-07,
      2.1878297977016527e-07, 1.0256620824663394e-07, 4.808338877705712e-08,
      2.2541656904446393e-08, 1.0567605755778742e-08, 4.95412967569123e-09,
      2.3225129145401065e-09, 1.0888019876978629e-09, 5.104340910197102e-10,
      2.392932454375875e-10, 1.1218149085156298e-10, 5.259106610663462e-11,
      2.4654871434113036e-11, 1.1558287945715522e-11, 5.4185648703577916e-12,
      2.5402417202418946e-12, 1.1908739955403386e-12, 5.582857969591823e-13,
      2.617262886363796e-13, 1.226981781311226e-13, 5.752132502674433e-14,
      2.6966193656897547e-14, 1.2641843698892608e-14, 5.926539508713799e-15,
      2.7783819658696107e-15, 1.3025149561425566e-15, 6.106234606385525e-16,
      2.862623641470058e-16, 1.3420077414211815e-16, 6.291378132786997e-17,
      2.9494195590700385e-17, 1.3826979640741014e-17, 6.482135286501858e-18,
      3.038847164329859e-18, 1.4246219308914109e-18, 6.678676275002258e-19,
      3.1309862510938665e-19, 1.467817049499904e-19, 6.881176466520397e-20,
      3.225919032588348e-20, 1.5123218617408925e-20, 7.089816546524877e-21,
      3.3237302147781795e-21, 1.5581760780600533e-21, 7.30478267894148e-22,
      3.4245070719476764e-22, 1.6054206129399893e-22, 7.526266672262229e-23,
      3.5283395245730877e-23, 1.6540976214071213e-23, 7.754466150690936e-24,
      3.6353202195562164e-24, 1.7042505366454825e-24, 7.989584730477965e-25,
      3.745544612890755e-25, 1.7559241087509795e-25, 8.23183220160152e-26,
      3.859111054835099e-26, 1.8091644446606987e-26, 8.48142471495761e-27,
      3.9761208776676354e-27, 1.864019049292883e-27, 8.738584975225655e-28,
      4.096678486102804e-28, 1.9205368679342938e-28, 9.003542439581889e-29,
      4.2208914504486135e-29, 1.97876832991277e-29, 9.276533522437812e-30,
      4.348870602588733e-30, 2.0387653935939603e-30, 9.55780180638641e-31,
      4.480730134874796e-31, 2.1005815927423746e-31, 9.847598259544339e-32,
      4.616587702017162e-32, 2.1642720842881213e-32, 1.0146181459484024e-32,
      4.756564526065046e-33, 2.2298936975419485e-33, 1.0453817823955459e-33,
      4.900785504569688e-34, 2.2975049849025093e-34, 1.0770781848603594e-34,
      5.049379322027077e-35, 2.367166274101091e-35, 1.1097356351893408e-35,
      5.2024785646996645e-36, 2.438939722030425e-36, 1.1433832727461215e-36,
      5.360219838919509e-37, 2.512889370205608e-37, 1.1780511204117353e-37,
      5.522743892978435e-38, 2.589081201906623e-38, 1.213770111373227e-38,
      5.69019574271394e-39, 2.6675832010534415e-39, 1.2505721167245027e-39,
      5.8627248009029275e-40, 2.7484654128662473e-40, 1.2884899739040486e-40,
      6.040485010578697e-41, 2.8318000063648983e-41, 1.3275575159948925e-41,
      6.223634982390173e-42, 2.9176613387634006e-42, 1.3678096019129544e-42,
      6.412338136125915e-43, 3.006126021816849e-43, 1.4092821475107166e-43,
      6.606762846529195e-44, 3.097272990180033e-44, 1.4520121576239736e-44,
      6.807082593534247e-45, 3.191183571838702e-45, 1.4960377590902495e-45,
      7.01347611705774e-46, 3.287941560676342e-46, 1.5413982347683495e-46,
      7.226127576483599e-47, 3.387633291241196e-47, 1.5881340585893965e-47,
      7.445226714983458e-48, 3.490347715780262e-48, 1.636286931670631e-48,
      7.670969028819386e-49, 3.596176483608984e-49, 1.685899819524193e-49,
      7.903555941779937e-50, 3.70521402288747e-50, 1.7370169903940942e-50,
      8.143194984905175e-51, 3.817557624876197e-51, 1.7896840547555792e-51,
      8.390099981661031e-52, 3.933307530746384e-52, 1.843948006012124e-52,
      8.64449123872823e-53, 4.052567021022489e-53, 1.8998572624263857e-53,
      8.906595742576001e-54, 4.175442507736639e-54, 1.9574617103225134e-54,
      9.176647361996e-55, 4.302043629377225e-55, 2.016812748598373e-55,
      9.454887056777133e-56, 4.432483348716367e-56, 2.0779633345873994e-56,
      9.741563092707486e-57, 4.5668780536035595e-57, 2.1409680313109992e-57,
      1.0036931263095208e-57, 4.705347660815416e-58, 2.2058830561636666e-58,
      1.0341255117005988e-58, 4.848015723054176e-59, 2.2727663310742493e-59,
      1.0654806194420793e-59, 4.995009539190457e-60, 2.3416775341881267e-60,
      1.097786426852368e-60, 5.146460267848609e-61, 2.412678153116413e-61,
      1.1310717595335878e-61, 5.302503044436023e-62, 2.4858315397996954e-62,
      1.1653663170918866e-62, 5.463277101720817e-63, 2.5612029670352663e-63,
      1.2007006996375977e-63, 5.6289258940654875e-64, 2.6388596867182837e-64,
      1.2371064350888935e-64, 5.799597225427373e-65, 2.718870989848823e-65,
      1.2746160073032973e-65, 5.975443381240146e-66, 2.8013082683583757e-66,
      1.3132628850621565e-66, 6.156621264294003e-67, 2.886245078810942e-67,
      1.3530815519339328e-67, 6.343292534735804e-68, 2.9737572080355774e-68,
      1.394107537042964e-68, 6.535623754314065e-69, 3.0639227407489364e-69,
      1.4363774467711438e-69, 6.733786534997525e-70, 3.156822129228165e-70,
      1.4799289974208113e-70, 6.937957692099882e-71, 3.2525382650962998e-71,
      1.5248010488679914e-71, 7.148319402047337e-72, 3.351156553284232e-72,
      1.5710336392360167e-72, 7.365059364929718e-73, 3.452764988235228e-73,
      1.6186680206204664e-73, 7.588370971980207e-74, 3.557454232420001e-74,
      1.6677466958973005e-74, 7.818453478133144e-75, 3.6653176972323935e-75,
      1.7183134566470323e-75, 8.055512179813829e-76, 3.776451626337849e-76,
      1.7704134222287752e-76, 8.299758598118998e-77, 3.890955181549041e-77,
      1.8240930800390334e-77, 8.551410667551403e-78, 4.008930531305294e-78,
      1.8794003269911538e-78, 8.810692930476901e-79, 4.130482941834724e-79,
      1.9363845122524515e-79, 9.077836737477561e-80, 4.255720871080465e-80,
      1.995096481277144e-80, 9.353080453779559e-81, 4.384756065474768e-81,
      2.05558862117438e-81, 9.636669671940053e-82, 4.517703659647337e-82,
      2.1179149074518476e-82, 9.928857430982806e-83, 4.654682279156856e-83,
      2.182130952176665e-83, 1.0229904442178095e-83, 4.795814146337383e-84,
      2.2482940535965322e-84, 1.0540079321668364e-84, 4.941225189354047e-85,
      2.3164632472654138e-85, 1.085965883014716e-85, 5.091045154565358e-86,
      2.3866993587193737e-86, 1.1188928119805269e-86, 5.2454077222923935e-87,
      2.459065057749565e-87, 1.152818098876432e-87, 5.404450626098145e-88,
      2.5336249143207965e-88, 1.187772014322495e-88, 5.568315775683471e-89,
      2.610445456185572e-89, 1.2237857467563388e-89, 5.737149383509297e-90,
      2.6895952282450144e-90, 1.2608914302617494e-90, 5.911102095258065e-91,
      2.7711448537096363e-91, 1.2991221732410532e-91, 6.090329124250818e-92,
      2.855167097114527e-92, 1.3385120879568531e-92, 6.27499038993986e-93,
      2.9417369292451893e-93, 1.379096320969482e-93, 6.465250660600587e-94,
      3.030931594031953e-94, 1.420911084497332e-94, 6.661279700349779e-95,
      3.122830677472652e-95, 1.4639936887280424e-95, 6.863252420621547e-96,
      3.217516178645071e-96, 1.508382575109375e-96, 7.071349036236103e-97,
      3.315072582872512e-97, 1.554117350649483e-97, 7.285755226200586e-98,
      3.415586937107774e-98, 1.6012388232571783e-98, 7.506662299385446e-99,
      3.5191489276028065e-99, 1.64978903815373e-99, 7.734267365224192e-100,
      3.625850959933335e-100, 1.6998113153886818e-100, 7.968773509588835e-101,
      3.735788241449871e-101, 1.7513502884931676e-101, 8.210389975997946e-102,
      3.849058866228664e-102, 1.804451944305209e-102, 8.459332352319015e-103,
      3.965763902598411e-103, 1.859163664002532e-103, 8.71582276313169e-104,
      4.086007483320795e-104, 1.915534265379517e-104, 8.980090067923571e-105,
      4.209896898505353e-105, 1.973614046406002e-105, 9.252370065295365e-106,
      4.3375426913415495e-106, 2.033454830106807e-106, 9.532905703357622e-107,
      4.469058756733486e-107, 2.0951100108020225e-107, 9.821947296506802e-108,
      4.604562442925259e-108, 2.158634601749326e-108, 1.0119752748774066e-108,
      4.74417465620764e-109, 2.2240852842308293e-109, 1.0426587783946103e-109,
      4.8880199687995026e-110, 2.2915204581282596e-110, 1.0742726182663305e-110,
      5.0362267300002546e-111, 2.3610002940316025e-111, 1.1068450026706863e-111,
      5.18892718071247e-112, 2.4325867869276997e-112, 1.1404049950692747e-112,
      5.346257571436879e-113, 2.5063438115167057e-113, 1.174982540139715e-113,
      5.5083582838450286e-114, 2.5823371792057638e-114, 1.2106084904944777e-114,
      5.675373956038059e-115, 2.6606346968307522e-115, 1.2473146342098407e-115,
      5.847453611603395e-116, 2.7413062271584974e-116, 1.2851337231895333e-116,
      6.024750792584477e-117, 2.8244237512234403e-117, 1.3240995023883778e-117,
      6.207423696482188e-118, 2.9100614325543763e-118, 1.3642467399220055e-118,
      6.395635317410237e-119, 2.998295683348575e-119, 1.4056112580895088e-119,
      6.589553591530406e-120, 3.0892052326523245e-120, 1.4482299653367144e-120,
      6.789351546897468e-121, 3.182871196608741e-121, 1.4921408891885961e-121,
      6.995207457847463e-122, 3.2793771508355197e-122, 1.5373832101802117e-122,
      7.207305004067093e-123, 3.378809204997208e-123, 1.5839972968164383e-123,
      7.42583343448615e-124, 3.481256079638539e-124, 1.6320247415917033e-124,
      7.650987736139248e-125, 3.5868091853473876e-125, 1.6815083981018476e-125,
      7.882968808147505e-126, 3.6955627043179746e-126, 1.7324924192812347e-126,
      8.121983640975415e-127, 3.807613674387104e-127, 1.7850222967992248e-127,
      8.368245501122868e-128, 3.923062075618412e-128, 1.8391449016511677e-128,
      8.621974121417107e-129, 4.0420109195118844e-129, 1.894908525980129e-129,
      8.883395897074412e-130, 4.164566340918245e-130, 1.952362926166669e-130,
      9.152744087706457e-131, 4.290837692740228e-131, 2.0115593672251226e-131,
      9.430259025451578e-132, 4.4209376435052247e-132, 2.0725506685459906e-132,
      9.716188329416676e-133, 4.55498227789638e-133, 2.135391251025259e-133,
      1.001078712662107e-133, 4.693091200331827e-134, 2.2001371856226993e-134,
      1.0314318279639473e-134, 4.8353876416844917e-135, 2.2668462433924783e-135,
      1.062705262114719e-135, 4.9819985692376805e-136, 2.335577947030711e-136,
      1.0949269195576818e-136, 5.133054799974569e-137, 2.4063936239859624e-137,
      1.1281255508102083e-137, 5.288691117302677e-138, 2.4793564611800776e-138,
      1.1623307781170967e-138, 5.4490463913174695e-139, 2.55453156138817e-139,
      1.1975731218817015e-139, 5.614263702712404e-140, 2.631986001328076e-140,
      1.2338840278984688e-140, 5.784490470445987e-141, 2.7117888915111036e-141,
      1.2712958954111714e-141, 5.959878583279735e-142, 2.7940114379074816e-142,
      1.309842106021881e-142, 6.140584535304427e-143, 2.8787270054815285e-143,
      1.3495570534764745e-143, 6.326769565575572e-144, 2.966011183653236e-144,
      1.3904761743532458e-144, 6.518599801982674e-145, 3.0559418537446708e-145,
      1.4326359796820115e-145, 6.716246409480677e-146, 3.1485992584713857e-146,
      1.4760740875219197e-146, 6.919885742815843e-147, 3.2440660735408303e-147,
      1.5208292565270308e-147, 7.129699503882347e-148, 3.34242748142166e-148,
      1.566941420529621e-148, 7.34587490384998e-149, 3.4437712473497585e-149,
      1.6144517241720663e-149, 7.568604830207642e-150, 3.5481877976387984e-150,
      1.663402559619099e-150, 7.798088018871648e-151, 3.6557703003651995e-151,
      1.7138376043831927e-151, 8.034529231512439e-152, 3.7666147484995014e-152,
      1.7658018602968346e-152, 8.278139438257908e-153, 3.880820045558302e-153,
      1.8193416936664456e-153, 8.529136005936362e-154, 3.998488093853205e-154,
      1.8745048766437888e-154, 8.787742892027093e-155, 4.1197238854155085e-155,
      1.931340629851774e-155, 9.054190844491604e-156, 4.2446355956777663e-156,
      1.9898996663026937e-156, 9.328717607663804e-157, 4.373334679995814e-157,
      2.0502342366480786e-157, 9.611568134382875e-158, 4.5059359730973835e-158,
      2.112398175800548e-158, 9.9029948045581e-159, 4.642557791546037e-159,
      2.1764469509692523e-159, 1.020325765036065e-159, 4.783322039311855e-160,
      2.24243771115177e-160, 1.05126245882433e-160, 4.9283543165430584e-161,
      2.3104293381266195e-161, 1.083137165799506e-161, 5.077784031635647e-162,
      2.3804824989918854e-162, 1.1159783269044048e-162, 5.231744516701023e-163,
      2.452659700296836e-163, 1.1498152454228366e-163, 5.390373146534646e-164,
      2.5270253438148347e-164, 1.184678113126141e-164, 5.553811461191862e-165,
      2.603645784007307e-165, 1.2205980372124915e-165, 5.722205292280286e-166,
      2.6825893872300433e-166, 1.2576070680630117e-166, 5.8957048930814164e-167,
      2.763926592734652e-167, 1.2957382278394661e-167, 6.074465072617595e-168,
      2.8477299755196124e-168, 1.335025539949047e-168, 6.258645333783929e-169,
      2.934074311086988e-169, 1.3755040594025442e-169, 6.448410015668428e-170,
      3.0230366421625975e-170, 1.4172099040929875e-170, 6.64392844018735e-171,
      3.1146963474391604e-171, 1.4601802870226704e-171, 6.845375063166587e-172,
      3.2091352124037704e-172, 1.504453549507309e-172, 7.0529296300039e-173,
      3.306437502312881e-173, 1.5500691953869666e-173, 7.266777336050898e-174,
      3.4066900373799273e-174, 1.597067926274267e-174, 7.487108991857869e-175,
      3.509982270242665e-175, 1.6454916778713463e-175, 7.714121193428889e-176,
      3.616406365779347e-176, 1.695383657387952e-176, 7.948016497639148e-177,
      3.7260572833449674e-177, 1.7467883820940718e-177, 8.189003602970993e-178,
      3.8390328615009335e-178, 1.7997517190414956e-178, 8.437297535729966e-179,
      3.9554339053137816e-179, 1.854320925989751e-179, 8.693119841906987e-180,
      4.075364276300824e-180, 1.91054469357293e-180, 8.956698784857881e-181,
      4.198930985102985e-181, 1.9684731887450295e-181, 9.228269548976612e-182,
      4.3262442869675095e-182, 2.0281580995425746e-182, 9.508074449544e-183,
      4.457417780125761e-183, 2.0896526812044623e-183, 9.796363148939113e-184,
      4.592568507153853e-184, 2.153011803690176e-184, 1.0093392879406284e-184,
      4.7318170594066e-185, 2.218292000638774e-185, 1.0399428672576526e-185,
      4.875287684617927e-186, 2.285551519812333e-186, 1.0714743595948115e-186,
      5.023108397763786e-187, 2.3548503750688587e-187, 1.1039618996537361e-187,
      5.1754110952864624e-188, 2.426250399911034e-188, 1.1374344751916986e-188,
      5.3323316727822265e-189, 2.4998153026585892e-189, 1.171921952886607e-189,
      5.494010146257313e-190, 2.5756107232935217e-190, 1.2074551049862374e-190,
      5.660590777060432e-191, 2.6537042920288823e-191, 1.2440656367654838e-191,
      5.832222200603291e-192, 2.7341656896533952e-192, 1.2817862148161187e-192,
      6.009057558983962e-193, 2.8170667097057485e-193, 1.3206504961943155e-193,
      6.191254637631462e-194, 2.9024813225340365e-194, 1.3606931584519325e-194,
      6.3789760060934354e-195, 2.9904857412975085e-195, 1.401949930578359e-195,
      6.57238916309259e-196, 3.081158489969521e-196, 1.4444576248805304e-196,
      6.771666685981293e-197, 3.174580473402362e-197, 1.4882541698295586e-197,
      6.976986384727696e-198, 3.270835049516475e-198, 1.5333786439032856e-198,
      7.188531460570787e-199, 3.370008103678485e-199, 1.5798713104549572e-199,
      7.40649066948592e-200, 3.4721881253343996e-200, 1.6277736536391288e-200,
      7.631058490606687e-201, 3.57746628696636e-201, 1.6771284154268596e-201,
      7.862435299753415e-202, 3.68593652544339e-202, 1.7279796337432226e-202,
      8.100827548223118e-203, 3.7976956258387357e-203, 1.780372681761159e-203,
      8.346447947000426e-204, 3.912843307788582e-204, 1.83435430838674e-204,
      8.599515656553872e-205, 4.0314823144691965e-205, 1.8899726799719553e-205,
      8.860256482386878e-206, 4.153718504271902e-206, 1.947277423292254e-206,
      9.128903076517924e-207, 4.279660945257667e-207, 2.006319669827178e-207,
      9.40569514506968e-208, 4.409422012475599e-208, 2.0671521013836054e-208,
      9.690879662152325e-209, 4.5431174882321787e-209, 2.1298289971023102e-209,
      9.984711090231899e-210, 4.680866665400691e-210, 2.194406281889775e-210,
      1.0287451607180308e-210, 4.822792453863046e-211, 2.260941576318481e-211,
      1.0599371340209574e-211, 4.969021490178954e-212, 2.3294942480401928e-212,
      1.0920748606899086e-212, 5.119684250580326e-213, 2.400125464758117e-213,
      1.1251870163530871e-213, 5.274915167391691e-214, 2.472898248805195e-214,
      1.159303146095451e-214, 5.434852748980551e-215, 2.5478775333772345e-215,
      1.194453690820997e-215, 5.599639703344659e-216, 2.6251302204710526e-216,
      1.2306700144143604e-216, 5.7694230654465284e-217, 2.7047252405793244e-217,
      1.2679844317259638e-217, 5.944354328408768e-218, 2.786733614195408e-218,
      1.306430237405689e-218, 6.12458957868732e-219, 2.871228515183017e-219,
      1.3460417356107958e-219, 6.310289635343199e-220, 2.9582853360672887e-220,
      1.3868542706145983e-220, 6.501620193537007e-221, 3.0479817553055043e-221,
      1.4289042583432085e-221, 6.698751972374274e-222, 3.140397806597488e-222,
      1.472229218868487e-222, 6.901860867233511e-223, 3.235615950297517e-223,
      1.516867809886191e-223, 7.111128106712918e-224, 3.3337211469914786e-224,
      1.5628598612091982e-224, 7.326740414335793e-225, 3.4348009333049146e-225,
      1.610246410306574e-225, 7.548890175158898e-226, 3.538945500009594e-226,
      1.6590697389202026e-226, 7.77777560743246e-227, 3.6462477724983076e-227,
      1.7093734107916434e-227, 8.01360093946499e-228, 3.756803493699699e-228,
      1.7612023105328883e-228, 8.256576591850694e-229, 3.870711309507098e-229,
      1.8146026836756902e-229, 8.506919365222111e-230, 3.9880728567975977e-230,
      1.869622177935207e-230, 8.764852633695477e-231, 4.108992854119902e-231,
      1.926309885724774e-231, 9.03060654418143e-232, 4.233579195131867e-232,
      1.9847163879597428e-232, 9.304418221738909e-233, 4.361943044871106e-233,
      2.0448937991894704e-233, 9.586531981155456e-234, 4.4941989389445635e-234,
      2.106895814097729e-234, 9.877199544942725e-235, 4.630464885725549e-235,
      2.1707777554130253e-235, 1.0176680267941701e-235, 4.770862471649434e-236,
      2.2365966232715824e-236, 1.0485241368738036e-236, 4.915516969701952e-237,
      2.3044111460770264e-237, 1.0803158168094005e-237, 5.0645574511969133e-238,
      2.37428183290216e-238, 1.113071433460981e-238, 5.218116900943061e-239,
      2.446271027479579e-239, 1.1468202137833425e-239, 5.376332335902836e-240,
      2.5204429638293045e-240, 1.1815922709044855e-240, 5.539344927448924e-241,
      2.5968638235730733e-241, 1.2174186309947463e-241, 5.70730012732767e-242,
      2.6756017949864126e-242, 1.2543312609506134e-242, 5.880347797441756e-243,
      2.756727133841206e-243, 1.2923630969179293e-243, 6.058642343567937e-244,
      2.840312226093025e-244, 1.3315480736799252e-244, 6.2423428531291686e-245,
      2.926431652469168e-245, 1.3719211549363158e-245, 6.431613237144018e-246,
      3.015162255015037e-246, 1.4135183645004665e-246, 6.626622376480065e-247,
      3.106583205658225e-247, 1.4563768184424725e-247, 6.827544272541744e-248,
      3.2007760768514937e-248, 1.500534758206828e-248, 7.034558202527116e-249,
      3.2978249143576785e-249, 1.5460315847342381e-249, 7.247848879392084e-250,
      3.39781631224146e-250, 1.5929078936180175e-250, 7.467606616664793e-251,
      3.500839490134914e-251, 1.641205511326445e-251, 7.694027498257266e-252,
      3.6069863728457917e-252, 1.6909675325233953e-252, 7.927313553425797e-253,
      3.716351672379545e-253, 1.7422383585205466e-253, 8.167672937036214e-254,
      3.829032972448301e-254, 1.795063736895476e-254, 8.415320115294872e-255,
      3.9451308155421845e-255, 1.8494908023109918e-255, 8.670476057111066e-256,
      4.064748792640668e-256, 1.9055681185721226e-256, 8.933368431261635e-257,
      4.187993635644019e-257, 1.963345721958294e-257, 9.204231809533695e-258,
      4.314975312607299e-258, 2.0228751658693542e-258, 9.483307876026723e-259,
      4.4458071258619e-259, 2.0842095668252824e-259, 9.77084564280076e-260,
      4.580605813112157e-260, 2.1474036518606312e-260, 1.0067101672063187e-260,
      4.71949165159727e-261, 2.2125138073559857e-261, 1.0372340305092257e-261,
      4.8625885654114356e-262, 2.279598129350012e-262, 1.0686833898101719e-262,
      5.010024236077985e-263, 2.3487164753769892e-263, 1.1010863065256914e-263,
      5.16193021647617e-264, 2.4199305178760756e-264, 1.1344716929059256e-264,
      5.318442048222251e-265, 2.4933037992199645e-265, 1.1688693378322445e-265,
      5.479699382609636e-266, 2.5689017884120333e-266, 1.2043099333970641e-266,
      5.6458461052159665e-267, 2.646791939502573e-267, 1.2408251022895736e-267,
      5.817030464288347e-268, 2.7270437517762195e-268, 1.2784474260118096e-268,
      5.9934052030212615e-269, 2.8097288317642957e-269, 1.317210473950254e-269,
      6.175127695845217e-270, 2.8949209571373907e-270, 1.3571488333288922e-270,
      6.362360088847706e-271, 2.9826961425351886e-271, 1.3982981400704633e-271,
      6.555269444451799e-272, 3.0731327073922846e-272, 1.4406951105934327e-272,
      6.754027890481441e-273, 3.1663113458205088e-273, 1.4843775745730659e-273,
      6.958812773746484e-274, 3.262315198610109e-274, 1.5293845086958273e-274,
      7.169806818284458e-275, 3.361229927414038e-275, 1.5757560714372294e-275,
      7.387198288400319e-276, 3.4631437911815425e-276, 1.6235336388941582e-276,
      7.611181156649616e-277, 3.568147724909245e-277, 1.672759841703651e-277,
      7.84195527691498e-278, 3.676335420779995e-278, 1.723478603081066e-278,
      8.079726562730362e-279, 3.7878034117618785e-279, 1.7757351780115847e-279,
      8.324707171012135e-280, 3.9026511577419884e-280, 1.829576193630016e-280,
      8.577115691361e-281, 4.020981134271802e-281, 1.8850496908249345e-281,
      8.837177341103598e-282, 4.142898924003359e-282, 1.942205167104271e-282,
      9.105124166247873e-283, 4.2685133108978177e-283, 2.001093620760606e-283,
      9.381195248531466e-284, 4.397936377290453e-284, 2.0617675963755738e-284,
      9.665636918747925e-285, 4.531283603898709e-285, 2.1242812317039766e-285,
      9.95870297654103e-286, 4.668673972862532e-286, 2.1886903059794475e-286,
      1.0260654916863389e-286, 4.8102300739089333e-287, 2.2550522896847566e-287,
      1.0571762163301333e-287, 4.956078213735496e-288, 2.323426395831177e-288,
      1.0892302308474341e-288, 5.106348528710446e-289, 2.3938736327926593e-289,
      1.122256136172345e-289, 5.261175100989829e-290, 2.4664568587419623e-290,
      1.1562834004309693e-290, 5.420696078155405e-291, 2.5412408377373073e-291,
      1.191342385235026e-291, 5.585053796480018e-292, 2.618292297509603e-292,
      1.2274643727726968e-292, 5.754394907930421e-293, 2.6976799890018046e-293,
      1.2646815937208825e-293, 5.9288705110208735e-294, 2.7794747477135274e-294,
      1.3030272560037664e-294, 6.108636285634283e-295, 2.8637495569056577e-295,
      1.3425355744233516e-295, 6.293852631931167e-296, 2.9505796127213495e-296,
      1.383241801188408e-296, 6.484684813470401e-297, 3.04004239128152e-297,
      1.4251822573690685e-297, 6.681303104669443e-298, 3.1322177178147056e-298,
      1.4683943653051421e-298, 6.88388294273561e-299, 3.227187837882963e-299,
      1.51291668199706e-299, 7.092605084203971e-300, 3.325037490767372e-300,
      1.5587889335092487e-300, 7.307655766221546e-301, 3.4258539850786136e-301,
      1.6060520504166292e-301, 7.529226872721689e-302, 3.5297272766600903e-302,
      1.6547482043258643e-302, 7.757516105636956e-303, 3.636750048853106e-303,
      1.7049208455039502e-303, 7.992727161303224e-304, 3.747017795195717e-304,
      1.756614741647719e-304, 8.235069912212437e-305, 3.8606289046290386e-305,
      1.8098760178288486e-305, 8.484760594276187e-306, 3.977684749287056e-306,
      1.8647521976500223e-306, 8.742021999767189e-307, 4.098289774948243e-307,
      1.921292245648961e-307, 9.007083676110836e-308, 4.2225515942297256e-308,
      1.9795466109881613e-308, 9.28018213070418e-309, 4.350581082607115e-309,
      2.039567272469325e-309, 9.56156104194512e-310, 4.4824924773457e-310,
      2.10140778491263e-310, 9.85147147666e-311, 4.618403479431e-311, 2.165123326942e-311,
      1.0150172114125e-311, 4.75843535859e-312, 2.23077075022e-312, 1.04579294769e-312,
      4.9027130615e-313, 2.2984086302e-313, 1.07750181683e-313, 5.051365323e-314,
      2.3680973184e-314, 1.110172112e-314, 5.20452478e-315, 2.439898993e-315,
      1.14383298e-315, 5.3623281e-316, 2.51387774e-316, 1.1785145e-316, 5.5249163e-317,
      2.5900996e-317, 1.2142474e-317, 5.69243e-318, 2.66863e-318, 1.251063e-318, 5.865e-319,
      2.74952e-319, 1.28897e-319, 6.043e-320, 2.833e-320, 1.328e-320, 6.225e-321, 2.92e-321,
      1.37e-321, 6.4e-322, 3e-322, 1.43e-322, 7e-323, 3.5e-323, 1.5e-323, 5e-324, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.2655982920737682, 0.3901116786425311, 0.18288568751155718, 0.08573743501594426,
      0.040194002401903295, 0.018843085622794395, 0.00883370290516646, 0.004141270096567868,
      0.0019414415672386787, 0.0009101544383994531, 0.0004266835096749443,
      0.0002000306868235316, 9.377506925818601e-05, 4.3962072790038954e-05,
      2.060956989192491e-05, 9.661836764584488e-06, 4.529502078646124e-06,
      2.1234460465801373e-06, 9.95478760015178e-07, 4.666838431036904e-07,
      2.1878297977016527e-07, 1.0256620824663394e-07, 4.808338877705712e-08,
      2.2541656904446393e-08, 1.0567605755778742e-08, 4.95412967569123e-09,
      2.3225129145401065e-09, 1.0888019876978629e-09, 5.104340910197102e-10,
      2.392932454375875e-10, 1.1218149085156298e-10, 5.259106610663462e-11,
      2.4654871434113036e-11, 1.1558287945715522e-11, 5.4185648703577916e-12,
      2.5402417202418946e-12, 1.1908739955403386e-12, 5.582857969591823e-13,
      2.617262886363796e-13, 1.226981781311226e-13, 5.752132502674433e-14,
      2.6966193656897547e-14, 1.2641843698892608e-14, 5.926539508713799e-15,
      2.7783819658696107e-15, 1.3025149561425566e-15, 6.106234606385525e-16,
      2.862623641470058e-16, 1.3420077414211815e-16, 6.291378132786997e-17,
      2.9494195590700385e-17, 1.3826979640741014e-17, 6.482135286501858e-18,
      3.038847164329859e-18, 1.4246219308914109e-18, 6.678676275002258e-19,
      3.1309862510938665e-19, 1.467817049499904e-19, 6.881176466520397e-20,
      3.225919032588348e-20, 1.5123218617408925e-20, 7.089816546524877e-21,
      3.3237302147781795e-21, 1.5581760780600533e-21, 7.30478267894148e-22,
      3.4245070719476764e-22, 1.6054206129399893e-22, 7.526266672262229e-23,
      3.5283395245730877e-23, 1.6540976214071213e-23, 7.754466150690936e-24,
      3.6353202195562164e-24, 1.7042505366454825e-24, 7.989584730477965e-25,
      3.745544612890755e-25, 1.7559241087509795e-25, 8.23183220160152e-26,
      3.859111054835099e-26, 1.8091644446606987e-26, 8.48142471495761e-27,
      3.9761208776676354e-27, 1.864019049292883e-27, 8.738584975225655e-28,
      4.096678486102804e-28, 1.9205368679342938e-28, 9.003542439581889e-29,
      4.2208914504486135e-29, 1.97876832991277e-29, 9.276533522437812e-30,
      4.348870602588733e-30, 2.0387653935939603e-30, 9.55780180638641e-31,
      4.480730134874796e-31, 2.1005815927423746e-31, 9.847598259544339e-32,
      4.616587702017162e-32, 2.1642720842881213e-32, 1.0146181459484024e-32,
      4.756564526065046e-33, 2.2298936975419485e-33, 1.0453817823955459e-33,
      4.900785504569688e-34, 2.2975049849025093e-34, 1.0770781848603594e-34,
      5.049379322027077e-35, 2.367166274101091e-35, 1.1097356351893408e-35,
      5.2024785646996645e-36, 2.438939722030425e-36, 1.1433832727461215e-36,
      5.360219838919509e-37, 2.512889370205608e-37, 1.1780511204117353e-37,
      5.522743892978435e-38, 2.589081201906623e-38, 1.213770111373227e-38,
      5.69019574271394e-39, 2.6675832010534415e-39, 1.2505721167245027e-39,
      5.8627248009029275e-40, 2.7484654128662473e-40, 1.2884899739040486e-40,
      6.040485010578697e-41, 2.8318000063648983e-41, 1.3275575159948925e-41,
      6.223634982390173e-42, 2.9176613387634006e-42, 1.3678096019129544e-42,
      6.412338136125915e-43, 3.006126021816849e-43, 1.4092821475107166e-43,
      6.606762846529195e-44, 3.097272990180033e-44, 1.4520121576239736e-44,
      6.807082593534247e-45, 3.191183571838702e-45, 1.4960377590902495e-45,
      7.01347611705774e-46, 3.287941560676342e-46, 1.5413982347683495e-46,
      7.226127576483599e-47, 3.387633291241196e-47, 1.5881340585893965e-47,
      7.445226714983458e-48, 3.490347715780262e-48, 1.636286931670631e-48,
      7.670969028819386e-49, 3.596176483608984e-49, 1.685899819524193e-49,
      7.903555941779937e-50, 3.70521402288747e-50, 1.7370169903940942e-50,
      8.143194984905175e-51, 3.817557624876197e-51, 1.7896840547555792e-51,
      8.390099981661031e-52, 3.933307530746384e-52, 1.843948006012124e-52,
      8.64449123872823e-53, 4.052567021022489e-53, 1.8998572624263857e-53,
      8.906595742576001e-54, 4.175442507736639e-54, 1.9574617103225134e-54,
      9.176647361996e-55, 4.302043629377225e-55, 2.016812748598373e-55,
      9.454887056777133e-56, 4.432483348716367e-56, 2.0779633345873994e-56,
      9.741563092707486e-57, 4.5668780536035595e-57, 2.1409680313109992e-57,
      1.0036931263095208e-57, 4.705347660815416e-58, 2.2058830561636666e-58,
      1.0341255117005988e-58, 4.848015723054176e-59, 2.2727663310742493e-59,
      1.0654806194420793e-59, 4.995009539190457e-60, 2.3416775341881267e-60,
      1.097786426852368e-60, 5.146460267848609e-61, 2.412678153116413e-61,
      1.1310717595335878e-61, 5.302503044436023e-62, 2.4858315397996954e-62,
      1.1653663170918866e-62, 5.463277101720817e-63, 2.5612029670352663e-63,
      1.2007006996375977e-63, 5.6289258940654875e-64, 2.6388596867182837e-64,
      1.2371064350888935e-64, 5.799597225427373e-65, 2.718870989848823e-65,
      1.2746160073032973e-65, 5.975443381240146e-66, 2.8013082683583757e-66,
      1.3132628850621565e-66, 6.156621264294003e-67, 2.886245078810942e-67,
      1.3530815519339328e-67, 6.343292534735804e-68, 2.9737572080355774e-68,
      1.394107537042964e-68, 6.535623754314065e-69, 3.0639227407489364e-69,
      1.4363774467711438e-69, 6.733786534997525e-70, 3.156822129228165e-70,
      1.4799289974208113e-70, 6.937957692099882e-71, 3.2525382650962998e-71,
      1.5248010488679914e-71, 7.148319402047337e-72, 3.351156553284232e-72,
      1.5710336392360167e-72, 7.365059364929718e-73, 3.452764988235228e-73,
      1.6186680206204664e-73, 7.588370971980207e-74, 3.557454232420001e-74,
      1.6677466958973005e-74, 7.818453478133144e-75, 3.6653176972323935e-75,
      1.7183134566470323e-75, 8.055512179813829e-76, 3.776451626337849e-76,
      1.7704134222287752e-76, 8.299758598118998e-77, 3.890955181549041e-77,
      1.8240930800390334e-77, 8.551410667551403e-78, 4.008930531305294e-78,
      1.8794003269911538e-78, 8.810692930476901e-79, 4.130482941834724e-79,
      1.9363845122524515e-79, 9.077836737477561e-80, 4.255720871080465e-80,
      1.995096481277144e-80, 9.353080453779559e-81, 4.384756065474768e-81,
      2.05558862117438e-81, 9.636669671940053e-82, 4.517703659647337e-82,
      2.1179149074518476e-82, 9.928857430982806e-83, 4.654682279156856e-83,
      2.182130952176665e-83, 1.0229904442178095e-83, 4.795814146337383e-84,
      2.2482940535965322e-84, 1.0540079321668364e-84, 4.941225189354047e-85,
      2.3164632472654138e-85, 1.085965883014716e-85, 5.091045154565358e-86,
      2.3866993587193737e-86, 1.1188928119805269e-86, 5.2454077222923935e-87,
      2.459065057749565e-87, 1.152818098876432e-87, 5.404450626098145e-88,
      2.5336249143207965e-88, 1.187772014322495e-88, 5.568315775683471e-89,
      2.610445456185572e-89, 1.2237857467563388e-89, 5.737149383509297e-90,
      2.6895952282450144e-90, 1.2608914302617494e-90, 5.911102095258065e-91,
      2.7711448537096363e-91, 1.2991221732410532e-91, 6.090329124250818e-92,
      2.855167097114527e-92, 1.3385120879568531e-92, 6.27499038993986e-93,
      2.9417369292451893e-93, 1.379096320969482e-93, 6.465250660600587e-94,
      3.030931594031953e-94, 1.420911084497332e-94, 6.661279700349779e-95,
      3.122830677472652e-95, 1.4639936887280424e-95, 6.863252420621547e-96,
      3.217516178645071e-96, 1.508382575109375e-96, 7.071349036236103e-97,
      3.315072582872512e-97, 1.554117350649483e-97, 7.285755226200586e-98,
      3.415586937107774e-98, 1.6012388232571783e-98, 7.506662299385446e-99,
      3.5191489276028065e-99, 1.64978903815373e-99, 7.734267365224192e-100,
      3.625850959933335e-100, 1.6998113153886818e-100, 7.968773509588835e-101,
      3.735788241449871e-101, 1.7513502884931676e-101, 8.210389975997946e-102,
      3.849058866228664e-102, 1.804451944305209e-102, 8.459332352319015e-103,
      3.965763902598411e-103, 1.859163664002532e-103, 8.71582276313169e-104,
      4.086007483320795e-104, 1.915534265379517e-104, 8.980090067923571e-105,
      4.209896898505353e-105, 1.973614046406002e-105, 9.252370065295365e-106,
      4.3375426913415495e-106, 2.033454830106807e-106, 9.532905703357622e-107,
      4.469058756733486e-107, 2.0951100108020225e-107, 9.821947296506802e-108,
      4.604562442925259e-108, 2.158634601749326e-108, 1.0119752748774066e-108,
      4.74417465620764e-109, 2.2240852842308293e-109, 1.0426587783946103e-109,
      4.8880199687995026e-110, 2.2915204581282596e-110, 1.0742726182663305e-110,
      5.0362267300002546e-111, 2.3610002940316025e-111, 1.1068450026706863e-111,
      5.18892718071247e-112, 2.4325867869276997e-112, 1.1404049950692747e-112,
      5.346257571436879e-113, 2.5063438115167057e-113, 1.174982540139715e-113,
      5.5083582838450286e-114, 2.5823371792057638e-114, 1.2106084904944777e-114,
      5.675373956038059e-115, 2.6606346968307522e-115, 1.2473146342098407e-115,
      5.847453611603395e-116, 2.7413062271584974e-116, 1.2851337231895333e-116,
      6.024750792584477e-117, 2.8244237512234403e-117, 1.3240995023883778e-117,
      6.207423696482188e-118, 2.9100614325543763e-118, 1.3642467399220055e-118,
      6.395635317410237e-119, 2.998295683348575e-119, 1.4056112580895088e-119,
      6.589553591530406e-120, 3.0892052326523245e-120, 1.4482299653367144e-120,
      6.789351546897468e-121, 3.182871196608741e-121, 1.4921408891885961e-121,
      6.995207457847463e-122, 3.2793771508355197e-122, 1.5373832101802117e-122,
      7.207305004067093e-123, 3.378809204997208e-123, 1.5839972968164383e-123,
      7.42583343448615e-124, 3.481256079638539e-124, 1.6320247415917033e-124,
      7.650987736139248e-125, 3.5868091853473876e-125, 1.6815083981018476e-125,
      7.882968808147505e-126, 3.6955627043179746e-126, 1.7324924192812347e-126,
      8.121983640975415e-127, 3.807613674387104e-127, 1.7850222967992248e-127,
      8.368245501122868e-128, 3.923062075618412e-128, 1.8391449016511677e-128,
      8.621974121417107e-129, 4.0420109195118844e-129, 1.894908525980129e-129,
      8.883395897074412e-130, 4.164566340918245e-130, 1.952362926166669e-130,
      9.152744087706457e-131, 4.290837692740228e-131, 2.0115593672251226e-131,
      9.430259025451578e-132, 4.4209376435052247e-132, 2.0725506685459906e-132,
      9.716188329416676e-133, 4.55498227789638e-133, 2.135391251025259e-133,
      1.001078712662107e-133, 4.693091200331827e-134, 2.2001371856226993e-134,
      1.0314318279639473e-134, 4.8353876416844917e-135, 2.2668462433924783e-135,
      1.062705262114719e-135, 4.9819985692376805e-136, 2.335577947030711e-136,
      1.0949269195576818e-136, 5.133054799974569e-137, 2.4063936239859624e-137,
      1.1281255508102083e-137, 5.288691117302677e-138, 2.4793564611800776e-138,
      1.1623307781170967e-138, 5.4490463913174695e-139, 2.55453156138817e-139,
      1.1975731218817015e-139, 5.614263702712404e-140, 2.631986001328076e-140,
      1.2338840278984688e-140, 5.784490470445987e-141, 2.7117888915111036e-141,
      1.2712958954111714e-141, 5.959878583279735e-142, 2.7940114379074816e-142,
      1.309842106021881e-142, 6.140584535304427e-143, 2.8787270054815285e-143,
      1.3495570534764745e-143, 6.326769565575572e-144, 2.966011183653236e-144,
      1.3904761743532458e-144, 6.518599801982674e-145, 3.0559418537446708e-145,
      1.4326359796820115e-145, 6.716246409480677e-146, 3.1485992584713857e-146,
      1.4760740875219197e-146, 6.919885742815843e-147, 3.2440660735408303e-147,
      1.5208292565270308e-147, 7.129699503882347e-148, 3.34242748142166e-148,
      1.566941420529621e-148, 7.34587490384998e-149, 3.4437712473497585e-149,
      1.6144517241720663e-149, 7.568604830207642e-150, 3.5481877976387984e-150,
      1.663402559619099e-150, 7.798088018871648e-151, 3.6557703003651995e-151,
      1.7138376043831927e-151, 8.034529231512439e-152, 3.7666147484995014e-152,
      1.7658018602968346e-152, 8.278139438257908e-153, 3.880820045558302e-153,
      1.8193416936664456e-153, 8.529136005936362e-154, 3.998488093853205e-154,
      1.8745048766437888e-154, 8.787742892027093e-155, 4.1197238854155085e-155,
      1.931340629851774e-155, 9.054190844491604e-156, 4.2446355956777663e-156,
      1.9898996663026937e-156, 9.328717607663804e-157, 4.373334679995814e-157,
      2.0502342366480786e-157, 9.611568134382875e-158, 4.5059359730973835e-158,
      2.112398175800548e-158, 9.9029948045581e-159, 4.642557791546037e-159,
      2.1764469509692523e-159, 1.020325765036065e-159, 4.783322039311855e-160,
      2.24243771115177e-160, 1.05126245882433e-160, 4.9283543165430584e-161,
      2.3104293381266195e-161, 1.083137165799506e-161, 5.077784031635647e-162,
      2.3804824989918854e-162, 1.1159783269044048e-162, 5.231744516701023e-163,
      2.452659700296836e-163, 1.1498152454228366e-163, 5.390373146534646e-164,
      2.5270253438148347e-164, 1.184678113126141e-164, 5.553811461191862e-165,
      2.603645784007307e-165, 1.2205980372124915e-165, 5.722205292280286e-166,
      2.6825893872300433e-166, 1.2576070680630117e-166, 5.8957048930814164e-167,
      2.763926592734652e-167, 1.2957382278394661e-167, 6.074465072617595e-168,
      2.8477299755196124e-168, 1.335025539949047e-168, 6.258645333783929e-169,
      2.934074311086988e-169, 1.3755040594025442e-169, 6.448410015668428e-170,
      3.0230366421625975e-170, 1.4172099040929875e-170, 6.64392844018735e-171,
      3.1146963474391604e-171, 1.4601802870226704e-171, 6.845375063166587e-172,
      3.2091352124037704e-172, 1.504453549507309e-172, 7.0529296300039e-173,
      3.306437502312881e-173, 1.5500691953869666e-173, 7.266777336050898e-174,
      3.4066900373799273e-174, 1.597067926274267e-174, 7.487108991857869e-175,
      3.509982270242665e-175, 1.6454916778713463e-175, 7.714121193428889e-176,
      3.616406365779347e-176, 1.695383657387952e-176, 7.948016497639148e-177,
      3.7260572833449674e-177, 1.7467883820940718e-177, 8.189003602970993e-178,
      3.8390328615009335e-178, 1.7997517190414956e-178, 8.437297535729966e-179,
      3.9554339053137816e-179, 1.854320925989751e-179, 8.693119841906987e-180,
      4.075364276300824e-180, 1.91054469357293e-180, 8.956698784857881e-181,
      4.198930985102985e-181, 1.9684731887450295e-181, 9.228269548976612e-182,
      4.3262442869675095e-182, 2.0281580995425746e-182, 9.508074449544e-183,
      4.457417780125761e-183, 2.0896526812044623e-183, 9.796363148939113e-184,
      4.592568507153853e-184, 2.153011803690176e-184, 1.0093392879406284e-184,
      4.7318170594066e-185, 2.218292000638774e-185, 1.0399428672576526e-185,
      4.875287684617927e-186, 2.285551519812333e-186, 1.0714743595948115e-186,
      5.023108397763786e-187, 2.3548503750688587e-187, 1.1039618996537361e-187,
      5.1754110952864624e-188, 2.426250399911034e-188, 1.1374344751916986e-188,
      5.3323316727822265e-189, 2.4998153026585892e-189, 1.171921952886607e-189,
      5.494010146257313e-190, 2.5756107232935217e-190, 1.2074551049862374e-190,
      5.660590777060432e-191, 2.6537042920288823e-191, 1.2440656367654838e-191,
      5.832222200603291e-192, 2.7341656896533952e-192, 1.2817862148161187e-192,
      6.009057558983962e-193, 2.8170667097057485e-193, 1.3206504961943155e-193,
      6.191254637631462e-194, 2.9024813225340365e-194, 1.3606931584519325e-194,
      6.3789760060934354e-195, 2.9904857412975085e-195, 1.401949930578359e-195,
      6.57238916309259e-196, 3.081158489969521e-196, 1.4444576248805304e-196,
      6.771666685981293e-197, 3.174580473402362e-197, 1.4882541698295586e-197,
      6.976986384727696e-198, 3.270835049516475e-198, 1.5333786439032856e-198,
      7.188531460570787e-199, 3.370008103678485e-199, 1.5798713104549572e-199,
      7.40649066948592e-200, 3.4721881253343996e-200, 1.6277736536391288e-200,
      7.631058490606687e-201, 3.57746628696636e-201, 1.6771284154268596e-201,
      7.862435299753415e-202, 3.68593652544339e-202, 1.7279796337432226e-202,
      8.100827548223118e-203, 3.7976956258387357e-203, 1.780372681761159e-203,
      8.346447947000426e-204, 3.912843307788582e-204, 1.83435430838674e-204,
      8.599515656553872e-205, 4.0314823144691965e-205, 1.8899726799719553e-205,
      8.860256482386878e-206, 4.153718504271902e-206, 1.947277423292254e-206,
      9.128903076517924e-207, 4.279660945257667e-207, 2.006319669827178e-207,
      9.40569514506968e-208, 4.409422012475599e-208, 2.0671521013836054e-208,
      9.690879662152325e-209, 4.5431174882321787e-209, 2.1298289971023102e-209,
      9.984711090231899e-210, 4.680866665400691e-210, 2.194406281889775e-210,
      1.0287451607180308e-210, 4.822792453863046e-211, 2.260941576318481e-211,
      1.0599371340209574e-211, 4.969021490178954e-212, 2.3294942480401928e-212,
      1.0920748606899086e-212, 5.119684250580326e-213, 2.400125464758117e-213,
      1.1251870163530871e-213, 5.274915167391691e-214, 2.472898248805195e-214,
      1.159303146095451e-214, 5.434852748980551e-215, 2.5478775333772345e-215,
      1.194453690820997e-215, 5.599639703344659e-216, 2.6251302204710526e-216,
      1.2306700144143604e-216, 5.7694230654465284e-217, 2.7047252405793244e-217,
      1.2679844317259638e-217, 5.944354328408768e-218, 2.786733614195408e-218,
      1.306430237405689e-218, 6.12458957868732e-219, 2.871228515183017e-219,
      1.3460417356107958e-219, 6.310289635343199e-220, 2.9582853360672887e-220,
      1.3868542706145983e-220, 6.501620193537007e-221, 3.0479817553055043e-221,
      1.4289042583432085e-221, 6.698751972374274e-222, 3.140397806597488e-222,
      1.472229218868487e-222, 6.901860867233511e-223, 3.235615950297517e-223,
      1.516867809886191e-223, 7.111128106712918e-224, 3.3337211469914786e-224,
      1.5628598612091982e-224, 7.326740414335793e-225, 3.4348009333049146e-225,
      1.610246410306574e-225, 7.548890175158898e-226, 3.538945500009594e-226,
      1.6590697389202026e-226, 7.77777560743246e-227, 3.6462477724983076e-227,
      1.7093734107916434e-227, 8.01360093946499e-228, 3.756803493699699e-228,
      1.7612023105328883e-228, 8.256576591850694e-229, 3.870711309507098e-229,
      1.8146026836756902e-229, 8.506919365222111e-230, 3.9880728567975977e-230,
      1.869622177935207e-230, 8.764852633695477e-231, 4.108992854119902e-231,
      1.926309885724774e-231, 9.03060654418143e-232, 4.233579195131867e-232,
      1.9847163879597428e-232, 9.304418221738909e-233, 4.361943044871106e-233,
      2.0448937991894704e-233, 9.586531981155456e-234, 4.4941989389445635e-234,
      2.106895814097729e-234, 9.877199544942725e-235, 4.630464885725549e-235,
      2.1707777554130253e-235, 1.0176680267941701e-235, 4.770862471649434e-236,
      2.2365966232715824e-236, 1.0485241368738036e-236, 4.915516969701952e-237,
      2.3044111460770264e-237, 1.0803158168094005e-237, 5.0645574511969133e-238,
      2.37428183290216e-238, 1.113071433460981e-238, 5.218116900943061e-239,
      2.446271027479579e-239, 1.1468202137833425e-239, 5.376332335902836e-240,
      2.5204429638293045e-240, 1.1815922709044855e-240, 5.539344927448924e-241,
      2.5968638235730733e-241, 1.2174186309947463e-241, 5.70730012732767e-242,
      2.6756017949864126e-242, 1.2543312609506134e-242, 5.880347797441756e-243,
      2.756727133841206e-243, 1.2923630969179293e-243, 6.058642343567937e-244,
      2.840312226093025e-244, 1.3315480736799252e-244, 6.2423428531291686e-245,
      2.926431652469168e-245, 1.3719211549363158e-245, 6.431613237144018e-246,
      3.015162255015037e-246, 1.4135183645004665e-246, 6.626622376480065e-247,
      3.106583205658225e-247, 1.4563768184424725e-247, 6.827544272541744e-248,
      3.2007760768514937e-248, 1.500534758206828e-248, 7.034558202527116e-249,
      3.2978249143576785e-249, 1.5460315847342381e-249, 7.247848879392084e-250,
      3.39781631224146e-250, 1.5929078936180175e-250, 7.467606616664793e-251,
      3.500839490134914e-251, 1.641205511326445e-251, 7.694027498257266e-252,
      3.6069863728457917e-252, 1.6909675325233953e-252, 7.927313553425797e-253,
      3.716351672379545e-253, 1.7422383585205466e-253, 8.167672937036214e-254,
      3.829032972448301e-254, 1.795063736895476e-254, 8.415320115294872e-255,
      3.9451308155421845e-255, 1.8494908023109918e-255, 8.670476057111066e-256,
      4.064748792640668e-256, 1.9055681185721226e-256, 8.933368431261635e-257,
      4.187993635644019e-257, 1.963345721958294e-257, 9.204231809533695e-258,
      4.314975312607299e-258, 2.0228751658693542e-258, 9.483307876026723e-259,
      4.4458071258619e-259, 2.0842095668252824e-259, 9.77084564280076e-260,
      4.580605813112157e-260, 2.1474036518606312e-260, 1.0067101672063187e-260,
      4.71949165159727e-261, 2.2125138073559857e-261, 1.0372340305092257e-261,
      4.8625885654114356e-262, 2.279598129350012e-262, 1.0686833898101719e-262,
      5.010024236077985e-263, 2.3487164753769892e-263, 1.1010863065256914e-263,
      5.16193021647617e-264, 2.4199305178760756e-264, 1.1344716929059256e-264,
      5.318442048222251e-265, 2.4933037992199645e-265, 1.1688693378322445e-265,
      5.479699382609636e-266, 2.5689017884120333e-266, 1.2043099333970641e-266,
      5.6458461052159665e-267, 2.646791939502573e-267, 1.2408251022895736e-267,
      5.817030464288347e-268, 2.7270437517762195e-268, 1.2784474260118096e-268,
      5.9934052030212615e-269, 2.8097288317642957e-269, 1.317210473950254e-269,
      6.175127695845217e-270, 2.8949209571373907e-270, 1.3571488333288922e-270,
      6.362360088847706e-271, 2.9826961425351886e-271, 1.3982981400704633e-271,
      6.555269444451799e-272, 3.0731327073922846e-272, 1.4406951105934327e-272,
      6.754027890481441e-273, 3.1663113458205088e-273, 1.4843775745730659e-273,
      6.958812773746484e-274, 3.262315198610109e-274, 1.5293845086958273e-274,
      7.169806818284458e-275, 3.361229927414038e-275, 1.5757560714372294e-275,
      7.387198288400319e-276, 3.4631437911815425e-276, 1.6235336388941582e-276,
      7.611181156649616e-277, 3.568147724909245e-277, 1.672759841703651e-277,
      7.84195527691498e-278, 3.676335420779995e-278, 1.723478603081066e-278,
      8.079726562730362e-279, 3.7878034117618785e-279, 1.7757351780115847e-279,
      8.324707171012135e-280, 3.9026511577419884e-280, 1.829576193630016e-280,
      8.577115691361e-281, 4.020981134271802e-281, 1.8850496908249345e-281,
      8.837177341103598e-282, 4.142898924003359e-282, 1.942205167104271e-282,
      9.105124166247873e-283, 4.2685133108978177e-283, 2.001093620760606e-283,
      9.381195248531466e-284, 4.397936377290453e-284, 2.0617675963755738e-284,
      9.665636918747925e-285, 4.531283603898709e-285, 2.1242812317039766e-285,
      9.95870297654103e-286, 4.668673972862532e-286, 2.1886903059794475e-286,
      1.0260654916863389e-286, 4.8102300739089333e-287, 2.2550522896847566e-287,
      1.0571762163301333e-287, 4.956078213735496e-288, 2.323426395831177e-288,
      1.0892302308474341e-288, 5.106348528710446e-289, 2.3938736327926593e-289,
      1.122256136172345e-289, 5.261175100989829e-290, 2.4664568587419623e-290,
      1.1562834004309693e-290, 5.420696078155405e-291, 2.5412408377373073e-291,
      1.191342385235026e-291, 5.585053796480018e-292, 2.618292297509603e-292,
      1.2274643727726968e-292, 5.754394907930421e-293, 2.6976799890018046e-293,
      1.2646815937208825e-293, 5.9288705110208735e-294, 2.7794747477135274e-294,
      1.3030272560037664e-294, 6.108636285634283e-295, 2.8637495569056577e-295,
      1.3425355744233516e-295, 6.293852631931167e-296, 2.9505796127213495e-296,
      1.383241801188408e-296, 6.484684813470401e-297, 3.04004239128152e-297,
      1.4251822573690685e-297, 6.681303104669443e-298, 3.1322177178147056e-298,
      1.4683943653051421e-298, 6.88388294273561e-299, 3.227187837882963e-299,
      1.51291668199706e-299, 7.092605084203971e-300, 3.325037490767372e-300,
      1.5587889335092487e-300, 7.307655766221546e-301, 3.4258539850786136e-301,
      1.6060520504166292e-301, 7.529226872721689e-302, 3.5297272766600903e-302,
      1.6547482043258643e-302, 7.757516105636956e-303, 3.636750048853106e-303,
      1.7049208455039502e-303, 7.992727161303224e-304, 3.747017795195717e-304,
      1.756614741647719e-304, 8.235069912212437e-305, 3.8606289046290386e-305,
      1.8098760178288486e-305, 8.484760594276187e-306, 3.977684749287056e-306,
      1.8647521976500223e-306, 8.742021999767189e-307, 4.098289774948243e-307,
      1.921292245648961e-307, 9.007083676110836e-308, 4.2225515942297256e-308,
      1.9795466109881613e-308, 9.28018213070418e-309, 4.350581082607115e-309,
      2.039567272469325e-309, 9.56156104194512e-310, 4.4824924773457e-310,
      2.10140778491263e-310, 9.85147147666e-311, 4.618403479431e-311, 2.165123326942e-311,
      1.0150172114125e-311, 4.75843535859e-312, 2.23077075022e-312, 1.04579294769e-312,
      4.9027130615e-313, 2.2984086302e-313, 1.07750181683e-313, 5.051365323e-314,
      2.3680973184e-314, 1.110172112e-314, 5.20452478e-315, 2.439898993e-315,
      1.14383298e-315, 5.3623281e-316, 2.51387774e-316, 1.1785145e-316, 5.5249163e-317,
      2.5900996e-317, 1.2142474e-317, 5.69243e-318, 2.66863e-318, 1.251063e-318, 5.865e-319,
      2.74952e-319, 1.28897e-319, 6.043e-320, 2.833e-320, 1.328e-320, 6.225e-321, 2.92e-321,
      1.37e-321, 6.4e-322, 3e-322, 1.43e-322, 7e-323, 3.5e-323, 1.5e-323, 5e-324, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_2_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<2>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.018968496019252355), "design.b()[0] == 0.018968496019252355");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.018968496019252355));
    static_assert(almost_equal(design.b()[1], 0.03793699203850471), "design.b()[1] == 0.03793699203850471");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.03793699203850471));
    static_assert(almost_equal(design.b()[2], 0.018968496019252355), "design.b()[2] == 0.018968496019252355");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.018968496019252355));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.6205370655140037), "design.a()[1] == -1.6205370655140037");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.6205370655140037));
    static_assert(almost_equal(design.a()[2], 0.7009068657916182), "design.a()[2] == 0.7009068657916182");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.7009068657916182));
    std::cout << "max_deviation(cheby1,lowpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.018968496019252355, 0.06867614291475799, 0.11696558203551964, 0.1414114809929382,
      0.1471805669282769, 0.13939528610092597, 0.12273535801334748, 0.10119408382263483,
      0.0779627085383632, 0.055413830785505394, 0.035155569039782876, 0.018130968230829027,
      0.004741126340920235, -0.0050249491486917515, -0.011466204351714507,
      -0.01505938779413953, -0.01636755474966585, -0.0159690008441324,
      -0.014406226266879962, -0.012153041308175867, -0.00959703099801807,
      -0.0070341943580255195, -0.004672547765483985, -0.0026417217234986816,
      -0.0010059871601361407, 0.00022136141307930513, 0.0010638276822072035,
      0.0015688184560880062, 0.001796684330674855, 0.0018119979258341312,
      0.0016771014184184805, 0.0014477632241559435, 0.001170662068034391,
      0.0008823540885894968, 0.000609362424459987, 0.0003690463564172021,
      0.00017094699240753657, 1.8358812426356444e-05, -9.006678464914033e-05,
      -0.0001588243805730133, -0.0001942523678855127, -0.00020347206342360952,
      -0.0001935812022273403, -0.00017109054714577144, -0.00014157617947945522,
      -0.00010951090727380452, -7.823476808557077e-05, -5.002539470728062e-05,
      -2.623272024532479e-05, -7.447952872539761e-06, 6.317010036186748e-06,
      1.5457270211320107e-05, 2.062144360347186e-05, 2.2583706886322284e-05,
      2.214402268178104e-05, 2.005613432376025e-05, 1.698081152867547e-05,
      1.3460552235963616e-05, 9.911356433504336e-06, 6.627126990480842e-06,
      3.792567152391359e-06, 1.5009968358001278e-06, -2.2581534845352622e-07,
      -1.4180011298747034e-06, -2.13964786177049e-06, -2.4734919395174107e-06,
      -2.508691492546794e-06, -2.3317400667237476e-06, -2.0203121139908593e-06,
      -1.6396580426210598e-06, -1.2410760010973958e-06, -8.619620812746817e-07,
      -5.269628116348454e-07, -2.498076275842837e-07, -3.5470667056731855e-08,
      1.1761035059699959e-07, 2.154535665048068e-07, 2.6671658819662944e-07,
      2.8121123313756274e-07, 2.6876973865078705e-07, 2.38448439528267e-07,
      1.9803197933217568e-07, 1.53788014262234e-07, 1.1041720338352061e-07,
      7.114409568053428e-08, 3.7899468089761436e-08, 1.1552107679701331e-08,
      -7.843378714199154e-09, -2.080743751229004e-08, -2.822174573524648e-08,
      -3.115030920558452e-08, -3.069941531941221e-08, -2.791607482098988e-08,
      -2.3721602997911906e-08, -1.8875168403540025e-08, -1.3961275606935906e-08,
      -9.395029475881935e-09, -5.4394395691528594e-09, -2.2297727734754547e-09,
      1.9911111298690652e-10, 1.885529984835194e-09, 2.9160128824155553e-09,
      3.403926047443782e-09, 3.4723348781293583e-09, 3.2412122365854033e-09,
      2.8187212101756206e-09, 2.2960542883295654e-09, 1.7451800297058871e-09,
      1.2188087092127398e-09, 7.519160241872477e-10, 3.6423639497552966e-10,
      6.323547481546602e-11, -1.5282035921569642e-10, -2.9197323493395373e-10,
      -3.6604061034147715e-10, -3.8853633154913493e-10, -3.7307714962731537e-10,
      -3.322575668751013e-10, -2.7694336677484734e-10, -2.159153810729033e-10,
      -1.5578737083528376e-10, -1.0112263575354105e-10, -5.4680541579009595e-11,
      -1.773429470456278e-11, 9.586885118439172e-12, 2.796599159565528e-11,
      3.860041235354299e-11, 4.295184344497557e-11, 4.254976029375173e-11,
      3.8848221715770603e-11, 3.313156409203412e-11, 2.646194232521546e-11,
      1.9660417616983713e-11, 1.3313078413881274e-11, 7.794215333714617e-12,
      3.2995867797705645e-12, -1.1591636336069243e-13, -2.5005497915420364e-12,
      -3.97098704642008e-12, -4.682479178254104e-12, -4.804838982052915e-12,
      -4.504437859278727e-12, -3.931863878721632e-12, -3.2145397299239033e-12,
      -2.4534103929550053e-12, -1.722749511637265e-12, -1.0721672491776612e-12,
      -5.299998069768723e-13, -1.073949456957536e-13, 1.9744301342948985e-13,
      3.9523757637873924e-13, 5.021079784903528e-13, 5.366598591312274e-13,
      5.177462638030393e-13, 4.628784311643767e-13, 3.8721974349133606e-13,
      3.0306927639657044e-13, 2.1973001903600408e-13, 1.436573036170884e-13,
      7.879170628043247e-14, 2.6994490056205008e-14, -1.1480076198662273e-14,
      -3.752451241379497e-14, -5.2763399004441774e-14, -5.920385540289086e-14,
      -5.895981347700027e-14, -5.4050174382050626e-14, -4.6264972911785835e-14,
      -3.7089965116936774e-14, -2.7678226071083555e-14, -1.8856980053434332e-14,
      -1.1158576434093547e-14, -4.865899922271953e-15, -6.424834600669036e-17,
      3.3064258376735028e-15, 5.403217731154944e-15, 6.438618035522905e-15,
      6.6468667721183176e-15, 6.25862238644341e-15, 5.483494999707355e-15,
      4.49949549453116e-15, 3.448179931172114e-15, 2.4341761023105945e-15,
      1.5278196095393215e-15, 7.69757564022227e-16, 1.7656140994060764e-16,
      -2.5340405247004266e-16, -5.344037640403799e-16, -6.884084673819629e-16,
      -7.410241702853726e-16, -7.183469131321041e-16, -6.447188699575879e-16,
      -5.412965421680673e-16, -4.253032275592301e-16, -3.0982118150760875e-16,
      -2.0397875607482238e-16, -1.1339934151033531e-16, -4.0797725513902384e-17,
      1.3368150656897316e-17, 5.0258989558253534e-17, 7.207672687607507e-17,
      8.157613661447989e-17, 8.167808031397044e-17, 7.518508235097481e-17,
      6.459148544673634e-17, 5.197515585813812e-17, 3.8955050932683246e-17,
      2.66983603338406e-17, 1.5961819853457652e-17, 7.153656642217951e-18,
      4.050166168572101e-19, -4.357702616280183e-18, -7.345697537684295e-18,
      -8.849631449043473e-18, -9.192505941121844e-18, -8.694029160185639e-18,
      -7.645905974777871e-18, -6.296769301795867e-18, -4.845080053631971e-18,
      -3.4381829763585687e-18, -2.1757530763076477e-18, -1.1160424515850795e-18,
      -2.835878900294744e-19, 3.226771297072195e-19, 7.216789480612361e-19,
      9.433408690886659e-19, 1.0228891141789838e-18, 9.96435631511751e-19,
      8.978108711920897e-19, 7.56527219142207e-19, 5.966985958892919e-19,
      4.367170695237464e-19, 2.894860556388642e-19, 1.6302489067463933e-19,
      6.128511399140695e-20, -1.4950466381456823e-20, -6.71829420852709e-20,
      -9.839356328591231e-20, -1.1236143094117171e-19, -1.1312113951756275e-19,
      -1.0456210108455332e-19, -9.01593771015094e-20, -7.281831784488987e-20,
      -5.48114566900803e-20, -3.7785138248211004e-20, -2.2814490738679605e-20,
      -1.0487865049799692e-20, -1.0051408530294526e-21, 5.722148612503965e-21,
      9.97746404591819e-21, 1.2158157056659731e-20, 1.2709471105684659e-20,
      1.2074433253455621e-20, 1.0658911073745108e-20, 8.810107305131945e-21,
      6.806201485671755e-21, 4.854637084359687e-21, 3.0966059835552597e-21,
      1.615516310289438e-21, 4.47571666241168e-22, -4.0701999906253398e-22,
      -9.732970486885406e-22, -1.2919808312977398e-21, -1.4115122411710653e-21,
      -1.3818496701167047e-21, -1.2499999884067044e-21, -1.0571233918284582e-21,
      -8.369740651661977e-22, -6.154024521542671e-22, -4.106416151596887e-22,
      -2.3412015406888916e-22, -9.157886000729881e-23, 1.5689486347730086e-23,
      8.961364590585771e-23, 1.3422536606442179e-22, 1.547063611555464e-22,
      1.566279118854123e-22, 1.4538658598881181e-22, 1.2582277260831836e-22,
      1.019980103839583e-22, 7.710151124177877e-23, 5.345475099924598e-23,
      3.2584426729827475e-23, 1.533746928965781e-23, 2.0162890622532137e-24,
      -7.482666368817448e-24, -1.3539169046697573e-23, -1.6696073044101128e-23,
      -1.7566908674551417e-23, -1.6765434405241207e-23, -1.4856240972409673e-23,
      -1.2324081067385103e-23, -9.558788870680258e-24, -6.852338631657389e-24,
      -4.404647989942007e-24, -2.335044134584967e-24, -6.967775521604057e-25,
      5.074946161629964e-25, 1.3107900062796435e-24, 1.76847732946057e-24,
      1.947141346899633e-24, 1.9158768222299766e-24, 1.739984664674169e-24,
      1.4768584238184272e-24, 1.1737366184720993e-24, 8.669434863285823e-25,
      5.82233998783269e-25, 3.358851340096976e-25, 1.3622250217335128e-25,
      -1.467058261575715e-26, -1.192535099501354e-25, -1.829720209862901e-25,
      -2.129273380664903e-25, -2.168102978409196e-25, -2.0210689067080492e-25,
      -1.755578811967996e-25, -1.4283994632755456e-25, -1.08427703185167e-25,
      -7.559361284982467e-26, -4.6504529934757305e-26, -2.2378232217144136e-26,
      -3.669410446878465e-27, 9.738640967524654e-27, 1.8353743631231465e-26,
      2.2917041527734616e-26, 2.4273650303508295e-26, 2.327363828173961e-26,
      2.0702225329370925e-26, 1.7236070621246505e-26, 1.3421359435025718e-26,
      9.668930196344387e-27, 6.261736790777034e-27, 3.37035700446921e-27,
      1.0728941413215048e-27, -6.236416412170225e-28, -1.762633265110016e-27,
      -2.4192978308961882e-27, -2.6851200500965952e-27, -2.6556341064664433e-27,
      -2.4215344233845955e-27, -2.062834110260098e-27, -1.6456290325820793e-27,
      -1.2209482525147648e-27, -8.251592107919299e-28, -4.814300730747282e-28,
      -2.0181552165545558e-28, 1.0388110377927642e-29, 1.5828820265970825e-28,
      2.4923080155715886e-28, 2.929424637731366e-28, 3.000365406292001e-28,
      2.8089495095771318e-28, 2.449030082273403e-28, 1.999932025958249e-28,
      1.5244219773782174e-28, 1.0686162297148738e-28, 6.632543787547526e-29,
      3.258278523330321e-29, 6.313656384694149e-30, -1.2605983686319962e-29,
      -2.485374891922757e-29, -3.144080082478809e-29, -3.3530819847864744e-29,
      -3.2300863236456697e-29, -2.884276427578644e-29, -2.4100871767366523e-29,
      -1.884026450090952e-29, -1.3638880454501004e-29, -8.897040566615779e-30,
      -4.8583990593117226e-30, -1.6372189363054672e-30, 7.5211128678270555e-31,
      2.366362210883359e-30, 3.307617708422781e-30, 3.701517574491629e-30,
      3.68011446686771e-30, 3.369342817083912e-30, 2.8807274247812096e-30,
      2.3067300538008676e-30, 1.7190199218160606e-30, 1.168932567423014e-30,
      6.894256869619938e-31, 2.979270174851514e-31, -4.2142279203777995e-34,
      -2.0950202331491174e-31, -3.392104159536531e-31, -4.028616455226602e-31,
      -4.150973193534885e-31, -3.903120984968899e-31, -3.4157066162620663e-31,
      -2.799554880194051e-31, -2.142690231427137e-31, -1.5100817032540125e-31,
      -9.453170776057342e-32, -4.7349472920643184e-32, -1.0473652896061175e-32,
      1.621462793229789e-32, 3.3617460792574965e-32, 4.3113397218827366e-32,
      4.6304149133341774e-32, 4.4819113839391117e-32, 4.01761391780267e-32,
      3.3692898078516214e-32, 2.644085838994255e-32, 1.9232807473259584e-32,
      1.2634898201377245e-32, 6.994914047872056e-33, 2.4796305867377835e-33,
      -8.844500071849498e-34, -3.171274122108749e-33, -4.519250177297233e-33,
      -5.10084461514759e-33, -5.098534286776565e-33, -4.687146779422278e-33,
      -4.0220974004827264e-33, -3.232704559919634e-33, -2.4196018783249397e-33,
      -1.6552297064893258e-33, -9.864455223055719e-34, -4.384096662658868e-34,
      -1.9052674750119722e-35, 2.764087794854203e-34, 4.612848229336639e-34,
      5.5379234201665395e-34, 5.741233173561199e-34, 5.422312612091588e-34,
      4.762988819238828e-34, 3.918063785921823e-34, 3.01095602504123e-34,
      2.133168033049917e-34, 1.346478113978954e-34, 6.868655713543958e-35,
      1.6933536267925424e-35, -2.070145631141905e-35, -4.541630909509368e-35,
      -5.908901940688123e-35, -6.392334325006185e-35, -6.21742476931224e-35,
      -5.595136273883073e-35, -4.709290010075615e-35, -3.7099095841779717e-35,
      -2.71127228980017e-35, -1.7934161413057328e-35, -1.0059479679255388e-35,
      -3.731582813391287e-36, 1.0035901113457615e-36, 4.2418469881950886e-36,
      6.170647071126266e-36, 7.026622619302104e-36, 7.061853501428814e-36,
      6.518987313099714e-36, 5.6145589661275945e-36, 4.5293979453637075e-36,
      3.40477432717414e-36, 2.3428768790883256e-36, 1.4102891201110105e-36,
      6.432873019735768e-37, 5.39895895856537e-38, -3.6339235555440535e-37,
      -6.267324555222138e-37, -7.609389773500828e-37, -7.938487363001703e-37,
      -7.531139479127524e-37, -6.640350374754088e-37, -5.482306542134011e-37,
      -4.2300137871109906e-37, -3.012307833892588e-37, -1.916710791781842e-37,
      -9.947536392999764e-38, -2.685993898437776e-38, 2.6195438854026507e-38,
      6.127699525924995e-38, 8.094107913572872e-38, 8.821855216986186e-38,
      8.622927556642702e-38, 7.790474828176378e-38, 6.580884089339047e-38,
      5.204169295779694e-38, 3.8209623978243445e-38, 2.5443732014556965e-38,
      1.445112302892798e-38, 5.5848940463158114e-39, -1.0783635403517318e-39,
      -5.662018669020371e-39, -8.419678709527892e-39, -9.675853669152366e-39,
      -9.778668896083469e-39, -9.064823128388251e-39, -7.835945704313919e-39,
      -6.344843689321961e-39, -4.7897862293148915e-39, -3.3148816162729556e-39,
      -2.0146944731603398e-39, -9.414637853104075e-40, -1.135637712241245e-40,
      4.758441304499843e-40, 8.507206777576577e-40, 1.0451019726264426e-39,
      1.097350519971711e-39, 1.045778043408985e-39, 9.255815680167986e-40,
      7.669462274083106e-40, 5.9411831289815365e-40, 4.252328708686398e-40,
      2.72684024114712e-40, 1.4384592949929493e-40, 4.1981555783232867e-41,
      -3.2789932387560254e-41, -8.256246149482121e-41, -1.1081284033314655e-40,
      -1.2170771897637286e-40, -1.1956238915300151e-40, -1.0844950741347186e-40,
      -9.19443470524788e-41, -7.298621802520372e-41, -5.383244746171919e-41,
      -3.608093511702194e-41, -2.0738960687254348e-41, -8.318879346230865e-42,
      1.0550276109730111e-42, 7.540470998187755e-42, 1.1480136647865924e-41,
      1.3318819061100041e-41, 1.353713336067184e-41, 1.2602174647613577e-41,
      1.0934021406907024e-41, 8.886036230598984e-42, 6.736420402372333e-42,
      4.688335147229226e-42, 2.8760175707555104e-42, 1.374606780653727e-42,
      2.1178077707637384e-43, -6.2027273130828785e-43, -1.1536135525082033e-42,
      -1.4347201050815305e-42, -1.516441449499507e-42, -1.4518444044548167e-42,
      -1.289883447252937e-42, -1.0726962253228378e-42, -8.34255828922076e-43,
      -6.000823436518039e-43, -3.877200419300996e-43, -2.0771286428449545e-43,
      -6.485075616328384e-44, 4.0494318601033276e-44, 1.1107688448233135e-43,
      1.5162146249241777e-43, 1.6785364893199578e-43, 1.6574053561377229e-43,
      1.5093890623564998e-43, 1.2843341283134035e-43, 1.0233699024800452e-43,
      7.582102501950067e-44, 5.114208230008923e-44, 2.973416296733618e-44,
      1.2339476585589593e-44, -8.442997963826878e-46, -1.0017042973558732e-44,
      -1.5641213901427447e-44, -1.8326152681799075e-44, -1.8735175476298463e-44,
      -1.7516120050032186e-44, -1.525390866192182e-44, -1.2442355575511646e-44,
      -9.471729081122206e-45, -6.628355600968697e-45, -4.102695990900434e-45,
      -2.0027109721625704e-45, -3.698595736231689e-46, 8.043427224934013e-46,
      1.5627043097082406e-45, 1.9686509196755317e-45, 2.094961604515774e-45,
      2.0151219849989375e-45, 1.7972068960480015e-45, 1.50002755474977e-45,
      1.1711755990762516e-45, 8.465538565279076e-46, 5.50986884017142e-46,
      2.995392578590611e-46, 9.92239799684205e-47, -4.915298508089738e-47,
      -1.4920100301528696e-46, -2.073340908807852e-46, -2.3141657182055088e-46,
      -2.296972443983805e-46, -2.1003143434702127e-46, -1.793673486301788e-46,
      -1.4345896243228849e-46, -1.0676075984797337e-46, -7.24583967479472e-47,
      -4.259216806319313e-47, -1.8235599282117007e-47, 3.0167847591139248e-49,
      1.32703378907427e-47, 2.1293625908815618e-47, 2.52058391054288e-47,
      2.592214794064255e-47, 2.434085586851485e-47, 2.127624767359995e-47,
      1.741827497263855e-47, 1.331429213776654e-47, 9.367715391763688e-48,
      5.848651239023162e-48, 2.912060081232449e-48, 6.1974148958891476e-49,
      -1.0367688496178234e-48, -2.114503414244792e-48, -2.6999527530035867e-48,
      -2.893303550594895e-48, -2.7962902236291034e-48, -2.5035556298941762e-48,
      -2.0971656773321532e-48, -1.6437753827564477e-48, -1.1938811131916562e-48,
      -7.825951441509592e-49, -4.314249692129321e-49, -1.5061384392720588e-49,
      5.831340633170323e-50, 2.0006531366874988e-49, 2.833409894583074e-49,
      3.1893742363941923e-49, 3.1825427171570292e-49, 2.9219741358670265e-49,
      2.504501350515294e-49, 2.0106055356451837e-49, 1.5028386026801078e-49,
      1.0261584347960443e-49, 6.095778838816554e-50, 2.6860206280928596e-50,
      8.022274608590232e-52, -1.7526463663586767e-50, -2.896457072946938e-50,
      -3.465374173895183e-50, -3.5856206457729112e-50, -3.3817266083271697e-50,
      -2.967027185482727e-50, -2.437902130455736e-50, -1.8711010392038514e-50,
      -1.3234462459871735e-50, -8.332261308697674e-51, -4.226612687107274e-51,
      -1.009243362193026e-51, 1.3269455748776759e-51, 2.8577500898247707e-51,
      3.7010246805734454e-51, 3.994631016576599e-51, 3.879374016336104e-51,
      3.486805078641895e-51, 2.9314169871380805e-51, 2.3065442628374594e-51,
      1.683190178393517e-51, 1.1109993623207803e-51, 6.206560939342118e-52,
      2.2708912421678684e-52, -6.7015774565479735e-53, -2.6776987296764207e-52,
      -3.8695918766275216e-52, -4.393999640335093e-52, -4.408415768878517e-52,
      -4.064216637467284e-52, -3.496324823623435e-52, -2.817286624493145e-52,
      -2.11491932525264e-52, -1.452649619133632e-52, -8.717110753458994e-53,
      -3.9446801637675834e-53, -2.826176400178643e-54, 2.306861049119661e-53,
      3.9364424793712766e-53, 4.762256196329771e-53, 4.958333121041021e-53,
      4.697264541146494e-53, 4.136761568032888e-53, 3.411430484862032e-53,
      2.6288649619661806e-53, 1.8690780620866303e-53, 1.1863207768693513e-53,
      6.1242714408914e-54, 1.6096050938436213e-54, -1.6841191854785743e-54,
      -3.8573608242994386e-54, -5.0705854909255697e-54, -5.513421046315314e-54,
      -5.380694979165872e-54, -4.855220986600984e-54, -4.0966995164205175e-54,
      -3.2357956881885594e-54, -2.3723220309956115e-54, -1.5764443684135743e-54,
      -8.919097313414703e-55, -3.4043209737188416e-55, 7.346282228178347e-56,
      3.576604208286925e-55, 5.281113723025014e-55, 6.0513740895491906e-55,
      6.104907141910954e-55, 5.65177865814933e-55, 4.879945470826316e-55,
      3.9467620477298265e-55, 2.9754869019192578e-55, 2.0555741956119663e-55,
      1.2455949762750855e-55, 5.777667608233021e-56, 6.324638026936983e-57,
      -3.024675860011288e-56, -5.344897563986426e-56, -6.541588536739431e-56,
      -6.854611291576782e-56, -6.523107349106581e-56, -5.766493124955092e-56,
      -4.772725119736837e-56, -3.692603337222117e-56, -2.6387647712494747e-56,
      -1.6880450872783313e-56, -8.860112868155515e-57, -2.526517393091663e-57,
      2.115798858808013e-57, 5.199583861230503e-57, 6.943140425599845e-57,
      7.607192383157471e-57, 7.461242426944218e-57, 6.759286536895991e-57,
      5.724038325088823e-57, 4.538385928665884e-57, 3.342604852901148e-57,
      2.2358292024793067e-57, 1.280389403749534e-57, 5.078104483123508e-58,
      -7.450807022943715e-59, -4.7667091922956975e-58, -7.202396746834531e-58,
      -8.330731688670764e-58, -8.452050154331502e-58, -7.857793517020414e-58,
      -6.809745664301167e-58, -5.527863829670847e-58, -4.1851107386924055e-58,
      -2.90760936395429e-58, -1.778515895475786e-58, -8.44187563988779e-59,
      -1.214632356312847e-59, 3.948611841778782e-59, 7.2502160048823585e-59,
      8.981634618645886e-59, 9.47334563212507e-59, 9.056618361043282e-59,
      8.036652746711827e-59, 6.675847668601772e-59, 5.185513502541031e-59,
      3.724169368689136e-59, 2.400592483626482e-59, 1.2799532190259811e-59,
      3.91619879814012e-60, -2.6249346827664717e-60, -6.998694573397604e-60,
      -9.501809224996971e-60, -1.049260096047756e-59, -1.034376544685921e-59,
      -9.408119250407922e-60, -7.996189742220135e-60, -6.363906483353392e-60,
      -4.7083620472444466e-60, -3.1695694679808375e-60, -1.8362815190381364e-60,
      -7.541892626084032e-61, 6.487066975050003e-62, 6.337417570639509e-61,
      9.815337094694774e-61, 1.1464178085817745e-60, 1.1698488353990316e-60,
      1.0922512857117746e-60, 9.500786126817468e-61, 7.740711816777886e-61,
      5.884944185846688e-61, 4.111252123151758e-61, 2.537638666580159e-61,
      1.2307326779572453e-61, 2.15799558064705e-62, -5.129178013689419e-62,
      -9.824577005626685e-62, -1.2326015104952296e-61, -1.3088650870918477e-61,
      -1.2571255258983278e-61, -1.1198259847844044e-61, -9.335916030048114e-62,
      -7.2802607549468256e-62, -5.2543247560835425e-62, -3.4120432735857073e-62,
      -1.8465502973455523e-62, -6.008786433500415e-63, 3.2051366801453976e-63,
      9.40564245653009e-63, 1.2995689920864735e-62, 1.446751783372497e-62,
      1.4336380604303155e-62, 1.3092253573968805e-62, 1.1168014591566765e-62,
      8.921731175155592e-63, 6.630257953401327e-63, 4.4912761319921924e-63,
      2.6310861218432393e-63, 1.1158063059271133e-63, -3.5940850599823774e-65,
      -8.403197812810121e-64, -1.3365781635026936e-63, -1.576988550752379e-63,
      -1.618751586919252e-63, -1.517924843965145e-63, -1.325259371027297e-63,
      -1.0837079872786692e-63, -8.273055694709477e-64, -5.811009710370064e-64,
      -3.618315086218166e-64, -1.790637108744895e-64, -3.6569191907822844e-65,
      6.624525342353325e-65, 1.3298448627184841e-64, 1.6907453619120837e-64,
      1.807818132607323e-64, 1.7445812591289635e-64, 1.560046452972521e-64,
      1.3053241185107428e-64, 1.0218788467137518e-64, 7.4108191081676626e-65,
      4.847088053916237e-65, 2.66059185712697e-65, 9.142304245925691e-66,
      -3.8328281025670196e-66, -1.2619143821078744e-65, -1.7763334764621835e-65,
      -1.9941297848597183e-65, -1.9865169002228012e-65, -1.821525010593294e-65,
      -1.5594854610499767e-65, -1.2504846066256923e-65, -9.334025881394967e-66,
      -6.361402447760777e-66, -3.766605629501456e-66, -1.6451733820816817e-66,
      -2.602469841346695e-68, 1.110939330520821e-66, 1.8185592524444584e-66,
      2.1683776701796953e-66, 2.2392957206719017e-66, 2.1090309193375286e-66,
      1.8482250319448144e-66, 1.516882918146893e-66, 1.1627313784840313e-66,
      8.210556441383817e-67, 5.1558469792491296e-67, 2.6004057522561107e-67,
      6.002853601801628e-68, -8.498575695429482e-68, -1.7979698222364632e-67,
      -2.3180057341721828e-67, -2.4962048174083507e-67, -2.4204862956992243e-67,
      -2.172880663805656e-67, -1.8246981914256304e-67, -1.4340040767743677e-67,
      -1.044913268143279e-67, -6.8821737828923146e-68, -3.828948868501896e-68,
      -1.3811907073649314e-68, 4.4546581486964986e-69, 1.6899799141753289e-68,
      2.4264450427776997e-68, 2.7476256043585574e-68, 2.751917144069431e-68,
      2.5337540824681964e-68, 2.1772047851692116e-68, 1.7523154209516603e-68,
      1.3136743079644742e-68, 9.006479984923403e-69, 5.387701226714852e-69,
      2.418265877759082e-69, 1.4261270853798495e-70, -1.4638699768317848e-69,
      -2.4722137831124453e-69, -2.9802775520207006e-69, -3.0968586242807006e-69,
      -2.9296771891276353e-69, -2.577041002827885e-69, -2.122759608019317e-69,
      -1.6337448936626993e-69, -1.159687372088775e-69, -7.34213357958207e-70,
      -3.769871192979141e-70, -9.63064164947929e-71, 1.081647426542707e-70,
      2.427868031940167e-70, 3.176316028305959e-70, 3.445628482833187e-70,
      3.3574669582583516e-70, 3.025834991511279e-70, 2.5502061151614993e-70,
      2.0118750140169052e-70, 1.4728610560954354e-70, 9.766889233156964e-71,
      5.504221751356659e-71, 2.074115643935921e-71, -4.967655372048422e-72,
      -2.2587888611909127e-71, -3.3122646970145046e-71, -3.784447091123175e-71,
      -3.811247716185096e-71, -3.523723240540193e-71, -3.038994428401741e-71,
      -2.4550013006714528e-71, -1.848368543653924e-71, -1.2746224685533483e-71,
      -7.700387520673689e-72, -3.5448470010601657e-72, -3.4730147429787293e-73,
      1.9217926892165358e-72, 3.357762272944161e-72, 4.0943805299905534e-72,
      4.2816167783659306e-72, 4.0687392650347444e-72, 3.5925281922557394e-72,
      2.9700178084756493e-72, 2.2949962683694623e-72, 1.6374206446250797e-72,
      1.0449222049864755e-72, 5.4565579175254953e-73, 1.5186228785425956e-73,
      -1.3635542447673869e-73, -3.2741033966032404e-73, -4.350081378484081e-73,
      -4.754626561844835e-73, -4.6560466712152066e-73, -4.212745807995094e-73,
      -3.5634556501438433e-73, -2.8219695017147803e-73, -2.075455644149131e-73,
      -1.3854150003674675e-73, -7.904152485844867e-74, -3.0985032175037067e-74,
      5.188354340133983e-75, 3.0125542305465247e-74, 4.518300474555697e-74,
      5.210553448387375e-74, 5.276987170627935e-74, 4.899440617695535e-74,
      4.2410485826730355e-74, 3.438724857386158e-74, 2.6000010197472836e-74,
      1.803172160764419e-74, 1.0997487562156366e-74, 5.183278745162742e-75,
      6.914807886538148e-76, -2.5124254116919674e-75, -4.556142136316575e-75,
      -5.622420986806933e-75, -5.917910302177677e-75, -5.649399523042237e-75,
      -5.007157363051795e-75, -4.1545811863865955e-75, -3.223101830364564e-75,
      -2.311181504004753e-75, -1.486261090322049e-75, -7.886182016506071e-76,
      -2.3625442374814503e-76, 1.6988886144962845e-76, 4.409035446758132e-76,
      5.954242670520992e-76, 6.558747728492964e-76, 6.455324229021041e-76,
      5.864020869143308e-76, 4.978282098362541e-76, 3.957358174653451e-76,
      2.923733500950948e-76, 1.9642789929648448e-76, 1.1339220305485673e-76,
      4.607860474075502e-77, -4.805286738823598e-78, -4.008395569957995e-77,
      -6.158947747625173e-77, -7.171291133798315e-77, -7.304494327549807e-77,
      -6.810796610361453e-77, -5.9173781274522835e-77, -4.81559648048565e-77,
      -3.6563216321693255e-77, -2.5499200923167065e-77, -1.5694990881682167e-77,
      -7.5617494674225e-78, -1.253368424581066e-78, 3.2689521303340322e-78,
      6.175952626752556e-78, 7.71712915441583e-78, 8.177126235194948e-78,
      7.842347344989675e-78, 6.9774106324982e-78, 5.81039745324891e-78,
      4.525449420592603e-78, 3.261111056218891e-78, 2.1128327716741785e-78,
      1.1381886903179155e-78, 3.635779642730555e-79, -2.0857270030158438e-79,
      -5.928340831025855e-79, -8.145195677096709e-79, -9.04437670938084e-79,
      -8.947724118729935e-79, -8.160852853984649e-79, -6.953443268060796e-79,
      -5.548314752768382e-79, -4.11753358052301e-79, -2.783763881947842e-79,
      -1.6251849956195058e-79, -6.825133061186525e-80, 3.3065211339450585e-81,
      5.319616628073336e-80, 8.388879583650745e-80, 9.865934485443857e-80,
      1.010828922311466e-79, 9.465756136695162e-80, 8.254639354742663e-80,
      6.7423355706923006e-80, 5.14047130206756e-80, 3.604574986242231e-80,
      2.238355741606233e-80
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.018968496019252355, 0.06867614291475799, 0.11696558203551964, 0.1414114809929382,
      0.1471805669282769, 0.13939528610092597, 0.12273535801334748, 0.10119408382263483,
      0.0779627085383632, 0.055413830785505394, 0.035155569039782876, 0.018130968230829027,
      0.004741126340920235, -0.0050249491486917515, -0.011466204351714507,
      -0.01505938779413953, -0.01636755474966585, -0.0159690008441324,
      -0.014406226266879962, -0.012153041308175867, -0.00959703099801807,
      -0.0070341943580255195, -0.004672547765483985, -0.0026417217234986816,
      -0.0010059871601361407, 0.00022136141307930513, 0.0010638276822072035,
      0.0015688184560880062, 0.001796684330674855, 0.0018119979258341312,
      0.0016771014184184805, 0.0014477632241559435, 0.001170662068034391,
      0.0008823540885894968, 0.000609362424459987, 0.0003690463564172021,
      0.00017094699240753657, 1.8358812426356444e-05, -9.006678464914033e-05,
      -0.0001588243805730133, -0.0001942523678855127, -0.00020347206342360952,
      -0.0001935812022273403, -0.00017109054714577144, -0.00014157617947945522,
      -0.00010951090727380452, -7.823476808557077e-05, -5.002539470728062e-05,
      -2.623272024532479e-05, -7.447952872539761e-06, 6.317010036186748e-06,
      1.5457270211320107e-05, 2.062144360347186e-05, 2.2583706886322284e-05,
      2.214402268178104e-05, 2.005613432376025e-05, 1.698081152867547e-05,
      1.3460552235963616e-05, 9.911356433504336e-06, 6.627126990480842e-06,
      3.792567152391359e-06, 1.5009968358001278e-06, -2.2581534845352622e-07,
      -1.4180011298747034e-06, -2.13964786177049e-06, -2.4734919395174107e-06,
      -2.508691492546794e-06, -2.3317400667237476e-06, -2.0203121139908593e-06,
      -1.6396580426210598e-06, -1.2410760010973958e-06, -8.619620812746817e-07,
      -5.269628116348454e-07, -2.498076275842837e-07, -3.5470667056731855e-08,
      1.1761035059699959e-07, 2.154535665048068e-07, 2.6671658819662944e-07,
      2.8121123313756274e-07, 2.6876973865078705e-07, 2.38448439528267e-07,
      1.9803197933217568e-07, 1.53788014262234e-07, 1.1041720338352061e-07,
      7.114409568053428e-08, 3.7899468089761436e-08, 1.1552107679701331e-08,
      -7.843378714199154e-09, -2.080743751229004e-08, -2.822174573524648e-08,
      -3.115030920558452e-08, -3.069941531941221e-08, -2.791607482098988e-08,
      -2.3721602997911906e-08, -1.8875168403540025e-08, -1.3961275606935906e-08,
      -9.395029475881935e-09, -5.4394395691528594e-09, -2.2297727734754547e-09,
      1.9911111298690652e-10, 1.885529984835194e-09, 2.9160128824155553e-09,
      3.403926047443782e-09, 3.4723348781293583e-09, 3.2412122365854033e-09,
      2.8187212101756206e-09, 2.2960542883295654e-09, 1.7451800297058871e-09,
      1.2188087092127398e-09, 7.519160241872477e-10, 3.6423639497552966e-10,
      6.323547481546602e-11, -1.5282035921569642e-10, -2.9197323493395373e-10,
      -3.6604061034147715e-10, -3.8853633154913493e-10, -3.7307714962731537e-10,
      -3.322575668751013e-10, -2.7694336677484734e-10, -2.159153810729033e-10,
      -1.5578737083528376e-10, -1.0112263575354105e-10, -5.4680541579009595e-11,
      -1.773429470456278e-11, 9.586885118439172e-12, 2.796599159565528e-11,
      3.860041235354299e-11, 4.295184344497557e-11, 4.254976029375173e-11,
      3.8848221715770603e-11, 3.313156409203412e-11, 2.646194232521546e-11,
      1.9660417616983713e-11, 1.3313078413881274e-11, 7.794215333714617e-12,
      3.2995867797705645e-12, -1.1591636336069243e-13, -2.5005497915420364e-12,
      -3.97098704642008e-12, -4.682479178254104e-12, -4.804838982052915e-12,
      -4.504437859278727e-12, -3.931863878721632e-12, -3.2145397299239033e-12,
      -2.4534103929550053e-12, -1.722749511637265e-12, -1.0721672491776612e-12,
      -5.299998069768723e-13, -1.073949456957536e-13, 1.9744301342948985e-13,
      3.9523757637873924e-13, 5.021079784903528e-13, 5.366598591312274e-13,
      5.177462638030393e-13, 4.628784311643767e-13, 3.8721974349133606e-13,
      3.0306927639657044e-13, 2.1973001903600408e-13, 1.436573036170884e-13,
      7.879170628043247e-14, 2.6994490056205008e-14, -1.1480076198662273e-14,
      -3.752451241379497e-14, -5.2763399004441774e-14, -5.920385540289086e-14,
      -5.895981347700027e-14, -5.4050174382050626e-14, -4.6264972911785835e-14,
      -3.7089965116936774e-14, -2.7678226071083555e-14, -1.8856980053434332e-14,
      -1.1158576434093547e-14, -4.865899922271953e-15, -6.424834600669036e-17,
      3.3064258376735028e-15, 5.403217731154944e-15, 6.438618035522905e-15,
      6.6468667721183176e-15, 6.25862238644341e-15, 5.483494999707355e-15,
      4.49949549453116e-15, 3.448179931172114e-15, 2.4341761023105945e-15,
      1.5278196095393215e-15, 7.69757564022227e-16, 1.7656140994060764e-16,
      -2.5340405247004266e-16, -5.344037640403799e-16, -6.884084673819629e-16,
      -7.410241702853726e-16, -7.183469131321041e-16, -6.447188699575879e-16,
      -5.412965421680673e-16, -4.253032275592301e-16, -3.0982118150760875e-16,
      -2.0397875607482238e-16, -1.1339934151033531e-16, -4.0797725513902384e-17,
      1.3368150656897316e-17, 5.0258989558253534e-17, 7.207672687607507e-17,
      8.157613661447989e-17, 8.167808031397044e-17, 7.518508235097481e-17,
      6.459148544673634e-17, 5.197515585813812e-17, 3.8955050932683246e-17,
      2.66983603338406e-17, 1.5961819853457652e-17, 7.153656642217951e-18,
      4.050166168572101e-19, -4.357702616280183e-18, -7.345697537684295e-18,
      -8.849631449043473e-18, -9.192505941121844e-18, -8.694029160185639e-18,
      -7.645905974777871e-18, -6.296769301795867e-18, -4.845080053631971e-18,
      -3.4381829763585687e-18, -2.1757530763076477e-18, -1.1160424515850795e-18,
      -2.835878900294744e-19, 3.226771297072195e-19, 7.216789480612361e-19,
      9.433408690886659e-19, 1.0228891141789838e-18, 9.96435631511751e-19,
      8.978108711920897e-19, 7.56527219142207e-19, 5.966985958892919e-19,
      4.367170695237464e-19, 2.894860556388642e-19, 1.6302489067463933e-19,
      6.128511399140695e-20, -1.4950466381456823e-20, -6.71829420852709e-20,
      -9.839356328591231e-20, -1.1236143094117171e-19, -1.1312113951756275e-19,
      -1.0456210108455332e-19, -9.01593771015094e-20, -7.281831784488987e-20,
      -5.48114566900803e-20, -3.7785138248211004e-20, -2.2814490738679605e-20,
      -1.0487865049799692e-20, -1.0051408530294526e-21, 5.722148612503965e-21,
      9.97746404591819e-21, 1.2158157056659731e-20, 1.2709471105684659e-20,
      1.2074433253455621e-20, 1.0658911073745108e-20, 8.810107305131945e-21,
      6.806201485671755e-21, 4.854637084359687e-21, 3.0966059835552597e-21,
      1.615516310289438e-21, 4.47571666241168e-22, -4.0701999906253398e-22,
      -9.732970486885406e-22, -1.2919808312977398e-21, -1.4115122411710653e-21,
      -1.3818496701167047e-21, -1.2499999884067044e-21, -1.0571233918284582e-21,
      -8.369740651661977e-22, -6.154024521542671e-22, -4.106416151596887e-22,
      -2.3412015406888916e-22, -9.157886000729881e-23, 1.5689486347730086e-23,
      8.961364590585771e-23, 1.3422536606442179e-22, 1.547063611555464e-22,
      1.566279118854123e-22, 1.4538658598881181e-22, 1.2582277260831836e-22,
      1.019980103839583e-22, 7.710151124177877e-23, 5.345475099924598e-23,
      3.2584426729827475e-23, 1.533746928965781e-23, 2.0162890622532137e-24,
      -7.482666368817448e-24, -1.3539169046697573e-23, -1.6696073044101128e-23,
      -1.7566908674551417e-23, -1.6765434405241207e-23, -1.4856240972409673e-23,
      -1.2324081067385103e-23, -9.558788870680258e-24, -6.852338631657389e-24,
      -4.404647989942007e-24, -2.335044134584967e-24, -6.967775521604057e-25,
      5.074946161629964e-25, 1.3107900062796435e-24, 1.76847732946057e-24,
      1.947141346899633e-24, 1.9158768222299766e-24, 1.739984664674169e-24,
      1.4768584238184272e-24, 1.1737366184720993e-24, 8.669434863285823e-25,
      5.82233998783269e-25, 3.358851340096976e-25, 1.3622250217335128e-25,
      -1.467058261575715e-26, -1.192535099501354e-25, -1.829720209862901e-25,
      -2.129273380664903e-25, -2.168102978409196e-25, -2.0210689067080492e-25,
      -1.755578811967996e-25, -1.4283994632755456e-25, -1.08427703185167e-25,
      -7.559361284982467e-26, -4.6504529934757305e-26, -2.2378232217144136e-26,
      -3.669410446878465e-27, 9.738640967524654e-27, 1.8353743631231465e-26,
      2.2917041527734616e-26, 2.4273650303508295e-26, 2.327363828173961e-26,
      2.0702225329370925e-26, 1.7236070621246505e-26, 1.3421359435025718e-26,
      9.668930196344387e-27, 6.261736790777034e-27, 3.37035700446921e-27,
      1.0728941413215048e-27, -6.236416412170225e-28, -1.762633265110016e-27,
      -2.4192978308961882e-27, -2.6851200500965952e-27, -2.6556341064664433e-27,
      -2.4215344233845955e-27, -2.062834110260098e-27, -1.6456290325820793e-27,
      -1.2209482525147648e-27, -8.251592107919299e-28, -4.814300730747282e-28,
      -2.0181552165545558e-28, 1.0388110377927642e-29, 1.5828820265970825e-28,
      2.4923080155715886e-28, 2.929424637731366e-28, 3.000365406292001e-28,
      2.8089495095771318e-28, 2.449030082273403e-28, 1.999932025958249e-28,
      1.5244219773782174e-28, 1.0686162297148738e-28, 6.632543787547526e-29,
      3.258278523330321e-29, 6.313656384694149e-30, -1.2605983686319962e-29,
      -2.485374891922757e-29, -3.144080082478809e-29, -3.3530819847864744e-29,
      -3.2300863236456697e-29, -2.884276427578644e-29, -2.4100871767366523e-29,
      -1.884026450090952e-29, -1.3638880454501004e-29, -8.897040566615779e-30,
      -4.8583990593117226e-30, -1.6372189363054672e-30, 7.5211128678270555e-31,
      2.366362210883359e-30, 3.307617708422781e-30, 3.701517574491629e-30,
      3.68011446686771e-30, 3.369342817083912e-30, 2.8807274247812096e-30,
      2.3067300538008676e-30, 1.7190199218160606e-30, 1.168932567423014e-30,
      6.894256869619938e-31, 2.979270174851514e-31, -4.2142279203777995e-34,
      -2.0950202331491174e-31, -3.392104159536531e-31, -4.028616455226602e-31,
      -4.150973193534885e-31, -3.903120984968899e-31, -3.4157066162620663e-31,
      -2.799554880194051e-31, -2.142690231427137e-31, -1.5100817032540125e-31,
      -9.453170776057342e-32, -4.7349472920643184e-32, -1.0473652896061175e-32,
      1.621462793229789e-32, 3.3617460792574965e-32, 4.3113397218827366e-32,
      4.6304149133341774e-32, 4.4819113839391117e-32, 4.01761391780267e-32,
      3.3692898078516214e-32, 2.644085838994255e-32, 1.9232807473259584e-32,
      1.2634898201377245e-32, 6.994914047872056e-33, 2.4796305867377835e-33,
      -8.844500071849498e-34, -3.171274122108749e-33, -4.519250177297233e-33,
      -5.10084461514759e-33, -5.098534286776565e-33, -4.687146779422278e-33,
      -4.0220974004827264e-33, -3.232704559919634e-33, -2.4196018783249397e-33,
      -1.6552297064893258e-33, -9.864455223055719e-34, -4.384096662658868e-34,
      -1.9052674750119722e-35, 2.764087794854203e-34, 4.612848229336639e-34,
      5.5379234201665395e-34, 5.741233173561199e-34, 5.422312612091588e-34,
      4.762988819238828e-34, 3.918063785921823e-34, 3.01095602504123e-34,
      2.133168033049917e-34, 1.346478113978954e-34, 6.868655713543958e-35,
      1.6933536267925424e-35, -2.070145631141905e-35, -4.541630909509368e-35,
      -5.908901940688123e-35, -6.392334325006185e-35, -6.21742476931224e-35,
      -5.595136273883073e-35, -4.709290010075615e-35, -3.7099095841779717e-35,
      -2.71127228980017e-35, -1.7934161413057328e-35, -1.0059479679255388e-35,
      -3.731582813391287e-36, 1.0035901113457615e-36, 4.2418469881950886e-36,
      6.170647071126266e-36, 7.026622619302104e-36, 7.061853501428814e-36,
      6.518987313099714e-36, 5.6145589661275945e-36, 4.5293979453637075e-36,
      3.40477432717414e-36, 2.3428768790883256e-36, 1.4102891201110105e-36,
      6.432873019735768e-37, 5.39895895856537e-38, -3.6339235555440535e-37,
      -6.267324555222138e-37, -7.609389773500828e-37, -7.938487363001703e-37,
      -7.531139479127524e-37, -6.640350374754088e-37, -5.482306542134011e-37,
      -4.2300137871109906e-37, -3.012307833892588e-37, -1.916710791781842e-37,
      -9.947536392999764e-38, -2.685993898437776e-38, 2.6195438854026507e-38,
      6.127699525924995e-38, 8.094107913572872e-38, 8.821855216986186e-38,
      8.622927556642702e-38, 7.790474828176378e-38, 6.580884089339047e-38,
      5.204169295779694e-38, 3.8209623978243445e-38, 2.5443732014556965e-38,
      1.445112302892798e-38, 5.5848940463158114e-39, -1.0783635403517318e-39,
      -5.662018669020371e-39, -8.419678709527892e-39, -9.675853669152366e-39,
      -9.778668896083469e-39, -9.064823128388251e-39, -7.835945704313919e-39,
      -6.344843689321961e-39, -4.7897862293148915e-39, -3.3148816162729556e-39,
      -2.0146944731603398e-39, -9.414637853104075e-40, -1.135637712241245e-40,
      4.758441304499843e-40, 8.507206777576577e-40, 1.0451019726264426e-39,
      1.097350519971711e-39, 1.045778043408985e-39, 9.255815680167986e-40,
      7.669462274083106e-40, 5.9411831289815365e-40, 4.252328708686398e-40,
      2.72684024114712e-40, 1.4384592949929493e-40, 4.1981555783232867e-41,
      -3.2789932387560254e-41, -8.256246149482121e-41, -1.1081284033314655e-40,
      -1.2170771897637286e-40, -1.1956238915300151e-40, -1.0844950741347186e-40,
      -9.19443470524788e-41, -7.298621802520372e-41, -5.383244746171919e-41,
      -3.608093511702194e-41, -2.0738960687254348e-41, -8.318879346230865e-42,
      1.0550276109730111e-42, 7.540470998187755e-42, 1.1480136647865924e-41,
      1.3318819061100041e-41, 1.353713336067184e-41, 1.2602174647613577e-41,
      1.0934021406907024e-41, 8.886036230598984e-42, 6.736420402372333e-42,
      4.688335147229226e-42, 2.8760175707555104e-42, 1.374606780653727e-42,
      2.1178077707637384e-43, -6.2027273130828785e-43, -1.1536135525082033e-42,
      -1.4347201050815305e-42, -1.516441449499507e-42, -1.4518444044548167e-42,
      -1.289883447252937e-42, -1.0726962253228378e-42, -8.34255828922076e-43,
      -6.000823436518039e-43, -3.877200419300996e-43, -2.0771286428449545e-43,
      -6.485075616328384e-44, 4.0494318601033276e-44, 1.1107688448233135e-43,
      1.5162146249241777e-43, 1.6785364893199578e-43, 1.6574053561377229e-43,
      1.5093890623564998e-43, 1.2843341283134035e-43, 1.0233699024800452e-43,
      7.582102501950067e-44, 5.114208230008923e-44, 2.973416296733618e-44,
      1.2339476585589593e-44, -8.442997963826878e-46, -1.0017042973558732e-44,
      -1.5641213901427447e-44, -1.8326152681799075e-44, -1.8735175476298463e-44,
      -1.7516120050032186e-44, -1.525390866192182e-44, -1.2442355575511646e-44,
      -9.471729081122206e-45, -6.628355600968697e-45, -4.102695990900434e-45,
      -2.0027109721625704e-45, -3.698595736231689e-46, 8.043427224934013e-46,
      1.5627043097082406e-45, 1.9686509196755317e-45, 2.094961604515774e-45,
      2.0151219849989375e-45, 1.7972068960480015e-45, 1.50002755474977e-45,
      1.1711755990762516e-45, 8.465538565279076e-46, 5.50986884017142e-46,
      2.995392578590611e-46, 9.92239799684205e-47, -4.915298508089738e-47,
      -1.4920100301528696e-46, -2.073340908807852e-46, -2.3141657182055088e-46,
      -2.296972443983805e-46, -2.1003143434702127e-46, -1.793673486301788e-46,
      -1.4345896243228849e-46, -1.0676075984797337e-46, -7.24583967479472e-47,
      -4.259216806319313e-47, -1.8235599282117007e-47, 3.0167847591139248e-49,
      1.32703378907427e-47, 2.1293625908815618e-47, 2.52058391054288e-47,
      2.592214794064255e-47, 2.434085586851485e-47, 2.127624767359995e-47,
      1.741827497263855e-47, 1.331429213776654e-47, 9.367715391763688e-48,
      5.848651239023162e-48, 2.912060081232449e-48, 6.1974148958891476e-49,
      -1.0367688496178234e-48, -2.114503414244792e-48, -2.6999527530035867e-48,
      -2.893303550594895e-48, -2.7962902236291034e-48, -2.5035556298941762e-48,
      -2.0971656773321532e-48, -1.6437753827564477e-48, -1.1938811131916562e-48,
      -7.825951441509592e-49, -4.314249692129321e-49, -1.5061384392720588e-49,
      5.831340633170323e-50, 2.0006531366874988e-49, 2.833409894583074e-49,
      3.1893742363941923e-49, 3.1825427171570292e-49, 2.9219741358670265e-49,
      2.504501350515294e-49, 2.0106055356451837e-49, 1.5028386026801078e-49,
      1.0261584347960443e-49, 6.095778838816554e-50, 2.6860206280928596e-50,
      8.022274608590232e-52, -1.7526463663586767e-50, -2.896457072946938e-50,
      -3.465374173895183e-50, -3.5856206457729112e-50, -3.3817266083271697e-50,
      -2.967027185482727e-50, -2.437902130455736e-50, -1.8711010392038514e-50,
      -1.3234462459871735e-50, -8.332261308697674e-51, -4.226612687107274e-51,
      -1.009243362193026e-51, 1.3269455748776759e-51, 2.8577500898247707e-51,
      3.7010246805734454e-51, 3.994631016576599e-51, 3.879374016336104e-51,
      3.486805078641895e-51, 2.9314169871380805e-51, 2.3065442628374594e-51,
      1.683190178393517e-51, 1.1109993623207803e-51, 6.206560939342118e-52,
      2.2708912421678684e-52, -6.7015774565479735e-53, -2.6776987296764207e-52,
      -3.8695918766275216e-52, -4.393999640335093e-52, -4.408415768878517e-52,
      -4.064216637467284e-52, -3.496324823623435e-52, -2.817286624493145e-52,
      -2.11491932525264e-52, -1.452649619133632e-52, -8.717110753458994e-53,
      -3.9446801637675834e-53, -2.826176400178643e-54, 2.306861049119661e-53,
      3.9364424793712766e-53, 4.762256196329771e-53, 4.958333121041021e-53,
      4.697264541146494e-53, 4.136761568032888e-53, 3.411430484862032e-53,
      2.6288649619661806e-53, 1.8690780620866303e-53, 1.1863207768693513e-53,
      6.1242714408914e-54, 1.6096050938436213e-54, -1.6841191854785743e-54,
      -3.8573608242994386e-54, -5.0705854909255697e-54, -5.513421046315314e-54,
      -5.380694979165872e-54, -4.855220986600984e-54, -4.0966995164205175e-54,
      -3.2357956881885594e-54, -2.3723220309956115e-54, -1.5764443684135743e-54,
      -8.919097313414703e-55, -3.4043209737188416e-55, 7.346282228178347e-56,
      3.576604208286925e-55, 5.281113723025014e-55, 6.0513740895491906e-55,
      6.104907141910954e-55, 5.65177865814933e-55, 4.879945470826316e-55,
      3.9467620477298265e-55, 2.9754869019192578e-55, 2.0555741956119663e-55,
      1.2455949762750855e-55, 5.777667608233021e-56, 6.324638026936983e-57,
      -3.024675860011288e-56, -5.344897563986426e-56, -6.541588536739431e-56,
      -6.854611291576782e-56, -6.523107349106581e-56, -5.766493124955092e-56,
      -4.772725119736837e-56, -3.692603337222117e-56, -2.6387647712494747e-56,
      -1.6880450872783313e-56, -8.860112868155515e-57, -2.526517393091663e-57,
      2.115798858808013e-57, 5.199583861230503e-57, 6.943140425599845e-57,
      7.607192383157471e-57, 7.461242426944218e-57, 6.759286536895991e-57,
      5.724038325088823e-57, 4.538385928665884e-57, 3.342604852901148e-57,
      2.2358292024793067e-57, 1.280389403749534e-57, 5.078104483123508e-58,
      -7.450807022943715e-59, -4.7667091922956975e-58, -7.202396746834531e-58,
      -8.330731688670764e-58, -8.452050154331502e-58, -7.857793517020414e-58,
      -6.809745664301167e-58, -5.527863829670847e-58, -4.1851107386924055e-58,
      -2.90760936395429e-58, -1.778515895475786e-58, -8.44187563988779e-59,
      -1.214632356312847e-59, 3.948611841778782e-59, 7.2502160048823585e-59,
      8.981634618645886e-59, 9.47334563212507e-59, 9.056618361043282e-59,
      8.036652746711827e-59, 6.675847668601772e-59, 5.185513502541031e-59,
      3.724169368689136e-59, 2.400592483626482e-59, 1.2799532190259811e-59,
      3.91619879814012e-60, -2.6249346827664717e-60, -6.998694573397604e-60,
      -9.501809224996971e-60, -1.049260096047756e-59, -1.034376544685921e-59,
      -9.408119250407922e-60, -7.996189742220135e-60, -6.363906483353392e-60,
      -4.7083620472444466e-60, -3.1695694679808375e-60, -1.8362815190381364e-60,
      -7.541892626084032e-61, 6.487066975050003e-62, 6.337417570639509e-61,
      9.815337094694774e-61, 1.1464178085817745e-60, 1.1698488353990316e-60,
      1.0922512857117746e-60, 9.500786126817468e-61, 7.740711816777886e-61,
      5.884944185846688e-61, 4.111252123151758e-61, 2.537638666580159e-61,
      1.2307326779572453e-61, 2.15799558064705e-62, -5.129178013689419e-62,
      -9.824577005626685e-62, -1.2326015104952296e-61, -1.3088650870918477e-61,
      -1.2571255258983278e-61, -1.1198259847844044e-61, -9.335916030048114e-62,
      -7.2802607549468256e-62, -5.2543247560835425e-62, -3.4120432735857073e-62,
      -1.8465502973455523e-62, -6.008786433500415e-63, 3.2051366801453976e-63,
      9.40564245653009e-63, 1.2995689920864735e-62, 1.446751783372497e-62,
      1.4336380604303155e-62, 1.3092253573968805e-62, 1.1168014591566765e-62,
      8.921731175155592e-63, 6.630257953401327e-63, 4.4912761319921924e-63,
      2.6310861218432393e-63, 1.1158063059271133e-63, -3.5940850599823774e-65,
      -8.403197812810121e-64, -1.3365781635026936e-63, -1.576988550752379e-63,
      -1.618751586919252e-63, -1.517924843965145e-63, -1.325259371027297e-63,
      -1.0837079872786692e-63, -8.273055694709477e-64, -5.811009710370064e-64,
      -3.618315086218166e-64, -1.790637108744895e-64, -3.6569191907822844e-65,
      6.624525342353325e-65, 1.3298448627184841e-64, 1.6907453619120837e-64,
      1.807818132607323e-64, 1.7445812591289635e-64, 1.560046452972521e-64,
      1.3053241185107428e-64, 1.0218788467137518e-64, 7.4108191081676626e-65,
      4.847088053916237e-65, 2.66059185712697e-65, 9.142304245925691e-66,
      -3.8328281025670196e-66, -1.2619143821078744e-65, -1.7763334764621835e-65,
      -1.9941297848597183e-65, -1.9865169002228012e-65, -1.821525010593294e-65,
      -1.5594854610499767e-65, -1.2504846066256923e-65, -9.334025881394967e-66,
      -6.361402447760777e-66, -3.766605629501456e-66, -1.6451733820816817e-66,
      -2.602469841346695e-68, 1.110939330520821e-66, 1.8185592524444584e-66,
      2.1683776701796953e-66, 2.2392957206719017e-66, 2.1090309193375286e-66,
      1.8482250319448144e-66, 1.516882918146893e-66, 1.1627313784840313e-66,
      8.210556441383817e-67, 5.1558469792491296e-67, 2.6004057522561107e-67,
      6.002853601801628e-68, -8.498575695429482e-68, -1.7979698222364632e-67,
      -2.3180057341721828e-67, -2.4962048174083507e-67, -2.4204862956992243e-67,
      -2.172880663805656e-67, -1.8246981914256304e-67, -1.4340040767743677e-67,
      -1.044913268143279e-67, -6.8821737828923146e-68, -3.828948868501896e-68,
      -1.3811907073649314e-68, 4.4546581486964986e-69, 1.6899799141753289e-68,
      2.4264450427776997e-68, 2.7476256043585574e-68, 2.751917144069431e-68,
      2.5337540824681964e-68, 2.1772047851692116e-68, 1.7523154209516603e-68,
      1.3136743079644742e-68, 9.006479984923403e-69, 5.387701226714852e-69,
      2.418265877759082e-69, 1.4261270853798495e-70, -1.4638699768317848e-69,
      -2.4722137831124453e-69, -2.9802775520207006e-69, -3.0968586242807006e-69,
      -2.9296771891276353e-69, -2.577041002827885e-69, -2.122759608019317e-69,
      -1.6337448936626993e-69, -1.159687372088775e-69, -7.34213357958207e-70,
      -3.769871192979141e-70, -9.63064164947929e-71, 1.081647426542707e-70,
      2.427868031940167e-70, 3.176316028305959e-70, 3.445628482833187e-70,
      3.3574669582583516e-70, 3.025834991511279e-70, 2.5502061151614993e-70,
      2.0118750140169052e-70, 1.4728610560954354e-70, 9.766889233156964e-71,
      5.504221751356659e-71, 2.074115643935921e-71, -4.967655372048422e-72,
      -2.2587888611909127e-71, -3.3122646970145046e-71, -3.784447091123175e-71,
      -3.811247716185096e-71, -3.523723240540193e-71, -3.038994428401741e-71,
      -2.4550013006714528e-71, -1.848368543653924e-71, -1.2746224685533483e-71,
      -7.700387520673689e-72, -3.5448470010601657e-72, -3.4730147429787293e-73,
      1.9217926892165358e-72, 3.357762272944161e-72, 4.0943805299905534e-72,
      4.2816167783659306e-72, 4.0687392650347444e-72, 3.5925281922557394e-72,
      2.9700178084756493e-72, 2.2949962683694623e-72, 1.6374206446250797e-72,
      1.0449222049864755e-72, 5.4565579175254953e-73, 1.5186228785425956e-73,
      -1.3635542447673869e-73, -3.2741033966032404e-73, -4.350081378484081e-73,
      -4.754626561844835e-73, -4.6560466712152066e-73, -4.212745807995094e-73,
      -3.5634556501438433e-73, -2.8219695017147803e-73, -2.075455644149131e-73,
      -1.3854150003674675e-73, -7.904152485844867e-74, -3.0985032175037067e-74,
      5.188354340133983e-75, 3.0125542305465247e-74, 4.518300474555697e-74,
      5.210553448387375e-74, 5.276987170627935e-74, 4.899440617695535e-74,
      4.2410485826730355e-74, 3.438724857386158e-74, 2.6000010197472836e-74,
      1.803172160764419e-74, 1.0997487562156366e-74, 5.183278745162742e-75,
      6.914807886538148e-76, -2.5124254116919674e-75, -4.556142136316575e-75,
      -5.622420986806933e-75, -5.917910302177677e-75, -5.649399523042237e-75,
      -5.007157363051795e-75, -4.1545811863865955e-75, -3.223101830364564e-75,
      -2.311181504004753e-75, -1.486261090322049e-75, -7.886182016506071e-76,
      -2.3625442374814503e-76, 1.6988886144962845e-76, 4.409035446758132e-76,
      5.954242670520992e-76, 6.558747728492964e-76, 6.455324229021041e-76,
      5.864020869143308e-76, 4.978282098362541e-76, 3.957358174653451e-76,
      2.923733500950948e-76, 1.9642789929648448e-76, 1.1339220305485673e-76,
      4.607860474075502e-77, -4.805286738823598e-78, -4.008395569957995e-77,
      -6.158947747625173e-77, -7.171291133798315e-77, -7.304494327549807e-77,
      -6.810796610361453e-77, -5.9173781274522835e-77, -4.81559648048565e-77,
      -3.6563216321693255e-77, -2.5499200923167065e-77, -1.5694990881682167e-77,
      -7.5617494674225e-78, -1.253368424581066e-78, 3.2689521303340322e-78,
      6.175952626752556e-78, 7.71712915441583e-78, 8.177126235194948e-78,
      7.842347344989675e-78, 6.9774106324982e-78, 5.81039745324891e-78,
      4.525449420592603e-78, 3.261111056218891e-78, 2.1128327716741785e-78,
      1.1381886903179155e-78, 3.635779642730555e-79, -2.0857270030158438e-79,
      -5.928340831025855e-79, -8.145195677096709e-79, -9.04437670938084e-79,
      -8.947724118729935e-79, -8.160852853984649e-79, -6.953443268060796e-79,
      -5.548314752768382e-79, -4.11753358052301e-79, -2.783763881947842e-79,
      -1.6251849956195058e-79, -6.825133061186525e-80, 3.3065211339450585e-81,
      5.319616628073336e-80, 8.388879583650745e-80, 9.865934485443857e-80,
      1.010828922311466e-79, 9.465756136695162e-80, 8.254639354742663e-80,
      6.7423355706923006e-80, 5.14047130206756e-80, 3.604574986242231e-80,
      2.238355741606233e-80
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_3_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<3>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.0012184524798618767), "design.b()[0] == 0.0012184524798618767");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.0012184524798618767));
    static_assert(almost_equal(design.b()[1], 0.0036553574395856298), "design.b()[1] == 0.0036553574395856298");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.0036553574395856298));
    static_assert(almost_equal(design.b()[2], 0.0036553574395856298), "design.b()[2] == 0.0036553574395856298");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.0036553574395856298));
    static_assert(almost_equal(design.b()[3], 0.0012184524798618767), "design.b()[3] == 0.0012184524798618767");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.0012184524798618767));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.642634111354347), "design.a()[1] == -2.642634111354347");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.642634111354347));
    static_assert(almost_equal(design.a()[2], 2.3826297026874146), "design.a()[2] == 2.3826297026874146");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.3826297026874146));
    static_assert(almost_equal(design.a()[3], -0.7302479714941731), "design.a()[3] == -0.7302479714941731");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.7302479714941731));
    std::cout << "max_deviation(cheby1,lowpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.0012184524798618767, 0.006875281525932921, 0.018921089855348287, 0.03572849242936129,
      0.05435604253228922, 0.07233245234494362, 0.087728543587774, 0.09918638219685885,
      0.10590930984760485, 0.10761872558604546, 0.1044849022192405, 0.09703985325797182,
      0.08608035092438171, 0.07256872285061947, 0.057538137488004876, 0.042007851927657464,
      0.026912469688105137, 0.013047762853813462, 0.0010341621997950468,
      -0.008702298625628622, -0.015932914413372183, -0.020615313086391755,
      -0.02287133036537336, -0.022956878936107872, -0.021227010861330442,
      -0.018099223954758353, -0.014017734309341959, -0.00942097588194173,
      -0.004714043676628248, -0.0002472177019971801, 0.0036988660241883903,
      0.006921356936265768, 0.009297055655741477, 0.01077877520276619, 0.011387224939237842,
      0.011199595134867207, 0.010336070492359, 0.008945462346889234, 0.007191037004352703,
      0.005237449902009613, 0.0032394911407583778, 0.0013331262745009988,
      -0.0003709056790796939, -0.0017908824244779924, -0.0028754033387798548,
      -0.0036024824081433236, -0.003976809752789676, -0.004025628973409036,
      -0.0037937048767435304, -0.0033378480066432806, -0.00272142447013253,
      -0.0020092186232519077, -0.001262939630822908, -0.0005375780769300586,
      0.0001212674895700737, 0.0006790559946152936, 0.0011129957120721208,
      0.001411856790221301, 0.00157504353423808, 0.001611094707145851,
      0.0015357938791240354, 0.0013700715357865753, 0.0011378683036370467,
      0.0008641068223120018, 0.0005728913063135887, 0.0002860215475856988,
      2.1874709545793066e-05, -0.00020532386694248133, -0.00038584853243076814,
      -0.0005144717872969277, -0.0005901638576664891, -0.0006155564880611662,
      -0.0005962406151517211, -0.0005399685759484817, -0.00045582765499852526,
      -0.0003534440421620682, -0.00024226572942358368, -0.00013096062790727702,
      -2.6953294509842753e-05, 6.38889289752541e-05, 0.0001374210502574423,
      0.0001912473065382323, 0.0002246279406298065, 0.00023828938834574454,
      0.00023416442027141378, 0.00021508960815279593, 0.00018448637491923626,
      0.00014604919121674105, 0.0001034606080644305, 6.014819205913137e-05,
      1.9093471863729786e-05, -1.7301909743152856e-05, -4.729219482855627e-05,
      -6.980895409023591e-05, -8.443441974594132e-05, -9.133541960515781e-05,
      -9.116798612412069e-05, -8.49632100801749e-05, -7.400463038674727e-05,
      -5.970652961784134e-05, -4.350109315550947e-05, -2.6740652963196064e-05,
      -1.0619337167126956e-05, 3.883466346954583e-06, 1.603722121320437e-05,
      2.5372896136801294e-05, 3.167641464604206e-05, 3.4966106149635485e-05,
      3.545796437679276e-05, 3.352278062133778e-05, 2.963917254323826e-05,
      2.4346222129470688e-05, 1.8198926764928625e-05, 1.1729018291603023e-05,
      5.412979686529829e-06, -3.5165324778532985e-07, -5.261325234074478e-06,
      -9.113080625447212e-06, -1.1803542012989118e-05, -1.332141825670746e-05,
      -1.37349731405227e-05, -1.3176014330758989e-05, -1.1821968611320262e-05,
      -9.87751068252755e-06, -7.557030844759224e-06, -5.068985747599711e-06,
      -2.6029006310554904e-06, -3.195044362670725e-07, 1.6557984749706562e-06,
      3.2361673856471126e-06, 4.373534228766449e-06, 5.0562056817534245e-06,
      5.304393718230629e-06, 5.164270438424433e-06, 4.7011551355921925e-06,
      3.992411537528336e-06, 3.1205690645403637e-06, 2.1670929435701594e-06,
      1.2071236193424538e-06, 3.0539526654939536e-07, -4.86565415349836e-07,
      -1.1319586227819706e-06, -1.6090329843907466e-06, -1.9103606215502493e-06,
      -2.041264850385484e-06, -2.01762723710585e-06, -1.8633092659027254e-06,
      -1.6074155582739846e-06, -1.2816033803119475e-06, -9.176105680256843e-07,
      -5.451346577858214e-07, -1.9015351580129903e-07, 1.2626460443199474e-07,
      3.8865308750800187e-07, 5.873668904277003e-07, 7.18383861444614e-07,
      7.827610265594746e-07, 7.858317438732643e-07, 7.362344577319445e-07,
      6.448618894995712e-07, 5.238119760690715e-07, 3.8541002314611253e-07,
      2.4135678791918764e-07, 1.0204094486958405e-07, -2.3962082578321373e-08,
      -1.3019849815278557e-07, -2.1245902977593746e-07, -2.687349326026169e-07,
      -2.9903409402754776e-07, -3.050896402859439e-07, -2.899959152968903e-07,
      -2.5780649956069405e-07, -2.1312645936625257e-07, -1.607267570414058e-07,
      -1.0520325159255604e-07, -5.069652056434634e-08, -6.823508009210872e-10,
      4.216337114703572e-08, 7.602712082485083e-08, 9.995387713122834e-08,
      1.1378676523348948e-07, 1.1806236143594496e-07, 1.1387501299769975e-07,
      1.0272365914658074e-07, 8.635385729006706e-08, 6.660620471581831e-08,
      4.5280307005177774e-08, 2.4021091242061502e-08, 4.231796573537241e-09,
      -1.2984423167593833e-08, -2.685453063819192e-08, -3.693936553392315e-08,
      -4.3114673740604466e-08, -4.5533944531249586e-08, -4.457814951618471e-08,
      -4.079761285255706e-08, -3.485101088596669e-08, -2.7445969258350832e-08,
      -1.9284974903098397e-08, -1.1019430945546465e-08, -3.2137334613133096e-09,
      3.679688004600802e-09, 9.334288746539594e-09, 1.3552953569405091e-08,
      1.6262428492236615e-08, 1.750032395593875e-08, 1.73966247340951e-08,
      1.6151727698703496e-08, 1.4012967825254328e-08, 1.1251410534596346e-08,
      8.140414304426396e-09, 4.937132913579815e-09, 1.8677626551456046e-09,
      -8.830251886798581e-10, -3.1783679693719527e-09, -4.9314116813759335e-09,
      -6.103870149251163e-09, -6.701564281758611e-09, -6.76767342838376e-09,
      -6.3744773389207235e-09, -5.614355251923704e-09, -4.59074744798692e-09,
      -3.409685364073082e-09, -2.1723711589400526e-09, -9.69148513412782e-10,
      1.2493530749133923e-10, 1.052910707513385e-09, 1.777064441345583e-09,
      2.278668539639233e-09, 2.556486598107173e-09, 2.6243330477614924e-09,
      2.507984207175723e-09, 2.2417398996996343e-09, 1.864914546495452e-09,
      1.4185011044354433e-09, 9.42204628494232e-10, 4.719892910002968e-10,
      3.822782080764611e-11, -3.355105421283198e-10, -6.330451223526574e-10,
      -8.455934625165003e-10, -9.71287909529623e-10, -1.0143023779412345e-09,
      -9.837035507802974e-10, -8.921426112339686e-10, -7.544974518847139e-10,
      -5.865627412302429e-10, -4.0386800109918485e-10, -2.2068378018060712e-10,
      -4.925484188143209e-11, 1.0072141570033139e-10, 2.2237201532291483e-10,
      3.116977879884281e-10, 3.674246477182659e-10, 3.9069521259607995e-10,
      3.8464429419400993e-10, 3.5390321801893786e-10, 3.040761822098072e-10,
      2.412274880114389e-10, 1.7141215186606259e-10, 1.002748368195864e-10,
      3.2733903641271444e-11, -2.7240698088626667e-11, -7.675447290729885e-11,
      -1.1402562518282462e-10, -1.383429842348957e-10, -1.4995884592125149e-10,
      -1.4993323962246322e-10, -1.3994697658747016e-10, -1.2210040700792755e-10,
      -9.871332144464562e-11, -7.213912981713895e-11, -4.460360802939965e-11,
      -1.807538538403629e-11, 5.827798131823841e-12, 2.5895993955981338e-11,
      4.134863853468464e-11, 5.182449603372542e-11, 5.734518374022655e-11,
      5.825851451104428e-11, 5.516833274052244e-11, 4.8857454959452664e-11,
      4.020983087845078e-11, 3.0137210381560985e-11, 1.951454016084924e-11,
      9.127124318320276e-12, -3.6863621173284185e-13, -8.47027476165443e-12,
      -1.4840449411102452e-11, -1.9305545450403665e-11, -2.184359834011223e-11,
      -2.2563880150109572e-11, -2.1680708554211726e-11, -1.9484052308162305e-11,
      -1.630934878904328e-11, -1.2508653128028174e-11, -8.424844261484852e-12,
      -4.370161214383824e-12, -6.09871492185822e-13, 2.6485832740269334e-12,
      5.2610330769040866e-12, 7.1470348712117835e-12, 8.286027033042206e-12,
      8.710058847202629e-12, 8.494072212224672e-12, 7.744734483456669e-12,
      6.5887735845111736e-12, 5.1616624094104394e-12, 3.5973541539701505e-12,
      2.019599170721053e-12, 5.351923054848698e-13, -7.706789553913192e-13,
      -1.8369793824676793e-12, -2.6273987121726505e-12, -3.129198564871809e-12,
      -3.350659124029735e-12, -3.3174972302817315e-12, -3.0686422969723455e-12,
      -2.6517433985625492e-12, -2.1187448987616257e-12, -1.5218147700103584e-12,
      -9.098453319087202e-13, -3.256764015777095e-13, 1.958787957948786e-13,
      6.291895473221781e-13, 9.581865916580233e-13, 1.1760509613755121e-12,
      1.2843329438381363e-12, 1.2916419101466076e-12, 1.2120559801978407e-12,
      1.0633976247515654e-12, 8.655091421438113e-13, 6.386426370948032e-13,
      4.020549860992261e-13, 1.728715997213954e-13, -3.474427543726841e-14,
      -2.101055776640247e-13, -3.4621028884007143e-13, -4.396752656071114e-13,
      -4.904391091345573e-13, -5.012871331046102e-13, -4.772556595674739e-13,
      -4.249726374867801e-13, -3.519875900394249e-13, -2.661369605894421e-13,
      -1.7498192980578226e-13, -8.534561290943025e-14, -2.966060150147987e-15,
      6.772858129415282e-14, 1.237254215522259e-13, 1.634229305153055e-13,
      1.8653380549161572e-13, 1.939145070776666e-13, 1.873433690747003e-13,
      1.6926944638295368e-13, 1.4255301269950578e-13, 1.1021615856624729e-13,
      7.521860784127963e-14, 4.027001412810157e-14, 7.685949981095586e-15,
      -2.070914239633999e-14, -4.363236270270281e-14, -6.034950286374397e-14,
      -7.064470072342766e-14, -7.476002220772021e-14, -7.331332461755891e-14,
      -6.720299236556662e-14, -5.750776973981881e-14, -4.538905484814811e-14,
      -3.20017931597422e-14, -1.8418652167991743e-14, -5.570600813542887e-15,
      5.794523469240514e-15, 1.513530095568755e-14, 2.2122938916288705e-14,
      2.6632454416647e-14, 2.8721583958676956e-14, 2.8600591819865095e-14,
      2.659629631359101e-14, 2.3113538713457625e-14, 1.8597024420043974e-14,
      1.3496018661456199e-14, 8.233831276993488e-15, 3.1834278274748453e-15,
      -1.3500957487857494e-15, -5.140000189789172e-15, -8.041669887964141e-15,
      -9.9903787160482e-15, -1.0994068758180289e-14, -1.1122341176101347e-14,
      -1.0492937205311106e-14, -9.256969746580554e-15, -7.584067248394986e-15,
      -5.648429847526445e-15, -3.616592877084092e-15, -1.6374646994167592e-15,
      1.6502710236764213e-16, 1.696568667736253e-15, 2.8944564826228362e-15,
      3.727205241158147e-15, 4.192137549784886e-15, 4.3114067479688474e-15,
      4.126943162935265e-15, 3.694814941870768e-15, 3.0794626712076514e-15,
      2.348209146346374e-15, 1.566369478340211e-15, 7.931999231804422e-16,
      7.883369540740945e-17, -5.377349503630335e-16, -1.029635592055243e-15,
      -1.3821587267649575e-15, -1.5919793107843297e-15, -1.6657356975067894e-15,
      -1.6181513892965639e-15, -1.4698903713450601e-15, -1.2453269858346296e-15,
      -9.703908837000032e-16, -6.706194465986865e-16, -3.695171878512388e-16,
      -8.728688705995391e-17, 1.6003683168608232e-16, 3.6105194339028487e-16,
      5.09078600661127e-16, 6.0192196263604e-16, 6.413711651623943e-16,
      6.32505787684573e-16, 5.828836738139063e-16, 5.016811948478986e-16,
      3.9884995250447163e-16, 2.8434359409573855e-16, 1.6745601222432545e-16,
      5.62988457409101e-17, -4.256708563868356e-17, -1.2434412137771906e-16,
      -1.8606229619981633e-16, -2.265131017654957e-16, -2.4607573832157593e-16,
      -2.464629101224394e-16, -2.304146633186028e-16, -2.0136810751672602e-16,
      -1.6312844927040861e-16, -1.1956301092193717e-16, -7.43352545712406e-17,
      -3.069071741352828e-17, 8.698402567861293e-18, 4.1828141385229435e-17,
      6.739956678011104e-17, 8.480341302139076e-17, 9.406109764897734e-17,
      9.573233136534754e-17, 9.080027963436343e-17, 8.054514581837215e-17,
      6.641624736043575e-17, 4.991130400279069e-17, 3.246992014551125e-17,
      1.53862930617828e-17, -2.5582478755471377e-19, -1.3624796852541668e-17,
      -2.4160007888106635e-17, -3.157003083392267e-17, -3.581316823045621e-17,
      -3.7064203573386776e-17, -3.567156127646786e-17, -3.210910574712663e-17,
      -2.6926556168407e-17, -2.0702012014266802e-17, -1.399943994297255e-17,
      -7.333231823875143e-18, -1.1411694143930334e-18, 4.233620118538017e-18,
      8.551815418414503e-18, 1.1678833444392812e-17, 1.3578666716803137e-17,
      1.4302058257076207e-17, 1.3970616802564686e-17, 1.2758513531783003e-17,
      1.0873325541032678e-17, 8.53742225622319e-18, 5.9710535021425255e-18,
      3.3780177331565935e-18, 9.344907442551977e-19, -1.2186985620872543e-18,
      -2.9803291984702265e-18, -4.289802239918808e-18, -5.12530901093907e-18,
      -5.499685539621579e-18, -5.454562507623209e-18, -5.0534453315358214e-18,
      -4.3743385763172254e-18, -3.502470595144832e-18, -2.523587449611227e-18,
      -1.5181796765313675e-18, -5.568910329163139e-19, 3.0275613546124767e-19,
      1.0182911780276839e-18, 1.5629466941959032e-18, 1.925172495335278e-18,
      2.107208356251039e-18, 2.122946164767318e-18, 1.9953260417231138e-18,
      1.753506699418097e-18, 1.4300306552281072e-18, 1.0581734383310746e-18,
      6.696264192142874e-19, 2.9261913767206262e-19, -4.9457474446607474e-20,
      -3.389077237361349e-19, -5.6408573200477675e-19, -7.192968084700739e-19,
      -8.04317540096598e-19, -8.2362148845612295e-19, -7.854044140994656e-19,
      -7.0050272583306865e-19, -5.812924339520714e-19, -4.406445934492739e-19,
      -2.909985091169891e-19, -1.435973106033649e-19, -7.91328055551153e-21,
      1.0872624135038586e-19, 2.0131644670900978e-19, 2.671726800733623e-19,
      3.057742096097594e-19, 3.1848672023543863e-19, 3.08199464437793e-19,
      2.789134945827607e-19, 2.3531539797937133e-19, 1.8236695467526832e-19,
      1.2493569212472808e-19, 6.74849907723072e-20, 1.3835746356329577e-20,
      -3.299489248109885e-20, -7.087811098068058e-20, -9.858677725264424e-20,
      -1.1574694130737668e-19, -1.2273962837640582e-19, -1.205666225131648e-19,
      -1.1069435417399958e-19, -9.48894249658021e-20, -7.505790656679774e-20,
      -5.3098549417239075e-20, -3.077765044336695e-20, -9.63077193285562e-21,
      9.106029695636334e-21, 2.4535151156098847e-20, 3.610827887807425e-20,
      4.361244927465224e-20, 4.7135832727130945e-20, 4.7018439787933814e-20,
      4.3793200344393955e-20, 3.812272009639557e-20, 3.073654090601463e-20,
      2.2373001931093625e-20, 1.3728901774200492e-20, 5.419181847993737e-21,
      -2.0521350689311615e-21, -8.30944309810568e-21, -1.3111993256594675e-20,
      -1.635044218070677e-20, -1.8035165614501037e-20, -1.8278301142853826e-20,
      -1.727161804720965e-20, -1.526228689776157e-20, -1.2528462132476157e-20,
      -9.356327343946046e-21, -6.019917837729518e-21, -2.7646608459645057e-21,
      2.0480892648851428e-22, 2.7323653153367896e-21, 4.713769980728474e-21,
      6.0961158883490254e-21, 6.873939654506124e-21, 7.08274159030123e-21,
      6.790717994591284e-21, 6.0895130124599584e-21, 5.084746090710634e-21,
      3.886976929038238e-21, 2.6036452811091956e-21, 1.3323806672430882e-21,
      1.5592903620778e-22, -8.611996780062056e-22, -1.6743885194543385e-21,
      -2.259009422019941e-21, -2.609176854125519e-21, -2.735435629537543e-21,
      -2.661690279842281e-21, -2.4216894516406205e-21, -2.0553631515285885e-21,
      -1.6052774848870643e-21, -1.113425554759839e-21, -6.185193070023438e-22,
      -1.5389004773768684e-22, 2.539506302267133e-22, 5.860891274564004e-22,
      8.313709107222465e-22, 9.860226969452928e-22, 1.0528385841199551e-21,
      1.0400471119937844e-21, 9.599805672022959e-22, 8.2766349225982055e-22,
      6.594258577413984e-22, 4.716295069615772e-22, 2.7957617394563205e-22,
      9.664345700665033e-23, -6.632670932609608e-23, -2.0138286189156527e-22,
      -3.035755441176501e-22, -3.7085324484448313e-22, -4.0378075309827666e-22,
      -4.051242604285334e-22, -3.7935000400991256e-22, -3.320822404411142e-22,
      -2.695624384770704e-22, -1.9814545616392637e-22, -1.2386085127570635e-22,
      -5.2059085222754664e-23, 1.2846111409596964e-23, 6.75359595641039e-23,
      1.0984926249685253e-22, 1.3875907172281646e-22, 1.54277338025871e-22,
      1.5730427138045344e-22, 1.4944039603174194e-22, 1.32779171958027e-22,
      1.0969676781001292e-22, 8.265336757608807e-23, 5.401755228096346e-23,
      2.5922099828341728e-23, 1.5625472281524872e-25, -2.1903632968209534e-23,
      -3.932602397162497e-23, -5.162194121016334e-23, -5.87136334763033e-23,
      -6.088042942052728e-23, -5.8688670280557e-23, -5.291267432883782e-23,
      -4.4453279170721287e-23, -3.425972481565801e-23, -2.325958720442019e-23,
      -1.2300257551421385e-23, -2.1041913889132275e-24, 6.76108467774192e-24,
      1.3898343776738397e-23, 1.9082494686776236e-23, 2.2250713059416645e-23,
      2.3483212040776115e-23, 2.2977280377847916e-23, 2.10172844657318e-23,
      1.7943210098887827e-23, 1.4120045223011707e-23, 9.909917164442456e-24,
      5.648438764620943e-24, 1.6262283496213576e-24, -1.9239145578265906e-24,
      -4.834141257030447e-24, -7.003340660526368e-24, -8.394233080135419e-24,
      -9.026641047279077e-24, -8.967935785511142e-24, -8.321701619500697e-24,
      -7.215628704034599e-24, -5.789550008484582e-24, -4.1843967950366345e-24,
      -2.532674114772468e-24, -9.508700665175291e-25, 4.659756283372163e-25,
      1.64749421961633e-24, 2.5491061129835858e-24, 3.151263862327596e-24,
      3.4571407482916015e-24, 3.4891427579309435e-24, 3.2846454813503497e-24,
      2.891351039369193e-24, 2.3626284191061854e-24, 1.7531492853216265e-24,
      1.1150666872885398e-24, 4.949123142578422e-25, -6.868513649126077e-26,
      -5.464272783381542e-25, -9.189474052194294e-25, -1.1766650774408434e-24,
      -1.319011299976756e-24, -1.3531665695261986e-24, -1.2924659193985273e-24,
      -1.1546249913146691e-24, -9.59930841090467e-25, -7.295228013013339e-25,
      -4.838646629658391e-25, -2.4148211794522256e-25, -1.801110990994131e-26,
      1.7442450484427387e-25, 3.2751212502574806e-25, 4.367531308805865e-25,
      5.012117456706326e-25, 5.230633386826621e-25, 5.070011165003123e-25,
      4.595610583913399e-25, 3.8842175172171894e-25, 3.017292796397857e-25,
      2.0748841461641944e-25, 1.1305101461495199e-25, 2.472160231344015e-26,
      -5.251056189751791e-26, -1.1511335194886626e-25, -1.6103634610910487e-25,
      -1.8963338117418812e-25, -2.0150295204312099e-25, -1.9826891308409303e-25,
      -1.8232466615006878e-25, -1.5656310265533226e-25, -1.241123021447463e-25,
      -8.809372216437041e-26, -5.141570575364064e-26, -1.6610935713480027e-26,
      1.4277700463401153e-26, 3.976223226711496e-26, 5.892845601311013e-26,
      7.141393414590507e-26, 7.735249822477756e-26, 7.729377519233462e-26,
      7.210668761765295e-26, 6.287565266773216e-26, 5.079743137652322e-26,
      3.708538966674108e-26, 2.2886464765251743e-26, 9.21452274106992e-27,
      -3.0978280475873808e-27, -1.342842717912854e-26, -2.1376556065449817e-26,
      -2.6757629432258155e-26, -2.9584288561876743e-26, -3.0037114159290645e-26,
      -2.842840243848234e-26, -2.5162412346712682e-26, -2.069523482586825e-26,
      -1.5497005658303443e-26, -1.001863515036618e-26, -4.6646142645684976e-27,
      2.2717197158206145e-28, 4.398292903891565e-27, 7.675487067938205e-27,
      9.969892504489464e-27, 1.1270779019341209e-26, 1.163499194584239e-26,
      1.1173427514926083e-26, 1.003586680702898e-26, 8.39541295017835e-27,
      6.4336230718173364e-27, 4.327222905777935e-27, 2.2370587081592668e-27,
      2.996980233808367e-28, -1.3781445558766758e-27, -2.722393642334199e-27,
      -3.6918282767031666e-27, -4.276082649000162e-27, -4.49188459684721e-27,
      -4.3780360394088524e-27, -3.98965039736207e-27, -3.392137140549526e-27,
      -2.655369714821356e-27, -1.8483979896262994e-27, -1.034978090511621e-27,
      -2.700988018344279e-28, 4.0240835048158173e-28, 9.511728104504292e-28,
      1.3575725240796252e-27, 1.61513275185387e-27, 1.72820430036205e-27,
      1.7101129490411052e-27, 1.5809793307851506e-27, 1.3654016862101936e-27,
      1.0901752708794165e-27, 7.821946937970946e-28, 4.666522096456922e-28,
      1.6560901675594599e-28, -1.0301929024059008e-28, -3.260554233858316e-28,
      -4.952527146073027e-28, -6.071320086036545e-28, -6.625252393933429e-28,
      -6.658983303216798e-28, -6.245302459553084e-28, -5.476235028703081e-28,
      -4.454151395634004e-28, -3.2834716294099704e-28, -2.063430237174608e-28,
      -8.822291203836411e-29, 1.8723290812430903e-29, 1.08999763156273e-28,
      1.7901122086923526e-28, 2.27027730437672e-28, 2.53030628658788e-28,
      2.5846693755109346e-28, 2.4594179392275148e-28, 2.188782747600312e-28,
      1.8117192862766993e-28, 1.368637360128356e-28, 8.985057510112202e-29,
      4.364702541412239e-29, 1.2069347735175434e-30, -3.519201197778406e-29,
      -6.400213816985461e-29, -8.440333882158533e-29, -9.625264220269592e-29,
      -9.999604508035637e-29, -9.655392241738736e-29, -8.71914385249953e-29,
      -7.338473527893491e-29, -5.669239943622747e-29, -3.863998971979406e-29,
      -2.0623414158613355e-29, -3.834860217664693e-30, 1.078705261022457e-29,
      2.2583078694404001e-29, 3.1176863248745385e-29, 3.6459151517767385e-29,
      3.8556524465486105e-29, 3.778897057169604e-29, 3.462072368011668e-29,
      2.9608605417532615e-29, 2.335166520205729e-29, 1.6445277535983666e-29,
      9.442104314570568e-30, 2.8215263632908615e-30, -3.031645820740054e-30,
      -7.839105657173383e-30, -1.1432184728323315e-29, -1.374724855996938e-29,
      -1.4814776086008784e-29, -1.4743759595358382e-29, -1.3703136869658125e-29,
      -1.190191756808082e-29, -9.569512967007669e-30, -6.937546981190546e-30,
      -4.22414362715455e-30, -1.6213779715492258e-30, 7.137317293017602e-31,
      2.6646028134753647e-30, 4.1570038953667756e-30, 5.157879633191919e-30,
      5.6716085050226965e-30, 5.734312546775841e-30, 5.406878194544926e-30,
      4.7673379603031165e-30, 3.903211434312472e-30, 2.9043204868575344e-30,
      1.856487764551461e-30, 8.36409868024879e-31, -9.21234980834546e-32,
      -8.806072695021048e-31, -1.4968400167808898e-30, -1.9247124484696064e-30,
      -2.1629569589577856e-30, -2.223091178182753e-30, -2.126808445273918e-30,
      -1.903068404584901e-30, -1.5851243318752235e-30, -1.2076938760592535e-30,
      -8.044405594322581e-31, -4.0588858997812724e-31, -3.7847065514143596e-32,
      2.796251774084164e-31, 5.327232551823895e-31, 7.139116499254677e-31,
      8.215207460576099e-31, 8.59011720974826e-31, 8.340064791546224e-31,
      7.5718098790223835e-31, 6.4111526436346785e-31, 4.991826944464472e-31,
      3.445468248928265e-31, 1.8931679886034802e-31, 4.3894681588991136e-32,
      -8.346962534551384e-32, -1.8691624300641935e-31, -2.630200289248072e-31,
      -3.10667032494209e-31, -3.307951713192272e-31, -3.260359469177154e-31,
      -3.002952844507176e-31, -2.583101337342901e-31, -2.052137952763359e-31,
      -1.4613760069665703e-31, -8.58701757017084e-32, -2.858862508116256e-32,
      2.2330868897917663e-32, 6.442190154517059e-32, 9.616053754525552e-32,
      1.169306522725416e-31, 1.2693394029977615e-31, 1.2705855274584546e-31,
      1.1872106081560308e-31, 1.0369609571243365e-31, 8.394676431376663e-32,
      6.14669990504525e-32, 3.8144597860701016e-32, 1.5651072151542858e-32,
      -4.6382433426106274e-33, -2.1692874249876993e-32, -3.484594941927593e-32,
      -4.378607584572464e-32, -4.852676094440133e-32, -4.935865278928015e-32,
      -4.679025061613534e-32, -4.148268887947581e-32, -3.418378382446729e-32,
      -2.5665832116257056e-32, -1.6670754162654573e-32, -7.865168463663355e-33,
      1.9304972090868707e-34, 7.076159365268837e-33, 1.2496210800856292e-32,
      1.6304019607469287e-32, 1.8479066364182022e-32, 1.9112302318702716e-32,
      1.8384026902244232e-32, 1.6539018132194077e-32, 1.386096493096856e-32,
      1.0648001241070687e-32, 7.190808986502589e-33, 3.7543746085293085e-33,
      5.640846364688271e-34, -2.20354147947834e-33, -4.425534247026188e-33,
      -6.032922720517026e-33, -7.00752972067031e-33, -7.375853614919991e-33,
      -7.200863487048582e-33, -6.572553940202506e-33, -5.598066152189625e-33,
      -4.392094285376468e-33, -3.0681736693732177e-33, -1.7313025488299353e-33,
      -4.721953974679634e-34, 6.366856143556424e-34, 1.5433137278585265e-33,
      2.2166077145729783e-33, 2.6454764078235152e-33, 2.836672535297739e-33,
      2.8117702246459626e-33, 2.6035934499907025e-33, 2.252411973365051e-33,
      1.802191128822624e-33, 1.2971369172297442e-33, 7.787234256348135e-34,
      2.8333055651680812e-34, -1.5943896809844725e-34, -5.277494534871804e-34,
      -8.078631227179315e-34, -9.938851049750574e-34, -1.0870239771467032e-33,
      -1.0944868763054927e-33, -1.028135320077729e-33, -9.030255815155017e-34,
      -7.359472743883108e-34, -5.440575305596717e-34, -3.436877523358056e-34,
      -1.493773499437943e-34, 2.6834058672650776e-35, 1.7584622570863356e-34,
      2.916791023898052e-34, 3.7142022197830967e-34, 4.149758048581672e-34,
      4.246704370880405e-34, 4.047437682525065e-34, 3.6079253079979817e-34,
      2.9920285003444263e-34, 2.2661197306539456e-34, 1.4943094618993462e-34,
      7.345117198619462e-35, 3.548895364146326e-36, -5.650686679093397e-35,
      -1.0414510786703468e-34, -1.3799090171751053e-34, -1.5778426139122786e-34,
      -1.6423660401549297e-34, -1.5884336036086733e-34, -1.4367150827060478e-34,
      -1.211397670425507e-34, -9.380711928156132e-35, -6.41825136452422e-35,
      -3.456534033769291e-35, -6.922842609737374e-36, 1.719271614922202e-35,
      3.6687358926151214e-35, 5.093199821400345e-35, 5.973719084160655e-35,
      6.330231590790754e-35, 6.214624247156788e-35, 5.702676455162447e-35,
      4.885577782375675e-35, 3.8616449445794085e-35, 2.7287598308765774e-35,
      1.5779271297372056e-35, 4.882182211380172e-36, -4.767625918316961e-36,
      -1.2708742376125844e-35, -1.8659865334954987e-35, -2.2512518733964895e-35,
      -2.4313333884076345e-35, -2.4238578474161317e-35, -2.256374394170366e-35,
      -1.9630925145861826e-35, -1.5816478671220552e-35, -1.1501068957055282e-35,
      -7.043748535300341e-36, -2.7612131072904795e-36, 1.0871362565187886e-36,
      4.308168640428601e-36, 6.778300000551635e-36, 8.441675277639913e-36,
      9.304111541155259e-36, 9.423816103137452e-36, 8.899961625717183e-36,
      7.86018660134981e-36, 6.448006905175714e-36, 4.810987856379971e-36,
      3.090353164377408e-36, 1.4125140851211983e-36, -1.1719521412532403e-37,
      -1.4184779557219633e-36, -2.4377998884405298e-36, -3.148086999322136e-36,
      -3.546708316288518e-36
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.0012184524798618767, 0.00687528152593292, 0.01892108985534828, 0.03572849242936128,
      0.05435604253228919, 0.07233245234494355, 0.08772854358777386, 0.09918638219685856,
      0.10590930984760435, 0.10761872558604471, 0.10448490221923941, 0.0970398532579703,
      0.08608035092437974, 0.07256872285061707, 0.05753813748800208, 0.04200785192765434,
      0.026912469688101785, 0.013047762853809998, 0.0010341621997915934,
      -0.008702298625631946, -0.01593291441337526, -0.02061531308639449,
      -0.022871330365375673, -0.022956878936109704, -0.021227010861331764,
      -0.018099223954759165, -0.014017734309342288, -0.009420975881941629,
      -0.004714043676627786, -0.0002472177019964375, 0.003698866024189327,
      0.006921356936266811, 0.00929705565574254, 0.010778775202767196, 0.011387224939238726,
      0.011199595134867922, 0.01033607049235951, 0.008945462346889524, 0.007191037004352773,
      0.005237449902009476, 0.003239491140758055, 0.0013331262745005237,
      -0.00037090567908028087, -0.0017908824244786475, -0.0028754033387805335,
      -0.0036024824081439836, -0.003976809752790279, -0.004025628973409554,
      -0.0037937048767439415, -0.003337848006643574, -0.002721424470132704,
      -0.002009218623251968, -0.0012629396308228668, -0.0005375780769299326,
      0.00012126748957026462, 0.0006790559946155279, 0.0011129957120723768,
      0.0014118567902215583, 0.0015750435342383204, 0.0016110947071460604,
      0.001535793879124204, 0.0013700715357866963, 0.0011378683036371176,
      0.0008641068223120234, 0.0005728913063135649, 0.0002860215475856363,
      2.1874709545700143e-05, -0.00020532386694259533, -0.00038584853243089353,
      -0.0005144717872970551, -0.0005901638576666101, -0.0006155564880612739,
      -0.00059624061515181, -0.0005399685759485481, -0.0004558276549985678,
      -0.00035344404216208726, -0.0002422657294235811, -0.00013096062790725576,
      -2.695329450980656e-05, 6.388892897530099e-05, 0.0001374210502574955,
      0.00019124730653828756, 0.00022462794062985992, 0.00023828938834579273,
      0.00023416442027145422, 0.0002150896081528269, 0.00018448637491925694,
      0.00014604919121675137, 0.0001034606080644311, 6.01481920591234e-05,
      1.909347186371482e-05, -1.730190974317297e-05, -4.729219482857959e-05,
      -6.980895409026052e-05, -8.443441974596544e-05, -9.133541960517993e-05,
      -9.116798612413961e-05, -8.49632100801898e-05, -7.400463038675768e-05,
      -5.9706529617847164e-05, -4.350109315551092e-05, -2.674065296319359e-05,
      -1.0619337167121206e-05, 3.883466346962836e-06, 1.603722121321429e-05,
      2.5372896136812038e-05, 3.167641464605285e-05, 3.4966106149645616e-05,
      3.545796437680166e-05, 3.352278062134501e-05, 2.9639172543243557e-05,
      2.4346222129473957e-05, 1.8198926764929926e-05, 1.1729018291602535e-05,
      5.412979686527828e-06, -3.5165324778851115e-07, -5.261325234078471e-06,
      -9.113080625451643e-06, -1.1803542012993634e-05, -1.332141825671175e-05,
      -1.3734973140526504e-05, -1.3176014330762113e-05, -1.1821968611322577e-05,
      -9.877510682529004e-06, -7.557030844759825e-06, -5.068985747599524e-06,
      -2.6029006310546217e-06, -3.195044362656617e-07, 1.6557984749724523e-06,
      3.2361673856491315e-06, 4.373534228768534e-06, 5.056205681755432e-06,
      5.30439371823244e-06, 5.1642704384259555e-06, 4.701155135593365e-06,
      3.992411537529129e-06, 3.1205690645407766e-06, 2.1670929435702157e-06,
      1.2071236193421978e-06, 3.0539526654888524e-07, -4.86565415350533e-07,
      -1.131958622782784e-06, -1.6090329843916077e-06, -1.9103606215510946e-06,
      -2.0412648503862606e-06, -2.017627237106517e-06, -1.8633092659032538e-06,
      -1.6074155582743582e-06, -1.281603380312162e-06, -9.176105680257462e-07,
      -5.451346577857467e-07, -1.9015351580111056e-07, 1.2626460443226955e-07,
      3.886530875083336e-07, 5.873668904280597e-07, 7.183838614449737e-07,
      7.82761026559811e-07, 7.858317438735583e-07, 7.362344577321825e-07,
      6.44861889499745e-07, 5.238119760691779e-07, 3.854100231461533e-07,
      2.413567879191687e-07, 1.0204094486951454e-07, -2.3962082578430084e-08,
      -1.3019849815292107e-07, -2.124590297760872e-07, -2.687349326027691e-07,
      -2.9903409402769213e-07, -3.050896402860721e-07, -2.8999591529699615e-07,
      -2.5780649956077357e-07, -2.131264593663041e-07, -1.607267570414297e-07,
      -1.0520325159255436e-07, -5.0696520564322545e-08, -6.823508008796442e-10,
      4.216337114708977e-08, 7.602712082491229e-08, 9.995387713129222e-08,
      1.1378676523355129e-07, 1.1806236143600091e-07, 1.1387501299774696e-07,
      1.0272365914661727e-07, 8.635385729009197e-08, 6.660620471583151e-08,
      4.5280307005179965e-08, 2.402109124205402e-08, 4.231796573521887e-09,
      -1.2984423167614989e-08, -2.68545306382167e-08, -3.693936553394944e-08,
      -4.311467374063031e-08, -4.5533944531273356e-08, -4.4578149516205133e-08,
      -4.079761285257325e-08, -3.48510108859782e-08, -2.7445969258357556e-08,
      -1.9284974903100568e-08, -1.101943094554458e-08, -3.2137334613080665e-09,
      3.6796880046085805e-09, 9.334288746549032e-09, 1.3552953569415327e-08,
      1.6262428492246852e-08, 1.7500323955948306e-08, 1.7396624734103434e-08,
      1.615172769871022e-08, 1.4012967825259213e-08, 1.1251410534599313e-08,
      8.140414304427512e-09, 4.937132913579256e-09, 1.8677626551436284e-09,
      -8.83025188682933e-10, -3.1783679693757784e-09, -4.931411681380159e-09,
      -6.1038701492554584e-09, -6.7015642817626845e-09, -6.767673428387375e-09,
      -6.374477338923707e-09, -5.614355251925947e-09, -4.590747447988375e-09,
      -3.409685364073762e-09, -2.1723711589400187e-09, -9.691485134121342e-10,
      1.249353074924747e-10, 1.0529107075148664e-09, 1.7770644413472652e-09,
      2.2786685396409772e-09, 2.5564865981088553e-09, 2.6243330477630115e-09,
      2.5079842071770007e-09, 2.241739899700619e-09, 1.864914546496119e-09,
      1.4185011044357911e-09, 9.422046284942817e-10, 4.719892910000864e-10,
      3.822782080722552e-11, -3.355105421288936e-10, -6.330451223533253e-10,
      -8.455934625172052e-10, -9.712879095303128e-10, -1.0143023779418654e-09,
      -9.837035507808357e-10, -8.921426112343912e-10, -7.544974518850084e-10,
      -5.865627412304074e-10, -4.0386800109922657e-10, -2.2068378018054004e-10,
      -4.925484188127535e-11, 1.007214157005553e-10, 2.2237201532318203e-10,
      3.1169778798871515e-10, 3.674246477185512e-10, 3.9069521259634506e-10,
      3.846442941942402e-10, 3.539032180191231e-10, 3.0407618220994157e-10,
      2.412274880115206e-10, 1.7141215186609358e-10, 1.0027483681957168e-10,
      3.2733903641218285e-11, -2.7240698088709444e-11, -7.675447290740169e-11,
      -1.1402562518293794e-10, -1.3834298423501057e-10, -1.4995884592136008e-10,
      -1.499332396225592e-10, -1.3994697658754888e-10, -1.2210040700798602e-10,
      -9.871332144468269e-11, -7.213912981715505e-11, -4.460360802939655e-11,
      -1.807538538401683e-11, 5.827798131856144e-12, 2.5895993956022607e-11,
      4.134863853473093e-11, 5.182449603377302e-11, 5.7345183740272163e-11,
      5.825851451108521e-11, 5.5168332740556697e-11, 4.8857454959478946e-11,
      4.020983087846851e-11, 3.013721038157024e-11, 1.9514540160850617e-11,
      9.127124318314806e-12, -3.6863621174382274e-13, -8.47027476166941e-12,
      -1.4840449411119865e-11, -1.930554545042201e-11, -2.184359834013015e-11,
      -2.256388015012593e-11, -2.1680708554225642e-11, -1.9484052308173194e-11,
      -1.6309348789050838e-11, -1.2508653128032361e-11, -8.424844261485858e-12,
      -4.3701612143820224e-12, -6.098714921817226e-13, 2.6485832740327414e-12,
      5.261033076910983e-12, 7.14703487121916e-12, 8.286027033049509e-12,
      8.710058847209383e-12, 8.49407221223051e-12, 7.74473448346133e-12,
      6.588773584514512e-12, 5.161662409412418e-12, 3.597354153970825e-12,
      2.019599170720559e-12, 5.351923054834006e-13, -7.706789553935318e-13,
      -1.8369793824703866e-12, -2.6273987121756054e-12, -3.129198564874783e-12,
      -3.350659124032528e-12, -3.3174972302841824e-12, -3.0686422969743384e-12,
      -2.651743398564016e-12, -2.118744898762542e-12, -1.52181477001074e-12,
      -9.098453319086158e-13, -3.2567640157719323e-13, 1.958787957957157e-13,
      6.291895473232363e-13, 9.58186591659202e-13, 1.176050961376717e-12,
      1.284332943839284e-12, 1.2916419101476306e-12, 1.2120559801986889e-12,
      1.063397624752207e-12, 8.65509142144233e-13, 6.386426370950078e-13,
      4.0205498609923036e-13, 1.7287159972122695e-13, -3.4744275437574094e-14,
      -2.1010557766442811e-13, -3.4621028884053217e-13, -4.3967526560759083e-13,
      -4.904391091350211e-13, -5.0128713310503e-13, -4.772556595678282e-13,
      -4.249726374870547e-13, -3.5198759003961277e-13, -2.661369605895427e-13,
      -1.7498192980580102e-13, -8.534561290937713e-14, -2.9660601500364153e-15,
      6.772858129430741e-14, 1.2372542155240736e-13, 1.634229305154981e-13,
      1.8653380549180518e-13, 1.939145070778408e-13, 1.8734336907484985e-13,
      1.692694463830722e-13, 1.4255301269958984e-13, 1.1021615856629615e-13,
      7.521860784129499e-14, 4.027001412808707e-14, 7.685949981056369e-15,
      -2.0709142396397882e-14, -4.3632362702772934e-14, -6.034950286381997e-14,
      -7.06447007235037e-14, -7.476002220779125e-14, -7.331332461762098e-14,
      -6.72029923656169e-14, -5.750776973985563e-14, -4.538905484817092e-14,
      -3.200179315975148e-14, -1.841865216798878e-14, -5.57060081352961e-15,
      5.79452346926177e-15, 1.5135300955714248e-14, 2.2122938916318306e-14,
      2.6632454416677124e-14, 2.872158395870552e-14, 2.8600591819890415e-14,
      2.659629631361186e-14, 2.311353871347324e-14, 1.8597024420054043e-14,
      1.3496018661460823e-14, 8.233831276993116e-15, 3.1834278274701958e-15,
      -1.3500957487937746e-15, -5.1400001897995724e-15, -8.0416698879759e-15,
      -9.990378716060348e-15, -1.0994068758191966e-14, -1.1122341176111844e-14,
      -1.0492937205319893e-14, -9.256969746587288e-15, -7.58406724839951e-15,
      -5.648429847528772e-15, -3.616592877084375e-15, -1.6374646994152678e-15,
      1.650271023705608e-16, 1.6965686677402057e-15, 2.8944564826274168e-15,
      3.727205241162964e-15, 4.192137549789588e-15, 4.311406747973139e-15,
      4.126943162938921e-15, 3.694814941873639e-15, 3.079462671209659e-15,
      2.3482091463475075e-15, 1.566369478340518e-15, 7.931999231800187e-16,
      7.883369540638636e-17, -5.377349503645037e-16, -1.0296355920569997e-15,
      -1.3821587267668437e-15, -1.5919793107862027e-15, -1.6657356975085271e-15,
      -1.6181513892980702e-15, -1.4698903713462683e-15, -1.2453269858355017e-15,
      -9.703908837005288e-16, -6.706194465988795e-16, -3.695171878511332e-16,
      -8.728688705959877e-17, 1.6003683168662824e-16, 3.6105194339095836e-16,
      5.090786006618652e-16, 6.019219626367846e-16, 6.413711651630948e-16,
      6.325057876851891e-16, 5.828836738144089e-16, 5.016811948482703e-16,
      3.98849952504706e-16, 2.8434359409583923e-16, 1.6745601222430425e-16,
      5.629884574078543e-17, -4.256708563888904e-17, -1.2434412137798047e-16,
      -1.8606229620010858e-16, -2.2651310176579526e-16, -2.4607573832186204e-16,
      -2.4646291012269507e-16, -2.304146633188154e-16, -2.0136810751688752e-16,
      -1.6312844927051543e-16, -1.1956301092198987e-16, -7.433525457124321e-17,
      -3.06907174134876e-17, 8.698402567936539e-18, 4.1828141385329454e-17,
      6.739956678022577e-17, 8.480341302151056e-17, 9.406109764909363e-17,
      9.573233136545315e-17, 9.080027963445292e-17, 8.05451458184419e-17,
      6.641624736048397e-17, 4.991130400281724e-17, 3.2469920145517464e-17,
      1.538629306177117e-17, -2.5582478758087233e-19, -1.3624796852578552e-17,
      -2.416000788815027e-17, -3.1570030833969194e-17, -3.581316823050211e-17,
      -3.706420357342908e-17, -3.567156127650425e-17, -3.210910574715552e-17,
      -2.6926556168427516e-17, -2.070201201427876e-17, -1.3999439942976353e-17,
      -7.333231823871673e-18, -1.1411694143835331e-18, 4.233620118552081e-18,
      8.551815418431566e-18, 1.1678833444411327e-17, 1.3578666716821679e-17,
      1.430205825709355e-17, 1.3970616802579856e-17, 1.2758513531795306e-17,
      1.0873325541041705e-17, 8.537422256228811e-18, 5.9710535021448536e-18,
      3.3780177331559418e-18, 9.344907442520338e-19, -1.2186985620923632e-18,
      -2.980329198476665e-18, -4.289802239925959e-18, -5.125309010946358e-18,
      -5.4996855396285e-18, -5.454562507629354e-18, -5.053445331540893e-18,
      -4.37433857632104e-18, -3.502470595147314e-18, -2.523587449612399e-18,
      -1.5181796765313351e-18, -5.568910329152485e-19, 3.0275613546313046e-19,
      1.0182911780301445e-18, 1.5629466941986973e-18, 1.925172495338174e-18,
      2.10720835625383e-18, 2.122946164769835e-18, 1.9953260417252284e-18,
      1.7535066994197265e-18, 1.4300306552292115e-18, 1.0581734383316543e-18,
      6.696264192143779e-19, 2.9261913767172655e-19, -4.9457474447287905e-20,
      -3.3890772373706624e-19, -5.640857320058619e-19, -7.192968084712194e-19,
      -8.043175400977192e-19, -8.236214884571487e-19, -7.854044141003408e-19,
      -7.005027258337558e-19, -5.812924339525509e-19, -4.406445934495429e-19,
      -2.909985091170592e-19, -1.4359731060325917e-19, -7.913280555261496e-21,
      1.087262413507435e-19, 2.0131644670943632e-19, 2.6717268007381983e-19,
      3.057742096102133e-19, 3.184867202358593e-19, 3.081994644381573e-19,
      2.7891349458305247e-19, 2.353153979795815e-19, 1.8236695467539452e-19,
      1.2493569212477377e-19, 6.748499077228072e-20, 1.3835746356242898e-20,
      -3.299489248123147e-20, -7.087811098084383e-20, -9.858677725282298e-20,
      -1.1574694130755687e-19, -1.2273962837657537e-19, -1.2056662251331396e-19,
      -1.1069435417412138e-19, -9.488942496589236e-20, -7.505790656685493e-20,
      -5.3098549417264076e-20, -3.077765044336264e-20, -9.63077193282643e-21,
      9.106029695684946e-21, 2.453515115616091e-20, 3.610827887814374e-20,
      4.361244927472349e-20, 4.713583272719897e-20, 4.7018439787994565e-20,
      4.3793200344444414e-20, 3.8122720096433834e-20, 3.073654090603989e-20,
      2.237300193110603e-20, 1.372890177420103e-20, 5.4191818479840444e-21,
      -2.0521350689490065e-21, -8.309443098129349e-21, -1.3111993256621778e-20,
      -1.6350442180735026e-20, -1.8035165614528412e-20, -1.8278301142878625e-20,
      -1.72716180472306e-20, -1.5262286897777828e-20, -1.252846213248731e-20,
      -9.35632734395207e-21, -6.019917837730737e-21, -2.764660845961516e-21,
      2.0480892649491875e-22, 2.7323653153457015e-21, 4.713769980738948e-21,
      6.096115888360145e-21, 6.873939654517062e-21, 7.082741590311287e-21,
      6.790717994599915e-21, 6.0895130124667895e-21, 5.084746090715464e-21,
      3.8869769290410244e-21, 2.6036452811100397e-21, 1.3323806672422053e-21,
      1.5592903620547153e-22, -8.611996780095865e-22, -1.6743885194584174e-21,
      -2.2590094220243493e-21, -2.6091768541299182e-21, -2.7354356295416436e-21,
      -2.661690279845853e-21, -2.421689451643501e-21, -2.0553631515306844e-21,
      -1.6052774848883477e-21, -1.1134255547603401e-21, -6.185193070021403e-22,
      -1.538900477368922e-22, 2.539506302279624e-22, 5.860891274579566e-22,
      8.313709107239628e-22, 9.860226969470321e-22, 1.0528385841215987e-21,
      1.0400471119952368e-21, 9.599805672034876e-22, 8.276634922607094e-22,
      6.594258577419683e-22, 4.716295069618354e-22, 2.7957617394560534e-22,
      9.664345700638067e-23, -6.632670932655652e-23, -2.0138286189215906e-22,
      -3.035755441183191e-22, -3.7085324484517235e-22, -4.037807530989375e-22,
      -4.051242604291259e-22, -3.7935000401040716e-22, -3.3208224044149185e-22,
      -2.6956243847732254e-22, -1.9814545616405398e-22, -1.2386085127571857e-22,
      -5.205908522266695e-23, 1.2846111409764742e-23, 6.753595956432936e-23,
      1.0984926249711262e-22, 1.3875907172308906e-22, 1.5427733802613633e-22,
      1.57304271380695e-22, 1.494403960319472e-22, 1.3277917195818762e-22,
      1.0969676781012466e-22, 8.265336757615052e-23, 5.40175522809795e-23,
      2.592209982831695e-23, 1.562547227571264e-25, -2.190363296829237e-23,
      -3.932602397172349e-23, -5.1621941210268753e-23, -5.87136334764076e-23,
      -6.088042942062369e-23, -5.868867028064022e-23, -5.2912674328904193e-23,
      -4.445327917076879e-23, -3.425972481568615e-23, -2.3259587204429834e-23,
      -1.2300257551414515e-23, -2.104191388892633e-24, 6.761084677772931e-24,
      1.3898343776776295e-23, 1.9082494686817532e-23, 2.2250713059458125e-23,
      2.3483212040815003e-23, 2.2977280377881996e-23, 2.1017284465759493e-23,
      1.7943210098908192e-23, 1.4120045223024426e-23, 9.909917164447764e-24,
      5.6484387646195336e-24, 1.6262283496142767e-24, -1.923914557838071e-24,
      -4.834141257044942e-24, -7.003340660542491e-24, -8.394233080151873e-24,
      -9.026641047294725e-24, -8.967935785525064e-24, -8.321701619512218e-24,
      -7.215628704043299e-24, -5.789550008490285e-24, -4.184396795039386e-24,
      -2.5326741147725056e-24, -9.508700665152369e-25, 4.659756283413544e-25,
      1.6474942196217764e-24, 2.5491061129897924e-24, 3.1512638623340414e-24,
      3.4571407482978235e-24, 3.489142757936561e-24, 3.284645481355075e-24,
      2.891351039372837e-24, 2.3626284191086598e-24, 1.753149285322933e-24,
      1.1150666872887576e-24, 4.94912314257111e-25, -6.868513649275787e-26,
      -5.464272783402093e-25, -9.18947405221827e-25, -1.176665077443376e-24,
      -1.3190112999792366e-24, -1.3531665695284693e-24, -1.2924659194004669e-24,
      -1.1546249913161954e-24, -9.599308410915371e-25, -7.295228013019418e-25,
      -4.838646629660104e-25, -2.414821179450084e-25, -1.801110990941087e-26,
      1.7442450484504026e-25, 3.2751212502666578e-25, 4.367531308815729e-25,
      5.012117456716123e-25, 5.23063338683571e-25, 5.070011165011002e-25,
      4.595610583919715e-25, 3.8842175172217435e-25, 3.0172927964005945e-25,
      2.0748841461651903e-25, 1.1305101461489546e-25, 2.4721602313253265e-26,
      -5.251056189780438e-26, -1.151133519492193e-25, -1.6103634610949168e-25,
      -1.8963338117457828e-25, -2.015029520434882e-25, -1.9826891308441617e-25,
      -1.8232466615033278e-25, -1.565631026555281e-25, -1.2411230214487073e-25,
      -8.809372216442535e-26, -5.141570575363233e-26, -1.6610935713418038e-26,
      1.427770046350506e-26, 3.9762232267247916e-26, 5.892845601325917e-26,
      7.1413934146058e-26, 7.735249822492367e-26, 7.729377519246517e-26,
      7.210668761776148e-26, 6.287565266781456e-26, 5.07974313765777e-26,
      3.708538966676798e-26, 2.2886464765253167e-26, 9.214522741049377e-27,
      -3.0978280476254207e-27, -1.3428427179179083e-26, -2.1376556065507745e-26,
      -2.675762943231858e-26, -2.9584288561935306e-26, -3.0037114159343715e-26,
      -2.842840243852717e-26, -2.5162412346747456e-26, -2.0695234825892096e-26,
      -1.5497005658316326e-26, -1.0018635150368797e-26, -4.6646142645621265e-27,
      2.271719715957263e-28, 4.398292903910586e-27, 7.675487067960564e-27,
      9.969892504513208e-27, 1.1270779019364571e-26, 1.1634991945863877e-26,
      1.1173427514944539e-26, 1.0035866807043615e-26, 8.39541295018874e-27,
      6.433623071823402e-27, 4.327222905779892e-27, 2.237058708157573e-27,
      2.996980233761258e-28, -1.37814455588366e-27, -2.722393642342668e-27,
      -3.691828276712345e-27, -4.2760826490093395e-27, -4.491884596855778e-27,
      -4.3780360394163284e-27, -3.9896503973681136e-27, -3.39213714055394e-27,
      -2.6553697148240795e-27, -1.8483979896273906e-27, -1.0349780905112386e-27,
      -2.7009880183280534e-28, 4.0240835048416147e-28, 9.511728104536598e-28,
      1.3575725240832001e-27, 1.615132751857504e-27, 1.7282043003654938e-27,
      1.7101129490441573e-27, 1.580979330787664e-27, 1.3654016862120779e-27,
      1.0901752708806352e-27, 7.821946937976605e-28, 4.6665220964565955e-28,
      1.6560901675540107e-28, -1.0301929024153907e-28, -3.2605542338706494e-28,
      -4.952527146086987e-28, -6.071320086050979e-28, -6.625252393947317e-28,
      -6.658983303229299e-28, -6.245302459563569e-28, -5.476235028711146e-28,
      -4.454151395639462e-28, -3.283471629412834e-28, -2.0634302371750585e-28,
      -8.822291203819941e-29, 1.8723290812764368e-29, 1.089997631567289e-28,
      1.7901122086976573e-28, 2.270277304382311e-28, 2.5303062865933455e-28,
      2.584669375515929e-28, 2.4594179392317747e-28, 2.1887827476036593e-28,
      1.8117192862790423e-28, 1.3686373601296814e-28, 8.985057510115847e-29,
      4.364702541407396e-29, 1.2069347733994868e-30, -3.5192011977954035e-29,
      -6.400213817005787e-29, -8.440333882180367e-29, -9.625264220291271e-29,
      -9.999604508055746e-29, -9.655392241756165e-29, -8.719143852513505e-29,
      -7.338473527903577e-29, -5.669239943628829e-29, -3.86399897198165e-29,
      -2.0623414158601405e-29, -3.834860217624044e-30, 1.0787052610287131e-29,
      2.2583078694481202e-29, 3.117686324883002e-29, 3.6459151517852775e-29,
      3.855652446556646e-29, 3.7788970571766745e-29, 3.4620723680174414e-29,
      2.960860541757539e-29, 2.3351665202084403e-29, 1.6445277535995554e-29,
      9.442104314568617e-30, 2.8215263632771764e-30, -3.0316458207628916e-30,
      -7.839105657202551e-30, -1.1432184728355972e-29, -1.3747248560002863e-29,
      -1.4814776086040753e-29, -1.474375959538693e-29, -1.3703136869681843e-29,
      -1.1901917568098826e-29, -9.569512967019584e-30, -6.93754698119645e-30,
      -4.2241436271549074e-30, -1.6213779715448047e-30, 7.137317293099848e-31,
      2.6646028134863043e-30, 4.157003895379318e-30, 5.1578796332050036e-30,
      5.671608505035379e-30, 5.7343125467873354e-30, 5.4068781945546365e-30,
      4.76733796031065e-30, 3.9032114343176365e-30, 2.9043204868603222e-30,
      1.8564877645520236e-30, 8.364098680234935e-31, -9.21234980864208e-32,
      -8.806072695062313e-31, -1.4968400167857385e-30, -1.9247124484747534e-30,
      -2.1629569589628477e-30, -2.2230911781874066e-30, -2.126808445277912e-30,
      -1.9030684045880647e-30, -1.5851243318774656e-30, -1.2076938760605563e-30,
      -8.044405594326684e-31, -4.05888589977744e-31, -3.784706551310462e-32,
      2.796251774099493e-31, 5.327232551842447e-31, 7.139116499274765e-31,
      8.215207460596172e-31, 8.590117209766989e-31, 8.340064791562556e-31,
      7.571809879035576e-31, 6.411152643644304e-31, 4.991826944470401e-31,
      3.4454682489306288e-31, 1.8931679886026315e-31, 4.3894681588636563e-32,
      -8.346962534607606e-32, -1.8691624300712228e-31, -2.630200289255841e-31,
      -3.1066703249499784e-31, -3.307951713199738e-31, -3.2603594691837616e-31,
      -3.002952844512609e-31, -2.5831013373469662e-31, -2.0521379527659816e-31,
      -1.4613760069677816e-31, -8.587017570170045e-32, -2.8588625081044436e-32,
      2.233086889812246e-32, 6.442190154543615e-32, 9.616053754555557e-32,
      1.1693065227285133e-31, 1.2693394030007364e-31, 1.2705855274611278e-31,
      1.1872106081582678e-31, 1.0369609571260512e-31, 8.394676431388189e-32,
      6.14669990505119e-32, 3.814459786070859e-32, 1.5651072151505493e-32,
      -4.638243342684053e-33, -2.169287424997647e-32, -3.4845949419391134e-32,
      -4.378607584584568e-32, -4.852676094451932e-32, -4.935865278938768e-32,
      -4.679025061622675e-32, -4.1482688879547354e-32, -3.418378382451705e-32,
      -2.566583211628483e-32, -1.6670754162661645e-32, -7.86516846365221e-33,
      1.930497209347069e-34, 7.076159365305884e-33, 1.2496210800900331e-32,
      1.63040196075164e-32, 1.8479066364228645e-32, 1.9112302318745823e-32,
      1.838402690228146e-32, 1.6539018132223795e-32, 1.3860964930989859e-32,
      1.0648001241083354e-32, 7.190808986507012e-33, 3.754374608526366e-33,
      5.6408463645976385e-34, -2.2035414794920515e-33, -4.425534247042976e-33,
      -6.032922720535338e-33, -7.007529720688712e-33, -7.375853614937254e-33,
      -7.200863487063724e-33, -6.572553940214824e-33, -5.598066152198703e-33,
      -4.3920942853821676e-33, -3.0681736693756412e-33, -1.73130254882939e-33,
      -4.7219539746490935e-34, 6.366856143606436e-34, 1.5433137278648645e-33,
      2.216607714580041e-33, 2.645476407830729e-33, 2.8366725353046025e-33,
      2.8117702246520696e-33, 2.6035934499957555e-33, 2.2524119733688638e-33,
      1.8021911288251193e-33, 1.2971369172309433e-33, 7.787234256348207e-34,
      2.8333055651579205e-34, -1.594389681002737e-34, -5.277494534895809e-34,
      -8.07863122720665e-34, -9.938851049778953e-34, -1.0870239771494424e-33,
      -1.0944868763079652e-33, -1.0281353200798086e-33, -9.03025581517106e-34,
      -7.359472743894009e-34, -5.4405753056024854e-34, -3.436877523359037e-34,
      -1.4937734994347528e-34, 2.6834058673306395e-35, 1.758462257095344e-34,
      2.916791023908566e-34, 3.7142022197942043e-34, 4.149758048592552e-34,
      4.246704370890368e-34, 4.047437682533582e-34, 3.6079253080046944e-34,
      2.992028500349146e-34, 2.266119730656645e-34, 1.4943094619001344e-34,
      7.345117198610443e-35, 3.548895363917259e-36, -5.650686679126687e-35,
      -1.0414510786743449e-34, -1.3799090171794112e-34, -1.5778426139165623e-34,
      -1.6423660401589094e-34, -1.5884336036121276e-34, -1.4367150827088222e-34,
      -1.2113976704275135e-34, -9.38071192816828e-35, -6.418251364528773e-35,
      -3.456534033767031e-35, -6.922842609657886e-36, 1.7192716149344996e-35,
      3.668735892630331e-35, 5.093199821417043e-35, 5.973719084177519e-35,
      6.330231590806642e-35, 6.214624247170785e-35, 5.702676455173896e-35,
      4.885577782384181e-35, 3.861644944584828e-35, 2.7287598308789904e-35,
      1.5779271297368806e-35, 4.8821822113536635e-36, -4.767625918361654e-36,
      -1.2708742376183162e-35, -1.865986533501933e-35, -2.2512518734030988e-35,
      -2.431333388413955e-35, -2.423857847421784e-35, -2.2563743941750698e-35,
      -1.96309251458976e-35, -1.5816478671244292e-35, -1.1501068957067125e-35,
      -7.043748535301199e-36, -2.761213107281864e-36, 1.0871362565349528e-36,
      4.308168640450162e-36, 6.778300000576389e-36, 8.44167527766576e-36,
      9.304111541180327e-36, 9.423816103160185e-36, 8.899961625736403e-36,
      7.86018660136474e-36, 6.448006905185974e-36, 4.810987856385549e-36,
      3.090353164378601e-36, 1.4125140851185543e-36, -1.1719521413108184e-37,
      -1.418477955730008e-36, -2.4377998884500004e-36, -3.148086999332199e-36,
      -3.546708316298419e-36
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_4_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<4>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 7.7184096185762e-05), "design.b()[0] == 7.7184096185762e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 7.7184096185762e-05));
    static_assert(almost_equal(design.b()[1], 0.000308736384743048), "design.b()[1] == 0.000308736384743048");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.000308736384743048));
    static_assert(almost_equal(design.b()[2], 0.00046310457711457205), "design.b()[2] == 0.00046310457711457205");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.00046310457711457205));
    static_assert(almost_equal(design.b()[3], 0.000308736384743048), "design.b()[3] == 0.000308736384743048");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.000308736384743048));
    static_assert(almost_equal(design.b()[4], 7.7184096185762e-05), "design.b()[4] == 7.7184096185762e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 7.7184096185762e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.639824534558878), "design.a()[1] == -3.639824534558878");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.639824534558878));
    static_assert(almost_equal(design.a()[2], 5.035260720891305), "design.a()[2] == 5.035260720891305");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 5.035260720891305));
    static_assert(almost_equal(design.a()[3], -3.1344249904821635), "design.a()[3] == -3.1344249904821635");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -3.1344249904821635));
    static_assert(almost_equal(design.a()[4], 0.7402969248122844), "design.a()[4] == 0.7402969248122844");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.7402969248122844));
    std::cout << "max_deviation(cheby1,lowpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      7.7184096185762e-05, 0.0005896729517177368, 0.002220768606340879, 0.005664715151676783,
      0.011304750839874301, 0.0191482913107651, 0.02888564920970617, 0.03996237791782237,
      0.0516592792684919, 0.06317419985249578, 0.07370018154761138, 0.08249527235613802,
      0.08894027222863601, 0.0925818053816691, 0.09315929293563124, 0.09061556743866914,
      0.08509195150088472, 0.07690955539667854, 0.0665392866470047, 0.054563578058006684,
      0.04163311607890163, 0.028421891533742666, 0.015583717393845911,
      0.0037129932827213857, -0.0066880167350286245, -0.01523374228901361,
      -0.02167072009909904, -0.02588355881829181, -0.02789179102730764,
      -0.027838512329779533, -0.02597216654327872, -0.02262316916660788,
      -0.018177257769560737, -0.013047516515081146, -0.007646950443088586,
      -0.002363298871540357, 0.0024625021852853427, 0.006553145632756895,
      0.009706390578245648, 0.011800833041497441, 0.012796115054877693,
      0.012728022072190509, 0.01169920639660945, 0.009866491280758748, 0.007425848437081436,
      0.004596198631539566, 0.0016031639108858159, -0.0013361913361559404,
      -0.004026743188015196, -0.006306121586199814, -0.008052483088943622,
      -0.009189005328752348, -0.009685094734093014, -0.009554509648414963,
      -0.008850781013557771, -0.007660453325883908, -0.006094763940247529,
      -0.0042804266693829245, -0.0023501869147159633, -0.00043377408156446834,
      0.0013502009938697913, 0.002900962401154096, 0.004140583916031731,
      0.005017122249663204, 0.0055058245062427295, 0.005608492682186777,
      0.005351199213795524, 0.004780637034407096, 0.003959451429221678,
      0.0029609372346010594, 0.0018634936029923999, 0.0007452113948914763,
      -0.00032107147783471063, -0.0012719693183418544, -0.0020567958955298943,
      -0.002639731184133471, -0.0030008589358483315, -0.0031361027147178352,
      -0.003056156190589611, -0.0027845598313423845, -0.0023551180484090283,
      -0.0018088768536513554, -0.0011908918429125604, -0.0005470105640893157,
      7.912628162984672e-05, 0.0006486914072119901, 0.0011297514283996812,
      0.0014987322373075321, 0.0017412269912084107, 0.0018521500134860381,
      0.0018352814561939821, 0.0017022827889211596, 0.0014712903331195746,
      0.0011652120906320814, 0.0008098616283399558, 0.00043206202754782425,
      5.7843708757273704e-05, -0.0002891564067433002, -0.0005890087946445724,
      -0.0008264581888005012, -0.0009915105316167824, -0.001079634190572036,
      -0.0010915947821948206, -0.00103296477028147, -0.0009133663743230648,
      -0.0007455184980280855, -0.0005441650215362234, -0.0003249629326831059,
      -0.00010340478952550517, 0.00010615840981051942, 0.0002913398144792698,
      0.0004423450368432805, 0.0005523822139198282, 0.0006178457964817244,
      0.0006382811931017098, 0.0006161508211340028, 0.0005564331057142879,
      0.000466094021687844, 0.00035347562179373197, 0.00022764759490262053,
      9.776641941794753e-05, -2.7517529217527888e-05, -0.00014057099481785108,
      -0.0002351811279741135, -0.0003068342418632259, -0.0003528626024294206,
      -0.0003724608814029229, -0.00036658210222806006, -0.0003377297970060648,
      -0.0002896683360501275, -0.00022707679247252986, -0.00015517319866692155,
      -7.933570317676219e-05, -4.745121397675505e-06, 6.393004009652127e-05,
      0.00012278948293991635, 0.0001688865028053181, 0.0002003368901803529,
      0.00021635076600003502, 0.00021719175041530275, 0.0002040721443183855,
      0.0001789961718757949, 0.00014456564894888945, 0.00010376364654827904,
      5.9731826208600004e-05, 1.5556220044919743e-05, -2.5925545416644913e-05,
      -6.228503968867744e-05, -9.162421748011825e-05, -0.00011265256020710879,
      -0.00012471891255000427, -0.00012779975996402736, -0.00012244833382858293,
      -0.00010971107058786744, -9.101949475495995e-05, -6.806649405632936e-05,
      -4.267620467408807e-05, -1.6676363690930264e-05, 8.218911483079072e-06,
      3.0509288526978885e-05, 4.898634673286873e-05, 6.278650685903798e-05,
      7.141748204536524e-05, 7.475876847304693e-05, 7.303831185353276e-05,
      6.678883154556339e-05, 5.678829472132623e-05, 4.3989671859834696e-05,
      2.9445362108794054e-05, 1.423156812824072e-05, -6.225375473707399e-07,
      -1.419672338515967e-05, -2.5729471452311256e-05, -3.465344119328668e-05,
      -4.061555041860936e-05, -4.348167326157182e-05, -4.332693895018808e-05,
      -4.041345423033097e-05, -3.515792460608935e-05, -2.8092089089221638e-05,
      -1.9819099521765714e-05, -1.0968973544508295e-05, -2.1560482882835392e-06,
      6.059010514198355e-06, 1.3200594013735668e-05, 1.890147406020031e-05,
      2.2917246384709792e-05, 2.513171066812093e-05, 2.5553600030522424e-05,
      2.4305591421491647e-05, 2.1606944419812004e-05, 1.7751411042985483e-05,
      1.308222454123048e-05, 7.966011058981765e-06, 2.767383001589044e-06,
      -2.1742175148407455e-06, -6.564131641395564e-06, -1.0167594396842906e-05,
      -1.281975216150835e-05, -1.4430371469540047e-05, -1.4983381109588585e-05,
      -1.4531708206979118e-05, -1.3188131547603895e-05, -1.1113069798916254e-05,
      -8.500341744394532e-06, -5.5619787890555665e-06, -2.513140427382726e-06,
      4.419109466756558e-07, 3.1219671261656914e-06, 5.378541343205882e-06,
      7.102635143684687e-06, 8.22841415972176e-06, 8.733815720869777e-06,
      8.638305603756146e-06, 7.998165450106239e-06, 6.8998184943456165e-06,
      5.4517843494106965e-06, 3.775891977025912e-06, 1.998374896079709e-06,
      2.414281121357288e-07, -1.3842716684189e-06, -2.785684475553064e-06,
      -3.891886422732182e-06, -4.6567602667141e-06, -5.059874412327837e-06,
      -5.105645382965448e-06, -4.820980652843306e-06, -4.251679510871918e-06,
      -3.457925892838193e-06, -2.509237325238862e-06, -1.479238513992657e-06,
      -4.406085590867911e-07, 5.394894682536891e-07, 1.4032444839003838e-06,
      2.105114816003372e-06, 2.613717156495698e-06, 2.9126520703991923e-06,
      3.0003020437741667e-06, 2.8887007750205896e-06, 2.60162358684919e-06,
      2.1720861484671082e-06, 1.6394609196957066e-06, 1.0464276991877258e-06,
      4.359672051372495e-07, -1.5141357997545962e-07, -6.800661530183161e-07,
      -1.121075321953382e-06, -1.4535467642891935e-06, -1.6652739785670646e-06,
      -1.752793779341987e-06, -1.7208778377675201e-06, -1.5815398806876534e-06,
      -1.352662497975175e-06, -1.0563631629465303e-06, -7.172257674145372e-07,
      -3.605220308724476e-07, -1.0537407949447705e-08, 3.109001368953636e-07,
      5.856113092444507e-07, 7.999237996444424e-07, 9.451706179047103e-07,
      1.017826623475381e-06, 1.0193047258947868e-06, 9.554532077097003e-07,
      8.358112808693793e-07, 6.726906853494891e-07, 4.801566055199521e-07,
      2.729815025666608e-07, 6.564104894475798e-08, -1.2858711900775675e-07,
      -2.9837276093273203e-07, -4.348952488015189e-07, -5.321982991896526e-07,
      -5.873318522232662e-07, -6.002897927345239e-07, -5.737645433811478e-07,
      -5.127495185848975e-07, -4.2402757333459713e-07, -3.155876900351557e-07,
      -1.9601321028698066e-07, -7.388312297545163e-08, 4.277638107844829e-08,
      1.469592000575403e-07, 2.3304234029130574e-07, 2.970301467489051e-07,
      3.366740391415401e-07, 3.514704883451185e-07, 3.425475286463748e-07,
      3.12456372219982e-07, 2.64889379799368e-07, 2.0434857803929484e-07,
      1.357900579273779e-07, 6.426901628599359e-08, -5.391906184602363e-09,
      -6.889171857960169e-08, -1.2268266563509706e-07, -1.641342923937282e-07,
      -1.9162512979633727e-07, -2.0456217908541283e-07, -2.0333297685528972e-07,
      -1.891989362367746e-07, -1.6414169033353423e-07, -1.3067619148703452e-07,
      -9.164529829436258e-08, -5.00105365460266e-08, -8.652738821298148e-09,
      2.980550871800623e-08, 6.31460747753553e-08, 8.966341053011137e-08,
      1.0823085882527603e-07, 1.183243945855197e-07, 1.2000583194523635e-07,
      1.138699565843791e-07, 1.0096197726762673e-07, 8.267305544817715e-08,
      6.062242636261855e-08, 3.653477199308974e-08, 1.2121086938236082e-08,
      -1.102963327867638e-08, -3.154185622371949e-08, -4.8323684478856294e-08,
      -6.061302422942299e-08, -6.799880115474598e-08, -7.041794978419995e-08,
      -6.813039165378318e-08, -6.167544071811592e-08, -5.1813975508628626e-08,
      -3.946126573187635e-08, -2.561553076212075e-08, -1.128715658775649e-08,
      2.5669556830517044e-09, 1.5100138396429267e-08, 2.5620916057901976e-08,
      3.362428247207056e-08, 3.880843779038792e-08, 4.1077128769402224e-08,
      4.052864455796135e-08, 3.743328613358953e-08, 3.220171306360903e-08,
      2.5346954166137096e-08, 1.7443041315565787e-08, 9.083194583335608e-09,
      8.402711237134202e-10, -6.768181066935923e-09, -1.3308413435771262e-08,
      -1.845122766991767e-08, -2.1984305740382647e-08, -2.3816033496853744e-08,
      -2.3971283440144317e-08, -2.258009780416743e-08, -1.9860588677797163e-08,
      -1.6097631902792532e-08, -1.1619068915362686e-08, -6.77114699835831e-09,
      -1.894832649435345e-09, 2.695559569866832e-09, 6.730248890472894e-09,
      9.997528303422698e-09, 1.2352458986259128e-08, 1.3720567562337218e-08,
      1.409672690199877e-08, 1.3539694201588325e-08, 1.2163018332190811e-08,
      1.0123201266209801e-08, 7.606100174943274e-09, 4.812586963424775e-09,
      1.9444446188477406e-09, -8.086171712113258e-10, -3.280089954370473e-09,
      -5.335381134529258e-09, -6.877759287428929e-09, -7.851381058304501e-09,
      -8.241449673938775e-09, -8.071734418348503e-09, -7.399830094827008e-09,
      -6.310648427344387e-09, -4.908705384866158e-09, -3.3097983499383442e-09,
      -1.632656497185255e-09, 8.899245649226443e-12, 1.5128276633605633e-09,
      2.7944114381536384e-09, 3.79023020354677e-09, 4.460439484094044e-09,
      4.789351180546929e-09, 4.784420274753705e-09, 4.4738356451885375e-09,
      3.902985658353401e-09, 3.1301185847174663e-09, 2.2215426742035105e-09,
      1.2467113835634598e-09, 2.7351774885297574e-10, -6.359185341508307e-10,
      -1.4287429533411277e-09, -2.0639737744880002e-09, -2.514132403569282e-09,
      -2.7658738126764875e-09, -2.8196601878106605e-09, -2.6885785597822203e-09,
      -2.3964495270803867e-09, -1.9754072467954157e-09, -1.4631496499290165e-09,
      -9.000623221767832e-10, -3.26410587187307e-10, 2.2022627612865054e-10,
      7.071347623152177e-10, 1.1081536068246574e-09, 1.4048002904970795e-09,
      1.5868122700070664e-09, 1.6521171772284786e-09, 1.6062815708661389e-09,
      1.4615170415234584e-09, 1.2353442087083007e-09, 9.490286391273378e-10,
      6.259077854770883e-10, 2.897250725742549e-10, -3.6922895307633314e-11,
      -3.3393611658622165e-10, -5.847885666404881e-10, -7.77286987294926e-10,
      -9.039891503192611e-10, -9.622832695546542e-10, -9.541517732105546e-10,
      -8.856609017596157e-10, -7.662316740782688e-10, -6.077571132212499e-10,
      -4.2363504022263383e-10, -2.277853587867222e-10, -3.3715991309044636e-11,
      1.463068425520233e-10, 3.0193963827153864e-10, 4.252627607258719e-10,
      5.110846977121472e-10, 5.570463890246981e-10, 5.635356492702006e-10,
      5.334330147012742e-10, 4.717193474431294e-10, 3.849818414249828e-10,
      2.808585141645299e-10, 1.674618569551713e-10, 5.282025340537148e-11,
      -5.562858403589827e-11, -1.5146409718673568e-10, -2.2960868834020218e-10,
      -2.8654041312997636e-10, -3.203883979678177e-10, -3.3091466972849034e-10,
      -3.193930438158106e-10, -2.8840141317394943e-10, -2.415479561733482e-10,
      -1.8315429549514094e-10, -1.179194710213452e-10, -5.058782470193561e-11,
      1.4358283397688625e-11, 7.296334374951935e-11, 1.2200774810386167e-10,
      1.5915230946979648e-10, 1.83014394060839e-10, 1.9317650485507102e-10,
      1.9013240747007474e-10, 1.7517945951349701e-10, 1.5026852285753313e-10,
      1.17824601658036e-10, 8.055212431966318e-11, 4.1238607885545787e-11,
      2.569399744747508e-12, -3.303557701100396e-11, -6.355446812075069e-11,
      -8.745959286199445e-11, -1.0377391180400225e-10, -1.1208755469204768e-10,
      -1.1253668584305299e-10, -1.0574920360535322e-10, -9.27635166725639e-11,
      -7.492784112144134e-11, -5.378808664827243e-11, -3.0972456782484884e-11,
      -8.080419706959555e-12, 1.341721255188654e-11, 3.226163197212081e-11,
      4.74688612775467e-11, 5.836975383001427e-11, 6.462651370581826e-11,
      6.622663954076397e-11, 6.345656451578947e-11, 5.6858373991998194e-11,
      4.717378251660834e-11, 3.528001781199444e-11, 2.212238903853364e-11,
      8.648129863954636e-12, -4.2543579553688045e-12, -1.580742471987853e-11,
      -2.538467302653931e-11, -3.2538400730729614e-11, -3.7013321257558356e-11,
      -3.874682929898237e-11, -3.7856918262695635e-11, -3.4619553398270003e-11,
      -2.9437828444967545e-11, -2.2805564905990706e-11, -1.526814655014369e-11,
      -7.383325445900309e-12, 3.1549080769057923e-13, 7.351329252956522e-12,
      1.3329452252926762e-11, 1.7955743303063784e-11, 2.1047120899564208e-11,
      2.2533979875502683e-11, 2.245516967821658e-11, 2.094645394529809e-11,
      1.8223733899128232e-11, 1.4562545963903908e-11, 1.027545624400733e-11,
      5.688973564402713e-12, 1.1214981716660273e-12, -3.1363697250260915e-12,
      -6.838098914964571e-12, -9.793318656827601e-12, -1.1875307942964153e-11,
      -1.3023787710289587e-11, -1.3243229546507659e-11, -1.2597163426067496e-11,
      -1.1199182669261969e-11, -9.201497306590064e-12, -6.781972794573582e-12,
      -4.130609694973588e-12, -1.4363759049463838e-12, 1.1247956384158122e-12,
      3.4001732858121956e-12, 5.268059972904284e-12, 6.642987172172652e-12,
      7.478157602027367e-12, 7.765210138845762e-12, 7.531545547495718e-12,
      6.83558776075749e-12, 5.7604562163276726e-12, 4.4065867052106835e-12,
      2.8838605768555023e-12, 1.303786854399116e-12, -2.2776703761456235e-13,
      -1.6168767136675499e-12, -2.7865721316924893e-12, -3.680345899027847e-12,
      -4.264059638631743e-12, -4.526260213275178e-12, -4.477018343808173e-12,
      -4.145487285963397e-12, -3.576444606083915e-12, -2.8261231866407983e-12,
      -1.957657501563359e-12, -1.0364685910984056e-12, -1.2588808334206244e-13,
      7.167187593441307e-13, 1.4431246203743178e-12, 2.0165623390363686e-12,
      2.41312011217429e-12, 2.6221978331345445e-12, 2.6460737636429754e-12,
      2.4986835399249115e-12, 2.2037553859844174e-12, 1.7924745788536008e-12,
      1.3008658769801512e-12, 7.670849091588249e-13, 2.287993984201279e-13,
      -2.79179753271446e-13, -7.268868385704137e-13, -1.0907137502655468e-12,
      -1.354389408150786e-12, -1.5094080519367281e-12, -1.5549250174618006e-12,
      -1.497171124822897e-12, -1.3484633331799854e-12, -1.1259086607106896e-12,
      -8.499098917362705e-13, -5.425852121621691e-13, -2.2621005751669578e-13,
      7.822100405088594e-14, 3.5223037769935804e-13, 5.808293279544938e-13,
      7.531855325647484e-13, 8.629690094262483e-13, 9.083811407159753e-13,
      8.918913966131891e-13, 8.197230056955652e-13, 7.011414354620782e-13,
      5.476076637117705e-13, 3.7186169606507655e-13, 1.8700078211397476e-13,
      5.611740506322209e-15, -1.6099161847796547e-13, -3.033859646964641e-13,
      -4.1448342908153555e-13, -4.897900294884261e-13, -5.274765856260429e-13,
      -5.282732423576577e-13, -4.952090762745053e-13, -4.3322637766525014e-13,
      -3.4870474644960493e-13, -2.4893297614295735e-13, -1.415668694247142e-13,
      -3.410884414380056e-14, 6.655919932026566e-14, 1.5456431321263146e-13,
      2.253339620568985e-13, 2.757799585174355e-13, 3.043720863191024e-13,
      3.111059108057335e-13, 2.973756709033752e-13, 2.657683087662598e-13,
      2.1979839772266264e-13, 1.6360586007974685e-13, 1.0163891893948751e-13,
      3.8343798852427344e-14, -2.2119537928069093e-14, -7.611960866386096e-14,
      -1.20741596461348e-13, -1.5391397838279588e-13, -1.7447063444504118e-13,
      -1.8214985119349985e-13, -1.775355524405532e-13, -1.6194934032617086e-13,
      -1.3730435995296723e-13, -1.0593352351525073e-13, -7.040522343864153e-14,
      -3.3339368171006364e-14, 2.764517891116028e-15, 3.567714094342459e-14,
      6.355948621971423e-14, 8.504787661707369e-14, 9.930152158944458e-14,
      1.0601264633789461e-13, 1.0538167759500812e-13, 9.806199092176692e-14,
      8.508029549575933e-14, 6.773978356978329e-14, 4.751367927786038e-14,
      2.5936798191270898e-14, 4.502220785003373e-15, -1.5430737230814964e-14,
      -3.271231366666446e-14, -4.645835539268521e-14, -5.608470229811394e-14,
      -6.13195095058348e-14, -6.219456157048615e-14, -5.901788831925699e-14,
      -5.233099531225363e-14, -4.285472951196814e-14, -3.142819208129364e-14,
      -1.894518665015897e-14, -6.292474306119936e-15, 5.706365633094939e-15,
      1.6338345809910173e-14, 2.503744790168949e-14, 3.1408560677811626e-14,
      3.523848625922779e-14, 3.64943902076917e-14, 3.5310842943803515e-14,
      3.196723401226292e-14, 2.6857807829974034e-14, 2.04568538209138e-14,
      1.3281682342532412e-14, 5.855939750909664e-15, -1.3244189292657872e-15,
      -7.820544849314896e-15, -1.32740011001187e-14, -1.742297855949223e-14,
      -2.0110976431817988e-14, -2.12880213185193e-14, -2.1004969812589722e-14,
      -1.9401836563121348e-14, -1.6691393308346724e-14, -1.3139482907721077e-14,
      -9.04358198313706e-15, -4.711129772705752e-15, -4.390290473076135e-16,
      3.5044674165430313e-15, 6.894525238964533e-15, 9.560486254453071e-15,
      1.1392262408687383e-14, 1.2342321064553163e-14, 1.2423502800286097e-14,
      1.1703159254706907e-14, 1.0294293278452264e-14, 8.344518452701152e-15,
      6.023726315992218e-15, 3.5113581392630247e-15, 9.841285071297382e-16,
      -1.3950516791064274e-15, -3.486344310249798e-15, -5.180003278766555e-15,
      -6.400882611699781e-15, -7.110354792710329e-15, -7.305732786228007e-15,
      -7.017441160374436e-15, -6.304305209472626e-15, -5.247416570356722e-15,
      -3.9430866092381605e-15, -2.4954145244458095e-15, -1.0089777613487089e-15,
      4.1789786931475473e-16, 1.6989062516961173e-15, 2.7642785187012363e-15,
      3.563865514060546e-15, 4.068707793389298e-15, 4.2711190088362874e-15,
      4.183401464815406e-15, 3.835390216164487e-15, 3.2710806241124086e-15,
      2.5446316342089644e-15, 1.7160525742853183e-15, 8.468758172250075e-16,
      -3.906686030507444e-18, -7.834050893722666e-16, -1.4477056002917547e-15,
      -1.963930265211254e-15, -2.3114188010599603e-15, -2.482030172621715e-15,
      -2.4796181182299446e-15, -2.3187831444318754e-15, -2.023041235709345e-15,
      -1.622575129285668e-15, -1.1517468616099756e-15, -6.465506441557336e-16,
      -1.4217399336209498e-16, 3.291859061161375e-16, 7.401322249789236e-16,
      1.0694203041714328e-15, 1.3028030408955165e-15, 1.4333580484771494e-15,
      1.4613189293932248e-15, 1.3934628580995014e-15, 1.24213069568294e-15,
      1.0239730017782915e-15, 7.58525048548822e-16, 4.667162719804772e-16,
      1.6941498678623117e-16, -1.1390148290677688e-16, -3.662766549752579e-16,
      -5.741491448453673e-16, -7.279367383387334e-16, -8.223171460960935e-16,
      -8.562128042568118e-16, -8.325054037106793e-16, -7.575209755559729e-16,
      -6.403376293954767e-16, -4.919750365326481e-16, -3.2452738129878044e-16,
      -1.502999667139367e-16, 1.8995598200447364e-17, 1.729410357154661e-16,
      3.0296988599670075e-16, 4.0276090098130717e-16, 4.684549636743611e-16,
      4.986963906134392e-16, 4.945106380655158e-16, 4.59039894350357e-16,
      3.9716533826439493e-16, 3.1504969077239217e-16, 2.196359784495137e-16,
      1.1813822941270302e-16, 1.7557356145837934e-17, -7.574890811652578e-17,
      -1.564190208142348e-16, -2.2034744000846299e-16, -2.648423941286216e-16,
      -2.8868003840743723e-16, -2.9206018451049586e-16, -2.764746533180875e-16,
      -2.445039678331486e-16, -1.9956137510829412e-16, -1.456049700790296e-16,
      -8.683900036585942e-17, -2.7424363265871737e-17, 2.8783952673765275e-17,
      7.84579349833016e-17, 1.1896544574885108e-16, 1.4848050231390451e-16,
      1.660327795682152e-16, 1.7149824165777029e-16, 1.6553641768467123e-16,
      1.4948278879062013e-16, 1.2520691863317895e-16, 9.49482630066269e-17,
      6.114202570367283e-17, 2.6247031905775115e-17, -7.413538189960228e-18,
      -3.778944077261573e-17, -6.32117368944704e-17, -8.24677204095741e-17,
      -9.484040418189356e-17, -1.0011299770842998e-16, -9.854101268168141e-17,
      -9.079648376679205e-17, -7.789020103870083e-17, -6.107876483600565e-17,
      -4.176367606855207e-17, -2.1389582281448e-17, -1.348259291770323e-18,
      1.7106008064671323e-17, 3.292518461904095e-17, 4.531730865017704e-17,
      5.377577439758263e-17, 5.808791511455079e-17, 5.832406584781104e-17,
      5.48094354131429e-17, 4.808202226004179e-17, 3.8840431635126136e-17,
      2.788577541486862e-17, 1.606186540317037e-17, 4.197668487546149e-18,
      -6.944483978439926e-18, -1.6712099891416186e-17, -2.4595096360869584e-17,
      -3.0246540218010073e-17, -3.349121994805348e-17, -3.432251667668293e-17,
      -3.2888751321972815e-17, -2.9470759965793697e-17, -2.4452864356779714e-17,
      -1.8289646057248284e-17, -1.1471000099307034e-17, -4.487847360521102e-18,
      2.1993559164643055e-18, 8.187530515756307e-18, 1.3151969169018346e-17,
      1.6860564999619474e-17, 1.918092823040379e-17, 2.008052966881896e-17,
      1.9620444004123263e-17, 1.7943627535256408e-17, 1.5258936553454965e-17,
      1.1822264368413781e-17, 7.916244238716851e-18, 3.829936372378868e-18,
      -1.602002241945005e-19, -3.806941069477245e-18, -6.905670598382663e-18,
      -9.303914142583276e-18, -1.0906738540290702e-17, -1.1678020831207253e-17,
      -1.1637848861624837e-17, -1.0856543043772083e-17, -9.44596381420548e-18,
      -7.548887488623927e-18, -5.327291428041958e-18, -2.950388993675656e-18,
      -5.832006004490493e-19, 1.6236527670672318e-18, 3.54238272135485e-18,
      5.07430190011111e-18, 6.1537073966031846e-18, 6.749329894323154e-18,
      6.8634590490470174e-18, 6.528995085245213e-18, 5.804788366052314e-18,
      4.769708012224422e-18, 3.515925123249742e-18, 2.141905856495129e-18,
      7.455868307365518e-19, -5.818457906222547e-19, -1.7612259796118837e-18,
      -2.729468600323367e-18, -3.4422624067200972e-18, -3.875337205124372e-18,
      -4.024343166325797e-18, -3.903465883335226e-18, -3.542971327384781e-18,
      -2.9859271002001087e-18, -2.284378501488031e-18, -1.4952695524263833e-18,
      -6.763912067733103e-19, 1.1738632231142986e-19, 8.373798185192454e-19,
      1.4436908198602211e-18, 1.9070245103257e-18, 2.209678418605044e-18,
      2.3457069906538243e-18, 2.320320316769507e-18, 2.1486194199227195e-18,
      1.8538044028854804e-18, 1.4650140937288424e-18, 1.0149661575212917e-18,
      5.375652988973065e-19, 6.56352259856242e-20, -3.7109086834373456e-19,
      -7.476143407823429e-19, -1.0448749917891678e-18, -1.2504745535776868e-18,
      -1.3589135998862405e-18, -1.3713673478749298e-18, -1.2950531935570664e-18,
      -1.1422645276202575e-18, -9.291605028348314e-19, -6.744095494367539e-19,
      -3.977856255084688e-19, -1.188109482827202e-19, 1.444718482556043e-19,
      3.765303889973884e-19, 5.651265949418876e-19, 7.01824518701968e-19,
      7.822125522482758e-19, 8.058496398335315e-19, 7.759619804950917e-19,
      6.989304547756481e-19, 5.836190386371427e-19, 4.406004431986186e-19,
      2.813370980039869e-19, 1.1737359984857387e-19, -4.040867005639878e-20,
      -1.8243226810475333e-19, -3.0092750012420316e-19, -3.9027852454353993e-19,
      -4.472027737729771e-19, -4.707661327083133e-19, -4.6224661646279e-19,
      -4.248679172531198e-19, -3.6343073076676334e-19, -2.8387398120305265e-19,
      -1.927998669310699e-19, -9.699613091128067e-20, -2.9863485586735146e-21,
      8.336533755185705e-20, 1.5717429643430207e-19, 2.147661025846061e-19,
      2.538105502265961e-19, 2.7335848690102338e-19, 2.737872239882445e-19,
      2.566656494871436e-19, 2.245543762372136e-19, 1.8075913442542985e-19,
      1.290570879352653e-19, 7.341584309059938e-20, 1.7723735292874188e-20,
      -3.445229416591018e-20, -8.006804576781738e-20, -1.16753157907481e-19,
      -1.4290648133223153e-19, -1.5773428301894235e-19, -1.6123360886570236e-19,
      -1.5412644835020865e-19, -1.3775302040485209e-19, -1.1393442022877272e-19,
      -8.481597183422444e-20, -5.270291819467086e-20, -1.9899599858564755e-20,
      1.1437881285272053e-20, 3.942721371791855e-20, 6.255743062469571e-20,
      7.97545637577257e-20, 9.041386032466738e-20, 9.439929369391502e-20,
      9.201312994678897e-20, 8.393999726303584e-20, 7.117116492078277e-20,
      5.49155282331544e-20, 3.65041037859045e-20, 1.7294686379471006e-20,
      -1.4172466096401383e-21, -1.8476205501725513e-20, -3.292891849076305e-20,
      -4.4068429918462e-20, -5.145875950581116e-20, -5.494016807930415e-20,
      -5.461631215406963e-20, -5.0825621260905414e-20, -4.410004633257016e-20,
      -3.5114872492448764e-20, -2.4633552842762495e-20, -1.3451508015212757e-20,
      -2.342573049269626e-21, 7.988703573644947e-21, 1.6946345861620972e-20,
      2.4072010633119012e-20, 2.9062816966239094e-20, 3.1777741900501596e-20,
      3.2233127885205477e-20, 3.058849845896955e-20, 2.712439874196773e-20,
      2.221434418305425e-20, 1.6293163954013127e-20, 9.824065124940164e-21,
      3.2666313726534967e-21, -2.9522746415001956e-21, -8.463086248123373e-21,
      -1.2972390616388543e-20, -1.62753404494771e-20, -1.8261363743965033e-20,
      -1.8913365915800122e-20, -1.830101867419327e-20, -1.6569058676424144e-20,
      -1.3921761160612213e-20, -1.0604901159479282e-20, -6.886566027895451e-21,
      -3.038142638088661e-21, 6.833190677890681e-22, 4.050352857763225e-21,
      6.877157486926139e-21, 9.028003913163168e-21, 1.0421737389016169e-20,
      1.1032412474763173e-20, 1.0886343223227212e-20, 1.0056056546951599e-20,
      8.651794140363622e-21, 6.81131126764267e-21, 4.688767200133326e-21,
      2.4434938367708926e-21, 2.2937116391906035e-22, -1.8145614468036944e-21,
      -3.5717606790830826e-21, -4.953756437440322e-21, -5.903467480330032e-21,
      -6.396232237157885e-21, -6.43867963216291e-21, -6.065692493790375e-21,
      -5.335817059412719e-21, -4.325541974987069e-21, -3.1229071582745175e-21,
      -1.820907326272451e-21, -5.111293156093906e-22, 7.219892954536299e-22,
      1.805964854389486e-21, 2.6839064390497886e-21, 3.3168533617539158e-21,
      3.684770488910521e-21
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      7.7184096185762e-05, 0.0005896729517177368, 0.002220768606340879, 0.005664715151676783,
      0.0113047508398743, 0.0191482913107651, 0.028885649209706193, 0.039962377917822436,
      0.05165927926849205, 0.06317419985249609, 0.0737001815476119, 0.08249527235613885,
      0.08894027222863735, 0.09258180538167123, 0.09315929293563457, 0.09061556743867419,
      0.08509195150089206, 0.07690955539668873, 0.06653928664701823, 0.05456357805802396,
      0.041633116078922956, 0.02842189153376818, 0.015583717393875565, 0.003712993282754905,
      -0.0066880167349917434, -0.01523374228897408, -0.021670720099057746,
      -0.025883558818249778, -0.027891791027265977, -0.02783851232973936,
      -0.02597216654324112, -0.022623169166573847, -0.018177257769531125,
      -0.013047516515056621, -0.007646950443069588, -0.002363298871527091,
      0.0024625021852929152, 0.0065531456327590516, 0.009706390578242881,
      0.011800833041490428, 0.012796115054867253, 0.012728022072177561,
      0.011699206396594952, 0.009866491280743652, 0.007425848437066649,
      0.004596198631525906, 0.0016031639108739716, -0.0013361913361654382,
      -0.004026743188021994, -0.00630612158620375, -0.00805248308894472,
      -0.009189005328750806, -0.009685094734089178, -0.009554509648409301,
      -0.008850781013550831, -0.007660453325876272, -0.006094763940239784,
      -0.004280426669375624, -0.002350186914709596, -0.0004337740815594299,
      0.001350200993873219, 0.0029009624011557536, 0.0041405839160315846,
      0.00501712224966134, 0.005505824506239342, 0.0056084926821821516,
      0.005351199213790009, 0.004780637034401082, 0.00395945142921556,
      0.0029609372345952177, 0.0018634936029871731, 0.0007452113948871438,
      -0.00032107147783794155, -0.0012719693183438573, -0.002056795895530626,
      -0.0026397311841329686, -0.0030008589358467073, -0.0031361027147152627,
      -0.00305615619058631, -0.0027845598313386037, -0.0023551180484050267,
      -0.001808876853647387, -0.0011908918429088579, -0.0005470105640860771,
      7.912628163246754e-05, 0.0006486914072138888, 0.0011297514284008053,
      0.0014987322373078806, 0.0017412269912080304, 0.0018521500134850177,
      0.0018352814561924432, 0.0017022827889192483, 0.0014712903331174508,
      0.0011652120906299082, 0.0008098616283378884, 0.0004320620275460004,
      5.784370875580611e-05, -0.00028915640674432994, -0.0005890087946451166,
      -0.000826458188800547, -0.0009915105316163496, -0.001079634190571174,
      -0.0010915947821936035, -0.0010329647702799895, -0.000913366374321424,
      -0.0007455184980263917, -0.0005441650215345808, -0.00032496293268160896,
      -0.00010340478952423389, 0.00010615840981150372, 0.00029133981447992713,
      0.0004423450368435934, 0.0005523822139198014, 0.0006178457964813832,
      0.0006382811931010968, 0.0006161508211331746, 0.0005564331057133106,
      0.0004660940216867886, 0.0003534756217926697, 0.00022764759490161856,
      9.776641941706474e-05, -2.751752921824404e-05, -0.00014057099481836673,
      -0.00023518112797440958, -0.00030683424186329835, -0.0003528626024292796,
      -0.0003724608814025913, -0.00036658210222757114, -0.00033772979700545934,
      -0.0002896683360494507, -0.0002270767924718283, -0.0001551731986662401,
      -7.933570317614151e-05, -4.745121397149734e-06, 6.393004009692622e-05,
      0.0001227894829401839, 0.00016888650280544142, 0.0002003368901803347,
      0.00021635076599988676, 0.00021719175041504327, 0.00020407214431803942,
      0.00017899617187539077, 0.00014456564894845778, 0.00010376364654785013,
      5.9731826208201926e-05, 1.5556220044576677e-05, -2.5925545416913944e-05,
      -6.228503968885946e-05, -9.162421748020678e-05, -0.00011265256020710375,
      -0.0001247189125499116, -0.00012779975996385815, -0.0001224483338283524,
      -0.00010971107058759363, -9.101949475466247e-05, -6.806649405602803e-05,
      -4.267620467380164e-05, -1.6676363690675308e-05, 8.218911483289063e-06,
      3.0509288527134156e-05, 4.8986346732963625e-05, 6.278650685907104e-05,
      7.141748204533899e-05, 7.47587684729675e-05, 7.303831185340923e-05,
      6.678883154540699e-05, 5.6788294721149516e-05, 4.398967185965062e-05,
      2.9445362108615086e-05, 1.4231568128078099e-05, -6.225375475076515e-07,
      -1.4196723385263834e-05, -2.5729471452378246e-05, -3.465344119331476e-05,
      -4.061555041859942e-05, -4.3481673261527094e-05, -4.332693895011378e-05,
      -4.04134542302338e-05, -3.515792460597697e-05, -2.8092089089102098e-05,
      -1.9819099521646947e-05, -1.096897354439761e-05, -2.156048288187202e-06,
      6.0590105142754345e-06, 1.320059401379015e-05, 1.890147406023052e-05,
      2.2917246384715724e-05, 2.5131710668104094e-05, 2.555360003048565e-05,
      2.4305591421438816e-05, 2.1606944419747728e-05, 1.775141104291476e-05,
      1.308222454115834e-05, 7.966011058912964e-06, 2.7673830015277736e-06,
      -2.174217514891079e-06, -6.564131641432504e-06, -1.0167594396865032e-05,
      -1.2819752161515294e-05, -1.4430371469532437e-05, -1.4983381109567936e-05,
      -1.453170820694766e-05, -1.3188131547564374e-05, -1.1113069798871718e-05,
      -8.500341744348106e-06, -5.561978789010254e-06, -2.5131404273412293e-06,
      4.4191094671107903e-07, 3.1219671261933377e-06, 5.378541343224667e-06,
      7.102635143694164e-06, 8.228414159722103e-06, 8.73381572086172e-06,
      8.638305603740894e-06, 7.99816545008536e-06, 6.899818494320906e-06,
      5.4517843493840565e-06, 3.775891976999222e-06, 1.99837489605471e-06,
      2.414281121139224e-07, -1.3842716684363316e-06, -2.7856844755653093e-06,
      -3.8918864227388245e-06, -4.656760266715113e-06, -5.059874412323558e-06,
      -5.105645382956528e-06, -4.820980652830646e-06, -4.251679510856596e-06,
      -3.4579258928213766e-06, -2.5092373252217255e-06, -1.4792385139763075e-06,
      -4.406085590722002e-07, 5.394894682657368e-07, 1.4032444839093247e-06,
      2.1051148160088828e-06, 2.6137171564976984e-06, 2.9126520703978294e-06,
      3.0003020437697905e-06, 2.888700775013715e-06, 2.6016235868404515e-06,
      2.172086148457212e-06, 1.6394609196853783e-06, 1.0464276991776625e-06,
      4.359672051280784e-07, -1.5141357998321477e-07, -6.800661530242615e-07,
      -1.121075321957269e-06, -1.4535467642909227e-06, -1.6652739785666807e-06,
      -1.7527937793396655e-06, -1.720877837763546e-06, -1.5815398806823956e-06,
      -1.3526624979690559e-06, -1.0563631629399948e-06, -7.172257674080229e-07,
      -3.6052203086635716e-07, -1.0537407944125628e-08, 3.1090013689964786e-07,
      5.856113092475141e-07, 7.999237996461933e-07, 9.451706179051466e-07,
      1.017826623474584e-06, 1.0193047258929087e-06, 9.554532077069504e-07,
      8.35811280866005e-07, 6.726906853457575e-07, 4.801566055161314e-07,
      2.729815025630034e-07, 6.56410489414858e-08, -1.285871190104642e-07,
      -2.983727609347456e-07, -4.3489524880276397e-07, -5.321982991901095e-07,
      -5.873318522229672e-07, -6.002897927335469e-07, -5.737645433796077e-07,
      -5.127495185829364e-07, -4.24027573332373e-07, -3.155876900328311e-07,
      -1.960132102847123e-07, -7.388312297338069e-08, 4.2776381080204105e-08,
      1.469592000588924e-07, 2.3304234029219825e-07, 2.9703014674931585e-07,
      3.3667403914147954e-07, 3.514704883446265e-07, 3.425475286455158e-07,
      3.124563722188391e-07, 2.648893797980362e-07, 2.0434857803787394e-07,
      1.3579005792596593e-07, 6.426901628468042e-08, -5.391906185739975e-09,
      -6.88917185805041e-08, -1.226826656357243e-07, -1.6413429239406088e-07,
      -1.9162512979637632e-07, -2.0456217908517783e-07, -2.0333297685481626e-07,
      -1.8919893623611057e-07, -1.6414169033273588e-07, -1.3067619148616227e-07,
      -9.16452982934769e-08, -5.001053654518435e-08, -8.652738820549143e-09,
      2.980550871862184e-08, 6.314607477580885e-08, 8.966341053038661e-08,
      1.0823085882536926e-07, 1.18324394585439e-07, 1.2000583194500021e-07,
      1.1386995658401439e-07, 1.0096197726716639e-07, 8.267305544765766e-08,
      6.062242636207732e-08, 3.653477199256272e-08, 1.2121086937755552e-08,
      -1.102963327908359e-08, -3.15418562240333e-08, -4.832368447906412e-08,
      -6.061302422951997e-08, -6.799880115473469e-08, -7.041794978408961e-08,
      -6.813039165358856e-08, -6.167544071785597e-08, -5.1813975508325024e-08,
      -3.9461265731551824e-08, -2.561553076179758e-08, -1.1287156587455122e-08,
      2.566955683313824e-09, 1.5100138396638574e-08, 2.562091605804935e-08,
      3.362428247215156e-08, 3.8808437790402676e-08, 4.1077128769355095e-08,
      4.05286445578603e-08, 3.7433286133445336e-08, 3.220171306343438e-08,
      2.534695416594562e-08, 1.7443041315371078e-08, 9.083194583150386e-09,
      8.402711235487905e-10, -6.7681810670710445e-09, -1.330841343587055e-08,
      -1.845122766997759e-08, -2.198430574040246e-08, -2.381603349683532e-08,
      -2.3971283440091824e-08, -2.25800978040869e-08, -1.9860588677695946e-08,
      -1.6097631902678715e-08, -1.1619068915244514e-08, -6.771146998243647e-09,
      -1.894832649331203e-09, 2.6955595699546698e-09, 6.7302488905401454e-09,
      9.997528303466737e-09, 1.2352458986279022e-08, 1.3720567562333648e-08,
      1.4096726901973859e-08, 1.3539694201545381e-08, 1.2163018332134013e-08,
      1.0123201266143867e-08, 7.606100174873118e-09, 4.812586963355184e-09,
      1.94444461878308e-09, -8.086171712673511e-10, -3.2800899544150016e-09,
      -5.335381134560388e-09, -6.877759287445763e-09, -7.851381058307124e-09,
      -8.241449673928167e-09, -8.071734418326409e-09, -7.39983009479577e-09,
      -6.310648427306744e-09, -4.9087053848250465e-09, -3.309798349896695e-09,
      -1.6326564971458056e-09, 8.899245684090668e-12, 1.5128276633889364e-09,
      2.7944114381741786e-09, 3.790230203558741e-09, 4.460439484097313e-09,
      4.789351180541928e-09, 4.7844202747413576e-09, 4.473835645170166e-09,
      3.902985658330612e-09, 3.1301185846920305e-09, 2.2215426741772326e-09,
      1.2467113835380612e-09, 2.735177488299892e-10, -6.359185341701436e-10,
      -1.4287429533558365e-09, -2.063973774497538e-09, -2.514132403573455e-09,
      -2.765873812675457e-09, -2.8196601878049046e-09, -2.6885785597724786e-09,
      -2.3964495270675936e-09, -1.9754072467806257e-09, -1.46314964991333e-09,
      -9.000623221612722e-10, -3.2641058717294824e-10, 2.202262761410305e-10,
      7.071347623249837e-10, 1.1081536068313913e-09, 1.4048002905005896e-09,
      1.5868122700073828e-09, 1.6521171772258332e-09, 1.6062815708609353e-09,
      1.4615170415162318e-09, 1.235344208699672e-09, 9.490286391179669e-10,
      6.259077854676294e-10, 2.897250725653159e-10, -3.692289531552547e-11,
      -3.3393611659264843e-10, -5.847885666451574e-10, -7.772869872976808e-10,
      -9.039891503200788e-10, -9.622832695536376e-10, -9.541517732079153e-10,
      -8.856609017556513e-10, -7.662316740733376e-10, -6.077571132157431e-10,
      -4.236350402169483e-10, -2.277853587812345e-10, -3.371599130408857e-11,
      1.463068425561747e-10, 3.0193963827468564e-10, 4.2526276072789514e-10,
      5.110846977130086e-10, 5.57046389024437e-10, 5.635356492689252e-10,
      5.334330146991491e-10, 4.717193474403603e-10, 3.8498184142180035e-10,
      2.8085851416117263e-10, 1.6746185695186966e-10, 5.28202534023335e-11,
      -5.562858403849828e-11, -1.514640971887656e-10, -2.296086883415772e-10,
      -2.865404131306604e-10, -3.2038839796782183e-10, -3.3091466972786845e-10,
      -3.1939304381465245e-10, -2.88401413172372e-10, -2.415479561714861e-10,
      -1.8315429549313656e-10, -1.179194710193387e-10, -5.0587824700056246e-11,
      1.4358283399330081e-11, 7.296334375083617e-11, 1.2200774810479478e-10,
      1.5915230947031607e-10, 1.830143940609442e-10, 1.931765048547875e-10,
      1.9013240746945105e-10, 1.7517945951259957e-10, 1.502685228564406e-10,
      1.1782460165683326e-10, 8.055212431843537e-11, 4.1238607884372954e-11,
      2.5693997436998776e-12, -3.3035577011869695e-11, -6.355446812139392e-11,
      -8.745959286239203e-11, -1.0377391180414859e-10, -1.1208755469195366e-10,
      -1.1253668584274391e-10, -1.0574920360486596e-10, -9.276351667194373e-11,
      -7.492784112073839e-11, -5.3788086647538124e-11, -3.097245678176859e-11,
      -8.080419706305531e-12, 1.3417212552441553e-11, 3.226163197254933e-11,
      4.746886127783154e-11, 5.836975383014875e-11, 6.462651370580584e-11,
      6.622663954061723e-11, 6.345656451552862e-11, 5.685837399164919e-11,
      4.717378251620072e-11, 3.5280017811559174e-11, 2.212238903810097e-11,
      8.648129863552194e-12, -4.2543579557175395e-12, -1.580742472015542e-11,
      -2.538467302673228e-11, -3.253840073083295e-11, -3.7013321257572586e-11,
      -3.8746829298913676e-11, -3.7856918262555033e-11, -3.4619553398072255e-11,
      -2.9437828444729905e-11, -2.280556490573159e-11, -1.5268146549881407e-11,
      -7.38332544565188e-12, 3.154908079103979e-13, 7.351329253136004e-12,
      1.3329452253057716e-11, 1.7955743303141794e-11, 2.1047120899588603e-11,
      2.2533979875476278e-11, 2.2455169678145196e-11, 2.0946453945189947e-11,
      1.822373389899323e-11, 1.4562545963752867e-11, 1.027545624385123e-11,
      5.688973564251977e-12, 1.1214981715298917e-12, -3.136369725140074e-12,
      -6.838098915050876e-12, -9.793318656882925e-12, -1.1875307942987447e-11,
      -1.3023787710281939e-11, -1.3243229546472063e-11, -1.2597163426008495e-11,
      -1.1199182669185235e-11, -9.201497306501953e-12, -6.7819727944806685e-12,
      -4.130609694882227e-12, -1.4363759048623222e-12, 1.124795638487756e-12,
      3.4001732858683648e-12, 5.268059972942326e-12, 6.642987172191561e-12,
      7.478157602027441e-12, 7.765210138828488e-12, 7.531545547463574e-12,
      6.83558776071371e-12, 5.760456216275974e-12, 4.406586705154991e-12,
      2.883860576799676e-12, 1.3037868543467114e-12, -2.277670376604973e-13,
      -1.6168767137046272e-12, -2.7865721317190798e-12, -3.680345899043123e-12,
      -4.264059638635664e-12, -4.526260213268434e-12, -4.4770183437920795e-12,
      -4.1454872859397625e-12, -3.576444606054887e-12, -2.826123186608695e-12,
      -1.9576575015305076e-12, -1.0364685910669913e-12, -1.2588808331400042e-13,
      7.167187593672955e-13, 1.44312462039148e-12, 2.0165623390468974e-12,
      2.413120112178032e-12, 2.622197833131793e-12, 2.6460737636344172e-12,
      2.498683539911551e-12, 2.2037553859674876e-12, 1.7924745788344662e-12,
      1.3008658769602108e-12, 7.670849091394192e-13, 2.287993984024578e-13,
      -2.791797532863855e-13, -7.268868385818809e-13, -1.090713750273081e-12,
      -1.354389408154214e-12, -1.5094080519361528e-12, -1.554925017457572e-12,
      -1.4971711248155694e-12, -1.3484633331702659e-12, -1.12590866069938e-12,
      -8.499098917242091e-13, -5.425852121501756e-13, -2.2621005750551965e-13,
      7.822100406060711e-14, 3.5223037770713043e-13, 5.808293279599874e-13,
      7.531855325678049e-13, 8.629690094268775e-13, 9.083811407143404e-13,
      8.918913966095838e-13, 8.197230056903843e-13, 7.011414354557852e-13,
      5.476076637048624e-13, 3.7186169605804945e-13, 1.8700078210729198e-13,
      5.611740500387703e-15, -1.6099161848282832e-13, -3.0338596470002666e-13,
      -4.144834290836709e-13, -4.897900294891089e-13, -5.274765856253429e-13,
      -5.282732423557279e-13, -4.952090762715652e-13, -4.332263776615664e-13,
      -3.4870474644547065e-13, -2.4893297613867104e-13, -1.4156686942056023e-13,
      -3.410884414003215e-14, 6.655919932344007e-14, 1.54564313215058e-13,
      2.2533396205848329e-13, 2.7577995851814584e-13, 3.043720863189642e-13,
      3.111059108048249e-13, 2.9737567090181713e-13, 2.6576830876420504e-13,
      2.1979839772028343e-13, 1.636058600772224e-13, 1.0163891893699183e-13,
      3.8343798850118644e-14, -2.2119537930057288e-14, -7.611960866542639e-14,
      -1.207415964624237e-13, -1.539139783833516e-13, -1.7447063444508248e-13,
      -1.8214985119306475e-13, -1.7753555243970724e-13, -1.6194934032500072e-13,
      -1.3730435995157349e-13, -1.0593352351374024e-13, -7.040522343712018e-14,
      -3.333936816957234e-14, 2.7645178923779658e-15, 3.567714094444744e-14,
      6.355948622045161e-14, 8.504787661750114e-14, 9.930152158955936e-14,
      1.0601264633771414e-13, 1.0538167759456734e-13, 9.806199092111464e-14,
      8.508029549495404e-14, 6.773978356888871e-14, 4.7513679276940934e-14,
      2.59367981903875e-14, 4.502220784209773e-15, -1.5430737231475055e-14,
      -3.271231366715935e-14, -4.64583553929963e-14, -5.6084702298235844e-14,
      -6.131950950577461e-14, -6.219456157026204e-14, -5.901788831889611e-14,
      -5.2330995311789694e-14, -4.2854729511438766e-14, -3.142819208073763e-14,
      -1.894518664961376e-14, -6.292474305619287e-15, 5.706365633522776e-15,
      1.6338345810243836e-14, 2.5037447901915324e-14, 3.1408560677923935e-14,
      3.523848625922856e-14, 3.649439020758986e-14, 3.5310842943613816e-14,
      3.19672340120045e-14, 2.6857807829668852e-14, 2.0456853820585004e-14,
      1.3281682342202747e-14, 5.855939750600077e-15, -1.32441892953734e-15,
      -7.82054484953435e-15, -1.3274001100276457e-14, -1.742297855958341e-14,
      -2.0110976431842355e-14, -2.1288021318480897e-14, -2.1004969812496254e-14,
      -1.9401836562983414e-14, -1.6691393308176904e-14, -1.3139482907532975e-14,
      -9.043581982944348e-15, -4.7111297725212875e-15, -4.390290471426848e-16,
      3.5044674166793015e-15, 6.894525239065598e-15, 9.560486254515172e-15,
      1.1392262408709566e-14, 1.2342321064537116e-14, 1.242350280023583e-14,
      1.1703159254628301e-14, 1.0294293278352555e-14, 8.34451845258835e-15,
      6.023726315874528e-15, 3.5113581391483133e-15, 9.841285070250517e-16,
      -1.395051679195246e-15, -3.4863443103183864e-15, -5.180003278812191e-15,
      -6.400882611721424e-15, -7.110354792708555e-15, -7.30573278620484e-15,
      -7.0174411603330986e-15, -6.3043052094172394e-15, -5.2474165702919655e-15,
      -3.943086609168933e-15, -2.4954145243769017e-15, -1.0089777612845011e-15,
      4.1789786937053705e-16, 1.6989062517405894e-15, 2.764278518732471e-15,
      3.563865514077617e-15, 4.0687077933922614e-15, 4.271119008826095e-15,
      4.1834014647937734e-15, 3.835390216133718e-15, 3.2710806240752043e-15,
      2.5446316341682166e-15, 1.7160525742439102e-15, 8.468758171856299e-16,
      -3.9066860655123576e-18, -7.834050894010266e-16, -1.4477056003129486e-15,
      -1.963930265224151e-15, -2.311418801064419e-15, -2.482030172618144e-15,
      -2.479618118219232e-15, -2.318783144415294e-15, -2.0230412356884405e-15,
      -1.6225751292621383e-15, -1.1517468615855489e-15, -6.465506441320567e-16,
      -1.4217399334063421e-16, 3.291859061341758e-16, 7.401322249926494e-16,
      1.069420304180304e-15, 1.3028030408993456e-15, 1.4333580484760878e-15,
      1.461318929387725e-15, 1.393462858090263e-15, 1.2421306956708453e-15,
      1.0239730017643351e-15, 7.585250485340385e-16, 4.667162719658722e-16,
      1.6941498677271947e-16, -1.1390148291842274e-16, -3.6627665498444565e-16,
      -5.741491448517087e-16, -7.279367383420524e-16, -8.223171460964204e-16,
      -8.562128042543645e-16, -8.325054037058342e-16, -7.575209755492284e-16,
      -6.403376293874113e-16, -4.919750365238782e-16, -3.245273812899173e-16,
      -1.5029996670554864e-16, 1.8995598207867784e-17, 1.729410357215275e-16,
      3.0296988600112986e-16, 4.027609009839567e-16, 4.684549636752091e-16,
      4.986963906125804e-16, 4.945106380631457e-16, 4.590398943467514e-16,
      3.971653382598859e-16, 3.1504969076734203e-16, 2.1963597844428932e-16,
      1.181382294076522e-16, 1.7557356141268704e-17, -7.574890812036146e-17,
      -1.5641902081715258e-16, -2.2034744001035233e-16, -2.6484239412944687e-16,
      -2.886800384072336e-16, -2.920601845093614e-16, -2.7647465331617155e-16,
      -2.445039678306382e-16, -1.9956137510539875e-16, -1.4560497007596605e-16,
      -8.683900036283744e-17, -2.7424363263081117e-17, 2.878395267616509e-17,
      7.845793498518921e-17, 1.1896544575014777e-16, 1.4848050231457588e-16,
      1.6603277956826964e-16, 1.7149824165725506e-16, 1.6553641768366622e-16,
      1.4948278878923006e-16, 1.252069186315247e-16, 9.49482630048366e-17,
      6.114202570187304e-17, 2.6247031904082885e-17, -7.413538191444118e-18,
      -3.778944077381193e-17, -6.321173689532438e-17, -8.246772041005764e-17,
      -9.484040418200448e-17, -1.0011299770819015e-16, -9.854101268113344e-17,
      -9.079648376599498e-17, -7.789020103772497e-17, -6.107876483492724e-17,
      -4.1763676067447865e-17, -2.1389582280390272e-17, -1.3482592908226238e-18,
      1.7106008065457543e-17, 3.2925184619628655e-17, 4.531730865054483e-17,
      5.377577439772483e-17, 5.808791511447656e-17, 5.83240658475426e-17,
      5.480943541271311e-17, 4.808202225949115e-17, 3.8840431634499565e-17,
      2.788577541421223e-17, 1.60618654025284e-17, 4.1976684869583215e-18,
      -6.944483978940585e-18, -1.671209989180492e-17, -2.4595096361130808e-17,
      -3.0246540218137635e-17, -3.3491219948050285e-17, -3.4322516676560035e-17,
      -3.2888751321748027e-17, -2.9470759965489874e-17, -2.445286435642292e-17,
      -1.8289646056865846e-17, -1.1471000098925703e-17, -4.487847360165372e-18,
      2.199355916773582e-18, 8.18753051600296e-18, 1.3151969169191538e-17,
      1.686056499971396e-17, 1.9180928230419797e-17, 2.0080529668761735e-17,
      1.9620444004002314e-17, 1.794362753508457e-17, 1.5258936553247288e-17,
      1.1822264368186398e-17, 7.916244238485845e-18, 3.829936372159248e-18,
      -1.6020022438967115e-19, -3.8069410696375224e-18, -6.9056705985006785e-18,
      -9.30391414265496e-18, -1.0906738540315274e-17, -1.1678020831187001e-17,
      -1.1637848861564728e-17, -1.0856543043679231e-17, -9.445963814088528e-18,
      -7.54888748849236e-18, -5.327291427905427e-18, -2.9503889935433446e-18,
      -5.832006003291271e-19, 1.6236527671680502e-18, 3.542382721431617e-18,
      5.074301900160822e-18, 6.1537073966248136e-18, 6.749329894317551e-18,
      6.8634590490167025e-18, 6.528995085194078e-18, 5.8047883659852614e-18,
      4.769708012146969e-18, 3.515925123167619e-18, 2.1419058564138972e-18,
      7.455868306612645e-19, -5.818457906873326e-19, -1.7612259796634843e-18,
      -2.7294686003593466e-18, -3.4422624067394806e-18, -3.875337205127321e-18,
      -4.024343166313509e-18, -3.903465883309774e-18, -3.54297132734891e-18,
      -2.9859271001570018e-18, -2.2843785014410717e-18, -1.4952695523789211e-18,
      -6.763912067284492e-19, 1.1738632235100907e-19, 8.373798185514215e-19,
      1.4436908198835222e-18, 1.907024510339344e-18, 2.209678418608933e-18,
      2.3457069906484933e-18, 2.32032031675604e-18, 2.1486194199026336e-18,
      1.853804402860596e-18, 1.4650140937011395e-18, 1.0149661574927702e-18,
      5.375652988698564e-19, 6.563522596091355e-20, -3.710908683643489e-19,
      -7.476143407978767e-19, -1.044874991799042e-18, -1.2504745535817318e-18,
      -1.3589135998846727e-18, -1.3713673478683073e-18, -1.2950531935462252e-18,
      -1.142264527606236e-18, -9.291605028187873e-19, -6.744095494198803e-19,
      -3.9778562549191544e-19, -1.1881094826752337e-19, 1.4447184826857895e-19,
      3.765303890074876e-19, 5.651265949486951e-19, 7.018245187053124e-19,
      7.822125522482212e-19, 8.058496398303543e-19, 7.75961980489245e-19,
      6.989304547677185e-19, 5.836190386278023e-19, 4.406004431885753e-19,
      2.8133709799393613e-19, 1.1737359983915506e-19, -4.040867006463839e-20,
      -1.8243226811138618e-19, -3.0092750012893897e-19, -3.9027852454623305e-19,
      -4.472027737736242e-19, -4.70766132707042e-19, -4.622466164598399e-19,
      -4.248679172488181e-19, -3.634307307614969e-19, -2.838739811972384e-19,
      -1.9279986692512594e-19, -9.699613090559927e-20, -2.9863485535981114e-21,
      8.336533755604981e-20, 1.5717429643741459e-19, 2.1476610258652605e-19,
      2.5381055022729675e-19, 2.7335848690055836e-19, 2.737872239867378e-19,
      2.5666564948477607e-19, 2.245543762342063e-19, 1.8075913442202692e-19,
      1.2905708793171636e-19, 7.341584308714311e-20, 1.7723735289723848e-20,
      -3.445229416857828e-20, -8.006804576987217e-20, -1.1675315790884135e-19,
      -1.4290648133286733e-19, -1.5773428301887224e-19, -1.6123360886498873e-19,
      -1.5412644834894998e-19, -1.377530204031737e-19, -1.1393442022681662e-19,
      -8.481597183213876e-20, -5.2702918192599844e-20, -1.9899599856639944e-20,
      1.1437881286939228e-20, 3.9427213719242266e-20, 6.255743062561915e-20,
      7.975456375822231e-20, 9.041386032474007e-20, 9.439929369359365e-20,
      9.201312994612628e-20, 8.393999726210215e-20, 7.117116491966007e-20,
      5.491552823193021e-20, 3.6504103784665743e-20, 1.72946863782985e-20,
      -1.4172466106763668e-21, -1.8476205502569868e-20, -3.2928918491376746e-20,
      -4.406842991882419e-20, -5.1458759505918804e-20, -5.494016807917074e-20,
      -5.461631215372301e-20, -5.082562126038483e-20, -4.410004633192279e-20,
      -3.5114872491726095e-20, -2.4633552842016624e-20, -1.3451508014493036e-20,
      -2.342573048619706e-21, 7.988703574189447e-21, 1.6946345862034078e-20,
      2.407201063338526e-20, 2.906281696635366e-20, 3.1777741900469734e-20,
      3.223312788504134e-20, 3.058849845869458e-20, 2.712439874160866e-20,
      2.2214344182640993e-20, 1.629316395357658e-20, 9.824065124510162e-21,
      3.2666313722569898e-21, -2.9522746418406165e-21, -8.463086248390567e-21,
      -1.2972390616571465e-20, -1.6275340449571006e-20, -1.8261363743971268e-20,
      -1.8913365915725534e-20, -1.8301018674049323e-20, -1.65690586762258e-20,
      -1.3921761160376702e-20, -1.0604901159224803e-20, -6.886566027639932e-21,
      -3.038142637848621e-21, 6.833190679994548e-22, 4.050352857932845e-21,
      6.877157487047401e-21, 9.028003913232204e-21, 1.0421737389032774e-20,
      1.1032412474730524e-20, 1.0886343223151378e-20, 1.0056056546840914e-20,
      8.651794140227967e-21, 6.811311267492719e-21, 4.688767199979802e-21,
      2.4434938366238795e-21, 2.2937116378741175e-22, -1.8145614469128224e-21,
      -3.571760679164552e-21, -4.953756437491176e-21, -5.90346748034951e-21,
      -6.39623223714729e-21, -6.4386796321253625e-21, -6.065692493730459e-21,
      -5.33581705933607e-21, -4.325541974899932e-21, -3.1229071581833e-21,
      -1.820907326183303e-21, -5.111293155278331e-22, 7.219892955230078e-22,
      1.805964854443245e-21, 2.6839064390857663e-21, 3.316853361771261e-21,
      3.6847704889096405e-21
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_5_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<5>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 4.8709873729449025e-06), "design.b()[0] == 4.8709873729449025e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 4.8709873729449025e-06));
    static_assert(almost_equal(design.b()[1], 2.4354936864724512e-05), "design.b()[1] == 2.4354936864724512e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 2.4354936864724512e-05));
    static_assert(almost_equal(design.b()[2], 4.8709873729449025e-05), "design.b()[2] == 4.8709873729449025e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 4.8709873729449025e-05));
    static_assert(almost_equal(design.b()[3], 4.8709873729449025e-05), "design.b()[3] == 4.8709873729449025e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 4.8709873729449025e-05));
    static_assert(almost_equal(design.b()[4], 2.4354936864724512e-05), "design.b()[4] == 2.4354936864724512e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 2.4354936864724512e-05));
    static_assert(almost_equal(design.b()[5], 4.8709873729449025e-06), "design.b()[5] == 4.8709873729449025e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 4.8709873729449025e-06));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -4.62995532543778), "design.a()[1] == -4.62995532543778");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -4.62995532543778));
    static_assert(almost_equal(design.a()[2], 8.655358051742468), "design.a()[2] == 8.655358051742468");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 8.655358051742468));
    static_assert(almost_equal(design.a()[3], -8.162891668940338), "design.a()[3] == -8.162891668940338");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -8.162891668940338));
    static_assert(almost_equal(design.a()[4], 3.8825148345596294), "design.a()[4] == 3.8825148345596294");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 3.8825148345596294));
    static_assert(almost_equal(design.a()[5], -0.744870020328045), "design.a()[5] == -0.744870020328045");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.744870020328045));
    std::cout << "max_deviation(cheby1,lowpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      4.8709873729449025e-06, 4.690739079223094e-05, 0.0002237288577519752, 0.0007183255697986771,
      0.0017777051325767526, 0.0036659853695825955, 0.006616597161292079,
      0.010793086931592026, 0.01626062686661065, 0.022969426601711307, 0.030750316700330127,
      0.03932190140520209, 0.04830790847224983, 0.05726274010712265, 0.06570278184072562,
      0.07314077313746487, 0.0791204886575374, 0.08324911347133646, 0.08522499861762023,
      0.08485892505856713, 0.08208754703613613, 0.07697828846373012, 0.06972558525998512,
      0.06063896082295078, 0.050123953521615416, 0.03865735269194112, 0.026758519552316867,
      0.014958756999390074, 0.0037707420701498934, -0.006340049196099987,
      -0.014980200416161927, -0.021848080758699373, -0.026747406728545392,
      -0.02959404191255509, -0.030415888403794847, -0.029346163628032912,
      -0.026610757101644122, -0.022510699619337313, -0.01740103410078253,
      -0.011667540542039112, -0.005702831531395551, 0.00011669948863271898,
      0.005451720494143398, 0.010017441092000933, 0.013596843998775775,
      0.016049088936286857, 0.017312838297976377, 0.017404580841100234,
      0.016412334784851434, 0.014485377017498427, 0.011820856066392965,
      0.008648292688108641, 0.005213047645074548, 0.0017598404485253405,
      -0.0014826608795041347, -0.004315282995762597, -0.006579100634524427,
      -0.008162986480154313, -0.009007673440279269, -0.009106280009121087,
      -0.008501474238067262, -0.007279653126304388, -0.005562680631485663,
      -0.003497850419938671, -0.0012468135744483043, 0.0010257652282294645,
      0.0031630857390851537, 0.0050259583049838425, 0.006500861520570379,
      0.007505893194135801, 0.007994353698639704, 0.007955865796060342,
      0.0074150969530754965, 0.006428298935329042, 0.005078006386158802,
      0.0034663343309856015, 0.0017073794561359573, -8.074069107342e-05,
      -0.0017836826491134888, -0.0032980175928671723, -0.004537297196317949,
      -0.005436715725412107, -0.005956146412169558, -0.0060814455566196406,
      -0.005824033694596616, -0.0052188721816527825, -0.004321049138168932,
      -0.003201265545477963, -0.001940566522415534, -0.0006246922325945353,
      0.0006615730461874757, 0.0018396953050560452, 0.0028420120403873494,
      0.0036154233521821424, 0.004123968603303637, 0.004350184797954806,
      0.004295225549885557, 0.003977799114217417, 0.0034320555769667624,
      0.002704612827940083, 0.0018509552676783565, 0.0009314663309490795,
      7.3650572913995516e-06, -0.0008631915060012006, -0.0016286028379491994,
      -0.002246717426058297, -0.0026869729773578085, -0.0029316897826196214,
      -0.002976481283495683, -0.002829803629195292, -0.002511719252600868,
      -0.002051995119500062, -0.0014876918340958525, -0.0008604235168560362,
      -0.0002134794432509142, 0.0004110031720455944, 0.0009746393544584461,
      0.0014450175077893668, 0.0017974217131861711, 0.0020159734290485067,
      0.002094151981054237, 0.0020346947194615148, 0.0018489169050024366,
      0.00155552591100158, 0.0011790322659225609, 0.0007478799969853241,
      0.0002924298439558426, -0.00015706903178413036, -0.0005723898537849073,
      -0.0009290070007299195, -0.0012074490903739013, -0.0013942584213618965,
      -0.001482517417656262, -0.0014719322601508189, -0.0013684924490606938,
      -0.0011837508648239493, -0.0009337904986055304, -0.0006379602677199555,
      -0.00031747247885312736, 6.04175890415678e-06, 0.00031192542783724486,
      0.0005817514120326219, 0.0008003691393981991, 0.0009566871168977921,
      0.001044156115500917, 0.0010609386199141079, 0.001009770797233845,
      0.000897542363887535, 0.0007346362131714357, 0.000534082606263061,
      0.0003105915006316657, 7.953086199286442e-05, -0.0001440814473924799,
      -0.0003465091290715303, -0.0005160974477836898, -0.0006438982471717247,
      -0.0007240898896087905, -0.0007541766359216544, -0.0007349667779956355,
      -0.0006703428769224496, -0.0005668498939621807, -0.00043313713107173257,
      -0.0002792972058325979, -0.00011614946253103026, 4.5483827922639434e-05,
      0.0001954622871320452, 0.000324932042218413, 0.0004268162144721579,
      0.0004961664233577075, 0.00053036058642127, 0.0005291428190261653,
      0.0004945114570674377, 0.00043047051064557147, 0.0003426676701143508,
      0.00023794791315780812, 0.000123855529619385, 8.11886814844993e-06,
      -0.0001018486552936793, -0.0001994005921669539, -0.00027903647795196726,
      -0.0003366878011010615, -0.00036989786758733737, -0.00037788992575591394,
      -0.0003615252923891868, -0.00032316008751564, -0.00026641513557265303,
      -0.00019587829716755773, -0.00011676172834928849, -3.453819824687863e-05,
      4.541938567899549e-05, 0.00011817260636951557, 0.00017950654314176834,
      0.00022615733638523287, 0.0002559672373862239, 0.0002679612584293898,
      0.000262344818492034, 0.00024042681233688544, 0.00020447701055862928,
      0.00015753037158479312, 0.00010315352496524091, 4.519025289821145e-05,
      -1.2496785222479185e-05, -6.627153657411434e-05, -0.00011294240401988216,
      -0.00014994017026964354, -0.00017544689900355714, -0.00018847030999870102,
      -0.00018886187399238998, -0.00017728052972902273, -0.0001551072639370591,
      -0.00012431862084840654, -8.732937021894104e-05, -4.6815960722872856e-05,
      -5.532972003287253e-06, 3.386543960076634e-05, 6.898807217768207e-05,
      9.784376800683702e-05, 0.00011894576379560307, 0.00013137847033095195,
      0.00013482448973479056, 0.00012955231355491154, 0.00011636760923068221,
      9.653314933663767e-05, 7.166414875380022e-05, 4.3606964899345444e-05,
      1.4309738251871691e-05, -1.4306403977701275e-05, -4.0467460730452275e-05,
      -6.265085546789878e-05, -7.966817590254846e-05, -9.072228632987718e-05,
      -9.543658593279546e-05, -9.38560697228929e-05, -8.642165182530157e-05,
      -7.392082384678089e-05, -5.7419052298568105e-05, -3.8177299489696955e-05,
      -1.75616389109371e-05, 3.0488869024928417e-06, 2.2350239727468312e-05,
      3.9191848650955185e-05, 5.2641112231556784e-05, 6.203061383951101e-05,
      6.698599827476535e-05, 6.743379270939123e-05, 6.358976303220872e-05,
      5.592959646954251e-05, 4.51447228490959e-05, 3.208687507451761e-05,
      1.7705507038298223e-05, 2.982416210093862e-06, -1.1132140365902647e-05,
      -2.3777874676192145e-05, -3.423403874137073e-05, -4.1957480591235826e-05,
      -4.660740040689771e-05, -4.805596034469046e-05, -4.6384842635375926e-05,
      -4.1868734685025734e-05, -3.494749422283555e-05, -2.6189368990088866e-05,
      -1.6248082993416133e-05, -5.816837224898729e-06, 4.4176970267201e-06,
      1.3818480361626387e-05, 2.183573252974902e-05, 2.8037000011704684e-05,
      3.212817046498279e-05, 3.3964594374216636e-05, 3.355214577265987e-05,
      3.103869970717138e-05, 2.669708472458407e-05, 2.0901050850544297e-05,
      1.4096152126451378e-05, 6.767661765405154e-06, -5.922889156180977e-07,
      -7.516226158230275e-06, -1.3589582419942601e-05, -1.8474067231728254e-05,
      -2.19249453746539e-05, -2.3801458852250288e-05, -2.40701043713315e-05,
      -2.2800945790137612e-05, -2.015757205347599e-05, -1.6381680217029504e-05,
      -1.1773550266116348e-05, -6.6698698279345605e-06, -1.4204556311057714e-06,
      3.634595376762224e-06, 8.18590254028641e-06, 1.1972717189058433e-05,
      1.479679055281873e-05, 1.6531535462001637e-05, 1.7126156881067122e-05,
      1.6604762312816813e-05, 1.5060780210276073e-05, 1.2647293694332786e-05,
      9.564122487838366e-06, 6.0426466622093565e-06, 2.3294548976340716e-06,
      -1.3300842801147297e-06, -4.707284430492744e-06, -7.603710150947668e-06,
      -9.862096852681956e-06, -1.1374073760224975e-05, -1.2084374494246128e-05,
      -1.1991458970268693e-05, -1.1144701583676409e-05, -9.638509560425178e-06,
      -7.603909921585916e-06, -5.198274550290895e-06, -2.5939344260634936e-06,
      3.353628016526722e-08, 2.5166069388395703e-06, 4.705956987422637e-06,
      6.478939525131333e-06, 7.745898576470737e-06, 8.454056462745514e-06,
      8.588856849889794e-06, 8.172816253537244e-06, 7.262091600075506e-06,
      5.941104739108394e-06, 4.315669308046488e-06, 2.5051360089526666e-06,
      6.341065323938356e-07, -1.175736134181028e-06, -2.813170301289855e-06,
      -4.183907703748283e-06, -5.215643539293161e-06, -5.861441836499842e-06,
      -6.101332052616151e-06, -5.94211272324095e-06, -5.415471677759196e-06,
      -4.574632939490835e-06, -3.489822289539194e-06, -2.242902422909887e-06,
      -9.215621746197308e-07, 3.8654830548119923e-07, 1.5993623500414876e-06,
      2.6452879736982688e-06, 3.4671713300943828e-06, 4.0251318383721485e-06,
      4.298150658696224e-06, 4.28437949702297e-06, 4.000219490614783e-06,
      3.478295066525717e-06, 2.7645108334134785e-06, 1.914427413317125e-06,
      9.892224462302169e-07, 5.1514835930696064e-08, -8.386760971480359e-07,
      -1.627588138413003e-06, -2.2707796696590257e-06, -2.7354374231176012e-06,
      -3.0018233771116857e-06, -3.0638158427115567e-06, -2.9285595484827025e-06,
      -2.615295115180648e-06, -2.153486432392292e-06, -1.5804024636002138e-06,
      -9.383360564510835e-07, -2.7165542042132853e-07, 3.761160714629402e-07,
      9.650084874551263e-07, 1.460942393664396e-06, 1.8375665823402278e-06,
      2.07750721081915e-06, 2.172981172116811e-06, 2.1257693071382694e-06,
      1.946585818270029e-06, 1.6539164863032296e-06, 1.2724279777380647e-06,
      8.310721339951714e-07, 3.610217282480829e-07, -1.0642254961823485e-07,
      -5.418198666231564e-07, -9.193516825336563e-07, -1.2182595151706785e-06,
      -1.4238846278701208e-06, -1.5282653989260885e-06, -1.5302785202976393e-06,
      -1.4353397914978746e-06, -1.2547072916380203e-06, -1.0044525591852087e-06,
      -7.041828651077824e-07, -3.756089179189269e-07, -4.105701246559944e-08,
      2.7797721132513587e-07, 5.62144128334494e-07, 7.953484521605452e-07,
      9.655915943556402e-07, 1.0655091527123212e-06, 1.092586022679299e-06,
      1.0490529753759437e-06, 9.414884957615805e-07, 7.80167038546303e-07,
      5.782086785646044e-07, 3.505947239913353e-07, 1.1311884687593032e-07,
      -1.1865640014615357e-07, -3.303719363590005e-07, -5.097156916195189e-07,
      -6.470909235356024e-07, -7.360765073093589e-07, -7.736613337153038e-07,
      -7.602502134885511e-07, -6.994532873725102e-07, -5.976839920428105e-07,
      -4.63601391093599e-07, -3.074405904799622e-07, -1.4027967292305385e-07,
      2.6707019576697027e-08, 1.829612602637753e-07, 3.191757466268202e-07,
      4.278153704997092e-07, 5.034981090926927e-07, 5.432190339867651e-07,
      5.464117569519929e-07, 5.148522268049283e-07, 4.524195021438473e-07,
      3.647363840699534e-07, 2.587191568252625e-07, 1.4206985256085926e-07,
      2.2746284293355867e-08, -9.15554104268908e-08, -1.9387364565000243e-07,
      -2.783821712702547e-07, -3.406973057373687e-07, -3.780772399884014e-07,
      -3.895066440932308e-07, -3.756674331753642e-07, -3.388037071347727e-07,
      -2.824951418664066e-07, -2.1135813012912525e-07, -1.3069749755026352e-07,
      -4.613351107865334e-08, 3.6770877637322104e-08, 1.1285897696982584e-07,
      1.7768469476710562e-07, 2.2775542795997172e-07, 2.6070145868724166e-07,
      2.753651164642321e-07, 2.7180840847636613e-07, 2.5124305006199256e-07,
      2.1589152538901448e-07, 1.6879170573230684e-07, 1.1356044632726224e-07,
      5.41333437487699e-08, -5.5015859678889535e-09, -6.155912523922142e-08,
      -1.1068541883216556e-07, -1.5014686252068301e-07, -1.7796951119592907e-07,
      -1.9302286343109025e-07, -1.950457322502703e-07, -1.8461570091040646e-07,
      -1.6306715153628994e-07, -1.3236583889644753e-07, -9.495029992592185e-08,
      -5.355193114821617e-08, -1.1006275429063353e-08, 2.993206331006528e-08,
      6.675936085171802e-08, 9.736763438252127e-08, 1.2015661566907094e-07,
      1.3410753045910532e-07, 1.3881608320825136e-07, 1.3448476873965665e-07,
      1.218771998314985e-07, 1.0223939791967982e-07, 7.719481693441659e-08,
      4.8621165977761324e-08, 1.851781164221155e-08, -1.112733854667689e-08,
      -3.8463019258396884e-08, -6.1884364505257e-08, -8.01211282043428e-08,
      -9.229995136789254e-08, -9.797814074968436e-08, -9.714836393622153e-08,
      -9.02155386281115e-08, -7.794888434264178e-08, -6.141351587166483e-08,
      -4.18870153771656e-08, -2.0767076218897852e-08, 5.234533114569392e-10,
      2.0627976299694226e-08, 3.833841119378227e-08, 5.26636024887664e-08,
      6.288029893410268e-08, 6.856441710253208e-08, 6.960167936845657e-08,
      6.617806995090366e-08, 5.875180585497944e-08, 4.800959748181292e-08,
      3.481081764316779e-08, 2.0123766972655663e-08, 4.958497121330045e-09,
      -9.699370619546095e-09, -2.2949696918750194e-08, -3.403016038831264e-08,
      -4.235703784555984e-08, -4.7552473838680484e-08, -4.945724530392882e-08,
      -4.81289989873473e-08, -4.38268598231831e-08, -3.6984122330671605e-08,
      -2.8171398542522838e-08, -1.8053071406079376e-08, -7.340171987724256e-09,
      3.2571437285318566e-09, 1.3074489286659797e-08, 2.1532814674964476e-08,
      2.8170430227807465e-08, 3.2665869351178084e-08, 3.4850639293878014e-08,
      3.4711600600109746e-08, 3.238338626700432e-08, 2.8131879705539496e-08,
      2.2330281257932705e-08, 1.542967921774496e-08, 7.926285330157113e-09,
      3.2758887385184576e-10, -6.880370196468136e-09, -1.3262598542756255e-08,
      -1.8459913588715966e-08, -2.220756904646506e-08, -2.4346895524135705e-08,
      -2.48295977776369e-08, -2.3714834299361274e-08, -2.1159654896206956e-08,
      -1.7403761073762324e-08, -1.2749861076856187e-08, -7.541101355863612e-09,
      -2.13716100727996e-09, 3.1094055614318273e-09, 7.875094042584798e-09,
      1.1884349960567911e-08, 1.4924410506719686e-08, 1.6855368954158514e-08,
      1.7615083428434174e-08, 1.721889856277379e-08, 1.575447853460758e-08,
      1.33723431900431e-08, 1.0272938849816591e-08, 6.69124966032074e-09,
      2.8800565311462715e-09, -9.070236588661234e-10, -4.431633334099456e-09,
      -7.48493226058815e-09, -9.899215524315774e-09, -1.1556299171007191e-08,
      -1.2392317857621687e-08, -1.2398825188023094e-08, -1.1620327307977854e-08,
      -1.0148598983223985e-08, -8.114316092713365e-09, -5.676679385949926e-09,
      -3.011794932091322e-09, -3.006139227271048e-10, 2.282781087757028e-09,
      4.5818209649481025e-09, 6.466410036071909e-09, 7.839725587808226e-09,
      8.642543511009805e-09, 8.8549503051785e-09, 8.495474627798807e-09,
      7.61783307934503e-09, 6.305625354074006e-09, 4.665425512712251e-09,
      2.818793441891451e-09, 8.937705225141151e-10, -9.835743709602181e-10,
      -2.697016258932751e-09, -4.146996244694988e-09, -5.256019577747414e-09,
      -5.972365095149715e-09, -6.271962729658956e-09, -6.158419466588614e-09,
      -5.6612923680431186e-09, -4.83281287636999e-09, -3.7433535605641935e-09,
      -2.4759922866783896e-09, -1.1205666901293974e-09, 2.3237719054364344e-10,
      1.4973534299348734e-09, 2.599072140958521e-09, 3.4766520395078916e-09,
      4.086693058628828e-09, 4.405076291715017e-09, 4.427446271317706e-09,
      4.168416414217655e-09, 3.659617056153005e-09, 2.946772278909424e-09,
      2.0860431119622196e-09, 1.1399082528912662e-09, 1.7286803622692937e-10,
      -7.527469062218636e-10, -1.5806027159628096e-09, -2.263602640413725e-09,
      -2.7663673366319145e-09, -3.066839337009234e-09, -3.1569575657466174e-09,
      -3.0424095763627084e-09, -2.741527131065286e-09, -2.28344140259224e-09,
      -1.7056546369305732e-09, -1.051213551490189e-09, -3.656849146619404e-10,
      3.0586458259559076e-10, 9.21693268386381e-10, 1.4458460391906415e-09,
      1.8501164167244405e-09, 2.1154119921224232e-09, 2.232469152576753e-09,
      2.2019070956408366e-09, 2.033653490440466e-09, 1.7458121577653913e-09,
      1.3630746419074424e-09, 9.148008952658308e-10, 4.3290845605096373e-10,
      -5.0285928604122484e-11, -5.041330673527809e-10, -9.015006438857949e-10,
      -1.2202998322220225e-09, -1.4446100714166264e-09, -1.565352578565647e-09,
      -1.5804944129835075e-09, -1.4947955980720534e-09, -1.319140047515894e-09,
      -1.0695151747270448e-09, -7.657237841620891e-10, -4.299242586724128e-10,
      -8.510072408189101e-11, 2.4643620248761413e-10, 5.444248573314731e-10,
      7.918238277899022e-10, 9.757160324059825e-10, 1.0879028391978302e-09,
      1.1251674080022426e-09, 1.0892085028983939e-09, 9.862668073688288e-10,
      8.264840415840832e-10, 6.230499084602248e-10, 3.912023425904713e-10,
      1.4715227438288868e-10, -9.29949573909102e-11, -3.142531053336556e-10,
      -5.036428111661804e-10, -6.509043244353146e-10, -7.48999518686733e-10,
      -7.943828448067124e-10, -7.870365864290937e-10, -7.302809493084489e-10,
      -6.30383195767767e-10, -4.960014416218759e-10, -3.3750726759340615e-10,
      -1.6623657556897327e-10, 6.280015619366029e-12, 1.6905742297459284e-10,
      3.1232174356417176e-10, 4.280632053148818e-10, 5.104475335242487e-10,
      5.560673667600007e-10, 5.640264727404518e-10, 5.358604885047331e-10,
      4.753080529813222e-10, 3.8795491694147496e-10, 2.8078043090575345e-10,
      1.616403974915599e-10, 3.8722461465980296e-11, -7.999001007424294e-11,
      -1.872120890869351e-10, -2.767804888464243e-10, -3.4398286739009405e-10,
      -3.8577747697352856e-10, -4.0089519689205543e-10, -3.898238615068148e-10,
      -3.5468224897074615e-10, -2.989976800710086e-10, -2.2740652122562891e-10,
      -1.4530071987015809e-10, -5.84456633889588e-11, 2.7404901994074055e-11,
      1.0687236351604396e-10, 1.752733109882025e-10, 2.2887827868510173e-10,
      2.6509610653463227e-10, 2.8257628111990106e-10, 2.812272212840247e-10,
      2.621539027348965e-10, 2.2752313682778095e-10, 1.803689468031303e-10,
      1.2435360185439645e-10, 6.350183297770847e-11, 1.92650281120845e-12,
      -5.643644693685274e-11, -1.0806749914540856e-10, -1.5006374263712976e-10,
      -1.8028919216581167e-10, -1.9746843410504186e-10, -2.0122074042991559e-10,
      -1.9203571574330422e-10, -1.711951844911422e-10, -1.4064917277988443e-10,
      -1.0285631899146194e-10, -6.060073889940566e-11, -1.6798209863087983e-11,
      2.5695482002274813e-11, 6.426202016074725e-11, 9.667339742451553e-11,
      1.2121177895160374e-10, 1.3675058869743927e-10, 1.4279378755490716e-10,
      1.3947312140335087e-10, 1.2750578914753472e-10, 1.0811735295512488e-10,
      8.293665140749206e-11, 5.387088196684295e-11, 2.2969831926684946e-11,
      -7.711562476114823e-12, -3.62435403867175e-11, -6.093686195299008e-11,
      -8.043668675263892e-11, -9.379020642854725e-11, -1.0048517264520415e-10,
      -1.0045845816118117e-10, -9.407573193871671e-11, -8.208509871198772e-11,
      -6.554904673052593e-11, -4.5760184937631825e-11, -2.4146979910655398e-11,
      -2.1759994609967476e-12, 1.874296148208061e-11, 3.7343024722898e-11,
      5.2572663562745936e-11, 6.36505868267793e-11, 7.010054921959872e-11,
      7.176497204262572e-11, 6.879765971048785e-11, 6.163720495810585e-11,
      5.096381148084418e-11, 3.7643164407591156e-11, 2.2661602091614864e-11,
      7.057162869578171e-12, -8.148906173249872e-12, -2.2015869019017198e-11,
      -3.373867501286025e-11, -4.269155870214012e-11, -4.8457932783149816e-11,
      -5.084542462347222e-11, -4.988590925585498e-11, -4.5821349195199373e-11,
      -3.907710575720073e-11, -3.0225089274132525e-11, -1.993963044884326e-11,
      -8.949259653732882e-12, 2.012332620345157e-12, 1.2253006383559776e-11,
      2.1163723890487974e-11, 2.825259228079626e-11, 3.3169649364583007e-11,
      3.5721325255384456e-11, 3.5874223706182484e-11, 3.374856218567777e-11,
      2.960224581419742e-11, 2.3807090207034422e-11, 1.6819123085405885e-11,
      9.145164735414839e-12, 1.3080037523225546e-12, -6.187552030817295e-12,
      -1.2885648372982849e-11, -1.8405582278137704e-11, -2.2461825142601123e-11,
      -2.4876938591827578e-11, -2.558695049513352e-11, -2.4639259220858177e-11,
      -2.2183603355066697e-11, -1.8457043864654814e-11, -1.3764233325959497e-11,
      -8.454476074842015e-12, -2.8972047853280775e-12, 2.542488821710892e-12,
      7.526723545315986e-12, 1.1764737883600626e-11, 1.5028739188546626e-11,
      1.7164909641305127e-11, 1.8099134798597747e-11, 1.7837377954564066e-11,
      1.6460966555340153e-11, 1.4117364474877193e-11, 1.1007258563625828e-11,
      7.368976272519932e-12, 3.4613649963746675e-12, -4.5370009421264946e-13,
      -4.128052632901117e-12, -7.34219779933227e-12, -9.917650366825777e-12,
      -1.1726009376400225e-11, -1.2694371862724382e-11, -1.2806941267305816e-11,
      -1.2102934808684921e-11, -1.0671122651677019e-11, -8.641526849087687e-12,
      -6.17495918185568e-12, -3.4511770130994932e-12, -6.564815407477657e-13,
      2.0284265194166796e-12, 4.439579213705274e-12, 6.439211894949731e-12,
      7.923062676021082e-12, 8.825156414896375e-12, 9.119906691776801e-12,
      8.821547986257703e-12, 7.981078558311664e-12, 6.681042296326239e-12,
      5.02859677979809e-12, 3.1473990418352778e-12, 1.1688865579686342e-12,
      -7.764620124595712e-13, -2.5673321767545048e-12, -4.098754691154151e-12,
      -5.28786338811576e-12, -6.077942436785961e-12, -6.440599535024914e-12,
      -6.376028984343962e-12, -5.9114514318568255e-12, -5.0979277526200346e-12,
      -4.005836744206485e-12, -2.7193751795626637e-12, -1.3304812184854657e-12,
      6.740304364146307e-14, 1.3853264454743443e-12, 2.544214801440431e-12,
      3.479340230853098e-12, 4.1436405752718745e-12, 4.5097411042125e-12,
      4.5706208376306075e-12, 4.338954711195588e-12, 3.845244918046874e-12,
      3.1349252500175497e-12, 2.264677300477987e-12, 1.298234333494375e-12,
      3.01966111955579e-13, -6.594640425553329e-13, -1.5270990289070988e-12,
      -2.251110042891889e-12, -2.793455669336559e-12, -3.129651026198678e-12,
      -3.2495831919330683e-12, -3.1573729559234008e-12, -2.8703432825393287e-12,
      -2.4172081403740755e-12, -1.835638532758003e-12, -1.1693934864595313e-12,
      -4.652211198485124e-13, 2.3026164510489096e-13, 8.735121048499849e-13,
      1.42665088169809e-12, 1.8595524308856573e-12, 2.1513316498288043e-12,
      2.2911652113265662e-12, 2.2784316677253417e-12, 2.122198348115116e-12,
      1.8401228910797312e-12, 1.4568706263248667e-12, 1.0021741770535934e-12,
      5.086774537983851e-13, 9.712156556748095e-15, -4.628488472602046e-13,
      -8.805295840869634e-13, -1.2198691190751933e-12, -1.4636347046096209e-12,
      -1.6015750895439525e-12, -1.6306912166476707e-12, -1.555033310705586e-12,
      -1.3850628443379772e-12, -1.1366433210125692e-12, -8.297438425035556e-13,
      -4.869530575126896e-13, -1.3190780323888742e-13, 2.1225949818034175e-13,
      5.243574482670244e-13, 7.863716519703953e-13, 9.844327143351523e-13,
      1.1094695061915921e-12, 1.1575233999589779e-12, 1.129721947757114e-12,
      1.031932108757988e-12, 8.741323234712121e-13, 6.695583973080462e-13,
      4.3368949391872006e-13, 1.8314706719762252e-13, -6.541887319800379e-14,
      -2.9638499485218283e-13, -4.960877621255533e-13, -6.535820026972375e-13,
      -7.611863676739221e-13, -8.147927058153038e-13, -8.139325573254851e-13,
      -7.616097111389525e-13, -6.639220898601202e-13, -5.2950829904717e-13,
      -3.688633600732165e-13, -1.9357401373114913e-13, -1.5526343209677834e-14,
      1.538626395115152e-13, 3.0434211283155463e-13, 4.2741301404614053e-13,
      5.167710402882841e-13, 5.685867668412101e-13, 5.816139757682366e-13,
      5.571286417363034e-13, 4.98711606178141e-13, 4.118971574004435e-13,
      3.0371701723267887e-13, 1.8217425649646474e-13, 5.5684226613453485e-14,
      -6.748032623940768e-14, -1.79705075265985e-13, -2.7448032819344965e-13,
      -3.4675317371972447e-13, -3.931683676820675e-13, -4.121887393311648e-13,
      -4.0409402184030824e-13, -3.7086476437599213e-13, -3.1596489511293253e-13,
      -2.440421836150486e-13, -1.6057000439731757e-13, -7.145625099994911e-14,
      1.7354070970661722e-14, 1.0025707986983603e-13, 1.723261847562153e-13,
      2.2958718676726936e-13, 2.6921821217290663e-13, 2.8966589481100733e-13,
      2.906749904510416e-13, 2.732342366096496e-13, 2.3944641935056797e-13,
      1.9233497400444057e-13, 1.3560279565770502e-13, 7.336111079255648e-14,
      9.847189473008065e-15, -5.0850633210423123e-14, -1.050436203662636e-13,
      -1.496544347860919e-13, -1.823787793059658e-13, -2.0178936294368216e-13,
      -2.073787364255826e-13, -1.9954159649668966e-13, -1.795009566356303e-13,
      -1.4918589604876112e-13, -1.1107124556266086e-13, -6.799141691841564e-14,
      -2.294155731076921e-14, 2.112070066538552e-14, 6.146037975672022e-14,
      9.572618281922961e-14, 1.2207851712571109e-13, 1.3927820323670135e-13,
      1.4673238346974936e-13, 1.4449704231232642e-13, 1.332383287344247e-13,
      1.141573589701304e-13, 8.888523611184504e-14, 5.935654290112416e-14,
      2.7670479329645225e-14, -4.050898086755005e-15, -3.379820716720598e-14,
      -5.979580140882128e-14, -8.060148403591487e-14, -9.517972036046748e-14,
      -1.0294515031368665e-13, -1.0377525572483253e-13, -9.799305097294031e-14,
      -8.632251565545172e-14, -6.982106570994395e-14, -4.9794579882425234e-14,
      -2.7701303671732526e-14, -5.051314419685782e-15, 1.66918497929511e-14,
      3.620128925330855e-14, 5.236331578141707e-14, 6.433638649113214e-14,
      7.158962372830219e-14, 7.391958887955876e-14, 7.144542608122992e-14,
      6.458385442387694e-14, 5.4006682459034973e-14, 4.058448009487562e-14,
      2.5320722149955613e-14, 9.28108721284636e-15, -6.4773515698243774e-15,
      -2.0972556802782134e-14, -3.335561136048122e-14, -4.2957233191382843e-14,
      -4.932040324318971e-14, -5.2217793641855366e-14, -5.1653716256403725e-14,
      -4.785130655529507e-14, -4.122655332446132e-14, -3.235153005733519e-14,
      -2.190973962655436e-14, -1.0646825290278733e-14, 6.799818274707874e-16,
      1.1350411174214988e-14, 2.0724733283833396e-14, 2.8279883412382866e-14,
      3.3636246019740584e-14, 3.6573910770150897e-14, 3.703794141583259e-14,
      3.513291907654746e-14, 3.1107686031091374e-14, 2.533178614279869e-14,
      1.8265542500240544e-14, 1.0426010437357056e-14, 2.3511839252354984e-15,
      -5.43518490588289e-15, -1.2455959938090287e-14, -1.8308292110362232e-14,
      -2.268509086318284e-14, -2.5389272882398236e-14, -2.6340277526911323e-14,
      -2.5572855373267885e-14
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      4.8709873729449025e-06, 4.690739079223094e-05, 0.0002237288577519752, 0.0007183255697986771,
      0.001777705132576753, 0.003665985369582598, 0.00661659716129209, 0.01079308693159206,
      0.016260626866610735, 0.022969426601711473, 0.03075031670033043, 0.03932190140520261,
      0.04830790847225075, 0.05726274010712429, 0.06570278184072842, 0.0731407731374694,
      0.07912048865754433, 0.08324911347134648, 0.08522499861763405, 0.08485892505858537,
      0.08208754703615925, 0.07697828846375836, 0.06972558526001853, 0.060638960822989245,
      0.05012395352165868, 0.038657352691988986, 0.026758519552369225, 0.014958756999446939,
      0.0037707420702113204, -0.006340049196033964, -0.014980200416091362,
      -0.021848080758624468, -0.02674740672846656, -0.029594041912473012,
      -0.030415888403710532, -0.029346163627947747, -0.026610757101559874,
      -0.022510699619256103, -0.017401034100706776, -0.011667540541971395,
      -0.005702831531338461, 0.00011669948867677137, 0.005451720494172359,
      0.010017441092013262, 0.013596843998770576, 0.016049088936263972,
      0.017312838297936426, 0.017404580841044646, 0.0164123347847824, 0.0144853770174188,
      0.011820856066306125, 0.008648292688018309, 0.0052130476449845685,
      0.0017598404484394543, -0.0014826608795825097, -0.00431528299583055,
      -0.006579100634579706, -0.008162986480195427, -0.00900767344030555,
      -0.009106280009132696, -0.008501474238065155, -0.007279653126290233,
      -0.005562680631461736, -0.00349785041990771, -0.001246813574413353,
      0.0010257652282652395, 0.003163085739118654, 0.005025958305012219, 0.0065008615205912,
      0.007505893194147189, 0.007994353698640436, 0.00795586579604991, 0.007415096953054113,
      0.006428298935297609, 0.005078006386118831, 0.0034663343309391044,
      0.0017073794560853038, -8.07406911256616e-05, -0.0017836826491647133,
      -0.003298017592914897, -0.004537297196359961, -0.005436715725446587,
      -0.005956146412195171, -0.0060814455566356, -0.005824033694602714,
      -0.005218872181649388, -0.004321049138156948, -0.0032012655454587654,
      -0.0019405665223908657, -0.0006246922325663908, 0.000661573046216984,
      0.0018396953050848202, 0.0028420120404134353, 0.003615423352203841,
      0.0041239686033196065, 0.004350184797964132, 0.0042952255498877896,
      0.003977799114212582, 0.0034320555769553392, 0.0027046128279229627,
      0.0018509552676567698, 0.0009314663309245121, 7.365057265487711e-06,
      -0.0008631915060267797, -0.001628602837972836, -0.002246717426078547,
      -0.002686972977373483, -0.002931689782629852, -0.0029764812834999696,
      -0.0028298036291935207, -0.0025117192525933064, -0.002051995119487328,
      -0.0014876918340788654, -0.0008604235168359497, -0.00021347944322904115,
      0.00041100317206786767, 0.000974639354479746, 0.0014450175078084165,
      0.0017974217132018645, 0.002015973429059973, 0.002094151981060885,
      0.0020346947194630604, 0.0018489169049989086, 0.0015555259109933076,
      0.001179032265910144, 0.0007478799969695901, 0.0002924298439377877,
      -0.00015706903180340564, -0.000572389853804268, -0.0009290070007482662,
      -0.001207449090390236, -0.0013942584213753797, -0.0014825174176662564,
      -0.0014719322601569223, -0.0013684924490627536, -0.0011837508648220613,
      -0.0009337904986000222, -0.0006379602677113568, -0.0003174724788421303,
      6.041758916747919e-06, 0.0003119254278505676, 0.000581751412045811,
      0.0008003691394104398, 0.0009566871169083678, 0.0010441561155092496,
      0.0010609386199197874, 0.0010097707972366488, 0.0008975423638874344,
      0.0007346362131685886, 0.0005340826062577938, 0.00031059150062444525,
      7.953086198426204e-05, -0.00014408144740182978, -0.00034650912908097394,
      -0.0005160974477925968, -0.0006438982471795275, -0.0007240898896150174,
      -0.0007541766359259555, -0.0007349667779978001, -0.0006703428769224139,
      -0.0005668498939600256, -0.0004331371310676719, -0.0002792972058269588,
      -0.0001161494625242272, 4.548382793013483e-05, 0.0001954622871397369,
      0.00032493204222581356, 0.00042681621447881936, 0.0004961664233632487,
      0.0005303605864253976, 0.0005291428190286893, 0.0004945114570682792,
      0.000430470510644763, 0.00034266767011202946, 0.00023794791315420236,
      0.00012385552961479592, 8.118868143228735e-06, -0.0001018486552991563,
      -0.0001994005921723106, -0.0002790364779568519, -0.000336687801105168,
      -0.00036989786759042306, -0.00037788992575781244, -0.0003615252923898153,
      -0.000323160087515001, -0.0002664151355708307, -0.00019587829716470874,
      -0.00011676172834562925, -3.453819824266881e-05, 4.541938568347108e-05,
      0.00011817260637396607, 0.00017950654314591546, 0.000226157336388828,
      0.00025596723738906263, 0.0002679612584313226, 0.00026234481849297345,
      0.00024042681233680903, 0.00020447701055757787, 0.00015753037158286552,
      0.00010315352496258494, 4.519025289501225e-05, -1.249678522601242e-05,
      -6.627153657776248e-05, -0.00011294240402343014, -0.0001499401702728934,
      -0.00017544689900633956, -0.00018847031000088435, -0.0001888618739938865,
      -0.00017728052972979175, -0.00015510726393710696, -0.00012431862084778393,
      -8.732937021773725e-05, -4.6815960721207996e-05, -5.532972001302984e-06,
      3.3865439602916835e-05, 6.898807217984432e-05, 9.784376800886503e-05,
      0.00011894576379736815, 0.0001313784703323499, 0.00013482448973574696,
      0.00012955231355538517, 0.00011636760923066583, 9.653314933615688e-05,
      7.166414875291025e-05, 4.3606964898126137e-05, 1.4309738250421064e-05,
      -1.4306403979274318e-05, -4.046746073203559e-05, -6.265085546938442e-05,
      -7.966817590383953e-05, -9.072228633089356e-05, -9.543658593347813e-05,
      -9.385606972320672e-05, -8.642165182523636e-05, -7.392082384635097e-05,
      -5.7419052297810424e-05, -3.817729948866771e-05, -1.7561638909707424e-05,
      3.048886903841963e-06, 2.2350239728851595e-05, 3.919184865228858e-05,
      5.264111223276269e-05, 6.203061384052283e-05, 6.698599827553112e-05,
      6.743379270987625e-05, 6.358976303239683e-05, 5.592959646943628e-05,
      4.5144722848715624e-05, 3.208687507389923e-05, 1.770550703749041e-05,
      2.982416209154453e-06, -1.1132140366910616e-05, -2.377787467720454e-05,
      -3.4234038742326314e-05, -4.195748059207988e-05, -4.660740040758516e-05,
      -4.8055960345188185e-05, -4.6384842635664195e-05, -4.1868734685098836e-05,
      -3.494749422270146e-05, -2.6189368989768075e-05, -1.6248082992939748e-05,
      -5.8168372243060214e-06, 4.41769702738457e-06, 1.3818480362315818e-05,
      2.1835732530417418e-05, 2.8037000012309706e-05, 3.2128170465488216e-05,
      3.396459437459438e-05, 3.355214577289132e-05, 3.103869970724814e-05,
      2.669708472450794e-05, 2.090105085032664e-05, 1.4096152126111974e-05,
      6.767661764970553e-06, -5.922889161165767e-07, -7.516226158758726e-06,
      -1.3589582420466786e-05, -1.847406723221578e-05, -2.1924945375076185e-05,
      -2.380145885258421e-05, -2.407010437156064e-05, -2.2800945790253e-05,
      -2.0157572053476356e-05, -1.638168021692103e-05, -1.1773550265911943e-05,
      -6.669869827652735e-06, -1.4204556307691963e-06, 3.6345953771283623e-06,
      8.18590254065614e-06, 1.1972717189406694e-05, 1.4796790553122955e-05,
      1.6531535462243082e-05, 1.712615688123189e-05, 1.6604762312896515e-05,
      1.5060780210268118e-05, 1.2647293694240273e-05, 9.564122487669605e-06,
      6.042646661977063e-06, 2.3294548973543267e-06, -1.330084280423665e-06,
      -4.707284430811692e-06, -7.603710151257783e-06, -9.862096852965892e-06,
      -1.1374073760467897e-05, -1.2084374494436524e-05, -1.1991458970398933e-05,
      -1.114470158374303e-05, -9.638509560428877e-06, -7.603909921531291e-06,
      -5.19827455018594e-06, -2.5939344259189245e-06, 3.353628033682528e-08,
      2.5166069390244763e-06, 4.705956987607145e-06, 6.478939525302467e-06,
      7.745898576617072e-06, 8.454056462857824e-06, 8.58885684996152e-06,
      8.172816253564784e-06, 7.262091600058314e-06, 5.941104739048851e-06,
      4.315669307949618e-06, 2.5051360088257022e-06, 6.341065322456593e-07,
      -1.1757361343405257e-06, -2.8131703014504536e-06, -4.1839077039001e-06,
      -5.215643539427267e-06, -5.861441836608787e-06, -6.101332052694375e-06,
      -5.942112723285052e-06, -5.415471677768058e-06, -4.574632939465585e-06,
      -3.4898222894830293e-06, -2.242902422827766e-06, -9.215621745179806e-07,
      3.8654830559534634e-07, 1.5993623501603883e-06, 2.6452879738143673e-06,
      3.4671713302006795e-06, 4.02513183846261e-06, 4.298150658766113e-06,
      4.284379497069082e-06, 4.000219490635573e-06, 3.478295066521316e-06,
      2.7645108333855967e-06, 1.9144274132688657e-06, 9.892224461658125e-07,
      5.15148358551863e-08, -8.386760972291593e-07, -1.627588138494164e-06,
      -2.2707796697349207e-06, -2.735437423183522e-06, -3.0018233771637876e-06,
      -3.0638158427470575e-06, -2.9285595485000082e-06, -2.615295115179395e-06,
      -2.1534864323733147e-06, -1.5804024635654314e-06, -9.383360564033275e-07,
      -2.7165542036411765e-07, 3.761160715256567e-07, 9.650084875192401e-07,
      1.4609423937259087e-06, 1.8375665823954986e-06, 2.077507210865106e-06,
      2.1729811721511163e-06, 2.1257693071594347e-06, 1.94658581827747e-06,
      1.6539164862972607e-06, 1.2724279777198398e-06, 8.310721339665707e-07,
      3.610217282115604e-07, -1.064225496598355e-07, -5.418198666668021e-07,
      -9.193516825763271e-07, -1.2182595152095607e-06, -1.4238846279027775e-06,
      -1.528265398950598e-06, -1.530278520312693e-06, -1.43533979150283e-06,
      -1.2547072916329116e-06, -1.0044525591707121e-06, -7.041828650851422e-07,
      -3.756089178898501e-07, -4.105701243212524e-08, 2.7797721136078066e-07,
      5.621441283700447e-07, 7.953484521938438e-07, 9.655915943847665e-07,
      1.0655091527357027e-06, 1.0925860226957948e-06, 1.0490529753848956e-06,
      9.414884957628313e-07, 7.801670385401828e-07, 5.782086785518856e-07,
      3.5059472397316293e-07, 1.1311884685373277e-07, -1.1865640017076756e-07,
      -3.3037193638435104e-07, -5.097156916439637e-07, -6.470909235576383e-07,
      -7.360765073277097e-07, -7.736613337289887e-07, -7.602502134969323e-07,
      -6.994532873753165e-07, -5.976839920401359e-07, -4.6360139108587835e-07,
      -3.074405904679261e-07, -1.4027967290766736e-07, 2.6707019594307593e-08,
      1.8296126028240172e-07, 3.1917574664525276e-07, 4.2781537051681336e-07,
      5.034981091074764e-07, 5.432190339984342e-07, 5.464117569599914e-07,
      5.148522268089607e-07, 4.524195021438838e-07, 3.6473638406621906e-07,
      2.587191568182105e-07, 1.4206985255113106e-07, 2.2746284281730585e-08,
      -9.155541043955289e-08, -1.9387364566281894e-07, -2.7838217128237836e-07,
      -3.406973057480397e-07, -3.7807723999699155e-07, -3.8950664409927703e-07,
      -3.756674331785905e-07, -3.3880370713509894e-07, -2.824951418639436e-07,
      -2.1135813012415814e-07, -1.3069749754322478e-07, -4.613351107008775e-08,
      3.677087764679788e-08, 1.128589769795662e-07, 1.776846947764787e-07,
      2.2775542796839898e-07, 2.607014586942319e-07, 2.753651164694084e-07,
      2.7180840847948417e-07, 2.512430500629501e-07, 2.1589152538785115e-07,
      1.6879170572919527e-07, 1.1356044632249085e-07, 5.413334374271942e-08,
      -5.501585974773867e-09, -6.155912524646327e-08, -1.106854188392857e-07,
      -1.5014686252723198e-07, -1.7796951120151364e-07, -1.930228634353957e-07,
      -1.9504573225307647e-07, -1.8461570091159728e-07, -1.6306715153585584e-07,
      -1.323658388944807e-07, -9.495029992260529e-08, -5.3551931143807854e-08,
      -1.1006275423876187e-08, 2.993206331568576e-08, 6.675936085741686e-08,
      9.736763438795672e-08, 1.201566156739351e-07, 1.3410753046314154e-07,
      1.388160832112674e-07, 1.3448476874153328e-07, 1.2187719983219302e-07,
      1.0223939791922483e-07, 7.719481693291428e-08, 4.8621165975373625e-08,
      1.8517811639146892e-08, -1.1127338550179102e-08, -3.846301926208299e-08,
      -6.188436450887586e-08, -8.012112820766152e-08, -9.229995137071021e-08,
      -9.797814075184306e-08, -9.714836393761404e-08, -9.02155386286854e-08,
      -7.794888434239995e-08, -6.141351587066252e-08, -4.188701537550418e-08,
      -2.0767076216716147e-08, 5.234533139934157e-10, 2.0627976302405106e-08,
      3.833841119648456e-08, 5.266360249128631e-08, 6.288029893628623e-08,
      6.856441710425395e-08, 6.960167936962667e-08, 6.61780699514712e-08,
      5.875180585493429e-08, 4.800959748118436e-08, 3.4810817642020836e-08,
      2.012376697108526e-08, 4.958497119453629e-09, -9.699370621597145e-09,
      -2.2949696920839546e-08, -3.403016039030788e-08, -4.235703784734068e-08,
      -4.755247384014582e-08, -4.945724530500219e-08, -4.812899898798059e-08,
      -4.382685982335826e-08, -3.698412233040033e-08, -2.8171398541844368e-08,
      -1.805307140505673e-08, -7.3401719864391035e-09, 3.2571437299852374e-09,
      1.3074489288181074e-08, 2.1532814676453887e-08, 2.8170430229172094e-08,
      3.26658693523374e-08, 3.485063929476837e-08, 3.471160060068759e-08,
      3.238338626724795e-08, 2.8131879705449297e-08, 2.233028125753e-08,
      1.54296792170696e-08, 7.926285329264041e-09, 3.2758887280687935e-10,
      -6.880370197592986e-09, -1.3262598543887626e-08, -1.8459913589783817e-08,
      -2.2207569047406896e-08, -2.4346895524900126e-08, -2.4829597778186267e-08,
      -2.37148342996734e-08, -2.1159654896275702e-08, -1.7403761073597142e-08,
      -1.2749861076480701e-08, -7.541101355313373e-09, -2.137161006599598e-09,
      3.1094055621918913e-09, 7.875094043371835e-09, 1.1884349961330325e-08,
      1.4924410507410207e-08, 1.685536895473697e-08, 1.761508342886967e-08,
      1.7218898563046184e-08, 1.57544785347082e-08, 1.337234318997468e-08,
      1.0272938849592484e-08, 6.691249659963491e-09, 2.8800565306856816e-09,
      -9.070236593952772e-10, -4.431633334659891e-09, -7.484932261142569e-09,
      -9.89921552482923e-09, -1.1556299171449172e-08, -1.2392317857967828e-08,
      -1.2398825188256399e-08, -1.1620327308089404e-08, -1.0148598983213086e-08,
      -8.11431609258717e-09, -5.676679385722565e-09, -3.0117949317826435e-09,
      -3.006139223611144e-10, 2.2827810881539024e-09, 4.5818209653488095e-09,
      6.46641003645052e-09, 7.839725588141523e-09, 8.642543511278623e-09,
      8.854950305368734e-09, 8.495474627902074e-09, 7.617833079358885e-09,
      6.305625354001782e-09, 4.665425512562549e-09, 2.818793441677328e-09,
      8.937705222520385e-10, -9.835743712515795e-10, -2.6970162592338138e-09,
      -4.1469962449865355e-09, -5.256019578011793e-09, -5.972365095371872e-09,
      -6.271962729827261e-09, -6.1584194666954315e-09, -5.661292368085087e-09,
      -4.832812876348024e-09, -3.743353560483204e-09, -2.475992286546778e-09,
      -1.1205666899583483e-09, 2.3237719074101018e-10, 1.4973534301444292e-09,
      2.599072141166077e-09, 3.4766520397001023e-09, 4.086693058793998e-09,
      4.4050762918437625e-09, 4.427446271403445e-09, 4.168416414256885e-09,
      3.6596170561453747e-09, 2.946772278857601e-09, 2.0860431118715697e-09,
      1.1399082527693805e-09, 1.7286803608303495e-10, -7.527469063775704e-10,
      -1.5806027161198583e-09, -2.263602640562049e-09, -2.766367336762471e-09,
      -3.0668393371145236e-09, -3.156957565821083e-09, -3.0424095764029917e-09,
      -2.741527131070335e-09, -2.2834414025632617e-09, -1.70565463687085e-09,
      -1.051213551404769e-09, -3.6568491455723327e-10, 3.058645827122848e-10,
      9.216932685073744e-10, 1.445846039308362e-09, 1.8501164168319013e-09,
      2.1154119922136323e-09, 2.2324691526470387e-09, 2.2019070956870722e-09,
      2.0336534904611895e-09, 1.7458121577608081e-09, 1.363074641879328e-09,
      9.148008952173353e-10, 4.3290845598634236e-10, -5.028592867983522e-11,
      -5.041330674341297e-10, -9.015006439672701e-10, -1.2202998322984105e-09,
      -1.4446100714833221e-09, -1.5653525786189135e-09, -1.5804944130206655e-09,
      -1.494795598091598e-09, -1.3191400475175306e-09, -1.0695151747116444e-09,
      -7.657237841315726e-10, -4.299242586295737e-10, -8.510072403017153e-11,
      2.4643620254437624e-10, 5.444248573893098e-10, 7.91823827844975e-10,
      9.757160324548205e-10, 1.0879028392375336e-09, 1.1251674080306383e-09,
      1.0892085029141374e-09, 9.862668073714477e-10, 8.26484041573963e-10,
      6.230499084385408e-10, 3.912023425590731e-10, 1.471522743441486e-10,
      -9.299495743427324e-11, -3.142531053787654e-10, -5.036428112101928e-10,
      -6.509043244755952e-10, -7.489995187210125e-10, -7.943828448332106e-10,
      -7.870365864466066e-10, -7.302809493163952e-10, -6.303831957661918e-10,
      -4.960014416114166e-10, -3.375072675752222e-10, -1.6623657554464659e-10,
      6.280015647951432e-12, 1.6905742300538443e-10, 3.123217435950861e-10,
      4.28063205343937e-10, 5.104475335496843e-10, 5.560673667803767e-10,
      5.640264727547232e-10, 5.35860488512295e-10, 4.753080529820254e-10,
      3.8795491693561097e-10, 2.8078043089401364e-10, 1.6164039747497133e-10,
      3.872246144582323e-11, -7.999001009652897e-11, -1.8721208910985036e-10,
      -2.7678048886850663e-10, -3.439828674100094e-10, -3.857774769901487e-10,
      -4.0089519690451846e-10, -3.8982386151456593e-10, -3.546822489735571e-10,
      -2.98997680068975e-10, -2.2740652121914785e-10, -1.4530071985988776e-10,
      -5.844566337576321e-11, 2.7404902009190493e-11, 1.0687236353200721e-10,
      1.752733110039406e-10, 2.288782786996126e-10, 2.6509610654704386e-10,
      2.8257628112952013e-10, 2.8122722129037187e-10, 2.6215390273772533e-10,
      2.275231368270816e-10, 1.803689467991177e-10, 1.243536018474851e-10,
      6.350183296847575e-11, 1.926502800349691e-12, -5.6436446948574374e-11,
      -1.0806749915721395e-10, -1.5006374264827398e-10, -1.802891921756293e-10,
      -1.9746843411298523e-10, -2.012207404355835e-10, -1.9203571574646007e-10,
      -1.7119518449172051e-10, -1.4064917277798646e-10, -1.0285631898734108e-10,
      -6.060073889344368e-11, -1.6798209855764407e-11, 2.5695482010418006e-11,
      6.42620201691431e-11, 9.667339743260929e-11, 1.2121177895888738e-10,
      1.3675058870348146e-10, 1.4279378755937683e-10, 1.3947312140603297e-10,
      1.2750578914833804e-10, 1.0811735295408155e-10, 8.293665140474932e-11,
      5.387088196264811e-11, 2.2969831921364746e-11, -7.711562482178835e-12,
      -3.6243540393115806e-11, -6.093686195931243e-11, -8.043668675850023e-11,
      -9.379020643361068e-11, -1.004851726491999e-10, -1.0045845816392012e-10,
      -9.407573194009832e-11, -8.208509871200194e-11, -6.554904672924914e-11,
      -4.576018493521765e-11, -2.4146979907321062e-11, -2.1759994570061654e-12,
      1.8742961486435894e-11, 3.734302472731862e-11, 5.2572663566943994e-11,
      6.365058683049599e-11, 7.010054922261918e-11, 7.176497204479042e-11,
      6.879765971169984e-11, 6.163720495833384e-11, 5.0963811480121116e-11,
      3.764316440600878e-11, 2.2661602089314788e-11, 7.057162866740252e-12,
      -8.14890617642093e-12, -2.2015869022306106e-11, -3.373867501605532e-11,
      -4.269155870504648e-11, -4.84579327856009e-11, -5.0845424625338816e-11,
      -4.9885909257051525e-11, -4.5821349195687106e-11, -3.907710575698775e-11,
      -3.0225089273270835e-11, -1.993963044742321e-11, -8.949259651875443e-12,
      2.01233262249764e-12, 1.2253006385853727e-11, 2.1163723892768893e-11,
      2.825259228291857e-11, 3.316964936641883e-11, 3.572132525683081e-11,
      3.587422370716652e-11, 3.374856218615986e-11, 2.960224581417197e-11,
      2.3807090206528484e-11, 1.681912308447581e-11, 9.14516473414124e-12,
      1.3080037508039741e-12, -6.187552032471527e-12, -1.2885648374660101e-11,
      -1.840558227972937e-11, -2.2461825144009333e-11, -2.4876938592970896e-11,
      -2.558695049595131e-11, -2.46392592213134e-11, -2.218360335514712e-11,
      -1.8457043864372584e-11, -1.3764233325349186e-11, -8.454476073957336e-12,
      -2.8972047842375558e-12, 2.5424888229289798e-12, 7.526723546579045e-12,
      1.1764737884827184e-11, 1.5028739189661433e-11, 1.7164909642243603e-11,
      1.8099134799309542e-11, 1.783737795501554e-11, 1.646096655551565e-11,
      1.4117364474779165e-11, 1.100725856327376e-11, 7.36897627194826e-12,
      3.4613649956298673e-12, -4.53700095075588e-13, -4.128052633822574e-12,
      -7.342197800251975e-12, -9.91765036768663e-12, -1.1726009377151725e-11,
      -1.2694371863325473e-11, -1.280694126772699e-11, -1.2102934808909488e-11,
      -1.0671122651701506e-11, -8.641526848921387e-12, -6.174959181519408e-12,
      -3.4511770126236947e-12, -6.564815401700971e-13, 2.0284265200540994e-12,
      4.439579214358756e-12, 6.439211895576858e-12, 7.923062676583332e-12,
      8.825156415361357e-12, 9.119906692119975e-12, 8.821547986463524e-12,
      7.981078558374081e-12, 6.6810422962485765e-12, 5.028596779592338e-12,
      3.1473990415208853e-12, 1.1688865575708872e-12, -7.764620129114481e-13,
      -2.5673321772293997e-12, -4.098754691621127e-12, -5.287863388546e-12,
      -6.07794243715447e-12, -6.440599535311907e-12, -6.376028984535835e-12,
      -5.91145143194669e-12, -5.097927752607796e-12, -4.005836744098489e-12,
      -2.7193751793709614e-12, -1.3304812182267552e-12, 6.740304394713215e-14,
      1.3853264458050122e-12, 2.544214801773715e-12, 3.4793402311676296e-12,
      4.1436405755485955e-12, 4.509741104435742e-12, 4.570620837788909e-12,
      4.338954711282198e-12, 3.845244918059935e-12, 3.134925249959962e-12,
      2.264677300356978e-12, 1.2982343333208197e-12, 3.019661117431228e-13,
      -6.594640427912794e-13, -1.5270990291504256e-12, -2.2511100431268417e-12,
      -2.793455669548719e-12, -3.1296510263758052e-12, -3.249583192065765e-12,
      -3.15737295600556e-12, -2.8703432825683507e-12, -2.4172081403508526e-12,
      -1.835638532686681e-12, -1.1693934863470804e-12, -4.652211197041425e-13,
      2.3026164527042724e-13, 8.735121050251511e-13, 1.4266508818713351e-12,
      1.8595524310461473e-12, 2.151331649967068e-12, 2.2911652114350246e-12,
      2.278431667798688e-12, 2.122198348150531e-12, 1.840122891076931e-12,
      1.4568706262859908e-12, 1.002174176982944e-12, 5.08677453702044e-13,
      9.712156442102599e-15, -4.628488473849947e-13, -8.805295842135205e-13,
      -1.2198691191954616e-12, -1.4636347047163587e-12, -1.6015750896311468e-12,
      -1.6306912167108527e-12, -1.5550333107420318e-12, -1.3850628443467878e-12,
      -1.1366433209946307e-12, -8.297438424613896e-13, -4.869530574502082e-13,
      -1.3190780316107408e-13, 2.1225949826780182e-13, 5.243574483581396e-13,
      7.863716520592609e-13, 9.844327144163182e-13, 1.109469506260381e-12,
      1.1575234000117405e-12, 1.1297219477914064e-12, 1.0319321087726636e-12,
      8.741323234664287e-13, 6.695583972851905e-13, 4.3368949388025616e-13,
      1.8314706714687905e-13, -6.54188732570902e-14, -2.963849949153496e-13,
      -4.960877621884998e-13, -6.535820027559003e-13, -7.611863677247211e-13,
      -8.147927058553453e-13, -8.139325573527107e-13, -7.616097111522278e-13,
      -6.639220898592588e-13, -5.295082990328968e-13, -3.688633600470743e-13,
      -1.9357401369535802e-13, -1.552634316695858e-14, 1.538626395581403e-13,
      3.0434211287896934e-13, 4.2741301409133754e-13, 5.167710403285502e-13,
      5.685867668742822e-13, 5.816139757924221e-13, 5.571286417505581e-13,
      4.987116061821021e-13, 4.1189715739441767e-13, 3.037170172175886e-13,
      1.8217425647375801e-13, 5.568422658498507e-14, -6.748032627151494e-14,
      -1.797050752994886e-13, -2.744803282261358e-13, -3.46753173749547e-13,
      -3.931683677072686e-13, -4.121887393503713e-13, -4.040940218525992e-13,
      -3.7086476438093457e-13, -3.159648951105839e-13, -2.440421836059281e-13,
      -1.605700043823493e-13, -7.145625098038254e-14, 1.7354070993347873e-14,
      1.002570798940396e-13, 1.7232618478031898e-13, 2.2958718678974425e-13,
      2.6921821219240475e-13, 2.896658948264375e-13, 2.906749904616256e-13,
      2.7323423661495543e-13, 2.3944641935052016e-13, 1.9233497399930674e-13,
      1.356027956480615e-13, 7.336111077923624e-14, 9.847189457034831e-15,
      -5.085063322790942e-14, -1.0504362038408492e-13, -1.4965443480310864e-13,
      -1.8237877932114704e-13, -2.0178936295616535e-13, -2.0737873643471948e-13,
      -1.995415965020764e-13, -1.7950095663712036e-13, -1.4918589604646118e-13,
      -1.1107124555691088e-13, -6.799141690975526e-14, -2.2941557299893228e-14,
      2.112070067767915e-14, 6.146037976958617e-14, 9.5726182831831e-14,
      1.220785171372719e-13, 1.3927820324655214e-13, 1.4673238347736387e-13,
      1.4449704231734729e-13, 1.3323832873667716e-13, 1.1415735896962395e-13,
      8.888523610876331e-14, 5.935654289580443e-14, 2.7670479322549023e-14,
      -4.050898095077626e-15, -3.379820717615582e-14, -5.979580141779045e-14,
      -8.060148404432573e-14, -9.517972036780771e-14, -1.0294515031953847e-13,
      -1.0377525572889443e-13, -9.799305097504033e-14, -8.63225156555518e-14,
      -6.982106570813569e-14, -4.979457987891754e-14, -2.7701303666832425e-14,
      -5.051314413773869e-15, 1.6691849799448634e-14, 3.6201289259949347e-14,
      5.236331578777155e-14, 6.433638649681024e-14, 7.158962373297608e-14,
      7.391958888298057e-14, 7.144542608324338e-14, 6.458385442442267e-14,
      5.4006682458149316e-14, 4.058448009268342e-14, 2.5320722146657726e-14,
      9.281087208703028e-15, -6.477351574513035e-15, -2.097255680769714e-14,
      -3.335561136530583e-14, -4.2957233195822363e-14, -4.93204032469889e-14,
      -5.221779364481246e-14, -5.1653716258380275e-14, -4.785130655622132e-14,
      -4.1226553324336956e-14, -3.235153005622567e-14, -2.1909739624583336e-14,
      -1.0646825287617255e-14, 6.799818306175315e-16, 1.135041117762235e-14,
      2.072473328727242e-14, 2.8279883415634926e-14, 3.3636246022610587e-14,
      3.657391077247831e-14, 3.7037941417499697e-14, 3.513291907748458e-14,
      3.1107686031278694e-14, 2.5331786142264928e-14, 1.8265542499058578e-14,
      1.0426010435636992e-14, 2.351183923115725e-15, -5.435184908245948e-15,
      -1.2455959940533028e-14, -1.8308292112724615e-14, -2.2685090865318336e-14,
      -2.5389272884182406e-14, -2.6340277528248527e-14, -2.5572855374095848e-14
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_9_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<9>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 7.660134919763609e-11), "design.b()[0] == 7.660134919763609e-11");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 7.660134919763609e-11));
    static_assert(almost_equal(design.b()[1], 6.894121427787248e-10), "design.b()[1] == 6.894121427787248e-10");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 6.894121427787248e-10));
    static_assert(almost_equal(design.b()[2], 2.757648571114899e-09), "design.b()[2] == 2.757648571114899e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 2.757648571114899e-09));
    static_assert(almost_equal(design.b()[3], 6.434513332601431e-09), "design.b()[3] == 6.434513332601431e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 6.434513332601431e-09));
    static_assert(almost_equal(design.b()[4], 9.651769998902147e-09), "design.b()[4] == 9.651769998902147e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 9.651769998902147e-09));
    static_assert(almost_equal(design.b()[5], 9.651769998902147e-09), "design.b()[5] == 9.651769998902147e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 9.651769998902147e-09));
    static_assert(almost_equal(design.b()[6], 6.434513332601431e-09), "design.b()[6] == 6.434513332601431e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 6.434513332601431e-09));
    static_assert(almost_equal(design.b()[7], 2.757648571114899e-09), "design.b()[7] == 2.757648571114899e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - 2.757648571114899e-09));
    static_assert(almost_equal(design.b()[8], 6.894121427787248e-10), "design.b()[8] == 6.894121427787248e-10");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 6.894121427787248e-10));
    static_assert(almost_equal(design.b()[9], 7.660134919763609e-11), "design.b()[9] == 7.660134919763609e-11");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - 7.660134919763609e-11));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -8.574026534656303), "design.a()[1] == -8.574026534656303");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -8.574026534656303));
    static_assert(almost_equal(design.a()[2], 32.812390323435984), "design.a()[2] == 32.812390323435984");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 32.812390323435984));
    static_assert(almost_equal(design.a()[3], -73.55824266041644), "design.a()[3] == -73.55824266041644");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -73.55824266041644));
    static_assert(almost_equal(design.a()[4], 106.4485767569629), "design.a()[4] == 106.4485767569629");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 106.4485767569629));
    static_assert(almost_equal(design.a()[5], -103.11891152904236), "design.a()[5] == -103.11891152904236");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -103.11891152904236));
    static_assert(almost_equal(design.a()[6], 66.86684535547894), "design.a()[6] == 66.86684535547894");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 66.86684535547894));
    static_assert(almost_equal(design.a()[7], -27.98662407372329), "design.a()[7] == -27.98662407372329");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -27.98662407372329));
    static_assert(almost_equal(design.a()[8], 6.860411871040079), "design.a()[8] == 6.860411871040079");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 6.860411871040079));
    static_assert(almost_equal(design.a()[9], -0.7504194698596083), "design.a()[9] == -0.7504194698596083");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.7504194698596083));
    std::cout << "max_deviation(cheby1,lowpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      7.660134919763609e-11, 1.34619414338973e-09, 1.17864795081627e-08, 6.895491433413884e-08,
      3.0500003990148825e-07, 1.0937459582566178e-06, 3.3277053604888323e-06,
      8.868823862366847e-06, 2.1199044738251838e-05, 4.6267556579495284e-05,
      9.349499323579256e-05, 0.00017685594639542618, 0.000315925258734669,
      0.0005367457736132853, 0.000872359865436074, 0.001362847336834709,
      0.0020547298382859753, 0.0029996368724517913, 0.004252179015998045,
      0.005867036955710683, 0.007895345668990278, 0.01038052596167141, 0.013353784440431768,
      0.01682956162537698, 0.02080125054688975, 0.025237530016140874, 0.030079654380789717,
      0.03524001324583809, 0.040602220526687494, 0.046022914446227414, 0.0513353527136059,
      0.056354775812200664, 0.06088539306817764, 0.06472872880869895, 0.06769295760964122,
      0.06960276628856654, 0.07030921302039317, 0.0696990165091137, 0.06770270453365523,
      0.06430108329081707, 0.0595295563774928, 0.053479922243552025, 0.046299406537230026,
      0.03818683403019635, 0.029386005267273363, 0.020176506210585532, 0.010862334962365355,
      0.0017588683570073094, -0.006821196175837936, -0.01458220914664194,
      -0.021259494042340787, -0.026632078137869192, -0.03053352508984697,
      -0.03286025378651475, -0.033576853726428824, -0.03271806358385693,
      -0.03038725789075214, -0.026751476777921, -0.02203322448652928, -0.01649944272419135,
      -0.010448224239220955, -0.004193960719300449, 0.0019482904752849625,
      0.007678389698713064, 0.012725817786773314, 0.01686271481955344, 0.01991456332929692,
      0.02176795550716462, 0.022375046799241932, 0.021754483434298727, 0.019988788160438226,
      0.017218385378391488, 0.013632632548611134, 0.009458388510163854,
      0.004946781801334538, 0.00035893571615310677, -0.004048543510267866,
      -0.008037505881969713, -0.011400857920523297, -0.013973144441843652,
      -0.015638556874382467, -0.016335968135343437, -0.016060770026546572,
      -0.014863475524697023, -0.012845234212090967, -0.010150583567485369,
      -0.006957911857032331, -0.003468231266605122, 0.00010705407394976524,
      0.003558655907082877, 0.006691454997824961, 0.009335410635988174,
      0.011354718651876289, 0.012654725419084592, 0.013186247399031167,
      0.012947105755689789, 0.011980853635971664, 0.010372839750030088,
      0.008243906065828102, 0.00574215079948831, 0.003033292883642111,
      0.00029024500852942864, -0.0023174644209175014, -0.004633785735341973,
      -0.006525167654171896, -0.007887988853614664, -0.008653995150272445,
      -0.00879346504257418, -0.008315969230859463, -0.00726873756206535,
      -0.005732790601025779, -0.0038171241259113073, -0.0016513456260439999,
      0.0006227539240042431, 0.0028601566612728646, 0.004921547038896818,
      0.006681672587002668, 0.008036642384535712, 0.008909745523661153,
      0.009255471638039303, 0.009061532427605254, 0.00834880955191386,
      0.0071692823615565615, 0.005602110839043474, 0.003748157519070504,
      0.001723320727553726, -0.00034888475699048835, -0.0023450279066974397,
      -0.004149264895574389, -0.005660191679092, -0.006796642376720195,
      -0.007502104488300673, -0.007747514791532878, -0.007532304918157928,
      -0.006883676339631065, -0.0058541938627883275, -0.004517888033200253,
      -0.0029651440059814266, -0.0012967224153217355, 0.0003826972025533365,
      0.001971040057889866, 0.0033750224802352735, 0.004515627575163543,
      0.005332550020437948, 0.005787361720231844, 0.005865235577487943,
      0.005575158235712398, 0.004948658279732419, 0.004037168074676405,
      0.0029082195482112785, 0.0016407418888306179, 0.00031977845925199727,
      -0.0009690314440208327, -0.002144854299515185, -0.0031366119392302987,
      -0.0038871801087265595, -0.004356591682900562, -0.004524068796592298,
      -0.0043887861362516475, -0.003969349920224567, -0.0033020584069061165,
      -0.0024380850252410484, -0.0014397898263198948, -0.0003764150836581201,
      0.0006805463075787292, 0.0016620071459771315, 0.0025056700665896155,
      0.0031598668730524852, 0.003586621377589482, 0.003763758775788866,
      0.003685949284128215, 0.0033646441519506257, 0.0028269336483705276,
      0.002113424667487599, 0.001275295954663084, 0.0003707379691409232,
      -0.0005389808054250553, -0.0013935606213079516, -0.002137568123625996,
      -0.0027239377703966797, -0.00311686035880146, -0.0032938856624232134,
      -0.0032471199895524536, -0.0029834597972419018, -0.0025238653732680034,
      -0.0019017399780863198, -0.0011605358449152947, -0.0003507556082705601,
      0.0004734467627638566, 0.001257839647716091, 0.0019516292244914739,
      0.002510691860770211, 0.0029003208516216947, 0.0030973196629191513,
      0.00309131867663949, 0.0028852443125237416, 0.002494924889357389,
      0.0019478730897789613, 0.0012813368708084576, 0.0005397558713259119,
      -0.00022820395118261678, -0.0009728406734166701, -0.0016466238786964817,
      -0.002207213731823055, -0.0026201015520310907, -0.002860709048595391,
      -0.002915820572073905, -0.0027842673089379724, -0.002476831349553711,
      -0.0020153877995098546, -0.0014313513679977997, -0.0007635371198985493,
      -5.5580654990140636e-05, 0.0006469112554584758, 0.0012992940632492378,
      0.0018607148973328776, 0.002296659627369642, 0.0025810597917823273,
      0.002697832039541423, 0.00264176073440368, 0.002418677443179338, 0.002044936363724402,
      0.001546229434057779, 0.0009558260798031622, 0.00031235774688228614,
      -0.0003427056034118097, -0.0009677225718159091, -0.0015235199007271518,
      -0.001975837813383275, -0.002297429184327019, -0.0024696848122276807,
      -0.0024836889726284617, -0.002340646903564815, -0.0020516664650120538,
      -0.0016369172998570193, -0.0011242298056132853, -0.0005472306727449562,
      5.6860447548628956e-05, 0.0006496290681286265, 0.0011939045847375995,
      0.001656085156454096, 0.0020082038288957403, 0.002229609489951174,
      0.0023081624439435927, 0.0022408765018431115, 0.002033975395573734,
      0.0017023687106902767, 0.0012685890145064174, 0.0007612651514576785,
      0.00021323473641359815, -0.0003405799856146599, -0.0008653957511851737,
      -0.0013287500401553765, -0.0017025044646431769, -0.001964546576236877,
      -0.0021000877398436174, -0.00210248169251271, -0.001973519695171351,
      -0.0017231917582587047, -0.0013689371312837935, -0.0009344389695618016,
      -0.0004480458657322769, 5.907492427227644e-05, 0.000554932523711878,
      0.0010087282816286921, 0.0013927656550159814, 0.00168413600377189,
      0.0018660781012431286, 0.001928931251885417, 0.0018706286733753894,
      0.001696707487456501, 0.0014198423607619543, 0.001058939600135294,
      0.0006378554829606104, 0.00018382514320310767, -0.00027429490495379984,
      -0.0007078575002896778, -0.001090212952584691, -0.0013983432202013327,
      -0.0016142422772382828, -0.0017259603328671907, -0.0017282519759431857,
      -0.001622794120466474, -0.001417967147539785, -0.001128220122390361,
      -0.0007730666872766724, -0.0003757806080387791, 3.8122364883759734e-05,
      0.0004425177026757699, 0.0008123161768173568, 0.001125015663965924,
      0.001362065028770884, 0.0015099578062661954, 0.0015609917110985944,
      0.0015136520117690656, 0.0013726010819297696, 0.0011482814173113393,
      0.000856163507761222, 0.0005156916821987623, 0.00014899907701517844,
      -0.00022052385340180498, -0.0005697151138427065, -0.00087708722145108,
      -0.0011241436075407705, -0.0012964850947210262, -0.0013846407000555599,
      -0.0013845754156732917, -0.0012978486757019604, -0.0011314195666626784,
      -0.0008971170537140742, -0.0006108141860005113, -0.00029136313871182436,
      4.063802775933906e-05, 0.0003641666738284909, 0.000659100588243978,
      0.0009074635505780934, 0.0010945147143832084, 0.0012096161930233718,
      0.0012468282726343753, 0.001205199634154155, 0.0010887396621066456,
      0.0009060800860095225, 0.0006698525670725645, 0.00039582620649860397,
      0.00010186325672853448, -0.00019323828201565538, -0.00047094058638708623,
      -0.0007141247349247972, -0.0009081401576119252, -0.0010416808407311788,
      -0.0011074363001941402, -0.0011024803758529853, -0.0010283779986840769,
      -0.0008910081330593643, -0.0007001189478176226, -0.0004686478049688884,
      -0.00021185285793244146, 5.3685929549351485e-05, 0.0003111313344366367,
      0.0005444509949678561, 0.0007394104319755684, 0.00088443579815063,
      0.0009712944259127982, 0.0009955535901926722, 0.0009567925212636656,
      0.0008585586372310793, 0.0007080751921567452, 0.000515723029613291,
      0.00029433293191167414, 5.833632444129759e-05, -0.00017716983192786115,
      -0.0003973837018130771, -0.0005887239685722582, -0.0007396624081064916,
      -0.0008414129211962891, -0.0008884362018906685, -0.0008787315137784892,
      -0.0008139009211294273, -0.0006989858786153056, -0.0005420903949563006,
      -0.0003538181570615206, -0.0001465622237981157, 6.630549945122952e-05,
      0.000271292308413086, 0.0004556354942167355, 0.0006080925097860755,
      0.0007196218662188416, 0.000783913826220878, 0.0007977401117326543,
      0.0007611037537700273, 0.0006771831051041923, 0.0005520770832819358,
      0.0003943710896895554, 0.0002145539931007654, 2.43254100283038e-05,
      -0.00016416126083775817, -0.0003390713332594409, -0.0004896280002404407,
      -0.0006067722508276297, -0.000683703387110695, -0.0007162681899147965,
      -0.0007031768488707305, -0.0006460350435481942, -0.0005491933077680028,
      -0.0004194262823336509, -0.00026546494540291045, -9.741376217564744e-05,
      7.390861229890973e-05, 0.00023766229551087632, 0.0003836686371200444,
      0.0005030394232067863, 0.0005887141525904149, 0.0006358731553622442,
      0.0006422026835944082, 0.0006079978226396559, 0.0005360995141497219,
      0.0004316724798055652, 0.00030184072661131956, 0.00015520598867917006,
      1.2813919612266085e-06, -0.000150122588868385, -0.00028952044239426806,
      -0.000408342913432295, -0.0004994606087036333, -0.0005576081281886934,
      -0.0005796837326088175, -0.0005649078110430642, -0.0005148325784884748,
      -0.00043320491925257203, -0.0003256934963945992, -0.00019949959593479295,
      -6.287815674028345e-05, 7.539936301286844e-05, 0.00020660551084730142,
      0.00032260510334601784, 0.0004163569508474872, 0.0004823382749237822,
      0.000516866434081515, 0.0005182994622012094, 0.00048710485960281897,
      0.0004257945414997263, 0.00033873230166545825, 0.00023182805900517564,
      0.00011214003319576444, -1.2588572422943907e-05, -0.00013442813401246182,
      -0.0002457644655389827, -0.0003397723552176859, -0.00041083147959809904,
      -0.0004548595145818209, -0.0004695428961097809, -0.0004544524504517264,
      -0.0004110385702239981, -0.00034250827692004424, -0.0002535938983698979,
      -0.00015022974031038156, -3.9158639438059e-05, 7.250567605499177e-05,
      0.00017773215243673858, 0.0002700131137861146, 0.00034376460963115533,
      0.0003946619165026877, 0.00041989019479788314, 0.00041829597549118214,
      0.00039043162903369243, 0.00033849183032179765, 0.00026614784097427806,
      0.0001782917562464575, 8.070831913912536e-05, -2.030383960479427e-05,
      -0.00011833686716246458, -0.0002072783802663827, -0.00028169073949412915,
      -0.0003371414915145942, -0.0003704650309509683, -0.00037994019532874065,
      -0.0003653740504944011, -0.00032808818642968965, -0.0002708100346142544,
      -0.00019747764659179589, -0.00011297167090774094, -2.279260975772315e-05,
      6.729542943840846e-05, 0.00015163152525286784, 0.00022501204004225588,
      0.0002830099795690531, 0.0003222401268345989, 0.00034055420139759334,
      0.0003371549610316094, 0.00031262344583455996, 0.0002688591232425327,
      0.0002089381717351453, 0.00013690019823463565, 5.74780085352139e-05,
      -2.421161786707066e-05, -0.00010299605008138313, -0.00017397287953668545,
      -0.00023281348315704162, -0.0002760253759026875, -0.0003011575600775458,
      -0.00030693692974484606, -0.0002933283249018782, -0.00026151575495872307,
      -0.00021380730836662119, -0.00015347101958343998, -8.451318120301855e-05,
      -1.1414012069695784e-05, 6.116198016120129e-05, 0.00012866230698998344,
      0.00018693073936100176, 0.0002324618185156654, 0.0002626101440469284,
      0.000275742051297784, 0.00027132112174886765, 0.0002499232743705137,
      0.0002131816844773548, 0.00016366618334215182, 0.00010470583125214076,
      4.0166781141418484e-05, -2.579984541552986e-05, -8.902371302350179e-05,
      -0.00014557772216306343, -0.0001920207131235771, -0.00022560550386085585,
      -0.000244439773857645, -0.0002475904821317935, -0.00023512621500601646,
      -0.00020809585605043339, -0.00016844600058355972, -0.0001188833463821998,
      -6.269164510406362e-05, -3.515492360201271e-06, 5.4874889722070965e-05,
      0.00010882276926517826, 0.00015501282411648875, 0.00019067372774143497,
      0.00021374309785712363, 0.0002229850790125929, 0.0002180539730084097,
      0.00019950083434202323, 0.00016872358542201074, 0.00012786474717499342,
      7.966410393480208e-05, 2.7276329934628244e-05, -2.593436318685578e-05,
      -7.660925895197537e-05, -0.00012160616730399619, -0.0001581932572320647,
      -0.00018421379884798008, -0.00019821195376493812, -0.00019951236875812928,
      -0.00018824935478318951, -0.00016534467422033104, -0.00013243620634763547,
      -9.176281029920946e-05, -4.6013367815072584e-05, 1.8498959004832507e-06,
      4.878226964578355e-05, 9.184935340972962e-05, 0.00012840964279169835,
      0.00015627559674284068, 0.00017384342945840126, 0.0001801839992149265,
      0.00017508974213408315, 0.00015907544785091223, 0.00013333361312020849,
      9.9647952223238e-05, 6.0271212566118766e-05, 1.777558320851971e-05,
      -2.5114433946804424e-05, -6.569588591209032e-05, -0.00010145691935154854,
      -0.000130231435081634, -0.00015032937749428024, -0.0001606348827038282,
      -0.00016066666192547847, -0.00015059746622009024, -0.0001312321046510565,
      -0.00010394610236335168, -7.058952395245914e-05, -3.336260041079161e-05,
      5.3285423649109855e-06, 4.302664568155144e-05, 7.737866338819211e-05,
      0.00010628191480998759, 0.00012801201369062193, 0.00014132484072230467,
      0.0001455265904201134, 0.0001405080315596257, 0.00012674143572774716,
      0.0001052410016685061, 7.748988387021555e-05, 4.5338980428358744e-05,
      1.0884322951800894e-05, -2.3668859841482036e-05, -5.614663262382732e-05,
      -8.454248863990648e-05, -0.00010714064538388125, -0.00012261896794166,
      -0.0001301253959095194, -0.00012932351959201328, -0.00012040496463028316,
      -0.00010406837060029928, -8.14668528542296e-05, -5.4127786090506984e-05,
      -2.3850422917513574e-05, 7.411839599673478e-06, 3.7676883084411826e-05,
      6.505896515390775e-05, 8.788563204959279e-05, 0.00010479923584073489,
      0.0001148369358284539, 0.00011748452038868565, 0.00011270111054283117,
      0.00010091368702641102, 8.298229768055664e-05, 6.013863064030327e-05,
      3.390226754661349e-05, 5.980260869981318e-06, -2.1843368121499464e-05,
      -4.782109265080776e-05, -7.03511216592717e-05, -8.807562312785949e-05,
      -9.996194176399261e-05, -0.00010536199413437649, -0.0001040464780603,
      -9.621217355777745e-05, -8.246233349933161e-05, -6.376185394557654e-05,
      -4.137047088359914e-05, -1.6758556340276437e-05, 8.488896945165321e-06,
      3.2773865521923615e-05, 5.458597863212505e-05, 7.259598085100643e-05,
      8.573622100228331e-05, 9.326332772572677e-05, 9.479943414164853e-05,
      9.034972438100666e-05, 8.029560113137328e-05, 6.536431785956109e-05,
      4.65773846067784e-05, 2.5181351445705588e-05, 2.565620306499986e-06,
      -1.9827327652918166e-05, -4.059351666754261e-05, -5.8455084657344294e-05,
      -7.233847517176535e-05, -8.143845734151099e-05, -8.526418990697756e-05,
      -8.366473847929931e-05, -7.68327908843517e-05, -6.528670735058946e-05,
      -4.983240197033471e-05, -3.150779436264723e-05, -1.1513619674449825e-05,
      8.8648217002962e-06, 2.8339901545278414e-05, 4.5702650772066556e-05,
      5.989742585606027e-05, 7.008566818000786e-05, 7.569493329303342e-05,
      7.645035804212962e-05, 7.23868856866188e-05, 6.384180729542433e-05,
      5.142842265163088e-05, 3.5992797171904975e-05, 1.8556620448197244e-05,
      2.49994690405662e-07, -1.7761450619486744e-05, -3.4350439542825214e-05,
      -4.849826453513328e-05, -5.9356983537845235e-05, -6.629982547223681e-05,
      -6.895683567807167e-05, -6.723377115253743e-05, -6.131334225078296e-05,
      -5.16390226428311e-05, -3.8882741400267905e-05, -2.389876201789145e-05,
      -7.666882383678959e-06, 8.77129218601288e-06, 2.437887900127894e-05,
      3.818882113029194e-05, 4.9363495148663575e-05, 5.724516962058118e-05,
      6.139429765780052e-05, 6.161344295185637e-05, 5.79555792030842e-05,
      5.0716506636616144e-05, 4.041213212462253e-05, 2.774229829898754e-05,
      1.3543664004321391e-05, -1.2652157799935323e-06, -1.5743025516992265e-05,
      -2.8985251047255746e-05, -4.018041630149101e-05, -4.865951597483149e-05,
      -5.393565217320451e-05, -5.573154968913064e-05, -5.399342606913322e-05,
      -4.889057632039321e-05, -4.080094102179094e-05, -3.0283803186618812e-05,
      -1.8041548914262133e-05, -4.8730814984657915e-06, 8.378040628421803e-06,
      2.0877392208034113e-05, 3.185198162927814e-05, 4.063780099339818e-05,
      4.671971725510451e-05, 4.976132680557875e-05, 4.9623067195518405e-05,
      4.636764689066572e-05, 4.025266715069803e-05, 3.1711117422069865e-05,
      2.132117638603201e-05, 9.767398769599443e-06, -2.2041257784181115e-06,
      -1.3833720435432161e-05, -2.4396108595225167e-05, -3.324542352624543e-05,
      -3.985446137506112e-05, -4.384580768798787e-05, -4.501301874843401e-05,
      -4.333069512165615e-05, -3.895300283414437e-05, -3.2200931400545635e-05,
      -2.353928105022215e-05, -1.354500031631122e-05, -2.8690113652663288e-06,
      7.80596647457443e-06, 1.7808875602838597e-05, 2.65223076506493e-05,
      3.3420405072272236e-05, 3.810036357332981e-05, 4.0305663701489575e-05,
      3.993971166341571e-05, 3.706919477393649e-05, 3.191711532759319e-05,
      2.4846116158656504e-05, 1.6333311045647132e-05, 6.93834655093005e-06,
      -2.7331819430630216e-06, -1.2068581245029816e-05, -2.0486697551298522e-05,
      -2.7473914552195286e-05, -3.2615294279024975e-05, -3.561898555444205e-05,
      -3.633247999318401e-05, -3.474983212427594e-05, -3.100954325003624e-05,
      -2.5383400680105384e-05, -1.82571276104845e-05, -1.0104199208051107e-05,
      -1.4545870357194631e-06, 7.139517154752872e-06, 1.5138792188185306e-05,
      2.2050472986266358e-05, 2.7458537090372265e-05, 3.104855396704641e-05,
      3.262572562661299e-05, 3.212510010858492e-05, 2.9613448738810436e-05,
      2.5282830765600253e-05, 1.943639115057247e-05, 1.2467416277677694e-05,
      4.833078773012621e-06, -2.9753878187681454e-06, -1.0464148892558229e-05,
      -1.7167857695193155e-05, -2.2678425201316013e-05, -2.6669701742361565e-05,
      -2.8916588240627194e-05, -2.930747026068072e-05, -2.784930665167024e-05,
      -2.46651776727672e-05, -1.998457484048133e-05, -1.4127166230889766e-05,
      -7.481168668077313e-06, -4.777780450339336e-07, 6.436667827047896e-06,
      1.2829005346734376e-05, 1.8306252006280844e-05, 2.25396284945958e-05,
      2.5284136584407938e-05, 2.6392537546575205e-05, 2.5822947469609955e-05,
      2.363968044628132e-05, 2.0007401329289164e-05, 1.517906930167197e-05,
      9.478535670541933e-06, 3.2789806854182263e-06, -3.0213843670114215e-06,
      -9.024775852060125e-06, -1.4358837086914745e-05, -1.8699614481542477e-05,
      -2.1791100502235693e-05, -2.3460173219086314e-05, -2.3626071471621245e-05,
      -2.2303902830096294e-05, -1.960206519874001e-05, -1.571384754869685e-05,
      -1.0903836685642577e-05, -5.490072824183143e-06, 1.7685202487754433e-07,
      5.7363869432519224e-06, 1.0840857241662744e-05, 1.5177102203645199e-05,
      1.848557552704529e-05, 2.057575082326329e-05, 2.1336926482228203e-05,
      2.0743828814950605e-05, 1.8856749601914893e-05, 1.58163022514885e-05,
      1.1833217641761838e-05, 7.173905394976108e-06, 2.142760209497438e-06,
      -2.9376191466772624e-06, -7.747019192427875e-06, -1.1987701362614503e-05,
      -1.5402737469519086e-05, -1.7791468142394878e-05, -1.902116132945512e-05,
      -1.903420250745584e-05, -1.7850440496279643e-05, -1.556462370693609e-05,
      -1.2339171397244127e-05, -8.392813618193025e-06, -3.985884181431952e-06,
      5.967519389860784e-07, 5.0640233191669524e-06, 9.13705566242596e-06,
      1.2566495964547007e-05, 1.514768652488697e-05, 1.6732771419789472e-05,
      1.723902647940637e-05, 1.6652953261438917e-05, 1.5029951616756757e-05,
      1.248966654227314e-05, 9.20737532564358e-06, 5.402023694717182e-06,
      1.321720003292064e-06, -2.772357459248743e-06, -6.622601413373148e-06,
      -9.991109347112738e-06, -1.2674304457424394e-05, -1.451515033308213e-05,
      -1.5412232383669457e-05, -1.532518834070686e-05, -1.4276208465888402e-05,
      -1.2347577924145018e-05, -9.675483055454487e-06, -6.440534381556203e-06,
      -2.855657892561154e-06, 8.478394676042901e-07, 4.435123110432228e-06,
      7.682653548714796e-06, 1.0392047270118854e-05, 1.2402120718452129e-05,
      1.3598391106182841e-05, 1.3919479995417626e-05, 1.336006970362748e-05,
      1.1970285241035363e-05, 9.851601357054943e-06, 7.149591029658532e-06,
      4.044024919530988e-06, 7.369891860071746e-07, -2.5601977007894146e-06,
      -5.640426277823187e-06, -8.313744468247235e-06, -1.0419007399358927e-05,
      -1.183351835665196e-05, -1.2480088924518793e-05, -1.2331118322569666e-05,
      -1.1409486129043458e-05, -9.786256404617459e-06, -7.57539171412081e-06,
      -4.925860143535415e-06, -2.01167579025056e-06, 9.794660654618842e-07,
      3.85822078740386e-06, 6.445525500401417e-06, 8.58368116174569e-06,
      1.0145903339352829e-05, 1.1043767303220835e-05, 1.1232115167963575e-05,
      1.0711159714922724e-05, 9.525700260443315e-06, 7.761548925059306e-06,
      5.539439354848268e-06, 3.006843589543182e-06, 3.282470440533229e-07,
      -2.3254808425236376e-06, -4.787936716479702e-06, -6.907568338376429e-06,
      -8.556949580145219e-06, -9.640381177590884e-06, -1.0099367861241318e-05,
      -9.915663623375113e-06, -9.11173499390229e-06, -7.748657064270527e-06,
      -5.92161813773761e-06, -3.7533562295423068e-06, -1.3859751632396084e-06,
      1.028317730635221e-06, 3.3369517218615876e-06, 5.396590167805014e-06,
      7.081984460257687e-06, 8.293540462342493e-06, 8.963143645878912e-06,
      9.05790631488644e-06, 8.581636646763524e-06, 7.573975902113735e-06,
      6.107297655479692e-06, 4.281601994782672e-06, 2.2177597256479002e-06,
      4.955931188988923e-08, -2.0849231419408344e-06, -4.052076842260246e-06,
      -5.731079852261911e-06, -7.021277269346269e-06, -7.848166267174369e-06,
      -8.167635421082306e-06, -7.968221469221531e-06, -7.2712753186884665e-06,
      -6.12906237855498e-06, -4.62095173355051e-06, -2.847966191729937e-06,
      -9.260636613204043e-07, 1.0214062267531762e-06, 2.8715820275026453e-06,
      4.509805836537961e-06, 5.836691862720045e-06, 6.774114842646155e-06,
      7.269760186851917e-06, 7.2999742475209e-06, 6.870764404102536e-06,
      6.016917527757525e-06, 4.79932420719924e-06, 3.3007074283203223e-06,
      1.6200513281374002e-06, -1.338976589887012e-07, -1.8496329560753838e-06,
      -3.419944560687633e-06, -4.748585779206177e-06, -5.756137500973163e-06,
      -6.384714988704851e-06, -6.601240957600776e-06, -6.399103537991431e-06,
      -5.798122331911285e-06, -4.842853439668937e-06, -3.5993682281237373e-06,
      -2.150734270645227e-06, -5.915045957416875e-07, 9.784214769503009e-07,
      2.460169301053845e-06, 3.7620872215730687e-06, 4.8053855242318e-06,
      5.528871027740811e-06, 5.892495043535526e-06, 5.879511820150568e-06,
      5.497135387463845e-06, 4.775679017800572e-06, 3.7662571788576752e-06,
      2.5372188650177633e-06, 1.1695580760892999e-06, -2.483926613072421e-07,
      -1.6266399597465901e-06, -2.8792151938206884e-06, -3.929510519585932e-06,
      -4.714935782423138e-06, -5.190615094963451e-06, -5.33190701495634e-06,
      -5.135609877621011e-06, -4.61979884632697e-06, -3.82232816985703e-06,
      -2.7981154770052123e-06, -1.615399521400335e-06, -3.5122407146104415e-07,
      9.135550042530899e-07, 2.099417478162217e-06, 3.133155089797628e-06,
      3.952366533655019e-06, 4.509196709676048e-06, 4.773098007991632e-06,
      4.732456654328678e-06, 4.395001156796556e-06, 3.7869878669342174e-06,
      2.951235628979469e-06, 1.944152620358812e-06, 8.319594109584031e-07,
      -3.1364066782644844e-07, -1.42006227410975e-06, -2.418416095900663e-06,
      -3.247776769474532e-06, -3.858877642647209e-06, -4.217009849529399e-06,
      -4.30395696448439e-06, -4.118859997486897e-06, -3.6779765246498515e-06,
      -3.013367882635494e-06, -2.1706151662393573e-06, -1.2057241110780846e-06,
      -1.8142721433201437e-07, 8.368742005669395e-07, 1.7852667576986693e-06,
      2.6053176474013255e-06, 3.2476548838453416e-06, 3.6749171347929718e-06,
      3.863898393099158e-06, 3.8067663438878812e-06, 3.5112935712334993e-06,
      3.00010383956808e-06, 2.3089975641091024e-06, 1.4844773819418938e-06,
      5.806429667782143e-07, -3.4433899068680524e-07, -1.2319605060220143e-06,
      -2.02705618675558e-06, -2.68121440483573e-06, -3.1557059463481884e-06,
      -3.4237542268963895e-06, -3.4720155417369715e-06, -3.301189715159775e-06,
      -2.925737533658854e-06, -2.372737900403961e-06, -1.679971170151719e-06,
      -8.933623009068536e-07, -6.395543335719565e-08, 7.553819495757874e-07,
      1.5133134970873872e-06, 2.163235224590368e-06, 2.6661248661540795e-06,
      2.992866199345589e-06, 3.125911143662802e-06, 3.060186395167382e-06,
      2.8032004358652964e-06, 2.37435777481414e-06, 1.8035369986007678e-06,
      1.1290345281013513e-06, 3.950141220972417e-07, -3.513691396167197e-07,
      -1.0629840636834562e-06
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      7.660134919763609e-11, 1.34619414338973e-09, 1.1786479508162704e-08, 6.895491433413887e-08,
      3.0500003990148846e-07, 1.0937459582566189e-06, 3.3277053604888374e-06,
      8.868823862366873e-06, 2.119904473825196e-05, 4.626755657949576e-05,
      9.349499323579408e-05, 0.0001768559463954304, 0.0003159252587346802,
      0.0005367457736133165, 0.0008723598654361639, 0.0013628473368349626,
      0.002054729838286646, 0.002999636872453434, 0.004252179016001787,
      0.005867036955718654, 0.007895345669006243, 0.010380525961701607,
      0.013353784440485914, 0.016829561625469402, 0.020801250547040646,
      0.025237530016377976, 0.03007965438115098, 0.03524001324637676, 0.04060222052748148,
      0.04602291444739533, 0.05133535271533206, 0.05635477581477071, 0.06088539307202564,
      0.06472872881446574, 0.06769295761824284, 0.06960276630127123, 0.07030921303890485,
      0.0696990165356593, 0.06770270457107336, 0.06430108334264677, 0.059529556448063375,
      0.053479922338075914, 0.04629940666190255, 0.038186834192306354, 0.029386005475327426,
      0.020176506474444994, 0.010862335293390528, 0.0017588687681972578,
      -0.006821195669728084, -0.01458220852903006, -0.021259493294821484,
      -0.02663207724032244, -0.030533524020680984, -0.032860252523068526,
      -0.03357685224555239, -0.03271806186267665, -0.030387255907614864,
      -0.026751474513495205, -0.022033221925025742, -0.016499439854651046,
      -0.010448221056806114, -0.0041939572265160515, 0.0019482942675167726,
      0.007678393770203433, 0.012725822107515238, 0.016862719349532335, 0.01991456801871317,
      0.02176796029710018, 0.022375051622781916, 0.021754488218095776, 0.019988792826683796,
      0.017218389847135317, 0.013632636740349348, 0.009458392348598665,
      0.0049467852161948845, 0.0003589386459566905, -0.004048541115634082,
      -0.008037504058971152, -0.011400856690113929, -0.01397314380811536,
      -0.01563855682380749, -0.016335968636666674, -0.01606077103135809,
      -0.014863476968686397, -0.01284523601695509, -0.010150585643431576,
      -0.006957914105790558, -0.0034682335848377527, 0.00010705179097249177,
      0.0035586537616892136, 0.0066914530861858544, 0.00933540904455725,
      0.011354717454178091, 0.012654724672990999, 0.013186247144646616,
      0.012947106013940909, 0.011980854407967043, 0.010372841017222204, 0.00824390779097372,
      0.005742152928367765, 0.0030332953474635567, 0.000290247726913081,
      -0.0023174615365065153, -0.00463378277786381, -0.0065251647171499895,
      -0.007887986027311548, -0.008653992518070697, -0.008793462677719154,
      -0.008315967193702537, -0.007268735897922104, -0.005732789338733996,
      -0.0038171232771405236, -0.0016513451853730973, 0.0006227539782604581,
      0.002860156365541408, 0.004921546442213213, 0.006681671748378064,
      0.008036641369957171, 0.008909744402872458, 0.009255470481257041,
      0.009061531302324816, 0.008348808519952334, 0.007169281476464707,
      0.005602110143997781, 0.003748157045330131, 0.0017233204935371853,
      -0.0003488847459859838, -0.0023450276581433917, -0.004149264428765716,
      -0.005660191023677763, -0.006796641570803029, -0.007502103576216149,
      -0.007747513821432232, -0.007532303939523004, -0.006883675400848868,
      -0.005854193008904559, -0.0045178873039571875, -0.0029651434342264104,
      -0.00129672202584956, 0.00038269739368657166, 0.0019710400435704717,
      0.0033750222620286584, 0.004515627162623723, 0.005332549430051034,
      0.005787360974071709, 0.005865234701674311, 0.005575157258768076,
      0.004948657230937182, 0.004037166982510199, 0.002908218438969404,
      0.0016407407854791103, 0.0003197773805736713, -0.000969032483959103,
      -0.0021448552915640812, -0.0031366128790389744, -0.0038871809963319215,
      -0.004356592522069969, -0.004524069593977277, -0.0043887869004186645,
      -0.003969350660632971, -0.0033020591329030774, -0.002438085745138814,
      -0.0014397905466123529, -0.00037641580842227536, 0.0006805455770644842,
      0.0016620064113812298, 0.0025056693324408976, 0.003159866146433137,
      0.0035866206676350375, 0.003763758093034538, 0.0036859486397496193,
      0.0033646435569524976, 0.002826933112779046, 0.002113424199600446,
      0.0012752955604065446, 0.0003707376515755456, -0.0005389810464188753,
      -0.0013935607891449385, -0.0021375682249247505, -0.0027239378146883403,
      -0.003116860358056657, -0.0032938856304266565, -0.003247119941163511,
      -0.002983459747586162, -0.0025238653369086136, -0.0019017399682247557,
      -0.0011605358726691384, -0.00035075568207101936, 0.00047344663761923934,
      0.0012578394693294162, 0.0019516289944338382, 0.0025106915839507855,
      0.0029003205359647193, 0.0030973193188683656, 0.0030913183165196443,
      0.0028852439497971433, 0.0024949245378194053, 0.0019478727627396486,
      0.0012813365803078978, 0.0005397556274284154, -0.0002282041409753151,
      -0.0009728408046003643, -0.0016466239500238149, -0.002207213745373756,
      -0.0026201015130906855, -0.002860708965350969, -0.002915820455145989,
      -0.002784267170776776, -0.002476831203735598, -0.002015387659975184,
      -0.0014313512482742575, -0.0007635370323543427, -5.558061015909045e-05,
      0.0006469112494427049, 0.001299294001079449, 0.001860714776793463,
      0.0022966594494284766, 0.002581059560507602, 0.0026978317618516607,
      0.0026417604196685342, 0.002418677102696843, 0.002044936010106686,
      0.0015462290805615146, 0.0009558257396430718, 0.0003123574325657488,
      -0.00034270588069346955, -0.0009677228027082835, -0.0015235200781206159,
      -0.001975837932689944, -0.002297429243616847, -0.002469684812221982,
      -0.0024836889165571513, -0.00234064679690099, -0.0020516663151038577,
      -0.0016369171154816155, -0.001124229596481038, -0.0005472304489833855,
      5.686067590185171e-05, 0.0006496292915964025, 0.0011939047948141374,
      0.0016560853459367387, 0.002008203992124632, 0.0022296096229496953,
      0.0023081625444587393, 0.0022408765692909435, 0.0020339754309003527,
      0.0017023687161631688, 0.0012685889934542407, 0.0007612651079784888,
      0.00021323467507208983, -0.0003405800600811289, -0.0008653958341340433,
      -0.0013287501272652121, -0.0017025045520881444, -0.001964546660803053,
      -0.0021000878189854017, -0.002102481764352036, -0.0019735197584463907,
      -0.0017231918122320492, -0.0013689371756224595, -0.0009344390042027225,
      -0.00044804589074710693, 5.907490880009937e-05, 0.0005549325177867137,
      0.0010087282854104528, 0.0013927656688507643, 0.0016841360281836697,
      0.0018660781368881995, 0.0019289312994745602, 0.001870628733571541,
      0.0016967075607578284, 0.0014198424473815933, 0.0010589396998894735,
      0.0006378555951764785, 0.00018382526665630764, -0.0002742947720637461,
      -0.0007078573603207302, -0.0010902128083880125, -0.0013983430750123221,
      -0.0016142421345272495, -0.0017259601961571987, -0.0017282518486053842,
      -0.0016227940055054315, -0.001417967047382793, -0.0011282200386952754,
      -0.0007730666207725403, -0.000375780558412225, 3.812239904561263e-05,
      0.0004425177238780907, 0.0008123161885820372, 0.0011250156706877055,
      0.0013620650355095753, 0.001509957818483649, 0.0015609917343530468,
      0.0015136520513827666, 0.0013726011426483209, 0.0011482815029746308,
      0.0008561636210061419, 0.0005156918242129256, 0.00014899924735877035,
      -0.0002205236568922444, -0.0005697148950589424, -0.0008770869859216153,
      -0.0011241433622437799, -0.001296484847808065, -0.0013846404604976798,
      -0.0013845751928460528, -0.0012978484789298752, -0.0011314194047466178,
      -0.0008971169344668803, -0.0006108141158163579, -0.00029136312219372047,
      4.063798809206153e-05, 0.0003641665777347099, 0.0006591004378442971,
      0.0009074633503201085, 0.0010945144708876292, 0.001209615914816616,
      0.0012468279697795742, 0.0012051993177982845, 0.0010887393439663758,
      0.0009060797778220534, 0.0006698522800399655, 0.00039582595075485347,
      0.00010186304085751024, -0.00019323845138553836, -0.0004709407048898949,
      -0.0007141248006493092, -0.0009081401711688123, -0.0010416808051916828,
      -0.0011074362209037784, -0.0011024802601306387, -0.0010283778554230484,
      -0.000891007972252305, -0.0007001187800312922, -0.00046864764079729705,
      -0.0002118527074578707, 5.368605725864975e-05, 0.0003111314317655666,
      0.0005444510561076992, 0.0007394104531735843, 0.0008844357778442906,
      0.0009712943647434833, 0.0009955534909004491, 0.0009567923884714088,
      0.0008585584771322715, 0.0007080750121264919, 0.0005157228377660898,
      0.00029433273663209214, 5.83361339147872e-05, -0.00017717001015729665,
      -0.0003973838612337164, -0.0005887241040228052, -0.0007396625160049895,
      -0.0008414129996688155, -0.0008884362507949449, -0.0008787315346238458,
      -0.0008139009169007029, -0.0006989858535138547, -0.0005420903540760192,
      -0.0003538181060213942, -0.0001465621683550533, 6.630555378472586e-05,
      0.0002712923567225748, 0.00045563553248913094, 0.0006080925351443655,
      0.0007196218770745607, 0.0007839138223360213, 0.0007977400941885448,
      0.0007611037248465839, 0.0006771830680787283, 0.0005520770421616774,
      0.0003943710488961921, 0.00021455395712827445, 2.4325383096860345e-05,
      -0.00016416127510885688, -0.0003390713321382454, -0.0004896279821093186,
      -0.000606772215335722, -0.000683703335241668, -0.0007162681239651543,
      -0.000703176772339694, -0.0006460349609458155, -0.0005491932243534127,
      -0.0004194262037998205, -0.0002654648775277539, -9.741371046149635e-05,
      7.390864297461837e-05, 0.00023766230121149482, 0.00038366861511203595,
      0.0005030393721516446, 0.0005887140726537413, 0.0006358730482327092,
      0.0006422025524109528, 0.0006079976718310185, 0.0005360993491958411,
      0.00043167230693527865, 0.00030184055245474476, 0.00015520581989597783,
      1.2812348675109505e-06, -0.0001501227286518551, -0.00028952056025097103,
      -0.0004083430059972839, -0.0004994606740343389, -0.0005576081658490387,
      -0.0005796837436618695, -0.0005649077979531245, -0.0005148325449391223,
      -0.0004332048698923677, -0.0003256934365266094, -0.00019949953116951344,
      -6.287809263374423e-05, 7.539942131319789e-05, 0.000206605558926761,
      0.00032260513779705974, 0.00041635696947712374, 0.0004823382768815067,
      0.0005168664199000361, 0.0005182994337478172, 0.0004871048199447956,
      0.0004257944946925798, 0.00033873225247756924, 0.00023182801259639968,
      0.00011213999477039393, -1.2588597966870303e-05, -0.00013442814241530638,
      -0.00024576445347210024, -0.0003397723205179437, -0.00041083142142946095,
      -0.00045485943351371397, -0.00046954279410718104, -0.0004544523307774267,
      -0.00041103843725900967, -0.000342508135913186, -0.0002535937551320296,
      -0.0001502296008721639, -3.91585096923603e-05, 7.250579070400041e-05,
      0.00017773224739620796, 0.0002700131855490548, 0.00034376465598608374,
      0.0003946619366656163, 0.0004198901894586742, 0.0004182959467715706,
      0.0003904315803596873, 0.0003384917662184001, 0.0002661477667951646,
      0.00017829167785517847, 8.070824256122747e-05, -2.0303908537664364e-05,
      -0.00011833692315507079, -0.00020727841886858427, -0.00028169075735750296,
      -0.00033714148658205276, -0.00037046500256860386, -0.00037994014427390933,
      -0.0003653739789191588, -0.00032808809772378537, -0.00027080993319666843,
      -0.0001974775376439944, -0.00011297156006515442, -2.2792502778255503e-05,
      6.72955270088927e-05, 0.00015163160839820974, 0.00022501210455822915,
      0.00028301002229394045, 0.00032224014581523435, 0.00034055419598204534,
      0.00033715493188421686, 0.00031262339487376465, 0.0002688590535065846,
      0.00020893808718501256, 0.00013690010350706972, 5.747790866169242e-05,
      -2.4211717758033414e-05, -0.0001029961450603973, -0.00017397296515040737,
      -0.00023281355566966976, -0.00027602543248832895, -0.000301157598953025,
      -0.0003069369502363775, -0.00029332832744320095, -0.00026151574102253764,
      -0.00021380728033521015, -0.000153470980567954, -8.451313482385717e-05,
      -1.141396221253016e-05, 6.116202959804188e-05, 0.0001286623523408635,
      0.0001869307774159892, 0.00023246184670785788, 0.00026261016059329114,
      0.0002757420552858536, 0.0002713211131652494, 0.00024992325407085516,
      0.0002131816541011748, 0.00016366614517931223, 0.00010470578807065848,
      4.016673598855923e-05, -2.579988942549177e-05, -8.902375292090404e-05,
      -0.00014557775532022792, -0.00019202073742548555, -0.00022560551783862678,
      -0.0002444397767768879, -0.0002475904740309519, -0.00023512619668310578,
      -0.00020809582899991713, -0.00016844596688828117, -0.00011888330856809049,
      -6.269160596761871e-05, -3.5154547803032263e-06, 5.487492297557191e-05,
      0.00010882279571369808, 0.0001550128417341026, 0.00019067373508527974,
      0.0002137430941587913, 0.0002229850642251068, 0.00021805394780629244,
      0.0001995008000749972, 0.00016872354402582012, 0.00012786470104551682,
      7.966405577387134e-05, 2.7276282577646874e-05, -2.5934406950386234e-05,
      -7.660929655361546e-05, -0.00012160619655623575, -0.00015819327646302844,
      -0.00018421380700281756, -0.00019821195046794461, -0.00019951235433218279,
      -0.00018824933022580377, -0.0001653446411383374, -0.00013243616685505204,
      -9.176276688507845e-05, -4.601332318981352e-05, 1.8499389704524378e-06,
      4.878230850482607e-05, 9.184938567091179e-05, 0.0001284096664763052,
      0.00015627561039322546, 0.00017384343221768777, 0.0001801839908692325,
      0.00017508972311531274, 0.00015907541920062485, 0.00013333357641745635,
      9.964790948142617e-05, 6.027116610575312e-05, 1.7775535514063793e-05,
      -2.5114480376917214e-05, -6.569592871299029e-05, -0.00010145695642803632,
      -0.00013023146472476363, -0.00015032939847168424, -0.00016063489431880688,
      -0.0001606666640419098, -0.0001505974592523978, -0.0001312320895206596,
      -0.00010394608042507678, -7.058949689619037e-05, -3.336257014507552e-05,
      5.328573839602088e-06, 4.302667640170424e-05, 7.737869155012732e-05,
      0.00010628193887911429, 0.0001280120324904739, 0.00014132485349817225,
      0.00014552659687379704, 0.00014050803185374075, 0.0001267414304599796,
      0.00010524099181812982, 7.748987072091256e-05, 4.533896547282828e-05,
      1.0884307784711759e-05, -2.366887363501168e-05, -5.614664357687795e-05,
      -8.454249550250081e-05, -0.00010714064720554954, -0.0001226189641327029,
      -0.0001301253862773061, -0.00012932350435032833, -0.00012040494438151546,
      -0.00010406834629203184, -8.14668257134293e-05, -5.4127757539922195e-05,
      -2.3850394479980254e-05, 7.411866402607576e-06, 3.767690683284743e-05,
      6.505898462238975e-05, 8.788564628636017e-05, 0.0001047992442283903,
      0.00011483693812227727, 0.00011748451673030317, 0.00011270110144856815,
      0.00010091367335129904, 8.298228056052671e-05, 6.0138611416478786e-05,
      3.390224767673281e-05, 5.980241832762863e-06, -2.184338492283275e-05,
      -4.78211059796239e-05, -7.035113052541829e-05, -8.807562685128117e-05,
      -9.996194001809194e-05, -0.00010536198696645761, -0.00010404646588791698,
      -9.621215714135477e-05, -8.246231389293367e-05, -6.376183242908083e-05,
      -4.137044888068856e-05, -1.6758535327536658e-05, 8.488915532229248e-06,
      3.2773880379982395e-05, 5.458598867248764e-05, 7.259598526829213e-05,
      8.573621932505343e-05, 9.326331984599481e-05, 9.479942032154119e-05,
      9.034970523629894e-05, 8.02955775930772e-05, 6.536429111611855e-05,
      4.657735603060884e-05, 2.51813225088129e-05, 2.565592490492967e-06,
      -1.982735294673061e-05, -4.059353820237216e-05, -5.8455101434254505e-05,
      -7.233848648763609e-05, -8.143846282816161e-05, -8.526418954918732e-05,
      -8.366473261080732e-05, -7.68327801623074e-05, -6.528669271027019e-05,
      -4.983238456316478e-05, -3.150777548156593e-05, -1.1513600671424966e-05,
      8.864839499372245e-06, 2.833991692296567e-05, 4.5702662693911455e-05,
      5.989743353271755e-05, 7.008567111320822e-05, 7.569493130270762e-05,
      7.645035127320857e-05, 7.23868745953179e-05, 6.384179261610766e-05,
      5.142840534655548e-05, 3.599277836719406e-05, 1.8556601360217326e-05,
      2.499765472776655e-07, -1.7761466656258718e-05, -3.435045245168499e-05,
      -4.849827349820971e-05, -5.935698799119147e-05, -6.629982513955564e-05,
      -6.895683058597785e-05, -6.723376162658648e-05, -6.131332889271063e-05,
      -5.163900629062117e-05, -3.8882723073726814e-05, -2.389874285329135e-05,
      -7.666863561682718e-06, 8.771309514549091e-06, 2.4378893786939702e-05,
      3.818883248969245e-05, 4.936350241799925e-05, 5.724517239487298e-05,
      6.139429581350228e-05, 6.161343665155866e-05, 5.795556888218693e-05,
      5.071649297297761e-05, 4.0412115993254144e-05, 2.7742280714784984e-05,
      1.3543646056547052e-05, -1.26523299727801e-06, -1.574304097412961e-05,
      -2.898526384348396e-05, -4.018042572071027e-05, -4.8659521529222155e-05,
      -5.393565363206725e-05, -5.573154709127201e-05, -5.3993419718168366e-05,
      -4.889056676341413e-05, -4.0800929012886716e-05, -3.0283789637667686e-05,
      -1.8041534836187032e-05, -4.873067936708374e-06, 8.378052660130488e-06,
      2.0877401791462684e-05, 3.185198799909293e-05, 4.063780358465649e-05,
      4.671971573798013e-05, 4.976132110527848e-05, 4.9623057496287336e-05,
      4.6367633623775225e-05, 4.025265096730187e-05, 3.171109915273918e-05,
      2.132115698958314e-05, 9.767379274462226e-06, -2.2041443366176785e-06,
      -1.3833737076206166e-05, -2.439612245165247e-05, -3.324543389595383e-05,
      -3.985446776071889e-05, -4.384580982493957e-05, -4.501301661793255e-05,
      -4.3330688949046616e-05, -3.895299307228726e-05, -3.220091869967045e-05,
      -2.353926621622003e-05, -1.3544984260158387e-05, -2.8689950467779185e-06,
      7.805982105156855e-06, 1.780888966183849e-05, 2.652231937307532e-05,
      3.342041385596376e-05, 3.8100369012556234e-05, 4.0305665608113366e-05,
      3.993971007451649e-05, 3.706918994563636e-05, 3.191710771567035e-05,
      2.4846106387331984e-05, 1.633329986663017e-05, 6.93833479536893e-06,
      -2.7331934166868804e-06, -1.2068591603827647e-05, -2.0486706038484405e-05,
      -2.747392053214426e-05, -3.261529727422418e-05, -3.561898527221794e-05,
      -3.6332476340747896e-05, -3.4749825211367876e-05, -3.1009533379217876e-05,
      -2.5383388325507222e-05, -1.8257113386506596e-05, -1.0104183830106233e-05,
      -1.4545712755593093e-06, 7.139532516300108e-06, 1.5138806408128866e-05,
      2.2050485403155425e-05, 2.7458547162173382e-05, 3.104856130098838e-05,
      3.26257299993273e-05, 3.2125101475498626e-05, 2.9613447232430522e-05,
      2.528282668301989e-05, 1.9436384931187936e-05, 1.2467408472689256e-05,
      4.833070008758974e-06, -2.9753968812517237e-06, -1.046415759918176e-05,
      -1.7167865439054652e-05, -2.2678431459084144e-05, -2.6669706104625645e-05,
      -2.8916590434459383e-05, -2.930747016317388e-05, -2.7849304293800566e-05,
      -2.466517323354621e-05, -1.9984568631967813e-05, -1.4127158675191292e-05,
      -7.48116026794871e-06, -4.777693500482018e-07, 6.436676256543646e-06,
      1.2829012975571462e-05, 1.8306258358076056e-05, 2.2539633180951734e-05,
      2.52841393279636e-05, 2.639253819658512e-05, 2.5822946009225916e-05,
      2.363967699124863e-05, 2.000739611831479e-05, 1.5179062679240467e-05,
      9.478528063414567e-06, 3.2789725744230346e-06, -3.0213924780269492e-06,
      -9.024783468101519e-06, -1.4358843752514787e-05, -1.869961980833048e-05,
      -2.1791104191729556e-05, -2.3460175079370166e-05, -2.3626071426983628e-05,
      -2.2303900923166e-05, -1.9602061585138498e-05, -1.5713842484697416e-05,
      -1.0903830509757303e-05, -5.49006593396272e-06, 1.7685919927059128e-07,
      5.736393966964143e-06, 1.0840863702772862e-05, 1.5177107738751623e-05,
      1.848557984324267e-05, 2.0575753715191044e-05, 2.1336927843210372e-05,
      2.0743828641638292e-05, 1.8856747992264417e-05, 1.5816299396333015e-05,
      1.183321381063465e-05, 7.173900917195234e-06, 2.1427554518024336e-06,
      -2.93762380445087e-06, -7.747023382054385e-06, -1.1987704750987078e-05,
      -1.5402739779489995e-05, -1.7791469169671246e-05, -1.902116095454817e-05,
      -1.9034200702014125e-05, -1.785043732350567e-05, -1.5564619316166996e-05,
      -1.2339166013146108e-05, -8.392807525353567e-06, -3.985877705413046e-06,
      5.967584528634311e-07, 5.064029527913748e-06, 9.137061246926285e-06,
      1.256650064918296e-05, 1.5147690094026556e-05, 1.6732773730137704e-05,
      1.7239027467501315e-05, 1.6652952945897423e-05, 1.5029950095217542e-05,
      1.24896639833257e-05, 9.207371956348326e-06, 5.402019784595594e-06,
      1.321715845878783e-06, -2.7723615660600195e-06, -6.622605186898877e-06,
      -9.991112538097029e-06, -1.2674306865743202e-05, -1.4515151819950941e-05,
      -1.5412232879610518e-05, -1.5325187848815922e-05, -1.4276207060250897e-05,
      -1.2347575743567183e-05, -9.675480292976028e-06, -6.440531270478558e-06,
      -2.8556546899424807e-06, 8.478424988827148e-07, 4.435125719842583e-06,
      7.682655515312713e-06, 1.0392048417709644e-05, 1.2402120927719248e-05,
      1.359839032300872e-05, 1.391947823487843e-05, 1.3360067049425854e-05,
      1.1970281840430272e-05, 9.851597411636627e-06, 7.1495867825806765e-06,
      4.0440206400352485e-06, 7.369851522432588e-07, -2.5602012195419223e-06,
      -5.640429038393429e-06, -8.313746269175138e-06, -1.0419008093873919e-05,
      -1.1833517862213513e-05, -1.2480087228326158e-05, -1.2331115482706198e-05,
      -1.1409482271198197e-05, -9.786251714605544e-06, -7.575386426687145e-06,
      -4.925854528156209e-06, -2.0116701348307335e-06, 9.794714719720284e-07,
      3.8582256723890496e-06, 6.44552962388339e-06, 8.583684330606487e-06,
      1.0145905418616147e-05, 1.1043768223717822e-05, 1.1232114929939176e-05,
      1.0711158387393703e-05, 9.525697976383345e-06, 7.761545872743336e-06,
      5.539435765922e-06, 3.006839724579318e-06, 3.282431765026644e-07,
      -2.32548444298965e-06, -4.787939800212566e-06, -6.907570690595291e-06,
      -8.556951033495437e-06, -9.640381621680282e-06, -1.0099367248612378e-05,
      -9.915661971596576e-06, -9.111732383705285e-06, -7.748653633897254e-06,
      -5.921614073899692e-06, -3.753351755587564e-06, -1.3859705252881099e-06,
      1.028322278711685e-06, 3.336955933684403e-06, 5.396593819025882e-06,
      7.081987361513406e-06, 8.29354246986339e-06, 8.96314466914311e-06,
      9.057906320903584e-06, 8.581635660785959e-06, 7.573974004796677e-06,
      6.10729497673071e-06, 4.28159870474114e-06, 2.21775602340485e-06,
      4.95554126879952e-08, -2.0849270202062147e-06, -4.052080492389255e-06,
      -5.731083090122524e-06, -7.021279944521331e-06, -7.848168271255023e-06,
      -8.167636693137735e-06, -7.968221998159863e-06, -7.271275142423299e-06,
      -6.129061580093554e-06, -4.620950434310498e-06, -2.8479645425603915e-06,
      -9.260618318384574e-07, 1.0214080598027907e-06, 2.8715836921085527e-06,
      4.509807176745644e-06, 5.836692748706412e-06, 6.7741151789242585e-06,
      7.269759918113181e-06, 7.299973361779524e-06, 6.8707629329826575e-06,
      6.016915543946994e-06, 4.799321819272932e-06, 3.3007047732994586e-06,
      1.6200485622894698e-06, -1.339003705004476e-07, -1.849635450019203e-06,
      -3.419946686372221e-06, -4.7485874081986544e-06, -5.756138535317998e-06,
      -6.3847153671374535e-06, -6.6012406593819075e-06, -6.399102584142768e-06,
      -5.7981207837986175e-06, -4.842851395047024e-06, -3.599365814915166e-06,
      -2.1507316388649047e-06, -5.915019080904055e-07, 9.7842405522206e-07,
      2.4601716123714994e-06, 3.7620891257139384e-06, 4.805386906853836e-06,
      5.52887180724448e-06, 5.8924951758489175e-06, 5.879511301161573e-06,
      5.497134252972645e-06, 4.77567734102113e-06, 3.7662550656487512e-06,
      2.5372164471627693e-06, 1.1695555030615823e-06, -2.483952315683445e-07,
      -1.6266423704685593e-06, -2.879217298840994e-06, -3.929512192026429e-06,
      -4.7149369220717965e-06, -5.1906156339266805e-06, -5.331906921258388e-06,
      -5.135609156558688e-06, -4.619797539529781e-06, -3.822326352145695e-06,
      -2.798113251276583e-06, -1.6153970118856387e-06, -3.512214157999289e-07,
      9.13557663613635e-07, 2.0994200027011304e-06, 3.1331573532427487e-06,
      3.952368429387489e-06, 4.509198156773208e-06, 4.773098955557423e-06,
      4.732457083872989e-06, 4.395001082550522e-06, 3.7869873341191415e-06,
      2.9512347101746e-06, 1.9441514102298e-06, 8.31958019706675e-07,
      -3.1364212185882445e-07, -1.4200636721992354e-06, -2.418417326569985e-06,
      -3.247777735509925e-06, -3.8588782670724066e-06, -4.217010080176498e-06,
      -4.303956776896193e-06, -4.118859395995073e-06, -3.677975541591171e-06,
      -3.0133665757869218e-06, -2.170613614664399e-06, -1.2057224096744841e-06,
      -1.8142546744880377e-07, 8.368758860216591e-07, 1.785268279211998e-06,
      2.6053189134275824e-06, 3.2476558195826094e-06, 3.674917686807775e-06,
      3.863898532521466e-06, 3.8067660679936696e-06, 3.511292903337287e-06,
      3.0001028272564143e-06, 2.308996275950878e-06, 1.4844759029061709e-06,
      5.806413926688296e-07, -3.44340559412711e-07, -1.2319619706507258e-06,
      -2.0270574565201526e-06, -2.6812154025354794e-06, -3.155706613036471e-06,
      -3.4237545253528373e-06, -3.472015458521374e-06, -3.3011892611375075e-06,
      -2.9257367429860995e-06, -2.3727368280586697e-06, -1.6799698881870999e-06,
      -8.933608936825062e-07, -6.395399206396884e-08, 7.553833327410932e-07,
      1.5133147347245044e-06, 2.1632362395092736e-06, 2.666125596064021e-06,
      2.9928666005343577e-06, 3.125911193449239e-06, 3.06018609299086e-06,
      2.80319980296403e-06, 2.3743568525340363e-06, 1.803535845462396e-06,
      1.1290332158291612e-06, 3.950127308776788e-07, -3.513705263368382e-07,
      -1.0629853645225362e-06
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_48_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<48>(0.5), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      1.0870363907079738e-57, 1.032271694501514e-55, 4.899407989107242e-54, 1.5499631401366534e-52,
      3.6776427402165137e-51, 6.982424957185389e-50, 1.1052216031025436e-48,
      1.5004504828082033e-47, 1.783880118135725e-46, 1.8871546430160918e-45,
      1.798986045798519e-44, 1.5612619340223524e-43, 1.2440520593022496e-42,
      9.166933982017811e-42, 6.284774743688046e-41, 4.030277833408348e-40,
      2.4286822598536535e-39, 1.3809278803698968e-38, 7.435558048103458e-38,
      3.803742836329852e-37, 1.854114438154828e-36, 8.634610098742849e-36,
      3.851051382046576e-35, 1.6485643766589833e-34, 6.78739911789971e-34,
      2.692670404478458e-33, 1.0310869292322148e-32, 3.8171109505482395e-32,
      1.3681943371130553e-31, 4.754843957512939e-31, 1.6042142419983262e-30,
      5.260804058809257e-30, 1.6787991938059225e-29, 5.21873788941006e-29,
      1.5819331929805783e-28, 4.680339415908101e-28, 1.3527594597893348e-27,
      3.822820578950761e-27, 1.0570941531849933e-26, 2.862449543127704e-26,
      7.595693026970591e-26, 1.9765031929142795e-25, 5.0467128225661565e-25,
      1.2652235280295769e-24, 3.1162140972823283e-24, 7.544498790275873e-24,
      1.7964163216579548e-23, 4.208980322970603e-23, 9.70845102545054e-23,
      2.2055992190286166e-22, 4.937401962109502e-22, 1.0895543369486773e-21,
      2.3711184564004003e-21, 5.09072400659973e-21, 1.0786704118197607e-20,
      2.2564993325955557e-20, 4.6619423630371163e-20, 9.515374446791345e-20,
      1.919325085206655e-19, 3.8270652806638246e-19, 7.54577354611681e-19,
      1.4715779287193967e-18, 2.8393620758364804e-18, 5.421610551902458e-18,
      1.0247400555602633e-17, 1.9177005548217402e-17, 3.5540995477542286e-17,
      6.524639003274005e-17, 1.18673682781593e-16, 2.1390109031649318e-16,
      3.821366328329898e-16, 6.767914546649506e-16, 1.1885080018417346e-15,
      2.0698466120142862e-15, 3.575511117972366e-15, 6.127376793803876e-15,
      1.0418798999347497e-14, 1.7580658914243086e-14, 2.944371550542271e-14,
      4.8950086624216704e-14, 8.079398928944969e-14, 1.324124262604675e-13,
      2.1550631542884611e-13, 3.48360144079202e-13, 5.593556091708597e-13,
      8.922587009999109e-13, 1.4141236876494434e-12, 2.227033746328715e-12,
      3.4854308266305245e-12, 5.421536986610435e-12, 8.382417417344587e-12,
      1.2883691139891694e-11, 1.9686904978685826e-11, 2.991034344695639e-11,
      4.5186806413740064e-11, 6.788698100459375e-11, 1.0143389679669747e-10,
      1.5074314217121634e-10, 2.228357498744155e-10, 3.2768684158264805e-10,
      4.793944049318266e-10, 6.977804059545318e-10, 1.0105726147878428e-09,
      1.4563622698932303e-09, 2.088592761814922e-09, 2.980911217969991e-09,
      4.2343122525147386e-09, 5.986626057580445e-09, 8.425057227341942e-09,
      1.180267304202276e-08, 1.6459978374652363e-08, 2.2853008171763074e-08,
      3.158972822237349e-08, 4.347697273177744e-08, 5.958067660090036e-08,
      8.13027962868333e-08, 1.1047907207939605e-07, 1.4950268418482341e-07,
      2.0147991371793227e-07, 2.704251566634854e-07, 3.615040731450869e-07,
      4.813353042307886e-07, 6.383630705700474e-07, 8.433150950285486e-07,
      1.1097626744124526e-06, 1.454802366480654e-06, 1.8998816527221697e-06,
      2.4717940693647936e-06, 3.203872640279227e-06, 4.137413951466438e-06,
      5.323368814351597e-06, 6.82433908872675e-06, 8.716923765112316e-06,
      1.1094460701272608e-05, 1.407021329793059e-05, 1.7781053679759705e-05,
      2.2391695379055085e-05, 2.8099528823859994e-05, 3.5140111795841186e-05,
      4.379336409690014e-05, 5.4390510566703864e-05, 6.73218089190868e-05,
      8.304508818825467e-05, 0.00010209510946264162, 0.00012509374260739488,
      0.00015276093043013525, 0.00018592638486507126, 0.00022554192793876023,
      0.00027269435332869576, 0.0003286186421449665, 0.00039471131921765357,
      0.00047254368390383837, 0.000563874592700005, 0.0006706624104693632,
      0.0007950756838603642, 0.0009395020258009222, 0.001106554635430407,
      0.0012990758154500718, 0.0015201367909530759, 0.0017730330830011036,
      0.0020612746495315515, 0.0023885699788791757, 0.0027588033107829486,
      0.0031760041698855298, 0.003644308431147447, 0.00416791019897014, 0.00475100387564715,
      0.005397715923199022, 0.0061120259883443466, 0.006897677265272387,
      0.007758076216079656, 0.008696182054194503, 0.009714386720539658,
      0.010814386442805116, 0.011997046360623606, 0.01326226011749109, 0.014608806755923989,
      0.016034207695650855, 0.017534587013758655, 0.01910453866699775, 0.020737004684585992,
      0.022423168698124076, 0.024152369445852324, 0.0259120390730095, 0.02768767112993603,
      0.02946282312671215, 0.031219158320606424, 0.032936531075400434, 0.03459311962740363,
      0.03616560941282714, 0.03762942925059383, 0.038959041634143744, 0.0401282871716427,
      0.04111078183888334, 0.0418803641925815, 0.042411588060326334, 0.042680254510931735,
      0.04266397515615628, 0.042342757089061746, 0.041699598078841674, 0.04072107907472478,
      0.03939793968393464, 0.0377256211438584, 0.035704760469628845, 0.0333416189860934,
      0.0306484284038974, 0.02764363802239525, 0.02435204757705933, 0.02080481172376167,
      0.017039304180259954, 0.013098832123581608, 0.009032194549839685,
      0.004893081900035332, 0.0007393182812013526, -0.0033680480137976672,
      -0.0073657953625979105, -0.01118970596923176, -0.01477584949674305,
      -0.0180619487601551, -0.02098879877968507, -0.023501706682090184,
      -0.025551916759526606, -0.027097982606308628, -0.02810704679878956,
      -0.028555988188779753, -0.028432397649195952, -0.027735345115169636,
      -0.02647590404303606, -0.02467740396268525, -0.02237538758226611,
      -0.01961725582997741, -0.01646159215188881, -0.012977166148938134,
      -0.009241626009816695, -0.00533989892089227, -0.001362328419328531,
      0.002597412813256212, 0.006444587271151833, 0.01008577858209752, 0.013431336836869832,
      0.01639781578769105, 0.01891033099966265, 0.020904766683804678, 0.022329759817638815,
      0.02314839337998155, 0.0233395361268806, 0.022898774270940843, 0.021838890567611822,
      0.02018985844477784, 0.01799833263823996, 0.01532663293947256, 0.012251233678193117,
      0.008860787948292488, 0.005253731796566146, 0.0015355290594832878,
      -0.002184368321551662, -0.005795757411381839, -0.009191021862568632,
      -0.012268466017617222, -0.014935537841613692, -0.01711183279335382,
      -0.018731774253017187, -0.019746873391230137, -0.02012748229766307,
      -0.01986396855749104, -0.018967256903596817, -0.017468703582792372,
      -0.015419291038409487, -0.012888153711194717, -0.009960469398897404,
      -0.006734773843924051, -0.003319778168084114, 0.0001692114150794128,
      0.0036141553207174756, 0.0068982942851428045, 0.009910176712037854,
      0.01254755729571625, 0.014721025606592601, 0.016357229642827386, 0.017401570867241135,
      0.017820263696214752, 0.017601673322579954, 0.016756870481975057,
      0.015319369484182187, 0.013344045554099964, 0.010905258175207272,
      0.008094237542294365, 0.00501582022104876, 0.0017846465082557727,
      -0.001479045318414467, -0.0046538746718428475, -0.007621858591198346,
      -0.01027286399132464, -0.012508800568137466, -0.014247389741631237,
      -0.01542535869494279, -0.01600092850149569, -0.0159554908764474,
      -0.015294398350573597, -0.01404682653403006, -0.012264703325938025,
      -0.010020737015709175, -0.007405611721573035, -0.004524453015146563,
      -0.0014926974312769413, 0.0015684744854389699, 0.0045369620659418235,
      0.007294632942396889, 0.009732078459471452, 0.011753041417943458,
      0.013278332500873435, 0.014249070533459111, 0.0146291076843357, 0.014406532868916066,
      0.013594183720385383, 0.012229138069523972, 0.010371198259708963,
      0.008100424045789477, 0.005513810475426534, 0.002721244260038552,
      -0.0001590959404563849, -0.0030057046260523667, -0.005698871839764367,
      -0.00812574600081605, -0.010185120887498351, -0.01179174034026437,
      -0.012879933181876777, -0.013406418138338051, -0.01335215311706693,
      -0.012723143642696841, -0.011550169868098743, -0.009887438458196198,
      -0.007810212745143117, -0.005411519791838086, -0.002798074343888256,
      -8.559520877224599e-05, 0.002606282282957377, 0.005159274753941491,
      0.007461667649478771, 0.009413248698583563, 0.01092973730012692, 0.011946510311107942,
      0.012421455022307088, 0.01233681830717174, 0.011699965373826834, 0.010543010281982831,
      0.00892133122940114, 0.006911034265556034, 0.004605477232709263,
      0.0021110091338552048, -0.0004578832576903815, -0.0029838016516755567,
      -0.005351797291513399, -0.007454621407298875, -0.009197623626032906,
      -0.01050307203868039, -0.011313694356916794, -0.011595274805614083,
      -0.011338184526185763, -0.010557772359207983, -0.009293595680510443,
      -0.007607525034237359, -0.005580809106740687, -0.003310235619764,
      -0.0009035666480859467, 0.0015255383885991603, 0.0038628739517624537,
      0.005999061998200914, 0.007834694295884747, 0.009284999933655235,
      0.010283816325998906, 0.010786674488680197, 0.010772851016430492,
      0.010246288092348078, 0.009235336698309874, 0.007791334418460627,
      0.005986085140893346, 0.003908360867705575, 0.0016595931680178984,
      -0.0006510387685931216, -0.002911886953236979, -0.005014225544345915,
      -0.006857493236053823, -0.008354133112086291, -0.00943379507612667,
      -0.01004669656651637, -0.010165977930159978, -0.009788937624771366,
      -0.008937086985751814, -0.00765502198115573, -0.0060081673627639665,
      -0.004079504049254989, -0.0019654407045766784, 0.00022896719678052574,
      0.002395215121113029, 0.0044267075106115775, 0.006224011380440744,
      0.007699745669862127, 0.008782864361499615, 0.009422121273587715, 0.00958854494322506,
      0.009276801169789106, 0.00850537615027112, 0.007315571963049944, 0.005769365507703894,
      0.00394623891020212, 0.0019391409894811747, -0.00015021695758365115,
      -0.0022164942825733946, -0.004156024606709888, -0.005872022867155719,
      -0.007279433532235109, -0.008309175802325777, -0.008911572065059036,
      -0.009058787191758042, -0.008746156376087284, -0.007992335599756543,
      -0.006838268609367858, -0.0053450244644335475, -0.003590617200889558,
      -0.001665971006060622, 0.0003297621423876907, 0.0022942924053800584,
      0.004127428848827233, 0.005736194896510073, 0.007039560645571355,
      0.007972549995226985, 0.008489512767431701, 0.008566395041318514, 0.00820189257991647,
      0.007417429845657629, 0.006255967712994031, 0.004779703461985075,
      0.0030667838451847273, 0.0012072029926262497, -0.0007019009959957429,
      -0.0025613059230469317, -0.004274858689004086, -0.005754454058080901,
      -0.00692458055461949, -0.007726197827850786, -0.008119744884982042,
      -0.008087124121852095, -0.007632559706507263, -0.006782287795495283,
      -0.005583097204200156, -0.004099799308186101, -0.0024117619656417503,
      -0.0006086911774737172, 0.0012141165346949508, 0.002960800522775262,
      0.004539976329559325, 0.005869524693639119, 0.006880877600167894, 0.00752257659841915,
      0.007762917324891089, 0.007591542700698707, 0.007019903049127286, 0.00608056145128377,
      0.004825383841402572, 0.0033227123927070975, 0.0016536745240013813,
      -9.217449229394452e-05, -0.001821642246904923, -0.0034428674946137103,
      -0.004870201265800936, -0.006028741097838674, -0.006858277622195746,
      -0.007316444502115784, -0.007380905608651807, -0.0070504650543317966,
      -0.006345043503663636, -0.005304524951083312, -0.003986538641748101,
      -0.002463297764421081, -0.0008176669123309857, 0.0008613286162131598,
      0.00248330902540353, 0.003961402587921735, 0.005216902887047698, 0.006183470615522749,
      0.006810654839984277, 0.007066545776061958, 0.006939418352073294,
      0.006438280611047084, 0.005592300345758535, 0.004449144065957497,
      0.0030723211735329482, 0.0015376798868914606, -7.075289554195128e-05,
      -0.0016653604417305376, -0.00315970361879134, -0.00447320763192723,
      -0.005535513735445032, -0.006290260349935918, -0.00669808957656725,
      -0.006738717715065096, -0.00641195973383748, -0.0057376549008112615,
      -0.004754500831668622, -0.003517862766712132, -0.0020966806951155307,
      -0.0005696459585406281, 0.0009791414892166529, 0.002464796068336848,
      0.0038062959249503072, 0.004930903922870682, 0.00577811866895547,
      0.006302940316170726, 0.006478274006698709, 0.006296341595669864,
      0.005769027096341188, 0.0049271400871049136, 0.003818640878718886,
      0.002505928276139149, 0.001062342144133546, -0.00043192412525559776,
      -0.0018942740967461038, -0.003244275126541165, -0.00440808914427776,
      -0.005322523129277022, -0.005938476661807687, -0.006223597831081969,
      -0.006164003056347447, -0.005764968559109154, -0.005050558410685232,
      -0.004062213092684051, -0.0028563800729904795, -0.0015013208244650698,
      -7.32740666808474e-05, 0.0013478097147867378, 0.002682724166275482,
      0.0038574051223994378, 0.004807026438209846, 0.005479566682103397,
      0.005838649838554663, 0.005865504134553755, 0.0055599326674048545,
      0.004940244895568043, 0.004042156158238584, 0.0029167199649367233,
      0.0016274116286023196, 0.00024652890284468273, -0.0011488869946548607,
      -0.002481380328463713, -0.003677416763703682, -0.004671483538017772,
      -0.0054097250410659525, -0.005852911618280707, -0.005978577350850117,
      -0.005782209622867321, -0.005277426811520014, -0.004495137409953786,
      -0.0034817311084126574, -0.00229640660180588, -0.0010077891171927653,
      0.000309969838008283, 0.0015813894231762418, 0.0027339159520093836,
      0.0037019990869559508, 0.004430758745829012, 0.0048790374440957395,
      0.005021668030882367, 0.004850831516787288, 0.004376431392897181,
      0.0036254665696259813, 0.0026404416649544946, 0.0014769076439844785,
      0.00020027469196951192, -0.0011179200622664666, -0.0024040770542541235,
      -0.003586699930307594, -0.004600426195559158, -0.005389695071208237,
      -0.005911846000379196, -0.00613947412984677, -0.006061911748535083,
      -0.005685754641910063, -0.005034406771391008, -0.004146672507983516,
      -0.0030744796654168186, -0.0018798657242840224, -0.0006314011315637381,
      0.0005997449436678894, 0.0017438712875789985, 0.0027367117747636705,
      0.003523077339552986, 0.004059966361576436, 0.004318967947549092,
      0.004287823421241893, 0.00397105973719422, 0.003389661732799148,
      0.0025798050813672243, 0.0015907253650445125, 0.0004818477959083295,
      -0.0006806560189994332, -0.0018276856234131084, -0.002891184112866745,
      -0.003808037728269921, -0.0045236798153679755, -0.0049951938957866196,
      -0.0051937398685040605, -0.005106166630959575, -0.004735721403737058,
      -0.004101818050912979, -0.0032388807168753056, -0.002194332047068339,
      -0.0010258440904823143, 0.00020198809598342008, 0.001421357496357046,
      0.002565126716033307, 0.003570656850066527, 0.004383364121909627,
      0.004959801104433254, 0.00527008729748815, 0.005299551795125411, 0.005049496522432055,
      0.00453703940482816, 0.0037940499096526113, 0.0028652416089549127,
      0.0018055347482429942, 0.0006768434928686195, -0.0004555248245539243,
      -0.001526649375895167, -0.0024757357150658674, -0.0032496001626440576,
      -0.0038056984557538727, -0.0041145253967545415, -0.004161249141071131,
      -0.003946488445319938, -0.0034861910498895864, -0.0028106235002226436,
      -0.001962534097819511, -0.0009945983447564365, 3.3702544952520525e-05,
      0.0010595871165730599, 0.002020658485390719, 0.002858554065818607,
      0.003522348470746872, 0.003971512771288442, 0.004178259614301671,
      0.004129139817863556, 0.0038257998841498817, 0.0032848588242094735,
      0.002536913926942542, 0.0016247356461895975, 0.0006007586933104501,
      -0.0004759830066483294, -0.0015432979492712824, -0.002539454355165715,
      -0.0034067625783071316, -0.004094914666312501, -0.004563887811657006,
      -0.0047862443162053165, -0.0047486962335922, -0.004452845963152206,
      -0.003915062218055981, -0.003165501164477355, -0.0022463321905178005,
      -0.0012092738242315256, -0.00011258510705290739, 0.0009823110582399294,
      0.0020143752224664802, 0.002926462717833784, 0.00366859512683939,
      0.004200802669686169, 0.004495373920577148, 0.004538384354398288,
      0.0043304177007286795, 0.003886441442059802, 0.0032348472588247497,
      0.002415715900608771, 0.0014784110094335854, 0.00047864521536385493,
      -0.0005248078828550815, -0.0014735621956685483, -0.0023130257704471534,
      -0.002995566473208972, -0.0034832524839240194, -0.003750008959858063,
      -0.0037830670257545575, -0.0035836231980004916, -0.0031666739634750307,
      -0.002560038766626742, -0.00180263225901389, -0.000942090544515271,
      -3.1893746478129406e-05, 0.0008718436587098668, 0.0017137243398155715,
      0.00244236332786269, 0.003013432796826374, 0.0033922776147107202,
      0.0035559487051228513, 0.0034945360176692943, 0.003211724521514229,
      0.0027245426450487656, 0.002062320268292098, 0.0012649199238478723,
      0.00038034754085857126, -0.0005381146274965793, -0.001435082439919238,
      -0.002256363510683285, -0.00295217533023058, -0.0034800980440460247,
      -0.0038075881538631746, -0.003913905684332628, -0.003791342261551208,
      -0.0034456790007951522, -0.0028958486420549404, -0.002172823310904597,
      -0.0013177948501390693, -0.00037975618300465, 0.0005873728046567606,
      0.0015279048866545224, 0.002387644234318829, 0.003117052488910605,
      0.003674136305442673, 0.00402688735590636, 0.004155132543257936,
      0.0040516872500619035, 0.0037227457381770615, 0.003187487877323114,
      0.0024769275435722275, 0.0016320725683126283, 0.0007015064113875714,
      -0.00026146458626633896, -0.0012019294137272521, -0.002066572043733406,
      -0.00280676434027139, -0.0033813709752498174, -0.003759102721229955,
      -0.003920281694842264, -0.003857917292509413, -0.0035780325839342196,
      -0.003099225366596466, -0.0024514932983631496, -0.0016743958390430962,
      -0.000814664589297908, 7.659426801702579e-05, 0.0009469382221930064,
      0.0017456866686772867, 0.0024268956426779465, 0.002952033686303634,
      0.0032922019580300804, 0.0034297693989084515, 0.0033593290320975324,
      0.003087922173429648, 0.0026345210367381975, 0.0020288043233711193,
      0.0013093022694926864, 0.0005210248059820848, -0.0002872832306891786,
      -0.0010660942904911945, -0.001768080483962578, -0.00235094783868787,
      -0.002779953685746392, -0.0030299579954834945, -0.0030868878811591925,
      -0.002948529996604759, -0.002624606032315373, -0.002136129535559791,
      -0.0015140852713193694, -0.0007975127380888197, -3.111085310318783e-05,
      0.0007374908731011447, 0.0014606298127363625, 0.0020935018554238513,
      0.0025968735348450437, 0.0029394521873662783, 0.003099772575126032,
      0.003067487712829027, 0.002843987587695554, 0.00244230989247315, 0.001886349376487369,
      0.0012094144166057874, 0.00045221841078299236, -0.0003395727219476531,
      -0.001118089290350615, -0.0018361377029616768, -0.0024500387618247407,
      -0.0029222544387558337, -0.003223646108594244, -0.003335229487350405,
      -0.0032493218072824097, -0.002970013231124031, -0.002512934973754488,
      -0.0019043386372979592, -0.0011795423619077958, -0.0003808370976911982,
      0.0004450216305832174, 0.0012495865678863222, 0.001985590746152803,
      0.0026097475970545364, 0.0030853126553515554, 0.0033842548391590744,
      0.0034889088180123304, 0.003393011114322848, 0.003102059454524371,
      0.002632975280562668, 0.0020130908327873434, 0.0012785223437649846,
      0.000472027248833323, -0.00035952623651019244, -0.0011679261010721686,
      -0.0019064553502475708, -0.002532634099083441, -0.0030107026368128057,
      -0.0033136990423395115, -0.003425009495013424, -0.0033393011754216605,
      -0.0030627846711869322, -0.00261279286780464, -0.002016704013682505,
      -0.0013102755695514532, -0.0005354902671035348, 0.00026195555571745124,
      0.0010353704954088247, 0.0017398309500440844, 0.0023348238072680313,
      0.0027866123208599445, 0.0030701857409368457, 0.003170678722595927,
      0.0030841787069774973, 0.0028178763977823387, 0.002389553916977042,
      0.0018264448433245868, 0.0011635377425127783, 0.00044142775489909976,
      -0.0002961526424972638, -0.0010049740068357423, -0.0016429622220014012,
      -0.002172703577899677, -0.0025636531304044467, -0.002793915402113519,
      -0.002851492837519863, -0.002734929952635296, -0.002453317838724553,
      -0.0020256623674921115, -0.001479657764947357, -0.0008499428675472253,
      -0.00017594821020159432, 0.0005005337186009173, 0.0011379066170235648,
      0.001697301390270067, 0.0021449268769094683, 0.0024540986913845907,
      0.0026068246887907334, 0.0025948529219286397, 0.002420120914648955,
      0.002094581609425127, 0.001639419240763516, 0.0010837053439467978,
      0.0004625788985682136, -0.00018493680580354782, -0.0008183463225529255,
      -0.00139817549519747, -0.0018883940073957251, -0.0022586196200699202,
      -0.0024859703835379697, -0.0025564528898989343, -0.002465803141558607,
      -0.0022197301111933922, -0.0018335485144749882, -0.001331224493910598,
      -0.0007438935655247457, -0.00010794215253398436, 0.0005372296079949186,
      0.0011516269340334498, 0.0016971136691601707, 0.002139750240858529,
      0.002451874028933357, 0.002613795723619074, 0.002615008754356113,
      0.002454838578282965, 0.002142492721605345, 0.0016965088937129756,
      0.0011436350328726849, 0.0005172095802564764, -0.00014485946635441196,
      -0.0008023939222529565, -0.0014153836343231687, -0.0019464156689416013,
      -0.0023629472481709922, -0.002639284782297547, -0.0027581492353508613,
      -0.002711733174731408, -0.00250218566768578, -0.002141495825289049,
      -0.0016507821596140717, -0.0010590308115905871, -0.0004013589574523244,
      0.0002830916945362882, 0.0009535041694120537, 0.0015698365708459194,
      0.002095225857965503, 0.00249820035410729, 0.0027545679607829826, 0.00284886672893039,
      0.0027752909241777705, 0.002538037404564314, 0.0021510520882880003,
      0.0016371924116476784, 0.0010268567831812985, 0.0003561640143484587,
      -0.0003352073717085523, -0.001006389796743225, -0.0016177647113662182,
      -0.0021333217907689057, -0.002522797962117776, -0.0027634685096639276,
      -0.00284148368634664, -0.002752671806079217, -0.0025027620243172955,
      -0.002107014982498399, -0.0015892850809238882, -0.0009805722088854795,
      -0.00031715125204298295, 0.0003616072121403302, 0.0010155934264095975,
      0.0016063503486227774, 0.0020993574509981486, 0.0024660699311079928,
      0.0026855920202153113, 0.0027458855041946, 0.0026444428777358323,
      0.0023883870076937858, 0.0019939938150654287, 0.0014856692006363975,
      0.0008944441421448625, 0.0002560806146382366, -0.00039109598873510236,
      -0.0010085063000846112, -0.001559628695382434, -0.002012174200730125,
      -0.002339994392149703, -0.0025246088103180655, -0.002556261908170798,
      -0.002434448379073697, -0.00216787811113328, -0.0017738860045516131,
      -0.0012773254099704141, -0.0007090149689996177, -0.00010383529512732167,
      0.000501407372729771, 0.0010702199096967679, 0.0015686272811333006,
      0.001967210358381352, 0.0022428540143973053, 0.0023801011631406506,
      0.0023720328780682575, 0.002220623931315838, 0.001936555241186553,
      0.0015384978347933475, 0.001051915007011432, 0.0005074584396103042,
      -6.0941621541319956e-05, -0.0006181739092341041, -0.0011301023391092914,
      -0.0015656488972758174, -0.0018986763758291631, -0.002109556978209033,
      -0.0021863325728053665, -0.002125397795108464, -0.0019316667114166759,
      -0.001618215542282092, -0.0012054260510524493, -0.0007196846690069684,
      -0.00019171939786983533, 0.00034532163273103087, 0.0008579306873390757,
      0.0013143127392794174, 0.0016863420999759413, 0.0019512835087282965,
      0.002093172772529393, 0.0021037733691501126, 0.0019830518023337858,
      0.0017391442926058332, 0.0013878187636810907, 0.0009514671141760325,
      0.00045769154565979207, -6.242650742373719e-05, -0.0005762670407430905,
      -0.001051701351776855, -0.0014590855910820014, -0.001773095048787687,
      -0.001974286367606262, -0.0020502919187738696, -0.001996573468508828,
      -0.0018166895804421447, -0.0015220612564986885, -0.0011312512631769568,
      -0.0006688025200070265, -0.00016370800635598335, 0.00035239278548113476,
      0.0008471791361948079, 0.0012896546216234948, 0.0016520690677642679,
      0.001911638450336298, 0.002051956842473994, 0.002064013598061819,
      0.0019467533526666108, 0.001707144623650932, 0.001359753059545072,
      0.0009258458655671024, 0.00043208274671873874, -9.112590386876193e-05,
      -0.0006114924391278107, -0.0010968417057259671, -0.001517094709654834,
      -0.0018461242350833085, -0.0020633683660404483, -0.0021551027654832747,
      -0.0021152935418539613, -0.0019459782883482928, -0.0016571518325388679,
      -0.0012661636074005277, -0.0007966634877476572, -0.0002771605960991767,
      0.0002607167224763378, 0.0007841532731127769, 0.0012611534905129695,
      0.0016624992670028274, 0.001963539365773708, 0.002145700972774793
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby1_highpass_1_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<1>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.9577367145348356), "design.b()[0] == 0.9577367145348356");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.9577367145348356));
    static_assert(almost_equal(design.b()[1], -0.9577367145348356), "design.b()[1] == -0.9577367145348356");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.9577367145348356));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.915473429069671), "design.a()[1] == -0.915473429069671");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.915473429069671));
    std::cout << "max_deviation(cheby1,highpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.9577367145348356, -0.08095420033370904, -0.07411141937709372, -0.06784703523036845,
      -0.062112157994556175, -0.05686203026619352, -0.0520556778316556,
      -0.04765558988709181, -0.043627426288273874, -0.039939749545610394,
      -0.036563779472703783, -0.03347316857362338, -0.030643796415922145,
      -0.02805358138459714, -0.02568230834784223, -0.023511470889623763,
      -0.021524126877795615, -0.019704766240546224, -0.018039189919249143,
      -0.016514399053014054, -0.015118493530087703, -0.013840579114357024,
      -0.012670682422130495, -0.011599673085640609, -0.010619192495798579,
      -0.009721588568079642, -0.008899856022424383, -0.008147581711075212,
      -0.007458894567663361, -0.006828419786927918, -0.006251236877466093,
      -0.005722841260140667, -0.005239109112442374, -0.00479626518443778,
      -0.004390853335124733, -0.00401970955924864, -0.0036799372940694887,
      -0.003368884813363161, -0.0030841245322303116, -0.0028234340611987783,
      -0.002584778861757753, -0.0023662963679601714, -0.002166281450171606,
      -0.00198317310751862, -0.0018155422851788262, -0.0016620807214336466,
      -0.0015215907374414531, -0.0013929758900461766, -0.0012752324146719503,
      -0.001167441391520527, -0.001068761573933165, -0.0009784228229464933,
      -0.0008957200968028538, -0.0008200079485067263, -0.0007506954884838389,
      -0.0006872417730294317, -0.0006291515825551743, -0.0005759715566863956,
      -0.000527286656046291, -0.0004827169231133782, -0.0004419145168725651,
      -0.00040456099811699416, -0.00037036484421401335, -0.0003390591739394573,
      -0.000310399664623885, -0.00028416264535530383, -0.0002601433513569288,
      -0.00023815432591640386, -0.00021802395739446625, -0.00019959513989525188,
      -0.00018272404714554693, -0.00016727901001382207, -0.0001531394889087335,
      -0.00014019513303725512, -0.00012834491918049467, -0.00011749636326583725,
      -0.00010756479858219175, -9.847271500522757e-05, -9.014915407563613e-05,
      -8.252915520935272e-05, -7.555324871772923e-05, -6.916699168097331e-05,
      -6.332054305261404e-05, -5.79682746789303e-05, -5.3068415197572904e-05,
      -4.858272403621511e-05, -4.447619296697937e-05, -4.071677288744499e-05,
      -3.727512369592027e-05, -3.412438530890028e-05, -3.1239968033633644e-05,
      -2.85993606597775e-05, -2.6181954772406755e-05, -2.3968883915242248e-05,
      -2.1942876348859702e-05, -2.0088120254742374e-05, -1.8390140333172913e-05,
      -1.6835684831882267e-05, -1.5412622123779505e-05, -1.41098460266115e-05,
      -1.2917189125627101e-05, -1.1825343422779307e-05, -1.0825787693178252e-05,
      -9.910720981854137e-06, -9.073001721810744e-06, -8.306091998221112e-06,
      -7.604006523779637e-06, -6.961265926992693e-06, -6.372853988849863e-06,
      -5.834178494132715e-06, -5.341035391828206e-06, -4.8895759849394416e-06,
      -4.476276893629225e-06, -4.097912557276082e-06, -3.751530060837199e-06,
      -3.4344260890525823e-06, -3.1441258286313066e-06, -2.878363653763623e-06,
      -2.635065444220491e-06, -2.4123323980435288e-06, -2.2084262124927717e-06,
      -2.0217555175981037e-06, -1.8508634564360635e-06, -1.6944163152032668e-06,
      -1.5511931143507312e-06, -1.4200760795439261e-06, -1.3000419180798928e-06,
      -1.1901538326789118e-06, -1.0895542103229748e-06, -9.974579290816713e-07,
      -9.131462306891303e-07, -8.359611110510229e-07, -7.65300184902772e-07,
      -7.00611984540594e-07, -6.413916559346849e-07, -5.871770186352006e-07,
      -5.375449587208732e-07, -4.921081266393125e-07, -4.505119141675433e-07,
      -4.1243168689970217e-07, -3.7757025066305926e-07, -3.456555320892061e-07,
      -3.164384552386072e-07, -2.8969099770679734e-07, -2.6520441104125594e-07,
      -2.427875915803411e-07, -2.2226558899962165e-07, -2.0347824092567378e-07,
      -1.8627892296129124e-07, -1.7053340436677836e-07, -1.561188004665794e-07,
      -1.429226136053832e-07, -1.3084185516891976e-07, -1.1978224181732822e-07,
      -1.0965745965816202e-07, -1.0038849061632669e-07, -9.190299574365708e-08,
      -8.413475065522113e-08, -7.702312868625704e-08, -7.051262773608227e-08,
      -6.455243710626443e-08, -5.909604095247617e-08, -5.4100855255205064e-08,
      -4.952789547608451e-08, -4.5341472306095334e-08, -4.150891313112862e-08,
      -3.800030704110941e-08, -3.4788271392624796e-08, -3.1847738103212564e-08,
      -2.9155758009460824e-08, -2.6691321762046625e-08, -2.4435195859902755e-08,
      -2.2369772543854204e-08, -2.0478932378230786e-08, -1.874791844798485e-08,
      -1.7163221189495237e-08, -1.571247295622844e-08, -1.4384351496402922e-08,
      -1.3168491589355437e-08, -1.2055404150982343e-08, -1.1036402176920552e-08,
      -1.0103532945497439e-08, -9.249515951332934e-09, -8.46768608520138e-09,
      -7.751941616704846e-09, -7.096696573792675e-09, -6.4968371474769655e-09,
      -5.947681781507957e-09, -5.444944635532299e-09, -4.9847021365852636e-09,
      -4.563362357870627e-09, -4.177636985847282e-09, -3.824515656841895e-09,
      -3.501242462899695e-09, -3.205294443515124e-09, -2.9343618953827535e-09,
      -2.6863303464974285e-09, -2.459264053921918e-09, -2.251390896431679e-09,
      -2.0610885441325493e-09, -1.886871797113241e-09, -1.727380994318111e-09,
      -1.581371402178179e-09, -1.4477035001847714e-09, -1.3253340875903179e-09,
      -1.213308141829232e-09, -1.1107513651185576e-09, -1.0168633610689041e-09,
      -9.309113880530606e-10, -8.522246405809426e-10, -7.801890140503034e-10,
      -7.14242312015117e-10, -6.53869858567129e-10, -5.986004815877504e-10,
      -5.480028355218943e-10, -5.016820349751315e-10, -4.5927657286133423e-10,
      -4.2045549904873224e-10, -3.849158374853427e-10, -3.523802216459309e-10,
      -3.2259472984653106e-10, -2.953269035324079e-10, -2.703639330733414e-10,
      -2.475109969074149e-10, -2.2658974107128386e-10, -2.0743688725053709e-10,
      -1.899029584867879e-10, -1.7385111259637512e-10, -1.59156074196181e-10,
      -1.457031570016448e-10, -1.3338736876657241e-10, -1.221125918793148e-10,
      -1.1179083322034157e-10, -1.0234153742678179e-10, -9.3690958204358e-11,
      -8.577158278016683e-11, -7.852160500449248e-11, -7.188444298951696e-11,
      -6.580829752037636e-11, -6.024574779221607e-11, -5.51533813182066e-11,
      -5.049145512016573e-11, -4.6223585557575514e-11, -4.2316464374288975e-11,
      -3.87395987468349e-11, -3.546507330554807e-11, -3.246733227123735e-11,
      -2.9722980007094046e-11, -2.721059842926366e-11, -2.4910579851075808e-11,
      -2.2804973956378223e-11, -2.0877347707690114e-11, -1.9112657095838905e-11,
      -1.7497129730160422e-11, -1.6018157352946848e-11, -1.4664197439279816e-11,
      -1.3424683114292181e-11, -1.2289940684814773e-11, -1.125111414179024e-11,
      -1.030009604423898e-11, -9.429464245366411e-12, -8.632423966995445e-12,
      -7.902754770248534e-12, -7.234762008616125e-12, -6.623232384530784e-12,
      -6.063393262591691e-12, -5.5508754219027555e-12, -5.081678956827873e-12,
      -4.652142060038401e-12, -4.258912444222598e-12, -3.8989211794199556e-12,
      -3.5693587417959525e-12, -3.267653086931747e-12, -2.991449576503502e-12,
      -2.7385926016906762e-12, -2.507108759894595e-12, -2.2951914534713152e-12,
      -2.101186790280787e-12, -1.9235806760142476e-12, -1.7609869975629192e-12,
      -1.61213680520603e-12, -1.4758684091913886e-12, -1.3511183134180409e-12,
      -1.2369129154636444e-12, -1.1323609081800666e-12, -1.0366463235560524e-12,
      -9.490221645583268e-13, -8.688045752513331e-13, -7.953675036967569e-13,
      -7.281378159798543e-13, -6.665908232303783e-13, -6.102461867290893e-13,
      -5.586641691415702e-13, -5.114422026223919e-13, -4.682117470056665e-13,
      -4.286354135619788e-13, -3.924043318742813e-13, -3.592357392827415e-13,
      -3.2887077408554965e-13, -3.0107245527289523e-13, -2.7562383302710256e-13,
      -2.52326295554648e-13, -2.309980190358609e-13, -2.1147254859506073e-13,
      -1.9359749921642287e-13, -1.7723336646697158e-13, -1.622524377450801e-13,
      -1.485377955574018e-13, -1.3598240504538437e-13, -1.2448827864003895e-13,
      -1.1396571132557715e-13, -1.0433258054359035e-13, -9.55137052739283e-14,
      -8.744025929027306e-14, -8.004923401120744e-14, -7.32829467546406e-14,
      -6.708859055780095e-14, -6.141782204940119e-14, -5.622638415755616e-14,
      -5.1473760708906563e-14, -4.712286022329439e-14, -4.3139726436190116e-14,
      -3.94932732896665e-14, -3.615504232367664e-14, -3.3098980574215336e-14,
      -3.030123724498734e-14, -2.7739977565722193e-14, -2.539521238440744e-14,
      -2.3248642163506055e-14, -2.1283514162638623e-14, -1.9484491693123687e-14,
      -1.7837534423983462e-14, -1.632978880527244e-14, -1.4949487753546284e-14,
      -1.3685858816574069e-14, -1.2529040100572453e-14, -1.1470003303822479e-14,
      -1.050048325599082e-14, -9.61291341325058e-15, -8.800366805778344e-15,
      -8.056501976756808e-15, -7.375513490968138e-15, -6.752086626726221e-15,
      -6.181355897544521e-15, -5.658867079825117e-15, -5.180542450216975e-15,
      -4.74264896134113e-15, -4.341769107512678e-15, -3.974774253083396e-15,
      -3.6388002152480966e-15, -3.331224910752632e-15, -3.049647892049021e-15,
      -2.791871613189211e-15, -2.555884279248601e-15, -2.339844145428981e-15,
      -2.142065143304463e-15, -1.961003722031553e-15, -1.7952468018266137e-15,
      -1.6435007456945702e-15, -1.5045812633395695e-15, -1.3774041684634535e-15,
      -1.2609769173180966e-15, -1.1543908624749009e-15, -1.0568141613565924e-15,
      -9.674852841865082e-16, -8.857070706886679e-16, -8.108412891546083e-16,
      -7.423036554136419e-16, -6.795592728324781e-16, -6.221184577560409e-16,
      -5.69532917809458e-16, -5.213922532350796e-16, -4.773207539594805e-16,
      -4.3697446739340637e-16, -4.0003851408053485e-16, -3.662246302452431e-16,
      -3.3526891806038506e-16, -3.069297860772193e-16, -2.809860637437325e-16,
      -2.5723527529626394e-16, -2.354920595531516e-16, -2.1558672327780287e-16,
      -1.9736391682102446e-16, -1.806814217067646e-16, -1.6540904069907506e-16,
      -1.51427581687907e-16, -1.3862792746355596e-16, -1.269101841198832e-16,
      -1.1618290144009277e-16, -1.0636235918062534e-16, -9.737191368302708e-17,
      -8.914139971447682e-17, -8.160658286868229e-17, -7.470865825345084e-17,
      -6.839379155248082e-17, -6.261269887962591e-17, -5.732026214663788e-17,
      -5.2475176942555044e-17, -4.80396301766386e-17, -4.3979004969046185e-17,
      -4.026161048608481e-17, -3.6858434611563486e-17, -3.3742917523988273e-17,
      -3.089074441250064e-17, -2.827965571382674e-17, -2.5889273389246677e-17,
      -2.370094188577584e-17, -2.1697582540352202e-17, -1.9863560290738453e-17,
      -1.8184561652894482e-17, -1.6647483012504155e-17, -1.5240328358836274e-17,
      -1.3952115662811596e-17, -1.2772791168610797e-17, -1.1693150929918937e-17,
      -1.0704768978442102e-17, -9.79993156409303e-18, -8.971576953628349e-18,
      -8.213240317900578e-18, -7.519003277601716e-18, -6.8834477137321385e-18,
      -6.301613482312148e-18, -5.768959703323972e-18, -5.2813293217667485e-18,
      -4.834916664244005e-18, -4.426237737881554e-18, -4.05210303977601e-18,
      -3.709592664767382e-18, -3.3960335172662933e-18, -3.1089784492873093e-18,
      -2.8461871618727614e-18, -2.6056087208537318e-18, -2.385365550493805e-18,
      -2.183738780095227e-18, -1.9991548292061977e-18, -1.8301731267345903e-18,
      -1.6754748681228768e-18, -1.5338527228405049e-18, -1.4042014118666486e-18,
      -1.2855090816260343e-18, -1.1768494070563892e-18, -1.0773743621765217e-18,
      -9.8630760173349e-19, -9.029384022764414e-19, -8.266161153707038e-19,
      -7.56745089662669e-19, -6.927800221651192e-19, -6.342217024824643e-19,
      -5.806131167620263e-19, -5.315358809649615e-19, -4.866069756205617e-19,
      -4.454757565805774e-19, -4.0782121844422723e-19, -3.7334948929650805e-19,
      -3.4179153720768467e-19, -3.129010705945131e-19, -2.8645261605673013e-19,
      -2.6223975868743264e-19, -2.40073531123987e-19, -2.1978093876694075e-19,
      -2.0120360965712262e-19, -1.841965584740016e-19, -1.6862705500902643e-19,
      -1.5437358828303346e-19, -1.4132491822325823e-19, -1.2937920749883705e-19,
      -1.1844322673927685e-19, -1.0843162693308232e-19, -9.926627332803217e-20,
      -9.087563563458083e-20, -8.31942297732757e-20, -7.616210680935083e-20,
      -6.972438508592694e-20, -6.383082190438777e-20, -5.843542140914535e-20,
      -5.3496075616561555e-20, -4.897423578646402e-20, -4.4834611571500814e-20,
      -4.10448955963686e-20, -3.75755113174142e-20, -3.439938219479941e-20,
      -3.14917203757512e-20, -2.882983323969218e-20, -2.6392946295447782e-20,
      -2.4162041048345253e-20, -2.2119706571850777e-20, -2.0250003625347168e-20,
      -1.853834025756984e-20, -1.697135792485779e-20, -1.5536827235438295e-20,
      -1.4223552506089753e-20, -1.3021284386302498e-20, -1.1920639868019715e-20,
      -1.0913029056680638e-20, -9.990588132056381e-21, -9.146117975676414e-21,
      -8.373027985868245e-21, -7.665284641919123e-21, -7.017364415932785e-21,
      -6.424210664885475e-21, -5.881194166448657e-21, -5.3840769905832976e-21,
      -4.928979424944406e-21, -4.51234969596771e-21, -4.130936249329047e-21,
      -3.781762373441468e-21, -3.462102967941119e-21, -3.169463275853341e-21,
      -2.9015594134558507e-21, -2.656300545885811e-21, -2.4317725693817223e-21,
      -2.22622317280945e-21, -2.0380481618862298e-21, -1.865778939371127e-21,
      -1.7080710435120594e-21, -1.5636936552985961e-21, -1.4315199926306939e-21,
      -1.3105185164354114e-21, -1.1997448801004242e-21, -1.0983345593943165e-21,
      -1.0054961053544412e-21, -9.205049674850294e-22, -8.426978390591859e-22,
      -7.714674803931146e-22, -7.062579796912238e-22, -6.465604144757427e-22,
      -5.919088797408159e-22, -5.418768518331123e-22, -4.960738596811373e-22,
      -4.5414243739411755e-22, -4.1575533444725117e-22, -3.8061296168043295e-22,
      -3.4844105317794923e-22, -3.1898852578146477e-22, -2.9202551953103672e-22,
      -2.673416037409304e-22, -2.4474413470969474e-22, -2.240567522473737e-22,
      -2.0511800328611693e-22, -1.8778008183226551e-22, -1.7190767542596753e-22,
      -1.573769091056065e-22, -1.4407437863529552e-22, -1.3189626545033615e-22,
      -1.207475264133028e-22, -1.1054115205726699e-22, -1.0119748752717812e-22,
      -9.264361091974102e-23, -8.481276417009173e-23, -7.76438320436712e-23,
      -7.108086516712928e-23, -6.507264337579077e-23, -5.957227596986299e-23,
      -5.453683575961523e-23, -4.992702404346441e-23, -4.5706863904314275e-23,
      -4.184341943050336e-23, -3.830653867004341e-23, -3.5068618312054597e-23,
      -3.210438825887208e-23, -2.939071440753371e-23, -2.6906418101472266e-23,
      -2.4632110843337082e-23, -2.2550042978974024e-23, -2.064396517162981e-23,
      -1.88990015852668e-23, -1.7301533787257345e-23, -1.5839094464385253e-23,
      -1.450027012266921e-23, -1.327461201163648e-23, -1.2152554577862292e-23,
      -1.112534081135192e-23, -1.0184953902137098e-23, -9.324054673705976e-24,
      -8.535924304970702e-24, -7.814411893750677e-24, -7.153886452534754e-24,
      -6.549192961877056e-24, -5.9956121384485434e-24, -5.488823603757231e-24,
      -5.024872166090181e-24, -4.600136952527323e-24, -4.211303150120295e-24,
      -3.855336135692534e-24, -3.5294577923586586e-24, -3.231124827927252e-24,
      -2.9580089259747122e-24, -2.7079785746807645e-24, -2.4790824316101995e-24,
      -2.2695340946125673e-24, -2.0776981599854982e-24, -1.90207745909367e-24,
      -1.7413013738326087e-24, -1.5941151397462673e-24, -1.4593700533153931e-24,
      -1.3360145069902316e-24, -1.2230857820011732e-24, -1.1197025348949742e-24,
      -1.025057919158305e-24, -9.38413288246875e-25, -8.590924308759122e-25,
      -7.864762935817707e-25, -7.199981493673089e-25, -6.591391747251074e-25,
      -6.034244005197471e-25, -5.524190051281234e-25, -5.057249209078993e-25,
      -4.629777275095427e-25, -4.2384380778604475e-25, -3.880177441038369e-25,
      -3.552199347346177e-25, -3.2519441172540524e-25, -2.9770684321655117e-25,
      -2.72542704616963e-25, -2.4950560436361357e-25, -2.2841575119885797e-25,
      -2.091085510035433e-25, -1.91433322235004e-25, -1.752521199446784e-25,
      -1.6043865919748402e-25, -1.46877329490861e-25, -1.3446229248159445e-25,
      -1.2309665597869432e-25, -1.126917177558249e-25, -1.0316627328167655e-25,
      -9.444598196551521e-26, -8.646278697182252e-26, -7.915438407601484e-26,
      -7.246373541596707e-26, -6.633862434445274e-26, -6.073124790838091e-26,
      -5.559784377436576e-26, -5.0898348688998476e-26, -4.659608580830123e-26,
      -4.265747845615016e-26, -3.9051788077717406e-26, -3.5750874342810047e-26,
      -3.272897552685123e-26, -2.996250745550384e-26, -2.7429879443815683e-26,
      -2.5111325793397623e-26, -2.2988751532567398e-26, -2.104559119555013e-26,
      -1.9266679538588756e-26, -1.7638133183978315e-26, -1.614724226832418e-26,
      -1.4782371249401472e-26, -1.3532868097470483e-26, -1.2388981162338858e-26,
      -1.1341783067365912e-26, -1.0383101036445803e-26, -9.505453110211894e-27,
      -8.701989753666651e-27, -7.96644039951835e-27, -7.293064510026224e-27,
      -6.676606775420028e-27, -6.112256099243572e-27, -5.5956080505265236e-27,
      -5.1226304897453735e-27, -4.689632100304045e-27, -4.2932335799405474e-27,
      -3.930341267225233e-27, -3.59812299732072e-27, -3.293985998571642e-27,
      -3.0155566574198655e-27, -2.7606619937220392e-27, -2.5273127018950297e-27,
      -2.3136876255351782e-27, -2.1181195443447544e-27, -1.9390821624407813e-27,
      -1.775178196497495e-27, -1.625128470757276e-27, -1.487761933802914e-27,
      -1.3620065191778785e-27, -1.246880778527019e-27, -1.1414862219591911e-27,
      -1.0450003058527642e-27, -9.56670013377885e-28, -8.758059776351804e-28,
      -8.017771015453942e-28, -7.340056325013039e-28, -6.719626533424214e-28,
      -6.151639544621412e-28, -5.631662548315153e-28, -5.155637424469315e-28,
      -4.719849072018851e-28, -4.320896414652402e-28, -3.9556658573766815e-28,
      -3.6213069867064507e-28, -3.315210324834112e-28, -3.0349869641630626e-28,
      -2.7784499232641096e-28, -2.5435970787489587e-28, -2.3285955398539074e-28,
      -2.131767343786398e-28, -1.9515763601948782e-28, -1.7866163025589126e-28,
      -1.6355997529353845e-28, -1.4973481144052632e-28, -1.3707824128055923e-28,
      -1.2549148759595329e-28, -1.1488412246852144e-28, -1.0517336154191737e-28,
      -9.628341793756335e-29, -8.814491078184939e-29, -8.069432372849988e-29,
      -7.38735092501879e-29, -6.762923483067959e-29, -6.191276751580028e-29,
      -5.667949358088302e-29, -5.188857034642338e-29, -4.7502607424563064e-29,
      -4.348737490871516e-29, -3.981153622891984e-29, -3.644640358802069e-29,
      -3.336571406998246e-29, -3.0545424673005013e-29, -2.796352466778523e-29,
      -2.559986381649168e-29, -2.3435995111800232e-29, -2.1455030808659805e-29,
      -1.964151062519923e-29, -1.7981281084159517e-29, -1.6461385053181125e-29,
      -1.5069960621871952e-29, -1.379614852645003e-29, -1.2630007399463696e-29,
      -1.1562436183162348e-29, -1.0585103100998873e-29, -9.690380632927446e-30,
      -8.871285987016418e-30, -8.121426602791641e-30, -7.434950260995313e-30,
      -6.806499410395824e-30, -6.2311693551957584e-30, -5.7044699767149114e-30,
      -5.2222906906081865e-30, -4.780868366129697e-30, -4.376757957071469e-30,
      -4.0068056151681855e-30, -3.668124076133631e-30, -3.358070126231074e-30,
      -3.0742239735171845e-30, -2.8143703627639665e-30, -2.5764812866715822e-30,
      -2.3587001584430713e-30, -2.1593273221970546e-30, -1.976806788135568e-30,
      -1.809714088942671e-30, -1.6567451626400426e-30, -1.5167061751366695e-30,
      -1.3885042030435117e-30, -1.2711387040378944e-30, -1.1636937082087488e-30,
      -1.0653306694406645e-30, -9.752819210459333e-31, -8.928446845695768e-31,
      -8.173755850095392e-31, -7.482856296465112e-31, -6.850356112960495e-31,
      -6.271319001080327e-31, -5.74122591070879e-31, -5.255939771540221e-31,
      -4.811673205635589e-31, -4.404958969125869e-31, -4.032622892376862e-31,
      -3.691759107429101e-31, -3.379707369377307e-31, -3.0940322946958804e-31,
      -2.8325043544775403e-31, -2.5930824742483287e-31, -2.3738981045605844e-31,
      -2.173240638044071e-31, -1.989544059103765e-31, -1.821374722072916e-31,
      -1.6674201624369115e-31, -1.5264788538060272e-31, -1.3974508306961448e-31,
      -1.27932910393366e-31, -1.1711918016867773e-31, -1.0721949747884802e-31,
      -9.815660102008793e-32, -8.985976012168346e-32, -8.226422273397564e-32,
      -7.531071007602387e-32, -6.894495399896939e-32, -6.311727345448724e-32,
      -5.778218676290756e-32, -5.289805665498314e-32, -4.8426765317059143e-32,
      -4.433341690356035e-32, -4.0586065195077707e-32, -3.715546427658301e-32,
      -3.4014840289959113e-32, -3.113968247950607e-32, -2.850755189965418e-32,
      -2.6097906291958026e-32, -2.3891939764637756e-32, -2.1872436023458954e-32,
      -2.0023634008502966e-32, -1.8331104888200291e-32, -1.6781639450636528e-32,
      -1.5363145013285093e-32, -1.4064551046606722e-32, -1.2875722774962485e-32,
      -1.1787382080545365e-32, -1.0791035093031258e-32, -9.878905899828483e-33,
      -9.043875859572585e-33, -8.279428045243333e-33, -7.579596383314517e-33,
      -6.938919091997017e-33, -6.352396055187516e-33, -5.8154497994511666e-33,
      -5.32388976948609e-33, -4.8738796232603714e-33, -4.4619072915789686e-33,
      -4.0847575684127665e-33, -3.7394870180731264e-33, -3.423401003396924e-33,
      -3.134032655660334e-33, -2.8691236220936933e-33, -2.626606440742908e-33,
      -2.4045884051233938e-33, -2.2013367927394844e-33, -2.0152653421864476e-33,
      -1.844921873296691e-33, -1.6889769537125627e-33, -1.5462135234348868e-33,
      -1.415517396372834e-33, -1.295868564765211e-33, -1.1863332386092007e-33,
      -1.0860565579688931e-33, -9.942559212873865e-34, -9.102148776337886e-34,
      -8.332775352176354e-34, -7.628434425324122e-34, -6.983629021784599e-34,
      -6.3933268079236195e-34, -5.8529208160128896e-34, -5.358193489508577e-34,
      -4.905283767459204e-34, -4.490656951155672e-34, -4.111077117850037e-34,
      -3.7635818662480335e-34, -3.445459196678519e-34, -3.154226345502918e-34,
      -2.887610408579453e-34, -2.6435306025595055e-34, -2.4200820255757642e-34,
      -2.21552079058372e-34, -2.0282504153308265e-34, -1.8568093627348962e-34,
      -1.699859634431586e-34, -1.5561763284702015e-34, -1.424638079661666e-34,
      -1.3042183079710964e-34, -1.1939772066537438e-34, -1.09305440760633e-34,
      -1.0006622666910848e-34, -9.160797166283171e-35, -8.38646639482898e-35,
      -7.677587148251647e-35, -7.028627033591172e-35, -6.4345212920935e-35,
      -5.890633271694647e-35, -5.392718240630194e-35, -4.936890259756287e-35,
      -4.519591855039747e-35, -4.137566253528593e-35, -3.7878319661207725e-35,
      -3.4676595187642975e-35, -3.1745501504892366e-35, -2.9062163120220214e-35,
      -2.660563812785013e-35, -2.435675476948974e-35, -2.2297961809833835e-35,
      -2.041319155931315e-35, -1.8687734475060473e-35, -1.7108124361427118e-35,
      -1.566203327410606e-35, -1.4338175307649162e-35, -1.3126218515495663e-35,
      -1.201670427509862e-35, -1.100097346884071e-35, -1.0071098904624078e-35,
      -9.219823448716011e-36, -8.440503388013007e-36, -7.727056579698443e-36,
      -7.073914983631897e-36, -6.475981207012818e-36, -5.9285887221747715e-36,
      -5.427465447033117e-36, -4.9687004039525624e-36, -4.5487131968263114e-36,
      -4.164226068153049e-36, -3.812238318033385e-36, -3.490002885440818e-36,
      -3.195004908997552e-36, -2.924942099934421e-36, -2.6777067740572087e-36,
      -2.4513694024892396e-36, -2.2441635528132946e-36, -2.0544721030871626e-36,
      -1.8808146211411833e-36, -1.7218358106604933e-36, -1.5762949338803184e-36,
      -1.4430561283445653e-36, -1.3210795421556025e-36, -1.2094132185309805e-36,
      -1.107185666330744e-36, -1.0135990585725949e-36, -9.279230058532438e-37,
      -8.494888560811054e-37, -7.776844760330418e-37, -7.119494740082192e-37,
      -6.51770826294653e-37, -5.966788733155389e-37, -5.462436542076042e-37,
      -5.00071551224983e-37, -4.578022177801248e-37, -4.191057661468712e-37,
      -3.836801928773478e-37, -3.5124902183953833e-37, -3.215591464808099e-37,
      -2.9437885447750368e-37, -2.6949601935412197e-37, -2.4671644495874446e-37,
      -2.2586234987426053e-37, -2.0677097993712304e-37, -1.8929333803513417e-37,
      -1.7329302127106865e-37, -1.5864515641686865e-37, -1.4523542535024506e-37,
      -1.3295917286778107e-37, -1.217205899115347e-37, -1.1143196583469586e-37,
      -1.0201300387066345e-37, -9.339019446317389e-38, -8.549624156668521e-38,
      -7.826953743962225e-38, -7.165368183154798e-38, -6.559704181179441e-38,
      -6.005234880427002e-38, -5.497632968353303e-38, -5.032936905304872e-38,
      -4.6075200069907496e-38, -4.218062140306936e-38, -3.861523811615746e-38,
      -3.5351224452540536e-38, -3.2363106671378885e-38, -2.9627564239794774e-38,
      -2.7123247829586883e-38, -2.4830612698058416e-38, -2.2731766152592453e-38,
      -2.0810327908523694e-38, -1.905130225048046e-38, -1.7440960999490088e-38,
      -1.5966736372473588e-38, -1.4617122897959836e-38, -1.3381587622528097e-38,
      -1.2250487907192063e-38, -1.1214996172173656e-38, -1.0267031002743052e-38,
      -9.399194078445804e-39, -8.604712433486126e-39, -7.877385597641978e-39,
      -7.211537205177341e-39, -6.601970694087212e-39, -6.043928749933496e-39,
      -5.5330561777543877e-39, -5.0653659122839366e-39, -4.637207901211198e-39,
      -4.245240618630787e-39, -3.8864049863637784e-39, -3.5579004996199164e-39,
      -3.257163370675741e-39, -2.981846519992648e-39, -2.729801258617135e-39,
      -2.4990605189049322e-39, -2.2878235026945296e-39, -2.0944416271179467e-39,
      -1.917405658363928e-39, -1.7553339329800153e-39, -1.6069615747875667e-39,
      -1.4711306232539723e-39, -1.3467809962797163e-39, -1.2329422168700597e-39,
      -1.1287258391227955e-39, -1.0333185144212873e-39, -9.459756437184342e-40,
      -8.660155663713044e-40, -7.928142401736513e-40, -7.2580037106703826e-40,
      -6.6445095452078115e-40, -6.082871937837555e-40, -5.568707631523821e-40,
      -5.0980038709175584e-40, -4.667087085119354e-40, -4.27259421758099e-40,
      -3.911446479392117e-40, -3.5808253211115933e-40, -3.278150435617536e-40,
      -3.0010596203010216e-40, -2.7473903414395012e-40, -2.5151628568705144e-40,
      -2.30256476524792e-40, -2.1079368612965154e-40, -1.9297601866734802e-40,
      -1.7666441753760993e-40, -1.6173158011775188e-40, -1.4806096423925453e-40,
      -1.3554587864347228e-40, -1.2408865031800106e-40, -1.1359986221524776e-40,
      -1.0399765540403501e-40, -9.520709020793793e-41, -8.715956134440644e-41,
      -7.979226250017211e-41, -7.304769616425988e-41, -6.687322489313445e-41,
      -6.122066050586507e-41, -5.604588800321448e-41, -5.13085212755575e-41
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.9577367145348356, -0.08095420033370904, -0.07411141937709372, -0.06784703523036845,
      -0.062112157994556175, -0.05686203026619352, -0.0520556778316556,
      -0.04765558988709181, -0.043627426288273874, -0.039939749545610394,
      -0.036563779472703783, -0.03347316857362338, -0.030643796415922145,
      -0.02805358138459714, -0.02568230834784223, -0.023511470889623763,
      -0.021524126877795615, -0.019704766240546224, -0.018039189919249143,
      -0.016514399053014054, -0.015118493530087703, -0.013840579114357024,
      -0.012670682422130495, -0.011599673085640609, -0.010619192495798579,
      -0.009721588568079642, -0.008899856022424383, -0.008147581711075212,
      -0.007458894567663361, -0.006828419786927918, -0.006251236877466093,
      -0.005722841260140667, -0.005239109112442374, -0.00479626518443778,
      -0.004390853335124733, -0.00401970955924864, -0.0036799372940694887,
      -0.003368884813363161, -0.0030841245322303116, -0.0028234340611987783,
      -0.002584778861757753, -0.0023662963679601714, -0.002166281450171606,
      -0.00198317310751862, -0.0018155422851788262, -0.0016620807214336466,
      -0.0015215907374414531, -0.0013929758900461766, -0.0012752324146719503,
      -0.001167441391520527, -0.001068761573933165, -0.0009784228229464933,
      -0.0008957200968028538, -0.0008200079485067263, -0.0007506954884838389,
      -0.0006872417730294317, -0.0006291515825551743, -0.0005759715566863956,
      -0.000527286656046291, -0.0004827169231133782, -0.0004419145168725651,
      -0.00040456099811699416, -0.00037036484421401335, -0.0003390591739394573,
      -0.000310399664623885, -0.00028416264535530383, -0.0002601433513569288,
      -0.00023815432591640386, -0.00021802395739446625, -0.00019959513989525188,
      -0.00018272404714554693, -0.00016727901001382207, -0.0001531394889087335,
      -0.00014019513303725512, -0.00012834491918049467, -0.00011749636326583725,
      -0.00010756479858219175, -9.847271500522757e-05, -9.014915407563613e-05,
      -8.252915520935272e-05, -7.555324871772923e-05, -6.916699168097331e-05,
      -6.332054305261404e-05, -5.79682746789303e-05, -5.3068415197572904e-05,
      -4.858272403621511e-05, -4.447619296697937e-05, -4.071677288744499e-05,
      -3.727512369592027e-05, -3.412438530890028e-05, -3.1239968033633644e-05,
      -2.85993606597775e-05, -2.6181954772406755e-05, -2.3968883915242248e-05,
      -2.1942876348859702e-05, -2.0088120254742374e-05, -1.8390140333172913e-05,
      -1.6835684831882267e-05, -1.5412622123779505e-05, -1.41098460266115e-05,
      -1.2917189125627101e-05, -1.1825343422779307e-05, -1.0825787693178252e-05,
      -9.910720981854137e-06, -9.073001721810744e-06, -8.306091998221112e-06,
      -7.604006523779637e-06, -6.961265926992693e-06, -6.372853988849863e-06,
      -5.834178494132715e-06, -5.341035391828206e-06, -4.8895759849394416e-06,
      -4.476276893629225e-06, -4.097912557276082e-06, -3.751530060837199e-06,
      -3.4344260890525823e-06, -3.1441258286313066e-06, -2.878363653763623e-06,
      -2.635065444220491e-06, -2.4123323980435288e-06, -2.2084262124927717e-06,
      -2.0217555175981037e-06, -1.8508634564360635e-06, -1.6944163152032668e-06,
      -1.5511931143507312e-06, -1.4200760795439261e-06, -1.3000419180798928e-06,
      -1.1901538326789118e-06, -1.0895542103229748e-06, -9.974579290816713e-07,
      -9.131462306891303e-07, -8.359611110510229e-07, -7.65300184902772e-07,
      -7.00611984540594e-07, -6.413916559346849e-07, -5.871770186352006e-07,
      -5.375449587208732e-07, -4.921081266393125e-07, -4.505119141675433e-07,
      -4.1243168689970217e-07, -3.7757025066305926e-07, -3.456555320892061e-07,
      -3.164384552386072e-07, -2.8969099770679734e-07, -2.6520441104125594e-07,
      -2.427875915803411e-07, -2.2226558899962165e-07, -2.0347824092567378e-07,
      -1.8627892296129124e-07, -1.7053340436677836e-07, -1.561188004665794e-07,
      -1.429226136053832e-07, -1.3084185516891976e-07, -1.1978224181732822e-07,
      -1.0965745965816202e-07, -1.0038849061632669e-07, -9.190299574365708e-08,
      -8.413475065522113e-08, -7.702312868625704e-08, -7.051262773608227e-08,
      -6.455243710626443e-08, -5.909604095247617e-08, -5.4100855255205064e-08,
      -4.952789547608451e-08, -4.5341472306095334e-08, -4.150891313112862e-08,
      -3.800030704110941e-08, -3.4788271392624796e-08, -3.1847738103212564e-08,
      -2.9155758009460824e-08, -2.6691321762046625e-08, -2.4435195859902755e-08,
      -2.2369772543854204e-08, -2.0478932378230786e-08, -1.874791844798485e-08,
      -1.7163221189495237e-08, -1.571247295622844e-08, -1.4384351496402922e-08,
      -1.3168491589355437e-08, -1.2055404150982343e-08, -1.1036402176920552e-08,
      -1.0103532945497439e-08, -9.249515951332934e-09, -8.46768608520138e-09,
      -7.751941616704846e-09, -7.096696573792675e-09, -6.4968371474769655e-09,
      -5.947681781507957e-09, -5.444944635532299e-09, -4.9847021365852636e-09,
      -4.563362357870627e-09, -4.177636985847282e-09, -3.824515656841895e-09,
      -3.501242462899695e-09, -3.205294443515124e-09, -2.9343618953827535e-09,
      -2.6863303464974285e-09, -2.459264053921918e-09, -2.251390896431679e-09,
      -2.0610885441325493e-09, -1.886871797113241e-09, -1.727380994318111e-09,
      -1.581371402178179e-09, -1.4477035001847714e-09, -1.3253340875903179e-09,
      -1.213308141829232e-09, -1.1107513651185576e-09, -1.0168633610689041e-09,
      -9.309113880530606e-10, -8.522246405809426e-10, -7.801890140503034e-10,
      -7.14242312015117e-10, -6.53869858567129e-10, -5.986004815877504e-10,
      -5.480028355218943e-10, -5.016820349751315e-10, -4.5927657286133423e-10,
      -4.2045549904873224e-10, -3.849158374853427e-10, -3.523802216459309e-10,
      -3.2259472984653106e-10, -2.953269035324079e-10, -2.703639330733414e-10,
      -2.475109969074149e-10, -2.2658974107128386e-10, -2.0743688725053709e-10,
      -1.899029584867879e-10, -1.7385111259637512e-10, -1.59156074196181e-10,
      -1.457031570016448e-10, -1.3338736876657241e-10, -1.221125918793148e-10,
      -1.1179083322034157e-10, -1.0234153742678179e-10, -9.3690958204358e-11,
      -8.577158278016683e-11, -7.852160500449248e-11, -7.188444298951696e-11,
      -6.580829752037636e-11, -6.024574779221607e-11, -5.51533813182066e-11,
      -5.049145512016573e-11, -4.6223585557575514e-11, -4.2316464374288975e-11,
      -3.87395987468349e-11, -3.546507330554807e-11, -3.246733227123735e-11,
      -2.9722980007094046e-11, -2.721059842926366e-11, -2.4910579851075808e-11,
      -2.2804973956378223e-11, -2.0877347707690114e-11, -1.9112657095838905e-11,
      -1.7497129730160422e-11, -1.6018157352946848e-11, -1.4664197439279816e-11,
      -1.3424683114292181e-11, -1.2289940684814773e-11, -1.125111414179024e-11,
      -1.030009604423898e-11, -9.429464245366411e-12, -8.632423966995445e-12,
      -7.902754770248534e-12, -7.234762008616125e-12, -6.623232384530784e-12,
      -6.063393262591691e-12, -5.5508754219027555e-12, -5.081678956827873e-12,
      -4.652142060038401e-12, -4.258912444222598e-12, -3.8989211794199556e-12,
      -3.5693587417959525e-12, -3.267653086931747e-12, -2.991449576503502e-12,
      -2.7385926016906762e-12, -2.507108759894595e-12, -2.2951914534713152e-12,
      -2.101186790280787e-12, -1.9235806760142476e-12, -1.7609869975629192e-12,
      -1.61213680520603e-12, -1.4758684091913886e-12, -1.3511183134180409e-12,
      -1.2369129154636444e-12, -1.1323609081800666e-12, -1.0366463235560524e-12,
      -9.490221645583268e-13, -8.688045752513331e-13, -7.953675036967569e-13,
      -7.281378159798543e-13, -6.665908232303783e-13, -6.102461867290893e-13,
      -5.586641691415702e-13, -5.114422026223919e-13, -4.682117470056665e-13,
      -4.286354135619788e-13, -3.924043318742813e-13, -3.592357392827415e-13,
      -3.2887077408554965e-13, -3.0107245527289523e-13, -2.7562383302710256e-13,
      -2.52326295554648e-13, -2.309980190358609e-13, -2.1147254859506073e-13,
      -1.9359749921642287e-13, -1.7723336646697158e-13, -1.622524377450801e-13,
      -1.485377955574018e-13, -1.3598240504538437e-13, -1.2448827864003895e-13,
      -1.1396571132557715e-13, -1.0433258054359035e-13, -9.55137052739283e-14,
      -8.744025929027306e-14, -8.004923401120744e-14, -7.32829467546406e-14,
      -6.708859055780095e-14, -6.141782204940119e-14, -5.622638415755616e-14,
      -5.1473760708906563e-14, -4.712286022329439e-14, -4.3139726436190116e-14,
      -3.94932732896665e-14, -3.615504232367664e-14, -3.3098980574215336e-14,
      -3.030123724498734e-14, -2.7739977565722193e-14, -2.539521238440744e-14,
      -2.3248642163506055e-14, -2.1283514162638623e-14, -1.9484491693123687e-14,
      -1.7837534423983462e-14, -1.632978880527244e-14, -1.4949487753546284e-14,
      -1.3685858816574069e-14, -1.2529040100572453e-14, -1.1470003303822479e-14,
      -1.050048325599082e-14, -9.61291341325058e-15, -8.800366805778344e-15,
      -8.056501976756808e-15, -7.375513490968138e-15, -6.752086626726221e-15,
      -6.181355897544521e-15, -5.658867079825117e-15, -5.180542450216975e-15,
      -4.74264896134113e-15, -4.341769107512678e-15, -3.974774253083396e-15,
      -3.6388002152480966e-15, -3.331224910752632e-15, -3.049647892049021e-15,
      -2.791871613189211e-15, -2.555884279248601e-15, -2.339844145428981e-15,
      -2.142065143304463e-15, -1.961003722031553e-15, -1.7952468018266137e-15,
      -1.6435007456945702e-15, -1.5045812633395695e-15, -1.3774041684634535e-15,
      -1.2609769173180966e-15, -1.1543908624749009e-15, -1.0568141613565924e-15,
      -9.674852841865082e-16, -8.857070706886679e-16, -8.108412891546083e-16,
      -7.423036554136419e-16, -6.795592728324781e-16, -6.221184577560409e-16,
      -5.69532917809458e-16, -5.213922532350796e-16, -4.773207539594805e-16,
      -4.3697446739340637e-16, -4.0003851408053485e-16, -3.662246302452431e-16,
      -3.3526891806038506e-16, -3.069297860772193e-16, -2.809860637437325e-16,
      -2.5723527529626394e-16, -2.354920595531516e-16, -2.1558672327780287e-16,
      -1.9736391682102446e-16, -1.806814217067646e-16, -1.6540904069907506e-16,
      -1.51427581687907e-16, -1.3862792746355596e-16, -1.269101841198832e-16,
      -1.1618290144009277e-16, -1.0636235918062534e-16, -9.737191368302708e-17,
      -8.914139971447682e-17, -8.160658286868229e-17, -7.470865825345084e-17,
      -6.839379155248082e-17, -6.261269887962591e-17, -5.732026214663788e-17,
      -5.2475176942555044e-17, -4.80396301766386e-17, -4.3979004969046185e-17,
      -4.026161048608481e-17, -3.6858434611563486e-17, -3.3742917523988273e-17,
      -3.089074441250064e-17, -2.827965571382674e-17, -2.5889273389246677e-17,
      -2.370094188577584e-17, -2.1697582540352202e-17, -1.9863560290738453e-17,
      -1.8184561652894482e-17, -1.6647483012504155e-17, -1.5240328358836274e-17,
      -1.3952115662811596e-17, -1.2772791168610797e-17, -1.1693150929918937e-17,
      -1.0704768978442102e-17, -9.79993156409303e-18, -8.971576953628349e-18,
      -8.213240317900578e-18, -7.519003277601716e-18, -6.8834477137321385e-18,
      -6.301613482312148e-18, -5.768959703323972e-18, -5.2813293217667485e-18,
      -4.834916664244005e-18, -4.426237737881554e-18, -4.05210303977601e-18,
      -3.709592664767382e-18, -3.3960335172662933e-18, -3.1089784492873093e-18,
      -2.8461871618727614e-18, -2.6056087208537318e-18, -2.385365550493805e-18,
      -2.183738780095227e-18, -1.9991548292061977e-18, -1.8301731267345903e-18,
      -1.6754748681228768e-18, -1.5338527228405049e-18, -1.4042014118666486e-18,
      -1.2855090816260343e-18, -1.1768494070563892e-18, -1.0773743621765217e-18,
      -9.8630760173349e-19, -9.029384022764414e-19, -8.266161153707038e-19,
      -7.56745089662669e-19, -6.927800221651192e-19, -6.342217024824643e-19,
      -5.806131167620263e-19, -5.315358809649615e-19, -4.866069756205617e-19,
      -4.454757565805774e-19, -4.0782121844422723e-19, -3.7334948929650805e-19,
      -3.4179153720768467e-19, -3.129010705945131e-19, -2.8645261605673013e-19,
      -2.6223975868743264e-19, -2.40073531123987e-19, -2.1978093876694075e-19,
      -2.0120360965712262e-19, -1.841965584740016e-19, -1.6862705500902643e-19,
      -1.5437358828303346e-19, -1.4132491822325823e-19, -1.2937920749883705e-19,
      -1.1844322673927685e-19, -1.0843162693308232e-19, -9.926627332803217e-20,
      -9.087563563458083e-20, -8.31942297732757e-20, -7.616210680935083e-20,
      -6.972438508592694e-20, -6.383082190438777e-20, -5.843542140914535e-20,
      -5.3496075616561555e-20, -4.897423578646402e-20, -4.4834611571500814e-20,
      -4.10448955963686e-20, -3.75755113174142e-20, -3.439938219479941e-20,
      -3.14917203757512e-20, -2.882983323969218e-20, -2.6392946295447782e-20,
      -2.4162041048345253e-20, -2.2119706571850777e-20, -2.0250003625347168e-20,
      -1.853834025756984e-20, -1.697135792485779e-20, -1.5536827235438295e-20,
      -1.4223552506089753e-20, -1.3021284386302498e-20, -1.1920639868019715e-20,
      -1.0913029056680638e-20, -9.990588132056381e-21, -9.146117975676414e-21,
      -8.373027985868245e-21, -7.665284641919123e-21, -7.017364415932785e-21,
      -6.424210664885475e-21, -5.881194166448657e-21, -5.3840769905832976e-21,
      -4.928979424944406e-21, -4.51234969596771e-21, -4.130936249329047e-21,
      -3.781762373441468e-21, -3.462102967941119e-21, -3.169463275853341e-21,
      -2.9015594134558507e-21, -2.656300545885811e-21, -2.4317725693817223e-21,
      -2.22622317280945e-21, -2.0380481618862298e-21, -1.865778939371127e-21,
      -1.7080710435120594e-21, -1.5636936552985961e-21, -1.4315199926306939e-21,
      -1.3105185164354114e-21, -1.1997448801004242e-21, -1.0983345593943165e-21,
      -1.0054961053544412e-21, -9.205049674850294e-22, -8.426978390591859e-22,
      -7.714674803931146e-22, -7.062579796912238e-22, -6.465604144757427e-22,
      -5.919088797408159e-22, -5.418768518331123e-22, -4.960738596811373e-22,
      -4.5414243739411755e-22, -4.1575533444725117e-22, -3.8061296168043295e-22,
      -3.4844105317794923e-22, -3.1898852578146477e-22, -2.9202551953103672e-22,
      -2.673416037409304e-22, -2.4474413470969474e-22, -2.240567522473737e-22,
      -2.0511800328611693e-22, -1.8778008183226551e-22, -1.7190767542596753e-22,
      -1.573769091056065e-22, -1.4407437863529552e-22, -1.3189626545033615e-22,
      -1.207475264133028e-22, -1.1054115205726699e-22, -1.0119748752717812e-22,
      -9.264361091974102e-23, -8.481276417009173e-23, -7.76438320436712e-23,
      -7.108086516712928e-23, -6.507264337579077e-23, -5.957227596986299e-23,
      -5.453683575961523e-23, -4.992702404346441e-23, -4.5706863904314275e-23,
      -4.184341943050336e-23, -3.830653867004341e-23, -3.5068618312054597e-23,
      -3.210438825887208e-23, -2.939071440753371e-23, -2.6906418101472266e-23,
      -2.4632110843337082e-23, -2.2550042978974024e-23, -2.064396517162981e-23,
      -1.88990015852668e-23, -1.7301533787257345e-23, -1.5839094464385253e-23,
      -1.450027012266921e-23, -1.327461201163648e-23, -1.2152554577862292e-23,
      -1.112534081135192e-23, -1.0184953902137098e-23, -9.324054673705976e-24,
      -8.535924304970702e-24, -7.814411893750677e-24, -7.153886452534754e-24,
      -6.549192961877056e-24, -5.9956121384485434e-24, -5.488823603757231e-24,
      -5.024872166090181e-24, -4.600136952527323e-24, -4.211303150120295e-24,
      -3.855336135692534e-24, -3.5294577923586586e-24, -3.231124827927252e-24,
      -2.9580089259747122e-24, -2.7079785746807645e-24, -2.4790824316101995e-24,
      -2.2695340946125673e-24, -2.0776981599854982e-24, -1.90207745909367e-24,
      -1.7413013738326087e-24, -1.5941151397462673e-24, -1.4593700533153931e-24,
      -1.3360145069902316e-24, -1.2230857820011732e-24, -1.1197025348949742e-24,
      -1.025057919158305e-24, -9.38413288246875e-25, -8.590924308759122e-25,
      -7.864762935817707e-25, -7.199981493673089e-25, -6.591391747251074e-25,
      -6.034244005197471e-25, -5.524190051281234e-25, -5.057249209078993e-25,
      -4.629777275095427e-25, -4.2384380778604475e-25, -3.880177441038369e-25,
      -3.552199347346177e-25, -3.2519441172540524e-25, -2.9770684321655117e-25,
      -2.72542704616963e-25, -2.4950560436361357e-25, -2.2841575119885797e-25,
      -2.091085510035433e-25, -1.91433322235004e-25, -1.752521199446784e-25,
      -1.6043865919748402e-25, -1.46877329490861e-25, -1.3446229248159445e-25,
      -1.2309665597869432e-25, -1.126917177558249e-25, -1.0316627328167655e-25,
      -9.444598196551521e-26, -8.646278697182252e-26, -7.915438407601484e-26,
      -7.246373541596707e-26, -6.633862434445274e-26, -6.073124790838091e-26,
      -5.559784377436576e-26, -5.0898348688998476e-26, -4.659608580830123e-26,
      -4.265747845615016e-26, -3.9051788077717406e-26, -3.5750874342810047e-26,
      -3.272897552685123e-26, -2.996250745550384e-26, -2.7429879443815683e-26,
      -2.5111325793397623e-26, -2.2988751532567398e-26, -2.104559119555013e-26,
      -1.9266679538588756e-26, -1.7638133183978315e-26, -1.614724226832418e-26,
      -1.4782371249401472e-26, -1.3532868097470483e-26, -1.2388981162338858e-26,
      -1.1341783067365912e-26, -1.0383101036445803e-26, -9.505453110211894e-27,
      -8.701989753666651e-27, -7.96644039951835e-27, -7.293064510026224e-27,
      -6.676606775420028e-27, -6.112256099243572e-27, -5.5956080505265236e-27,
      -5.1226304897453735e-27, -4.689632100304045e-27, -4.2932335799405474e-27,
      -3.930341267225233e-27, -3.59812299732072e-27, -3.293985998571642e-27,
      -3.0155566574198655e-27, -2.7606619937220392e-27, -2.5273127018950297e-27,
      -2.3136876255351782e-27, -2.1181195443447544e-27, -1.9390821624407813e-27,
      -1.775178196497495e-27, -1.625128470757276e-27, -1.487761933802914e-27,
      -1.3620065191778785e-27, -1.246880778527019e-27, -1.1414862219591911e-27,
      -1.0450003058527642e-27, -9.56670013377885e-28, -8.758059776351804e-28,
      -8.017771015453942e-28, -7.340056325013039e-28, -6.719626533424214e-28,
      -6.151639544621412e-28, -5.631662548315153e-28, -5.155637424469315e-28,
      -4.719849072018851e-28, -4.320896414652402e-28, -3.9556658573766815e-28,
      -3.6213069867064507e-28, -3.315210324834112e-28, -3.0349869641630626e-28,
      -2.7784499232641096e-28, -2.5435970787489587e-28, -2.3285955398539074e-28,
      -2.131767343786398e-28, -1.9515763601948782e-28, -1.7866163025589126e-28,
      -1.6355997529353845e-28, -1.4973481144052632e-28, -1.3707824128055923e-28,
      -1.2549148759595329e-28, -1.1488412246852144e-28, -1.0517336154191737e-28,
      -9.628341793756335e-29, -8.814491078184939e-29, -8.069432372849988e-29,
      -7.38735092501879e-29, -6.762923483067959e-29, -6.191276751580028e-29,
      -5.667949358088302e-29, -5.188857034642338e-29, -4.7502607424563064e-29,
      -4.348737490871516e-29, -3.981153622891984e-29, -3.644640358802069e-29,
      -3.336571406998246e-29, -3.0545424673005013e-29, -2.796352466778523e-29,
      -2.559986381649168e-29, -2.3435995111800232e-29, -2.1455030808659805e-29,
      -1.964151062519923e-29, -1.7981281084159517e-29, -1.6461385053181125e-29,
      -1.5069960621871952e-29, -1.379614852645003e-29, -1.2630007399463696e-29,
      -1.1562436183162348e-29, -1.0585103100998873e-29, -9.690380632927446e-30,
      -8.871285987016418e-30, -8.121426602791641e-30, -7.434950260995313e-30,
      -6.806499410395824e-30, -6.2311693551957584e-30, -5.7044699767149114e-30,
      -5.2222906906081865e-30, -4.780868366129697e-30, -4.376757957071469e-30,
      -4.0068056151681855e-30, -3.668124076133631e-30, -3.358070126231074e-30,
      -3.0742239735171845e-30, -2.8143703627639665e-30, -2.5764812866715822e-30,
      -2.3587001584430713e-30, -2.1593273221970546e-30, -1.976806788135568e-30,
      -1.809714088942671e-30, -1.6567451626400426e-30, -1.5167061751366695e-30,
      -1.3885042030435117e-30, -1.2711387040378944e-30, -1.1636937082087488e-30,
      -1.0653306694406645e-30, -9.752819210459333e-31, -8.928446845695768e-31,
      -8.173755850095392e-31, -7.482856296465112e-31, -6.850356112960495e-31,
      -6.271319001080327e-31, -5.74122591070879e-31, -5.255939771540221e-31,
      -4.811673205635589e-31, -4.404958969125869e-31, -4.032622892376862e-31,
      -3.691759107429101e-31, -3.379707369377307e-31, -3.0940322946958804e-31,
      -2.8325043544775403e-31, -2.5930824742483287e-31, -2.3738981045605844e-31,
      -2.173240638044071e-31, -1.989544059103765e-31, -1.821374722072916e-31,
      -1.6674201624369115e-31, -1.5264788538060272e-31, -1.3974508306961448e-31,
      -1.27932910393366e-31, -1.1711918016867773e-31, -1.0721949747884802e-31,
      -9.815660102008793e-32, -8.985976012168346e-32, -8.226422273397564e-32,
      -7.531071007602387e-32, -6.894495399896939e-32, -6.311727345448724e-32,
      -5.778218676290756e-32, -5.289805665498314e-32, -4.8426765317059143e-32,
      -4.433341690356035e-32, -4.0586065195077707e-32, -3.715546427658301e-32,
      -3.4014840289959113e-32, -3.113968247950607e-32, -2.850755189965418e-32,
      -2.6097906291958026e-32, -2.3891939764637756e-32, -2.1872436023458954e-32,
      -2.0023634008502966e-32, -1.8331104888200291e-32, -1.6781639450636528e-32,
      -1.5363145013285093e-32, -1.4064551046606722e-32, -1.2875722774962485e-32,
      -1.1787382080545365e-32, -1.0791035093031258e-32, -9.878905899828483e-33,
      -9.043875859572585e-33, -8.279428045243333e-33, -7.579596383314517e-33,
      -6.938919091997017e-33, -6.352396055187516e-33, -5.8154497994511666e-33,
      -5.32388976948609e-33, -4.8738796232603714e-33, -4.4619072915789686e-33,
      -4.0847575684127665e-33, -3.7394870180731264e-33, -3.423401003396924e-33,
      -3.134032655660334e-33, -2.8691236220936933e-33, -2.626606440742908e-33,
      -2.4045884051233938e-33, -2.2013367927394844e-33, -2.0152653421864476e-33,
      -1.844921873296691e-33, -1.6889769537125627e-33, -1.5462135234348868e-33,
      -1.415517396372834e-33, -1.295868564765211e-33, -1.1863332386092007e-33,
      -1.0860565579688931e-33, -9.942559212873865e-34, -9.102148776337886e-34,
      -8.332775352176354e-34, -7.628434425324122e-34, -6.983629021784599e-34,
      -6.3933268079236195e-34, -5.8529208160128896e-34, -5.358193489508577e-34,
      -4.905283767459204e-34, -4.490656951155672e-34, -4.111077117850037e-34,
      -3.7635818662480335e-34, -3.445459196678519e-34, -3.154226345502918e-34,
      -2.887610408579453e-34, -2.6435306025595055e-34, -2.4200820255757642e-34,
      -2.21552079058372e-34, -2.0282504153308265e-34, -1.8568093627348962e-34,
      -1.699859634431586e-34, -1.5561763284702015e-34, -1.424638079661666e-34,
      -1.3042183079710964e-34, -1.1939772066537438e-34, -1.09305440760633e-34,
      -1.0006622666910848e-34, -9.160797166283171e-35, -8.38646639482898e-35,
      -7.677587148251647e-35, -7.028627033591172e-35, -6.4345212920935e-35,
      -5.890633271694647e-35, -5.392718240630194e-35, -4.936890259756287e-35,
      -4.519591855039747e-35, -4.137566253528593e-35, -3.7878319661207725e-35,
      -3.4676595187642975e-35, -3.1745501504892366e-35, -2.9062163120220214e-35,
      -2.660563812785013e-35, -2.435675476948974e-35, -2.2297961809833835e-35,
      -2.041319155931315e-35, -1.8687734475060473e-35, -1.7108124361427118e-35,
      -1.566203327410606e-35, -1.4338175307649162e-35, -1.3126218515495663e-35,
      -1.201670427509862e-35, -1.100097346884071e-35, -1.0071098904624078e-35,
      -9.219823448716011e-36, -8.440503388013007e-36, -7.727056579698443e-36,
      -7.073914983631897e-36, -6.475981207012818e-36, -5.9285887221747715e-36,
      -5.427465447033117e-36, -4.9687004039525624e-36, -4.5487131968263114e-36,
      -4.164226068153049e-36, -3.812238318033385e-36, -3.490002885440818e-36,
      -3.195004908997552e-36, -2.924942099934421e-36, -2.6777067740572087e-36,
      -2.4513694024892396e-36, -2.2441635528132946e-36, -2.0544721030871626e-36,
      -1.8808146211411833e-36, -1.7218358106604933e-36, -1.5762949338803184e-36,
      -1.4430561283445653e-36, -1.3210795421556025e-36, -1.2094132185309805e-36,
      -1.107185666330744e-36, -1.0135990585725949e-36, -9.279230058532438e-37,
      -8.494888560811054e-37, -7.776844760330418e-37, -7.119494740082192e-37,
      -6.51770826294653e-37, -5.966788733155389e-37, -5.462436542076042e-37,
      -5.00071551224983e-37, -4.578022177801248e-37, -4.191057661468712e-37,
      -3.836801928773478e-37, -3.5124902183953833e-37, -3.215591464808099e-37,
      -2.9437885447750368e-37, -2.6949601935412197e-37, -2.4671644495874446e-37,
      -2.2586234987426053e-37, -2.0677097993712304e-37, -1.8929333803513417e-37,
      -1.7329302127106865e-37, -1.5864515641686865e-37, -1.4523542535024506e-37,
      -1.3295917286778107e-37, -1.217205899115347e-37, -1.1143196583469586e-37,
      -1.0201300387066345e-37, -9.339019446317389e-38, -8.549624156668521e-38,
      -7.826953743962225e-38, -7.165368183154798e-38, -6.559704181179441e-38,
      -6.005234880427002e-38, -5.497632968353303e-38, -5.032936905304872e-38,
      -4.6075200069907496e-38, -4.218062140306936e-38, -3.861523811615746e-38,
      -3.5351224452540536e-38, -3.2363106671378885e-38, -2.9627564239794774e-38,
      -2.7123247829586883e-38, -2.4830612698058416e-38, -2.2731766152592453e-38,
      -2.0810327908523694e-38, -1.905130225048046e-38, -1.7440960999490088e-38,
      -1.5966736372473588e-38, -1.4617122897959836e-38, -1.3381587622528097e-38,
      -1.2250487907192063e-38, -1.1214996172173656e-38, -1.0267031002743052e-38,
      -9.399194078445804e-39, -8.604712433486126e-39, -7.877385597641978e-39,
      -7.211537205177341e-39, -6.601970694087212e-39, -6.043928749933496e-39,
      -5.5330561777543877e-39, -5.0653659122839366e-39, -4.637207901211198e-39,
      -4.245240618630787e-39, -3.8864049863637784e-39, -3.5579004996199164e-39,
      -3.257163370675741e-39, -2.981846519992648e-39, -2.729801258617135e-39,
      -2.4990605189049322e-39, -2.2878235026945296e-39, -2.0944416271179467e-39,
      -1.917405658363928e-39, -1.7553339329800153e-39, -1.6069615747875667e-39,
      -1.4711306232539723e-39, -1.3467809962797163e-39, -1.2329422168700597e-39,
      -1.1287258391227955e-39, -1.0333185144212873e-39, -9.459756437184342e-40,
      -8.660155663713044e-40, -7.928142401736513e-40, -7.2580037106703826e-40,
      -6.6445095452078115e-40, -6.082871937837555e-40, -5.568707631523821e-40,
      -5.0980038709175584e-40, -4.667087085119354e-40, -4.27259421758099e-40,
      -3.911446479392117e-40, -3.5808253211115933e-40, -3.278150435617536e-40,
      -3.0010596203010216e-40, -2.7473903414395012e-40, -2.5151628568705144e-40,
      -2.30256476524792e-40, -2.1079368612965154e-40, -1.9297601866734802e-40,
      -1.7666441753760993e-40, -1.6173158011775188e-40, -1.4806096423925453e-40,
      -1.3554587864347228e-40, -1.2408865031800106e-40, -1.1359986221524776e-40,
      -1.0399765540403501e-40, -9.520709020793793e-41, -8.715956134440644e-41,
      -7.979226250017211e-41, -7.304769616425988e-41, -6.687322489313445e-41,
      -6.122066050586507e-41, -5.604588800321448e-41, -5.13085212755575e-41
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_2_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<2>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.8359639206095842), "design.b()[0] == 0.8359639206095842");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.8359639206095842));
    static_assert(almost_equal(design.b()[1], -1.6719278412191685), "design.b()[1] == -1.6719278412191685");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -1.6719278412191685));
    static_assert(almost_equal(design.b()[2], 0.8359639206095842), "design.b()[2] == 0.8359639206095842");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.8359639206095842));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.7523548027388904), "design.a()[1] == -1.7523548027388904");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.7523548027388904));
    static_assert(almost_equal(design.a()[2], 0.7896367853391639), "design.a()[2] == 0.7896367853391639");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.7896367853391639));
    std::cout << "max_deviation(cheby1,highpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.8359639206095842, -0.20702245002253106, -0.18692072689184613, -0.16407889157154187,
      -0.13992495177732783, -0.11563543278744251, -0.09214441690167836, -0.0701597200856516,
      -0.05018410130171476, -0.03253965510846536, -0.017393808481765353,
      -0.0047856151750482745, 0.005348695278290318, 0.013151709641994306,
      0.018822935010068164, 0.02259938684311648, 0.024738862181491027, 0.025505956780596615,
      0.025160770256987857, 0.023950154881212535, 0.022101299190047923,
      0.019817394473673873, 0.017275107539465043, 0.014623573998622436,
      0.011984629745842055, 0.00945401153173209, 0.007103278006792743, 0.004982228055916482,
      0.0031216216514714885, 0.0015360381473892857, 0.00022673653885468435,
      -0.0008155893620444013, -0.0016082414473013956, -0.0021741902621407842,
      -0.0025400261414342522, -0.002734206398712081, -0.0027856016374629374,
      -0.0027223324567927157, -0.002570878833070933, -0.002355438020585335,
      -0.0020975026306838647, -0.0018156283019956803, -0.0015253597404571405,
      -0.0012392845713359436, -0.00096718610860039, -0.0007162685375180933,
      -0.0004914308821506845, -0.0002955692811455901, -0.00012989034735970016,
      5.7784029836179765e-06, 0.00011269200855620468, 0.00019291354286737908,
      0.0002490672179872915, 0.0002841225058066582, 0.00030121080027165217,
      0.0003034746103651769, 0.0002939480629467868, 0.000275466584099782,
      0.00025060298815935447, 0.00022162680194484982, 0.00019048345283717723,
      0.00015878991798878368, 0.00012784353405550676, 9.864087051634753e-05,
      7.190384593767832e-05, 4.811058986670249e-05, 2.7528901455766294e-05,
      1.025051115702379e-05, -3.7753007929107074e-06, -1.470984715435652e-05,
      -2.279575492668924e-05, -2.8330814208046086e-05, -3.164527170328246e-05,
      -3.3082690795941506e-05, -3.2984341484829415e-05, -3.167695960564365e-05,
      -2.9463622924505556e-05, -2.661742858552598e-05, -2.3377618327854013e-05,
      -1.9947781011142187e-05, -1.6495762473566087e-05, -1.3154926923105558e-05,
      -1.0026438522038022e-05, -7.1822634915268575e-06, -4.66862924097042e-06,
      -2.5097154177136297e-06, -7.113904799580162e-07, 7.351550903823734e-07,
      1.8499926451044281e-06, 2.6613379943851084e-06, 3.202786170990874e-06,
      3.5109273502943245e-06, 3.6233526281656225e-06, 3.5770419935368507e-06,
      3.407114195518082e-06, 3.1459089831963294e-06, 2.822366015051177e-06,
      2.461661185101206e-06, 2.085059773252489e-06, 1.709946282859148e-06,
      1.3499926846026397e-06, 1.0154296786262535e-06, 7.133891904833072e-07,
      4.482903469970174e-07, 2.2224539551275996e-07, 3.5466237712086035e-08,
      -1.1334370767927371e-07, -2.266238364470544e-07, -3.07625007242825e-07,
      -3.6011764119126993e-07, -3.8814185628336094e-07, -3.9580010946793886e-07,
      -3.870911350995524e-07, -3.65782683612197e-07, -3.353196428332549e-07,
      -2.9876352415127583e-07, -2.587589716017567e-07, -2.175228578507014e-07,
      -1.768516221468864e-07, -1.3814273923024412e-07, -1.0242654615954058e-07,
      -7.04050615669112e-08, -4.249487913109101e-08, -1.887167904987431e-08,
      4.856423316568823e-10, 1.575278965118745e-08, 2.722099555219966e-08,
      3.526186011094334e-08, 4.029659049734785e-08, 4.276986202894524e-08,
      4.3128302958447444e-08, 4.180343246127738e-08, 3.919875113924827e-08,
      3.568059179536233e-08, 3.157228055826313e-08, 2.715112966540324e-08,
      2.2647778343102647e-08, 1.824741240358593e-08, 1.4092421877059498e-08,
      1.028609508736224e-08, 6.896993419123557e-09, 3.963700483982002e-09,
      1.4996898677422306e-09, -5.018949658618869e-10, -2.06370834006824e-09,
      -3.220034493749794e-09, -4.013062890578236e-09, -4.4896523436721775e-09,
      -4.698601766781765e-09, -4.688422728229721e-09, -4.505591290373054e-09,
      -4.1932434854333475e-09, -3.790269738170378e-09, -3.330758073376758e-09,
      -2.8437334950259243e-09, -2.353140949914439e-09, -1.8780212697305453e-09,
      -1.432832936517726e-09, -1.0278769996007022e-09, -6.697876029551996e-10,
      -3.620560331647496e-10, -1.055616989192718e-10, 1.0091121205439989e-10,
      2.6018764768328474e-10, 3.762578689398233e-10, 4.538835460034114e-10,
      4.982579576350295e-10, 5.147215808801403e-10, 5.08532022392086e-10,
      4.846854373144064e-10, 4.47785262491789e-10, 4.019532047015264e-10,
      3.507769135387382e-10, 2.9728857271224427e-10, 2.43968703813768e-10,
      1.9276973697147333e-10, 1.4515431140180756e-10, 1.0214377931038359e-10,
      6.437295841100872e-11, 3.214777730099769e-11, 5.503056008342963e-12,
      -1.574176089779826e-11, -3.1930565768793355e-11, -4.352340680819988e-11,
      -5.105490164417685e-11, -5.509861906049933e-11, -5.6237501324831574e-11,
      -5.504015910904345e-11, -5.204268739659801e-11, -4.773551890344606e-11,
      -4.2554745435426127e-11, -3.687729084968581e-11, -3.101930534588953e-11,
      -2.5237163301930383e-11, -1.973047976286123e-11, -1.464660847197653e-11,
      -1.0086142086559023e-11, -6.1089986965556466e-12, -2.7407443921303943e-12,
      2.1133493759965476e-14, 2.2012259705271137e-12, 3.840641117291158e-12,
      4.991996908309507e-12, 5.715038252034652e-12, 6.0729103376888315e-12,
      6.129089163424683e-12, 5.944945435236547e-12, 5.577899421393634e-12,
      5.080111237776689e-12, 4.497642757911339e-12, 3.870023180866378e-12,
      3.230149538740954e-12, 2.60445539405015e-12, 2.0132850203468e-12,
      1.4714158897699737e-12, 9.88678789826591e-13, 5.70631912623773e-13,
      2.1925243135066329e-13, -6.638389800666112e-14, -2.8945792756603475e-13,
      -4.54813821740924e-13, -5.684285574655575e-13, -6.369507885613863e-13,
      -6.673116746317878e-13, -6.664070448658865e-13, -6.408477400742284e-13,
      -5.967730985081677e-13, -5.397212559520748e-13, -4.745491439250025e-13,
      -4.0539471396339453e-13, -3.3567391352432194e-13, -2.6810521579095985e-13,
      -2.04754992533073e-13, -1.470976538202597e-13, -9.608520605759448e-14,
      -5.222165381361857e-14, -1.5638452637292122e-14, 1.3832021256116941e-14,
      3.6587306347933064e-14, 5.319166919865643e-14, 6.431999401716285e-14,
      7.070935175526072e-14, 7.311843883813799e-14, 7.229474225334068e-14,
      6.894902980724618e-14, 6.37365756570634e-14, 5.724440421353764e-14,
      4.99837619431491e-14, 4.2386997978201155e-14, 3.480804238083814e-14,
      2.7525707416316155e-14, 2.0749094900212704e-14, 1.462446498246648e-14,
      9.24300285381066e-15, 4.649004926544376e-15, 8.480910506230334e-16,
      -2.1848688795032927e-15, -4.49834936524122e-15, -6.157451276179329e-15,
      -7.237977184342013e-15, -7.821354049491458e-15, -7.990414296345586e-15,
      -7.826011999434792e-15, -7.404424655007319e-15, -6.795472148460915e-15,
      -6.061272174367825e-15, -5.255544623288558e-15, -4.423375386794723e-15,
      -3.601351741826627e-15, -2.8179861003649927e-15, -2.094351664734456e-15,
      -1.444861712898955e-15, -8.781332459813816e-16, -3.978850528069966e-16,
      -3.829469768174095e-18, 3.07474084292817e-16, 5.418275785255548e-16,
      7.0668131198955615e-16, 8.105094037556963e-16, 8.62278486877633e-16,
      8.710098077096329e-16, 8.454314073274801e-16, 7.937144024578911e-16,
      7.232855064432774e-16, 6.407067417330634e-16, 5.51612693832841e-16,
      4.606955414024898e-16, 3.717283702666053e-16, 2.876178486178386e-16,
      2.1047812306220797e-16, 1.4171871643077097e-16, 8.214020489638958e-17,
      3.2032470883358256e-17, -8.728673145438807e-18, -4.0589749642753054e-17,
      -6.423516132560689e-17, -8.051163402800966e-17, -9.036250227044379e-17,
      -9.477221696483528e-17, -9.47209937565051e-17, -9.114915958583387e-17,
      -8.493048655183184e-17, -7.685361664632898e-17, -6.761056785996853e-17,
      -5.779126051502386e-17, -4.788300145993552e-17, -3.8273902404089715e-17,
      -2.9259277352152195e-17, -2.1050153935962848e-17, -1.3783136638376994e-17,
      -7.530969800178042e-18, -2.313259391605073e-18, 1.893079578638921e-18,
      5.1439818012374886e-18, 7.519235941732305e-18, 9.114491962049156e-18,
      1.0034358466985652e-17, 1.0386618119113812e-17, 1.02775415824325e-17,
      9.808243610201703e-18, 9.071997900428405e-18, 8.15240913706978e-18,
      7.12233004653871e-18, 6.043407119978207e-18, 4.966139689526852e-18,
      3.9303421652991945e-18, 2.9659073897859965e-18, 2.0937793062804324e-18,
      1.3270546463515335e-18, 6.721454224101241e-19, 1.299460941849152e-19,
      -3.030390883902685e-19, -6.336422180378588e-19, -8.710751724081628e-19,
      -1.0260855578094586e-18, -1.1102329563192786e-18, -1.1352871518134811e-18,
      -1.112745110362558e-18, -1.0534597413731926e-18, -9.673707654388199e-19,
      -8.6332624318375775e-19, -7.489823471213852e-19, -6.307686537782464e-19,
      -5.13906467008742e-19, -4.024683335591775e-19, -2.994678666889524e-19,
      -2.0697015334587624e-19, -1.2621429867460924e-19, -5.774098590758074e-20,
      -1.5192409007721657e-21, 4.293215740539056e-20, 7.643202072231968e-20,
      1.000352078345277e-19, 1.1494364175166884e-19, 1.2243056273264374e-19,
      1.23778056838609e-19, 1.202273963913542e-19, 1.1294134858961435e-19,
      1.029773398326516e-19, 9.127019259684888e-20, 7.862306475575801e-20,
      6.570520365134121e-20, 5.305516507611498e-20, 4.1088227539934566e-20,
      3.0106842869290574e-20, 2.0313094787388417e-20, 1.1822278589152476e-20,
      4.676859796815377e-21, -1.1397883338365305e-21, -5.6903340963434715e-21,
      -9.071465487018587e-21, -1.1403128990714613e-20, -1.28191650076453e-20,
      -1.3459395249213856e-20, -1.346315165955157e-20, -1.2964184873418814e-20,
      -1.2086851829548402e-20, -1.0943455585513438e-20, -9.632594130278816e-21,
      -8.23836749798178e-21, -6.830292188306085e-21, -5.4637772927391094e-21,
      -4.181026413525851e-21, -3.0122421788725532e-21, -1.977024792565292e-21,
      -1.085871659597686e-21, -3.4170091611697004e-22, 2.586629651177684e-22,
      7.23088902164855e-22, 1.0628585182538844e-21, 1.2915276328742534e-21,
      1.4239424667128439e-21, 1.4754146921685892e-21, 1.4610526699300994e-21,
      1.3952409486403115e-21, 1.2912562438330094e-21, 1.1610055029894526e-21,
      1.0148701397404275e-21, 8.616399103887566e-22, 7.085200405199056e-22,
      5.611959268825068e-22, 4.239408906055516e-22, 2.997539080811057e-22,
      1.9051587843408755e-22, 9.71547022019764e-23, 1.9811163209540167e-23,
      -4.200073972927071e-23, -8.924382121378446e-23, -1.2322150961705784e-22,
      -1.4545760008355183e-22, -1.5759308736263243e-22, -1.6130033178523293e-22,
      -1.5821411219052632e-22, -1.4987858389310656e-22, -1.3770877336737196e-22,
      -1.229649872130568e-22, -1.0673837279671528e-22, -8.994582299466857e-23,
      -7.33324493434781e-23, -5.74799392794547e-23, -4.281924809686111e-23,
      -2.9646240578083705e-23, -1.813907864231204e-23, -8.37633946864444e-24,
      -3.5503494912084178e-25, 5.9921185726978915e-24, 1.078066641535489e-23,
      1.4159955322556737e-23, 1.630045494401569e-23, 1.73829589065249e-23,
      1.7589672684103248e-23, 1.709712361596229e-23, 1.607077408800863e-23,
      1.4661180426198873e-23, 1.300151554490394e-23, 1.1206260826975609e-23,
      9.370870041480283e-24, 7.572213347944737e-24, 5.869620732248926e-24,
      4.306359874438778e-24, 2.911401962121686e-24, 1.7013490432619633e-24,
      6.824170808954151e-25, -1.476109400831043e-25, -7.975283698102221e-25,
      -1.2809936409493462e-24, -1.6149976208418368e-24, -1.8185291366149214e-24,
      -1.9114467368158197e-24, -1.9135553679565694e-24, -1.8438792827392006e-24,
      -1.720117007457052e-24, -1.5582603899145475e-24, -1.372357414008924e-24,
      -1.1743973804993862e-24, -9.742969933076966e-25, -7.799666432685325e-25,
      -5.974375475466414e-25, -4.310322029175587e-25, -2.835626864320642e-25,
      -1.5654355235729042e-25, -5.0408317654752295e-26, 3.527928990869111e-26,
      1.0162609501596656e-25, 1.5022715061228057e-25, 1.8300356590222824e-25,
      2.0206229334696905e-25, 2.095784827143564e-25, 2.077000409784722e-25,
      1.9847328497086622e-25, 1.8378802146100844e-25, 1.6534001537297781e-25,
      1.4460858757344369e-25, 1.2284699472456536e-25, 1.0108326098370022e-25,
      8.012923185841276e-26, 6.059578303209894e-26, 4.291232236564877e-26,
      2.7348954875548065e-26, 1.4039924141807046e-26, 3.007187689671644e-27,
      -5.8167807750088625e-27, -1.2567649747749849e-26, -1.7429837322409003e-26,
      -2.0619380596799238e-26, -2.2369229906050606e-26, -2.2917006049296917e-26,
      -2.2495158821355166e-26, -2.1323388612610852e-26, -1.960313754858756e-26,
      -1.7513920195418725e-26, -1.5211243652799506e-26, -1.2825860228817575e-26,
      -1.0464100232218838e-26, -8.209045257976875e-27, -6.12232141488061e-27,
      -4.246315227064627e-27, -2.606640681230535e-27, -1.214712611332847e-27,
      -7.030811035544539e-29, 8.359770066709499e-28, 1.5204461928634656e-27,
      2.0042429922052497e-27, 2.3115445892327567e-27, 2.468022269283616e-27,
      2.4995700382357875e-27, 2.4312923904221312e-27, 2.2867344474961407e-27,
      2.087332184265822e-27, 1.8520569399644895e-27, 1.597226597774027e-27,
      1.3364554113329659e-27, 1.0807151825712094e-27, 8.384820858174025e-28,
      6.159456474598903e-28, 4.172590147431235e-28, 2.4481249746733225e-28,
      9.951528865183525e-29, -1.8926859495965933e-29, -1.1174750576165424e-28,
      -1.8087593392656607e-28, -2.287188702967979e-28, -2.5797031983061448e-28,
      -2.714506954316962e-28, -2.719750757825823e-28, -2.622493757541168e-28,
      -2.4479242858466866e-28, -2.2188143387677773e-28, -1.955178899095984e-28,
      -1.6741097123155536e-28, -1.3897530140428642e-28, -1.1134017572409355e-28,
      -8.536748142548523e-29, -6.167581763580121e-29, -4.066861164162327e-29,
      -2.2564342559822705e-29, -7.42730229445257e-30, 4.802366075152541e-30,
      1.4280320363837592e-29, 2.1232063064615472e-29, 2.592984141761981e-29,
      2.8672664117962517e-29, 2.9769524053067054e-29, 2.9525778128425457e-29,
      2.823252783360845e-29, 2.61587652167159e-29, 2.3545995340702093e-29,
      2.0605014746377367e-29, 1.751451248287711e-29, 1.442116246080446e-29,
      1.1440889965506751e-29, 8.661018112259474e-30, 6.143029111844557e-30,
      3.925708067576786e-30, 2.028471626247155e-30, 4.547184978124151e-31,
      -8.049276705657101e-31, -1.7695813222200986e-30, -2.465333830613377e-30,
      -2.922813071755911e-30, -3.1750872430060456e-30, -3.255918661268002e-30,
      -3.19835901966148e-30, -3.033666643977584e-30, -2.7905183788368802e-30,
      -2.49448350674484e-30, -2.16772419130266e-30, -1.8288859602949338e-30,
      -1.4931423342623839e-30, -1.1723595101782247e-30, -8.75349705316661e-31,
      -6.081850653087931e-31, -3.7454769279409683e-31, -1.7609514846078125e-31,
      -1.282454305013658e-32, 1.1657805733755563e-31, 2.1441284961698895e-31,
      2.836730643581499e-31, 3.2778758342869354e-31, 3.5040145947236663e-31,
      3.551945467403918e-31, 3.4573698785127795e-31, 3.2537919108757996e-31,
      2.971731445538872e-31, 2.6382140863736862e-31, 2.276498659363702e-31,
      1.9060024689640114e-31, 1.5423854973123983e-31, 1.1977569714489415e-31,
      8.809708555810308e-32, 5.979805452978938e-32, 3.5222708611868684e-32,
      1.4503939053041647e-32, -2.397099140984388e-33, -1.5653412000944224e-32,
      -2.553749403927901e-32, -3.2390240397631275e-32, -3.6593848623862054e-32,
      -3.854888108277632e-32, -3.8655467915079023e-32, -3.7298480316482607e-32,
      -3.483639169720607e-32, -3.159346620554886e-32, -2.7854865887864636e-32,
      -2.3864244925976164e-32, -1.982339745402456e-32, -1.589354008726756e-32,
      -1.219783746434987e-32, -8.824815161512771e-33, -5.832346068121032e-33,
      -3.2519409683579145e-33, -1.0931193739087455e-33, 6.523192275309522e-34,
      2.0062619996880483e-33, 3.0005875928634138e-33, 3.673875803411136e-33,
      4.068559567816458e-33, 4.228532419751527e-33, 4.1972047961972045e-33,
      4.0159872360598445e-33, 3.7231672181682696e-33, 3.353138705111751e-33,
      2.935938920717691e-33, 2.4970450003669103e-33, 2.0573834277404376e-33,
      1.6335071437393985e-33, 1.2378984525489928e-33, 8.793599688163298e-34,
      5.634605100445042e-34, 2.930077519981176e-34, 6.85243956365191e-35,
      -1.1129064556881446e-34, -2.491300807501536e-34, -3.486851059039803e-34,
      -4.142977438795209e-34, -4.5066205512950025e-34, -4.625750780680652e-34,
      -4.547363231930914e-34, -4.315930823035583e-34, -3.9722768218037785e-34,
      -3.552820625648197e-34, -3.0891463865780013e-34, -2.60784264915993e-34,
      -2.1305619689031673e-34, -1.6742520125872754e-34, -1.2515134511619888e-34,
      -8.710446297689932e-35, -5.381381819913385e-35, -2.552001464119669e-35,
      -2.2267498128775762e-36, 1.6249486593989008e-35, 3.023318943901309e-35,
      4.014808235807997e-35, 4.6480446421765687e-35, 4.97478308298625e-35,
      5.047317998693909e-35, 4.9164202145528e-35, 4.629764616181004e-35,
      4.2308040071194023e-35, 3.7580372729244513e-35, 3.2446161884991065e-35,
      2.71823428958394e-35, 2.2012426155761082e-35, 1.7109402831725617e-35,
      1.259992279701785e-35, 8.569321376376858e-36, 5.067128937148204e-36,
      2.1127563449284634e-36, -2.9889267677630636e-37, -2.192076146066677e-36,
      -3.6052785100782384e-36, -4.586783151148158e-36, -5.190810951085745e-36,
      -5.4742497977242613e-36, -5.493972651715834e-36, -5.304720349931804e-36,
      -4.9575092789475514e-36, -4.498512870342961e-36, -3.968358943210978e-36,
      -3.401781611383115e-36, -2.8275661455870056e-36, -2.268727219242838e-36,
      -1.7428647972094618e-36, -1.2626470297001674e-36, -8.363754309098095e-37,
      -4.685939616971297e-37, -1.6071007271412888e-37, 8.83979617747448e-38,
      2.818071780579109e-37, 4.2402387954973005e-37, 5.20514967637796e-37,
      5.773020502828803e-37, 6.006202546777854e-37, 5.966408527517908e-37,
      5.712546167164713e-37, 5.29911206220931e-37, 4.775087880922563e-37,
      4.183274367679978e-37, 3.559995885374811e-37, 2.9351085635806972e-37,
      2.3322478812026643e-37, 1.769256085035777e-37, 1.258735678360502e-37,
      8.086818239244156e-38, 4.231534833892969e-38, 1.0295012310703834e-38,
      -1.53732413659415e-38, -3.506869376732306e-38, -4.931351705650285e-38,
      -5.872324784143642e-38, -6.396419830510234e-38, -6.571793345310203e-38,
      -6.465265238618031e-38, -6.140108820769048e-38, -5.654437922026682e-38,
      -5.060125658587651e-38, -4.4021833166393513e-38, -3.718525718990612e-38,
      -3.040050520156488e-38, -2.390962434620334e-38, -1.7892787854701903e-38,
      -1.2474593824171952e-38, -7.731110917662177e-39, -3.697251181341459e-39,
      -3.741262924324662e-40, 2.2638835320509693e-39, 4.2625510630982316e-39,
      5.681856112708949e-39, 6.590760728767927e-39, 7.062748621160174e-39,
      7.172134352023597e-39, 6.991117960785597e-39, 6.587538021344258e-39,
      6.023259977446028e-39, 5.3531262031486915e-39, 4.624388765902484e-39,
      3.8765444970918116e-39, 3.141493888244072e-39, 2.443949767931566e-39,
      1.8020279784117972e-39, 1.2279597443598892e-39, 7.288735756347482e-40,
      3.0760292579077444e-40, -3.6515922836886376e-41, -3.068834382420091e-40,
      -5.089343509617963e-40, -6.49507102539454e-40, -7.362936057058865e-40,
      -7.77372935680436e-40, -7.808286814834645e-40, -7.544466241734564e-40,
      -7.054871153332782e-40, -6.405249278023631e-40, -5.653483556584822e-40,
      -4.8490886133921755e-40, -4.0331251389947826e-40, -3.238447462860721e-40,
      -2.4902049953351503e-40, -1.8065254393168155e-40, -1.19931606250483e-40,
      -6.75128321596683e-41, -2.3604027661305586e-41, 1.194798451943253e-41,
      3.957571657920756e-41, 5.99161289322007e-41, 7.374387467876517e-41,
      8.191345352591917e-41, 8.531055755527905e-41, 8.481248913808996e-41,
      8.125721824992966e-41, 7.542041537785234e-41, 6.799963850746433e-41,
      5.960475877515174e-41, 5.075366935047081e-41, 4.1872326132792e-41,
      3.329820749057459e-41, 2.528634481653354e-41, 1.8017158262550404e-41,
      1.1605425779181707e-41, 6.109812670591539e-42, 1.5424884723807048e-42,
      -2.1215457534846924e-42, -4.9357065291026164e-42, -6.973858472451061e-42,
      -8.323258950802807e-42, -9.078487611282208e-42, -9.336379925778545e-42,
      -9.19194243001869e-42, -8.735195432445766e-42, -8.048865797446537e-42,
      -7.206836996170406e-42, -6.273254908873499e-42, -5.302184770250441e-42,
      -4.337716107301361e-42, -3.414417516292553e-42, -2.5580507305476907e-42,
      -1.7864628119539893e-42, -1.110585732837818e-42, -5.354834908323293e-43,
      -6.139771902582469e-44, 3.152468744909173e-43, 6.009062720412926e-43,
      8.040704632462544e-43, 9.34519041065231e-43, 1.0026853140776551e-42,
      1.0191298143347446e-42, 9.941198166488138e-43, 9.373082447678674e-43,
      8.575030281052036e-43, 7.625164803929021e-43, 6.5908348205246535e-43,
      5.5283704283492405e-43, 4.483300851056936e-43, 3.490929125267186e-43,
      2.5771671469460904e-43, 1.7595451750890254e-43, 1.04832145700708e-43,
      4.4762954428425343e-44, -4.338740353880678e-45, -4.2949487934105116e-44,
      -7.183671247104548e-44, -9.196891252735931e-44, -1.0443725486502082e-43,
      -1.1038908870834203e-43, -1.1097335156677057e-43, -1.072974004498868e-43,
      -1.0039447441025952e-43, -9.120076503476734e-44, -8.054092858300333e-44,
      -6.912080409694977e-44, -5.752609309394997e-44, -4.622579596881422e-44,
      -3.55792763525515e-44, -2.584592686580931e-44, -1.719652867081656e-44,
      -9.725525002313632e-45, -3.463558828345098e-45, 1.6102483511433832e-45,
      5.556679890775992e-45, 8.465763362289371e-45, 1.0447262240647586e-44,
      1.162243199603121e-44, 1.2117081956451245e-44, 1.2055926922398962e-44,
      1.1558167800151565e-44, 1.0734207476170595e-44, 9.683385558340928e-45,
      8.49260210528417e-45, 7.235694643457112e-45, 5.973433234032925e-45,
      4.7540037585424166e-45, 3.613858702160655e-45, 2.5788264077652206e-45,
      1.6653830728331614e-45, 8.82005831503769e-46, 2.3053941888910173e-46,
      -2.924773915280821e-46, -6.945665673623268e-46, -9.861761529086197e-46,
      -1.1796752064399366e-45, -1.2884885465161086e-45, -1.3263741550040088e-45,
      -1.3068401669327006e-45, -1.2426938190222957e-45, -1.1457114137288195e-45,
      -1.0264161459868464e-45, -8.939493853655787e-46, -7.560205529135838e-46,
      -6.189209279514329e-46, -4.875874215582846e-46, -3.657034279960303e-46,
      -2.55825194295824e-46, -1.5952362861559925e-46, -7.753301272235897e-47,
      -9.899621929180768e-48, 4.387526889084488e-47, 8.470214379856365e-47,
      1.1378268220483497e-46, 1.3250370108972203e-46, 1.4234650558175917e-46,
      1.4481178613526438e-46, 1.4135959185548393e-46, 1.3336344641809393e-46,
      1.2207734215093699e-46, 1.0861413371245769e-46, 9.393373883753416e-47,
      7.883952300407043e-47, 6.3981281211267e-47, 4.986331791334403e-47,
      3.685625140839864e-47, 2.521131910302163e-47, 1.5076124231782751e-47,
      6.510933733582814e-48, -4.9519627540030445e-49, -6.009032354438788e-48,
      -1.013893151109517e-47, -1.3022052336750225e-47, -1.4813182668626304e-47,
      -1.5675260247506003e-47, -1.5771583635803262e-47, -1.525964821980251e-47,
      -1.4286495244193436e-47, -1.2985428989777334e-47, -1.1473936677472972e-47,
      -9.852635639353907e-48, -8.205070909073293e-48, -6.598191880950242e-48,
      -5.083347415855385e-48, -3.697653232239991e-48, -2.465602288160538e-48,
      -1.4008069996971618e-48, -5.077806088816026e-49, 2.1631694741011157e-49,
      7.80026289362757e-49, 1.1960709954601212e-48, 1.480003301698785e-48,
      1.649029237908737e-48, 1.72101925546145e-48, 1.7137022115614348e-48,
      1.6440341885045574e-48, 1.5277289007269083e-48, 1.3789332048733836e-48,
      1.2100292861762736e-48, 1.0315442479920551e-48, 8.52147881504079e-49,
      6.7872014887789186e-49, 5.1647119881736885e-49, 3.690983892190714e-49,
      2.389666778768167e-49, 1.2730074013518608e-49, 3.43791840462797e-50,
      -4.0276818933902143e-50, -9.772634547075586e-50, -1.3944717301314497e-49,
      -1.6719260607747338e-49, -1.8286814881955787e-49, -1.8842844685642917e-49,
      -1.8579407664669392e-49, -1.767871094901094e-49, -1.6308390295896568e-49,
      -1.4618325577237386e-49, -1.2738788145964513e-49, -1.077970897280315e-49,
      -8.830859069923047e-50, -6.962743563313922e-50, -5.228025955655211e-50,
      -3.6633179477598257e-50, -2.2911911904232153e-50, -1.122289278586825e-50,
      -1.5744016119078754e-51, 6.103098755572483e-51, 1.193799984357692e-50,
      1.6100380079030433e-50, 1.8786894537549014e-50, 2.0207852503078734e-50,
      2.0576504377673028e-50, 2.0100472580654067e-50, 1.8975194893727572e-50,
      1.7379201352544294e-50, 1.5471015060830055e-50, 1.3387450857306126e-50,
      1.1243081207663636e-50, 9.130643692983492e-51, 7.122176825370502e-51,
      5.270688632088826e-51, 3.612183725179472e-51, 2.1678978712272084e-51,
      9.466131016872511e-52, -5.304989090225727e-53, -8.404427576836007e-52,
      -1.4308637575393236e-51, -1.8437364601501885e-51, -2.101017783167315e-51,
      -2.225846471567457e-51, -2.2414318263699912e-51, -2.1701735734842098e-51,
      -2.0329970623403847e-51, -1.848883281952151e-51, -1.6345702339220688e-51,
      -1.404400748599349e-51, -1.1702916118528545e-51, -9.417996341834818e-52,
      -7.26261805886278e-52, -5.289887280203938e-52, -3.534929004266174e-52,
      -2.017360231220063e-52, -7.438209147020024e-53, 2.8954369559599445e-53,
      1.094731641533734e-52, 1.6897238967462257e-52, 2.096555411536158e-52,
      2.339640798676142e-52, 2.4443635147931516e-52, 2.435925705672511e-52,
      2.3384467614287413e-52, 2.174291869786583e-52, 1.9636072171952707e-52,
      1.7240356952975226e-52, 1.4705857400930413e-52, 1.2156259802466603e-52,
      9.689794284467224e-53, 7.380927639770564e-53, 5.282585988835669e-53,
      3.4287129541279435e-53, 1.8369973938772453e-53, 5.116333308312787e-54,
      -5.53997592254163e-54, -1.3748048401223438e-53, -1.9716889865838471e-53,
      -2.3695021907246494e-53, -2.595290390961959e-53, -2.676823488366363e-53,
      -2.6414077345822425e-53, -2.514965235412864e-53, -2.3213586966915507e-53,
      -2.0819349972959626e-53, -1.8152585726271313e-53, -1.5370046194062118e-53,
      -1.2599824827996885e-53, -9.942609683815391e-54, -7.473694658176057e-54,
      -5.245514379848778e-54, -3.290498091875295e-54, -1.6240690223466821e-54
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.8359639206095842, -0.20702245002253106, -0.18692072689184613, -0.16407889157154187,
      -0.13992495177732783, -0.11563543278744251, -0.09214441690167836, -0.0701597200856516,
      -0.05018410130171476, -0.03253965510846536, -0.017393808481765353,
      -0.0047856151750482745, 0.005348695278290318, 0.013151709641994306,
      0.018822935010068164, 0.02259938684311648, 0.024738862181491027, 0.025505956780596615,
      0.025160770256987857, 0.023950154881212535, 0.022101299190047923,
      0.019817394473673873, 0.017275107539465043, 0.014623573998622436,
      0.011984629745842055, 0.00945401153173209, 0.007103278006792743, 0.004982228055916482,
      0.0031216216514714885, 0.0015360381473892857, 0.00022673653885468435,
      -0.0008155893620444013, -0.0016082414473013956, -0.0021741902621407842,
      -0.0025400261414342522, -0.002734206398712081, -0.0027856016374629374,
      -0.0027223324567927157, -0.002570878833070933, -0.002355438020585335,
      -0.0020975026306838647, -0.0018156283019956803, -0.0015253597404571405,
      -0.0012392845713359436, -0.00096718610860039, -0.0007162685375180933,
      -0.0004914308821506845, -0.0002955692811455901, -0.00012989034735970016,
      5.7784029836179765e-06, 0.00011269200855620468, 0.00019291354286737908,
      0.0002490672179872915, 0.0002841225058066582, 0.00030121080027165217,
      0.0003034746103651769, 0.0002939480629467868, 0.000275466584099782,
      0.00025060298815935447, 0.00022162680194484982, 0.00019048345283717723,
      0.00015878991798878368, 0.00012784353405550676, 9.864087051634753e-05,
      7.190384593767832e-05, 4.811058986670249e-05, 2.7528901455766294e-05,
      1.025051115702379e-05, -3.7753007929107074e-06, -1.470984715435652e-05,
      -2.279575492668924e-05, -2.8330814208046086e-05, -3.164527170328246e-05,
      -3.3082690795941506e-05, -3.2984341484829415e-05, -3.167695960564365e-05,
      -2.9463622924505556e-05, -2.661742858552598e-05, -2.3377618327854013e-05,
      -1.9947781011142187e-05, -1.6495762473566087e-05, -1.3154926923105558e-05,
      -1.0026438522038022e-05, -7.1822634915268575e-06, -4.66862924097042e-06,
      -2.5097154177136297e-06, -7.113904799580162e-07, 7.351550903823734e-07,
      1.8499926451044281e-06, 2.6613379943851084e-06, 3.202786170990874e-06,
      3.5109273502943245e-06, 3.6233526281656225e-06, 3.5770419935368507e-06,
      3.407114195518082e-06, 3.1459089831963294e-06, 2.822366015051177e-06,
      2.461661185101206e-06, 2.085059773252489e-06, 1.709946282859148e-06,
      1.3499926846026397e-06, 1.0154296786262535e-06, 7.133891904833072e-07,
      4.482903469970174e-07, 2.2224539551275996e-07, 3.5466237712086035e-08,
      -1.1334370767927371e-07, -2.266238364470544e-07, -3.07625007242825e-07,
      -3.6011764119126993e-07, -3.8814185628336094e-07, -3.9580010946793886e-07,
      -3.870911350995524e-07, -3.65782683612197e-07, -3.353196428332549e-07,
      -2.9876352415127583e-07, -2.587589716017567e-07, -2.175228578507014e-07,
      -1.768516221468864e-07, -1.3814273923024412e-07, -1.0242654615954058e-07,
      -7.04050615669112e-08, -4.249487913109101e-08, -1.887167904987431e-08,
      4.856423316568823e-10, 1.575278965118745e-08, 2.722099555219966e-08,
      3.526186011094334e-08, 4.029659049734785e-08, 4.276986202894524e-08,
      4.3128302958447444e-08, 4.180343246127738e-08, 3.919875113924827e-08,
      3.568059179536233e-08, 3.157228055826313e-08, 2.715112966540324e-08,
      2.2647778343102647e-08, 1.824741240358593e-08, 1.4092421877059498e-08,
      1.028609508736224e-08, 6.896993419123557e-09, 3.963700483982002e-09,
      1.4996898677422306e-09, -5.018949658618869e-10, -2.06370834006824e-09,
      -3.220034493749794e-09, -4.013062890578236e-09, -4.4896523436721775e-09,
      -4.698601766781765e-09, -4.688422728229721e-09, -4.505591290373054e-09,
      -4.1932434854333475e-09, -3.790269738170378e-09, -3.330758073376758e-09,
      -2.8437334950259243e-09, -2.353140949914439e-09, -1.8780212697305453e-09,
      -1.432832936517726e-09, -1.0278769996007022e-09, -6.697876029551996e-10,
      -3.620560331647496e-10, -1.055616989192718e-10, 1.0091121205439989e-10,
      2.6018764768328474e-10, 3.762578689398233e-10, 4.538835460034114e-10,
      4.982579576350295e-10, 5.147215808801403e-10, 5.08532022392086e-10,
      4.846854373144064e-10, 4.47785262491789e-10, 4.019532047015264e-10,
      3.507769135387382e-10, 2.9728857271224427e-10, 2.43968703813768e-10,
      1.9276973697147333e-10, 1.4515431140180756e-10, 1.0214377931038359e-10,
      6.437295841100872e-11, 3.214777730099769e-11, 5.503056008342963e-12,
      -1.574176089779826e-11, -3.1930565768793355e-11, -4.352340680819988e-11,
      -5.105490164417685e-11, -5.509861906049933e-11, -5.6237501324831574e-11,
      -5.504015910904345e-11, -5.204268739659801e-11, -4.773551890344606e-11,
      -4.2554745435426127e-11, -3.687729084968581e-11, -3.101930534588953e-11,
      -2.5237163301930383e-11, -1.973047976286123e-11, -1.464660847197653e-11,
      -1.0086142086559023e-11, -6.1089986965556466e-12, -2.7407443921303943e-12,
      2.1133493759965476e-14, 2.2012259705271137e-12, 3.840641117291158e-12,
      4.991996908309507e-12, 5.715038252034652e-12, 6.0729103376888315e-12,
      6.129089163424683e-12, 5.944945435236547e-12, 5.577899421393634e-12,
      5.080111237776689e-12, 4.497642757911339e-12, 3.870023180866378e-12,
      3.230149538740954e-12, 2.60445539405015e-12, 2.0132850203468e-12,
      1.4714158897699737e-12, 9.88678789826591e-13, 5.70631912623773e-13,
      2.1925243135066329e-13, -6.638389800666112e-14, -2.8945792756603475e-13,
      -4.54813821740924e-13, -5.684285574655575e-13, -6.369507885613863e-13,
      -6.673116746317878e-13, -6.664070448658865e-13, -6.408477400742284e-13,
      -5.967730985081677e-13, -5.397212559520748e-13, -4.745491439250025e-13,
      -4.0539471396339453e-13, -3.3567391352432194e-13, -2.6810521579095985e-13,
      -2.04754992533073e-13, -1.470976538202597e-13, -9.608520605759448e-14,
      -5.222165381361857e-14, -1.5638452637292122e-14, 1.3832021256116941e-14,
      3.6587306347933064e-14, 5.319166919865643e-14, 6.431999401716285e-14,
      7.070935175526072e-14, 7.311843883813799e-14, 7.229474225334068e-14,
      6.894902980724618e-14, 6.37365756570634e-14, 5.724440421353764e-14,
      4.99837619431491e-14, 4.2386997978201155e-14, 3.480804238083814e-14,
      2.7525707416316155e-14, 2.0749094900212704e-14, 1.462446498246648e-14,
      9.24300285381066e-15, 4.649004926544376e-15, 8.480910506230334e-16,
      -2.1848688795032927e-15, -4.49834936524122e-15, -6.157451276179329e-15,
      -7.237977184342013e-15, -7.821354049491458e-15, -7.990414296345586e-15,
      -7.826011999434792e-15, -7.404424655007319e-15, -6.795472148460915e-15,
      -6.061272174367825e-15, -5.255544623288558e-15, -4.423375386794723e-15,
      -3.601351741826627e-15, -2.8179861003649927e-15, -2.094351664734456e-15,
      -1.444861712898955e-15, -8.781332459813816e-16, -3.978850528069966e-16,
      -3.829469768174095e-18, 3.07474084292817e-16, 5.418275785255548e-16,
      7.0668131198955615e-16, 8.105094037556963e-16, 8.62278486877633e-16,
      8.710098077096329e-16, 8.454314073274801e-16, 7.937144024578911e-16,
      7.232855064432774e-16, 6.407067417330634e-16, 5.51612693832841e-16,
      4.606955414024898e-16, 3.717283702666053e-16, 2.876178486178386e-16,
      2.1047812306220797e-16, 1.4171871643077097e-16, 8.214020489638958e-17,
      3.2032470883358256e-17, -8.728673145438807e-18, -4.0589749642753054e-17,
      -6.423516132560689e-17, -8.051163402800966e-17, -9.036250227044379e-17,
      -9.477221696483528e-17, -9.47209937565051e-17, -9.114915958583387e-17,
      -8.493048655183184e-17, -7.685361664632898e-17, -6.761056785996853e-17,
      -5.779126051502386e-17, -4.788300145993552e-17, -3.8273902404089715e-17,
      -2.9259277352152195e-17, -2.1050153935962848e-17, -1.3783136638376994e-17,
      -7.530969800178042e-18, -2.313259391605073e-18, 1.893079578638921e-18,
      5.1439818012374886e-18, 7.519235941732305e-18, 9.114491962049156e-18,
      1.0034358466985652e-17, 1.0386618119113812e-17, 1.02775415824325e-17,
      9.808243610201703e-18, 9.071997900428405e-18, 8.15240913706978e-18,
      7.12233004653871e-18, 6.043407119978207e-18, 4.966139689526852e-18,
      3.9303421652991945e-18, 2.9659073897859965e-18, 2.0937793062804324e-18,
      1.3270546463515335e-18, 6.721454224101241e-19, 1.299460941849152e-19,
      -3.030390883902685e-19, -6.336422180378588e-19, -8.710751724081628e-19,
      -1.0260855578094586e-18, -1.1102329563192786e-18, -1.1352871518134811e-18,
      -1.112745110362558e-18, -1.0534597413731926e-18, -9.673707654388199e-19,
      -8.6332624318375775e-19, -7.489823471213852e-19, -6.307686537782464e-19,
      -5.13906467008742e-19, -4.024683335591775e-19, -2.994678666889524e-19,
      -2.0697015334587624e-19, -1.2621429867460924e-19, -5.774098590758074e-20,
      -1.5192409007721657e-21, 4.293215740539056e-20, 7.643202072231968e-20,
      1.000352078345277e-19, 1.1494364175166884e-19, 1.2243056273264374e-19,
      1.23778056838609e-19, 1.202273963913542e-19, 1.1294134858961435e-19,
      1.029773398326516e-19, 9.127019259684888e-20, 7.862306475575801e-20,
      6.570520365134121e-20, 5.305516507611498e-20, 4.1088227539934566e-20,
      3.0106842869290574e-20, 2.0313094787388417e-20, 1.1822278589152476e-20,
      4.676859796815377e-21, -1.1397883338365305e-21, -5.6903340963434715e-21,
      -9.071465487018587e-21, -1.1403128990714613e-20, -1.28191650076453e-20,
      -1.3459395249213856e-20, -1.346315165955157e-20, -1.2964184873418814e-20,
      -1.2086851829548402e-20, -1.0943455585513438e-20, -9.632594130278816e-21,
      -8.23836749798178e-21, -6.830292188306085e-21, -5.4637772927391094e-21,
      -4.181026413525851e-21, -3.0122421788725532e-21, -1.977024792565292e-21,
      -1.085871659597686e-21, -3.4170091611697004e-22, 2.586629651177684e-22,
      7.23088902164855e-22, 1.0628585182538844e-21, 1.2915276328742534e-21,
      1.4239424667128439e-21, 1.4754146921685892e-21, 1.4610526699300994e-21,
      1.3952409486403115e-21, 1.2912562438330094e-21, 1.1610055029894526e-21,
      1.0148701397404275e-21, 8.616399103887566e-22, 7.085200405199056e-22,
      5.611959268825068e-22, 4.239408906055516e-22, 2.997539080811057e-22,
      1.9051587843408755e-22, 9.71547022019764e-23, 1.9811163209540167e-23,
      -4.200073972927071e-23, -8.924382121378446e-23, -1.2322150961705784e-22,
      -1.4545760008355183e-22, -1.5759308736263243e-22, -1.6130033178523293e-22,
      -1.5821411219052632e-22, -1.4987858389310656e-22, -1.3770877336737196e-22,
      -1.229649872130568e-22, -1.0673837279671528e-22, -8.994582299466857e-23,
      -7.33324493434781e-23, -5.74799392794547e-23, -4.281924809686111e-23,
      -2.9646240578083705e-23, -1.813907864231204e-23, -8.37633946864444e-24,
      -3.5503494912084178e-25, 5.9921185726978915e-24, 1.078066641535489e-23,
      1.4159955322556737e-23, 1.630045494401569e-23, 1.73829589065249e-23,
      1.7589672684103248e-23, 1.709712361596229e-23, 1.607077408800863e-23,
      1.4661180426198873e-23, 1.300151554490394e-23, 1.1206260826975609e-23,
      9.370870041480283e-24, 7.572213347944737e-24, 5.869620732248926e-24,
      4.306359874438778e-24, 2.911401962121686e-24, 1.7013490432619633e-24,
      6.824170808954151e-25, -1.476109400831043e-25, -7.975283698102221e-25,
      -1.2809936409493462e-24, -1.6149976208418368e-24, -1.8185291366149214e-24,
      -1.9114467368158197e-24, -1.9135553679565694e-24, -1.8438792827392006e-24,
      -1.720117007457052e-24, -1.5582603899145475e-24, -1.372357414008924e-24,
      -1.1743973804993862e-24, -9.742969933076966e-25, -7.799666432685325e-25,
      -5.974375475466414e-25, -4.310322029175587e-25, -2.835626864320642e-25,
      -1.5654355235729042e-25, -5.0408317654752295e-26, 3.527928990869111e-26,
      1.0162609501596656e-25, 1.5022715061228057e-25, 1.8300356590222824e-25,
      2.0206229334696905e-25, 2.095784827143564e-25, 2.077000409784722e-25,
      1.9847328497086622e-25, 1.8378802146100844e-25, 1.6534001537297781e-25,
      1.4460858757344369e-25, 1.2284699472456536e-25, 1.0108326098370022e-25,
      8.012923185841276e-26, 6.059578303209894e-26, 4.291232236564877e-26,
      2.7348954875548065e-26, 1.4039924141807046e-26, 3.007187689671644e-27,
      -5.8167807750088625e-27, -1.2567649747749849e-26, -1.7429837322409003e-26,
      -2.0619380596799238e-26, -2.2369229906050606e-26, -2.2917006049296917e-26,
      -2.2495158821355166e-26, -2.1323388612610852e-26, -1.960313754858756e-26,
      -1.7513920195418725e-26, -1.5211243652799506e-26, -1.2825860228817575e-26,
      -1.0464100232218838e-26, -8.209045257976875e-27, -6.12232141488061e-27,
      -4.246315227064627e-27, -2.606640681230535e-27, -1.214712611332847e-27,
      -7.030811035544539e-29, 8.359770066709499e-28, 1.5204461928634656e-27,
      2.0042429922052497e-27, 2.3115445892327567e-27, 2.468022269283616e-27,
      2.4995700382357875e-27, 2.4312923904221312e-27, 2.2867344474961407e-27,
      2.087332184265822e-27, 1.8520569399644895e-27, 1.597226597774027e-27,
      1.3364554113329659e-27, 1.0807151825712094e-27, 8.384820858174025e-28,
      6.159456474598903e-28, 4.172590147431235e-28, 2.4481249746733225e-28,
      9.951528865183525e-29, -1.8926859495965933e-29, -1.1174750576165424e-28,
      -1.8087593392656607e-28, -2.287188702967979e-28, -2.5797031983061448e-28,
      -2.714506954316962e-28, -2.719750757825823e-28, -2.622493757541168e-28,
      -2.4479242858466866e-28, -2.2188143387677773e-28, -1.955178899095984e-28,
      -1.6741097123155536e-28, -1.3897530140428642e-28, -1.1134017572409355e-28,
      -8.536748142548523e-29, -6.167581763580121e-29, -4.066861164162327e-29,
      -2.2564342559822705e-29, -7.42730229445257e-30, 4.802366075152541e-30,
      1.4280320363837592e-29, 2.1232063064615472e-29, 2.592984141761981e-29,
      2.8672664117962517e-29, 2.9769524053067054e-29, 2.9525778128425457e-29,
      2.823252783360845e-29, 2.61587652167159e-29, 2.3545995340702093e-29,
      2.0605014746377367e-29, 1.751451248287711e-29, 1.442116246080446e-29,
      1.1440889965506751e-29, 8.661018112259474e-30, 6.143029111844557e-30,
      3.925708067576786e-30, 2.028471626247155e-30, 4.547184978124151e-31,
      -8.049276705657101e-31, -1.7695813222200986e-30, -2.465333830613377e-30,
      -2.922813071755911e-30, -3.1750872430060456e-30, -3.255918661268002e-30,
      -3.19835901966148e-30, -3.033666643977584e-30, -2.7905183788368802e-30,
      -2.49448350674484e-30, -2.16772419130266e-30, -1.8288859602949338e-30,
      -1.4931423342623839e-30, -1.1723595101782247e-30, -8.75349705316661e-31,
      -6.081850653087931e-31, -3.7454769279409683e-31, -1.7609514846078125e-31,
      -1.282454305013658e-32, 1.1657805733755563e-31, 2.1441284961698895e-31,
      2.836730643581499e-31, 3.2778758342869354e-31, 3.5040145947236663e-31,
      3.551945467403918e-31, 3.4573698785127795e-31, 3.2537919108757996e-31,
      2.971731445538872e-31, 2.6382140863736862e-31, 2.276498659363702e-31,
      1.9060024689640114e-31, 1.5423854973123983e-31, 1.1977569714489415e-31,
      8.809708555810308e-32, 5.979805452978938e-32, 3.5222708611868684e-32,
      1.4503939053041647e-32, -2.397099140984388e-33, -1.5653412000944224e-32,
      -2.553749403927901e-32, -3.2390240397631275e-32, -3.6593848623862054e-32,
      -3.854888108277632e-32, -3.8655467915079023e-32, -3.7298480316482607e-32,
      -3.483639169720607e-32, -3.159346620554886e-32, -2.7854865887864636e-32,
      -2.3864244925976164e-32, -1.982339745402456e-32, -1.589354008726756e-32,
      -1.219783746434987e-32, -8.824815161512771e-33, -5.832346068121032e-33,
      -3.2519409683579145e-33, -1.0931193739087455e-33, 6.523192275309522e-34,
      2.0062619996880483e-33, 3.0005875928634138e-33, 3.673875803411136e-33,
      4.068559567816458e-33, 4.228532419751527e-33, 4.1972047961972045e-33,
      4.0159872360598445e-33, 3.7231672181682696e-33, 3.353138705111751e-33,
      2.935938920717691e-33, 2.4970450003669103e-33, 2.0573834277404376e-33,
      1.6335071437393985e-33, 1.2378984525489928e-33, 8.793599688163298e-34,
      5.634605100445042e-34, 2.930077519981176e-34, 6.85243956365191e-35,
      -1.1129064556881446e-34, -2.491300807501536e-34, -3.486851059039803e-34,
      -4.142977438795209e-34, -4.5066205512950025e-34, -4.625750780680652e-34,
      -4.547363231930914e-34, -4.315930823035583e-34, -3.9722768218037785e-34,
      -3.552820625648197e-34, -3.0891463865780013e-34, -2.60784264915993e-34,
      -2.1305619689031673e-34, -1.6742520125872754e-34, -1.2515134511619888e-34,
      -8.710446297689932e-35, -5.381381819913385e-35, -2.552001464119669e-35,
      -2.2267498128775762e-36, 1.6249486593989008e-35, 3.023318943901309e-35,
      4.014808235807997e-35, 4.6480446421765687e-35, 4.97478308298625e-35,
      5.047317998693909e-35, 4.9164202145528e-35, 4.629764616181004e-35,
      4.2308040071194023e-35, 3.7580372729244513e-35, 3.2446161884991065e-35,
      2.71823428958394e-35, 2.2012426155761082e-35, 1.7109402831725617e-35,
      1.259992279701785e-35, 8.569321376376858e-36, 5.067128937148204e-36,
      2.1127563449284634e-36, -2.9889267677630636e-37, -2.192076146066677e-36,
      -3.6052785100782384e-36, -4.586783151148158e-36, -5.190810951085745e-36,
      -5.4742497977242613e-36, -5.493972651715834e-36, -5.304720349931804e-36,
      -4.9575092789475514e-36, -4.498512870342961e-36, -3.968358943210978e-36,
      -3.401781611383115e-36, -2.8275661455870056e-36, -2.268727219242838e-36,
      -1.7428647972094618e-36, -1.2626470297001674e-36, -8.363754309098095e-37,
      -4.685939616971297e-37, -1.6071007271412888e-37, 8.83979617747448e-38,
      2.818071780579109e-37, 4.2402387954973005e-37, 5.20514967637796e-37,
      5.773020502828803e-37, 6.006202546777854e-37, 5.966408527517908e-37,
      5.712546167164713e-37, 5.29911206220931e-37, 4.775087880922563e-37,
      4.183274367679978e-37, 3.559995885374811e-37, 2.9351085635806972e-37,
      2.3322478812026643e-37, 1.769256085035777e-37, 1.258735678360502e-37,
      8.086818239244156e-38, 4.231534833892969e-38, 1.0295012310703834e-38,
      -1.53732413659415e-38, -3.506869376732306e-38, -4.931351705650285e-38,
      -5.872324784143642e-38, -6.396419830510234e-38, -6.571793345310203e-38,
      -6.465265238618031e-38, -6.140108820769048e-38, -5.654437922026682e-38,
      -5.060125658587651e-38, -4.4021833166393513e-38, -3.718525718990612e-38,
      -3.040050520156488e-38, -2.390962434620334e-38, -1.7892787854701903e-38,
      -1.2474593824171952e-38, -7.731110917662177e-39, -3.697251181341459e-39,
      -3.741262924324662e-40, 2.2638835320509693e-39, 4.2625510630982316e-39,
      5.681856112708949e-39, 6.590760728767927e-39, 7.062748621160174e-39,
      7.172134352023597e-39, 6.991117960785597e-39, 6.587538021344258e-39,
      6.023259977446028e-39, 5.3531262031486915e-39, 4.624388765902484e-39,
      3.8765444970918116e-39, 3.141493888244072e-39, 2.443949767931566e-39,
      1.8020279784117972e-39, 1.2279597443598892e-39, 7.288735756347482e-40,
      3.0760292579077444e-40, -3.6515922836886376e-41, -3.068834382420091e-40,
      -5.089343509617963e-40, -6.49507102539454e-40, -7.362936057058865e-40,
      -7.77372935680436e-40, -7.808286814834645e-40, -7.544466241734564e-40,
      -7.054871153332782e-40, -6.405249278023631e-40, -5.653483556584822e-40,
      -4.8490886133921755e-40, -4.0331251389947826e-40, -3.238447462860721e-40,
      -2.4902049953351503e-40, -1.8065254393168155e-40, -1.19931606250483e-40,
      -6.75128321596683e-41, -2.3604027661305586e-41, 1.194798451943253e-41,
      3.957571657920756e-41, 5.99161289322007e-41, 7.374387467876517e-41,
      8.191345352591917e-41, 8.531055755527905e-41, 8.481248913808996e-41,
      8.125721824992966e-41, 7.542041537785234e-41, 6.799963850746433e-41,
      5.960475877515174e-41, 5.075366935047081e-41, 4.1872326132792e-41,
      3.329820749057459e-41, 2.528634481653354e-41, 1.8017158262550404e-41,
      1.1605425779181707e-41, 6.109812670591539e-42, 1.5424884723807048e-42,
      -2.1215457534846924e-42, -4.9357065291026164e-42, -6.973858472451061e-42,
      -8.323258950802807e-42, -9.078487611282208e-42, -9.336379925778545e-42,
      -9.19194243001869e-42, -8.735195432445766e-42, -8.048865797446537e-42,
      -7.206836996170406e-42, -6.273254908873499e-42, -5.302184770250441e-42,
      -4.337716107301361e-42, -3.414417516292553e-42, -2.5580507305476907e-42,
      -1.7864628119539893e-42, -1.110585732837818e-42, -5.354834908323293e-43,
      -6.139771902582469e-44, 3.152468744909173e-43, 6.009062720412926e-43,
      8.040704632462544e-43, 9.34519041065231e-43, 1.0026853140776551e-42,
      1.0191298143347446e-42, 9.941198166488138e-43, 9.373082447678674e-43,
      8.575030281052036e-43, 7.625164803929021e-43, 6.5908348205246535e-43,
      5.5283704283492405e-43, 4.483300851056936e-43, 3.490929125267186e-43,
      2.5771671469460904e-43, 1.7595451750890254e-43, 1.04832145700708e-43,
      4.4762954428425343e-44, -4.338740353880678e-45, -4.2949487934105116e-44,
      -7.183671247104548e-44, -9.196891252735931e-44, -1.0443725486502082e-43,
      -1.1038908870834203e-43, -1.1097335156677057e-43, -1.072974004498868e-43,
      -1.0039447441025952e-43, -9.120076503476734e-44, -8.054092858300333e-44,
      -6.912080409694977e-44, -5.752609309394997e-44, -4.622579596881422e-44,
      -3.55792763525515e-44, -2.584592686580931e-44, -1.719652867081656e-44,
      -9.725525002313632e-45, -3.463558828345098e-45, 1.6102483511433832e-45,
      5.556679890775992e-45, 8.465763362289371e-45, 1.0447262240647586e-44,
      1.162243199603121e-44, 1.2117081956451245e-44, 1.2055926922398962e-44,
      1.1558167800151565e-44, 1.0734207476170595e-44, 9.683385558340928e-45,
      8.49260210528417e-45, 7.235694643457112e-45, 5.973433234032925e-45,
      4.7540037585424166e-45, 3.613858702160655e-45, 2.5788264077652206e-45,
      1.6653830728331614e-45, 8.82005831503769e-46, 2.3053941888910173e-46,
      -2.924773915280821e-46, -6.945665673623268e-46, -9.861761529086197e-46,
      -1.1796752064399366e-45, -1.2884885465161086e-45, -1.3263741550040088e-45,
      -1.3068401669327006e-45, -1.2426938190222957e-45, -1.1457114137288195e-45,
      -1.0264161459868464e-45, -8.939493853655787e-46, -7.560205529135838e-46,
      -6.189209279514329e-46, -4.875874215582846e-46, -3.657034279960303e-46,
      -2.55825194295824e-46, -1.5952362861559925e-46, -7.753301272235897e-47,
      -9.899621929180768e-48, 4.387526889084488e-47, 8.470214379856365e-47,
      1.1378268220483497e-46, 1.3250370108972203e-46, 1.4234650558175917e-46,
      1.4481178613526438e-46, 1.4135959185548393e-46, 1.3336344641809393e-46,
      1.2207734215093699e-46, 1.0861413371245769e-46, 9.393373883753416e-47,
      7.883952300407043e-47, 6.3981281211267e-47, 4.986331791334403e-47,
      3.685625140839864e-47, 2.521131910302163e-47, 1.5076124231782751e-47,
      6.510933733582814e-48, -4.9519627540030445e-49, -6.009032354438788e-48,
      -1.013893151109517e-47, -1.3022052336750225e-47, -1.4813182668626304e-47,
      -1.5675260247506003e-47, -1.5771583635803262e-47, -1.525964821980251e-47,
      -1.4286495244193436e-47, -1.2985428989777334e-47, -1.1473936677472972e-47,
      -9.852635639353907e-48, -8.205070909073293e-48, -6.598191880950242e-48,
      -5.083347415855385e-48, -3.697653232239991e-48, -2.465602288160538e-48,
      -1.4008069996971618e-48, -5.077806088816026e-49, 2.1631694741011157e-49,
      7.80026289362757e-49, 1.1960709954601212e-48, 1.480003301698785e-48,
      1.649029237908737e-48, 1.72101925546145e-48, 1.7137022115614348e-48,
      1.6440341885045574e-48, 1.5277289007269083e-48, 1.3789332048733836e-48,
      1.2100292861762736e-48, 1.0315442479920551e-48, 8.52147881504079e-49,
      6.7872014887789186e-49, 5.1647119881736885e-49, 3.690983892190714e-49,
      2.389666778768167e-49, 1.2730074013518608e-49, 3.43791840462797e-50,
      -4.0276818933902143e-50, -9.772634547075586e-50, -1.3944717301314497e-49,
      -1.6719260607747338e-49, -1.8286814881955787e-49, -1.8842844685642917e-49,
      -1.8579407664669392e-49, -1.767871094901094e-49, -1.6308390295896568e-49,
      -1.4618325577237386e-49, -1.2738788145964513e-49, -1.077970897280315e-49,
      -8.830859069923047e-50, -6.962743563313922e-50, -5.228025955655211e-50,
      -3.6633179477598257e-50, -2.2911911904232153e-50, -1.122289278586825e-50,
      -1.5744016119078754e-51, 6.103098755572483e-51, 1.193799984357692e-50,
      1.6100380079030433e-50, 1.8786894537549014e-50, 2.0207852503078734e-50,
      2.0576504377673028e-50, 2.0100472580654067e-50, 1.8975194893727572e-50,
      1.7379201352544294e-50, 1.5471015060830055e-50, 1.3387450857306126e-50,
      1.1243081207663636e-50, 9.130643692983492e-51, 7.122176825370502e-51,
      5.270688632088826e-51, 3.612183725179472e-51, 2.1678978712272084e-51,
      9.466131016872511e-52, -5.304989090225727e-53, -8.404427576836007e-52,
      -1.4308637575393236e-51, -1.8437364601501885e-51, -2.101017783167315e-51,
      -2.225846471567457e-51, -2.2414318263699912e-51, -2.1701735734842098e-51,
      -2.0329970623403847e-51, -1.848883281952151e-51, -1.6345702339220688e-51,
      -1.404400748599349e-51, -1.1702916118528545e-51, -9.417996341834818e-52,
      -7.26261805886278e-52, -5.289887280203938e-52, -3.534929004266174e-52,
      -2.017360231220063e-52, -7.438209147020024e-53, 2.8954369559599445e-53,
      1.094731641533734e-52, 1.6897238967462257e-52, 2.096555411536158e-52,
      2.339640798676142e-52, 2.4443635147931516e-52, 2.435925705672511e-52,
      2.3384467614287413e-52, 2.174291869786583e-52, 1.9636072171952707e-52,
      1.7240356952975226e-52, 1.4705857400930413e-52, 1.2156259802466603e-52,
      9.689794284467224e-53, 7.380927639770564e-53, 5.282585988835669e-53,
      3.4287129541279435e-53, 1.8369973938772453e-53, 5.116333308312787e-54,
      -5.53997592254163e-54, -1.3748048401223438e-53, -1.9716889865838471e-53,
      -2.3695021907246494e-53, -2.595290390961959e-53, -2.676823488366363e-53,
      -2.6414077345822425e-53, -2.514965235412864e-53, -2.3213586966915507e-53,
      -2.0819349972959626e-53, -1.8152585726271313e-53, -1.5370046194062118e-53,
      -1.2599824827996885e-53, -9.942609683815391e-54, -7.473694658176057e-54,
      -5.245514379848778e-54, -3.290498091875295e-54, -1.6240690223466821e-54
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_3_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<3>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.7682351907303248), "design.b()[0] == 0.7682351907303248");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.7682351907303248));
    static_assert(almost_equal(design.b()[1], -2.3047055721909744), "design.b()[1] == -2.3047055721909744");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.3047055721909744));
    static_assert(almost_equal(design.b()[2], 2.3047055721909744), "design.b()[2] == 2.3047055721909744");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 2.3047055721909744));
    static_assert(almost_equal(design.b()[3], -0.7682351907303248), "design.b()[3] == -0.7682351907303248");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.7682351907303248));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.4848873200288146), "design.a()[1] == -2.4848873200288146");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.4848873200288146));
    static_assert(almost_equal(design.a()[2], 2.0815972167601067), "design.a()[2] == 2.0815972167601067");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.0815972167601067));
    static_assert(almost_equal(design.a()[3], -0.5793969890536745), "design.a()[3] == -0.5793969890536745");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.5793969890536745));
    std::cout << "max_deviation(cheby1,highpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.7682351907303248, -0.39572768794527247, -0.2777893766099664, -0.18965168009112243,
      -0.12230089276442313, -0.07007585662587207, -0.029433021997854275,
      0.0018711959356152164, 0.025315667390884894, 0.04195810032178002,
      0.052648293971822434, 0.05815303472353543, 0.05922159339964643, 0.05661205429010499,
      0.05109276509661226, 0.0434290823911441, 0.034362672332384644, 0.024588505988600483,
      0.014733103236787351, 0.005336364672830066, -0.003161615446247358,
      -0.010428104328955787, -0.016239580681655423, -0.020478245641293375,
      -0.0231238792319347, -0.02424193931271148, -0.023968918826839603, -0.0224960150676298,
      -0.020052134520639135, -0.016887171856019442, -0.013256375203799298,
      -0.009406455084383158, -0.00556392376405759, -0.0019259767665298667,
      0.0013459412221473038, 0.004129899476951966, 0.006344722201812313,
      0.007948966783221855, 0.008937982012589971, 0.009339443977769346,
      0.009207794855905756, 0.008618011958965683, 0.007659114216294095,
      0.006427774706269058, 0.005022355208777642, 0.003537616552180543,
      0.0020602912005929803, 0.000665636196860742, -0.0005849811047783766,
      -0.0016454720662829852, -0.00248545002513803, -0.003089789469361509,
      -0.0034574543800276036, -0.0035997496497194286, -0.0035381595606832844,
      -0.0033019376342699157, -0.0029256039733462245, -0.00244649102363361,
      -0.001902458158270665, -0.0013298713820681088, -0.0007619184601516194,
      -0.00022730348166736906, 0.0002506603320571987, 0.0006545637138455621,
      0.0009730442702438872, 0.001200599205691781, 0.0013371197428820381,
      0.0013872068498305972, 0.0013593315409809784, 0.001264902945251012,
      0.0011173040093475912, 0.0009309487171090881, 0.000720406704532172,
      0.0004996318057486624, 0.0002813210313548478, 7.642036291986864e-05,
      -0.00010621592118652677, -0.00026001445197490296, -0.00038073012064103153,
      -0.00046636727451061376, -0.0005169949580294106, -0.0005344792806582774,
      -0.0005221573162574643, -0.000484476833232406, -0.00042662480943943563,
      -0.0003541653285963584, -0.0002727043367341047, -0.00018759511623314337,
      -0.00010369446229888162, -2.5175654300616592e-05, 4.459939446309936e-05,
      0.00010314978246708526, 0.00014889091283338353, 0.00018110159613983197,
      0.0001998508235129757, 0.00020589314536233823, 0.00020054206771613148,
      0.00018553080826726312, 0.00016286921142653248, 0.00013470469439781944,
      0.00010319388154286148, 7.039018151746963e-05, 3.815106724648629e-05,
      8.067321567052421e-06, -1.858491109798646e-05, -4.086971056013604e-05,
      -5.8196144503149196e-05, -7.030462733067329e-05, -7.723793181145492e-05,
      -7.930031170630568e-05, -7.70083645382329e-05, -7.103722557344675e-05,
      -6.216546562110253e-05, -5.1221700770918144e-05, -3.9035449148463276e-05,
      -2.6394226462170297e-05, -1.4008295556272394e-05, -2.483909363785055e-06,
      7.694658818736971e-06, 1.6174494681888542e-05, 2.2735446755437557e-05,
      2.7284502396828212e-05, 2.9844324869408705e-05, 3.053728958778289e-05,
      2.9566418637034084e-05, 2.719459372617849e-05, 2.372334002012332e-05,
      1.9472330128799554e-05, 1.4760573393812467e-05, 9.890045240652155e-06,
      5.132288965150169e-06, 7.183009067331164e-07, -3.168199176320396e-06,
      -6.394198355454795e-06, -8.877766445052827e-06, -1.0585748832844673e-05,
      -1.1529238399239786e-05, -1.1757344147874582e-05, -1.1349795827675904e-05,
      -1.040891489700288e-05, -9.051447035682233e-06, -7.400695216714553e-06,
      -5.579320696923646e-06, -3.7030978480101407e-06, -1.8758229786864127e-06,
      -1.854921733107091e-07, 1.298216998835704e-06, 2.5251967648984564e-06,
      3.4649909234376506e-06, 4.105852472344604e-06, 4.4529566864614654e-06,
      4.5259698361035775e-06, 4.356181371650229e-06, 3.9834033367081815e-06,
      3.4528267186034567e-06, 2.8120024028956056e-06, 2.1080865269210414e-06,
      1.3854585093623758e-06, 6.837869606616829e-07, 3.658595748659945e-08,
      -5.297265635372949e-07, -9.96283941931329e-07, -1.351778200540973e-06,
      -1.5920766053238488e-06, -1.7195171453582145e-06, -1.7419603398236026e-06,
      -1.6716774479392457e-06, -1.5241533551257785e-06, -1.316876798925161e-06,
      -1.0681819577487986e-06, -7.961945876509029e-07, -5.179236971379178e-07,
      -2.4852700018798873e-07, -7.658117813032147e-10, 2.1534672521491006e-07,
      3.927106629613196e-07, 5.271328939466633e-07, 6.171716653179463e-07,
      6.638590562166183e-07, 6.703313418737806e-07, 6.413980925130142e-07,
      5.83080069952651e-07, 5.021437493265026e-07, 4.056569083582379e-07,
      3.0058551375771565e-07, 1.9344741675477536e-07, 9.003345544138877e-08,
      -4.798270877114251e-09, -8.725370191476648e-08, -1.5466243721367617e-07,
      -2.0547176975808664e-07, -2.39183828627629e-07, -2.5624634930284056e-07,
      -2.579086369543695e-07, -2.46054604317275e-07, -2.2302442868215758e-07,
      -1.9143548307341399e-07, -1.5401187136264752e-07, -1.1343025999206475e-07,
      -7.218787447612254e-08, -3.249663499573114e-08, 3.794451241849885e-09,
      3.5248251620873386e-08, 6.086096189082384e-08, 8.005846364223392e-08,
      9.267098314283343e-08, 9.889013392092025e-08, 9.92128120540747e-08,
      9.437651972835185e-08, 8.529054958362118e-08, 7.296710896426566e-08,
      5.8455944583230637e-08, 4.2785392163613296e-08, 2.691207015613386e-08,
      1.1680706924748077e-08, -2.2051224129034798e-09, -1.4201235329616093e-08,
      -2.3930526499775596e-08, -3.11810512107528e-08, -3.5895834412054125e-08,
      -3.815598935684904e-08, -3.815887231761367e-08, -3.6193035098604965e-08,
      -3.26116769265548e-08, -2.7806157078824315e-08, -2.2180926780549425e-08,
      -1.6130991938636835e-08, -1.0022745564878634e-08, -4.178727634066153e-09,
      1.1334038007057958e-09, 5.707659943175196e-09, 9.402459413564605e-09,
      1.2139693871436545e-08, 1.3900639009806207e-08, 1.4719325314582013e-08,
      1.4674035436728104e-08, 1.387760637116242e-08, 1.246718954849054e-08,
      1.0594066377243074e-08, 8.414037490119912e-09, 6.0788080707618895e-09,
      3.728686235585643e-09, 1.4868031734161295e-09, -5.450414439318362e-10,
      -2.2889023425453236e-09, -3.691658373074951e-09, -4.724577706977688e-09,
      -5.381680567446371e-09, -5.677137743255775e-09, -5.641962399557943e-09,
      -5.320256218043001e-09, -4.765260502419891e-09, -4.03544088982628e-09,
      -3.190803332609212e-09, -2.2896018044024874e-09, -1.3855574563560545e-09,
      -5.256672545136097e-10, 2.513602579140862e-10, 9.16041593213776e-10,
      1.4484593018085437e-09, 1.8380658983747268e-09, 2.083029533969771e-09,
      2.1892137761631765e-09, 2.168890920080253e-09, 2.0392892825708624e-09,
      1.821070647739442e-09, 1.5368253353565301e-09, 1.2096602671995113e-09,
      8.619409689364199e-10, 5.142327109026477e-10, 1.8446993750973143e-10,
      -1.1263236899374793e-10, -3.659259696636359e-10, -5.679482499078765e-10,
      -7.148357801015312e-10, -8.060632746448482e-10, -8.440437459409278e-10,
      -8.336282314636422e-10, -7.815437439236108e-10, -6.958063379240175e-10,
      -5.85142751475588e-10, -4.584493591648597e-10, -3.243115737428002e-10,
      -1.9060075564058583e-10, -6.415950994680562e-11, 4.941970038589956e-11,
      1.459231402529973e-10, 2.2255682325471397e-10, 2.7790905108352387e-10,
      3.1184644139654865e-10, 3.2535731406161905e-10, 3.203572471513081e-10,
      2.99471671114676e-10, 2.6580965235549815e-10, 2.2274166200962884e-10,
      1.7369228358940967e-10, 1.2195664161858885e-10, 7.054698656409772e-11,
      2.2073492754266174e-11, -2.1338957679906087e-11, -5.8098314840836726e-11,
      -8.715933570826293e-11, -1.0800756548174046e-10, -1.206179879956521e-10,
      -1.2539371791924376e-10, -1.2309044980098342e-10, -1.1473238277760041e-10,
      -1.0152504805393052e-10, -8.476993190837206e-11, -6.578506858661727e-11,
      -4.583493560867708e-11, -2.6072077944059408e-11, -7.491972160370752e-12,
      9.098234575055908e-12, 2.30972726681154e-11, 3.411443409958835e-11,
      4.196279594181884e-11, 4.664279871499084e-11, 4.831826025814615e-11,
      4.7287029875256333e-11, 4.3948482003303e-11, 3.876993039721828e-11,
      3.225383335455493e-11, 2.490738046241673e-11, 1.721572508347574e-11,
      9.619777048747255e-12, 2.499117836804583e-12, -3.839735628849827e-12,
      -9.169797252427958e-12, -1.3345148571749971e-11, -1.6298097293051345e-11,
      -1.8032664098183797e-11, -1.861520330116053e-11, -1.816300774416084e-11,
      -1.6831743539035112e-11, -1.4802512469202246e-11, -1.226925703433905e-11,
      -9.427114000895857e-12, -6.4621959059829494e-12, -3.543144983595759e-12,
      -8.146684982929401e-13, 1.6068644643939205e-12, 3.6358012759300518e-12,
      5.217695416922258e-12, 6.328123797100922e-12, 6.97010663729272e-12,
      7.170441733262599e-12, 6.9752810396791766e-12, 6.4452746532666884e-12,
      5.650588012126954e-12, 4.6660655547399925e-12, 3.5667715800218186e-12,
      2.4240900812775307e-12, 1.3025132449251053e-12, 2.571961942277507e-13,
      -6.676938893459899e-13, -1.4398507090502131e-12, -2.038978327411406e-12,
      -2.456301992185778e-12, -2.6935472286806888e-12, -2.7615078676390417e-12,
      -2.6783294485014267e-12, -2.4676329482738576e-12, -2.1565960418419208e-12,
      -1.7740962998404367e-12, -1.3490041819290492e-12, -9.086947195773631e-13,
      -4.778266903724894e-13, -7.741804615159528e-14, 2.757726030574651e-13,
      5.695656882536981e-13, 7.964032908433372e-13, 9.531479034898655e-13,
      1.0406789106984113e-12, 1.063333475137714e-12, 1.028240570685978e-12,
      9.445961811325786e-13, 8.22924576799002e-13, 6.743655552984052e-13,
      5.100210919767216e-13, 3.4038750342777254e-13, 1.7489147787764777e-13,
      2.1540621049274004e-14, -1.133081028767379e-13, -2.2506516922492295e-13,
      -3.109191826242694e-13, -3.697544782506943e-13, -4.0199179073078997e-13,
      -4.0937004898291735e-13, -3.946880825591671e-13, -3.615246903036855e-13,
      -3.1395427845888444e-13, -2.5627330313521583e-13, -1.9275024622317466e-13,
      -1.2740901187581084e-13, -6.385264221100097e-14, -5.131288770671585e-15,
      4.634441004840181e-14, 8.884588466673648e-14, 1.2132856401228157e-13,
      1.4339827567006758e-13, 1.5524839383079877e-13, 1.5757471843690224e-13,
      1.5147532445502738e-13, 1.383424696465188e-13, 1.197531522660083e-13,
      9.736413672854217e-14, 7.281629069857643e-14, 4.765197727465228e-14,
      2.3248093713460758e-14, 7.662096002004657e-16, -1.8879810493507905e-14,
      -3.5039265972280085e-14, -4.7324527206051415e-14, -5.5597384409302944e-14,
      -5.994427663182997e-14, -6.064310083676201e-14, -5.812439004499336e-14,
      -5.2929583281189597e-14, -4.5668911837998417e-14, -3.698112328601008e-14,
      -2.7496885744375558e-14, -1.780728943395293e-14, -8.43841836718687e-15,
      1.6747251339306418e-16, 7.664048630737693e-15, 1.3806492750518173e-14,
      1.8451149540983868e-14, 2.1549997352259436e-14, 2.3140893965789078e-14,
      2.3334639968694816e-14, 2.22999340831338e-14, 2.0247266115511838e-14,
      1.7412714252812586e-14, 1.4042494724911487e-14, 1.0378964582506397e-14,
      6.6486137596856885e-15, 3.0524114018308594e-15, -2.412966809548617e-16,
      -3.1012993475849878e-15, -5.435538949364574e-15, -7.190852292939821e-15,
      -8.350738438482705e-15, -8.931520840692144e-15, -8.977307161430813e-15,
      -8.554160517655306e-15, -7.74388368534501e-15, -6.637786391364351e-15,
      -5.330759358444232e-15, -3.915921549081638e-15, -2.480043408923111e-15,
      -1.0998829439870974e-15, 1.6049312152079228e-16, 1.2513909137318529e-15,
      2.1382145128071154e-15, 2.8013195186458512e-15, 3.235114100082301e-15,
      3.4465501435432862e-15, 3.4531603373822024e-15, 3.2808005189963795e-15,
      2.961251437668365e-15, 2.5298216219900597e-15, 2.0230748620327303e-15,
      1.4767835917160435e-15, 9.24184850001062e-16, 3.945900845492038e-16,
      -8.762474730450663e-17, -5.036453258368181e-16, -8.404781469570778e-16,
      -1.0908762963936196e-15, -1.2529782905157646e-15, -1.3297153116838148e-15,
      -1.3280470366133098e-15, -1.2580873986723841e-15, -1.132179457196441e-15,
      -9.639736040025516e-16, -7.675562292124873e-16, -5.566673388253612e-16,
      -3.440361049720253e-16, -1.4085353985206804e-16, 4.3608043395242634e-17,
      2.0222792726443298e-16, 3.301291135673679e-16, 4.246429267728216e-16,
      4.851642324639725e-16, 5.129187292939577e-16, 5.106655638544019e-16,
      4.823588805608977e-16, 4.3279101697667046e-16, 3.6723809716325596e-16,
      2.9112599773535625e-16, 2.0973131148577348e-16, 1.2792825767377685e-16,
      4.9988717633826194e-17, -2.0561084140772638e-17, -8.1027105452362e-17,
      -1.2958001891251604e-16, -1.6523897897588363e-16, -1.8781369784649883e-16,
      -1.9781315036943695e-16, -1.9632988527420194e-16, -1.8490903024830596e-16,
      -1.6541070558850378e-16, -1.398737865843343e-16, -1.1038786968717725e-16,
      -7.897899759423534e-17, -4.7513278160095666e-17, -1.7621080183160184e-17,
      9.356915460280783e-18, 3.240182174137706e-17, 5.082794600940536e-17,
      6.427554523158942e-17, 7.268769434391166e-17, 7.62744928151336e-17,
      7.546807517592471e-17, 7.087192236198203e-17, 6.320781746159292e-17,
      5.3263483328475124e-17, 4.184351586293948e-17, 2.972572246364194e-17,
      1.7624426535876433e-17, 6.1617399776850654e-18, -4.152733591329785e-18,
      -1.293379616381733e-17, -1.992461381124634e-17, -2.4993547458450862e-17,
      -2.8124931061882325e-17, -2.9405046996176373e-17, -2.9004636348862483e-17,
      -2.7159289473991146e-17, -2.4148999430547872e-17, -2.027804006723713e-17,
      -1.5856165182011572e-17, -1.118192959847054e-17, -6.5287211201975054e-18,
      -2.1338771617945808e-18, 1.8089470697996284e-18, 5.154181037834364e-18,
      7.805697917732128e-18, 9.71544936231353e-18, 1.087979484273234e-17,
      1.1334009768051419e-17, 1.1145488601988995e-17, 1.0406160488101251e-17,
      9.224609327249806e-18, 7.718342577836491e-18, 6.0065885564170766e-18,
      4.203926181850491e-18, 2.4149692924397798e-18, 7.30244857509955e-19,
      -7.766749987929494e-19, -2.0507995825334068e-18, -3.056179691029889e-18,
      -3.775326614609324e-18, -4.2077531981158296e-18, -4.367824505467298e-18,
      -4.282117256934312e-18, -3.986487074424604e-18, -3.5230321860041865e-18,
      -2.9371234537253227e-18, -2.274645442401711e-18, -1.5795638517398925e-18,
      -8.919030499122513e-19, -2.4618558243756084e-19, 3.2964493442807075e-19,
      8.14823799233588e-19, 1.1959181635359597e-18, 1.46658221019254e-18,
      1.626978073083181e-18, 1.6829351199899684e-18, 1.6449244282198137e-18,
      1.526924989130853e-18, 1.3452539738581906e-18, 1.1174259952137497e-18,
      8.610964999717741e-19, 5.931330344946464e-19, 3.288459359199984e-19,
      8.139774200638342e-20, -1.386010736688348e-19, -3.2331301857852746e-19,
      -4.67723204442748e-19, -5.695370251509876e-19, -6.289506009887321e-19,
      -6.483221032899407e-19, -6.317735907889131e-19, -5.847527835844148e-19,
      -5.13582503654863e-19, -4.250226005853031e-19, -3.2586536288500576e-19,
      -2.2258100207930514e-19, -1.2102509238510958e-19, -2.6215133133572834e-20,
      5.782108112519746e-20, 1.2812664535832618e-19, 1.828311056632288e-19,
      2.2110798810647227e-19, 2.4308390785526703e-19, 2.4971013981337527e-19,
      2.426080766387903e-19, 2.238998856427524e-19, 1.9603499283879034e-19,
      1.616218783248082e-19, 1.2327318019861522e-19, 8.34703948866585e-20,
      4.4452646715644435e-20, 8.132185925638707e-21, -2.3962444517718176e-20,
      -5.0716180465446024e-20, -7.143207190428952e-20, -8.581375782071146e-20,
      -9.392951888731477e-20, -9.616211840338766e-20, -9.314883650093869e-20,
      -8.571604509694261e-20, -7.481239664356028e-20, -6.144425029756654e-20,
      -4.6616380263469115e-20, -3.1280349176178094e-20, -1.6292229239161038e-20,
      -2.3806564322124926e-21, 9.874455928080212e-21, 2.0052809565083305e-20,
      2.789498707352074e-20, 3.329525712573442e-20, 3.628737227911254e-20,
      3.7024988209380085e-20, 3.5758402314384844e-20, 3.280928232747015e-20,
      2.854494558962703e-20, 2.3353573204142732e-20, 1.7621518033950814e-20,
      1.1713609266407407e-20, 5.957086241432627e-21, 6.295261099111225e-22,
      -4.049122752113193e-21, -7.920515750415924e-21, -1.0888200972565022e-20,
      -1.2914678524164965e-20, -1.4015795044473122e-20, -1.425310337459611e-20,
      -1.3724841742835768e-20, -1.2556174349382567e-20, -1.088929123640368e-20,
      -8.873896119648234e-21, -6.658523228843915e-21, -4.383025032294348e-21,
      -2.1724685981223717e-21, -1.3257527475738168e-22, 1.653258461498076e-21,
      3.1254075460873276e-21, 4.2480536541378925e-21, 5.007987985512401e-21,
      5.4124009027240046e-21, 5.485902018426677e-21, 5.267022869431616e-21,
      4.804448756166463e-21, 4.153208760025463e-21, 3.371025818142726e-21,
      2.5149946588854433e-21, 1.63871702760237e-21, 7.899834899560616e-22,
      9.051486353738242e-24, -6.724677986073551e-22, -1.2321341992059348e-21,
      -1.6566631462990023e-21, -1.9414399438040695e-21, -2.089648949641121e-21,
      -2.1111118335871325e-21, -2.020932046733421e-21, -1.838040210104696e-21,
      -1.5837281279866285e-21, -1.280248500919272e-21, -9.49544166592781e-22,
      -6.121558519339394e-22, -2.863419466548616e-22, 1.2571414076729363e-23,
      2.7260588919041594e-22, 4.853206351299913e-22, 6.457952716358664e-22,
      7.524334298949179e-22, 8.06619963797549e-22, 8.122682225870301e-22,
      7.752947988891825e-22, 7.030581219790624e-22, 6.037944794836398e-22,
      4.860808881454572e-22, 3.5834908647712905e-22, 2.2846918066711425e-22,
      1.0341551204577993e-22, -1.0978534280297856e-23, -1.101755072998446e-22,
      -1.9100219836438363e-22, -2.51638841169023e-22, -2.915398783342785e-22,
      -3.112991341843717e-22, -3.124734588577672e-22, -2.973792521591476e-22,
      -2.6887583170162624e-22, -2.3014850246226657e-22, -1.8450255587598613e-22,
      -1.3517742675940996e-22, -8.518801627385221e-23, -3.719789149337646e-23,
      6.5731746208408186e-24, 4.440694553709405e-23, 7.511120755990712e-23,
      9.801399060667222e-23, 1.1293169237701263e-22, 1.2011608787102907e-22,
      1.2018565818883003e-22, 1.1404678641427142e-22, 1.0281018151988826e-22,
      8.77074517302916e-23, 7.001211162991653e-23, 5.096853064341009e-23,
      3.173147225807911e-23, 1.331798820593561e-23, -3.427431123613578e-24,
      -1.7854347837087742e-23, -2.951510919344079e-23, -3.816200309250881e-23,
      -4.373446382036419e-23, -4.633826057039503e-23, -4.621876764665673e-23,
      -4.37304520950923e-23, -3.9304636467331135e-23, -3.341742021945228e-23,
      -2.655939416907964e-23, -1.9208480903299383e-23, -1.1806902309525512e-23,
      -4.742934463915683e-24, 1.6622212772883682e-24, 7.162428106188484e-24,
      1.1589709649571213e-23, 1.4852918143150625e-23, 1.6932609888774743e-23,
      1.7872877415030718e-23, 1.7770948894883215e-23, 1.676537687752942e-23,
      1.5023606019696364e-23, 1.2729640535574639e-23, 1.007243476226454e-23,
      7.235513205900536e-24, 4.388198250163214e-24, 1.6786924120652893e-24,
      -7.708652094048243e-25, -2.8673657835376516e-24, -4.547820673905039e-24,
      -5.778758273201776e-24, -6.554175402963145e-24, -6.892333819458241e-24,
      -6.831714780374044e-24, -6.426448030445571e-24, -5.741518213699772e-24,
      -4.848024446930291e-24, -3.8187307809019626e-24, -2.7240998661664506e-24,
      -1.6289526182575455e-24, -5.898461229084349e-25, 3.4678682447730865e-25,
      1.1457379883301388e-24, 1.7834042430177118e-24, 2.2475208242615957e-24,
      2.536343829767412e-24, 2.6573945780990554e-24, 2.6258866330537504e-24,
      2.4629572188761332e-24, 2.193819273344636e-24, 1.845939611744776e-24,
      1.4473338380794763e-24, 1.0250510254809735e-24, 6.039020595510759e-25,
      2.0546607657821413e-25, -1.526093201818845e-25, -4.570155427948055e-25,
      -6.989145650825466e-25, -8.73823039274209e-25, -9.812866062586345e-25,
      -1.024388033326724e-24, -1.0091358042920944e-24, -9.437799902821884e-25,
      -8.380999913338515e-25, -7.027044869295605e-25, -5.483781446700098e-25,
      -3.855028055787666e-25, -2.235734776625415e-25, -7.082197847706582e-26,
      6.604612772262835e-26, 1.8200221880833166e-25, 2.737395290002914e-25,
      3.3962350002904224e-25, 3.795622247003791e-25, 3.948138858008593e-25,
      3.8774918140297396e-25, 3.615867485484053e-25, 3.201186864185386e-25,
      2.674416036029201e-25, 2.077063563499915e-25, 1.4489699652850078e-25,
      8.264659597762381e-26, 2.4094731174210427e-26, -2.8211348675886206e-26,
      -7.237235909146996e-26, -1.0715207784779694e-25, -1.3195630878351605e-25,
      -1.4678141842423857e-25, -1.521389916363885e-25, -1.4896354713104216e-25,
      -1.3851023974547733e-25, -1.222491070027831e-25, -1.0176175701558177e-25,
      -7.864551464510279e-26, -5.442901645441612e-26, -3.050214404894585e-26,
      -8.062076206364497e-27, 1.192381896835878e-26, 2.873849153162933e-26,
      4.192018214652533e-26, 5.1253589891363755e-26, 5.674945660809355e-26,
      5.861510239342871e-26, 5.721858943281367e-26, 5.304917763842511e-26,
      4.6676586181219934e-26, 3.871131505565806e-26, 2.9767937836231616e-26,
      2.0432879088379688e-26, 1.1237764995365462e-26, 2.6390090543299177e-27,
      -4.996111578906271e-27, -1.1397001012363683e-26, -1.6391337444539704e-26,
      -1.9901392993296358e-26, -2.1935944767228046e-26, -2.257875830237167e-26,
      -2.1974675811383172e-26, -2.031433319551357e-26, -1.7818469541156054e-26,
      -1.472269058556586e-26, -1.1263414037098709e-26, -7.665570576577449e-27,
      -4.132470411727624e-27, -8.380811289743283e-28, 2.0781932254045585e-27,
      4.514282425961318e-27, 6.4059402426979276e-27, 7.725220845863391e-27,
      8.477277589716552e-27, 8.695863868121643e-27, 8.437934124003318e-27,
      7.777738597621465e-27, 6.800781174408156e-27, 5.597969514361778e-27,
      4.2602346248113224e-27, 2.873837374602963e-27, 1.5165161956589905e-27,
      2.545670990945536e-28, -8.591126135439313e-28, -1.786039287210095e-27,
      -2.5022845418976065e-27, -2.9978479815301218e-27, -3.275391684063379e-27,
      -3.348483378564938e-27, -3.2395017695169204e-27, -2.977355268813015e-27,
      -2.5951556750153823e-27, -2.127972560771486e-27, -1.6107738815524512e-27,
      -1.0766352180889478e-27, -5.5527566755606415e-28, -7.19541290085255e-29,
      3.532631776524283e-28, 7.058736555833972e-28, 9.769748432189253e-28,
      1.163007384530515e-27, 1.265255259127927e-27, 1.2891600978388176e-27,
      1.2435087315591728e-27, 1.1395520953000817e-27, 9.901097165889271e-28,
      8.087078251866891e-28, 6.087912429625076e-28, 4.03040270725797e-28,
      2.0281438018614484e-28, 1.7735188993716662e-29, -1.4458758373969948e-28,
      -2.7869133229977923e-28, -3.8126773083977364e-28, -4.51057858922854e-28,
      -4.886550256900808e-28, -4.962372687459423e-28, -4.772523207491114e-28,
      -4.360773733803799e-28, -3.776744124683431e-28, -3.072594695821752e-28,
      -2.3000107121894206e-28, -1.5075970618632434e-28, -7.387650410661548e-29,
      -3.015731648936052e-30, 5.893765216227362e-29, 1.099271390960388e-28,
      1.4872479552623906e-28, 1.748886299930283e-28, 1.8868487206378122e-28,
      1.9098365936159954e-28, 1.831369145853201e-28, 1.668469898622287e-28,
      1.440340349993559e-28, 1.167090943957835e-28, 8.685874598158559e-29,
      5.634575665826874e-29, 2.6828830259117514e-29, -2.9685421929933717e-31,
      -2.393790592799038e-29, -4.332052451986409e-29, -5.798954016248751e-29,
      -6.779114039385757e-29, -7.284226124259256e-29, -7.348992712584945e-29,
      -7.026392242848767e-29, -6.382608897278527e-29, -5.491929631220824e-29,
      -4.4318758962845464e-29, -3.2787911610175533e-29, -2.1040535427269622e-29,
      -9.710289640389784e-30, 6.7172711904141415e-31, 9.691255215358178e-30,
      1.7057299317906834e-29, 2.260137357603968e-29, 2.627052392066563e-29,
      2.811528331631858e-29, 2.827382933408502e-29, 2.695364696175217e-29,
      2.441196161467552e-29, 2.0936108961405852e-29, 1.6824862229830847e-29,
      1.2371557728726526e-29, 7.849659033867094e-30, 3.5011925819087375e-30,
      -4.717160477217359e-31, -3.912165150159639e-30, -6.710786323396683e-30,
      -8.805306612091291e-30, -1.0177737324980417e-29, -1.0849638078937849e-29,
      -1.0875946539399866e-29, -1.0337875582567348e-29, -9.335363540369303e-30,
      -7.979524127475541e-30, -6.38548554690247e-30, -4.665938379913426e-30,
      -2.925634427729074e-30, -1.2569986468228322e-30, 2.630618348031348e-31,
      1.5751401238854564e-30, 2.6381557067358823e-30, 3.429129601062385e-30,
      3.942054533011049e-30, 4.1860341635976496e-30, 4.182880836029235e-30,
      3.964365013544976e-30, 3.569302838270421e-30, 3.0406527477103183e-30,
      2.422769755836176e-30, 1.758938866373468e-30, 1.0892791519392813e-30,
      4.490792056332592e-31, -1.3240534407864776e-31, -6.326893242835564e-31,
      -1.0363519441210045e-30, -1.3349287262247952e-30, -1.5264584319682985e-30,
      -1.6147524770900758e-30, -1.6084600163969445e-30, -1.5200030568489431e-30,
      -1.3644531522601333e-30, -1.1584150947345504e-30, -9.189742905822737e-31,
      -6.627539731723478e-31, -4.051168366480552e-31, -1.595338015457814e-31,
      6.286890251272671e-32, 2.5358378058602754e-31, 4.068259841840224e-31,
      5.194834904947227e-31, 5.909357810558855e-31, 6.227671916354741e-31,
      6.184031909507888e-31, 5.826982073289238e-31, 5.215024613914397e-31,
      4.412328339464854e-31, 3.484693889413874e-31, 2.4959508282674465e-31,
      1.5049172177144612e-31, 5.630065620002448e-32, -2.874772301171773e-32,
      -1.0143569116737734e-31, -1.5959465188675241e-31, -2.020828185587917e-31,
      -2.2871278430012e-31, -2.4013912574108876e-31, -2.377169499726962e-31,
      -2.2334239754679323e-31, -1.9928563665736376e-31, -1.6802592353702183e-31,
      -1.3209697289368315e-31, -9.394929602041336e-32, -5.583443746914599e-32,
      -1.971428093306369e-32, 1.2803103683144856e-32, 4.0501157364824223e-32,
      6.256751237564257e-32, 7.85842014263551e-32, 8.849877468856717e-32,
      9.258025637431701e-32, 9.136415176477363e-32, 8.55907418192542e-32,
      7.614070682242052e-32, 6.397174140962461e-32, 5.005930376618691e-32,
      3.5344026585825706e-32, 2.0687650466492972e-32, 6.838662831478538e-33
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.7682351907303248, -0.39572768794527213, -0.277789376609966, -0.1896516800911222,
      -0.12230089276442326, -0.07007585662587255, -0.029433021997855094,
      0.0018711959356141339, 0.025315667390883638, 0.041958100321778685,
      0.05264829397182113, 0.05815303472353422, 0.05922159339964536, 0.05661205429010412,
      0.05109276509661161, 0.04342908239114369, 0.03436267233238445, 0.02458850598860048,
      0.014733103236787521, 0.005336364672830379, -0.0031616154462469374,
      -0.010428104328955296, -0.016239580681654903, -0.020478245641292865,
      -0.023123879231934225, -0.024241939312711066, -0.023968918826839266,
      -0.022496015067629545, -0.02005213452063897, -0.016887171856019373,
      -0.013256375203799318, -0.009406455084383258, -0.005563923764057754,
      -0.001925976766530078, 0.0013459412221470612, 0.004129899476951709,
      0.006344722201812059, 0.00794896678322162, 0.008937982012589767, 0.009339443977769183,
      0.009207794855905642, 0.008618011958965614, 0.007659114216294069,
      0.006427774706269069, 0.005022355208777685, 0.0035376165521806098,
      0.002060291200593063, 0.0006656361968608337, -0.0005849811047782831,
      -0.001645472066282896, -0.0024854500251379496, -0.003089789469361441,
      -0.00345745438002755, -0.00359974964971939, -0.003538159560683262,
      -0.0033019376342699087, -0.002925603973346233, -0.002446491023633633,
      -0.0019024581582706994, -0.0013298713820681528, -0.0007619184601516704,
      -0.00022730348166742447, 0.00025066033205714175, 0.0006545637138455065,
      0.0009730442702438355, 0.0012005992056917348, 0.0013371197428819993,
      0.0013872068498305674, 0.001359331540980958, 0.0012649029452510014,
      0.0011173040093475897, 0.0009309487171090943, 0.0007204067045321848,
      0.0004996318057486803, 0.0002813210313548694, 7.642036291989233e-05,
      -0.00010621592118650243, -0.0002600144519748793, -0.00038073012064100985,
      -0.00046636727451059484, -0.0005169949580293952, -0.000534479280658266,
      -0.000522157316257457, -0.00048447683323240274, -0.000426624809439436,
      -0.00035416532859636196, -0.0002727043367341109, -0.00018759511623315131,
      -0.0001036944622988907, -2.5175654300626167e-05, 4.4599394463089875e-05,
      0.00010314978246707635, 0.0001488909128333756, 0.0001811015961398254,
      0.00019985082351297069, 0.00020589314536233487, 0.00020054206771612983,
      0.00018553080826726312, 0.00016286921142653397, 0.00013470469439782218,
      0.00010319388154286528, 7.039018151747414e-05, 3.8151067246491166e-05,
      8.067321567057346e-06, -1.858491109798177e-05, -4.086971056013181e-05,
      -5.819614450314561e-05, -7.030462733067048e-05, -7.723793181145297e-05,
      -7.930031170630464e-05, -7.700836453823272e-05, -7.103722557344735e-05,
      -6.216546562110379e-05, -5.122170077091995e-05, -3.903544914846548e-05,
      -2.639422646217273e-05, -1.4008295556274896e-05, -2.4839093637874885e-06,
      7.694658818734725e-06, 1.6174494681886577e-05, 2.273544675543594e-05,
      2.7284502396826985e-05, 2.9844324869407875e-05, 3.053728958778245e-05,
      2.9566418637034006e-05, 2.7194593726178726e-05, 2.3723340020123815e-05,
      1.947233012880025e-05, 1.4760573393813307e-05, 9.890045240653084e-06,
      5.132288965151128e-06, 7.183009067340532e-07, -3.1681991763195262e-06,
      -6.39419835545403e-06, -8.877766445052195e-06, -1.058574883284419e-05,
      -1.1529238399239461e-05, -1.1757344147874418e-05, -1.1349795827675894e-05,
      -1.0408914897003007e-05, -9.051447035682476e-06, -7.400695216714884e-06,
      -5.579320696924037e-06, -3.7030978480105676e-06, -1.8758229786868497e-06,
      -1.8549217331113262e-07, 1.2982169988353144e-06, 2.5251967648981168e-06,
      3.4649909234373727e-06, 4.105852472344395e-06, 4.452956686461327e-06,
      4.525969836103509e-06, 4.356181371650223e-06, 3.98340333670823e-06,
      3.452826718603548e-06, 2.8120024028957293e-06, 2.1080865269211867e-06,
      1.385458509362532e-06, 6.8378696066184e-07, 3.658595748674874e-08,
      -5.297265635371604e-07, -9.962839419312147e-07, -1.3517782005408822e-06,
      -1.5920766053237831e-06, -1.719517145358174e-06, -1.7419603398235869e-06,
      -1.6716774479392522e-06, -1.5241533551258043e-06, -1.3168767989252026e-06,
      -1.0681819577488517e-06, -7.961945876509633e-07, -5.179236971379814e-07,
      -2.4852700018805205e-07, -7.658117813629305e-10, 2.1534672521485661e-07,
      3.9271066296127444e-07, 5.271328939466279e-07, 6.171716653179213e-07,
      6.638590562166037e-07, 6.703313418737758e-07, 6.413980925130182e-07,
      5.830800699526624e-07, 5.021437493265201e-07, 4.0565690835825994e-07,
      3.005855137577406e-07, 1.9344741675480173e-07, 9.003345544141508e-08,
      -4.798270877089317e-09, -8.725370191474403e-08, -1.5466243721365708e-07,
      -2.054717697580715e-07, -2.3918382862761813e-07, -2.5624634930283416e-07,
      -2.5790863695436736e-07, -2.4605460431727677e-07, -2.2302442868216266e-07,
      -1.9143548307342174e-07, -1.5401187136265718e-07, -1.1343025999207555e-07,
      -7.218787447613377e-08, -3.2496634995742166e-08, 3.794451241839608e-09,
      3.5248251620864294e-08, 6.086096189081627e-08, 8.005846364222808e-08,
      9.267098314282944e-08, 9.889013392091812e-08, 9.921281205407431e-08,
      9.437651972835303e-08, 8.529054958362368e-08, 7.296710896426919e-08,
      5.845594458323487e-08, 4.278539216361793e-08, 2.691207015613861e-08,
      1.1680706924752703e-08, -2.2051224128991983e-09, -1.4201235329612331e-08,
      -2.3930526499772483e-08, -3.118105121075042e-08, -3.589583441205252e-08,
      -3.815598935684819e-08, -3.815887231761353e-08, -3.619303509860547e-08,
      -3.261167692655586e-08, -2.7806157078825817e-08, -2.218092678055124e-08,
      -1.6130991938638824e-08, -1.0022745564880669e-08, -4.1787276340681215e-09,
      1.1334038007039892e-09, 5.707659943173627e-09, 9.402459413563326e-09,
      1.2139693871435587e-08, 1.3900639009805585e-08, 1.4719325314581722e-08,
      1.467403543672812e-08, 1.387760637116271e-08, 1.2467189548491057e-08,
      1.0594066377243765e-08, 8.414037490120723e-09, 6.078808070762766e-09,
      3.7286862355865366e-09, 1.486803173416994e-09, -5.4504144393104e-10,
      -2.288902342544627e-09, -3.6916583730743777e-09, -4.724577706977252e-09,
      -5.381680567446079e-09, -5.6771377432556244e-09, -5.641962399557925e-09,
      -5.320256218043101e-09, -4.76526050242009e-09, -4.035440889826557e-09,
      -3.190803332609544e-09, -2.289601804402851e-09, -1.3855574563564276e-09,
      -5.25667254513972e-10, 2.5136025791375203e-10, 9.160415932134836e-10,
      1.448459301808303e-09, 1.8380658983745442e-09, 2.083029533969649e-09,
      2.189213776163114e-09, 2.1688909200802463e-09, 2.039289282570906e-09,
      1.821070647739528e-09, 1.5368253353566494e-09, 1.2096602671996538e-09,
      8.619409689365758e-10, 5.142327109028077e-10, 1.8446993750988705e-10,
      -1.1263236899360421e-10, -3.6592596966350994e-10, -5.679482499077727e-10,
      -7.14835780101452e-10, -8.060632746447949e-10, -8.440437459409e-10,
      -8.336282314636382e-10, -7.815437439236275e-10, -6.958063379240518e-10,
      -5.85142751475636e-10, -4.5844935916491717e-10, -3.243115737428631e-10,
      -1.906007556406503e-10, -6.415950994686823e-11, 4.941970038584184e-11,
      1.4592314025294684e-10, 2.2255682325467246e-10, 2.779090510834923e-10,
      3.1184644139652735e-10, 3.253573140616079e-10, 3.203572471513064e-10,
      2.9947167111468264e-10, 2.658096523555116e-10, 2.2274166200964755e-10,
      1.7369228358943208e-10, 1.2195664161861338e-10, 7.054698656412287e-11,
      2.2073492754290563e-11, -2.133895767988363e-11, -5.809831484081712e-11,
      -8.715933570824685e-11, -1.0800756548172833e-10, -1.2061798799564406e-10,
      -1.2539371791923968e-10, -1.23090449800983e-10, -1.147323827776032e-10,
      -1.0152504805393597e-10, -8.476993190837958e-11, -6.578506858662621e-11,
      -4.5834935608686796e-11, -2.6072077944069308e-11, -7.491972160380297e-12,
      9.098234575047171e-12, 2.3097272668107824e-11, 3.411443409958218e-11,
      4.196279594181421e-11, 4.66427987149878e-11, 4.8318260258144637e-11,
      4.728702987525623e-11, 4.3948482003304125e-11, 3.876993039722042e-11,
      3.225383335455784e-11, 2.4907380462420155e-11, 1.7215725083479427e-11,
      9.619777048750974e-12, 2.499117836808134e-12, -3.8397356288466094e-12,
      -9.1697972524252e-12, -1.334514857174776e-11, -1.6298097293049726e-11,
      -1.8032664098182786e-11, -1.8615203301160104e-11, -1.816300774416094e-11,
      -1.6831743539035664e-11, -1.480251246920316e-11, -1.2269257034340226e-11,
      -9.4271140008972e-12, -6.462195905984368e-12, -3.543144983597171e-12,
      -8.146684982942738e-13, 1.6068644643927234e-12, 3.6358012759290356e-12,
      5.217695416921453e-12, 6.328123797100343e-12, 6.970106637292368e-12,
      7.170441733262462e-12, 6.975281039679232e-12, 6.4452746532669065e-12,
      5.6505880121273e-12, 4.666065554740431e-12, 3.5667715800223138e-12,
      2.4240900812780493e-12, 1.3025132449256166e-12, 2.571961942282281e-13,
      -6.676938893455678e-13, -1.4398507090498615e-12, -2.0389783274111355e-12,
      -2.4563019921855927e-12, -2.693547228680587e-12, -2.7615078676390187e-12,
      -2.6783294485014747e-12, -2.4676329482739654e-12, -2.156596041842076e-12,
      -1.7740962998406257e-12, -1.3490041819292585e-12, -9.086947195775798e-13,
      -4.778266903727018e-13, -7.74180461517932e-14, 2.7577260305729007e-13,
      5.69565688253552e-13, 7.964032908432243e-13, 9.53147903489788e-13,
      1.0406789106983689e-12, 1.0633334751377044e-12, 1.0282405706859982e-12,
      9.445961811326242e-13, 8.229245767990679e-13, 6.743655552984855e-13,
      5.100210919768105e-13, 3.4038750342786443e-13, 1.748914778777375e-13,
      2.1540621049357207e-14, -1.1330810287666467e-13, -2.2506516922486221e-13,
      -3.109191826242228e-13, -3.6975447825066246e-13, -4.0199179073077275e-13,
      -4.093700489829139e-13, -3.9468808255917595e-13, -3.615246903037047e-13,
      -3.139542784589117e-13, -2.5627330313524875e-13, -1.927502462232108e-13,
      -1.274090118758479e-13, -6.385264221103694e-14, -5.131288770704742e-15,
      4.634441004837282e-14, 8.884588466671263e-14, 1.2132856401226347e-13,
      1.4339827567005551e-13, 1.5524839383079266e-13, 1.5757471843690171e-13,
      1.514753244550318e-13, 1.383424696465274e-13, 1.197531522660202e-13,
      9.73641367285564e-14, 7.2816290698592e-14, 4.765197727466825e-14,
      2.3248093713476257e-14, 7.662096002147662e-16, -1.8879810493495388e-14,
      -3.503926597226978e-14, -4.732452720604358e-14, -5.5597384409297674e-14,
      -5.994427663182723e-14, -6.064310083676163e-14, -5.812439004499509e-14,
      -5.292958328119309e-14, -4.566891183800329e-14, -3.6981123286015914e-14,
      -2.7496885744381932e-14, -1.7807289433959456e-14, -8.43841836719321e-15,
      1.6747251338720137e-16, 7.664048630732543e-15, 1.3806492750513907e-14,
      1.845114954098059e-14, 2.1549997352257186e-14, 2.314089396578784e-14,
      2.3334639968694532e-14, 2.2299934083134377e-14, 2.0247266115513147e-14,
      1.741271425281447e-14, 1.4042494724913781e-14, 1.0378964582508937e-14,
      6.64861375968832e-15, 3.052411401833439e-15, -2.412966809524596e-16,
      -3.1012993475828646e-15, -5.435538949362804e-15, -7.190852292938452e-15,
      -8.350738438481757e-15, -8.931520840691612e-15, -8.97730716143067e-15,
      -8.554160517655511e-15, -7.743883685345508e-15, -6.637786391365075e-15,
      -5.330759358445116e-15, -3.915921549082614e-15, -2.480043408924117e-15,
      -1.0998829439880775e-15, 1.604931215198847e-16, 1.2513909137310555e-15,
      2.1382145128064556e-15, 2.8013195186453456e-15, 3.235114100081957e-15,
      3.4465501435431012e-15, 3.453160337382167e-15, 3.280800518996478e-15,
      2.961251437668576e-15, 2.5298216219903586e-15, 2.0230748620330912e-15,
      1.4767835917164407e-15, 9.24184850001471e-16, 3.945900845496014e-16,
      -8.762474730413941e-17, -5.036453258364965e-16, -8.404781469568129e-16,
      -1.0908762963934182e-15, -1.2529782905156295e-15, -1.3297153116837446e-15,
      -1.3280470366132997e-15, -1.2580873986724271e-15, -1.1321794571965283e-15,
      -9.63973604002673e-16, -7.675562292126327e-16, -5.566673388255199e-16,
      -3.440361049721877e-16, -1.4085353985222531e-16, 4.3608043395097977e-17,
      2.022279272643068e-16, 3.301291135672644e-16, 4.2464292677274326e-16,
      4.851642324639204e-16, 5.129187292939313e-16, 5.106655638543995e-16,
      4.823588805609168e-16, 4.3279101697670763e-16, 3.6723809716330724e-16,
      2.911259977354175e-16, 2.097313114858405e-16, 1.2792825767384553e-16,
      4.998871763389288e-17, -2.056108414071107e-17, -8.102710545230805e-17,
      -1.2958001891247152e-16, -1.6523897897584963e-16, -1.8781369784647583e-16,
      -1.9781315036942472e-16, -1.9632988527419972e-16, -1.8490903024831252e-16,
      -1.6541070558851756e-16, -1.3987378658435367e-16, -1.1038786968720045e-16,
      -7.89789975942607e-17, -4.751327816012166e-17, -1.7621080183185403e-17,
      9.35691546025753e-18, 3.2401821741356725e-17, 5.0827946009388615e-17,
      6.427554523157668e-17, 7.26876943439031e-17, 7.627449281512913e-17,
      7.546807517592407e-17, 7.08719223619848e-17, 6.320781746159852e-17,
      5.3263483328482914e-17, 4.184351586294879e-17, 2.972572246365208e-17,
      1.7624426535886774e-17, 6.1617399776950556e-18, -4.152733591320615e-18,
      -1.2933796163809348e-17, -1.9924613811239808e-17, -2.499354745844593e-17,
      -2.8124931061879034e-17, -2.940504699617468e-17, -2.9004636348862274e-17,
      -2.715928947399225e-17, -2.414899943055007e-17, -2.0278040067240172e-17,
      -1.5856165182015193e-17, -1.1181929598474478e-17, -6.528721120201516e-18,
      -2.1338771617984465e-18, 1.8089470697960893e-18, 5.154181037831293e-18,
      7.805697917729626e-18, 9.715449362311656e-18, 1.0879794842731113e-17,
      1.1334009768050818e-17, 1.1145488601988974e-17, 1.0406160488101741e-17,
      9.224609327250717e-18, 7.718342577837722e-18, 6.006588556418522e-18,
      4.203926181852046e-18, 2.4149692924413483e-18, 7.302448575114526e-19,
      -7.766749987915922e-19, -2.0507995825322428e-18, -3.056179691028954e-18,
      -3.775326614608638e-18, -4.2077531981153966e-18, -4.3678245054671115e-18,
      -4.282117256934353e-18, -3.986487074424846e-18, -3.523032186004592e-18,
      -2.937123453725851e-18, -2.2746454424023217e-18, -1.5795638517405446e-18,
      -8.919030499129073e-19, -2.4618558243818735e-19, 3.2964493442750193e-19,
      8.148237992330986e-19, 1.1959181635355647e-18, 1.4665822101922477e-18,
      1.6269780730829938e-18, 1.682935119989883e-18, 1.6449244282198225e-18,
      1.5269249891309441e-18, 1.345253973858349e-18, 1.117425995213959e-18,
      8.610964999720168e-19, 5.931330344949056e-19, 3.288459359202587e-19,
      8.139774200663119e-20, -1.3860107366861076e-19, -3.2331301857833574e-19,
      -4.677232044425944e-19, -5.695370251508752e-19, -6.289506009886615e-19,
      -6.483221032899101e-19, -6.317735907889187e-19, -5.847527835844518e-19,
      -5.135825036549253e-19, -4.2502260058538426e-19, -3.2586536288509926e-19,
      -2.2258100207940466e-19, -1.2102509238520924e-19, -2.6215133133667566e-20,
      5.782108112511185e-20, 1.281266453582529e-19, 1.8283110566317005e-19,
      2.2110798810642927e-19, 2.4308390785523997e-19, 2.497101398133636e-19,
      2.426080766387928e-19, 2.238998856427672e-19, 1.9603499283881509e-19,
      1.616218783248404e-19, 1.2327318019865227e-19, 8.347039488669789e-20,
      4.445264671568382e-20, 8.132185925676058e-21, -2.396244451768453e-20,
      -5.071618046541735e-20, -7.143207190426668e-20, -8.581375782069491e-20,
      -9.39295188873046e-20, -9.616211840338358e-20, -9.314883650094009e-20,
      -8.571604509694872e-20, -7.481239664357018e-20, -6.144425029757926e-20,
      -4.6616380263483656e-20, -3.128034917619348e-20, -1.629222923917638e-20,
      -2.3806564322270153e-21, 9.874455928067148e-21, 2.0052809565072186e-20,
      2.7894987073511895e-20, 3.3295257125728015e-20, 3.6287372279108625e-20,
      3.702498820937855e-20, 3.575840231438548e-20, 3.280928232747266e-20,
      2.854494558963104e-20, 2.3353573204147866e-20, 1.762151803395666e-20,
      1.1713609266413582e-20, 5.957086241438772e-21, 6.295261099169228e-22,
      -4.049122752107995e-21, -7.920515750411523e-21, -1.0888200972561542e-20,
      -1.291467852416247e-20, -1.401579504447162e-20, -1.425310337459555e-20,
      -1.372484174283606e-20, -1.2556174349383593e-20, -1.0889291236405299e-20,
      -8.873896119650288e-21, -6.658523228846247e-21, -4.383025032296805e-21,
      -2.1724685981248115e-21, -1.3257527475968e-22, 1.6532584614960202e-21,
      3.1254075460855905e-21, 4.248053654136524e-21, 5.007987985511424e-21,
      5.412400902723421e-21, 5.4859020184264675e-21, 5.2670228694317435e-21,
      4.804448756166877e-21, 4.1532087600261056e-21, 3.3710258181435363e-21,
      2.514994658886359e-21, 1.6387170276033315e-21, 7.899834899570133e-22,
      9.051486354632558e-24, -6.7246779860655675e-22, -1.2321341992052615e-21,
      -1.6566631462984729e-21, -1.9414399438036933e-21, -2.0896489496408984e-21,
      -2.111111833587056e-21, -2.0209320467334773e-21, -1.8380402101048662e-21,
      -1.5837281279868907e-21, -1.280248500919602e-21, -9.495441665931541e-22,
      -6.121558519343317e-22, -2.8634194665525066e-22, 1.2571414076363173e-23,
      2.726058891900885e-22, 4.853206351297145e-22, 6.45795271635648e-22,
      7.524334298947617e-22, 8.066199637974551e-22, 8.1226822258699515e-22,
      7.752947988892008e-22, 7.030581219791263e-22, 6.037944794837407e-22,
      4.860808881455856e-22, 3.583490864772752e-22, 2.2846918066726848e-22,
      1.034155120459333e-22, -1.0978534280153152e-23, -1.1017550729971497e-22,
      -1.9100219836427387e-22, -2.516388411689363e-22, -2.9153987833421645e-22,
      -3.112991341843344e-22, -3.124734588577536e-22, -2.973792521591555e-22,
      -2.6887583170165258e-22, -2.301485024623077e-22, -1.8450255587603818e-22,
      -1.351774267594689e-22, -8.518801627391419e-23, -3.719789149343789e-23,
      6.5731746207830195e-24, 4.4406945537042404e-23, 7.511120755986353e-23,
      9.801399060663794e-23, 1.1293169237698825e-22, 1.2011608787101459e-22,
      1.201856581888249e-22, 1.1404678641427471e-22, 1.0281018151989875e-22,
      8.770745173030782e-23, 7.001211162993691e-23, 5.096853064343306e-23,
      3.173147225810316e-23, 1.3317988205959378e-23, -3.427431123591264e-24,
      -1.785434783706784e-23, -2.951510919342402e-23, -3.816200309249563e-23,
      -4.373446382035482e-23, -4.633826057038947e-23, -4.621876764665478e-23,
      -4.373045209509362e-23, -3.930463646733526e-23, -3.3417420219458643e-23,
      -2.6559394169087635e-23, -1.920848090330838e-23, -1.1806902309534922e-23,
      -4.7429344639249635e-24, 1.6622212772796813e-24, 7.162428106180764e-24,
      1.1589709649564736e-23, 1.4852918143145567e-23, 1.6932609888771193e-23,
      1.7872877415028676e-23, 1.7770948894882598e-23, 1.6765376877530085e-23,
      1.5023606019698118e-23, 1.2729640535577255e-23, 1.0072434762267767e-23,
      7.235513205904126e-24, 4.388198250166936e-24, 1.678692412068934e-24,
      -7.708652094014345e-25, -2.867365783534659e-24, -4.547820673902547e-24,
      -5.778758273199852e-24, -6.5541754029618186e-24, -6.892333819457507e-24,
      -6.831714780373862e-24, -6.4264480304458785e-24, -5.7415182137004905e-24,
      -4.84802444693133e-24, -3.818730780903227e-24, -2.7240998661678465e-24,
      -1.6289526182589847e-24, -5.898461229098385e-25, 3.4678682447600807e-25,
      1.145737988328995e-24, 1.7834042430167636e-24, 2.2475208242608673e-24,
      2.536343829766913e-24, 2.657394578098783e-24, 2.625886633053691e-24,
      2.462957218876264e-24, 2.193819273344927e-24, 1.8459396117451928e-24,
      1.4473338380799825e-24, 1.0250510254815315e-24, 6.039020595516504e-25,
      2.0546607657877322e-25, -1.5260932018136788e-25, -4.570155427943528e-25,
      -6.989145650821732e-25, -8.738230392739245e-25, -9.812866062584424e-25,
      -1.0243880333266227e-24, -1.0091358042920777e-24, -9.437799902822465e-25,
      -8.380999913339718e-25, -7.027044869297293e-25, -5.4837814467021285e-25,
      -3.855028055789896e-25, -2.2357347766277073e-25, -7.08219784772888e-26,
      6.604612772242222e-26, 1.8200221880815079e-25, 2.737395290001419e-25,
      3.3962350002892786e-25, 3.7956222470030136e-25, 3.9481388580081765e-25,
      3.8774918140296606e-25, 3.6158674854842733e-25, 3.2011868641858564e-25,
      2.674416036029865e-25, 2.077063563500714e-25, 1.448969965285884e-25,
      8.264659597771368e-26, 2.4094731174297624e-26, -2.821134867580581e-26,
      -7.237235909139963e-26, -1.0715207784773901e-25, -1.319563087834719e-25,
      -1.4678141842420868e-25, -1.521389916363726e-25, -1.4896354713103929e-25,
      -1.3851023974548597e-25, -1.2224910700280134e-25, -1.0176175701560743e-25,
      -7.86455146451336e-26, -5.442901645444982e-26, -3.0502144048980333e-26,
      -8.06207620639788e-27, 1.1923818968328084e-26, 2.8738491531602564e-26,
      4.192018214650337e-26, 5.125358989134712e-26, 5.674945660808241e-26,
      5.861510239342297e-26, 5.721858943281293e-26, 5.304917763842877e-26,
      4.667658618122725e-26, 3.8711315055668176e-26, 2.9767937836243647e-26,
      2.0432879088392757e-26, 1.1237764995378761e-26, 2.6390090543427287e-27,
      -4.996111578894549e-27, -1.1397001012353518e-26, -1.6391337444531421e-26,
      -1.9901392993290145e-26, -2.193594476722396e-26, -2.2578758302369653e-26,
      -2.197467581138306e-26, -2.0314333195515123e-26, -1.7818469541158973e-26,
      -1.4722690585569816e-26, -1.1263414037103361e-26, -7.665570576582468e-27,
      -4.1324704117327034e-27, -8.38081128979197e-28, 2.0781932254001256e-27,
      4.5142824259574945e-27, 6.405940242694834e-27, 7.725220845861095e-27,
      8.477277589715073e-27, 8.695863868120953e-27, 8.437934124003356e-27,
      7.777738597622135e-27, 6.800781174409344e-27, 5.597969514363358e-27,
      4.2602346248131634e-27, 2.873837374604939e-27, 1.516516195660983e-27,
      2.545670990964585e-28, -8.591126135422007e-28, -1.7860392872086056e-27,
      -2.502284541896404e-27, -2.9978479815292318e-27, -3.275391684062809e-27,
      -3.348483378564676e-27, -3.23950176951694e-27, -2.9773552688132797e-27,
      -2.595155675015847e-27, -2.1279725607721016e-27, -1.6107738815531661e-27,
      -1.076635218089713e-27, -5.552756675568336e-28, -7.19541290092591e-29,
      3.532631776517638e-28, 7.058736555828274e-28, 9.769748432184675e-28,
      1.163007384530179e-27, 1.2652552591277147e-27, 1.2891600978387247e-27,
      1.2435087315591893e-27, 1.139552095300193e-27, 9.901097165891158e-28,
      8.087078251869358e-28, 6.087912429627923e-28, 4.030402707261003e-28,
      2.0281438018644896e-28, 1.7735188994005755e-29, -1.445875837394384e-28,
      -2.786913322995561e-28, -3.8126773083959513e-28, -4.510578589227236e-28,
      -4.886550256899991e-28, -4.962372687459074e-28, -4.77252320749119e-28,
      -4.360773733804242e-28, -3.7767441246841698e-28, -3.0725946958227113e-28,
      -2.300010712190523e-28, -1.5075970618644147e-28, -7.38765041067327e-29,
      -3.0157316490473936e-30, 5.893765216217311e-29, 1.099271390959529e-28,
      1.487247955261704e-28, 1.7488862999297819e-28, 1.8868487206374992e-28,
      1.9098365936158633e-28, 1.8313691458532335e-28, 1.668469898622462e-28,
      1.4403403499938503e-28, 1.1670909439582127e-28, 8.685874598162902e-29,
      5.634575665831484e-29, 2.6828830259163555e-29, -2.9685421925572315e-31,
      -2.3937905927951137e-29, -4.3320524519830695e-29, -5.798954016246095e-29,
      -6.779114039383837e-29, -7.284226124258082e-29, -7.348992712584484e-29,
      -7.026392242848955e-29, -6.382608897279274e-29, -5.49192963122202e-29,
      -4.431875896286072e-29, -3.2787911610192876e-29, -2.1040535427287873e-29,
      -9.710289640407866e-30, 6.717271190244192e-31, 9.691255215343016e-30,
      1.705729931789406e-29, 2.2601373576029656e-29, 2.6270523920658526e-29,
      2.81152833163144e-29, 2.8273829334083605e-29, 2.695364696175326e-29,
      2.4411961614678738e-29, 2.0936108961410756e-29, 1.6824862229836962e-29,
      1.2371557728733379e-29, 7.849659033874238e-30, 3.501192581915769e-30,
      -4.717160477151652e-31, -3.912165150153809e-30, -6.710786323391801e-30,
      -8.805306612087488e-30, -1.017773732497775e-29, -1.0849638078936309e-29,
      -1.0875946539399387e-29, -1.033787558256782e-29, -9.335363540370585e-30,
      -7.979524127477464e-30, -6.385485546904853e-30, -4.66593837991609e-30,
      -2.9256344277318442e-30, -1.2569986468255514e-30, 2.630618348006009e-31,
      1.5751401238832156e-30, 2.6381557067340133e-30, 3.429129601060938e-30,
      3.942054533010045e-30, 4.186034163597085e-30, 4.182880836029084e-30,
      3.964365013545195e-30, 3.5693028382709526e-30, 3.0406527477110975e-30,
      2.422769755837132e-30, 1.75893886637453e-30, 1.0892791519403814e-30,
      4.490792056343363e-31, -1.3240534407764619e-31, -6.326893242826724e-31,
      -1.0363519441202684e-30, -1.3349287262242267e-30, -1.5264584319679056e-30,
      -1.614752477089857e-30, -1.6084600163968892e-30, -1.5200030568490333e-30,
      -1.3644531522603458e-30, -1.1584150947348585e-30, -9.189742905826495e-31,
      -6.627539731727633e-31, -4.051168366484843e-31, -1.5953380154620048e-31,
      6.286890251233807e-32, 2.5358378058568558e-31, 4.068259841837388e-31,
      5.194834904945047e-31, 5.90935781055736e-31, 6.22767191635392e-31,
      6.184031909507698e-31, 5.8269820732896065e-31, 5.215024613915233e-31,
      4.4123283394660515e-31, 3.4846938894153233e-31, 2.4959508282690413e-31,
      1.5049172177160999e-31, 5.63006562001837e-32, -2.874772301157081e-32,
      -1.0143569116724877e-31, -1.5959465188664653e-31, -2.020828185587111e-31,
      -2.287127843000657e-31, -2.401391257410602e-31, -2.3771694997269156e-31,
      -2.2334239754680974e-31, -1.992856366573979e-31, -1.6802592353706967e-31,
      -1.3209697289374052e-31, -9.394929602047609e-32, -5.583443746921021e-32,
      -1.9714280933125906e-32, 1.2803103683087594e-32, 4.050115736477424e-32,
      6.256751237560154e-32, 7.858420142632403e-32, 8.849877468854643e-32,
      9.258025637430637e-32, 9.136415176477235e-32, 8.559074181926114e-32,
      7.614070682243425e-32, 6.397174140964355e-32, 5.005930376620944e-32,
      3.534402658585022e-32, 2.0687650466517976e-32, 6.838662831502694e-33
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_4_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<4>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.6643227825256709), "design.b()[0] == 0.6643227825256709");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.6643227825256709));
    static_assert(almost_equal(design.b()[1], -2.6572911301026836), "design.b()[1] == -2.6572911301026836");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.6572911301026836));
    static_assert(almost_equal(design.b()[2], 3.9859366951540256), "design.b()[2] == 3.9859366951540256");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 3.9859366951540256));
    static_assert(almost_equal(design.b()[3], -2.6572911301026836), "design.b()[3] == -2.6572911301026836");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -2.6572911301026836));
    static_assert(almost_equal(design.b()[4], 0.6643227825256709), "design.b()[4] == 0.6643227825256709");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.6643227825256709));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.2848777118538313), "design.a()[1] == -3.2848777118538313");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.2848777118538313));
    static_assert(almost_equal(design.a()[2], 4.123223357971189), "design.a()[2] == 4.123223357971189");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 4.123223357971189));
    static_assert(almost_equal(design.a()[3], -2.3408307546160163), "design.a()[3] == -2.3408307546160163");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -2.3408307546160163));
    static_assert(almost_equal(design.a()[4], 0.5100502893263036), "design.a()[4] == 0.5100502893263036");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.5100502893263036));
    std::cout << "max_deviation(cheby1,highpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.6643227825256709, -0.4750720283073875, -0.31376803630036454, -0.17408547507394712,
      -0.0646922601968255, 0.013119889760058151, 0.0623707154896068, 0.08814265194613012,
      0.09607718935948961, 0.09147746204416943, 0.07885939385853255, 0.06180471157040279,
      0.04299508304896499, 0.02433734809905838, 0.007118994601351292, -0.007842593776252304,
      -0.020075207956958743, -0.02935674726789269, -0.035647988392108365,
      -0.03904740345894388, -0.03976113815846233, -0.038081800655405576,
      -0.034371100717011036, -0.02904304830941179, -0.02254600690398359,
      -0.01534319658017376, -0.0078921730046147, -0.0006243678371337276,
      0.006073991001117672, 0.011878286276563513, 0.016538161962048784,
      0.019885656130620842, 0.021838429870063528, 0.022398084489218477,
      0.021643905537798658, 0.019722661368329918, 0.016835301419286616,
      0.013221538628103977, 0.009143361517543622, 0.004868509748979802,
      0.0006548712690628566, -0.00326336884139061, -0.006687164923584774,
      -0.009461162379595538, -0.011479098245272747, -0.012685987353557242,
      -0.013077220565731237, -0.012694868592970112, -0.011621621570666697,
      -0.009972895529262574, -0.007887699424144894, -0.005518880035635658,
      -0.003023348640075571, -0.0005528466352580589, 0.0017542673967691797,
      0.003779822912468449, 0.005430959175642833, 0.006643405288816521, 0.00738287736207738,
      0.007644661928022649, 0.007451552310249413, 0.006850385074271506,
      0.005907483724495472, 0.004703354659673087, 0.0033269956638740817,
      0.0018701708056714037, 0.00042197961811520253, -0.0009359941414368053,
      -0.002133724274277588, -0.003115808697536633, -0.003843463476492075,
      -0.004295415630052377, -0.004467730825782343, -0.004372669736500308,
      -0.004036714613219033, -0.003497943603298444, -0.0028029533957646905,
      -0.002003540617127048, -0.0011533495133861553, -0.00030467900496930836,
      0.0004943820765895952, 0.0012023547141889698, 0.0017862047443042072,
      0.00222255349530983, 0.002498244488040856, 0.002610284780988491,
      0.0025652136006197165, 0.0023779792797215824, 0.0020704270686579714,
      0.001669514401656592, 0.001205376489786426, 0.0007093639261824018,
      0.0002121659841470844, -0.0002578805426153493, -0.0006762155210998956,
      -0.0010231528318048859, -0.0012846143281647487, -0.0014524873632109424,
      -0.0015246152554650129, -0.0015044501779813424, -0.0014004148057350416,
      -0.0012250319470532831, -0.0009938898945738642, -0.0007245152222992257,
      -0.00043522435727853847, -0.00014402083598240344, 0.00013240271546811596,
      0.00037950944206676117, 0.0005855740457848919, 0.0007421271529628633,
      0.0008441796910522311, 0.0008902318750059783, 0.0008820832761340597,
      0.0008244704468883387, 0.0007245662833228615, 0.0005913804657738553,
      0.0004351028355972452, 0.00026643150687474327, 9.592508333209054e-05,
      -6.658612288330834e-05, -0.00021250107708033073, -0.0003348396766211587,
      -0.000428511446948605, -0.0004904557109127457, -0.0005196554032656999,
      -0.0005170337085298707, -0.00048524863297167895, -0.0004284052278013327,
      -0.0003517083038680933, -0.00026108005757116454, -0.00016276709545692456,
      -6.296001637104529e-05, 3.255382934880098e-05, 0.00011868729459912242,
      0.00019128720064463844, 0.0002472966160612106, 0.0002848420678392123,
      0.00030324664963630457, 0.0003029741254925246, 0.000285512645126897,
      0.0002532094379273412, 0.000209069741116763, 0.00015653420407569943,
      9.924911049948097e-05, 4.084303722544678e-05, -1.527787089928041e-05,
      -6.610584855288015e-05, -0.00010917095425894548, -0.00014263896859517547,
      -0.0001653654610477249, -0.00017690641029711866, -0.00017748820036391107,
      -0.0001679419001511406, -0.00014960837584835994, -0.00012422192608325006,
      -9.37807433831561e-05, -6.041259911368052e-05, -2.624375828457322e-05,
      6.721684154391267e-06, 3.6706012949006095e-05, 6.224102586456624e-05,
      8.222703015356702e-05, 9.59662540371767e-05, 0.00010317079260900765,
      0.00010394664472655963, 9.875663287364978e-05, 8.836597738515255e-05,
      7.377498437427624e-05, 5.614368709469213e-05, 3.671335594744631e-05,
      1.6729582660385687e-05, -2.6288162786532683e-06, -2.031149713626472e-05,
      -3.544612377315376e-05, -4.737388499597824e-05, -5.567008212156092e-05,
      -6.0149794474051606e-05, -6.085947757484165e-05, -5.8056080481528764e-05,
      -5.2175852616626506e-05, -4.3795424986277544e-05, -3.3587985725982395e-05,
      -2.227742622820654e-05, -1.0593222598330419e-05, 7.71442582095223e-07,
      1.1196194786273526e-05, 2.0162967081652244e-05, 2.7277362080968964e-05,
      3.228130447905335e-05, 3.505695217567023e-05, 3.56223330638275e-05,
      3.411960775783366e-05, 3.079720643323999e-05, 2.5987337514880147e-05,
      2.008051075654609e-05, 1.3498757340587946e-05, 6.669170968140124e-06,
      -7.523714752373392e-10, -6.1447169516780465e-06, -1.1455186141674834e-05,
      -1.5696218934798693e-05, -1.8711227341646496e-05, -2.042561447346497e-05,
      -2.084454711133324e-05, -2.004637293071569e-05, -1.8172399729997652e-05,
      -1.541390410583252e-05, -1.1997326002495866e-05, -8.168633200646213e-06,
      -4.177809370022217e-06, -2.643370993256276e-07, 3.3555779131005364e-06,
      6.499453066569803e-06, 9.02623575306939e-06, 1.0841049141564407e-05,
      1.1896940747602755e-05, 1.2193770787766905e-05, 1.1774528990772003e-05,
      1.0719491852073877e-05, 9.138722507746637e-06, 7.163469954898882e-06,
      4.937042971190053e-06, 2.6057185598166316e-06, 3.101986434333491e-07,
      -1.821942919327428e-06, -3.682472033363287e-06, -5.187117685807492e-06,
      -6.278469498381026e-06, -6.92712099269022e-06, -7.1311319488664584e-06,
      -6.913972935880522e-06, -6.3211884535536174e-06, -5.416069272514354e-06,
      -4.274657928457273e-06, -2.9804236636292255e-06, -1.6189353691969027e-06,
      -2.7283528961939767e-07, 9.826247070124125e-07, 2.0832750882168128e-06,
      2.97879997744437e-06, 3.634503001991661e-06, 4.032046639898027e-06,
      4.169204005687745e-06, 4.058715042864224e-06, 3.7263827136681073e-06,
      3.2085772574039823e-06, 2.5493369610688502e-06, 1.7972619475548852e-06,
      1.0023937501134782e-06, 2.1325904958284987e-07, -5.257674391722476e-07,
      -1.176656294939137e-06, -1.7093833320029127e-06, -2.1030039200452077e-06,
      -2.3461268309946204e-06, -2.4368080425902086e-06, -2.381916266913013e-06,
      -2.1960478989332496e-06, -1.9000885491478001e-06, -1.5195307388935189e-06,
      -1.0826625479511303e-06, -6.187402835761427e-07, -1.5625023238060492e-07,
      2.786487878377461e-07, 6.634278613537923e-07, 9.80181515784405e-07,
      1.2162802890485673e-06, 1.3646721383979312e-06, 1.4238432583899158e-06,
      1.397467388763543e-06, 1.293788095507208e-06, 1.1247901694069824e-06,
      9.052238386304679e-07, 6.515488303971893e-07, 3.8086458411991646e-07,
      1.0988847719784426e-07, -1.4596368040116743e-07, -3.7335071404634847e-07,
      -5.616003471518992e-07, -7.031050001859051e-07, -7.935122912600191e-07,
      -8.317156044659163e-07, -8.196610261594648e-07, -7.619960953591564e-07,
      -6.655927937723162e-07, -5.389817880646465e-07, -3.917370599012696e-07,
      -2.3384979171718457e-07, -7.512792180814999e-08, 7.534654698373651e-08,
      2.096762112175634e-07, 3.215034744940553e-07, 4.0625027863431256e-07,
      4.6123784565812224e-07, 4.85689089633771e-07, 4.806228127440922e-07,
      4.4865422845488445e-07, 3.9372052907019295e-07, 3.2075299697534544e-07,
      2.3531850025840506e-07, 1.4325315155801203e-07, 5.0309558066717096e-08,
      -3.816337099496933e-08, -1.1749243801844703e-07, -1.8389233887814386e-07,
      -2.3461067771149616e-07, -2.680028730938458e-07, -2.835382285485413e-07,
      -2.817422501723761e-07, -2.6408351486740447e-07, -2.3281588775182724e-07,
      -1.9078857225699338e-07, -1.4123731937113138e-07, -8.757014196848235e-08,
      -3.316013998872831e-08, 1.8843355650736062e-08, 6.567603685175978e-08,
      1.0508528622994554e-07, 1.3541779079713795e-07, 1.5566620391796154e-07,
      1.6547543390602866e-07, 1.6511138543058716e-07, 1.5539688993197163e-07,
      1.376210516285339e-07, 1.134292548658848e-07, 8.470160577230416e-08,
      5.34276252838493e-08, 2.158460717688067e-08, -8.973738002084456e-09,
      -3.661283855944145e-08, -5.999283464120023e-08, -7.812145126860224e-08,
      -9.038295783583694e-08, -9.654345458147086e-08, -9.673405232732958e-08,
      -9.141464405094443e-08, -8.132185655959202e-08, -6.740538625231011e-08,
      -5.075725131848626e-08, -3.2538537732783885e-08, -1.3907997851347254e-08,
      4.04358850969487e-09, 2.0350016259960624e-08, 3.421471773430406e-08,
      4.504263599515724e-08, 5.245813814412901e-08, 5.630905180694958e-08,
      5.6657689671558095e-08, 5.376039790793132e-08, 4.8037695100747556e-08,
      4.0037439880316744e-08, 3.039366919378178e-08, 1.9783786773682414e-08,
      8.886663797917769e-09, -1.6560400922606728e-09, -1.127339217838994e-08,
      -1.9492041757422384e-08, -2.5955414594088345e-08, -3.0434760425122015e-08,
      -3.283206833968026e-08, -3.3175325636674954e-08, -3.1606993187927694e-08,
      -2.8366886835069125e-08, -2.3770878320393735e-08, -1.8186955270328062e-08,
      -1.20102083798498e-08, -5.6382512397940856e-09, 5.515650297135957e-10,
      6.221989535469135e-09, 1.1091867289144872e-08, 1.4947687116129566e-08,
      1.765037651795746e-08, 1.9137332278594703e-08, 1.9419947122284622e-08,
      1.857712805246126e-08, 1.6745490613953117e-08, 1.4107048193131847e-08,
      1.087529317874634e-08, 7.280587443058998e-09, 3.555746496291368e-09,
      -7.737906447452469e-11, -3.4196412067335082e-09, -6.3041169941372365e-09,
      -8.603049730565778e-09, -1.0232017964546851e-08, -1.1151314113858744e-08,
      -1.1364674415888086e-08, -1.091564119392126e-08, -9.881950770073293e-09,
      -8.368421495008411e-09, -6.498864154025487e-09, -4.407551363404601e-09,
      -2.230765311060437e-09, -9.889779471245831e-11, 1.870492233159607e-09,
      3.5783447457761665e-09, 4.948267126960845e-09, 5.929086353452129e-09,
      6.495767341571481e-09, 6.648774117687123e-09, 6.412032882791762e-09,
      5.829722918396648e-09, 4.962170049730389e-09, 3.881146700411538e-09,
      2.664892308578503e-09, 1.3931590189135565e-09, 1.4256208703714283e-10,
      -1.0175249096914242e-09, -2.0283398398044878e-09, -2.8442332997773466e-09,
      -3.4342278042995055e-09, -3.7826205978531765e-09, -3.888671254282744e-09,
      -3.765463973707682e-09, -3.4380742781945327e-09, -2.94119909441828e-09,
      -2.3164271577994318e-09, -1.6093331530537581e-09, -8.665745566809521e-10,
      -1.331558822025688e-10, 5.49997466828483e-10, 1.1480423310008113e-09,
      1.633717482457231e-09, 1.988294372023409e-09, 2.2019682121937228e-09,
      2.2737113094001425e-09, 2.210639378068885e-09, 2.0269652338364833e-09,
      1.7426318360728986e-09, 1.3817276126775004e-09, 9.707912514190595e-10,
      5.371109695832805e-10, 1.0711530729062257e-10, -2.9506036107339264e-10,
      -6.487640231780528e-10, -9.377255070412317e-10, -1.1506352048810276e-09,
      -1.2813953803996674e-09, -1.329055600421462e-09, -1.2974608651330613e-09,
      -1.1946550782818198e-09, -1.032093034377774e-09, -8.237207841851036e-10,
      -5.849869965642221e-10, -3.3184691711344156e-10, -7.981608747120422e-11,
      1.5687634482105347e-10, 3.6599448226896645e-10, 5.378335720075357e-10,
      6.655717063307622e-10, 7.454300320144254e-10, 7.766474666100448e-10,
      7.612859838694533e-10, 7.038908884961587e-10, 6.110368122453494e-10,
      4.907942318072419e-10, 3.521530796928783e-10, 2.0443957307350715e-10,
      5.6759922366682096e-11, -8.249959973660483e-11, -2.0609227418403788e-10,
      -3.0823273288551327e-10, -3.848103706386112e-10, -4.3349079485993614e-10,
      -4.5370837836480217e-10, -4.4655892463785394e-10, -4.14606418762414e-10,
      -3.6162161577158363e-10, -2.922726904524844e-10, -2.117893011417292e-10,
      -1.256212466445462e-10, -3.911153259659147e-11, 4.279871743553887e-11,
      1.1581925451304589e-10, 1.765030911663217e-10, 2.2237581728267095e-10,
      2.519994723260763e-10, 2.649725057879969e-10, 2.6187086748753804e-10,
      2.441382159321046e-10, 2.1393549343655593e-10, 1.7396161677164752e-10,
      1.2725774651735061e-10, 7.700754840076542e-11, 2.6345108800379765e-11,
      -2.1819187746507895e-11, -6.494634428937115e-11, -1.0098369568266626e-10,
      -1.2844316350357975e-10, -1.4644126930935168e-10, -1.5470164859349166e-10,
      -1.5352287941370566e-10, -1.4371618808572e-10, -1.2651894573068818e-10,
      -1.034907783688024e-10, -7.63995629274863e-11, -4.7104582645003175e-11,
      -1.7443703204992745e-11, 1.0869338468817921e-11, 3.633249561995065e-11,
      5.7724043887715664e-11, 7.41498782480318e-11, 8.506847022757771e-11,
      9.029382915933371e-11, 8.99780336222202e-11, 8.457593623457303e-11,
      7.479545235675519e-11, 6.153739324572593e-11, 4.582908584738175e-11,
      2.875603987088711e-11, 1.1395697766306347e-11, -5.243133296710557e-12,
      -2.0272174902337787e-11, -3.2964632483884315e-11, -4.278374806583891e-11,
      -4.9398306625939715e-11, -5.2685243930928876e-11, -5.2720224742311804e-11,
      -4.975767512003616e-11, -4.420223462165515e-11, -3.657392658640833e-11,
      -2.746952032814864e-11, -1.7522580321393477e-11, -7.364575315515733e-12,
      2.410827000405726e-12, 1.1278502717720453e-11, 1.8806296769847223e-11,
      2.46722410101859e-11, 2.867415549606127e-11, 3.073168815350293e-11,
      3.0881273184951206e-11, 2.9264852956754326e-11, 2.611349576227672e-11,
      2.1727242508063402e-11, 1.6452624477216562e-11, 1.065931290634602e-11,
      4.717295252348868e-12, -1.0241668777786862e-12, -6.2547433214967204e-12,
      -1.0717593963832714e-11, -1.421974090884521e-11, -1.6637995123734923e-11,
      -1.792045141747597e-11, -1.808381626359328e-11, -1.7207048835701e-11,
      -1.542196717582685e-11, -1.2901592408004546e-11, -9.847071456661645e-12,
      -6.474033208064843e-12, -2.999197825421388e-12, 3.720200854245646e-13,
      3.4562886215704583e-12, 6.101031554831507e-12, 8.190670373333284e-12,
      9.650272489898987e-12, 1.0446602901620098e-11, 1.0586724296071214e-11,
      1.0114418427381587e-11, 9.104803836330122e-12, 7.65759787112386e-12,
      5.889512655132917e-12, 3.926285235933014e-12, 1.894823487415607e-12,
      -8.409521002359621e-14, -1.9022013456993063e-12, -3.4688972963372317e-12,
      -4.7150103152143115e-12, -5.595032562229037e-12, -6.087840225135577e-12,
      -6.195970804228288e-12, -5.943613301523185e-12, -5.373526967780706e-12,
      -4.5431481199574894e-12, -3.5201702010538273e-12, -2.3778896912961817e-12,
      -1.1906007085197186e-12, -2.929606837556167e-14, 1.042105158388572e-12,
      1.9698308116824398e-12, 2.7125100968982983e-12, 3.2425458189503574e-12,
      3.5465960079030617e-12, 3.6252078009261216e-12, 3.491691221554659e-12,
      3.1703567644710736e-12, 2.6942670630262273e-12, 2.1026686700552125e-12,
      1.4382750623822772e-12, 7.445669387835401e-13, 6.326180440515369e-14,
      -5.679167661605622e-13, -1.1170670994637456e-12, -1.5594625472622306e-12,
      -1.8783903409733316e-12, -2.0654690749729276e-12, -2.120467893638096e-12,
      -2.0506769433173073e-12, -1.869900232962744e-12, -1.597157886630147e-12,
      -1.255194420517054e-12, -8.688930766075065e-13, -4.636936940284718e-13,
      -6.410371198703152e-14, 3.0762045655854737e-13, 6.325602094709828e-13,
      8.959462439185721e-13, 1.0876703589605125e-12, 1.2024921291874836e-12,
      1.2399527683990444e-12, 1.2040241640306625e-12, 1.1025339004200878e-12,
      9.464165954953307e-13, 7.488477736949383e-13, 5.243187373543407e-13,
      2.8770964069205584e-13, 5.341356214866726e-14, -1.654426890160894e-13,
      -3.5764439717724297e-13, -5.143752257859771e-13, -6.295289198285167e-13,
      -6.99842484718685e-13, -7.248573527816901e-13, -7.067243062536386e-13,
      -6.498755577698883e-13, -5.605930902932236e-13, -4.465059567587001e-13,
      -3.160506967747457e-13, -1.7792842958747656e-13, -4.058972521398338e-14,
      8.82256746390772e-14, 2.0187246456394428e-13, 2.950909669266553e-13,
      3.641966526364654e-13, 4.0716524210475155e-13, 4.236167856193125e-13,
      4.147075928088619e-13, 3.829434161407397e-13, 3.3193070959450183e-13,
      2.660849749651773e-13, 1.903161467762821e-13, 1.0971069799185351e-13,
      2.9228783073085745e-14, -4.656756351037723e-14, -1.1374218231958558e-13,
      -1.6915903292488383e-13, -2.1059724818267527e-13, -2.368051301944604e-13,
      -2.474948350881271e-13, -2.4328272517273424e-13, -2.2558306082952853e-13,
      -1.9646475008085162e-13, -1.5848220603824238e-13, -1.1449196193684103e-13,
      -6.746658393705554e-14, -2.0316665444369813e-14, 2.426962265918251e-14,
      6.396169578724243e-14, 9.689074921992679e-14, 1.2171950472353782e-13,
      1.3767626436632014e-13, 1.445541514411536e-13, 1.42678326572382e-13,
      1.3284556641678315e-13, 1.1624181636906926e-13, 9.434413741546889e-14,
      6.88138475481591e-14, 4.1387622141298165e-14, 1.3772900265130782e-14,
      -1.2446801136184013e-14, -3.58920677991398e-14, -5.544985249582432e-14,
      -7.031569893507845e-14, -8.001510684871551e-14, -8.440446931343978e-14,
      -8.365313977034097e-14, -7.820913532719097e-14, -6.875171482823238e-14,
      -5.6134560404040895e-14, -4.1323530978503044e-14, -2.533295163992251e-14,
      -9.164173403852615e-15, 6.250285537682233e-15, 2.009428411835724e-14,
      3.170524308214861e-14, 4.0599674618747475e-14, 4.648652572654767e-14,
      4.926853820750365e-14, 4.903249291457441e-14, 4.6029768891546864e-14,
      4.064908540319364e-14, 3.338359161505845e-14, 2.479461907505409e-14,
      1.54744191714232e-14, 6.010082299152314e-15, -3.0494048698928302e-15,
      -1.1221340137403207e-14, -1.811149921894522e-14, -2.3429553268569215e-14,
      -2.6997368968661887e-14, -2.875028090025644e-14, -2.873181804466093e-14,
      -2.7082700111916192e-14, -2.4025180577385456e-14, -1.9843992727120695e-14,
      -1.4865248920822877e-14, -9.434653086222736e-15, -3.8963182350216705e-15,
      1.4266554339284415e-15, 6.24887740374726e-15, 1.0335905080737426e-14,
      1.351354411838199e-14, 1.5672993019629316e-14, 1.6771867452370436e-14,
      1.6831370971892957e-14, 1.5930076718930153e-14, 1.4194940544729017e-14,
      1.1790274361439135e-14, 8.905466920586072e-15, 5.742248304677044e-15,
      2.50225755017255e-15, -6.244042786001337e-16, -3.4690630236920176e-15,
      -5.892363480970915e-15, -7.789873705317186e-15, -9.095263606959865e-15,
      -9.781068543236063e-15, -9.85718495036469e-15, -9.367362296984873e-15,
      -8.384048621825132e-15, -7.002012272779385e-15, -5.331198659640778e-15,
      -3.489288110956967e-15, -1.5944011535366187e-15, 2.416460329250925e-16,
      1.9191962429136183e-15, 3.3554535508454016e-15, 4.487857040286432e-15,
      5.276039068737787e-15, 5.702368436554724e-15, 5.771159184022009e-15,
      5.506695174598225e-15, 4.950276051813613e-15, 4.156529537829157e-15,
      3.1892574016703796e-15, 2.11708783652639e-15, 1.0091964772403568e-15,
      -6.866628662034817e-17, -1.0576401847082003e-15, -1.9085553451858857e-15,
      -2.5839613120525167e-15, -3.0593303553277337e-15, -3.3234318261494825e-15,
      -3.3779216537296625e-15, -3.2362321879817567e-15, -2.921880617271143e-15,
      -2.466337896317103e-15, -1.9066138930764397e-15, -1.282718306150989e-15,
      -6.351513806551015e-16, -2.5646128466729554e-18, 5.802890762351847e-16,
      1.084222082052934e-15, 1.486831299370961e-15, 1.7732357803850233e-15,
      1.936328933196166e-15, 1.9765692124481673e-15, 1.9013575813248314e-15,
      1.7240696907945183e-15, 1.462824978317722e-15, 1.1390833509696628e-15,
      7.761627631663345e-16, 3.977681353599443e-16, 2.6614284250807232e-17,
      -3.1678632374169767e-16, -6.15115130218296e-16, -8.549794293792983e-16,
      -1.0273635915426447e-15, -1.1277960683924894e-15, -1.156245103519349e-15,
      -1.1167704636996911e-15, -1.01697021181152e-15, -8.67270108187665e-16,
      -6.801084145334146e-16, -4.69070655011152e-16, -2.480274302080314e-16,
      -3.032401974569879e-17, 1.7193627532290026e-16, 3.4848173187398314e-16,
      4.913112720412732e-16, 5.949699265766745e-16, 6.566579465382538e-16,
      6.761804818603387e-16, 6.557532564380734e-16, 5.996866328670967e-16,
      5.139756023801676e-16, 4.0582640829473376e-16, 2.8315168950236343e-16,
      1.540653045324812e-16, 2.640555789457361e-17, -9.26883276626863e-17,
      -1.971266328643274e-16, -2.8213231621827225e-16, -3.4440887066538624e-16,
      -3.822108431649756e-16, -3.9532068626990233e-16, -3.849406422557489e-16,
      -3.535125009142151e-16, -3.0448115675002783e-16, -2.420198280685983e-16,
      -1.7073556980065238e-16, -9.537336222397599e-17, -2.0535697110626757e-17,
      4.956763174690004e-17, 1.113277020636257e-16, 1.6189408983490232e-16,
      1.9927698092095094e-16, 2.2239234430553554e-16, 2.3105209048545583e-16,
      2.25904111904634e-16, 2.083295631807101e-16, 1.8030658771531918e-16,
      1.442508773628627e-16, 1.0284394885290936e-16, 5.885986024391033e-17,
      1.5000333781437548e-17, -2.6253011829053014e-17, -6.276227484781894e-17,
      -9.28276123042171e-17, -1.1524925912675527e-16, -1.2935625021004593e-16,
      -1.3500283929803233e-16, -1.3253536517884751e-16, -1.227337775535633e-16,
      -1.0673314225817877e-16, -8.59311633402006e-17, -6.188807775345485e-17,
      -3.6225210563294214e-17, -1.0528058850779298e-17, 1.3740947448449738e-17,
      3.5315815165794165e-17, 5.318341381836716e-17, 6.662108854263565e-17,
      7.52148068233317e-17, 7.88583430812884e-17, 7.773504258337452e-17,
      7.228457417661428e-17, 6.315774407182901e-17, 5.1162878852647223e-17,
      3.7207488180105534e-17, 2.2238893233502278e-17, 7.187275039317552e-18,
      -7.085812977742827e-18, -1.9830974324993152e-17, -3.0444695458597015e-17,
      -3.849212566101353e-17, -4.371847985906842e-17, -4.6049313714048506e-17,
      -4.5580532766275237e-17, -4.2559512623036845e-17, -3.7359103541880146e-17,
      -3.044655713633839e-17, -2.2349540707485236e-17, -1.3621399394584107e-17,
      -4.80769873690489e-18, 3.584152762592298e-18, 1.1110718336225977e-17,
      1.7412678276058082e-17, 2.2228608552608892e-17, 2.540211204107221e-17,
      2.6882421405232653e-17, 2.67189541447792e-17, 2.5050605971714152e-17,
      2.2090805582470027e-17, 1.810951399859134e-17, 1.3413431920752161e-17,
      8.325680713466442e-18, 3.1661527457374753e-18, -1.766405491472646e-18,
      -6.2096963500067305e-18, -9.949896891136361e-18, -1.282998292025783e-17,
      -1.47541702282113e-17, -1.5688526908451026e-17, -1.5658023873792678e-17,
      -1.474047196211994e-17, -1.305793552273599e-17, -1.0766309211254299e-17,
      -8.0437949121284e-18, -5.079020080917572e-18, -2.059500717480608e-18,
      8.389228428877348e-19, 3.4611539261297974e-18, 5.680014171042606e-18,
      7.401266567919928e-18, 8.566371202806107e-18, 9.152995940951527e-18,
      9.173430060638877e-18, 8.67115630093264e-18, 7.715921255180394e-18,
      6.397702540314537e-18, 4.8200024248857894e-18, 3.092901979249626e-18,
      1.326289189448385e-18, -3.763680050803228e-19, -1.9233929940277063e-18,
      -3.239178452675857e-18, -4.267214170532919e-18, -4.971791327529005e-18,
      -5.338390767002366e-18, -5.3728369750160526e-18, -5.099363146887972e-18,
      -4.557783114384803e-18, -3.800001205289665e-18, -2.886110496056502e-18,
      -1.880333551045803e-18, -8.47048654396812e-19, 1.528794765742498e-19,
      1.0652800706625732e-18, 1.845225663108902e-18, 2.458855375713171e-18,
      2.884425795921399e-18, 3.112590662661939e-18, 3.145954279106095e-18,
      2.997981286562622e-18, 2.691375480004516e-18, 2.256061622083554e-18,
      1.7269162018092197e-18, 1.1413958375730061e-18, 5.372061137076973e-19,
      -4.98599158240643e-20, -5.878041508833544e-19, -1.0499418692748623e-18,
      -1.4159985983964811e-18, -1.6727563655696802e-18, -1.8142481477909948e-18,
      -1.8415250991590484e-18, -1.7620434646266326e-18, -1.5887359937500053e-18,
      -1.3388454795986313e-18, -1.0326054398106639e-18, -6.918549363749724e-19,
      -3.3867141238655873e-19, 5.9022131381882814e-21, 3.2297131715349903e-19,
      5.966934908566873e-19, 8.14937803989844e-19, 9.696812563566389e-19,
      1.0571406186219582e-18, 1.0776530374381898e-18, 1.0353319967764767e-18,
      9.3753589149151e-19, 7.941941761137158e-19, 6.170405970195935e-19,
      4.1880439059693606e-19, 2.1240870572560182e-19, 1.022121455359899e-20,
      -1.7660463436742877e-19, -3.3866744752231793e-19, -4.68713784980921e-19,
      -5.618808282892967e-19, -6.157841150211357e-19, -6.304575725495978e-19,
      -6.081609034628408e-19, -5.5307572326928e-19, -4.709164830474332e-19,
      -3.6848499769039997e-19, -2.531983314029449e-19, -1.3261895966528956e-19,
      -1.4013717315230896e-20, 9.603568305165789e-20, 1.9195250412453363e-19,
      2.694025292453443e-19, 3.2544229620679076e-19, 3.5857664117741846e-19,
      3.6872943476670837e-19, 3.571360172709213e-19, 3.2616961724761125e-19,
      2.7911681905220337e-19, 2.199188513352139e-19, 1.5289608758554352e-19,
      8.247273217725311e-20, 1.2917316501509718e-20, -5.188750030731095e-20,
      -1.0863506021676842e-19, -1.5473712395281547e-19, -1.884142494069969e-19,
      -2.0873310008599296e-19, -2.1559274880413242e-19, -2.0966477630582933e-19,
      -1.9229421073382227e-19, -1.6537002273213835e-19, -1.311749332134045e-19,
      -9.222469663326941e-20, -5.110681912966756e-20, -1.0327917702901295e-20,
      2.782229013849929e-20, 6.138395149199938e-20, 8.881239804381319e-20,
      1.0903315410658259e-19, 1.214658980436198e-19, 1.2601846394193417e-19,
      1.230535865619816e-19, 1.1333242777943315e-19, 9.793992325277331e-20,
      7.819762345401896e-20, 5.556996618312234e-20, 3.156982267583483e-20,
      7.668740034485726e-21, -1.4783391639654232e-20, -3.462542723129297e-20,
      -5.0936043124743044e-20, -6.306716333168874e-20, -7.065922817524101e-20,
      -7.363886988691875e-20, -7.220051434957018e-20, -6.677422150465883e-20,
      -5.798267631547445e-20, -4.659062888106966e-20, -3.3450251131173384e-20,
      -1.9445836087929712e-20, -5.441032890634813e-21, 7.76858504432512e-21,
      1.949534487454418e-20, 2.919002974571219e-20
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.6643227825256709, -0.4750720283073875, -0.3137680363003646, -0.17408547507394764,
      -0.0646922601968268, 0.013119889760055875, 0.06237071548960352, 0.08814265194612597,
      0.09607718935948481, 0.09147746204416418, 0.07885939385852708, 0.061804711570397394,
      0.042995083048959916, 0.024337348099053878, 0.007118994601347511,
      -0.007842593776255272, -0.020075207956960866, -0.029356747267893984,
      -0.03564798839210888, -0.039047403458943676, -0.039761138158461495,
      -0.0380818006554042, -0.034371100717009224, -0.029043048309409666,
      -0.022546006903981307, -0.015343196580171468, -0.007892173004612538,
      -0.0006243678371318071, 0.006073991001119269, 0.011878286276564733,
      0.0165381619620496, 0.01988565613062125, 0.02183842987006357, 0.022398084489218203,
      0.021643905537798155, 0.019722661368329283, 0.016835301419285947,
      0.013221538628103357, 0.009143361517543129, 0.004868509748979486,
      0.0006548712690627404, -0.0032633688413905284, -0.006687164923584515,
      -0.009461162379595133, -0.011479098245272237, -0.012685987353556678,
      -0.013077220565730673, -0.012694868592969595, -0.011621621570666265,
      -0.009972895529262256, -0.007887699424144705, -0.005518880035635605,
      -0.003023348640075653, -0.000552846635258263, 0.0017542673967688752,
      0.003779822912468072, 0.0054309591756424155, 0.006643405288816094,
      0.007382877362076971, 0.007644661928022281, 0.0074515523102491, 0.006850385074271253,
      0.00590748372449528, 0.004703354659672949, 0.0033269956638739932,
      0.0018701708056713597, 0.0004219796181151986, -0.0009359941414367722,
      -0.002133724274277521, -0.0031158086975365366, -0.003843463476491956,
      -0.004295415630052243, -0.004467730825782205, -0.004372669736500176,
      -0.004036714613218913, -0.003497943603298345, -0.0028029533957646202,
      -0.002003540617127011, -0.0011533495133861516, -0.00030467900496933747,
      0.0004943820765895362, 0.0012023547141888859, 0.0017862047443041042,
      0.002222553495309715, 0.002498244488040736, 0.0026102847809883717,
      0.0025652136006196037, 0.0023779792797214805, 0.0020704270686578833,
      0.00166951440165652, 0.0012053764897863705, 0.0007093639261823626,
      0.0002121659841470604, -0.0002578805426153601, -0.0006762155210998953,
      -0.0010231528318048768, -0.001284614328164733, -0.0014524873632109215,
      -0.0015246152554649886, -0.0015044501779813162, -0.001400414805735015,
      -0.0012250319470532571, -0.0009938898945738395, -0.000724515222299202,
      -0.00043522435727851494, -0.0001440208359823793, 0.00013240271546814144,
      0.0003795094420667885, 0.0005855740457849208, 0.0007421271529628933,
      0.0008441796910522612, 0.0008902318750060073, 0.000882083276134086,
      0.0008244704468883605, 0.0007245662833228779, 0.0005913804657738656,
      0.0004351028355972492, 0.00026643150687474077, 9.592508333208165e-05,
      -6.658612288332335e-05, -0.0002125010770803513, -0.0003348396766211839,
      -0.00042851144694863356, -0.0004904557109127758, -0.0005196554032657298,
      -0.0005170337085298986, -0.0004852486329717032, -0.0004284052278013518,
      -0.0003517083038681064, -0.000261080057571171, -0.00016276709545692402,
      -6.296001637103779e-05, 3.255382934881495e-05, 0.000118687294599142,
      0.00019128720064466237, 0.0002472966160612374, 0.00028484206783924035,
      0.00030324664963633216, 0.00030297412549255034, 0.0002855126451269197,
      0.0002532094379273601, 0.00020906974111677774, 0.00015653420407570995,
      9.924911049948727e-05, 4.084303722544892e-05, -1.527787089928223e-05,
      -6.610584855288561e-05, -0.00010917095425895411, -0.00014263896859518667,
      -0.000165365461047738, -0.00017690641029713283, -0.0001774882003639256,
      -0.00016794190015115472, -0.0001496083758483729, -0.00012422192608326117,
      -9.378074338316483e-05, -6.041259911368645e-05, -2.6243758284576226e-05,
      6.721684154391134e-06, 3.6706012949008616e-05, 6.224102586457107e-05,
      8.222703015357369e-05, 9.596625403718464e-05, 0.00010317079260901624,
      0.00010394664472656825, 9.87566328736578e-05, 8.836597738515942e-05,
      7.377498437428154e-05, 5.614368709469556e-05, 3.671335594744776e-05,
      1.67295826603852e-05, -2.6288162786555316e-06, -2.031149713626851e-05,
      -3.544612377315876e-05, -4.7373884995984084e-05, -5.567008212156722e-05,
      -6.014979447405796e-05, -6.085947757484772e-05, -5.8056080481534246e-05,
      -5.217585261663117e-05, -4.379542498628121e-05, -3.358798572598494e-05,
      -2.2277426228207917e-05, -1.0593222598330622e-05, 7.714425820961378e-07,
      1.119619478627545e-05, 2.016296708165502e-05, 2.7277362080972386e-05,
      3.2281304479057186e-05, 3.505695217567423e-05, 3.562233306383142e-05,
      3.411960775783726e-05, 3.0797206433243075e-05, 2.5987337514882572e-05,
      2.0080510756547774e-05, 1.3498757340588868e-05, 6.669170968140317e-06,
      -7.523714757032073e-10, -6.144716951679072e-06, -1.14551861416763e-05,
      -1.5696218934800465e-05, -1.8711227341648437e-05, -2.0425614473466943e-05,
      -2.084454711133511e-05, -2.004637293071735e-05, -1.8172399729999e-05,
      -1.5413904105833486e-05, -1.1997326002496402e-05, -8.168633200646295e-06,
      -4.177809370021844e-06, -2.643370993248305e-07, 3.3555779131017023e-06,
      6.499453066571261e-06, 9.026235753071048e-06, 1.084104914156617e-05,
      1.1896940747604526e-05, 1.2193770787768583e-05, 1.1774528990773494e-05,
      1.0719491852075102e-05, 9.138722507747537e-06, 7.163469954899415e-06,
      4.937042971190205e-06, 2.6057185598164114e-06, 3.1019864343278414e-07,
      -1.821942919328291e-06, -3.682472033364386e-06, -5.187117685808753e-06,
      -6.278469498382373e-06, -6.927120992691576e-06, -7.131131948867752e-06,
      -6.913972935881687e-06, -6.321188453554598e-06, -5.416069272515111e-06,
      -4.274657928457783e-06, -2.9804236636294796e-06, -1.618935369196906e-06,
      -2.728352896191677e-07, 9.826247070128487e-07, 2.0832750882174197e-06,
      2.9787999774451044e-06, 3.634503001992476e-06, 4.032046639898872e-06,
      4.169204005688572e-06, 4.058715042864992e-06, 3.7263827136687773e-06,
      3.208577257404524e-06, 2.5493369610692407e-06, 1.7972619475551105e-06,
      1.002393750113535e-06, 2.1325904958274483e-07, -5.257674391724983e-07,
      -1.1766562949395098e-06, -1.7093833320033786e-06, -2.1030039200457337e-06,
      -2.3461268309951727e-06, -2.4368080425907554e-06, -2.3819162669135245e-06,
      -2.1960478989336994e-06, -1.900088549148166e-06, -1.5195307388937836e-06,
      -1.0826625479512839e-06, -6.187402835761819e-07, -1.5625023238053313e-07,
      2.786487878379192e-07, 6.634278613540518e-07, 9.80181515784731e-07,
      1.2162802890489374e-06, 1.3646721383983217e-06, 1.4238432583903035e-06,
      1.3974673887639062e-06, 1.2937880955075272e-06, 1.1247901694072423e-06,
      9.052238386306562e-07, 6.515488303972988e-07, 3.8086458411994536e-07,
      1.0988847719779566e-07, -1.4596368040128607e-07, -3.733507140465261e-07,
      -5.61600347152122e-07, -7.031050001861574e-07, -7.935122912602847e-07,
      -8.317156044661791e-07, -8.196610261597101e-07, -7.619960953593717e-07,
      -6.65592793772492e-07, -5.389817880647758e-07, -3.917370599013488e-07,
      -2.3384979171721295e-07, -7.512792180812998e-08, 7.534654698379988e-08,
      2.0967621121766306e-07, 3.215034744941827e-07, 4.0625027863445847e-07,
      4.6123784565827725e-07, 4.85689089633926e-07, 4.806228127442388e-07,
      4.486542284550151e-07, 3.937205290703016e-07, 3.2075299697542755e-07,
      2.35318500258458e-07, 1.4325315155803495e-07, 5.030955806671085e-08,
      -3.816337099500231e-08, -1.1749243801850294e-07, -1.8389233887821781e-07,
      -2.3461067771158261e-07, -2.6800287309393877e-07, -2.8353822854863493e-07,
      -2.8174225017246516e-07, -2.6408351486748435e-07, -2.3281588775189405e-07,
      -1.9078857225704415e-07, -1.4123731937116423e-07, -8.757014196849662e-08,
      -3.316013998872453e-08, 1.8843355650756325e-08, 6.56760368517941e-08,
      1.0508528622999086e-07, 1.3541779079719084e-07, 1.5566620391801834e-07,
      1.6547543390608583e-07, 1.6511138543064147e-07, 1.5539688993202028e-07,
      1.376210516285747e-07, 1.1342925486591614e-07, 8.470160577232513e-08,
      5.3427625283859584e-08, 2.1584607176880512e-08, -8.97373800209427e-09,
      -3.6612838559459656e-08, -5.999283464122518e-08, -7.812145126863201e-08,
      -9.038295783586946e-08, -9.654345458150408e-08, -9.673405232736153e-08,
      -9.141464405097335e-08, -8.132185655961639e-08, -6.740538625232878e-08,
      -5.07572513184985e-08, -3.253853773278939e-08, -1.3907997851346135e-08,
      4.04358850970213e-09, 2.0350016259973224e-08, 3.4214717734320945e-08,
      4.5042635995177184e-08, 5.24581381441507e-08, 5.6309051806971675e-08,
      5.665768967157933e-08, 5.376039790795057e-08, 4.8037695100763875e-08,
      4.003743988032941e-08, 3.0393669193790317e-08, 1.978378677368659e-08,
      8.886663797917617e-09, -1.6560400922648683e-09, -1.1273392178397674e-08,
      -1.9492041757432978e-08, -2.5955414594100997e-08, -3.043476042513585e-08,
      -3.283206833969439e-08, -3.3175325636688546e-08, -3.1606993187939995e-08,
      -2.8366886835079514e-08, -2.3770878320401736e-08, -1.8186955270333366e-08,
      -1.2010208379852276e-08, -5.6382512397937746e-09, 5.515650297164859e-10,
      6.221989535474261e-09, 1.1091867289151784e-08, 1.4947687116137745e-08,
      1.765037651796634e-08, 1.9137332278603722e-08, 1.9419947122293248e-08,
      1.8577128052469025e-08, 1.6745490613959642e-08, 1.410704819313685e-08,
      1.0875293178749645e-08, 7.2805874430605395e-09, 3.5557464962911926e-09,
      -7.737906447627583e-11, -3.419641206736617e-09, -6.304116994141429e-09,
      -8.60304973057074e-09, -1.0232017964552248e-08, -1.1151314113864238e-08,
      -1.1364674415893357e-08, -1.0915641193926022e-08, -9.881950770077312e-09,
      -8.368421495011507e-09, -6.4988641540275405e-09, -4.4075513634055626e-09,
      -2.230765311060326e-09, -9.88977947113565e-11, 1.870492233161567e-09,
      3.578344745778812e-09, 4.948267126963975e-09, 5.92908635345553e-09,
      6.495767341574941e-09, 6.64877411769044e-09, 6.4120328827947586e-09,
      5.829722918399177e-09, 4.962170049732339e-09, 3.881146700412838e-09,
      2.6648923085791267e-09, 1.3931590189135148e-09, 1.4256208703648274e-10,
      -1.0175249096926242e-09, -2.028339839806124e-09, -2.844233299779298e-09,
      -3.4342278043016417e-09, -3.782620597855366e-09, -3.888671254284861e-09,
      -3.7654639737096135e-09, -3.4380742781961833e-09, -2.941199094419579e-09,
      -2.316427157800332e-09, -1.6093331530542387e-09, -8.665745566810175e-10,
      -1.3315588220224579e-10, 5.499974668291479e-10, 1.148042331001756e-09,
      1.633717482458382e-09, 1.988294372024686e-09, 2.2019682121950446e-09,
      2.27371130940143e-09, 2.2106393780700667e-09, 2.026965233837498e-09,
      1.7426318360736993e-09, 1.3817276126780558e-09, 9.707912514193552e-10,
      5.371109695833181e-10, 1.0711530729041815e-10, -2.9506036107381047e-10,
      -6.487640231786453e-10, -9.377255070419528e-10, -1.1506352048818274e-09,
      -1.2813953804004952e-09, -1.3290556004222693e-09, -1.2974608651338045e-09,
      -1.1946550782824617e-09, -1.032093034378285e-09, -8.237207841854631e-10,
      -5.849869965644194e-10, -3.318469171134761e-10, -7.98160874710849e-11,
      1.5687634482130943e-10, 3.6599448226933506e-10, 5.378335720079881e-10,
      6.65571706331267e-10, 7.454300320149503e-10, 7.766474666105585e-10,
      7.612859838699277e-10, 7.038908884965698e-10, 6.110368122456787e-10,
      4.907942318074766e-10, 3.521530796930121e-10, 2.0443957307354023e-10,
      5.675992236662068e-11, -8.249959973674954e-11, -2.0609227418425078e-10,
      -3.0823273288577667e-10, -3.8481037063890596e-10, -4.3349079486024276e-10,
      -4.537083783651018e-10, -4.4655892463812945e-10, -4.146064187626509e-10,
      -3.6162161577177104e-10, -2.9227269045261514e-10, -2.1178930114180003e-10,
      -1.2562124664455757e-10, -3.911153259654716e-11, 4.2798717435632304e-11,
      1.1581925451317968e-10, 1.765030911664854e-10, 2.2237581728285309e-10,
      2.519994723262652e-10, 2.649725057881813e-10, 2.618708674877075e-10,
      2.441382159322503e-10, 2.1393549343667096e-10, 1.7396161677172742e-10,
      1.2725774651739342e-10, 7.700754840077147e-11, 2.6345108800351512e-11,
      -2.1819187746566296e-11, -6.494634428945418e-11, -1.0098369568276742e-10,
      -1.2844316350369198e-10, -1.4644126930946788e-10, -1.5470164859360498e-10,
      -1.5352287941381e-10, -1.4371618808581013e-10, -1.265189457307602e-10,
      -1.0349077836885366e-10, -7.639956292751559e-11, -4.7104582645010593e-11,
      -1.744370320497955e-11, 1.0869338468849431e-11, 3.6332495619997335e-11,
      5.772404388777376e-11, 7.414987824809718e-11, 8.506847022764611e-11,
      9.029382915940104e-11, 8.997803362228272e-11, 8.457593623462756e-11,
      7.479545235679925e-11, 6.15373932457578e-11, 4.5829085847400506e-11,
      2.8756039870892637e-11, 1.1395697766299284e-11, -5.243133296728884e-12,
      -2.02721749023655e-11, -3.296463248391915e-11, -4.2783748065878356e-11,
      -4.93983066259812e-11, -5.268524393096989e-11, -5.272022474235003e-11,
      -4.975767512006961e-11, -4.4202234621682295e-11, -3.6573926586428145e-11,
      -2.7469520328160615e-11, -1.752258032139758e-11, -7.364575315512376e-12,
      2.4108270004157605e-12, 1.1278502717736071e-11, 1.8806296769867115e-11,
      2.4672241010208612e-11, 2.8674155496085314e-11, 3.073168815352685e-11,
      3.088127318497367e-11, 2.926485295677415e-11, 2.6113495762292968e-11,
      2.1727242508075393e-11, 1.645262447722392e-11, 1.0659312906348672e-11,
      4.717295252347023e-12, -1.0241668777845798e-12, -6.254743321506018e-12,
      -1.0717593963844627e-11, -1.4219740908858865e-11, -1.6637995123749418e-11,
      -1.7920451417490424e-11, -1.808381626360688e-11, -1.7207048835713065e-11,
      -1.542196717583685e-11, -1.2901592408012104e-11, -9.847071456666544e-12,
      -6.474033208067027e-12, -2.9991978254209565e-12, 3.720200854273741e-13,
      3.456288621575293e-12, 6.101031554837927e-12, 8.190670373340797e-12,
      9.650272489907074e-12, 1.0446602901628257e-11, 1.0586724296078981e-11,
      1.011441842738856e-11, 9.104803836335975e-12, 7.657597871128353e-12,
      5.889512655135903e-12, 3.926285235934438e-12, 1.8948234874155054e-12,
      -8.409521002510315e-14, -1.9022013457020274e-12, -3.4688972963409217e-12,
      -4.71501031521869e-12, -5.595032562233806e-12, -6.087840225140439e-12,
      -6.1959708042329635e-12, -5.9436133015274264e-12, -5.37352696778431e-12,
      -4.543148119960301e-12, -3.5201702010557515e-12, -2.3778896912971794e-12,
      -1.1906007085198058e-12, -2.929606837480477e-14, 1.0421051583900646e-12,
      1.9698308116845267e-12, 2.7125100969008153e-12, 3.242545818953128e-12,
      3.5465960079059083e-12, 3.6252078009288754e-12, 3.4916912215571696e-12,
      3.170356764473216e-12, 2.6942670630279043e-12, 2.1026686700563603e-12,
      1.4382750623828673e-12, 7.445669387835789e-13, 6.326180440467951e-14,
      -5.679167661614844e-13, -1.11706709946503e-12, -1.5594625472637776e-12,
      -1.8783903409750336e-12, -2.0654690749746764e-12, -2.12046789363979e-12,
      -2.050676943318855e-12, -1.8699002329640683e-12, -1.5971578866311886e-12,
      -1.255194420517774e-12, -8.688930766078867e-13, -4.636936940285156e-13,
      -6.410371198676111e-14, 3.076204565590935e-13, 6.325602094717534e-13,
      8.959462439195068e-13, 1.0876703589615463e-12, 1.202492129188551e-12,
      1.2399527684000838e-12, 1.2040241640316183e-12, 1.102533900420914e-12,
      9.46416595495992e-13, 7.488477736954113e-13, 5.243187373546135e-13,
      2.8770964069212884e-13, 5.341356214855215e-14, -1.6544268901637147e-13,
      -3.5764439717766323e-13, -5.143752257865013e-13, -6.295289198291072e-13,
      -6.99842484719303e-13, -7.248573527822982e-13, -7.067243062542029e-13,
      -6.498755577703802e-13, -5.605930902936209e-13, -4.4650595675898747e-13,
      -3.1605069677491534e-13, -1.779284295875279e-13, -4.0589725213922643e-14,
      8.822567463923781e-14, 2.0187246456418785e-13, 2.950909669269615e-13,
      3.6419665263681197e-13, 4.071652421051155e-13, 4.2361678561967183e-13,
      4.147075928091963e-13, 3.8294341614103174e-13, 3.3193070959473806e-13,
      2.660849749653486e-13, 1.9031614677638374e-13, 1.0971069799188517e-13,
      2.922878307305111e-14, -4.656756351047106e-14, -1.1374218231972876e-13,
      -1.6915903292506452e-13, -2.1059724818288035e-13, -2.368051301946763e-13,
      -2.474948350883407e-13, -2.4328272517293346e-13, -2.255830608297029e-13,
      -1.9646475008099296e-13, -1.584822060383451e-13, -1.144919619369021e-13,
      -6.746658393707447e-14, -2.0316665444348532e-14, 2.4269622659239887e-14,
      6.396169578733003e-14, 9.689074922003743e-14, 1.217195047236635e-13,
      1.3767626436645261e-13, 1.4455415144128492e-13, 1.4267832657250487e-13,
      1.3284556641689137e-13, 1.1624181636915787e-13, 9.434413741553442e-14,
      6.88138475481997e-14, 4.1387622141313513e-14, 1.3772900265122035e-14,
      -1.2446801136214419e-14, -3.58920677991884e-14, -5.5449852495886883e-14,
      -7.03156989351503e-14, -8.001510684879182e-14, -8.440446931351587e-14,
      -8.365313977041256e-14, -7.820913532725433e-14, -6.87517148282845e-14,
      -5.6134560404079644e-14, -4.1323530978527215e-14, -2.533295163993185e-14,
      -9.164173403847737e-15, 6.25028553769996e-15, 2.0094284118385825e-14,
      3.1705243082185595e-14, 4.059967461879012e-14, 4.6486525726593104e-14,
      4.9268538207549076e-14, 4.903249291461722e-14, 4.60297688915848e-14,
      4.064908540322484e-14, 3.338359161508159e-14, 2.4794619075068423e-14,
      1.5474419171428558e-14, 6.010082299149077e-15, -3.0494048699038143e-15,
      -1.1221340137420706e-14, -1.8111499218967725e-14, -2.3429553268595052e-14,
      -2.6997368968689318e-14, -2.8750280900283776e-14, -2.8731818044686625e-14,
      -2.70827001119389e-14, -2.4025180577404123e-14, -1.984399272713458e-14,
      -1.4865248920831564e-14, -9.434653086226137e-15, -3.896318235019993e-15,
      1.4266554339347256e-15, 6.248877403757457e-15, 1.033590508075067e-14,
      1.3513544118397309e-14, 1.5672993019645693e-14, 1.6771867452386863e-14,
      1.6831370971908498e-14, 1.5930076718943996e-14, 1.4194940544740512e-14,
      1.179027436144781e-14, 8.905466920591651e-15, 5.742248304679452e-15,
      2.5022575501718985e-15, -6.244042786035684e-16, -3.469063023697824e-15,
      -5.892363480978581e-15, -7.789873705326133e-15, -9.09526360696949e-15,
      -9.781068543245767e-15, -9.857184950373917e-15, -9.367362296993139e-15,
      -8.384048621832039e-15, -7.002012272784642e-15, -5.331198659644206e-15,
      -3.4892881109585077e-15, -1.5944011535363268e-15, 2.416460329270607e-16,
      1.9191962429170214e-15, 3.355453550849935e-15, 4.4878570402917516e-15,
      5.2760390687435306e-15, 5.7023684365605324e-15, 5.771159184027548e-15,
      5.506695174603202e-15, 4.950276051817792e-15, 4.156529537832366e-15,
      3.189257401672512e-15, 2.117087836527407e-15, 1.009196477240285e-15,
      -6.866628662142457e-17, -1.057640184710148e-15, -1.9085553451885323e-15,
      -2.5839613120556627e-15, -3.0593303553311653e-15, -3.3234318261529854e-15,
      -3.377921653733035e-15, -3.2362321879848187e-15, -2.9218806172737464e-15,
      -2.4663378963191385e-15, -1.90661389307784e-15, -1.2827183061517259e-15,
      -6.351513806551847e-16, -2.5646128461471796e-18, 5.802890762362445e-16,
      1.0842220820544288e-15, 1.4868312993727748e-15, 1.7732357803870303e-15,
      1.936328933198239e-15, 1.9765692124501845e-15, 1.9013575813266824e-15,
      1.724069690796111e-15, 1.4628249783189854e-15, 1.1390833509705495e-15,
      7.761627631668218e-16, 3.9776813536003424e-16, 2.6614284250523932e-17,
      -3.167863237423106e-16, -6.151151302191795e-16, -8.549794293803821e-16,
      -1.0273635915438526e-15, -1.1277960683937437e-15, -1.1562451035205745e-15,
      -1.1167704637008196e-15, -1.0169702118124931e-15, -8.672701081884369e-16,
      -6.801084145339552e-16, -4.690706550114472e-16, -2.4802743020808295e-16,
      -3.0324019745522824e-17, 1.719362753232757e-16, 3.4848173187452075e-16,
      4.913112720419294e-16, 5.949699265774026e-16, 6.566579465390064e-16,
      6.761804818610709e-16, 6.557532564387451e-16, 5.996866328676743e-16,
      5.139756023806252e-16, 4.0582640829505424e-16, 2.8315168950253866e-16,
      1.5406530453251153e-16, 2.6405557894467608e-17, -9.268832766291297e-17,
      -1.9712663286465332e-16, -2.8213231621867186e-16, -3.444088706658316e-16,
      -3.8221084316543834e-16, -3.9532068627035523e-16, -3.849406422561674e-16,
      -3.5351250091457846e-16, -3.0448115675031985e-16, -2.42019828068808e-16,
      -1.7073556980077436e-16, -9.53733622240103e-17, -2.0535697110578464e-17,
      4.956763174702159e-17, 1.1132770206380776e-16, 1.618940898351297e-16,
      1.9927698092120722e-16, 2.22392344305804e-16, 2.310520904857204e-16,
      2.259041119048801e-16, 2.0832956318092539e-16, 1.8030658771549403e-16,
      1.4425087736299056e-16, 1.0284394885298679e-16, 5.885986024393703e-17,
      1.500033378141605e-17, -2.6253011829117645e-17, -6.27622748479196e-17,
      -9.282761230434526e-17, -1.1524925912690145e-16, -1.2935625021020038e-16,
      -1.3500283929818546e-16, -1.325353651789906e-16, -1.227337775536888e-16,
      -1.0673314225828083e-16, -8.593116334027517e-17, -6.188807775349984e-17,
      -3.622521056330939e-17, -1.0528058850766134e-17, 1.3740947448488265e-17,
      3.531581516585388e-17, 5.3183413818443e-17, 6.662108854272203e-17,
      7.521480682342287e-17, 7.88583430813788e-17, 7.77350425834591e-17,
      7.228457417668867e-17, 6.315774407188977e-17, 5.116287885269198e-17,
      3.7207488180132984e-17, 2.2238893233512206e-17, 7.187275039310748e-18,
      -7.085812977764675e-18, -1.983097432502763e-17, -3.044469545864119e-17,
      -3.8492125661064154e-17, -4.371847985912214e-17, -4.604931371410206e-17,
      -4.558053276632563e-17, -4.255951262308148e-17, -3.735910354191692e-17,
      -3.0446557136365806e-17, -2.234954070750245e-17, -1.3621399394590918e-17,
      -4.807698736901704e-18, 3.584152762604539e-18, 1.1110718336245897e-17,
      1.741267827608398e-17, 2.222860855263887e-17, 2.5402112041104286e-17,
      2.6882421405264864e-17, 2.6718954144809716e-17, 2.5050605971741358e-17,
      2.2090805582492614e-17, 1.8109513998608357e-17, 1.3413431920763039e-17,
      8.325680713471005e-18, 3.1661527457359284e-18, -1.7664054914797565e-18,
      -6.209696350018577e-18, -9.949896891151909e-18, -1.2829982920275912e-17,
      -1.4754170228230692e-17, -1.568852690847052e-17, -1.565802387381115e-17,
      -1.4740471962136406e-17, -1.3057935522749663e-17, -1.0766309211264606e-17,
      -8.043794912135013e-18, -5.079020080920396e-18, -2.059500717479773e-18,
      8.3892284289190325e-19, 3.46115392613681e-18, 5.68001417105185e-18,
      7.40126656793071e-18, 8.566371202817698e-18, 9.152995940963205e-18,
      9.173430060649979e-18, 8.671156300942589e-18, 7.715921255188722e-18,
      6.397702540320905e-18, 4.820002424889999e-18, 3.092901979251616e-18,
      1.326289189448224e-18, -3.763680050824513e-19, -1.9233929940315243e-18,
      -3.239178452681015e-18, -4.267214170539019e-18, -4.971791327535628e-18,
      -5.338390767009095e-18, -5.372836975022497e-18, -5.099363146893789e-18,
      -4.557783114389716e-18, -3.8000012052934694e-18, -2.8861104960590704e-18,
      -1.880333551047088e-18, -8.470486543968413e-19, 1.5287947657537955e-19,
      1.0652800706647071e-18, 1.845225663111841e-18, 2.4588553757166856e-18,
      2.884425795925243e-18, 3.1125906626658677e-18, 3.1459542791098776e-18,
      2.9979812865660546e-18, 2.6913754800074314e-18, 2.256061622085828e-18,
      1.7269162018107724e-18, 1.141395837573803e-18, 5.372061137077493e-19,
      -4.9859915824704863e-20, -5.878041508846e-19, -1.0499418692765973e-18,
      -1.4159985983985712e-18, -1.6727563655719809e-18, -1.8142481477933614e-18,
      -1.841525099161344e-18, -1.762043464628735e-18, -1.5887359937518114e-18,
      -1.3388454796000613e-18, -1.0326054398116648e-18, -6.918549363755193e-19,
      -3.3867141238665464e-19, 5.9022131385150154e-21, 3.229713171541982e-19,
      5.966934908576912e-19, 8.149378039910725e-19, 9.696812563580052e-19,
      1.0571406186233738e-18, 1.0776530374395707e-18, 1.0353319967777474e-18,
      9.375358914926073e-19, 7.941941761145909e-19, 6.170405970202136e-19,
      4.188043905972858e-19, 2.124087057256829e-19, 1.0221214553428064e-20,
      -1.766046343678222e-19, -3.3866744752289417e-19, -4.6871378498163325e-19,
      -5.61880828290094e-19, -6.157841150219664e-19, -6.304575725504119e-19,
      -6.081609034635928e-19, -5.530757232699314e-19, -4.709164830479546e-19,
      -3.684849976907714e-19, -2.5319833140315646e-19, -1.3261895966534122e-19,
      -1.401371731513171e-20, 9.603568305189102e-20, 1.9195250412487743e-19,
      2.6940252924577104e-19, 3.254422962072701e-19, 3.585766411779194e-19,
      3.687294347672009e-19, 3.5713601727137825e-19, 3.261696172480095e-19,
      2.791168190525247e-19, 2.199188513354459e-19, 1.5289608758567969e-19,
      8.247273217729307e-20, 1.2917316501458609e-20, -5.1887500307443186e-20,
      -1.0863506021696802e-19, -1.5473712395306587e-19, -1.8841424940727991e-19,
      -2.0873310008628994e-19, -2.155927488044253e-19, -2.0966477630610173e-19,
      -1.9229421073406031e-19, -1.6537002273233123e-19, -1.3117493321354475e-19,
      -9.222469663335316e-20, -5.11068191296944e-20, -1.0327917702874091e-20,
      2.782229013857483e-20, 6.138395149211526e-20, 8.881239804395977e-20,
      1.0903315410674925e-19, 1.2146589804379564e-19, 1.2601846394210856e-19,
      1.2305358656214472e-19, 1.1333242777957656e-19, 9.793992325289027e-20,
      7.819762345410478e-20, 5.556996618317455e-20, 3.156982267585308e-20,
      7.668740034471618e-21, -1.4783391639697427e-20, -3.4625427231360604e-20,
      -5.0936043124829446e-20, -6.30671633317876e-20, -7.06592281753458e-20,
      -7.363886988702308e-20, -7.220051434966822e-20, -6.677422150474554e-20,
      -5.798267631554584e-20, -4.65906288811229e-20, -3.345025113120687e-20,
      -1.9445836087943085e-20, -5.441032890628885e-21, 7.76858504434851e-21,
      1.9495344874582352e-20, 2.919002974576184e-20
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_5_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<5>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 0.5981561558974432), "design.b()[0] == 0.5981561558974432");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.5981561558974432));
    static_assert(almost_equal(design.b()[1], -2.990780779487216), "design.b()[1] == -2.990780779487216");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.990780779487216));
    static_assert(almost_equal(design.b()[2], 5.981561558974432), "design.b()[2] == 5.981561558974432");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 5.981561558974432));
    static_assert(almost_equal(design.b()[3], -5.981561558974432), "design.b()[3] == -5.981561558974432");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -5.981561558974432));
    static_assert(almost_equal(design.b()[4], 2.990780779487216), "design.b()[4] == 2.990780779487216");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 2.990780779487216));
    static_assert(almost_equal(design.b()[5], -0.5981561558974432), "design.b()[5] == -0.5981561558974432");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -0.5981561558974432));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.9974917463268365), "design.a()[1] == -3.9974917463268365");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.9974917463268365));
    static_assert(almost_equal(design.a()[2], 6.454401116515665), "design.a()[2] == 6.454401116515665");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 6.454401116515665));
    static_assert(almost_equal(design.a()[3], -5.233238163483254), "design.a()[3] == -5.233238163483254");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -5.233238163483254));
    static_assert(almost_equal(design.a()[4], 2.1178184104493667), "design.a()[4] == 2.1178184104493667");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 2.1178184104493667));
    static_assert(almost_equal(design.a()[5], -0.3380475519430605), "design.a()[5] == -0.3380475519430605");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.3380475519430605));
    std::cout << "max_deviation(cheby1,highpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.5981561558974432, -0.5996564832725984, -0.27630004401433217, -0.08535160650601203,
      0.028008436997584152, 0.0909256736496526, 0.11847257227719649, 0.1206538318542768,
      0.10530921444638358, 0.07912379301953609, 0.04783284234593421, 0.01614935111868715,
      -0.012340860622467129, -0.035216525760431154, -0.05116517550504729,
      -0.059845064231029005, -0.06169110057202842, -0.05769475617691919,
      -0.049184986905112194, -0.03763098589301617, -0.024480249882073257,
      -0.01103837873757535, 0.001608912470115187, 0.012635490745670087,
      0.021482899884974163, 0.027844804709445142, 0.03163577502542908, 0.032951556482909206,
      0.032026603911224916, 0.029193068703951275, 0.02484388737238942, 0.01940128864418328,
      0.013291019693393052, 0.0069219186547133035, 0.000670107840488026,
      -0.005133008410948582, -0.01020966275165873, -0.014342083531740414,
      -0.017376586454961672, -0.019225489692178452, -0.019866805417090364,
      -0.01934160688475456, -0.017749000708184165, -0.015238735551788285,
      -0.01200162835339609, -0.00825816018316352, -0.004245758571887838,
      -0.0002054175996681097, 0.0036316069111397343, 0.007056263034642451,
      0.00989260115324896, 0.012006472215777091, 0.013311537768143485, 0.013772284637637647,
      0.013403938137324545, 0.012269371892070967, 0.010473303939202656, 0.00815423381140213,
      0.005474703094122325, 0.002610545284136047, -0.00026017372943515533,
      -0.0029678352982627785, -0.005360934517627148, -0.0073141939995590485,
      -0.008734708197280276, -0.00956584397608929, -0.009788774812219174,
      -0.009421676843656426, -0.008516755649248642, -0.007155395034236595,
      -0.0054418168670219876, -0.0034957096905573436, -0.0014443210220619878,
      0.0005854863976409727, 0.0024747390712412834, 0.0041189945302143715,
      0.005433771321453108, 0.00635850900876201, 0.006858901245375186, 0.006927549958901685,
      0.006582991008922092, 0.005867235442988283, 0.004842050634973991,
      0.003584268165028052, 0.0021804475661601243, 0.0007212456306667902,
      -0.0007041602013803075, -0.0020132675246107377, -0.0031347766830715834,
      -0.004012218110735334, -0.004606512343791934, -0.004897367595345998,
      -0.004883493449473829, -0.004581680282159471, -0.004024858400581834,
      -0.003259305163331592, -0.0023412098320887264, -0.0013328328326366722,
      -0.00029850764361829055, 0.0006992701904525156, 0.0016034403913699137,
      0.0023654654982374736, 0.0029477529074557335, 0.0033253031524693253,
      0.003486527563843319, 0.003433230509108787, 0.003179801029240094,
      0.002751703060716206, 0.0021833902113477834, 0.0015157984682021043,
      0.0007935871273039271, 6.23041971392472e-05, -0.0006343522381904857,
      -0.001257019861960442, -0.0017727714935857116, -0.00215672414531315,
      -0.002393088346265923, -0.0024756250315009793, -0.00240751402216835,
      -0.0022006726900121367, -0.0018745938752910297, -0.001454796924579933,
      -0.0009710036654696948, -0.0004551615364426832, 6.056127726397501e-05,
      0.0005456887359131717, 0.000973149619641688, 0.0013206992430848416,
      0.0015719814191403271, 0.001717186747762378, 0.0017532894663351457,
      0.00168387093842743, 0.0015185618670105006, 0.0012721561733146647,
      0.0009634661159508241, 0.0006139998747241465, 0.0002465490622008521,
      -0.00011622563172627651, -0.000453126967228668, -0.000745597379699525,
      -0.000978677568216743, -0.0011417021895155002, -0.0012287053091913189,
      -0.0012385268496404559, -0.0011746294061129843, -0.0010446514303809398,
      -0.0008597370018571622, -0.0006336935041626542, -0.00038203600871676915,
      -0.00012098078294015273, 0.00013354992201139465, 0.0003668535717127478,
      0.0005662524639113764, 0.0007217369884831182, 0.0008264174900231278,
      0.0008767680514847154, 0.0008726586898724241, 0.0008171851449514053,
      0.0007163169244822718, 0.0005783939291905053, 0.00041350934207429104,
      0.0002328212150369065, 4.7837177422674e-05, -0.00013028404746318544,
      -0.00029137391369648267, -0.0004268032059189682, -0.000529911441624234,
      -0.0005962974153360919, -0.0006239609857513844, -0.0006132955179159708,
      -0.0005669392504984356, -0.0004895017633896417, -0.00038718825585787667,
      -0.0002673491958457724, -0.00013798586826997564, -7.243357637826782e-06,
      0.00011707840895546509, 0.00022796760419280308, 0.00031957365812095516,
      0.0003874922307036579, 0.000428949775249061, 0.00044288204376180117,
      0.00042990744986560873, 0.0003922023715352077, 0.0003332909008322829,
      0.00025776594936170413, 0.00017096178970629414, 7.859993163547444e-05,
      -1.3569339195119968e-05, -0.00010010834558721103, -0.0001761970428573688,
      -0.00023788555853970008, -0.0002822820704602827, -0.00030766830570568666,
      -0.00031353962532988493, -0.0003005712760813094, -0.0002705166715764799,
      -0.00022604727572088845, -0.00017054661137540412, -0.00010787297273411728,
      -4.210650599651127e-05, 2.2703573734131008e-05, 8.277669543993626e-05,
      0.00013481031421758158, 0.0001761500706939376, 0.00020491272502328893,
      0.0002200570731936155, 0.00022140137897247057, 0.00020958909290536487,
      0.00018600759353557157, 0.00015266721463828522, 0.00011204978909114141,
      6.693725821494691e-05, 2.0231521076163287e-05, -2.5223369354905506e-05,
      -6.680627683794322e-05, -0.00010226222962944219, -0.0001298165217444746,
      -0.00014825445045602958, -0.00015696377718537506, -0.00015593935479950945,
      -0.00014575162970502451, -0.00012748277285447134, -0.00010263591045273329,
      -7.30242285385977e-05, -4.0647560332146614e-05, -7.5644064961125925e-06,
      2.4232808061925208e-05, 5.2932037307388814e-05, 7.699926800306198e-05,
      9.525462465607079e-05, 0.00010692355605185401, 0.00011166138327553537,
      0.00010955115372601287, 0.00010107632631369483, 8.707122076704736e-05,
      6.865332461025519e-05, 4.71424092576458e-05, 2.3971926953531204e-05,
      5.983299018832332e-07, -2.158621977704764e-05, -4.13327675159845e-05,
      -5.760188528466741e-05, -6.961413219678468e-05, -7.688250494219476e-05,
      -7.922590347862589e-05, -7.676381058300158e-05, -6.989348383440393e-05,
      -5.92519241976402e-05, -4.5665666564908105e-05, -3.0091997880283552e-05,
      -1.3555526275309398e-05, 2.915906098965622e-06, 1.835214422111292e-05,
      3.189504036838352e-05, 4.2843308441081876e-05, 5.06857571410305e-05,
      5.512154648767192e-05, 5.60669501631491e-05, 5.3648930874864684e-05,
      4.8186599263183106e-05, 4.016228695931406e-05, 3.018448760871154e-05,
      1.8945282263325942e-05, 7.175054494700146e-06, -4.402686182815181e-06,
      -1.5113708041403803e-05, -2.4370326956788926e-05, -3.170160837653628e-05,
      -3.67750865643689e-05, -3.9409161743326565e-05, -3.957593072389509e-05,
      -3.739478484606547e-05, -3.311763728487639e-05, -2.710709136667354e-05,
      -1.980921006273893e-05, -1.172277896340503e-05, -3.3670631652476466e-06,
      4.749957268630947e-06, 1.2161020867067193e-05, 1.846506973241653e-05,
      2.3347486471388622e-05, 2.6594161865252833e-05, 2.8098884967485714e-05,
      2.7863968629802507e-05, 2.5994427842329458e-05, 2.268639271559162e-05,
      1.8210742982658297e-05, 1.2893181640027509e-05, 7.0921120301957206e-06,
      1.1757410306277408e-06, -4.500197769794402e-06, -9.612816688455694e-06,
      -1.3889437965647403e-05, -1.7121080464746093e-05, -1.9171475020709037e-05,
      -1.9981309803995185e-05, -1.9567704645897903e-05, -1.801919532395447e-05,
      -1.5486759474876442e-05, -1.2171621915298193e-05, -8.310728859079089e-06,
      -4.160871706967698e-06, 1.7530469191014115e-08, 3.976013314571261e-06,
      7.492126708471129e-06, 1.0381220181952309e-05, 1.2505376773368794e-05,
      1.3779116653888024e-05, 1.4171702617691063e-05, 1.3706089177673384e-05,
      1.2454753204274775e-05, 1.0532815900653571e-05, 8.089004539174792e-06,
      5.295101338533284e-06, 2.3345823674538366e-06, -6.088395849950448e-07,
      -3.3620859556129223e-06, -5.772385337495111e-06, -7.715239422883053e-06,
      -9.100300542207875e-06, -9.874922800761441e-06, -1.0025298786407995e-05,
      -9.575241140441134e-06, -8.582804380653414e-06, -7.135059784603197e-06,
      -5.341428920199903e-06, -3.3260453570129233e-06, -1.2196469359179184e-06,
      8.484975952014594e-07, 2.758152194896759e-06, 4.404747038082983e-06,
      5.704738564509899e-06, 6.599445963776096e-06, 7.057217148221669e-06,
      7.073883700305747e-06, 6.671567535384154e-06, 5.895996157823903e-06,
      4.812563321657002e-06, 3.501433655998446e-06, 2.0520306830595884e-06,
      5.572663211145992e-07, -8.921335138674141e-07, -2.212876850462575e-06,
      -3.3336393021834235e-06, -4.19865285852459e-06, -4.77018720261941e-06,
      -5.029834908858548e-06, -4.978587215510828e-06, -4.635759248749126e-06,
      -4.0368884947137085e-06, -3.2307845185307877e-06, -2.2759487713130258e-06,
      -1.2366090939487548e-06, -1.7862348656491098e-07, 8.34497895698987e-07,
      1.7452235895226938e-06, 2.5050880933000172e-06, 3.0770815585880263e-06,
      3.4372372000204433e-06, 3.5753646251351005e-06, 3.49493048034192e-06,
      3.2121381349314353e-06, 2.7543027573366717e-06, 2.157654737014801e-06,
      1.4647312288887594e-06, 7.215315719342435e-07, -2.5382916669861682e-08,
      -7.316704381283268e-07, -1.3577133144651396e-06, -1.8707121644751222e-06,
      -2.246267374579869e-06, -2.4693812477786197e-06, -2.534851945023732e-06,
      -2.4470677952848724e-06, -2.2192455431692817e-06, -1.8721866873158596e-06,
      -1.4326506620805416e-06, -9.314610888343357e-07, -4.014710119600986e-07,
      1.2448522649063072e-07, 6.15531716861478e-07, 1.0444733450281207e-06,
      1.389210373087562e-06, 1.6337777502626237e-06, 1.7689673827014237e-06,
      1.7925184286895802e-06, 1.708887000406122e-06, 1.5286309167973638e-06,
      1.2674660377482686e-06, 9.450671599775273e-07, 5.836977300046109e-07,
      2.06758333824104e-07, -1.6265598876891624e-07, -5.031047959586463e-07,
      -7.959828295666563e-07, -1.026471179779056e-06, -1.1842148273913438e-06,
      -1.2637008502488936e-06, -1.2643306201092855e-06, -1.1901977527859716e-06,
      -1.0496003500170091e-06, -8.543302815115957e-07, -6.187931945589168e-07,
      -3.5902013123429497e-07, -9.163485072408643e-08, 1.671597853231836e-07,
      4.025174522202336e-07, 6.01754809132305e-07, 7.549878551847257e-07,
      8.555694923685472e-07, 9.003128462756541e-07, 8.894983679982984e-07,
      8.266756239257336e-07, 7.182822440246228e-07, 5.731121291294799e-07,
      4.016722459133839e-07, 2.1547186314691426e-07, 2.628977873915795e-08,
      -1.545359981502159e-07, -3.1675530210637955e-07, -4.517546726574787e-07,
      -5.529807244578715e-07, -6.162195764717558e-07, -6.397233644547538e-07,
      -6.24184369527263e-07, -5.725662745412033e-07, -4.898100062951847e-07,
      -3.824381198639243e-07, -2.580864231522003e-07, -1.249943369960513e-07,
      8.513724749564255e-09, 1.3452483112550619e-07, 2.459836812329545e-07,
      3.370646890728979e-07, 4.0345189329026793e-07, 4.4251497598937874e-07,
      4.533764291016731e-07, 4.3687160053629436e-07, 3.9540959305995895e-07,
      3.3274843140253233e-07, 2.537022775922036e-07, 1.6380155949283496e-07,
      6.892856763337499e-08, -2.504865614258161e-08, -1.1262240931243883e-07,
      -1.8895199130262648e-07, -2.5011487789156477e-07, -2.932904681676516e-07,
      -3.168690756245028e-07, -3.204836373977906e-07, -3.049663157997856e-07,
      -2.722364917388692e-07, -2.251303642920089e-07, -1.6718528706202193e-07,
      -1.0239395944286776e-07, -3.4944580720798474e-08, 3.103693918328261e-08,
      9.1727583149591e-08, 1.4381732361288358e-07, 1.846778927095e-07, 2.12482415343796e-07,
      2.262714081479072e-07, 2.259640529855423e-07, 2.123169454282602e-07,
      1.868355079138394e-07, 1.516457832422672e-07, 1.0933626164830937e-07,
      6.278066020859949e-08, 1.4953127201535475e-08, -3.1252809216714575e-08,
      -7.319104292697996e-08, -1.08606329789668e-07, -1.3574711124349162e-07,
      -1.5344265681728756e-07, -1.6114183509524431e-07, -1.58913231606346e-07,
      -1.474086314889913e-07, -1.2779394444291143e-07, -1.0165336024169918e-07,
      -7.08738021009771e-08, -3.751753949792181e-08, -3.6911100613369165e-09,
      2.8581508605174322e-08, 5.7474203478816116e-08, 8.145629550805983e-08,
      9.936753593852762e-08, 1.1046727931114806e-07, 1.1445627944866963e-07,
      1.1147125428372732e-07, 1.020539672686891e-07, 8.709798777851606e-08,
      6.77774465643754e-08, 4.5462940423824644e-08, 2.163022981504014e-08,
      -2.2324965198847643e-09, -2.471323363009203e-08, -4.4555627612496614e-08,
      -6.0725080096429e-08, -7.24582827794158e-08, -7.929412222822468e-08,
      -8.108510419087794e-08, -7.798964264726478e-08, -7.044667175203089e-08,
      -5.9135007263717175e-08, -4.4920658336732084e-08, -2.879583508369175e-08,
      -1.181369194525594e-08, 4.977112690640908e-09, 2.059416306906433e-08,
      3.4175882746151796e-08, 4.502612891196219e-08, 5.264667252934753e-08,
      5.6756279109136954e-08, 5.7295964249393433e-08, 5.4420837531296015e-08,
      4.8479719408276135e-08, 3.99843763591689e-08, 2.9570736536586653e-08,
      1.795479839923065e-08, 5.886116401710617e-09, -5.898260054406969e-09,
      -1.6716695663365386e-08, -2.5980355181811085e-08, -3.3223145903822326e-08,
      -3.8122836784554385e-08, -4.051256814969278e-08, -4.038257508030814e-08,
      -3.7872535261496824e-08, -3.325548471562415e-08, -2.691469380985765e-08,
      -1.9315239078855887e-08, -1.097222899783604e-08, -2.417737037396532e-09,
      5.831535823572937e-09, 1.3303995996514999e-08, 1.9598668414674656e-08,
      2.4405197293620238e-08, 2.751744301152751e-08, 2.8840206914264935e-08,
      2.8389046557976216e-08, 2.628355426287168e-08, 2.273483867732253e-08,
      1.8028252940074086e-08, 1.2502639315679985e-08, 6.527499554257385e-09,
      4.795490061997155e-10, -5.279927431766658e-09, -1.0425621141024426e-08,
      -1.468554290706814e-08, -1.785430603409585e-08, -1.9801777016484518e-08,
      -2.0476825127574536e-08, -1.99062060425811e-08, -1.818890038112233e-08,
      -1.548647988741142e-08, -1.2010278755487283e-08, -8.006295712989802e-09,
      -3.738838115262787e-09, 5.260593174117167e-10, 4.536449260549531e-09,
      8.06862544816798e-09, 1.0938865685366482e-08, 1.3012196407662486e-08,
      1.4207816772741684e-08, 1.4501036676190528e-08, 1.3921796758736173e-08,
      1.2550036931979421e-08, 1.0508352259513342e-08, 7.952512375937424e-09,
      5.060516721224989e-09, 2.020909193275481e-09, -9.789183111313137e-10,
      -3.7637415528728075e-09, -6.180223375504025e-09, -8.104830323827992e-09,
      -9.449572974568264e-09, -1.0165344694186169e-08, -1.0242787287902908e-08,
      -9.710761927161311e-09, -8.632641179134773e-09, -7.100755442248127e-09,
      -5.2294187175959245e-09, -3.147020356347027e-09, -9.876991373788414e-10,
      1.116886332703327e-09, 3.0452095234272446e-09, 4.692528176306546e-09,
      5.976195976482277e-09, 6.8393899705619004e-09, 7.253116407755056e-09,
      7.216466630663813e-09, 6.7551995611551094e-09, 5.918822225387041e-09,
      4.77641955610448e-09, 3.4115454746944507e-09, 1.916526395510983e-09,
      3.8654463000831186e-10, -1.086137072613246e-09, -2.417475876747802e-09,
      -3.536185708893006e-09, -4.3872824435768215e-09, -4.934479832270996e-09,
      -5.161354764448482e-09, -5.071277454574275e-09, -4.686175380042361e-09,
      -4.0442651221416495e-09, -3.1969402378774766e-09, -2.205043319229525e-09,
      -1.134774842853454e-09, -5.3499648670521574e-11, 9.742957273243007e-10,
      1.8906638221711177e-09, 2.6472787487097546e-09, 3.2077885294426685e-09,
      3.549336473699098e-09, 3.663205204620125e-09, 3.5545912295237997e-09,
      3.2415689238964522e-09, 2.7533476259686867e-09, 2.127961888203235e-09,
      1.4095610996582683e-09, 6.454796657912526e-10, -1.1672758869162783e-10,
      -8.321077464060204e-10, -1.4608304893363664e-09, -1.9702739690425415e-09,
      -2.3365753452711904e-09, -2.5455823897226367e-09, -2.5931812842439865e-09,
      -2.4850139162699163e-09, -2.235633361906364e-09, -1.867176902969381e-09,
      -1.4076602844652612e-09, -8.890138733928191e-10, -3.449903142037108e-10,
      1.9092591718889938e-10, 6.874836022061553e-10, 1.1173949292406615e-09,
      1.4587407488958455e-09, 1.6959848950808802e-09, 1.820558098259406e-09,
      1.8309995246847477e-09, 1.732670749295974e-09, 1.5370814660348245e-09,
      1.2608871291241568e-09, 9.246349565249722e-10, 5.513455963133648e-10,
      1.650228968433022e-10, -2.1081637139543204e-10, -5.545069849810403e-10,
      -8.474188221172842e-10, -1.0748990243642387e-09, -1.2269297232636312e-09,
      -1.2984773561736197e-09, -1.289529080538015e-09, -1.2048305254515827e-09,
      -1.053356026275018e-09, -8.475566683835139e-10, -6.024422245869289e-10,
      -3.345599507001845e-10, -6.093600169693059e-11, 2.0195600469598774e-10,
      4.3913973488694944e-10, 6.379428976705925e-10, 7.886255579654906e-10,
      8.848022165786292e-10, 9.236435119565895e-10, 9.058571664947006e-10,
      8.354608677391626e-10, 7.193714079575071e-10, 5.668439916321472e-10,
      3.8880270008854904e-10, 1.9710738855035161e-10, 3.803676424924133e-12,
      -1.795987533831156e-10, -3.427783721723388e-10, -4.771496299427607e-10,
      -5.76279475501823e-10, -6.361548316051071e-10, -6.552930233544361e-10,
      -6.346968596643371e-10, -5.776651605148824e-10, -4.894775013738931e-10,
      -3.769783973755511e-10, -2.480907722952947e-10, -1.1129117364540293e-10,
      2.492024421450449e-11, 1.5252336764837683e-10, 2.644270146958083e-10,
      3.548394056072576e-10, 4.1954242390340597e-10, 4.5605849733569955e-10,
      4.637058601101577e-10, 4.435447771228883e-10, 3.9822362057455024e-10,
      3.3173914294918284e-10, 2.491296104593957e-10, 1.561224517074861e-10,
      5.875963036857671e-11, -3.697594843187857e-11, -1.2551097053517013e-10,
      -2.0198967340614465e-10, -2.6252326277455246e-10, -3.0436911001124937e-10,
      -3.260328169773804e-10, -3.2729115623443315e-10, -3.0913867560720643e-10,
      -2.736651218940963e-10, -2.2387455272947204e-10, -1.6345988282208895e-10,
      -9.65485248055716e-11, -2.7435673069259614e-11, 3.967835756377323e-11,
      1.0093142583702018e-10, 1.5301012512652266e-10, 1.9331688082571275e-10,
      2.2008598439475434e-10, 2.3244438067791633e-10, 2.304165096559524e-10,
      2.148758471323621e-10, 1.8744880073980153e-10, 1.5037913743742367e-10,
      1.0636302319545376e-10, 5.836596449076253e-11, 9.433419550108688e-12,
      -3.749339502230956e-11, -7.974588743902436e-11, -1.1507153947895806e-10,
      -1.417452482734049e-10, -1.5864366205469917e-10, -1.6528005471145946e-10,
      -1.6179974500331472e-10, -1.489383980325627e-10, -1.2794761800141212e-10,
      -1.004939436034678e-10, -6.853860932512041e-11, -3.4206187063555266e-11,
      3.4954535931711847e-13, 3.307443553106377e-11, 6.213015055923302e-11,
      8.59915281715346e-11, 1.0352031784238038e-10, 1.1401219019044643e-10,
      1.172156364313988e-10, 1.1332311333606271e-10, 1.0293641098407857e-10,
      8.700964061382306e-11, 6.677438469248249e-11, 4.3652367715170666e-11,
      1.9161463140592592e-11, -5.179058891038724e-12, -2.793840284916652e-11,
      -4.7854181859845896e-11, -6.389821047580589e-11, -7.532500819841571e-11,
      -8.170105258495584e-11, -8.291406132602865e-11, -7.916280083655932e-11,
      -7.092904384207072e-11, -5.893426855235438e-11, -4.4084458068426596e-11,
      -2.7406886076696947e-11, -9.983044974874487e-12, 7.118117137282005e-12,
      2.2902720681238804e-11, 3.6506766520585e-11, 4.724039986537709e-11,
      5.461956244507511e-11, 5.838382277192793e-11, 5.850005467025835e-11,
      5.5152487978521066e-11, 4.872043337411409e-11, 3.9745643603514016e-11,
      2.8891783158894176e-11, 1.6898815384863392e-11, 4.535269262848447e-12,
      -7.448681730997006e-12, -1.8364597908826938e-11, -2.7623230464733553e-11,
      -3.476415361447137e-11, -3.9476230246847804e-11, -4.160818162319563e-11,
      -4.116915478495342e-11, -3.831977809636348e-11, -3.335473186776136e-11,
      -2.6678308719449964e-11, -1.8774775446009518e-11, -1.017556049592062e-11,
      -1.4253727747807232e-12, 6.950689660621588e-12, 1.4477148795545849e-11,
      2.075365098939544e-11, 2.547469496970431e-11, 2.8442720033427145e-11,
      2.9574128684737874e-11, 2.889825786017153e-11, 2.654972893213498e-11,
      2.2754975501066448e-11, 1.7814050259017068e-11, 1.2079033553026878e-11,
      5.930497851805956e-12, -2.464789504094259e-13, -6.085309998956949e-12,
      -1.1258598354208574e-11, -1.5495435205570156e-11, -1.859445313579958e-11,
      -2.043208527737464e-11, -2.0965793330984032e-11, -2.023233720380862e-11,
      -1.8341448284388592e-11, -1.5465521079930002e-11, -1.1826141078898944e-11,
      -7.67841085685308e-12, -3.294116185954771e-12, 1.0552121005524414e-12,
      5.1143338810232795e-12, 8.658532613080031e-12, 1.1505298491161033e-11,
      1.35229049132013e-11, 1.4635534077180237e-11, 1.4824829525363923e-11,
      1.4127971043684422e-11, 1.263256787584626e-11, 1.0468838765074152e-11,
      7.799683158664931e-12, 4.809340897893686e-12, 1.691384616107204e-12,
      -1.36321047682947e-12, -4.177218329106307e-12, -6.596916945341103e-12,
      -8.499943047245512e-12, -9.80088178110615e-12, -1.0454379734551785e-11,
      -1.045572700434435e-11, -9.839006493732427e-12, -8.673047266443072e-12,
      -7.0555361719782885e-12, -5.1057322589457475e-12, -2.9562877911471137e-12,
      -7.447060943286507e-13, 1.3950398486605745e-12, 3.3402410828954286e-12,
      4.986115469083107e-12, 6.251061860917576e-12, 7.080268907404691e-12,
      7.447551369957268e-12, 7.355398267335662e-12, 6.833323675135015e-12,
      5.934706572079603e-12, 4.7323856678788806e-12, 3.313334804741398e-12,
      1.7727818123914474e-12, 2.081475824739067e-13, -1.2868269822993898e-12,
      -2.627428852863277e-12, -3.74250701030888e-12, -4.577967466808675e-12,
      -5.099077027381424e-12, -5.291502029552643e-12, -5.161086932513296e-12,
      -4.732451854759912e-12, -4.0465538229894714e-12, -3.157410162690619e-12,
      -2.1282215887426237e-12, -1.0271555913681907e-12, 7.694285973430012e-14,
      1.1186559621506463e-12, 2.039680141493539e-12, 2.7918994733629623e-12,
      3.339695953662228e-12, 3.6614000434664854e-12, 3.749840788618066e-12,
      3.6120101668824103e-12, 3.267907902469027e-12, 2.7486779571628457e-12,
      2.0941839479098254e-12, 1.3501961899699446e-12, 5.653769733043917e-13,
      -2.1174716982472447e-13, -9.356465671423292e-13, -1.5663224987711396e-12,
      -2.0713816296784682e-12, -2.427552249576115e-12, -2.6215819418448426e-12,
      -2.6504960272593596e-12, -2.5212349923552988e-12, -2.2497248641610928e-12,
      -1.859465182590726e-12, -1.3797433003033037e-12, -8.436001304122438e-13,
      -2.856805990155056e-13, 2.598981064229137e-13, 7.615354255496655e-13,
      1.1918833788263868e-12, 1.5292402308565892e-12, 1.7585374200194426e-12,
      1.8718827273612115e-12, 1.8686508263006492e-12, 1.7551395713021604e-12,
      1.543835089463593e-12, 1.2523496052181419e-12, 9.021119228714405e-13,
      5.169009243145339e-13, 1.2131698469665503e-13, -2.6071509315849974e-13,
      -6.07324790981916e-13, -8.998809435082021e-13, -1.1239232622918217e-12,
      -1.2697985379429222e-12, -1.332979387601916e-12, -1.314063337417416e-12,
      -1.218469039724008e-12, -1.0558634457595182e-12, -8.393678852440954e-13,
      -5.846015601934867e-13, -3.0862750527403395e-13, -2.8868424101483296e-14,
      2.379419398013469e-13, 4.767117784816388e-13, 6.747972255648253e-13,
      8.226214518358244e-13, 9.14080049264624e-13, 9.467199379648959e-13,
      9.216930854634786e-13, 8.434995700804507e-13, 7.19546210026845e-13,
      5.595565074137925e-13, 3.7487457186123753e-13, 1.7770971988140748e-13,
      -1.963049351646281e-14, -2.0547287252114678e-13, -3.694353070136505e-13,
      -5.02972785790232e-13, -5.997862234546817e-13, -6.560771232446275e-13,
      -6.706410994615299e-13, -6.448031730047839e-13, -5.822069530624242e-13,
      -4.884778196945612e-13, -3.7078661566223145e-13, -2.3734484773977244e-13,
      -9.686482202639032e-14, 4.1981540536854444e-14, 1.7107315200594416e-13,
      2.8329090817096003e-13, 3.728859826767746e-13, 4.357478364954774e-13,
      4.695613551100198e-13, 4.738496336241187e-13, 4.4990587120462483e-13,
      4.0062420925325346e-13, 3.3024480557703663e-13, 2.440327049254965e-13,
      1.4791295464232098e-13, 4.808582439516029e-14, -4.935408492052975e-14,
      -1.387725338500137e-13, -2.1530454651067036e-13, -2.751016628979246e-13,
      -3.155061567375078e-13, -3.3514574741441133e-13, -3.3394737279781853e-13,
      -3.130734488520946e-13, -2.747884439641196e-13, -2.2226730468073082e-13,
      -1.5936010214317256e-13, -9.032910340238275e-14, -1.9575252809820397e-14,
      4.8629215151936857e-14, 1.103865485790253e-13, 1.6238424199208856e-13,
      2.0206016780894735e-13, 2.2771470559284806e-13, 2.385660180449426e-13,
      2.347481848176892e-13, 2.1725529781206925e-13, 1.8783765304366265e-13,
      1.4885868416455512e-13, 1.0312315026764894e-13, 5.3688238949249805e-14,
      3.669644564734326e-15, -4.394565314386273e-14, -8.646919511901838e-14,
      -1.2165430947414733e-13, -1.478057607333236e-13, -1.6385106190576414e-13,
      -1.6937124268690461e-13, -1.6459137906509985e-13, -1.5033355196733959e-13,
      -1.2793698350777174e-13, -9.915179065582708e-14, -6.601401816600457e-14,
      -3.0710317759984875e-14, 4.5591857786066695e-15, 3.771164116948632e-14,
      6.689843653909952e-14, 9.060219315616739e-14, 1.077091003087662e-13,
      1.1755360763073883e-13, 1.199342813274763e-13, 1.151013976638634e-13,
      1.0371848754200069e-13, 8.680146967563109e-14, 6.564014397006462e-14,
      4.170760937782497e-14, 1.6563592756273318e-14, -8.242278450337635e-15,
      -3.12615395875108e-14, -5.122720252744554e-14, -6.711913584846116e-14,
      -7.821142937548352e-14, -8.409988728730674e-14, -8.470906573388953e-14,
      -8.027951054657336e-14, -7.133698657699013e-14, -5.864646075638933e-14,
      -4.315435742460749e-14, -2.5923113341100546e-14, -8.062303952528655e-15,
      9.339408612928301e-15, 2.52775265818189e-14, 3.88866795764069e-14,
      4.948448517143957e-14
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.5981561558974432, -0.5996564832725981, -0.2763000440143318, -0.08535160650601177,
      0.028008436997584076, 0.09092567364965193, 0.11847257227719503, 0.12065383185427457,
      0.1053092144463808, 0.0791237930195332, 0.047832842345931756, 0.01614935111868563,
      -0.012340860622467318, -0.0352165257604298, -0.051165175505044416,
      -0.059845064231024855, -0.06169110057202344, -0.05769475617691394,
      -0.04918498690510731, -0.03763098589301223, -0.024480249882070718,
      -0.011038378737574461, 0.0016089124701143692, 0.012635490745667687,
      0.021482899884970444, 0.02784480470944049, 0.03163577502542396, 0.032951556482904105,
      0.032026603911220315, 0.02919306870394759, 0.024843887372387016, 0.019401288644182415,
      0.013291019693393889, 0.006921918654715884, 0.0006701078404922718,
      -0.005133008410942866, -0.010209662751651846, -0.014342083531732757,
      -0.017376586454953696, -0.01922548969217064, -0.019866805417083192,
      -0.019341606884748466, -0.017749000708179502, -0.015238735551785289,
      -0.012001628353394871, -0.00825816018316405, -0.00424575857188997,
      -0.0002054175996715815, 0.0036316069111352644, 0.007056263034637378,
      0.009892601153243696, 0.012006472215772043, 0.01331153776813902, 0.013772284637634078,
      0.013403938137322121, 0.012269371892069858, 0.010473303939202948, 0.00815423381140383,
      0.005474703094125368, 0.0026105452841402896, -0.00026017372942992514,
      -0.0029678352982568305, -0.005360934517620795, -0.00731419399955263,
      -0.00873470819727414, -0.009565843976083774, -0.009788774812214577,
      -0.009421676843653004, -0.008516755649246588, -0.007155395034236012,
      -0.005441816867022879, -0.0034957096905596204, -0.001444321022065477,
      0.0005854863976365175, 0.0024747390712361638, 0.004118994530208922,
      0.005433771321447672, 0.006358509008756916, 0.006858901245370733,
      0.0069275499588981266, 0.006582991008919623, 0.005867235442987024,
      0.004842050634973976, 0.0035842681650292327, 0.00218044756616238,
      0.0007212456306699381, -0.0007041602013764938, -0.002013267524606512,
      -0.003134776683067212, -0.00401221811073108, -0.004606512343788046,
      -0.004897367595342691, -0.004883493449471279, -0.004581680282157802,
      -0.004024858400581112, -0.0032593051633318217, -0.002341209832089857,
      -0.0013328328326386006, -0.00029850764362086965, 0.0006992701904494662,
      0.0016034403913665956, 0.0023654654982340965, 0.0029477529074525013,
      0.0033253031524664227, 0.003486527563840903, 0.0034332305091069764,
      0.0031798010292389644, 0.002751703060715786, 0.0021833902113480535,
      0.0015157984682030023, 0.0007935871273053553, 6.230419714108374e-05,
      -0.000634352238188377, -0.0012570198619582037, -0.0017727714935834838,
      -0.0021567241453110645, -0.0023930883462640945, -0.002475625031499501,
      -0.0024075140221672866, -0.002200672690011525, -0.0018745938752908783,
      -0.0014547969245802285, -0.000971003665470402, -0.0004551615364437494,
      6.056127726261686e-05, 0.0005456887359116003, 0.0009731496196399909,
      0.0013206992430831108, 0.0015719814191386553, 0.0017171867477608533,
      0.0017532894663338486, 0.0016838709384264263, 0.0015185618670098392,
      0.001272156173314371, 0.0009634661159508999, 0.0006139998747245702,
      0.00024654906220158176, -0.00011622563172529964, -0.000453126967227515,
      -0.0007455973796982744, -0.0009786775682154756, -0.0011417021895142939,
      -0.001228705309190245, -0.0012385268496395746, -0.00117462940611234,
      -0.0010446514303805604, -0.0008597370018570577, -0.0006336935041628182,
      -0.00038203600871717974, -0.00012098078294077444, 0.00013354992201060762,
      0.0003668535717118489, 0.0005662524639104235, 0.0007217369884821698,
      0.0008264174900222402, 0.0008767680514839393, 0.0008726586898718017,
      0.0008171851449509681, 0.0007163169244820385, 0.000578393929190481,
      0.00041350934207446777, 0.00023282121503726363, 4.783717742318012e-05,
      -0.0001302840474625697, -0.0002913739136958016, -0.0004268032059182679,
      -0.0005299114416235594, -0.0005962974153354839, -0.0006239609857508781,
      -0.0006132955179155929, -0.0005669392504982032, -0.0004895017633895614,
      -0.0003871882558579453, -0.0002673491958459781, -0.00013798586827029906,
      -7.243357638242419e-06, 0.00011707840895498719, 0.00022796760419229535,
      0.0003195736581204504, 0.0003874922307031874, 0.000428949775248653,
      0.0004428820437614787, 0.00042990744986538864, 0.00039220237153509996,
      0.00033329090083229003, 0.00025776594936182176, 0.00017096178970651122,
      7.859993163577422e-05, -1.3569339194758566e-05, -0.00010010834558681216,
      -0.00017619704285695803, -0.0002378855585393027, -0.00028228207045992204,
      -0.000307668305705383, -0.0003135396253296541, -0.00030057127608116256,
      -0.0002705166715764226, -0.00022604727572092073, -0.00017054661137552067,
      -0.00010787297273430822, -4.210650599676293e-05, 2.2703573733835075e-05,
      8.277669543961428e-05, 0.00013481031421725252, 0.00017615007069362025,
      0.00020491272502300102, 0.00022005707319337268, 0.00022140137897228558,
      0.00020958909290524696, 0.0001860075935355261, 0.0001526672146383132,
      0.0001120497890912395, 6.693725821510755e-05, 2.023152107637508e-05,
      -2.5223369354656888e-05, -6.680627683767407e-05, -0.00010226222962916959,
      -0.00012981652174421534, -0.00014825445045579908, -0.0001569637771851865,
      -0.00015593935479937303, -0.00014575162970494716, -0.0001274827728544562,
      -0.00010263591045277962, -7.302422853870095e-05, -4.064756033229875e-05,
      -7.5644064963026514e-06, 2.423280806171029e-05, 5.293203730716324e-05,
      7.699926800284011e-05, 9.52546246558662e-05, 0.00010692355605167861,
      0.00011166138327539875, 0.00010955115372592174, 0.00010107632631365281,
      8.707122076705484e-05, 6.865332461030963e-05, 4.714240925774208e-05,
      2.397192695366201e-05, 5.983299020395114e-07, -2.1586219776876097e-05,
      -4.13327675158084e-05, -5.7601885284497287e-05, -6.961413219663033e-05,
      -7.688250494206468e-05, -7.922590347852683e-05, -7.676381058293817e-05,
      -6.989348383437841e-05, -5.92519241976525e-05, -4.566566656495585e-05,
      -3.0091997880362306e-05, -1.3555526275413048e-05, 2.91590609884441e-06,
      1.8352144220982192e-05, 3.189504036825153e-05, 4.284330844095657e-05,
      5.0685757140919026e-05, 5.512154648758027e-05, 5.606695016308183e-05,
      5.3648930874824724e-05, 4.818659926317173e-05, 4.016228695933087e-05,
      3.018448760875459e-05, 1.8945282263391943e-05, 7.175054494784693e-06,
      -4.402686182717354e-06, -1.5113708041298529e-05, -2.437032695668229e-05,
      -3.170160837643429e-05, -3.677508656427713e-05, -3.940916174324982e-05,
      -3.957593072383717e-05, -3.739478484602901e-05, -3.311763728486273e-05,
      -2.7107091366682774e-05, -1.9809210062769875e-05, -1.1722778963455297e-05,
      -3.3670631653137986e-06, 4.74995726855318e-06, 1.2161020866982654e-05,
      1.846506973233033e-05, 2.3347486471305816e-05, 2.6594161865178128e-05,
      2.8098884967423176e-05, 2.786396862975533e-05, 2.599442784229979e-05,
      2.268639271558046e-05, 1.8210742982665497e-05, 1.2893181640051826e-05,
      7.0921120302349424e-06, 1.1757410306788827e-06, -4.500197769734881e-06,
      -9.612816688391663e-06, -1.3889437965582824e-05, -1.712108046468478e-05,
      -1.9171475020654447e-05, -1.9981309803950232e-05, -1.956770464586479e-05,
      -1.801919532393461e-05, -1.548675947487042e-05, -1.2171621915305756e-05,
      -8.31072885909918e-06, -4.160871706998564e-06, 1.7530469151690676e-08,
      3.976013314526192e-06, 7.4921267084232375e-06, 1.0381220181904555e-05,
      1.2505376773323994e-05, 1.3779116653848705e-05, 1.4171702617659326e-05,
      1.3706089177650808e-05, 1.2454753204262334e-05, 1.0532815900651593e-05,
      8.089004539182955e-06, 5.295101338550669e-06, 2.3345823674790002e-06,
      -6.08839584963945e-07, -3.3620859555780004e-06, -5.772385337458609e-06,
      -7.7152394228472e-06, -9.100300542174756e-06, -9.874922800732882e-06,
      -1.0025298786385475e-05, -9.575241140425696e-06, -8.582804380645632e-06,
      -7.135059784603156e-06, -5.34142892020722e-06, -3.3260453570267833e-06,
      -1.2196469359371495e-06, 8.484975951782982e-07, 2.758152194871273e-06,
      4.404747038056835e-06, 5.704738564484703e-06, 6.599445963753326e-06,
      7.057217148202575e-06, 7.073883700291289e-06, 6.671567535374965e-06,
      5.895996157820267e-06, 4.8125633216588634e-06, 3.501433656005427e-06,
      2.0520306830710267e-06, 5.572663211296022e-07, -8.921335138499034e-07,
      -2.212876850443709e-06, -3.333639302164379e-06, -4.1986528585064995e-06,
      -4.770187202603296e-06, -5.029834908845269e-06, -4.97858721550104e-06,
      -4.635759248743251e-06, -4.036888494711916e-06, -3.2307845185329993e-06,
      -2.2759487713189287e-06, -1.236609093957833e-06, -1.786234865764857e-07,
      8.344978956857087e-07, 1.745223589508568e-06, 2.5050880932859095e-06,
      3.077081558574761e-06, 3.4372372000087576e-06, 3.5753646251256086e-06,
      3.4949304803350835e-06, 3.2121381349275428e-06, 2.7543027573358263e-06,
      2.1576547370169205e-06, 1.464731228893588e-06, 7.215315719413747e-07,
      -2.5382916660954707e-08, -7.316704381182542e-07, -1.3577133144545547e-06,
      -1.87071216446468e-06, -2.246267374570185e-06, -2.469381247770234e-06,
      -2.534851945017081e-06, -2.447067795280268e-06, -2.2192455431668985e-06,
      -1.8721866873157342e-06, -1.4326506620825775e-06, -9.314610888383134e-07,
      -4.0147101196569514e-07, 1.2448522648381952e-07, 6.155317168539103e-07,
      1.0444733450202787e-06, 1.389210373079922e-06, 1.6337777502556283e-06,
      1.768967382695458e-06, 1.7925184286849518e-06, 1.7088870004030453e-06,
      1.5286309167959532e-06, 1.2674660377485356e-06, 9.450671599793853e-07,
      5.83697730007884e-07, 2.0675833382854192e-07, -1.6265598876362101e-07,
      -5.031047959528382e-07, -7.959828295606953e-07, -1.0264711797732964e-06,
      -1.1842148273861137e-06, -1.2637008502444774e-06, -1.2643306201059086e-06,
      -1.1901977527837894e-06, -1.0496003500160994e-06, -8.543302815119559e-07,
      -6.187931945604673e-07, -3.590201312368867e-07, -9.163485072751321e-08,
      1.6715978531916922e-07, 4.0251745221590314e-07, 6.017548091279361e-07,
      7.549878551805847e-07, 8.555694923648736e-07, 9.003128462726466e-07,
      8.894983679961054e-07, 8.266756239244468e-07, 7.182822440242754e-07,
      5.731121291300468e-07, 4.0167224591478607e-07, 2.1547186314902623e-07,
      2.628977874181774e-08, -1.5453599814719516e-07, -3.167553021031971e-07,
      -4.5175467265433323e-07, -5.529807244549494e-07, -6.16219576469221e-07,
      -6.397233644527385e-07, -6.24184369525862e-07, -5.725662745404705e-07,
      -4.898100062951316e-07, -3.8243811986452167e-07, -2.580864231533816e-07,
      -1.2499433699771896e-07, 8.513724747531958e-09, 1.3452483112324675e-07,
      2.459836812306125e-07, 3.370646890706161e-07, 4.0345189328817894e-07,
      4.4251497598759765e-07, 4.533764291002915e-07, 4.368716005353761e-07,
      3.954095930595375e-07, 3.327484314026102e-07, 2.537022775927537e-07,
      1.6380155949380318e-07, 6.892856763468482e-08, -2.5048656141023334e-08,
      -1.126224093107355e-07, -1.8895199130088509e-07, -2.5011487788988955e-07,
      -2.9329046816613805e-07, -3.168690756232326e-07, -3.2048363739682713e-07,
      -3.0496631579917133e-07, -2.722364917386238e-07, -2.2513036429212928e-07,
      -1.6718528706248367e-07, -1.0239395944362746e-07, -3.4944580721797284e-08,
      3.103693918211484e-08, 9.172758314833104e-08, 1.4381732361161002e-07,
      1.846778927082885e-07, 2.1248241534271483e-07, 2.262714081470137e-07,
      2.259640529848801e-07, 2.1231694542785735e-07, 1.868355079137076e-07,
      1.5164578324240176e-07, 1.0933626164869006e-07, 6.278066020919249e-08,
      1.495312720229595e-08, -3.12528092158393e-08, -7.319104292604691e-08,
      -1.0860632978873498e-07, -1.3574711124261367e-07, -1.5344265681651377e-07,
      -1.6114183509461523e-07, -1.589132316058917e-07, -1.4740863148873007e-07,
      -1.2779394444284933e-07, -1.016533602418301e-07, -7.087380210128373e-08,
      -3.751753949837722e-08, -3.6911100619066918e-09, 2.858150860452974e-08,
      5.7474203478138814e-08, 8.145629550739176e-08, 9.936753593790808e-08,
      1.104672793106115e-07, 1.1445627944824382e-07, 1.1147125428343207e-07,
      1.0205396726853543e-07, 8.709798777850594e-08, 6.777744656450204e-08,
      4.5462940424073446e-08, 2.1630229815389953e-08, -2.2324965194600038e-09,
      -2.4713233629621463e-08, -4.455562761201057e-08, -6.072508009595713e-08,
      -7.245828277898538e-08, -7.929412222785918e-08, -8.108510419059585e-08,
      -7.79896426470787e-08, -7.04466717519471e-08, -5.913500726373556e-08,
      -4.4920658336846473e-08, -2.8795835083890645e-08, -1.1813691945523477e-08,
      4.97711269032379e-09, 2.0594163068718626e-08, 3.417588274579914e-08,
      4.502612891162357e-08, 5.264667252904209e-08, 5.675627910888101e-08,
      5.729596424919962e-08, 5.442083753117275e-08, 4.8479719408227285e-08,
      3.998437635919376e-08, 2.9570736536680204e-08, 1.79547983993841e-08,
      5.8861164019120954e-09, -5.898260054171601e-09, -1.671669566311159e-08,
      -2.5980355181554682e-08, -3.322314590357854e-08, -3.8122836784336975e-08,
      -4.051256814951331e-08, -4.0382575080175346e-08, -3.7872535261416223e-08,
      -3.3255484715597843e-08, -2.6914693809884356e-08, -1.9315239078931167e-08,
      -1.0972228997952749e-08, -2.4177370375454214e-09, 5.831535823402537e-09,
      1.3303995996334458e-08, 1.959866841449532e-08, 2.4405197293452757e-08,
      2.751744301138126e-08, 2.884020691414755e-08, 2.838904655789324e-08,
      2.628355426282634e-08, 2.2734838677315675e-08, 1.8028252940104264e-08,
      1.2502639315743635e-08, 6.527499554349146e-09, 4.795490063128292e-10,
      -5.279927431639891e-09, -1.0425621140892149e-08, -1.4685542906938435e-08,
      -1.785430603397626e-08, -1.9801777016381623e-08, -2.0476825127493618e-08,
      -1.990620604252589e-08, -1.8188900381094863e-08, -1.5486479887411965e-08,
      -1.2010278755514428e-08, -8.006295713040625e-09, -3.7388381153331105e-09,
      5.260593173270209e-10, 4.536449260456187e-09, 8.068625448071936e-09,
      1.0938865685273546e-08, 1.3012196407577988e-08, 1.4207816772670178e-08,
      1.450103667613556e-08, 1.3921796758700123e-08, 1.2550036931963429e-08,
      1.0508352259517315e-08, 7.952512375960118e-09, 5.060516721264141e-09,
      2.020909193327987e-09, -9.789183110691776e-10, -3.7637415528051425e-09,
      -6.180223375435055e-09, -8.104830323761816e-09, -9.449572974508628e-09,
      -1.0165344694136262e-08, -1.02427872878652e-08, -9.710761927137439e-09,
      -8.632641179125484e-09, -7.100755442253272e-09, -5.229418717614511e-09,
      -3.1470203563773126e-09, -9.87699137418474e-10, 1.116886332657143e-09,
      3.045209523377563e-09, 4.692528176256483e-09, 5.976195976434825e-09,
      6.839389970519751e-09, 7.2531164077204526e-09, 7.216466630638446e-09,
      6.755199561140043e-09, 5.918822225382682e-09, 4.77641955611058e-09,
      3.411545474710154e-09, 1.9165263955349017e-09, 3.8654463003863217e-10,
      -1.0861370725786356e-09, -2.417475876711169e-09, -3.5361857088566293e-09,
      -4.387282443542855e-09, -4.934479832241347e-09, -5.161354764424704e-09,
      -5.0712774545575024e-09, -4.686175380033261e-09, -4.0442651221404054e-09,
      -3.1969402378838004e-09, -2.2050433192426905e-09, -1.1347748428723626e-09,
      -5.349964869378644e-11, 9.742957272982584e-10, 1.8906638221439668e-09,
      2.647278748683151e-09, 3.2077885294181574e-09, 3.5493364736780283e-09,
      3.663205204603577e-09, 3.554591229512534e-09, 3.2415689238908795e-09,
      2.7533476259688612e-09, 2.1279618882088687e-09, 1.409561099668764e-09,
      6.454796658057568e-10, -1.1672758867416274e-10, -8.321077463867656e-10,
      -1.4608304893165421e-09, -1.9702739690233435e-09, -2.3365753452537203e-09,
      -2.5455823897078434e-09, -2.5931812842326152e-09, -2.485013916262474e-09,
      -2.2356333619031016e-09, -1.8671769029702894e-09, -1.4076602844700833e-09,
      -8.890138734010752e-10, -3.449903142147375e-10, 1.909259171758993e-10,
      6.874836021920581e-10, 1.1173949292263647e-09, 1.458740748882212e-09,
      1.6959848950686884e-09, 1.8205580982493092e-09, 1.8309995246772424e-09,
      1.7326707492913788e-09, 1.537081466033269e-09, 1.260887129125584e-09,
      9.246349565291527e-10, 5.5134559631992e-10, 1.6502289685173343e-10,
      -2.1081637138570885e-10, -5.545069849706569e-10, -8.474188221068809e-10,
      -1.0748990243544254e-09, -1.226929723254954e-09, -1.2984773561665316e-09,
      -1.2895290805328543e-09, -1.2048305254485592e-09, -1.0533560262742078e-09,
      -8.475566683848603e-10, -6.024422245902517e-10, -3.3455995070519703e-10,
      -6.09360017032607e-11, 2.0195600468877214e-10, 4.391397348793126e-10,
      6.37942897663002e-10, 7.886255579583897e-10, 8.848022165724113e-10,
      9.236435119515768e-10, 9.058571664911278e-10, 8.354608677371673e-10,
      7.193714079571268e-10, 5.668439916333227e-10, 3.8880270009113346e-10,
      1.9710738855412314e-10, 3.803676429602925e-12, -1.7959875337784864e-10,
      -3.4277837216682165e-10, -4.771496299373299e-10, -5.762794754967933e-10,
      -6.361548316007547e-10, -6.552930233509842e-10, -6.346968596619456e-10,
      -5.776651605136418e-10, -4.894775013738225e-10, -3.769783973766002e-10,
      -2.4809077229734995e-10, -1.1129117364829697e-10, 2.4920244210980676e-11,
      1.5252336764445985e-10, 2.644270146917472e-10, 3.548394056032986e-10,
      4.195424238997779e-10, 4.560584973326007e-10, 4.637058601077455e-10,
      4.435447771212721e-10, 3.982236205737874e-10, 3.3173914294927766e-10,
      2.4912961046030137e-10, 1.561224517091099e-10, 5.875963037078766e-11,
      -3.697594842924021e-11, -1.2551097053228188e-10, -2.0198967340319037e-10,
      -2.625232627717111e-10, -3.043691100086842e-10, -3.260328169752298e-10,
      -3.272911562328039e-10, -3.09138675606169e-10, -2.7366512189368244e-10,
      -2.2387455272967475e-10, -1.6345988282286474e-10, -9.65485248068451e-11,
      -2.7435673070929588e-11, 3.967835756182647e-11, 1.0093142583492665e-10,
      1.5301012512441446e-10, 1.933168808237161e-10, 2.2008598439298236e-10,
      2.3244438067646298e-10, 2.3041650965488774e-10, 2.1487584713172929e-10,
      1.8744880073961586e-10, 1.5037913743767343e-10, 1.063630231961024e-10,
      5.836596449175215e-11, 9.433419551364426e-12, -3.749339502087431e-11,
      -7.974588743750237e-11, -1.1507153947744264e-10, -1.4174524827198443e-10,
      -1.5864366205345224e-10, -1.6528005471045076e-10, -1.6179974500259195e-10,
      -1.4893839803215463e-10, -1.279476180013279e-10, -1.0049394360369739e-10,
      -6.85386093256359e-11, -3.420618706431322e-11, 3.4954535837243943e-13,
      3.307443552999658e-11, 6.213015055811179e-11, 8.599152817042783e-11,
      1.0352031784135264e-10, 1.1401219018955469e-10, 1.172156364306894e-10,
      1.13323113335569e-10, 1.0293641098381961e-10, 8.700964061380312e-11,
      6.677438469269141e-11, 4.3652367715585097e-11, 1.9161463141177965e-11,
      -5.179058890325513e-12, -2.7938402848374096e-11, -4.7854181859025197e-11,
      -6.389821047500697e-11, -7.532500819768479e-11, -8.170105258433274e-11,
      -8.291406132554474e-11, -7.916280083623606e-11, -7.092904384191898e-11,
      -5.893426855237444e-11, -4.4084458068608666e-11, -2.7406886077022203e-11,
      -9.983044975316608e-12, 7.118117136754907e-12, 2.2902720680662033e-11,
      3.650676651999504e-11, 4.7240399864809395e-11, 5.461956244456206e-11,
      5.838382277149707e-11, 5.850005466993099e-11, 5.5152487978311395e-11,
      4.872043337402866e-11, 3.9745643603551737e-11, 2.8891783159046745e-11,
      1.689881538511612e-11, 4.535269263181468e-12, -7.448681730607318e-12,
      -1.836459790840638e-11, -2.7623230464308486e-11, -3.476415361406712e-11,
      -3.947623024648726e-11, -4.1608181622897907e-11, -4.116915478473299e-11,
      -3.8319778096229544e-11, -3.335473186771759e-11, -2.6678308719494555e-11,
      -1.8774775446135547e-11, -1.0175560496116694e-11, -1.425372775031892e-12,
      6.95068966033277e-12, 1.4477148795238181e-11, 2.0753650989087908e-11,
      2.5474694969414954e-11, 2.844272003317208e-11, 2.957412868453043e-11,
      2.889825786002161e-11, 2.6549728932048615e-11, 2.2754975501045607e-11,
      1.781405025905974e-11, 1.2079033553127351e-11, 5.930497851955339e-12,
      -2.4647895022248955e-13, -6.0853099987454696e-12, -1.1258598353986345e-11,
      -1.5495435205350895e-11, -1.859445313559612e-11, -2.0432085277198213e-11,
      -2.096579333084371e-11, -2.023233720371087e-11, -1.834144828433703e-11,
      -1.5465521079925304e-11, -1.1826141078938985e-11, -7.678410856933213e-12,
      -3.2941161860682303e-12, 1.055212100414035e-12, 5.114333880869347e-12,
      8.658532612920432e-12, 1.1505298491005468e-11, 1.3522904913058746e-11,
      1.4635534077058447e-11, 1.482482952526905e-11, 1.4127971043620734e-11,
      1.263256787581598e-11, 1.0468838765077419e-11, 7.799683158699888e-12,
      4.8093408979566925e-12, 1.6913846161931355e-12, -1.3632104767268527e-12,
      -4.177218328993933e-12, -6.596916945226144e-12, -8.499943047134941e-12,
      -9.800881781006333e-12, -1.0454379734468138e-11, -1.0455727004281069e-11,
      -9.839006493692292e-12, -8.673047266427357e-12, -7.055536171986751e-12,
      -5.105732258976717e-12, -2.9562877911976598e-12, -7.44706094394826e-13,
      1.3950398485834471e-12, 3.3402410828124415e-12, 4.986115468999444e-12,
      6.251061860838201e-12, 7.080268907334068e-12, 7.44755136989912e-12,
      7.355398267292796e-12, 6.833323675109209e-12, 5.934706572071547e-12,
      4.732385667888188e-12, 3.3133348047666795e-12, 1.7727818124304347e-12,
      2.081475825236268e-13, -1.2868269822424057e-12, -2.6274288528027638e-12,
      -3.7425070102486025e-12, -4.577967466752202e-12, -5.099077027331924e-12,
      -5.291502029512708e-12, -5.161086932484816e-12, -4.7324518547439975e-12,
      -4.046553822986426e-12, -3.157410162699967e-12, -2.128221588763183e-12,
      -1.0271555913981792e-12, 7.694285969712829e-14, 1.1186559621088454e-12,
      2.039680141449806e-12, 2.791899473319973e-12, 3.3396959536224797e-12,
      3.661400043432162e-12, 3.749840788590922e-12, 3.6120101668636853e-12,
      3.2679079024594018e-12, 2.7486779571624313e-12, 2.094183947918185e-12,
      1.3501961899861453e-12, 5.65376973327085e-13, -2.1174716979720294e-13,
      -9.356465671118461e-13, -1.5663224987396437e-12, -2.0713816296478715e-12,
      -2.427552249548182e-12, -2.621581941821095e-12, -2.6504960272410013e-12,
      -2.5212349923431584e-12, -2.2497248641555925e-12, -1.8594651825918717e-12,
      -1.379743300310705e-12, -8.43600130425155e-13, -2.856805990328871e-13,
      2.598981064023177e-13, 7.61535425527241e-13, 1.19188337880356e-12,
      1.5292402308347388e-12, 1.7585374199998194e-12, 1.8718827273448703e-12,
      1.8686508262883954e-12, 1.7551395712945165e-12, 1.543835089460782e-12,
      1.2523496052200884e-12, 9.021119228777906e-13, 5.169009243246893e-13,
      1.2131698470982115e-13, -2.607150931432564e-13, -6.073247909656049e-13,
      -8.998809434918447e-13, -1.12392326227639e-12, -1.2697985379292834e-12,
      -1.3329793875907866e-12, -1.3140633374093262e-12, -1.21846903971928e-12,
      -1.0558634457582589e-12, -8.393678852462017e-13, -5.846015601986632e-13,
      -3.086275052818206e-13, -2.886842411129001e-14, 2.3794193979019887e-13,
      4.767117784698727e-13, 6.747972255531648e-13, 8.226214518249503e-13,
      9.140800492551369e-13, 9.467199379572839e-13, 9.216930854580946e-13,
      8.434995700774992e-13, 7.195462100263779e-13, 5.595565074157133e-13,
      3.7487457186531406e-13, 1.7770971988729236e-13, -1.963049350920615e-14,
      -2.0547287251301374e-13, -3.694353070051632e-13, -5.029727857819074e-13,
      -5.997862234470009e-13, -6.560771232380095e-13, -6.706410994563106e-13,
      -6.448031730012012e-13, -5.822069530606088e-13, -4.884778196945336e-13,
      -3.707866156639059e-13, -2.3734484774296697e-13, -9.686482203084227e-14,
      4.198154053146919e-14, 1.7107315199998893e-13, 2.8329090816481393e-13,
      3.7288598267080937e-13, 4.3574783649003565e-13, 4.695613551053965e-13,
      4.738496336205462e-13, 4.499058712022621e-13, 4.006242092521802e-13,
      3.3024480557725226e-13, 2.4403270492692407e-13, 1.4791295464481534e-13,
      4.8085824398520054e-14, -4.9354084916547316e-14, -1.387725338456761e-13,
      -2.1530454650625271e-13, -2.75101662893693e-13, -3.155061567337038e-13,
      -3.3514574741123867e-13, -3.339473727954327e-13, -3.1307344885059616e-13,
      -2.7478844396355093e-13, -2.222673046810768e-13, -1.593601021443648e-13,
      -9.032910340430628e-14, -1.9575252812322992e-14, 4.8629215149033646e-14,
      1.103865485759142e-13, 1.6238424198896442e-13, 2.0206016780599562e-13,
      2.2771470559023434e-13, 2.385660180428037e-13, 2.347481848161266e-13,
      2.1725529781114529e-13, 1.8783765304339866e-13, 1.4885868416493253e-13,
      1.0312315026861236e-13, 5.368823895071214e-14, 3.669644566583643e-15,
      -4.394565314175535e-14, -8.64691951167904e-14, -1.2165430947193624e-13,
      -1.4780576073125882e-13, -1.638510619039599e-13, -1.6937124268545415e-13,
      -1.6459137906407097e-13, -1.50333551966772e-13, -1.2793698350767607e-13,
      -9.915179065618561e-14, -6.601401816677361e-14, -3.071031776109866e-14,
      4.559185777231111e-15, 3.7711641167943424e-14, 6.689843653748899e-14,
      9.060219315458806e-14, 1.0770910030731013e-13, 1.175536076294861e-13,
      1.1993428132649085e-13, 1.1510139766319002e-13, 1.0371848754166326e-13,
      8.680146967563238e-14, 6.564014397038712e-14, 4.170760937843311e-14,
      1.6563592757116553e-14, -8.242278449321046e-15, -3.1261539586389585e-14,
      -5.122720252629103e-14, -6.7119135847343e-14, -7.821142937446566e-14,
      -8.409988728644396e-14, -8.470906573322464e-14, -8.027951054613532e-14,
      -7.133698657679306e-14, -5.86464607564324e-14, -4.315435742487578e-14,
      -2.592311334156666e-14, -8.062303953154992e-15, 9.339408612186847e-15,
      2.527752658101189e-14, 3.8886679575585225e-14, 4.9484485170652394e-14
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_9_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<9>(0.5), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 0.36065812824180227), "design.b()[0] == 0.36065812824180227");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.36065812824180227));
    static_assert(almost_equal(design.b()[1], -3.2459231541762206), "design.b()[1] == -3.2459231541762206");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -3.2459231541762206));
    static_assert(almost_equal(design.b()[2], 12.983692616704882), "design.b()[2] == 12.983692616704882");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 12.983692616704882));
    static_assert(almost_equal(design.b()[3], -30.295282772311392), "design.b()[3] == -30.295282772311392");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -30.295282772311392));
    static_assert(almost_equal(design.b()[4], 45.442924158467086), "design.b()[4] == 45.442924158467086");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 45.442924158467086));
    static_assert(almost_equal(design.b()[5], -45.442924158467086), "design.b()[5] == -45.442924158467086");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -45.442924158467086));
    static_assert(almost_equal(design.b()[6], 30.295282772311392), "design.b()[6] == 30.295282772311392");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 30.295282772311392));
    static_assert(almost_equal(design.b()[7], -12.983692616704882), "design.b()[7] == -12.983692616704882");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - -12.983692616704882));
    static_assert(almost_equal(design.b()[8], 3.2459231541762206), "design.b()[8] == 3.2459231541762206");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 3.2459231541762206));
    static_assert(almost_equal(design.b()[9], -0.36065812824180227), "design.b()[9] == -0.36065812824180227");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - -0.36065812824180227));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -7.0083383134260595), "design.a()[1] == -7.0083383134260595");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -7.0083383134260595));
    static_assert(almost_equal(design.a()[2], 21.99245189853133), "design.a()[2] == 21.99245189853133");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 21.99245189853133));
    static_assert(almost_equal(design.a()[3], -40.481901723956895), "design.a()[3] == -40.481901723956895");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -40.481901723956895));
    static_assert(almost_equal(design.a()[4], 48.06611610634028), "design.a()[4] == 48.06611610634028");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 48.06611610634028));
    static_assert(almost_equal(design.a()[5], -38.063027631586145), "design.a()[5] == -38.063027631586145");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -38.063027631586145));
    static_assert(almost_equal(design.a()[6], 20.00773513261458), "design.a()[6] == 20.00773513261458");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 20.00773513261458));
    static_assert(almost_equal(design.a()[7], -6.675873161590511), "design.a()[7] == -6.675873161590511");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -6.675873161590511));
    static_assert(almost_equal(design.a()[8], 1.2622453517383632), "design.a()[8] == 1.2622453517383632");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 1.2622453517383632));
    static_assert(almost_equal(design.a()[9], -0.09927234001861213), "design.a()[9] == -0.09927234001861213");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.09927234001861213));
    std::cout << "max_deviation(cheby1,highpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.36065812824180227, -0.7183089759706687, 0.017783762359626643, 0.22685435653955136,
      0.22773885925528403, 0.13804675032032998, 0.025957871052878723, -0.06611582067147295,
      -0.11807141258289677, -0.12784437347804867, -0.10485123505724303,
      -0.06323863756720927, -0.01669703601883782, 0.024482467167456348,
      0.054317319687137905, 0.07067501268570797, 0.07418238843822456, 0.06706810811280073,
      0.052249854565280085, 0.03275278473187654, 0.01140361796184558, -0.00930915498272425,
      -0.027308049584802485, -0.04098998677807897, -0.04929386874419872,
      -0.051756214538626555, -0.04852864102576837, -0.04033707850007634,
      -0.028377493771282236, -0.014158941166430766, 0.000683473102173468,
      0.014578126401935055, 0.026182961746100242, 0.0345086357558444, 0.03898813169642901,
      0.03949126240774081, 0.036290025790520375, 0.029985953892789463, 0.021413215316909123,
      0.011531561607997731, 0.001321780800919381, -0.008306253341800804,
      -0.016585992665940234, -0.022943376475086028, -0.027021993215098905,
      -0.028685931268972287, -0.028003791314271137, -0.02521841559325569,
      -0.020707306825977434, -0.014938556992321883, -0.008426520780187352,
      -0.0016906073134989388, 0.004780416768360319, 0.010557182578512868,
      0.01529094315495727, 0.018727332307243508, 0.020713170833329797, 0.021197084565304808,
      0.020224794484764913, 0.017929932236323665, 0.014521180139728834,
      0.010266480534048841, 0.00547503707845394, 0.0004778540554890784,
      -0.004392375841560559, -0.008821138689277332, -0.01253074585341133,
      -0.015296743458012615, -0.016961093674563804, -0.0174412467789323,
      -0.01673442424860226, -0.014916718455141045, -0.012136963536169859,
      -0.008605714329320072, -0.004580049082798104, -0.00034524875981804815,
      0.0038053338886671474, 0.007590746259439455, 0.010761744841392792,
      0.013117528269686568, 0.014518690543508725, 0.014895497787769288,
      0.014250969075821768, 0.01265865435417493, 0.010255413797493798, 0.007229877816164618,
      0.0038075750346326237, 0.00023393379603161082, -0.0032435228982262074,
      -0.006392462929152153, -0.009011281833551911, -0.010941847924152981,
      -0.012078668740758539, -0.012373992878225382, -0.011838681276096122,
      -0.010538995303331453, -0.008589732183612211, -0.006144372411609263,
      -0.0033830750489618894, -0.0004994572917119827, 0.002312877467612573,
      0.00487314013726751, 0.007024664173906219, 0.008644051912352554, 0.009647675215456127,
      0.009995251988384565, 0.0096904295055915, 0.00877850480153583, 0.00734158932495102,
      0.005491669952229605, 0.0033621245210457007, 0.0010983135603370511,
      -0.0011521098793994778, -0.0032485514520767984, -0.005065924954248485,
      -0.006501725850314291, -0.007481366644556141, -0.007961538581993617,
      -0.00793149715770488, -0.007412299899400732, -0.0064541462908287925,
      -0.005132075040176785, -0.0035403580497981382, -0.0017859898437565871,
      1.8296070122107017e-05, 0.0017610466800558882, 0.00333872754496275,
      0.004661605293096959, 0.005658562782792267, 0.006280612275277396,
      0.006502958599793836, 0.00632555502154656, 0.005772184014736392, 0.004888178427459644,
      0.00373697125614178, 0.0023957209023542786, 0.0009503008111413427,
      -0.0005100337147550876, -0.0018979833974017055, -0.003133242064734627,
      -0.0041469564841689, -0.004885375635768678, -0.005312510350209375,
      -0.005411686162205602, -0.005185938183768508, -0.004657263084110873,
      -0.0038648063240441094, -0.0028621194021980108, -0.0017136692635781048,
      -0.0004908180134788817, 0.0007324858504978785, 0.0018840541409372242,
      0.0028975975600623663, 0.0037164277990250037, 0.004296524444264649,
      0.004608807724714215, 0.004640505667118933, 0.004395556879043069,
      0.003894045064191713, 0.0031707155321825803, 0.00227267450704529,
      0.0012564162936450872, 0.00018435900701155826, -0.0008789052475551089,
      -0.0018704264248223662, -0.002732558477656492, -0.0034162582056043514,
      -0.0038838350986509437, -0.00411099968118829, -0.004088099725976766,
      -0.003820481626036796, -0.0033279654450440975, -0.002643473777690232,
      -0.0018109035719830156, -0.0008823736644773209, 8.498357157735604e-05,
      0.0010324924418133872, 0.0019034578854669523, 0.0026465332893019153,
      0.003218732967254303, 0.0035879125970123965, 0.0037345738373435917,
      0.0036528907496860795, 0.0033509030188523005, 0.0028498714490757596,
      0.0021828417480859244, 0.0013925101411689945, 0.0005285259978519419,
      -0.0003556001164680268, -0.0012057917394397693, -0.001970702907158983,
      -0.002604814782991932, -0.0030711453384942335, -0.0033434099876511712,
      -0.003407505964566168, -0.0032622357309887405, -0.0029192321385290744,
      -0.0024020974874964345, -0.0017448169446924178, -0.0009895510125639603,
      -0.00018394915792436291, 0.0006218449738702267, 0.0013783088156070619,
      0.0020395829593018184, 0.002566252795445048, 0.0029277004155361247,
      0.0031038858294292586, 0.0030864534116185963, 0.0028791024897293106,
      0.0024972073778966805, 0.0019667190010410826, 0.0013224246141014563,
      0.0006056812370689064, -0.0001382300978606879, -0.0008629602519250096,
      -0.001523977876671869, -0.0020813054075231336, -0.0025019367769325927,
      -0.002761790387446384, -0.002847081705807733, -0.00275503752291871,
      -0.0024939160216900617, -0.0020823406073960243, -0.0015479982097715526,
      -0.0009257917906604039, -0.00025556968248259277, 0.00042042084434836457,
      0.0010601931804712153, 0.0016246267241894407, 0.0020798562944987636,
      0.0023992997123083917, 0.002565202347458273, 0.0025696093605301375,
      0.0024147134268241444, 0.0021125655147501976, 0.001684176265687523,
      0.0011580731764524108, 0.000568411792069623, -4.723452358492558e-05,
      -0.0006502635091464448, -0.0012034599352649016, -0.0016732875307091952,
      -0.0020319159981753293, -0.00225886096721066, -0.0023421408228915808,
      -0.0022788860254330835, -0.002075371724644559, -0.001746480915010458,
      -0.0013146407721048286, -0.00080830696301455, -0.0002600976764191741,
      0.0002953007255502456, 0.0008233223166316085, 0.0012916667152571342,
      0.0016722679389133428, 0.001942967449929953, 0.0020887922665638846,
      0.002102765270606018, 0.0019862051912737117, 0.0017485062218238808,
      0.0014064197689124692, 0.0009828914162985977, 0.0005055329334328271,
      4.8304773273919605e-06, -0.0004877952086628518, -0.0009419535974547616,
      -0.0013301517556378447, -0.001629450043776461, -0.001822807018837306,
      -0.001900035441114065, -0.0018583167917135181, -0.0017022500264304505,
      -0.0014434396183568392, -0.0010996564358027577, -0.0006936309100891705,
      -0.00025155970798406996, 0.00019857653969279783, 0.0006287769044288395,
      0.0010127545205798252, 0.001327534705237392, 0.0015548202282454678,
      0.001682043250874319, 0.0017030442776101145, 0.0016183426151663589,
      0.0014349887507852082, 0.0011660151116262823, 0.0008295262336349626,
      0.0004474909580203454, 4.431660400064938e-05, -0.00035470285776678786,
      -0.0007249664381311759, -0.0010440753898850507, -0.0012931800015543943,
      -0.0014580835007403908, -0.0015300390776230178, -0.001506196136699103,
      -0.0013896743379096209, -0.001189267367676843, -0.0009188012252492224,
      -0.0005961927186791697, -0.0002422715810095769, 0.00012055689624023086,
      0.00046972331579606336, 0.0007838912407947987, 0.0010442538420556095,
      0.0012356518027344813, 0.0013474465643593704, 0.0013740992562299627,
      0.001315424687189308, 0.0011765103712292318, 0.000967311408448612,
      0.0007019518598143674, 0.00039778083378068114, 7.424580011592937e-05,
      -0.0002483441629262432, -0.0005500869541942019, -0.000812709028627432,
      -0.0010206653984309857, -0.0011620522786959927, -0.0012292792974401261,
      -0.001219463941101213, -0.001134528686688967, -0.0009809999496358697,
      -0.0007695263847998235, -0.0005141510868477382, -0.00023138682104202656,
      6.0845280960607337e-05, 0.00034434574349118965, 0.0006017645972832971,
      0.0008176575185344223, 0.000979406332716047, 0.001077949420000033,
      0.001108280216002195, 0.0010696870194174006, 0.0009657237308184257,
      0.0008039179187818418, 0.0005952387005326402, 0.0003533613541375942,
      9.37774867059561e-05, -0.00016719172300472783, -0.0004134166899860824,
      -0.0006299514196865877, -0.0008039356386546808, -0.0009253529350826007,
      -0.0009876005846299676, -0.0009878391035172069, -0.0009271036987182919,
      -0.0008101747732452624, -0.0006452195542913462, -0.0004432308253605535,
      -0.000217300819358026, 1.8222145680933492e-05, 0.0002486402772948926,
      0.00045981916529455624, 0.0006390504606451873, 0.0007758119998708263,
      0.0008623802079663848, 0.000894259487090928, 0.0008704051834164958,
      0.0007932298535629646, 0.0006683960943494509, 0.0005044123128693876,
      0.0003120596964624276, 0.00010368858166802256, -0.00010757016285707795,
      -0.00030862864736295624, -0.000487248962488006, -0.0006327841498952828,
      -0.0007368085268825335, -0.000793600326493101, -0.0008004493497428275,
      -0.000757773583233516, -0.0006690407935976824, -0.0005405032124411544,
      -0.0003807648241869704, -0.0002002107728414828, -1.0336418210660659e-05,
      0.00017698086382999343, 0.00035022123116026655, 0.0004989274385197645,
      0.0006143324739687735, 0.0006898723274461121, 0.0007215541677138117,
      0.0007081596269669999, 0.0006512734106784825, 0.0005551383962856355,
      0.0004263490753007482, 0.00027340497367005527, 0.00010615396622440268,
      -6.483830326492403e-05, -0.0002289527300306101, -0.000376173208768653,
      -0.0004976948522400128, -0.0005864472287205797, -0.0006375017410189887,
      -0.0006483399399085168, -0.00061896853927014, -0.0005518766031197561,
      -0.0004518401947464284, -0.0003255891071564411, -0.00018135856412730732,
      -2.8355499526708065e-05, 0.00012382619969892914, 0.00026580452682660374,
      0.0003889850554760553, 0.0004860783493065364, 0.0005515281126890954,
      0.000581825144374088, 0.000575689625545067, 0.0005341126964442224,
      0.00046025711589537787, 0.00035922550266809326, 0.00023771269147983796,
      0.00010356561466976985, -3.472056216851814e-05, -0.00016853786821324892,
      -0.0002896989278363003, -0.00039093543119046595, -0.00046633148194135266,
      -0.0005116661573176173, -0.0005246456526839687, -0.0005050125305827505,
      -0.000454527392602694, -0.0003768262490144404, -0.0002771644818555935,
      -0.0001620651170788532, -3.889473278127428e-05, 8.460559282350255e-05,
      0.00020080457411993395, 0.0003026500901920229, 0.0003840949032537966,
      0.0004404531689474085, 0.00046866688729269804, 0.0004674673548963485,
      0.0004374234140360322, 0.00038087542266937837, 0.00030176094445063997,
      0.0002053447434505755, 9.787136600403592e-05, -1.3836934975579524e-05,
      -0.00012281118540004348, -0.0002223684851755058, -0.00030651985729374326,
      -0.0003703283855735601, -0.0004101963621888044, -0.00042406490789735065,
      -0.0004115152110861415, -0.0003737667895698663, -0.0003135746154115139,
      -0.00023503315740170576, -0.00014330100821844955, -4.426443724026832e-05,
      5.5838327329524925e-05, 0.00015080822539029974, 0.0002348674894484641,
      0.00030300932208894983, 0.0003512940801277376, 0.0003770745767358334,
      0.0003791377825865137, 0.0003577555836122297, 0.0003146429923528379,
      0.00025282795160591056, 0.00017644225855488363, 9.04478478802981e-05,
      3.16424126258299e-07, -8.831698872860508e-05, -0.00017000474835353498,
      -0.00023981981888805486, -0.00029365123767361996, -0.00032844421519407545,
      -0.0003423709749482266, -0.0003349229507091404, -0.000306919972729702,
      -0.00026043727383479216, -0.00019865620681932053, -0.00012564917601035064,
      -4.611317106694866e-05, 3.493077758604223e-05, 0.00011245308979536438,
      0.0001817263406840168, 0.0002386120750660502, 0.00027980642374053903,
      0.00030303004957799766, 0.0003071516325953293, 0.0002922383887746776,
      0.0002595317324138209, 0.00021135084578483444, 0.0001509313247981057,
      8.220995742816016e-05, 9.5698314913781e-06, -6.243782129175394e-05,
      -0.00012937747798356908, -0.00018720125110352243, -0.00023249229980875567,
      -0.0002626651763043117, -0.0002761114623935027, -0.00027228262536919045,
      -0.0002517060348520507, -0.00021593427757203034, -0.0001674320233348277,
      -0.00010940847969106082, -4.560669706447397e-05, 1.9936539347630705e-05,
      8.314490987357544e-05, 0.00014015491981996534, 0.00018755086711079905,
      0.00022256820298155434, 0.00024325326163856186, 0.0002485702313480859,
      0.00023844965075282658, 0.00021377642102189134, 0.00017631909287062295,
      0.00012860578382127563, 7.375528616031279e-05, 1.52745485786568e-05,
      -4.31643976545223e-05, -9.795394812405059e-05, -0.000145772590929798,
      -0.00018378517404025086, -0.00020980976934854585, -0.0002224413931243396,
      -0.00022112567049797937, -0.00020617873871933527, -0.0001787530657957803,
      -0.00014075220597879225, -9.470061553448262e-05, -4.357732386391501e-05,
      9.375661373971808e-06, 6.08579596845125e-05, 0.0001077155813441829,
      0.00014713320353458147, 0.0001768022973613391, 0.0001950551315945692,
      0.00020095695386979692, 0.00019435136205908144, 0.00017585685275237355,
      0.00014681558222149303, 0.00010919830840175489, 6.547212115578659e-05,
      1.8439754413874013e-05, -2.8939119658068815e-05, -7.373327695890653e-05,
      -0.0001132204491735584, -0.00014505188975743092, -0.00016739110564892735,
      -0.00017901862388853044, -0.00017939689639797523, -0.00016869200671408026,
      -0.00014775156588313853, -0.00011804090010639331, -8.154217256155975e-05,
      -4.06232922463539e-05, 2.114787235403602e-06, 4.400258660084595e-05,
      8.246808040987411e-05, 0.00011519386429134821, 0.00014025595408404846,
      0.00015623595614239834, 0.00016230013134224154, 0.00015824102852391125,
      0.00014447974705175367, 0.00012202935177123416, 9.242235345229021e-05,
      5.7607337506558934e-05, 1.9821643096486002e-05, -1.8551642717297385e-05,
      -5.513328185393563e-05, -8.769472535255713e-05, -0.00011429317663064816,
      -0.00013338673676195915, -0.0001439228575859752, -0.00014539509062299716,
      -0.00013786516172328758, -0.00012194959233509037, -9.877229044640077e-05,
      -6.988661147860583e-05, -3.7172215533418725e-05, -2.713513892952388e-06,
      3.13324799464515e-05, 6.287055681119082e-05, 8.999563906733182e-05,
      0.0001111072073719519, 0.00012500299578763847, 0.00013094651918156553,
      0.00012870470408084505, 0.00011855380289413917, 0.00010125376038887029,
      7.799314637390426e-05, 5.030855032175452e-05, 1.998384490576623e-05,
      -1.10641226293132e-05, -4.0906124776973955e-05, -6.771988185718658e-05,
      -8.990077732548839e-05, -0.00010615726924251951, -0.0001155853644413036,
      -0.00011771790955591977, -0.00011254607949455313, -0.00010051220470856269,
      -8.24748627467251e-05, -5.964885653552906e-05, -3.352420828241562e-05,
      -5.769524050939557e-06, 2.187404108377986e-05, 4.770151192717224e-05,
      7.014875729693991e-05, 8.788669537181787e-05, 9.989939967566645e-05,
      0.00010554155414620582, 0.00010457205746605323, 9.716210337377051e-05,
      8.387766782482625e-05, 6.56379152816853e-05, 4.36524978176766e-05,
      1.9341973907198407e-05, -5.753455126718455e-06, -3.0071059237913298e-05,
      -5.212244954168712e-05, -7.058422685300616e-05, -8.43769165550641e-05,
      -9.272751321710837e-05, -9.521204914173843e-05, -9.177589482244953e-05,
      -8.273091282752455e-05, -6.873003060167118e-05, -5.072118242134072e-05,
      -2.9883811749847758e-05, -7.552148308426898e-06, 1.4869780190371065e-05,
      3.5996014877214e-05, 5.4543937328238785e-05, 6.94117245491845e-05,
      7.974333651370591e-05, 8.497723354382737e-05, 8.487608945311842e-05,
      7.953598582685487e-05, 6.937486525342834e-05, 5.51013057169433e-05,
      3.766587554280507e-05, 1.8198365804806508e-05, -2.0649864190723727e-06,
      -2.1859621805632234e-05, -3.997121577799619e-05, -5.5309810940437545e-05,
      -6.697502216111077e-05, -7.430843854827016e-05, -7.693020235599406e-05,
      -7.475777270269735e-05, -6.80060155281801e-05, -5.7168928682314554e-05,
      -4.298443977425475e-05, -2.6384735373744005e-05, -8.435432121214431e-06,
      9.732466487852172e-06, 2.699350484018378e-05, 4.2297172914681656e-05,
      5.473150789241305e-05, 6.357707019246728e-05, 6.834812327453232e-05,
      6.881869004229945e-05, 6.503213166203617e-05, 5.729393482084647e-05,
      4.614843552947401e-05, 3.234118715034109e-05, 1.6769537971551694e-05,
      4.2466845020601625e-07, -1.567118915905989e-05, -3.052839129862561e-05,
      -4.325043976643829e-05, -5.308776740354989e-05, -5.948154583677173e-05,
      -6.20949783924749e-05, -6.083035674332737e-05, -5.583106785409252e-05,
      -4.746868073226976e-05, -3.631616155434515e-05, -2.3109104583197732e-05,
      -8.697574473242307e-06, 6.008308449101683e-06, 2.0095574736198795e-05,
      3.270482497762486e-05, 4.308239123132989e-05, 5.0625091723161236e-05,
      5.491494016483594e-05, 5.5741835724056575e-05, 5.311303505361667e-05,
      4.7249044109791416e-05, 3.8566412099013195e-05, 2.7648710496015012e-05,
      1.5207687984087118e-05, 2.0371652301222896e-06, -1.1037361489218733e-05,
      -2.321022383338703e-05, -3.37449933925253e-05, -4.2018786413952e-05,
      -4.7558811673636134e-05, -5.006903546866384e-05, -4.944548372427251e-05,
      -4.577942773095284e-05, -3.934846083876681e-05, -3.0596220983780025e-05,
      -2.010220227148567e-05, -8.543686489079574e-06, 3.347722225983832e-06,
      1.4832184921990026e-05, 2.5207447749456345e-05, 3.385156962054672e-05,
      4.0259971469469276e-05, 4.4074615132416966e-05, 4.510364273232299e-05,
      4.3330424574985365e-05, 3.891163524773498e-05, 3.216466146790958e-05,
      2.354529882640514e-05, 1.3617278064720042e-05, 3.01564006500215e-06,
      -7.59367545847971e-06, -1.7555468618102334e-05, -2.6265553721640568e-05,
      -3.320720558977144e-05, -3.798159191128897e-05, -4.033041386514402e-05,
      -4.014948827401211e-05, -3.7492585198624665e-05, -3.256544811161143e-05,
      -2.5710531191629985e-05, -1.7383552447291194e-05, -8.123448209332066e-06,
      1.4823047381955242e-06, 1.0834780202936308e-05, 1.936077598872391e-05,
      2.6547773006599813e-05, 3.1974558834353835e-05, 3.5335697884762945e-05,
      3.645844089380623e-05, 3.531115697071204e-05, 3.20029103272276e-05,
      2.6774356937119345e-05, 1.9980669375373335e-05, 1.2067678379024062e-05,
      3.5428184899406197e-06, -5.057240768780211e-06, -1.3200223762029063e-05,
      -2.039104003012757e-05, -2.6201727405758378e-05, -3.0296746088102184e-05,
      -3.245214018148931e-05, -3.256748683907643e-05, -3.067001666417265e-05,
      -2.691078278507138e-05, -2.155324903686085e-05, -1.4955129526947255e-05,
      -7.544714538442555e-06, 2.0676262980723694e-07, 7.814945014151954e-06,
      1.4812479523266275e-05, 2.0777587251807385e-05, 2.5359338723354675e-05,
      2.8298128932871113e-05, 2.9440168791648887e-05, 2.8745198961386073e-05,
      2.6287063917067603e-05, 2.2247231020849185e-05, 1.6901773570677072e-05,
      1.060273161433337e-05, 3.7550960761447143e-06, -3.209088992473014e-06,
      -9.857858457798117e-06, -1.578599639554604e-05, -2.063960565206343e-05,
      -2.4137095005711688e-05, -2.6085348403928095e-05, -2.6390159038606798e-05,
      -2.506038058459442e-05, -2.2205645081262246e-05, -1.8027896698371827e-05,
      -1.2807368267712916e-05, -6.883960036421408e-06, -6.352478305924432e-07,
      5.54746473044576e-06, 1.1283538380356918e-05, 1.622632114055309e-05,
      2.00839799770501e-05, 2.2636596882924032e-05, 2.3748536695210494e-05,
      2.337540261717602e-05, 2.1565241116647997e-05, 1.8454018639655354e-05,
      1.4255745886661671e-05, 9.247949556844085e-06, 3.7534669499468515e-06,
      -1.8802505648753182e-06, -7.303005360548268e-06, -1.2183522695873097e-05,
      -1.622958657903328e-05, -1.920542488409521e-05, -2.0945316599318292e-05,
      -2.136264464581419e-05, -2.0453911994280173e-05, -1.8297557918972107e-05,
      -1.5047735040305498e-05, -1.09235162475849e-05, -6.194274875627687e-06,
      -1.162205273139151e-06, 3.85688881898581e-06, 8.553322692186317e-06,
      1.2642549066487872e-05, 1.5882304126743464e-05, 1.8086854048364638e-05,
      1.9137511188203058e-05, 1.898883343556427e-05, 1.7670196637195742e-05,
      1.52827209205218e-05, 1.1991818935152331e-05, 8.015899843463628e-06,
      3.6119912644969415e-06, -9.407811589289148e-07, -5.358800442487283e-06,
      -9.371545778555598e-06, -1.27380752744136e-05, -1.526140478977756e-05,
      -1.6799930482374527e-05, -1.7275239559592513e-05, -1.6675887781999226e-05,
      -1.5056978393744534e-05, -1.2535639179056757e-05, -9.282745985299748e-06,
      -5.511466948664355e-06, -1.4633882941681228e-06, 2.6068809054512975e-06,
      6.4476488220874275e-06, 9.825632422432241e-06, 1.2540051505584952e-05,
      1.4434478526769673e-05, 1.540575033219593e-05, 1.5409441026204666e-05,
      1.4461615956895348e-05, 1.2636821143401097e-05, 1.0062495679227494e-05,
      6.910212350959557e-06, 3.384340729128167e-06, -2.911238696732681e-07,
      -3.886721420524438e-06, -7.181787185876678e-06, -9.977928521555185e-06,
      -1.211089955793959e-05, -1.3460167534313703e-05, -1.395561898507195e-05,
      -1.3581039867745055e-05, -1.2374209076894537e-05, -1.0423656597530271e-05,
      -7.862342629970267e-06, -4.85869981580999e-06, -1.6056360645131892e-06,
      1.6917886588309611e-06, 4.829228360346345e-06, 7.6156563073801405e-06,
      9.884935660529533e-06, 1.150565844349571e-05, 1.2388674504745762e-05,
      1.2491884494919878e-05, 1.1822046989927462e-05, 1.0433538458398027e-05,
      8.424193950581872e-06, 5.928534482871212e-06, 3.1088432978577577e-06,
      1.446782179887218e-07, -2.778506014196537e-06, -5.480907910298835e-06,
      -7.799385855993733e-06, -9.597250727560631e-06, -1.0772260304141345e-05,
      -1.1262352142154332e-05, -1.1048799018742819e-05, -1.015663551359054e-05,
      -8.652375341551877e-06, -6.639206000470217e-06, -4.2499999197695694e-06,
      -1.6386104036431348e-06, 1.0299813179021292e-06, 3.5900402149404665e-06,
      5.885323435448636e-06, 7.778567656597569e-06, 9.159644789053183e-06,
      9.951904885339023e-06, 1.0116345136259493e-05, 9.653384148130295e-06,
      8.602172273342723e-06, 7.037522068535491e-06, 5.064688483772161e-06,
      2.8123572878343547e-06, 4.243048300151469e-07, -1.9497335212866013e-06,
      -4.163409111086072e-06, -6.082739244142118e-06, -7.594171694195627e-06,
      -8.611251937592278e-06, -9.079504972870823e-06, -8.97926036393527e-06,
      -8.3262807092882e-06, -7.170191720999327e-06, -5.590847866944614e-06,
      -3.69289274252394e-06, -1.5988804400860215e-06, 5.585931323722567e-07,
      2.6452464610895072e-06, 4.533432002524831e-06, 6.109906051361588e-06,
      7.282578407809349e-06, 7.985842266314127e-06, 8.184179140349502e-06,
      7.873845284656503e-06, 7.082567792974859e-06, 5.867302651015018e-06,
      4.3102258083560675e-06, 2.5132345543696483e-06, 5.913237950811489e-07,
      -1.3347348425463296e-06, -3.1459473115174118e-06, -4.7324144813864665e-06,
      -5.999964692947054e-06, -6.8757035360762704e-06, -7.312156413566473e-06,
      -7.289771805236188e-06, -6.817658273049384e-06, -5.932539443252156e-06,
      -4.696021497728284e-06, -3.190370308798235e-06, -1.5130840539566225e-06,
      2.2938329328740097e-07, 1.928345755840531e-06, 3.4796337373119194e-06,
      4.789949906080129e-06, 5.782446745402478e-06, 6.401194491049217e-06,
      6.6142822692446005e-06, 6.415383971348876e-06, 5.823718033094857e-06,
      4.882430647066766e-06, 3.6555287847480624e-06, 2.22357681818611e-06,
      6.784432726366202e-07, -8.825619338708563e-07, -2.362787505112642e-06,
      -3.672197395760214e-06, -4.732818678302238e-06, -5.4833528371940745e-06,
      -5.882679853737091e-06, -5.912057366944806e-06, -5.5759010973350205e-06,
      -4.9011222368076435e-06, -3.9350870168172565e-06, -2.7423476423254476e-06,
      -1.4003671286639395e-06, 5.4810475809339e-09, 1.3873175263538373e-06,
      2.6602253588836005e-06, 3.7474433074302474e-06, 4.5849681211948566e-06,
      5.125291573891851e-06, 5.3400560900297085e-06, 5.221483198689336e-06,
      4.782507279663563e-06, 4.055628145582621e-06, 3.09057488086638e-06,
      1.95094520082491e-06, 7.10045084530288e-07, -5.538009705991484e-07,
      -1.762170590604552e-06, -2.84138735079978e-06, -3.7269899978126147e-06,
      -4.367557424417406e-06, -4.72766407323226e-06, -4.789797931153176e-06,
      -4.5551401573254086e-06, -4.043177375750056e-06, -3.2901902283812622e-06,
      -2.346730435579349e-06, -1.2742591751055493e-06, -1.4116846511289327e-07,
      9.815584000788223e-07, 2.0247733376453076e-06, 2.9254021108281875e-06,
      3.630236559845044e-06, 4.099053795465911e-06, 4.306881094487341e-06,
      4.245281037117715e-06, 3.9225940339409615e-06, 3.3631408243281998e-06,
      2.6054517010965295e-06, 1.6996481867620686e-06, 7.041531013764883e-07,
      -3.1805653238095036e-07, -1.3034146848192884e-06, -2.191701112526329e-06,
      -2.929703308064082e-06, -3.4743840939881596e-06, -3.795367603099189e-06,
      -3.876601626238453e-06, -3.7171075554739826e-06, -3.330786981654896e-06,
      -2.745312773065746e-06, -2.000188521910845e-06, -1.1441101817812924e-06,
      -2.3180455190357593e-07, 6.794513750677761e-07, 1.5334099153849825e-06,
      2.2783083662863098e-06, 2.8699895630630116e-06, 3.2745002858360357e-06,
      3.4700158703683526e-06, 3.4479835342513694e-06, 3.2134269801216776e-06,
      2.784407591599868e-06, 2.1906896925780673e-06, 1.4717056861069687e-06,
      6.739585044987585e-07, -1.519687688333328e-07, -9.546048504609068e-07,
      -1.6847833000988432e-06, -2.298639483478282e-06, -2.7602297097362524e-06,
      -3.043617187333963e-06, -3.134304979786177e-06
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.36065812824180227, -0.7183089759706687, 0.017783762359626115, 0.22685435653955044,
      0.22773885925529228, 0.1380467503203765, 0.02595787105301307, -0.06611582067119945,
      -0.11807141258247068, -0.1278443734775448, -0.10485123505686737, -0.0632386375673161,
      -0.016697036019908237, 0.024482467164877446, 0.05431731968253843, 0.07067501267872224,
      0.07418238842874239, 0.06706810810105038, 0.052249854551868, 0.03275278471777417,
      0.011403617948321712, -0.00930915499421935, -0.027308049592788087,
      -0.04098998678121206, -0.04929386874143907, -0.05175621452937874,
      -0.04852864100998389, -0.040337078478303576, -0.028377493744658262,
      -0.014158941136615553, 0.0006834731331145124, 0.01457812643168942,
      0.02618296177229327, 0.034508635776234614, 0.03898813170909736, 0.039491262411258464,
      0.036290025784082094, 0.02998595387630236, 0.02141321529102975, 0.011531561574113919,
      0.0013217807610768119, -0.008306253385023592, -0.016585992709601254,
      -0.022943376516083004, -0.02702199325039254, -0.02868593129581383,
      -0.028003791330417346, -0.025218415597154355, -0.0207073068169083,
      -0.014938556970480436, -0.008426520746702505, -0.0016906072703804947,
      0.004780416818343083, 0.010557182632014474, 0.015290943208288768,
      0.018727332356637795, 0.02071317087521937, 0.021197084596590258, 0.020224794503052795,
      0.01792993224011465, 0.014521180128540851, 0.010266480508465042, 0.005475037040091324,
      0.00047785400688990065, -0.004392375897106394, -0.008821138747965555,
      -0.012530745911194775, -0.01529674351089063, -0.01696109371886819,
      -0.017441246811588866, -0.016734424267349023, -0.014916718458687429,
      -0.01213696352428564, -0.008605714302848082, -0.004580049043590404,
      -0.0003452487106009697, 0.003805333944488523, 0.007590746318022706,
      0.010761744898727815, 0.013117528321874275, 0.014518690587029278,
      0.014895497819721446, 0.014250969094117213, 0.012658654357674751,
      0.010255413786078336, 0.007229877790732557, 0.003807574997030018,
      0.00023393374891633316, -0.003243522951574713, -0.006392462985064127,
      -0.009011281888223033, -0.01094184797390647, -0.012078668782295276,
      -0.012373992908844719, -0.011838681293872392, -0.010538995307234475,
      -0.008589732173564226, -0.006144372388475396, -0.0033830750144760394,
      -0.000499457248344519, 0.0023128775168349824, 0.004873140188976553,
      0.007024664224625561, 0.008644051958733957, 0.009647675254501812,
      0.009995252017640977, 0.009690429523302034, 0.008778504806743269,
      0.007341589317544067, 0.00549166993293195, 0.0033621244913498807,
      0.0010983135223890286, -0.0011521099229561292, -0.003248551498285733,
      -0.005065925000041501, -0.006501725892714685, -0.0074813666808711,
      -0.007961538609983346, -0.007931497175718033, -0.007412299906468244,
      -0.006454146286711162, -0.005132075025363035, -0.003540358025457835,
      -0.0017859898116492478, 1.8296107773300323e-05, 0.001761046720717098,
      0.0033387275859588198, 0.004661605331785923, 0.005658562816733839,
      0.006280612302384918, 0.0065029586184604336, 0.006325555030738056,
      0.005772184014045758, 0.004888178417120266, 0.0037369712369995393,
      0.0023957208758010706, 0.0009503007790151472, -0.0005100337502964253,
      -0.0018979834340243258, -0.0031332421000806318, -0.004146956516006715,
      -0.004885375662132406, -0.005312510369518629, -0.005411686173358662,
      -0.005185938186203408, -0.004657263077831078, -0.00386480630960776,
      -0.0028621193806719963, -0.001713669236460534, -0.0004908179825955083,
      0.0007324858831161092, 0.001884054173187287, 0.002897597589904208,
      0.0037164278246098878, 0.004296524464048763, 0.004608807737550636,
      0.00464050567232258, 0.004395556876425118, 0.0038940450540619438, 0.00317071551532014,
      0.0022726744846403276, 0.0012564162672154735, 0.00018435897830043336,
      -0.0008789052766940734, -0.0018704264525444437, -0.0027325585022424047,
      -0.0034162582255664307, -0.0038838351128223977, -0.004110999688790266,
      -0.00408809972665943, -0.003820481619892426, -0.003327965432592033,
      -0.0026434737598353105, -0.0018109035499507412, -0.0008823736397303509,
      8.4983597435747e-05, 0.001032492467142563, 0.0019034579086922934,
      0.0026465333090118625, 0.0032187329822851466, 0.0035879126065157924,
      0.0037345738408329733, 0.003652890747059566, 0.0033509030103912193,
      0.0028498714354194266, 0.0021828417301847773, 0.0013925101202194262,
      0.0005285259752172129, -0.00035560013934562496, -0.0012057917611298986,
      -0.001970702926331718, -0.0026048147984983, -0.0030711453494340355,
      -0.003343409993424167, -0.0034075059649037822, -0.0032622357259647077,
      -0.002919232128548797, -0.0024020974732660975, -0.0017448169271701238,
      -0.0009895509928961527, -0.00018394913737165237, 0.0006218449940131129,
      0.0013783088340921783, 0.0020395829750047335, 0.0025662528074327224,
      0.002927700423121859, 0.0031038858322114974, 0.0030864534095014235,
      0.002879102482923624, 0.002497207366902264, 0.0019667189866109528,
      0.001322424597190921, 0.0006056812187727216, -0.00013823011637895122,
      -0.0008629602695068091, -0.0015239778922360152, -0.002081305420132032,
      -0.0025019367858483263, -0.0027617903921733147, -0.002847081706119234,
      -0.0027550375188667093, -0.002493916013597134, -0.0020823405958308163,
      -0.0015479981955093258, -0.0009257917746313914, -0.0002555696657115932,
      0.0004204208608072422, 0.001060193195600527, 0.0016246267370710005,
      0.0020798563043690345, 0.0023992997186033627, 0.002565202349845212,
      0.002569609358924463, 0.002414713421390595, 0.0021125655058884998,
      0.001684176254003712, 0.0011580731627178526, 0.0005684117771705173,
      -4.723453870425898e-05, -0.0006502635235428857, -0.0012034599480547814,
      -0.0016732875411219564, -0.002031916005599409, -0.002258860971228928,
      -0.002342140823304322, -0.0022788860222672665, -0.0020753717181489894,
      -0.0017464809056372864, -0.0013146407604787444, -0.0008083069498917232,
      -0.00026009766263861557, 0.0002953007391198216, 0.000823322329146106,
      0.0012916667259492368, 0.0016722679471393301, 0.001942967455208331,
      0.002088792268603509, 0.0021027652693220386, 0.0019862051867904325,
      0.0017485062144644726, 0.0014064197591762853, 0.0009828914048276385,
      0.0005055329209695818, 4.830464666815433e-06, -0.0004877952207241114,
      -0.0009419536081686148, -0.0013301517643512864, -0.0016294500499714425,
      -0.001822807022161492, -0.0019000354414006372, -0.0018583167889889298,
      -0.0017022500209098155, -0.0014434396104274346, -0.0010996564259968655,
      -0.0006936308990481585, -0.00025155969641615515, 0.00019857655105826822,
      0.0006287769148875718, 0.0010127545294962496, 0.0013275347120830878,
      0.0015548202326300454, 0.0016820432525670164, 0.00170304427655101,
      0.001618342611466783, 0.001434988744717601, 0.0011660151036043704,
      0.0008295262241856694, 0.00044749094774932627, 4.431659355367868e-05,
      -0.0003547028677441489, -0.0007249664470331543, -0.0010440753971820967,
      -0.0012931800068243253, -0.001458083503692447, -0.00153003907811349,
      -0.0015061961347377128, -0.001389674333656405, -0.001189267361429883,
      -0.000918801217424109, -0.0005961927097815993, -0.00024227157160286846,
      0.00012055690557062175, 0.0004697233244788075, 0.0007838912483074904,
      0.0010442538479559825, 0.0012356518066861913, 0.0013474465661508618,
      0.001374099255785393, 0.0013154246845710194, 0.0011765103666317742,
      0.0009673114021848191, 0.0007019518522944493, 0.0003977808254856956,
      7.4245791567313e-05, -0.00024834417119917805, -0.0005500869616867891,
      -0.0008127090348901993, -0.0010206654030963881, -0.0011620522814997504,
      -0.0012292792982359448, -0.0012194639398680888, -0.001134528683530741,
      -0.0009809999447731785, -0.000769526378555043, -0.0005141510796239321,
      -0.00023138681329724946, 6.0845288742043145e-05, 0.00034434575082871704,
      0.000601764603729542, 0.0008176575237023204, 0.000979406336301998,
      0.00107794942180171, 0.0011082802159299544, 0.001069687017498637,
      0.0009657237271946561, 0.0008039179136987596, 0.0005952386943238055,
      0.00035336134720281734, 9.377747948575151e-05, -0.00016719173005699713,
      -0.0004134166964326099, -0.0006299514251322961, -0.0008039356427714691,
      -0.0009253529376291637, -0.0009876005854659792, -0.0009878391026110155,
      -0.000927103696147701, -0.0008101747691914175, -0.0006452195490261963,
      -0.00044323081922875777, -0.00021730081275451318, 1.8222152336299112e-05,
      0.00024864028358393493, 0.000459819170827033, 0.0006390504650830229,
      0.0007758120029488238, 0.0008623802095081319, 0.0008942594870189275,
      0.0008704051817559239, 0.0007932298504388792, 0.0006683960899776933,
      0.0005044123075418248, 0.00031205969052754194, 0.0001036885755081405,
      -0.00010757016885042088, -0.00030862865281391526, -0.0004872489670600011,
      -0.0006327841533117648, -0.0007368085289436608, -0.0007936003270873234,
      -0.0008004493488527137, -0.0007577735809355376, -0.0006690407900560592,
      -0.0005405032078962424, -0.0003807648189390201, -0.0002002107672308654,
      -1.0336412595861835e-05, 0.0001769808690952019, 0.0003502212357490385,
      0.000498927442152396, 0.0006143324764296837, 0.0006898723285965615,
      0.0007215541674996085, 0.0007081596254207704, 0.0006512734079164287,
      0.0005551383924990538, 0.00042634907074290873, 0.0002734049686393296,
      0.00010615396104475934, -6.483830826478272e-05, -0.00022895273453812261,
      -0.00037617321250694985, -0.0004976948549849136, -0.0005864472303139883,
      -0.0006375017413778884, -0.0006483399390290641, -0.0006189685372266778,
      -0.0005518766000588925, -0.00045184019087663406, -0.0003255891027338963,
      -0.00018135855943895814, -2.8355494871651973e-05, 0.00012382620402852186,
      0.0002658045305638153, 0.00038898505839564146, 0.0004860783512384336,
      0.0005515281135282064, 0.0005818251440857946, 0.0005756896241662046,
      0.0005341126940795465, 0.00046025711270982937, 0.0003592254988754212,
      0.00023771268732835485, 0.00010356561042618043, -3.472056623616969e-05,
      -0.00016853787185243214, -0.00028969893082559967, -0.0003909354333529697,
      -0.0004663314831550222, -0.0005116661575220323, -0.0005246456518830836,
      -0.0005050125288435572, -0.00045452739004995206, -0.0003768262458218792,
      -0.0002771644782342035, -0.00016206511326304746, -3.8894729013816745e-05,
      8.46055963068446e-05, 0.00020080457710505074, 0.0003026500924995297,
      0.0003840949047497132, 0.00044045316955081755, 0.0004686668869799488,
      0.00046746735370159904, 0.00043742341204815687, 0.0003808754200254999,
      0.0003017609413267528, 0.00020534474004989993, 9.787136254387061e-05,
      -1.3836938277662083e-05, -0.0001228111883397901, -0.00022236848757452372,
      -0.00030651985901022856, -0.00037032838651057713, -0.0004101963622996382,
      -0.00042406490718764324, -0.0004115152096127261, -0.00037376678743642264,
      -0.0003135746127613643, -0.00023503315440824647, -0.00014330100507385353,
      -4.4264434143189614e-05, 5.5838330186462376e-05, 0.00015080822783244388,
      0.0002348674913297675, 0.00030300932330064556, 0.0003512940806045435,
      0.00037707457645933597, 0.00037913778158556774, 0.00035775558196040025,
      0.00031464299016309693, 0.0002528279490229657, 0.00017644225574565812,
      9.04478450231869e-05, 3.164213998496565e-07, -8.831699115663096e-05,
      -0.00017000475033664264, -0.00023981982030960605, -0.0002936512384536286,
      -0.00032844421529358504, -0.00034237097437108435, -0.00033492294950110516,
      -0.00030691997097498467, -0.0002604372716502801, -0.00019865620434687147,
      -0.0001256491734076548, -4.6113168497538754e-05, 3.493077996300664e-05,
      0.00011245309183490447, 0.00018172634226413216, 0.00023861207609497334,
      0.00027980642416201775, 0.0003030300493743039, 0.0003071516317878376,
      0.00029223838742200886, 0.000259531730607697, 0.00021135084364393088,
      0.00015093132246030898, 8.220995504172864e-05, 9.569829205567106e-06,
      -6.243782333601315e-05, -0.0001293774796623542, -0.00018720125231743074,
      -0.00023249230048878175, -0.0002626651764157411, -0.00027611146193760096,
      -0.00027228262438261006, -0.0002517060334040292, -0.00021593427575958916,
      -0.00016743202127630612, -0.00010940847751841472, -4.56066949148402e-05,
      1.9936541340565612e-05, 8.314491158785956e-05, 0.00014015492115280643,
      0.0001875508679846801, 0.00022256820334867983, 0.00024325326148338618,
      0.0002485702306877989, 0.00023844964963579964, 0.00021377641952421227,
      0.00017631909109096203, 0.00012860578187442575, 7.375528416982192e-05,
      1.5274546669021747e-05, -4.3164399365609974e-05, -9.795394953292556e-05,
      -0.00014577259195306798, -0.0001837851746196943, -0.0002098097694543751,
      -0.00022244139275665023, -0.00022112566968632294, -0.00020617873752046856,
      -0.00017875306428975757, -0.0001407522042636654, -9.470061371995682e-05,
      -4.357732206436674e-05, 9.375663046673888e-06, 6.085796112793811e-05,
      0.00010771558247159497, 0.00014713320428013323, 0.00017680229768390077,
      0.0001950551314799607, 0.00020095695333130617, 0.00019435136113625734,
      0.00017585685150819198, 0.00014681558073809765, 0.00010919830677506151,
      6.547211948930605e-05, 1.843975281214947e-05, -2.89391210959967e-05,
      -7.373327814560192e-05, -0.00011322045003848778, -0.00014505189025113701,
      -0.00016739110574583323, -0.0001790186235882138, -0.0001793968957248511,
      -0.00016869200571552985, -0.0001477515646262199, -0.00011804089867335864,
      -8.154217104447889e-05, -4.062329074119882e-05, 2.114788634829073e-06,
      4.400258780874364e-05, 8.246808135369164e-05, 0.00011519386491610343,
      0.00014025595435548444, 0.0001562359560487942, 0.00016230013089479092,
      0.00015824102775567026, 0.0001444797460152473, 0.00012202935053489212,
      9.242235209595304e-05, 5.760733611634882e-05, 1.9821641759369522e-05,
      -1.855164391891357e-05, -5.513328284724444e-05, -8.769472607872242e-05,
      -0.00011429317704825007, -0.00013338673684931568, -0.0001439228573422129,
      -0.00014539509006782048, -0.0001378651608954759, -0.00012194959128982931,
      -9.877228925162749e-05, -6.988661021060783e-05, -3.7172214271970836e-05,
      -2.7135127163024762e-06, 3.133248096643122e-05, 6.287055761338506e-05,
      8.999563960502867e-05, 0.00011110720761553822, 0.00012500299572619142,
      0.00013094651882325931, 0.0001287047034521662, 0.00011855380203797718,
      0.0001012537593616188, 7.799314524176684e-05, 5.0308549156496515e-05,
      1.99838437801842e-05, -1.1064123645920355e-05, -4.090612562305271e-05,
      -6.771988248263695e-05, -8.990077769461081e-05, -0.00010615726933602774,
      -0.00011558536425729174, -0.00011771790910973798, -0.00011254607881761554,
      -0.00010051220384617571, -8.247486175508227e-05, -5.964885547806759e-05,
      -3.352420722576836e-05, -5.769523060739901e-06, 2.1874041946974327e-05,
      4.770151261158186e-05, 7.014875776266247e-05, 8.788669559313926e-05,
      9.989939964244961e-05, 0.00010554155386428627, 0.00010457205695663319,
      9.716210267186628e-05, 8.387766697688058e-05, 6.563791434250681e-05,
      4.365249684690666e-05, 1.9341972965532733e-05, -5.7534559813147375e-06,
      -3.007105995376204e-05, -5.212245007650779e-05, -7.058422717639475e-05,
      -8.437691665019658e-05, -9.272751308157528e-05, -9.52120487874725e-05,
      -9.177589427476483e-05, -8.273091212334006e-05, -6.873002978704143e-05,
      -5.0721181548457214e-05, -2.9883810873705782e-05, -7.552147483370708e-06,
      1.4869780914007376e-05, 3.599601545616277e-05, 5.454393772886748e-05,
      6.941172474942587e-05, 7.974333650424092e-05, 8.497723332846074e-05,
      8.487608904833687e-05, 7.953598526060913e-05, 6.937486456322718e-05,
      5.510130494738779e-05, 3.76658747427242e-05, 1.8198365024176417e-05,
      -2.0649871322332776e-06, -2.1859622408201444e-05, -3.9971216234340127e-05,
      -5.53098112245044e-05, -6.697502225790068e-05, -7.430843845460031e-05,
      -7.693020208052146e-05, -7.475777226520833e-05, -6.800601495820138e-05,
      -5.716892801714241e-05, -4.2984439056532546e-05, -2.6384734648744284e-05,
      -8.435431433996946e-06, 9.732467095229836e-06, 2.6993505331231372e-05,
      4.229717326066115e-05, 5.473150807401223e-05, 6.357707020086436e-05,
      6.834812311179316e-05, 6.881868972109193e-05, 6.503213120468897e-05,
      5.7293934257820014e-05, 4.614843489734651e-05, 3.234118648944166e-05,
      1.6769537323392857e-05, 4.2466785487902147e-07, -1.5671189665362984e-05,
      -3.052839168580904e-05, -4.325044001228488e-05, -5.3087767494982907e-05,
      -5.9481545770525224e-05, -6.209497817514014e-05, -6.083035639078275e-05,
      -5.583106739036328e-05, -4.746868018789956e-05, -3.6316160964391104e-05,
      -2.3109103984981313e-05, -8.697573904000469e-06, 6.008308954518497e-06,
      2.009557514744163e-05, 3.270482527064849e-05, 4.3082391389777926e-05,
      5.062509173925678e-05, 5.491494003973112e-05, 5.574183546762781e-05,
      5.311303468372586e-05, 4.724904365106532e-05, 3.856641158122228e-05,
      2.764870995215592e-05, 1.5207687448290074e-05, 2.037164735515253e-06,
      -1.1037361912555185e-05, -2.3210224160246805e-05, -3.3744993604073836e-05,
      -4.2018786498803696e-05, -4.755881162845053e-05, -5.0069035298230604e-05,
      -4.944548344108823e-05, -4.577942735432444e-05, -3.934846039350539e-05,
      -3.059622049857365e-05, -2.010220177705772e-05, -8.543686016250923e-06,
      3.3477226482071857e-06, 1.4832185268185809e-05, 2.520744799930457e-05,
      3.3851569760008547e-05, 4.025997149155917e-05, 4.407461503752711e-05,
      4.510364252808676e-05, 4.333042427569526e-05, 3.891163487335781e-05,
      3.21646610427662e-05, 2.3545298377601644e-05, 1.3617277620431059e-05,
      3.0156396527140367e-06, -7.593675813657324e-06, -1.7555468894953956e-05,
      -2.626555390410051e-05, -3.320720566784445e-05, -3.798159188158398e-05,
      -4.033041373099346e-05, -4.0149488045174686e-05, -3.749258489059485e-05,
      -3.2565447744582605e-05, -2.5710530789179404e-05, -1.7383552034872004e-05,
      -8.123447812668718e-06, 1.4823050947070722e-06, 1.0834780497724068e-05,
      1.9360776204339445e-05, 2.6547773130744018e-05, 3.197455886056926e-05,
      3.533569781275452e-05, 3.645844072937569e-05, 3.531115672531546e-05,
      3.2002910017188276e-05, 2.6774356582549564e-05, 1.998066899887558e-05,
      1.2067678004255063e-05, 3.5428181401291123e-06, -5.057241072269225e-06,
      -1.3200224000994986e-05, -2.0391040190620964e-05, -2.620172747888935e-05,
      -3.029674607052412e-05, -3.2452140075532486e-05, -3.2567486652527895e-05,
      -3.067001640972052e-05, -2.6910782479452226e-05, -2.1553248699766322e-05,
      -1.4955129179760472e-05, -7.544714202884582e-06, 2.067629330353532e-07,
      7.814945266646392e-06, 1.4812479710037572e-05, 2.077758736216918e-05,
      2.535933875153116e-05, 2.829812887828878e-05, 2.9440168658898848e-05,
      2.874519875986401e-05, 2.6287063660318608e-05, 2.2247230725662906e-05,
      1.6901773255993375e-05, 1.0602731300029645e-05, 3.755095781782114e-06,
      -3.2090892488657137e-06, -9.857858660827778e-06, -1.578599653337817e-05,
      -2.0639605717109526e-05, -2.413709499504084e-05, -2.6085348319380692e-05,
      -2.6390158886607308e-05, -2.5060380375679356e-05, -2.220564482935717e-05,
      -1.802789641986654e-05, -1.2807367980396403e-05, -6.883959758345981e-06,
      -6.352475789400658e-07, 5.547464940423408e-06, 1.1283538536259112e-05,
      1.622632123355608e-05, 2.00839800023965e-05, 2.2636596840149478e-05,
      2.3748536588098367e-05, 2.3375402453448343e-05, 2.1565240907416833e-05,
      1.84540183986735e-05, 1.4255745629423052e-05, 9.24794929959236e-06,
      3.7534667086551652e-06, -1.8802507754901425e-06, -7.303005527917103e-06,
      -1.2183522810318175e-05, -1.622958663432065e-05, -1.9205424877764874e-05,
      -2.094531653277507e-05, -2.136264452417724e-05, -2.045391182600437e-05,
      -1.8297557715268134e-05, -1.5047734814397977e-05, -1.0923516013857295e-05,
      -6.194274648709181e-06, -1.1622050669915825e-06, 3.856888991923897e-06,
      8.553322821746034e-06, 1.2642549145362176e-05, 1.588230415089109e-05,
      1.8086854017204163e-05, 1.9137511104588973e-05, 1.898883330555068e-05,
      1.767019646960635e-05, 1.5282720726356326e-05, 1.1991818726868981e-05,
      8.015899634184216e-06, 3.6119910671851866e-06, -9.407813322646561e-07,
      -5.358800581518169e-06, -9.371545875240211e-06, -1.2738075323454556e-05,
      -1.526140478890176e-05, -1.6799930432423246e-05, -1.727523946441925e-05,
      -1.6675887648184884e-05, -1.5056978230150198e-05, -1.2535638996243825e-05,
      -9.28274579485463e-06, -5.511466762470155e-06, -1.4633881236684795e-06,
      2.6068810499510183e-06, 6.447648932039147e-06, 9.8256324915473e-06,
      1.2540051530189871e-05, 1.4434478505995438e-05, 1.5405750267991257e-05,
      1.5409440923174844e-05, 1.4461615821979136e-05, 1.2636820985408041e-05,
      1.0062495508266257e-05, 6.910212177794083e-06, 3.3843405645024304e-06,
      -2.911240156998338e-07, -3.886721539189832e-06, -7.181787270240209e-06,
      -9.977928566901006e-06, -1.211089956203649e-05, -1.3460167497516995e-05,
      -1.3955618910263386e-05, -1.3581039760116812e-05, -1.237420894359301e-05,
      -1.0423656447183948e-05, -7.862342472132884e-06, -4.858699660354971e-06,
      -1.6056359210177317e-06, 1.6917887816737924e-06, 4.829228455251656e-06,
      7.615656368900096e-06, 9.884935685362205e-06, 1.1505658430656754e-05,
      1.2388674455594426e-05, 1.2491884413039917e-05, 1.1822046880872429e-05,
      1.0433538329318583e-05, 8.424193809759829e-06, 5.928534339190524e-06,
      3.108843160246205e-06, 1.4467809486526678e-07, -2.778506115434743e-06,
      -5.480907983718825e-06, -7.799385897472252e-06, -9.597250735012856e-06,
      -1.0772260277620235e-05, -1.126235208381618e-05, -1.1048798932682999e-05,
      -1.015663540556144e-05, -8.652375218582182e-06, -6.639205870410655e-06,
      -4.249999790794371e-06, -1.6386102837387536e-06, 1.0299814214292205e-06,
      3.5900402959067785e-06, 5.8853234891607704e-06, 7.778567680121803e-06,
      9.159644781372181e-06, 9.95190484738748e-06, 1.0116345070838097e-05,
      9.653384059704904e-06, 8.602172167742722e-06, 7.037521952571469e-06,
      5.06468836479789e-06, 2.8123571732811916e-06, 4.243047269283467e-07,
      -1.9497336066807014e-06, -4.163409173755338e-06, -6.082739280543726e-06,
      -7.594171702473725e-06, -8.61125191766737e-06, -9.079504926417003e-06,
      -8.979260294248574e-06, -8.326280621056069e-06, -7.170191619987113e-06,
      -5.590847759619948e-06, -3.6928926356433257e-06, -1.5988803402700897e-06,
      5.585932190480558e-07, 2.6452465294634327e-06, 4.53343204865431e-06,
      6.1099060727476876e-06, 7.282578403527756e-06, 7.985842237046149e-06,
      8.184179088313005e-06, 7.873845213442928e-06, 7.08256770730417e-06,
      5.8673025564252166e-06, 4.310225710847517e-06, 2.513234460026798e-06,
      5.913237096952315e-07, -1.3347349138305476e-06, -3.1459473645095353e-06,
      -4.732414513094762e-06, -5.999964701744956e-06, -6.875703521781889e-06,
      -7.312156377431432e-06, -7.28977174984579e-06, -6.8176582021416635e-06,
      -5.932539361468312e-06, -4.696021410311094e-06, -3.1903702212579887e-06,
      -1.5130839717257945e-06, 2.2938336518926238e-07, 1.928345813111237e-06,
      3.479633776622119e-06, 4.789949925264814e-06, 5.7824467435776195e-06,
      6.401194468647393e-06, 6.614282227968551e-06, 6.415383914047044e-06,
      5.823717963567706e-06, 4.882430569816909e-06, 3.655528704690519e-06,
      2.2235767403372683e-06, 6.784432018015237e-07, -8.825619933935214e-07,
      -2.362787549789872e-06, -3.6721974230328113e-06, -4.732818686729587e-06,
      -5.483352826527463e-06, -5.882679824918018e-06, -5.912057322029384e-06,
      -5.575901039350223e-06, -4.901122169549288e-06, -3.935086944603025e-06,
      -2.7423475697187935e-06, -1.4003670601863571e-06, 5.481107731240883e-09,
      1.38731757455936e-06, 2.6602253923251117e-06, 3.747443324251336e-06,
      4.584968120603699e-06, 5.125291556194655e-06, 5.340056056594728e-06,
      5.221483151844779e-06, 4.7825072225369135e-06, 4.055628081892475e-06,
      3.09057481468078e-06, 1.950945136301996e-06, 7.100450256578805e-07,
      -5.5380102024877e-07, -1.7621706280897357e-06, -2.8413873739817216e-06,
      -3.726990005474881e-06, -4.367557416326341e-06, -4.727664050135582e-06,
      -4.789797894717895e-06, -4.555140110019831e-06, -4.043177320678017e-06,
      -3.290190169079543e-06, -2.346730375791372e-06, -1.2742591185457854e-06,
      -1.411684152367926e-07, 9.81558440285085e-07, 2.024773365842494e-06,
      2.9254021254585552e-06, 3.630236560216196e-06, 4.099053781779612e-06,
      4.306881067812477e-06, 4.245280999310045e-06, 3.922593987515559e-06,
      3.363140772293272e-06, 2.6054516467595455e-06, 1.6996481335206519e-06,
      7.041530525072377e-07, -3.180565739226831e-07, -1.3034147165765513e-06,
      -2.191701132684183e-06, -2.929703315551438e-06, -3.474384088532291e-06,
      -3.795367585230347e-06, -3.8766015972450695e-06, -3.717107517311953e-06,
      -3.3307869368171585e-06, -2.7453127244206922e-06, -2.000188472519904e-06,
      -1.1441101347072353e-06, -2.3180451002149373e-07, 6.794514092452142e-07,
      1.5334099398574315e-06, 2.2783083796819304e-06, 2.8699895647142392e-06,
      3.2745002758108236e-06, 3.4700158494555623e-06, 3.447983503901819e-06,
      3.2134269423490747e-06, 2.7844075488482936e-06, 2.190689647564681e-06,
      1.4717056416500862e-06, 6.739584633421935e-07, -1.5196880418875053e-07,
      -9.546048779083856e-07, -1.6847833180502356e-06, -2.298639490954967e-06,
      -2.7602297064211772e-06, -3.043617173582155e-06, -3.1343049565936333e-06
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_48_40_1000_rp_0_5_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<48>(0.5), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.00264490831736062, -0.03108088440822222, 0.15201464385233174, -0.3855167755689902,
      0.4871703228909303, -0.14610317129356198, -0.27881708930982346, 0.10344905593657977,
      0.23076851729264572, 0.032473932468176536, -0.18310815652257456, -0.13604781040417327,
      0.02203546544843049, 0.13907296964116175, 0.12862796748535982, 0.005129968749251514,
      -0.10881351053002698, -0.12326935008687513, -0.05135386653321666, 0.03924918535600802,
      0.09663276478376544, 0.09738838138273417, 0.043550864684078136, -0.033529952921283586,
      -0.08842423117170438, -0.09188467220030422, -0.04802025822943067,
      0.014118516635656855, 0.06249982703242435, 0.0791280149069598, 0.06319231031287154,
      0.024822290114309777, -0.02112831915219493, -0.058371992032748614,
      -0.07303680073761885, -0.05935601690324601, -0.02325235701984573, 0.02007474758666532,
      0.05356024163874975, 0.06591528760574976, 0.055288184620634374, 0.02804756915195976,
      -0.005326430975911075, -0.03452527142543913, -0.052167574722319754,
      -0.05477612606350439, -0.04263780528334877, -0.01929007500476257,
      0.009138369574821439, 0.035038254984186376, 0.05116780945859574, 0.052906883802448984,
      0.03995109113045224, 0.016489359367516943, -0.010345037684877644,
      -0.03302563794041273, -0.04601037493650923, -0.04703649351640861,
      -0.03710963645652318, -0.019572461972687076, 0.0011367067936903633,
      0.020565012351450113, 0.034985924684255626, 0.041846028503382746, 0.04003213400820848,
      0.030012918693634767, 0.013813033543238866, -0.005268824021806015,
      -0.023245972611549856, -0.03627371363608799, -0.04154196069300725,
      -0.03797791495867407, -0.02652727284273768, -0.009901023051910311,
      0.008148273936699986, 0.023793341879305017, 0.034037340885239575, 0.037296502967889,
      0.03354135080392634, 0.02404643880191866, 0.010915991052694154,
      -0.0034240714039467735, -0.01663729196684084, -0.026753294824496465,
      -0.03234199662504498, -0.03263521462729763, -0.02761762765260701,
      -0.018066465679531483, -0.005494456565156966, 0.008040306921545516,
      0.02025580748257719, 0.029049320885030316, 0.03289715085819957, 0.031156195792242478,
      0.024192444424440237, 0.013303329145022351, 0.0004516063822128159,
      -0.01212644494650476, -0.02234818847845836, -0.028653453419129258,
      -0.030241706352686876, -0.027141489975190905, -0.02011874084637595,
      -0.01046651848775525, 0.00026149804446792845, 0.010511278532621921,
      0.018936680559471383, 0.02453525693414469, 0.026715304312432797, 0.025312373584105582,
      0.020575096519182164, 0.013131330802970714, 0.003933081176226788,
      -0.00582970048608667, -0.014855184373747936, -0.02189332528740242,
      -0.025928556876761356, -0.026348778914111498, -0.023062585168859347,
      -0.01653344382443373, -0.007716846415133718, 0.002091147961237968,
      0.011465023829566618, 0.019078896588907285, 0.023909900455023034, 0.02538040182768115,
      0.02341869617254074, 0.018435392449929644, 0.011228370137861826,
      0.0028400146484635316, -0.00560491342920294, -0.013053699964568413,
      -0.01865116437035834, -0.021823443691057348, -0.022316276184290322,
      -0.02019163709800803, -0.01579163624057019, -0.009680542151685711,
      -0.0025749646179847106, 0.004730389996186302, 0.011437003867850067,
      0.016814622258364047, 0.020269307945796844, 0.021404380702006016,
      0.020068878560866983, 0.016386178064409274, 0.010754984932302005,
      0.003816925918720928, -0.003610477016110005, -0.010630383866050553,
      -0.016381165575075452, -0.020152261709565234, -0.021482738180669113,
      -0.020225729967399665, -0.016567419238595428, -0.01099719892242757,
      -0.0042344278903412875, 0.002875264558200444, 0.00947644378187076,
      0.014814402370259435, 0.01832367967963402, 0.019683841713517607, 0.01883843238393932,
      0.015979371268490864, 0.011503907491770445, 0.005953861915505546,
      -5.273560848150145e-05, -0.005888888248025874, -0.010978385465368161,
      -0.014844238754723755, -0.01714409426670626, -0.017692330094223385,
      -0.01646925213512221, -0.013618012052924573, -0.00942988111771979,
      -0.004318598572107851, 0.0012151480519491087, 0.0066274035644178515,
      0.011380178365060832, 0.014992624055083142, 0.017089648697943154,
      0.017442919928099442, 0.01599921640296044, 0.012891819290013781, 0.008432137147996163,
      0.0030809391697330154, -0.002598812620802268, -0.008002872425600223,
      -0.012553434986392734, -0.015765330735093532, -0.01730211095756127,
      -0.017014526411054796, -0.014956203056675076, -0.011374491447891865,
      -0.006677989427211475, -0.0013855116515188108, 0.003936251008923837,
      0.00873787233594343, 0.012546722282674824, 0.01501385213532373, 0.01594351865144801,
      0.015303432173222317, 0.013216573421342465, 0.009937688129610194,
      0.005819029413064143, 0.0012704589183166464, -0.0032812839445105985,
      -0.007430252588263637, -0.010823236011072785, -0.013184528567845046,
      -0.014333061908538426, -0.014192046559748048, -0.012791515634928762,
      -0.010264147672315507, -0.006834637591522629, -0.0028028572661791696,
      0.0014787738418475418, 0.00563285867020627, 0.009288054809159955,
      0.012111389720641045, 0.013839078865349004, 0.014302737454291068,
      0.013447946744462414, 0.011342659174104514, 0.008173870289688823,
      0.004232236694988327, -0.00011429161179786284, -0.004455424210062754,
      -0.008378580455591882, -0.011509855568156658, -0.013551516780712019,
      -0.0143119568775638, -0.0137248269376186, -0.01185525197174887, -0.008892463521195777,
      -0.005129694521933278, -0.0009335959135690034, 0.0032934167288467767,
      0.007153733471791568, 0.010293634063916323, 0.012436756205417572, 0.0134085765889929,
      0.013149671513100305, 0.011716886437527533, 0.00927294584467401, 0.006066290520547777,
      0.0024038813942653336, -0.0013797476989041105, -0.004953809425205447,
      -0.008019893987986882, -0.010335493154352034, -0.011730833461152815,
      -0.012118318769430415, -0.011494685042201672, -0.009936596108425136,
      -0.00759081028546575, -0.004660225671212654, -0.0013871096506468121,
      0.001965295794117794, 0.005131752373848397, 0.007863672606313966,
      0.009946585685295993, 0.011215572388817843, 0.011567782937221974,
      0.010971127914093897, 0.009468277998663148, 0.007175271998346879,
      0.004274341135424391, 0.001001006263788374, -0.0023739442584485458,
      -0.005566401599313698, -0.00830307613769381, -0.010345696388142919,
      -0.011512944301796203, -0.011697874846473935, -0.01087891119836163,
      -0.009123095939766087, -0.006581049975814362, -0.0034739537238699294,
      -7.371459019354735e-05, 0.0033217831457383364, 0.006415923684961656,
      0.008940418907880903, 0.010679534987965821, 0.011489159126980234, 0.01130893897802663,
      0.010166458100625922, 0.008173226458942636, 0.005513074592317287,
      0.0024242586916632097, -0.000822858476537052, -0.003950337400639943,
      -0.006697073252796291, -0.00884087486621964, -0.01021631831179765,
      -0.010726965602799943, -0.010351128197427478, -0.009140986361279115,
      -0.0072154855406486775, -0.004747962185184808, -0.001949857874656289,
      0.0009478683949135533, 0.0037139369132316653, 0.006134939266061365,
      0.008031130694010024, 0.009268750306148509, 0.009768179076002907,
      0.009507642221977404, 0.008522531981378385, 0.006900736745830888,
      0.004774593594263911, 0.002310227836068604, -0.0003048878254313536,
      -0.0028753144727679068, -0.005211162281814064, -0.007140989303755787,
      -0.008523396114259035, -0.00925669306283211, -0.009286085027140512,
      -0.008607900245814048, -0.007270498297409206, -0.005371640052611933,
      -0.0030522963780017552, -0.0004871102564769427, 0.0021280045031449816,
      0.004590369643554743, 0.006706145744135092, 0.008305834996709309,
      0.009258390459192183, 0.009482661767661606, 0.008955060872955778,
      0.007712611525576495, 0.005850932178761538, 0.00351715793930417,
      0.0008982864489922658, -0.0017941168123836566, -0.0043415469392983136,
      -0.0065369655112877765, -0.008202329978844255, -0.0092036588138303,
      -0.009462269267475848, -0.008961183890438342, -0.0077461579544145405,
      -0.005921284581611065, -0.00363963555806291, -0.001089843101061863,
      0.001520121800462107, 0.0039804968253060275, 0.006097047048566798,
      0.007706670154106582, 0.008690006137178213, 0.00898007963120718, 0.008566385720287437,
      0.007494245973033293, 0.005859670573110932, 0.0038003284805335964,
      0.0014835209452233136, -0.0009077462048499841, -0.003189399805272682,
      -0.005190462450169396, -0.006765661425570044, -0.007805586704755023,
      -0.008243742746984873, -0.008060114497727939, -0.007281153154597946,
      -0.005976358931347892, -0.004251876556476838, -0.0022417094924068624,
      -9.72910478951027e-05, 0.002023779656067433, 0.003969020669408576,
      0.005601600912630964, 0.006809451665915959, 0.007512414363292654,
      0.007667038474411774, 0.007268810094043159, 0.006351759065047163,
      0.004985550605749047, 0.003270309240153485, 0.0013295433104346106,
      -0.0006983655642470874, -0.0026695735778063537, -0.004444508307949525,
      -0.005897329998119536, -0.006924536289861279, -0.007452164426175241,
      -0.007441111617743818, -0.00689018953048971, -0.005836651814242009,
      -0.0043540814575355, -0.002547692143792538, -0.0005472763074921767,
      0.0015017891500722345, 0.003448904381823756, 0.005149265440176034,
      0.006474740077459217, 0.007323766987934912, 0.00762947814759205, 0.00736534677924084,
      0.006547832679393061, 0.005235721682955235, 0.003526119743982164,
      0.0015473420127199932, -0.0005507922369614636, -0.0026085130632989054,
      -0.004468580348393714, -0.0059886724187020145, -0.007052655736933589,
      -0.007579792529131653, -0.007531112682006445, -0.006912416148341132,
      -0.005773660265781966, -0.0042047959359120994, -0.0023284187262691365,
      -0.00028986790921058504, 0.0017543856544222963, 0.0036490907945902302,
      0.005252290249137469, 0.0064461458320929374, 0.007145668655482585,
      0.007304702584288251, 0.006918751732610865, 0.006024511088867817,
      0.004696229241595191, 0.003039280738994562, 0.0011815330522317628,
      -0.0007367556917001605, -0.0025736865070046474, -0.004196278614270069,
      -0.005490049300624196, -0.006366934361782486, -0.006771023592964008,
      -0.0066817720116596506, -0.00611454898630503, -0.00511858800212304,
      -0.0037725845429959167, -0.0021783460035745945, -0.0004530162780836085,
      0.0012795271660551299, 0.0028974765837633345, 0.004289485792004516,
      0.005362094555546205, 0.006045719310391878, 0.006298859531936573,
      0.006110301092507549, 0.005499237042375524, 0.004513363278179217,
      0.0032251332997029697, 0.0017264657391958486, 0.00012228515269159236,
      -0.001476663057740758, -0.0029612508108121985, -0.004231182779970694,
      -0.005201537993165883, -0.005808236550418769, -0.0060121022589745745,
      -0.005801281209827676, -0.005191877851684028, -0.004226778465059643,
      -0.0029727413941673295, -0.0015159382435206007, 4.3775034310973984e-05,
      0.0015994987812575166, 0.0030444239943701653, 0.004279006334669978,
      0.005217715985450438, 0.00579491769803243, 0.005969481491808453,
      0.0057277971519317985, 0.005084961777477583, 0.004084024378902576,
      0.0027932985314432857, 0.0013018856464100824, -0.0002863211449426381,
      -0.0018597682923394844, -0.003307032019960697, -0.004524729117813245,
      -0.005424984431949871, -0.0059419059210832565, -0.006036574369200712,
      -0.005700150368701495, -0.004954830539889968, -0.0038525395433634283,
      -0.0024714130971941837, -0.0009102969768796157, 0.0007183558433620462,
      0.002296676414496513, 0.003710052033529209, 0.004855624525548149,
      0.005649963557075621, 0.006035320211472482, 0.00598397105033719, 0.005500308688065839,
      0.004620509915293216, 0.003409802316487351, 0.0019575393897934583,
      0.0003704666112031495, -0.00123529770289824, -0.0027429441981555763,
      -0.004043646438893922, -0.005044562806393548, -0.005675561576523181,
      -0.0058941713830798804, -0.005688404195110596, -0.005077268244825009,
      -0.0041089696447876595, -0.002856978813391648, -0.0014142971496666908,
      0.00011361151610624678, 0.0016166705878386655, 0.0029882230033479074,
      0.004132650353956351, 0.004972030721278348, 0.005451374422058148,
      0.005542095431597752, 0.005243515818539794, 0.004582349690264414,
      0.003610260419054513, 0.002399719565354228, 0.0010385087414533174,
      -0.00037671040711151913, -0.001747282459439458, -0.002979409991598675,
      -0.003990499744216312, -0.004714583282895631, -0.0051064700020819484,
      -0.005144388027898832, -0.004830978689725428, -0.004192624823667679,
      -0.0032772044747923753, -0.002150462465628812, -0.0008912767502448666,
      0.0004138401896945054, 0.0016766255120210455, 0.0028129428221171145,
      0.0037482705428564024, 0.004422456202569603, 0.0047934469059633745,
      0.0048397784376941365, 0.004561688936816637, 0.003980812452882808,
      0.0031384974139990274, 0.0020928797643958294, 0.0009149154074984451,
      -0.0003163625110027031, -0.0015190522409450154, -0.0026137243977118023,
      -0.003528557712944883, -0.004203948320664243, -0.004596306678557216,
      -0.004680808351835708, -0.004452930647337354, -0.003928682605574763,
      -0.003143516744457019, -0.002149992511244037, -0.0010143388946739652,
      0.00018786747617372256, 0.0013766362860844507, 0.0024727971474804906,
      0.003403199342824556, 0.004105543387805989, 0.004532530103831635,
      0.0046550528536425375, 0.004464216504881325, 0.0039720393682290845,
      0.0032107776209215643, 0.0022309005785723967, 0.001097834087925726,
      -0.00011232746404335723, -0.0013178680946995278, -0.002436928133493677,
      -0.003393050122570778, -0.004120418339296892, -0.0045684312705998415,
      -0.004705285034714417, -0.004520307504265291, -0.004024864171329516,
      -0.0032517525239052175, -0.002253105559042464, -0.0010969298998992378,
      0.00013749766571670332, 0.0013650668221362545, 0.0025007308265832234,
      0.003465452559624247, 0.004191778206501853, 0.004628637868787166,
      0.004745022618177953, 0.004532264216858198, 0.00400474175147181,
      0.0031989518182226903, 0.0021709974580916697, 0.0009926669370105077,
      -0.000253622096227861, -0.0014806526113724705, -0.002602593126244941,
      -0.0035410904333472784, -0.004230828317850669, -0.004624148804272375,
      -0.00469440105109013, -0.004437776688055604, -0.003873502048293975,
      -0.0030423788716031903, -0.002003786408028062, -0.000831370206923354,
      0.00039226224102603127, 0.0015814484949324297, 0.0026535495634184467,
      0.003534760170555714, 0.00416523564943024, 0.004503174872078421, 0.004527579053973522,
      0.00423950603929483, 0.0036617509967186864, 0.0028369988462452287,
      0.0018246026748220874, 0.0006962379832153304, -0.00046924185435094027,
      -0.0015913730599588839, -0.0025936735980648766, -0.0034088682930477994,
      -0.00398338942589495, -0.0042808539484892, -0.004284296605783033,
      -0.003997029803682575, -0.0034420991442550425, -0.0026604010995481095,
      -0.0017076195418072922, -0.0006502147877544179, 0.00043924240423598947,
      0.0014870622389855997, 0.0024234092258176936, 0.003186923711240474,
      0.003728689684077436, 0.0040152980084444565, 0.0040308205367962854,
      0.003777587197995448, 0.0032757397726490187, 0.0025616171634580635,
      0.0016851022798268064, 0.0007061254821725279, -0.00030942999220757344,
      -0.0012941418898350472, -0.002183488844922782, -0.002920027759896263,
      -0.0034570431298059745, -0.003761442210420705, -0.003815722836059282,
      -0.003618903393736409, -0.0031863727717173678, -0.002548687608460577,
      -0.0017494105033107022, -0.0008421419553476448, 0.00011305283734366724,
      0.0010535863214315773, 0.0019184045852438565, 0.0026518982842866417,
      0.0032074226734515304, 0.003550208866623518, 0.0036594894440291474,
      0.003529712855004615, 0.0031707794226869413, 0.002607293491556302,
      0.001876887575768144, 0.0010277315602708545, 0.00011538967379065443,
      -0.0008007728176762097, -0.0016614047133101553, -0.0024109649354636087,
      -0.00300126115870705, -0.0033945096529090397, -0.0035657254870092325,
      -0.0035042943385298693, -0.003214628290079787, -0.002715865082988461,
      -0.0020406299022554465, -0.001232937291943902, -0.00034536470026567555,
      0.0005643248638432403, 0.0014368983628296169, 0.0022154715283952083,
      0.002849188248920543, 0.003296525207138624, 0.0035280085697963204,
      0.003528165282874839, 0.0032965788404357827, 0.0028479754740707835,
      0.0022113281578125233, 0.0014280288416375253, 0.0005492399389774509,
      -0.0003674096100520167, -0.001261573992605087, -0.002074144754613198,
      -0.002751152268244139, -0.0032473574658181763, -0.003529294110726176,
      -0.003577555177141465, -0.0033881643855302123, -0.0029729327153605735,
      -0.0023587660905581786, -0.001585960107895139, -0.0007055860285009072,
      0.0002238653667889354, 0.0011403633927420378, 0.0019824838704440117,
      0.0026935445595998963, 0.003225449401274582, 0.003541978076207196,
      0.0036212924218063207, 0.00345748248061133, 0.003061039066719055,
      0.002458212457831586, 0.0016892931882084017, 0.0008059256280719487,
      -0.00013236718404807966, -0.0010622129971723704, -0.0019206995170825318,
      -0.0026496674818123353, -0.003199691179795823, -0.00353347010080499,
      -0.003628395115181244, -0.0034781091560703893, -0.0030929519162082165,
      -0.0024992556855476526, -0.0017375396548705798, -0.0008597270838929147,
      7.442182784117189e-05, 0.0010014136245948089, 0.0018583766550919832,
      0.0025873650434746266, 0.0031393131810968176, 0.003477367470087091,
      0.0035793663718425715, 0.003439300117247284, 0.003067653361625386,
      0.002490612443007997, 0.001748198121677562, 0.0008914591154626336,
      -2.1073839987798766e-05, -0.0009274237585602035, -0.0017664113247594854,
      -0.0024818132424133665, -0.003026149843840348, -0.0033638451274216287,
      -0.0034735482773221712, -0.0033494657204955263, -0.0030016225131345373,
      -0.002455046324403504, -0.00174794125098974, -0.0009289870271811891,
      -5.3957249871251753e-05, 0.0008181058270783653, 0.0016288953515538863,
      0.002324749665370206, 0.0028602049134077508, 0.0032009554715790906,
      0.0033260306061058294, 0.00322905144387745, 0.0029184962551668157,
      0.002416969747734946, 0.0017595389077926797, 0.0009912594191201036,
      0.0001640688241992031, -0.0006667379464316251, -0.0014462106455743855,
      -0.002123375334296602, -0.002654556097895837, -0.0030061716829923586,
      -0.0031568299738070522, -0.003098592327992843, -0.002837336463072772,
      -0.0023922069544261085, -0.0017942024454407509, -0.0010840044568278123,
      -0.00030920065130426853, 0.00047890741943013905, 0.0012286979048133143,
      0.0018915995944408185, 0.002425221129369754, 0.002796038453436155,
      0.0029814721616785765, 0.00297122846288399, 0.0027678270050677674,
      0.0023862924923361414, 0.0018530413214914872, 0.0012040458859203865,
      0.00048240448184178026, -0.00026451889003741176, -0.0009881952811941661,
      -0.0016420698414851061, -0.0021845372947191313, -0.002581565276395603,
      -0.0028088020815975724, -0.0028530405148250496, -0.002712952308724352,
      -0.0023990551480798884, -0.0019329236099934314, -0.0013457031696593978,
      -0.000676029828962682, 3.250576048329777e-05, 0.0007341837579109818,
      0.0013840880219188666, 0.0019409597040262706, 0.0023697920317418074,
      0.0026440051219203836, 0.002747067863713538, 0.002673470057217751,
      0.0024289897352820014, 0.0020302452711711645, 0.001503566684354905,
      0.0008832627350930675, 0.00020939738144365675, -0.00047478125151489823,
      -0.0011255958019012909, -0.0017017047651479269, -0.0021667046767288763,
      -0.0024914076324471005, -0.0026556535976709566, -0.0026495466640800392,
      -0.002474040751347479, -0.0021408409652589693, -0.0016716294101066674,
      -0.0010966661122917083, -0.0004528543019985428, 0.00021860771408296328,
      0.0008748404642412413, 0.0014739991152558918, 0.001977921112649243,
      0.0023545399159383227, 0.0025799136196274306, 0.002639741128286714,
      0.0025302703368263, 0.0022585405320160123, 0.0018419426843796158,
      0.0013071239103716451, 0.0006883035362688102, 2.510534066059765e-05,
      -0.0006399586304449544, -0.00126419474763154, -0.0018074542652272642,
      -0.0022347066916771938, -0.0025182958720918977, -0.002639733691239602,
      -0.0025909147184413786, -0.0023746711500539624, -0.0020046288672168505,
      -0.0015043697515514857, -0.000905949808155913, -0.000247864307317868,
      0.00042741261883519013, 0.0010761580863868298, 0.0016562257784507,
      0.0021297843804796795, 0.0024657911397173264, 0.0026420382324868494,
      0.002646636003547858, 0.0024788326445283468, 0.0021491123009797406,
      0.0016785602504559315, 0.0010975316691445363, 0.00044370646852663165,
      -0.00024034631692236986, -0.0009099378433031954, -0.0015211824846730474,
      -0.0020338830320579698, -0.002414187552868288, -0.0026368410865076552,
      -0.0026868809176681203, -0.0025606600278460503, -0.0022661271803934425,
      -0.0018223410810962945, -0.001258246931956211, -0.0006107930546976489,
      7.749023580350353e-05, 0.0007612907212826186, 0.0013955083701698901,
      0.0019382445664412164, 0.002353587020180926, 0.002614003737504023,
      0.002702184903986023, 0.0026122079970555207, 0.0023499464709782285,
      0.0019326929356344232, 0.0013880204645919227, 0.0007519569443013815,
      6.659372367986272e-05, -0.0006227119239667233, -0.001270353477952111,
      -0.0018335090104156073, -0.002274988930881594, -0.0025657068385306053,
      -0.002686608053604574, -0.0026299269502243444, -0.002399689458521552,
      -0.0020114279631590648, -0.00149112883635976, -0.0008734844031253594,
      -0.00019956774740856749, 0.00048591272006904624, 0.0011375941880473173,
      0.0017124758375285487, 0.002172768922165195, 0.0024883906038210574,
      0.0026389361972585764, 0.0026150000847626046, 0.0024187597309068554,
      0.002063786935142242, 0.0015741023241099702, 0.0009825396007469055,
      0.0003285318420209304, -0.00034452987626162695, -0.000992187551251595,
      -0.0015718634247345673, -0.0020456670773274376, -0.0023828768051188266,
      -0.002561932490755694, -0.002571810725633694, -0.002412694852595744,
      -0.002095900015415078, -0.0016430630161424114, -0.0010846554637245142,
      -0.00045792311640214937, 0.00019560844017993802, 0.0008328939884365972,
      0.0014122106492676114, 0.0018958935419135738, 0.002252785534808506,
      0.0024602417748018036, 0.002505560316671337, 0.002386749037915595,
      0.002112583472451788, 0.0017019572457729441, 0.0011825733165786772,
      0.0005890671655373198, -3.9310372235455616e-05, -0.0006612951025223909,
      -0.0012363234052012975, -0.001727179364033606, -0.002102402283447315,
      -0.00233829899328096, -0.0024204325926248547, -0.0023444946884229527,
      -0.0021165093428582686, -0.001752361102931035, -0.0012766837252245387,
      -0.0007211876329941445, -0.0001225400703353208, 0.0004800599440105205,
      0.0010474511723171196, 0.0015430556099480814, 0.0019352343726159185,
      0.0021993024634701067, 0.0023190745059201994, 0.002287845261741982,
      0.0021087464270526674, 0.00179446229460208, 0.0013663286777938542,
      0.0008528792822713408, 0.0002879389192945782, -0.0002916086564582175,
      -0.0008482307020945829, -0.0013461756301636862, -0.001753766032286538,
      -0.002045407752028114, -0.0022031880401423474, -0.0022179636806474194,
      -0.0020898739274897793, -0.0018282508720424823, -0.0014509389851690712,
      -0.0009830735025193518, -0.0004554016165072847, 9.774106279938021e-05,
      0.000640665376676075, 0.0011386292897583507, 0.0015600561954280047,
      0.0018785295758842178, 0.0020744386007797815, 0.0021361729523859557,
      0.0020607950937827206, 0.0018541523564298051, 0.0015304273787508779,
      0.0011111612460159327, 0.000623816886028738, 9.997878574424427e-05,
      -0.000426692840285301, -0.0009226209948856747, -0.0013564457860719226,
      -0.0017009981713067837, -0.0019349900667252674, -0.002044316593142736,
      -0.002022891848502277, -0.0018729698734993503, -0.0016049354491891555,
      -0.0012365829266061852, -0.0007919333254470538, -0.0002996684629877333,
      0.00020871585626959987, 0.0007009189355821099, 0.001145878889749262,
      0.0015157223357956822, 0.0017874985422729431, 0.001944591108691034,
      0.0019777213610857047, 0.0018854838970412463, 0.0016743844117230668,
      0.0013583812110658342, 0.0009579627194415373, 0.0004988219122194126,
      1.0213204848259424e-05, -0.0004769035690226771, -0.0009318149835452007,
      -0.001325979405712366, -0.0016348061464728674, -0.0018391784158697242,
      -0.001926626669956991, -0.0018920811419366663, -0.001738158809431216,
      -0.0014749691153178885, -0.0011194526352058113, -0.0006942957368039607,
      -0.0002264903445167349, 0.00025437037532841534, 0.00071795356620846,
      0.0011350892344223012, 0.001479595360422599
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_1_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<1>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.11239691297845443), "design.b()[0] == 0.11239691297845443");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.11239691297845443));
    static_assert(almost_equal(design.b()[1], 0.11239691297845443), "design.b()[1] == 0.11239691297845443");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.11239691297845443));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.7752061740430913), "design.a()[1] == -0.7752061740430913");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.7752061740430913));
    std::cout << "max_deviation(cheby1,lowpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.11239691297845443, 0.19952769386273636, 0.15467510017497305, 0.11990509262637274,
      0.09295116810317289, 0.07205631939809688, 0.05585850367622567, 0.043301856922618856,
      0.033567866833944714, 0.02602201761913026, 0.02017242871940788, 0.01563779128872916,
      0.012122512355420115, 0.009397446422835331, 0.007284958487221112,
      0.005647344796941425, 0.00437785655353912, 0.0033937414293785354,
      0.0026308493091600662, 0.002039450627437885, 0.001580994718045905,
      0.0012255968665587018, 0.0009500902578441723, 0.0007365158337789949,
      0.000570951621625972, 0.0004426052221643685, 0.00034311030088553257,
      0.0002659812236242476, 0.00020619028673305286, 0.00015983998330317787,
      0.0001239089419155681, 9.605497679209518e-05, 7.446241105679804e-05,
      5.772372078536439e-05, 4.4747784741553996e-05, 3.4688759006403895e-05,
      2.689094015165719e-05, 2.0846022831387917e-05, 1.615996560313516e-05,
      1.2527305107874364e-05, 9.711244263745761e-06, 7.528216510896269e-06,
      5.835919918779927e-06, 4.524041152259255e-06, 3.5070646328563955e-06,
      2.718698156158445e-06, 2.107551596013595e-06, 1.6337870093441098e-06,
      1.2665217767149516e-06, 9.81815500869456e-07, 7.611094380452124e-07,
      5.900167354951164e-07, 4.5738461614456375e-07, 3.545673783475952e-07,
      2.748628208093285e-07, 2.1307535570629134e-07, 1.6517733127994487e-07,
      1.280464870201743e-07, 9.926242730256767e-08, 7.694884649545397e-08,
      5.965122088877e-08, 4.624199472218273e-08, 3.5847079808704096e-08,
      2.7788877589122852e-08, 2.154210947681573e-08, 1.6699576268339744e-08,
      1.2945614627120458e-08, 1.003552038572633e-08, 7.779597362750358e-09,
      6.030791907173428e-09, 4.675107120809951e-09, 3.6241719043646943e-09,
      2.809480436057019e-09, 2.1779265798846776e-09, 1.688342131339156e-09,
      1.3088132441111856e-09, 1.0146001075043587e-09, 7.865242675221631e-10,
      6.097184682179008e-10, 4.726575209906131e-10, 3.6640702847982534e-10,
      2.8404099069034343e-10, 2.2019032966447046e-10, 1.7069290302048113e-10,
      1.323221922868156e-10, 1.0257698042365658e-10, 7.951830853911589e-11,
      6.16430837289861e-11, 4.778609909376525e-11, 3.70440790509218e-11,
      2.8716798792014918e-11, 2.2261439722323152e-11, 1.7257205515833028e-11,
      1.3377892262604255e-11, 1.0370624677654119e-11, 8.039372278801117e-12,
      6.232171025957502e-12, 4.831217457014723e-12, 3.7451896008225765e-12,
      2.903294101519642e-12, 2.250651512560916e-12, 1.7447189481566442e-12,
      1.3525169005809989e-12, 1.0484794518280163e-12, 8.127877444143942e-13,
      6.300780776565965e-13, 4.88440415928596e-13, 3.7864202608002313e-13,
      2.9352563636941916e-13, 2.275428855535011e-13, 1.7639264974065458e-13,
      1.3674067113477593e-13, 1.0600221250647423e-13, 8.217356959724662e-14,
      6.370145849494524e-14, 4.938176392083128e-14, 3.8281048276566785e-14,
      2.9675704972836215e-14, 2.30047897140239e-14, 1.7833455018874328e-14,
      1.3824604435151133e-14, 1.0716918711832661e-14, 8.307821552130611e-15,
      6.440274560059908e-15, 4.992540601491094e-15, 3.870248298436705e-15,
      3.0002403760279027e-15, 2.325804863110196e-15, 1.802978289502471e-15,
      1.3976799016879676e-15, 1.0834900891244533e-15, 8.399282066037755e-16,
      6.511175315121879e-16, 5.047503304559451e-16, 3.9128557251973927e-16,
      3.0332699163128763e-16, 2.351409566664913e-16, 1.8228272137826304e-16,
      1.4130669103380611e-16, 1.0954181932300604e-16, 8.491749465510708e-17,
      6.582856614091021e-17, 5.103071090083759e-17, 3.955932215613739e-17,
      3.0666630776397356e-17, 2.377296151496311e-17, 1.8428946541688207e-17,
      1.4286233140226775e-17, 1.1074776134122817e-17, 8.585234835317087e-18,
      6.655327049947628e-18, 5.159250619395395e-18, 3.9994829335909534e-18,
      3.100423863099682e-18, 2.4034677208254057e-18, 1.8631830162971314e-18,
      1.444350977605766e-18, 1.1196697953251645e-18, 8.67974938225632e-19,
      6.728595310271808e-19, 5.216048627160095e-19, 4.043513099883496e-19,
      3.134556319853805e-19, 2.4299274120364605e-19, 1.8836947322872148e-19,
      1.460251786481497e-19, 1.1319962005379103e-19, 8.775304436503094e-20,
      6.802670178284929e-20, 5.273471922185294e-20, 4.088027992720929e-20,
      3.1690645396182494e-20, 2.4566783970530938e-20, 1.9044322610338432e-20,
      1.4763276468002796e-20, 1.144458306710085e-20, 8.871911452965597e-21,
      6.877560533902544e-21, 5.331527388236351e-21, 4.133032948440657e-21,
      3.2039526591547188e-21, 2.4837238827185183e-21, 1.9253980885016742e-21,
      1.4925804856972642e-21, 1.1570576077687552e-21, 8.969582012658684e-22,
      6.95327535479887e-22, 5.39022198486175e-22, 4.178533362127635e-22,
      3.2392248607663793e-22, 2.51106711117997e-22, 1.9465947280232623e-22,
      1.509012251523365e-22, 1.169795614087579e-22, 9.068327824092206e-23,
      7.029823717483031e-23, 5.449562748227401e-23, 4.224534688261118e-23,
      3.274885372799225e-23, 2.53871136027737e-23, 1.968024720600352e-23,
      1.5256249140788228e-23, 1.1826738526678641e-23, 9.168160724674576e-24,
      7.107214798387114e-24, 5.509556791960115e-24, 4.271042441368529e-24,
      3.310938470148961e-24, 2.566659943936262e-24, 1.989690635208485e-24,
      1.542420464849338e-24, 1.1956938673216217e-24, 9.26909268213182e-25,
      7.185457874966224e-25, 5.570211308000368e-25, 4.318062196686529e-25,
      3.3473884747734707e-25, 2.5949162125650814e-25, 2.0115950691049659e-25,
      1.5594009172448085e-25, 1.2088572188566354e-25, 9.371135795942243e-26,
      7.264562326810646e-26, 5.631533567464458e-26, 4.3655995908293635e-26,
      3.384239756210916e-26, 2.623483553456788e-26, 2.0337406481402108e-26,
      1.5765683068406896e-26, 1.2221654852635654e-26, 9.474302298786866e-27,
      7.344537636770232e-27, 5.693530921516139e-27, 4.413660322464562e-27,
      3.42149673210355e-27, 2.652365391194933e-27, 2.0561300270725313e-27,
      1.5939246916220149e-27, 1.2356202619051164e-27, 9.578604558015877e-28,
      7.425393392091204e-28, 5.756210802247875e-28, 4.4622501529960885e-28,
      3.459163868727297e-28, 2.681565188064186e-28, 2.07876588988638e-28,
      1.6114721522301028e-28, 1.249223161707284e-28, 9.684055077131177e-29,
      7.507139285565433e-29, 5.819580723571766e-29, 4.511374907254994e-29,
      3.4972456815271496e-29, 2.7110864444653853e-29, 2.1016509501140991e-29,
      1.6292127922119785e-29, 1.26297581535271e-29, 9.79066649728528e-30,
      7.589785116692396e-30, 5.883648282120309e-30, 4.561040474197692e-30,
      3.53574673565848e-30, 2.7409326993351596e-30, 2.124787951161212e-30,
      1.647148738272542e-30, 1.2768798714761625e-30, 9.898451598796702e-31,
      7.673340792853912e-31, 5.948421158157062e-31, 4.6112528076119105e-31,
      3.574671646534292e-31, 2.7711075305701663e-31, 2.1481796666352974e-31,
      1.6652821405295123e-31, 1.2909369968621729e-31, 1.0007423302682032e-31,
      7.757816330501816e-32, 6.013907116497327e-32, 4.6620179268304126e-32,
      3.6140250803785086e-32, 2.8016145554559994e-32, 2.1718289006784815e-32,
      1.6836151727711785e-32, 1.3051488766448436e-32, 1.0117594672204879e-32,
      7.843221856358708e-33, 6.080114007438987e-33, 4.713341917452585e-33,
      3.653811754785346e-33, 2.832457431100822e-33, 2.195738488303591e-33,
      1.702150032716988e-33, 1.319517214509859e-33, 1.022897891444185e-33,
      7.92956760863192e-34, 6.147049767703575e-34, 4.765230932073962e-34,
      3.69403643928485e-34, 2.8636398548737728e-34, 2.219911295734011e-34,
      1.720888942281004e-34, 1.3340437328987194e-34, 1.03415893818658e-34,
      8.016863938240845e-35, 6.214722421387715e-35, 4.817691191023787e-35,
      3.734703955914654e-35, 2.895165564848197e-35, 2.2443502207472762e-35,
      1.7398341478382635e-35, 1.3487301732152224e-35, 1.0455439573946485e-35,
      8.105121310057783e-36, 6.283140080925022e-36, 4.8707289831106855e-36,
      3.7758191797980315e-36, 2.9270383402497552e-36, 2.269058193022453e-36,
      1.758987920494066e-36, 1.3635782960342182e-36, 1.057054313876884e-36,
      8.194350304162442e-37, 6.352310948058609e-37, 4.924350666376557e-37,
      3.817387039728318e-37, 2.9592620019094716e-37, 2.294038174491341e-37,
      1.77835255635623e-37, 1.378589881312664e-37, 1.0686913874669096e-37,
      8.284561617110259e-38, 6.42224331482429e-38, 4.978562668858758e-38,
      3.8594125187597595e-38, 2.9918404127217636e-38, 2.3192931596935416e-38,
      1.7979303768103428e-38, 1.3937667286029993e-38, 1.0804565731888867e-38,
      8.375766063214662e-39, 6.492945564544603e-39, 5.0333714893606814e-39,
      3.9019006548048706e-39, 3.0247774781075166e-39, 2.3448261761354383e-39,
      1.817723728798045e-39, 1.409110657268874e-39, 1.0923512814247497e-39,
      8.467974575843483e-40, 6.564426172833796e-40, 5.088783698230819e-40,
      3.9448565412383665e-40, 3.0580771464822563e-40, 2.3706402846531243e-40,
      1.8377349850983735e-40, 1.4246235067032477e-40, 1.1043769380832769e-40,
      8.56119820872961e-41, 6.636693708613848e-41, 5.144805938150396e-41,
      3.988285327507746e-41, 3.091743409729477e-41, 2.39673857977933e-41,
      1.8579665446122068e-41, 1.4403071365488914e-41, 1.1165349847710264e-41,
      8.655448137296087e-42, 6.709756835141701e-42, 5.201444924929679e-42,
      4.032192219750591e-42, 3.125780303679176e-42, 2.423124190114386e-42,
      1.8784208326498374e-42, 1.4561634269213184e-42, 1.128826878965152e-42,
      8.750735659995792e-43, 6.783624311047784e-43, 5.258707448313054e-43,
      4.07658248141867e-43, 3.1601919085916587e-43, 2.4498002787012742e-43,
      1.8991003012217137e-43, 1.472194278634167e-43, 1.1412540941881214e-43,
      8.847072199665874e-44, 6.858304991385979e-44, 5.316600372792961e-44,
      4.1214614339089046e-44, 3.194982349646675e-44, 2.476770043404805e-44,
      1.9200074293323801e-44, 1.4884016134270656e-44, 1.1538181201843597e-44,
      8.944469304897092e-45, 6.933807828695144e-45, 5.3751306384327966e-45,
      4.1668344572012873e-45, 3.230155797437931e-45, 2.5040367172949692e-45,
      1.941144723277655e-45, 1.504787374196006e-45, 1.1665204630988356e-45,
      9.042938651418234e-46, 7.01014187407232e-46, 5.43430526169887e-46,
      4.2127069905038214e-46, 3.265716468473053e-46, 2.531603569034511e-46,
      1.9625147169450783e-46, 1.5213535252262545e-46, 1.1793626456576143e-46,
      9.142492043495772e-47, 7.087316278257761e-47, 5.494131336301521e-47,
      4.2590845329045585e-47, 3.3016686256790496e-47, 2.5594739032707673e-47,
      1.9841199721176686e-47, 1.538102052427823e-47, 1.192346207350399e-47,
      9.243141415348933e-48, 7.16534029273189e-48, 5.554616034045493e-48,
      4.305972644030816e-48, 3.338016578913343e-48, 2.5876510610318212e-48,
      2.005963078781024e-48, 1.5550349635735378e-48, 1.20547270461508e-48,
      9.344898832580337e-49, 7.244223270824354e-49, 5.615766605689676e-49,
      4.3533769447156514e-49, 3.3747646854804226e-49, 2.616138420127015e-49,
      2.0280466554338007e-49, 1.5721542885397241e-49, 1.2187437110243179e-49,
      9.447776493622405e-50, 7.323974668835277e-50, 5.677590381816312e-50,
      4.401303117671677e-50, 3.4119173506541904e-50, 2.6449393955518754e-50,
      2.050373349401616e-50, 1.5894620795495452e-50, 1.2321608174741786e-50,
      9.551786731199657e-51, 7.404604047168852e-51, 5.740094773709755e-51,
      4.4497569081722834e-51, 3.449479028206051e-51, 2.674057439897494e-51,
      2.0729458371543997e-51, 1.6069604114190154e-51, 1.2457256323748469e-51,
      9.656942013807155e-52, 7.48612107147943e-52, 5.8032872742449366e-52,
      4.4987441247403774e-52, 3.487454220938823e-52, 2.703496043764415e-52,
      2.095766824627246e-52, 1.6246513818057257e-52, 1.2594397818434382e-52,
      9.763254947205173e-53, 7.568535513830206e-53, 5.867175458785576e-53,
      4.548270639844686e-53, 3.525847481226522e-53, 2.733258736181082e-53,
      2.118839047544792e-53, 1.6425371114603059e-53, 1.2733049098989345e-53,
      9.870738275930361e-54, 7.651857253864676e-54, 5.931766986092311e-54,
      4.598342390603739e-54, 3.5646634115600866e-54, 2.763349085026888e-54,
      2.142165271749171e-54, 1.6606197444806538e-54, 1.2873226786592635e-54,
      9.979404884823516e-55, 7.736096279990975e-55, 5.997069599240795e-55,
      4.6489653794975916e-55, 3.603906665099116e-55, 2.7937706974598826e-55,
      2.1657482935315742e-55, 1.6789014485689658e-55, 1.3014947685405518e-55,
      1.0089267800574198e-55, 7.821262690579279e-56, 6.063091126549937e-56,
      4.700145675087394e-56, 3.643581946229681e-56, 2.8245272203491914e-56,
      2.189590939967464e-56, 1.697384415291594e-56, 1.3158228784585662e-56,
      1.0200340193282326e-56, 7.907366695172359e-57, 6.129839482520328e-57,
      4.7518894127428664e-57, 3.6836940111282695e-57, 2.8556223407121944e-57,
      2.2136960692554773e-57, 1.7160708603417686e-57, 1.3303087260323786e-57,
      1.0312635378036992e-57, 7.994418615709485e-58, 6.197322668783016e-58,
      4.804202795377802e-58, 3.7242476683319506e-58, 2.887059786156515e-58,
      2.2380665710600577e-58, 1.7349630238052076e-58, 1.3449540477902678e-58,
      1.0426166816512626e-58, 8.08242888776379e-59, 6.265548775058727e-59,
      4.857092094193653e-59, 3.765247779314808e-59, 2.918843325326878e-59,
      2.2627053668578634e-59, 1.7540631704286536e-59, 1.3597605993778915e-59,
      1.054094811858276e-59, 8.171408061793264e-60, 6.334525980127629e-60,
      4.9105636494313025e-60, 3.80669925907072e-60, 2.9509767683568833e-60,
      2.2876154102879854e-60, 1.7733735898913658e-60, 1.374730155768748e-60,
      1.065699304395154e-60, 8.261366804405511e-61, 6.404262552809795e-61,
      4.9646238711311225e-61, 3.8486070767025586e-61, 2.9834639673257564e-61,
      2.312799687506022e-61, 1.7928965970796005e-61, 1.389864511476955e-61,
      1.0774315503803206e-61, 8.352315899636446e-62, 6.474766852956449e-62,
      5.019279239901396e-62, 3.890976256017876e-62, 3.01630881672013e-62,
      2.338261217542056e-62, 1.8126345323641177e-62, 1.4051654807723758e-62,
      1.0892929562469744e-62, 8.444266250243055e-63, 6.54604733245212e-63,
      5.074536307695191e-63, 3.9338118761311447e-63, 3.0495152539009e-63,
      2.3640030526625629e-63, 1.8325897618807338e-63, 1.4206348978981035e-63,
      1.1012849439116865e-63, 8.537228879010389e-64, 6.618112536227833e-64,
      5.130401698595798e-64, 3.9771190720726254e-64, 3.08308725957523e-64,
      2.3900282787363133e-64, 1.8527646778139725e-64, 1.4362746172903504e-64,
      1.1134089509448579e-64, 8.631214930072952e-65, 6.690971103285461e-65,
      5.186882109610804e-65, 4.020903035403949e-65, 3.117028858273748e-65,
      2.416340015604297e-65, 1.8731616986838308e-65, 1.4520865138007503e-65,
      1.12566643074305e-65, 8.726235670250623e-66, 6.764631767733337e-66,
      5.243984311474913e-66, 4.065169014840462e-66, 3.1513441188329977e-66,
      2.442941417453725e-66, 1.8937832696357088e-66, 1.4680724829211138e-66,
      1.1380588527032182e-66, 8.822302490399319e-67, 6.839103359833293e-67,
      5.301715149461618e-67, 4.109922316880437e-67, 3.186037154883201e-67,
      2.4698356731961425e-67, 1.9146318627335245e-67, 1.4842344410106526e-67,
      1.1505877023988544e-67, 8.91942690677647e-68, 6.914394807059191e-68,
      5.360081544203774e-68, 4.155168306441193e-68, 3.2211121253413886e-68,
      2.497026006849708e-68, 1.93570997725606e-68, 1.5005743255257098e-68,
      1.1632544817580778e-68, 9.017620562421585e-69, 6.990515135167146e-69,
      5.419090492523247e-69, 4.2009124075022374e-69, 3.256573234909961e-69,
      2.524515677925684e-69, 1.9570201399965706e-69, 1.5170940952520165e-69,
      1.1760607092436807e-69, 9.116895228551983e-70, 7.067473469277497e-70,
      5.4787490682696616e-70, 4.247160103755476e-70, 3.292424734580741e-70,
      2.552307981819177e-70, 1.978564905565688e-70, 1.5337957305395073e-70,
      1.1890079200351597e-70, 9.2172628059739e-71, 7.145279034968716e-71,
      5.53906442316841e-71, 4.293916939262586e-71, 3.3286709221445702e-71,
      2.580406250204181e-71, 2.000346856697663e-71, 1.5506812335397191e-71,
      1.202097666212747e-71, 9.318735326509127e-72, 7.223941159383338e-72,
      5.600043787677971e-72, 4.3411885191196213e-72, 3.365316142706515e-72,
      2.6088138514329716e-72, 2.0223686045599757e-72, 1.5677526284458043e-72,
      1.215331516943472e-72, 9.421324954437354e-73, 7.303469272346084e-73,
      5.661694471856688e-73, 4.3889805101289434e-73, 3.402364789206753e-73,
      2.6375341909398962e-73, 2.0446327890663572e-73, 1.5850119617351858e-73,
      1.228711058669268e-73, 9.525043987954396e-74, 7.383872907494276e-74,
      5.7240238662390744e-74, 4.437298641478537e-74, 3.4398213029471835e-74,
      2.6665707116496077e-74, 2.0671420791932555e-74, 1.6024613024148845e-74,
      1.2422378952971518e-74, 9.629904860646474e-75, 7.465161703420722e-75,
      5.787039442721784e-75, 4.486148705428817e-75, 3.477690174123841e-75,
      2.695926894389795e-75, 2.089899173299786e-75, 1.6201027422695465e-75,
      1.2559136483914957e-75, 9.735920142980716e-76, 7.547345404829148e-76,
      5.85074875545931e-76, 4.53553655800699e-76, 3.51597594236517e-76,
      2.725606258308456e-76, 2.112906799451204e-76, 1.6379383961122012e-76,
      1.2697399573684169e-76, 9.843102543812084e-77, 7.630433863702385e-77,
      5.9151594417695684e-77, 4.585468119709055e-77, 3.554683197276225e-77,
      2.7556123612957656e-77, 2.1361677157459392e-77, 1.6559704020377794e-77,
      1.2837184796923068e-77, 9.95146491190687e-78, 7.714437040483393e-78,
      5.98027922304944e-78, 4.635949376209547e-78, 3.5938165789888584e-78,
      2.785948800410584e-78, 2.159684710646229e-78, 1.674200921679424e-78,
      1.2978508910745235e-78, 1.0061020237482983e-78, 7.799365005269297e-79,
      6.046115905700386e-79, 4.686986379079076e-79, 3.6333807787179724e-79,
      2.816619212311667e-79, 2.1834606033123933e-79, 1.6926321404676202e-79,
      1.3121388856742722e-79, 1.0171781653767178e-79, 7.885227939018562e-80,
      6.11267738206427e-80, 4.738585246509782e-80, 3.6733805393238865e-80,
      2.8476272736936174e-80, 2.207498243940788e-80, 1.711266267892181e-80,
      1.3265841763016973e-80, 1.0283762438569445e-80, 7.97203613477147e-81,
      6.179971631369466e-81, 4.790752164048765e-81, 3.713820655880904e-81,
      2.8789767017276396e-81, 2.2318005141054816e-81, 1.7301055377671147e-81,
      1.34118849462321e-81, 1.0396976015874718e-81, 8.059799998884024e-82,
      6.248006720687395e-82, 4.8434933853395975e-82, 3.75470597625213e-82,
      2.910671254507144e-82, 2.256370327103688e-82, 1.7491522084984085e-82,
      1.355953591369075e-82, 1.0511435957452098e-82, 8.148530052275419e-83,
      6.316790805899579e-83, 4.896815232871988e-83, 3.796041401670623e-83,
      2.9427147314982573e-83, 2.2812106283050067e-83, 1.768408563354761e-83,
      1.3708812365432838e-83, 1.0627155984481811e-83, 8.238236931689286e-84,
      6.3863321326753475e-84, 4.950724098739712e-84, 3.8378318873269436e-84,
      2.975110973995296e-84, 2.3063243955045085e-84, 1.7878769107412953e-84,
      1.385973219635741e-84, 1.0744149969200078e-84, 8.32893139096879e-85,
      6.456639037460318e-85, 5.0052264454068815e-85, 3.8800824429631703e-85,
      3.0078638655812507e-85, 2.3317146392797046e-85, 1.8075595844762865e-85,
      1.401231349836782e-85, 1.0862431936562082e-85, 8.42062430234578e-86,
      6.527719948475747e-86, 5.060328806482649e-86, 3.922798133473457e-86,
      3.0409773325933388e-86, 2.3573844033514476e-86, 1.8274589440709313e-86,
      1.4166574562540543e-86, 1.0982016065923235e-86, 8.513326657744113e-87,
      6.599583386728872e-87, 5.1160377875044365e-87, 3.965984079511196e-87,
      3.074455344593686e-87, 2.3833367649488054e-87, 1.847577375012202e-87,
      1.4322533881317869e-87, 1.1102916692738973e-87, 8.607049570097352e-88,
      6.672237967034403e-88, 5.172360066729793e-88, 4.009645458102871e-88,
      3.108301914845185e-88, 2.4095748351779505e-88, 1.8679172890488114e-88,
      1.4480210150724723e-88, 1.1225148310283247e-88, 8.701804274680948e-89,
      6.745692399047235e-89, 5.229302395936969e-89, 4.053787503268669e-89,
      3.1425211007926e-89, 2.4361017593951153e-89, 1.888481124480331e-89,
      1.4639622272609921e-89, 1.1348725571385963e-89, 8.797602130459108e-90,
      6.819955488306554e-90, 5.286871601234307e-90, 4.0984155066499195e-90,
      3.177117004548962e-90, 2.462920717583648e-90, 1.9092713464494847e-90,
      1.4800789356912066e-90, 1.147366329018951e-90, 8.894454621446477e-91,
      6.895036137291415e-91, 5.345074583878533e-91, 4.143534818143446e-91,
      3.212093773387317e-91, 2.4900349247352183e-91, 1.9302904472376655e-91,
      1.4963730723950382e-91, 1.1599976443924633e-91, 8.992373358084799e-92,
      6.970943346487943e-92, 5.4039183211020614e-92, 4.189150846542895e-92,
      3.247455600237895e-92, 2.5174476312352292e-92, 1.951540946563705e-92,
      1.5128465906740828e-92, 1.1727680174705904e-92, 9.091370078634778e-93,
      7.0476862154683045e-93, 5.4634098669494186e-93, 4.2352690601871336e-93,
      3.283206724190747e-93, 2.5451621232524597e-93, 1.9730253918859302e-93,
      1.5295014653337629e-93, 1.1856789791346882e-93, 9.191456650583199e-94,
      7.125273943981529e-94, 5.523556353122849e-94, 4.281894987615774e-94,
      3.319351431003914e-94, 2.5731817231330044e-94, 1.9947463587075455e-94,
      1.5463396929200642e-94, 1.1987320771195317e-94, 9.292645072065601e-95,
      7.203715833056362e-95, 5.584364989837263e-95, 4.329034218231931e-95,
      3.3558940536172006e-95, 2.601509789798551e-95, 2.0167064508853816e-95,
      1.5633632919588783e-95, 1.2119288761988543e-95, 9.394947473304572e-96,
      7.2830212861162456e-96, 5.645843066684569e-96, 4.376692402972258e-96,
      3.392838972671588e-96, 2.6301497191490345e-96, 2.0389083009420342e-96,
      1.5805743031979741e-96, 1.2252709583729266e-96, 9.498376118063881e-97,
      7.363199810106571e-97, 5.707997953507532e-97, 4.4248752549843685e-97,
      3.4301906170343806e-97, 2.659104944469733e-97, 2.0613545703814486e-97,
      1.597974789851643e-97, 1.238759923058205e-97, 9.602943405118654e-98,
      7.444261016634367e-98, 5.770837101283261e-98, 4.47358855031172e-98,
      3.467953464330128e-98, 2.6883789368428426e-98, 2.0840479500079736e-98,
      1.615566837848029e-98, 1.2523973872790659e-98, 9.708661869741685e-99,
      7.526214623120497e-99, 5.834368043016407e-99, 4.522838128586027e-99,
      3.506132041477389e-99, 2.71797520556358e-99, 2.1069911602489276e-99,
      1.6333525560791852e-99, 1.2661849858616488e-99, 9.815544185206145e-100,
      7.609070453964567e-100, 5.898598394642201e-100, 4.572629893727301e-100,
      3.5447309252314087e-100, 2.7478972985608677e-100, 2.1301869514807166e-100,
      1.6513340766538826e-100, 1.2801243716298373e-100, 9.923603164304826e-101,
      7.692838441722659e-101, 5.96353585593944e-101, 4.622969814651605e-101,
      3.58375474273277e-101, 2.7781488028226536e-101, 2.1536381043585437e-101,
      1.6695135551532025e-101, 1.2942172156033936e-101, 1.0032851760886094e-101,
      7.777528628298e-102, 6.0291882114535045e-102, 4.67386392598658e-102,
      3.623208172062078e-102, 2.8087333448259064e-102, 2.1773474301497457e-102,
      1.6878931708889413e-102, 1.308465207198278e-102, 1.0143303071406778e-102,
      7.863151166144786e-103, 6.095563331429571e-103, 4.725318328794878e-103,
      3.6630959428007715e-103, 2.8396545909713565e-103, 2.2013177710708046e-103,
      1.706475127164864e-103, 1.322870054429172e-103, 1.0254970336502144e-103,
      7.94971631948522e-104, 6.162669172756063e-104, 4.77733919130553e-104,
      3.703422836598076e-104, 2.870916248023007e-104, 2.2255520006280618e-104,
      1.7252616515408274e-104, 1.3374334841142298e-104, 1.0367866942573137e-104,
      8.037234465539964e-105, 6.230513779918505e-105, 4.829932749653383e-105,
      3.7441936877442274e-105, 2.9025220635524956e-105, 2.2500530239621884e-105,
      1.7442549960998164e-105, 1.3521572420820858e-105, 1.0482006423391117e-105,
      8.125716095772135e-106, 6.299105285963883e-106, 4.883105308626674e-106,
      3.7854133837499924e-106, 2.934475826388344e-106, 2.2748237781964466e-106,
      1.7634574377179171e-106, 1.3670430933811396e-106, 1.0597402461720257e-106,
      8.215171817144998e-107, 6.368451913475604e-107, 4.936863242422827e-107,
      3.8270868659325704e-107, 2.9667813670701534e-107, 2.2998672327887858e-107,
      1.7828712783372664e-107, 1.3820928224911478e-107, 1.07140688909578e-107,
      8.305612353393503e-108, 6.438561975559214e-108, 4.991212995412586e-108,
      3.869219130007948e-108, 2.9994425583077997e-108, 2.3251863898878112e-108,
      1.802498845241998e-108, 1.3973082335371394e-108, 1.0832019696792362e-108,
      8.397048546309814e-109, 6.509443876838932e-109, 5.046161082912537e-109,
      3.91181522668977e-109, 3.0324633154456846e-109, 2.3507842846926773e-109,
      1.8223424913372355e-109, 1.4126911505056936e-109, 1.0951269018880517e-109,
      8.489491357043004e-110, 6.581106114465198e-110, 5.101714091966161e-110,
      3.954880262294811e-110, 3.0658475969320984e-110, 2.3766639858169377e-110,
      1.842404595431152e-110, 1.428243417463593e-110, 1.1071831152541818e-110,
      8.582951867413052e-111, 6.653557279133278e-111, 5.157878682133469e-111,
      3.998419399355108e-111, 3.099599404793749e-111, 2.402828595656405e-111,
      1.862687562520136e-111, 1.443966898778886e-111, 1.119372055047248e-111,
      8.677441281239296e-112, 6.726806056113095e-112, 5.214661586289329e-112,
      4.042437857236828e-112, 3.133722785115514e-112, 2.429281250761058e-112,
      1.8831938240770953e-112, 1.4598634793443833e-112, 1.1316951824477948e-112,
      8.772970925683533e-113, 6.800861226290409e-113, 5.272069611430594e-113,
      4.0869409127659583e-113, 3.168221828525478e-113, 2.4560251222110427e-113,
      1.9039258383429382e-113, 1.4759350648036143e-113, 1.1441539747224519e-113,
      8.869552252607877e-114, 6.875731667219435e-114, 5.3301096394921044e-114,
      4.131933900860875e-114, 3.2031006706853048e-114, 2.483063415996815e-114,
      1.92488609062126e-114
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.11239691297845443, 0.19952769386273636, 0.15467510017497305, 0.11990509262637274,
      0.09295116810317289, 0.07205631939809688, 0.05585850367622567, 0.043301856922618856,
      0.033567866833944714, 0.02602201761913026, 0.02017242871940788, 0.01563779128872916,
      0.012122512355420115, 0.009397446422835331, 0.007284958487221112,
      0.005647344796941425, 0.00437785655353912, 0.0033937414293785354,
      0.0026308493091600662, 0.002039450627437885, 0.001580994718045905,
      0.0012255968665587018, 0.0009500902578441723, 0.0007365158337789949,
      0.000570951621625972, 0.0004426052221643685, 0.00034311030088553257,
      0.0002659812236242476, 0.00020619028673305286, 0.00015983998330317787,
      0.0001239089419155681, 9.605497679209518e-05, 7.446241105679804e-05,
      5.772372078536439e-05, 4.4747784741553996e-05, 3.4688759006403895e-05,
      2.689094015165719e-05, 2.0846022831387917e-05, 1.615996560313516e-05,
      1.2527305107874364e-05, 9.711244263745761e-06, 7.528216510896269e-06,
      5.835919918779927e-06, 4.524041152259255e-06, 3.5070646328563955e-06,
      2.718698156158445e-06, 2.107551596013595e-06, 1.6337870093441098e-06,
      1.2665217767149516e-06, 9.81815500869456e-07, 7.611094380452124e-07,
      5.900167354951164e-07, 4.5738461614456375e-07, 3.545673783475952e-07,
      2.748628208093285e-07, 2.1307535570629134e-07, 1.6517733127994487e-07,
      1.280464870201743e-07, 9.926242730256767e-08, 7.694884649545397e-08,
      5.965122088877e-08, 4.624199472218273e-08, 3.5847079808704096e-08,
      2.7788877589122852e-08, 2.154210947681573e-08, 1.6699576268339744e-08,
      1.2945614627120458e-08, 1.003552038572633e-08, 7.779597362750358e-09,
      6.030791907173428e-09, 4.675107120809951e-09, 3.6241719043646943e-09,
      2.809480436057019e-09, 2.1779265798846776e-09, 1.688342131339156e-09,
      1.3088132441111856e-09, 1.0146001075043587e-09, 7.865242675221631e-10,
      6.097184682179008e-10, 4.726575209906131e-10, 3.6640702847982534e-10,
      2.8404099069034343e-10, 2.2019032966447046e-10, 1.7069290302048113e-10,
      1.323221922868156e-10, 1.0257698042365658e-10, 7.951830853911589e-11,
      6.16430837289861e-11, 4.778609909376525e-11, 3.70440790509218e-11,
      2.8716798792014918e-11, 2.2261439722323152e-11, 1.7257205515833028e-11,
      1.3377892262604255e-11, 1.0370624677654119e-11, 8.039372278801117e-12,
      6.232171025957502e-12, 4.831217457014723e-12, 3.7451896008225765e-12,
      2.903294101519642e-12, 2.250651512560916e-12, 1.7447189481566442e-12,
      1.3525169005809989e-12, 1.0484794518280163e-12, 8.127877444143942e-13,
      6.300780776565965e-13, 4.88440415928596e-13, 3.7864202608002313e-13,
      2.9352563636941916e-13, 2.275428855535011e-13, 1.7639264974065458e-13,
      1.3674067113477593e-13, 1.0600221250647423e-13, 8.217356959724662e-14,
      6.370145849494524e-14, 4.938176392083128e-14, 3.8281048276566785e-14,
      2.9675704972836215e-14, 2.30047897140239e-14, 1.7833455018874328e-14,
      1.3824604435151133e-14, 1.0716918711832661e-14, 8.307821552130611e-15,
      6.440274560059908e-15, 4.992540601491094e-15, 3.870248298436705e-15,
      3.0002403760279027e-15, 2.325804863110196e-15, 1.802978289502471e-15,
      1.3976799016879676e-15, 1.0834900891244533e-15, 8.399282066037755e-16,
      6.511175315121879e-16, 5.047503304559451e-16, 3.9128557251973927e-16,
      3.0332699163128763e-16, 2.351409566664913e-16, 1.8228272137826304e-16,
      1.4130669103380611e-16, 1.0954181932300604e-16, 8.491749465510708e-17,
      6.582856614091021e-17, 5.103071090083759e-17, 3.955932215613739e-17,
      3.0666630776397356e-17, 2.377296151496311e-17, 1.8428946541688207e-17,
      1.4286233140226775e-17, 1.1074776134122817e-17, 8.585234835317087e-18,
      6.655327049947628e-18, 5.159250619395395e-18, 3.9994829335909534e-18,
      3.100423863099682e-18, 2.4034677208254057e-18, 1.8631830162971314e-18,
      1.444350977605766e-18, 1.1196697953251645e-18, 8.67974938225632e-19,
      6.728595310271808e-19, 5.216048627160095e-19, 4.043513099883496e-19,
      3.134556319853805e-19, 2.4299274120364605e-19, 1.8836947322872148e-19,
      1.460251786481497e-19, 1.1319962005379103e-19, 8.775304436503094e-20,
      6.802670178284929e-20, 5.273471922185294e-20, 4.088027992720929e-20,
      3.1690645396182494e-20, 2.4566783970530938e-20, 1.9044322610338432e-20,
      1.4763276468002796e-20, 1.144458306710085e-20, 8.871911452965597e-21,
      6.877560533902544e-21, 5.331527388236351e-21, 4.133032948440657e-21,
      3.2039526591547188e-21, 2.4837238827185183e-21, 1.9253980885016742e-21,
      1.4925804856972642e-21, 1.1570576077687552e-21, 8.969582012658684e-22,
      6.95327535479887e-22, 5.39022198486175e-22, 4.178533362127635e-22,
      3.2392248607663793e-22, 2.51106711117997e-22, 1.9465947280232623e-22,
      1.509012251523365e-22, 1.169795614087579e-22, 9.068327824092206e-23,
      7.029823717483031e-23, 5.449562748227401e-23, 4.224534688261118e-23,
      3.274885372799225e-23, 2.53871136027737e-23, 1.968024720600352e-23,
      1.5256249140788228e-23, 1.1826738526678641e-23, 9.168160724674576e-24,
      7.107214798387114e-24, 5.509556791960115e-24, 4.271042441368529e-24,
      3.310938470148961e-24, 2.566659943936262e-24, 1.989690635208485e-24,
      1.542420464849338e-24, 1.1956938673216217e-24, 9.26909268213182e-25,
      7.185457874966224e-25, 5.570211308000368e-25, 4.318062196686529e-25,
      3.3473884747734707e-25, 2.5949162125650814e-25, 2.0115950691049659e-25,
      1.5594009172448085e-25, 1.2088572188566354e-25, 9.371135795942243e-26,
      7.264562326810646e-26, 5.631533567464458e-26, 4.3655995908293635e-26,
      3.384239756210916e-26, 2.623483553456788e-26, 2.0337406481402108e-26,
      1.5765683068406896e-26, 1.2221654852635654e-26, 9.474302298786866e-27,
      7.344537636770232e-27, 5.693530921516139e-27, 4.413660322464562e-27,
      3.42149673210355e-27, 2.652365391194933e-27, 2.0561300270725313e-27,
      1.5939246916220149e-27, 1.2356202619051164e-27, 9.578604558015877e-28,
      7.425393392091204e-28, 5.756210802247875e-28, 4.4622501529960885e-28,
      3.459163868727297e-28, 2.681565188064186e-28, 2.07876588988638e-28,
      1.6114721522301028e-28, 1.249223161707284e-28, 9.684055077131177e-29,
      7.507139285565433e-29, 5.819580723571766e-29, 4.511374907254994e-29,
      3.4972456815271496e-29, 2.7110864444653853e-29, 2.1016509501140991e-29,
      1.6292127922119785e-29, 1.26297581535271e-29, 9.79066649728528e-30,
      7.589785116692396e-30, 5.883648282120309e-30, 4.561040474197692e-30,
      3.53574673565848e-30, 2.7409326993351596e-30, 2.124787951161212e-30,
      1.647148738272542e-30, 1.2768798714761625e-30, 9.898451598796702e-31,
      7.673340792853912e-31, 5.948421158157062e-31, 4.6112528076119105e-31,
      3.574671646534292e-31, 2.7711075305701663e-31, 2.1481796666352974e-31,
      1.6652821405295123e-31, 1.2909369968621729e-31, 1.0007423302682032e-31,
      7.757816330501816e-32, 6.013907116497327e-32, 4.6620179268304126e-32,
      3.6140250803785086e-32, 2.8016145554559994e-32, 2.1718289006784815e-32,
      1.6836151727711785e-32, 1.3051488766448436e-32, 1.0117594672204879e-32,
      7.843221856358708e-33, 6.080114007438987e-33, 4.713341917452585e-33,
      3.653811754785346e-33, 2.832457431100822e-33, 2.195738488303591e-33,
      1.702150032716988e-33, 1.319517214509859e-33, 1.022897891444185e-33,
      7.92956760863192e-34, 6.147049767703575e-34, 4.765230932073962e-34,
      3.69403643928485e-34, 2.8636398548737728e-34, 2.219911295734011e-34,
      1.720888942281004e-34, 1.3340437328987194e-34, 1.03415893818658e-34,
      8.016863938240845e-35, 6.214722421387715e-35, 4.817691191023787e-35,
      3.734703955914654e-35, 2.895165564848197e-35, 2.2443502207472762e-35,
      1.7398341478382635e-35, 1.3487301732152224e-35, 1.0455439573946485e-35,
      8.105121310057783e-36, 6.283140080925022e-36, 4.8707289831106855e-36,
      3.7758191797980315e-36, 2.9270383402497552e-36, 2.269058193022453e-36,
      1.758987920494066e-36, 1.3635782960342182e-36, 1.057054313876884e-36,
      8.194350304162442e-37, 6.352310948058609e-37, 4.924350666376557e-37,
      3.817387039728318e-37, 2.9592620019094716e-37, 2.294038174491341e-37,
      1.77835255635623e-37, 1.378589881312664e-37, 1.0686913874669096e-37,
      8.284561617110259e-38, 6.42224331482429e-38, 4.978562668858758e-38,
      3.8594125187597595e-38, 2.9918404127217636e-38, 2.3192931596935416e-38,
      1.7979303768103428e-38, 1.3937667286029993e-38, 1.0804565731888867e-38,
      8.375766063214662e-39, 6.492945564544603e-39, 5.0333714893606814e-39,
      3.9019006548048706e-39, 3.0247774781075166e-39, 2.3448261761354383e-39,
      1.817723728798045e-39, 1.409110657268874e-39, 1.0923512814247497e-39,
      8.467974575843483e-40, 6.564426172833796e-40, 5.088783698230819e-40,
      3.9448565412383665e-40, 3.0580771464822563e-40, 2.3706402846531243e-40,
      1.8377349850983735e-40, 1.4246235067032477e-40, 1.1043769380832769e-40,
      8.56119820872961e-41, 6.636693708613848e-41, 5.144805938150396e-41,
      3.988285327507746e-41, 3.091743409729477e-41, 2.39673857977933e-41,
      1.8579665446122068e-41, 1.4403071365488914e-41, 1.1165349847710264e-41,
      8.655448137296087e-42, 6.709756835141701e-42, 5.201444924929679e-42,
      4.032192219750591e-42, 3.125780303679176e-42, 2.423124190114386e-42,
      1.8784208326498374e-42, 1.4561634269213184e-42, 1.128826878965152e-42,
      8.750735659995792e-43, 6.783624311047784e-43, 5.258707448313054e-43,
      4.07658248141867e-43, 3.1601919085916587e-43, 2.4498002787012742e-43,
      1.8991003012217137e-43, 1.472194278634167e-43, 1.1412540941881214e-43,
      8.847072199665874e-44, 6.858304991385979e-44, 5.316600372792961e-44,
      4.1214614339089046e-44, 3.194982349646675e-44, 2.476770043404805e-44,
      1.9200074293323801e-44, 1.4884016134270656e-44, 1.1538181201843597e-44,
      8.944469304897092e-45, 6.933807828695144e-45, 5.3751306384327966e-45,
      4.1668344572012873e-45, 3.230155797437931e-45, 2.5040367172949692e-45,
      1.941144723277655e-45, 1.504787374196006e-45, 1.1665204630988356e-45,
      9.042938651418234e-46, 7.01014187407232e-46, 5.43430526169887e-46,
      4.2127069905038214e-46, 3.265716468473053e-46, 2.531603569034511e-46,
      1.9625147169450783e-46, 1.5213535252262545e-46, 1.1793626456576143e-46,
      9.142492043495772e-47, 7.087316278257761e-47, 5.494131336301521e-47,
      4.2590845329045585e-47, 3.3016686256790496e-47, 2.5594739032707673e-47,
      1.9841199721176686e-47, 1.538102052427823e-47, 1.192346207350399e-47,
      9.243141415348933e-48, 7.16534029273189e-48, 5.554616034045493e-48,
      4.305972644030816e-48, 3.338016578913343e-48, 2.5876510610318212e-48,
      2.005963078781024e-48, 1.5550349635735378e-48, 1.20547270461508e-48,
      9.344898832580337e-49, 7.244223270824354e-49, 5.615766605689676e-49,
      4.3533769447156514e-49, 3.3747646854804226e-49, 2.616138420127015e-49,
      2.0280466554338007e-49, 1.5721542885397241e-49, 1.2187437110243179e-49,
      9.447776493622405e-50, 7.323974668835277e-50, 5.677590381816312e-50,
      4.401303117671677e-50, 3.4119173506541904e-50, 2.6449393955518754e-50,
      2.050373349401616e-50, 1.5894620795495452e-50, 1.2321608174741786e-50,
      9.551786731199657e-51, 7.404604047168852e-51, 5.740094773709755e-51,
      4.4497569081722834e-51, 3.449479028206051e-51, 2.674057439897494e-51,
      2.0729458371543997e-51, 1.6069604114190154e-51, 1.2457256323748469e-51,
      9.656942013807155e-52, 7.48612107147943e-52, 5.8032872742449366e-52,
      4.4987441247403774e-52, 3.487454220938823e-52, 2.703496043764415e-52,
      2.095766824627246e-52, 1.6246513818057257e-52, 1.2594397818434382e-52,
      9.763254947205173e-53, 7.568535513830206e-53, 5.867175458785576e-53,
      4.548270639844686e-53, 3.525847481226522e-53, 2.733258736181082e-53,
      2.118839047544792e-53, 1.6425371114603059e-53, 1.2733049098989345e-53,
      9.870738275930361e-54, 7.651857253864676e-54, 5.931766986092311e-54,
      4.598342390603739e-54, 3.5646634115600866e-54, 2.763349085026888e-54,
      2.142165271749171e-54, 1.6606197444806538e-54, 1.2873226786592635e-54,
      9.979404884823516e-55, 7.736096279990975e-55, 5.997069599240795e-55,
      4.6489653794975916e-55, 3.603906665099116e-55, 2.7937706974598826e-55,
      2.1657482935315742e-55, 1.6789014485689658e-55, 1.3014947685405518e-55,
      1.0089267800574198e-55, 7.821262690579279e-56, 6.063091126549937e-56,
      4.700145675087394e-56, 3.643581946229681e-56, 2.8245272203491914e-56,
      2.189590939967464e-56, 1.697384415291594e-56, 1.3158228784585662e-56,
      1.0200340193282326e-56, 7.907366695172359e-57, 6.129839482520328e-57,
      4.7518894127428664e-57, 3.6836940111282695e-57, 2.8556223407121944e-57,
      2.2136960692554773e-57, 1.7160708603417686e-57, 1.3303087260323786e-57,
      1.0312635378036992e-57, 7.994418615709485e-58, 6.197322668783016e-58,
      4.804202795377802e-58, 3.7242476683319506e-58, 2.887059786156515e-58,
      2.2380665710600577e-58, 1.7349630238052076e-58, 1.3449540477902678e-58,
      1.0426166816512626e-58, 8.08242888776379e-59, 6.265548775058727e-59,
      4.857092094193653e-59, 3.765247779314808e-59, 2.918843325326878e-59,
      2.2627053668578634e-59, 1.7540631704286536e-59, 1.3597605993778915e-59,
      1.054094811858276e-59, 8.171408061793264e-60, 6.334525980127629e-60,
      4.9105636494313025e-60, 3.80669925907072e-60, 2.9509767683568833e-60,
      2.2876154102879854e-60, 1.7733735898913658e-60, 1.374730155768748e-60,
      1.065699304395154e-60, 8.261366804405511e-61, 6.404262552809795e-61,
      4.9646238711311225e-61, 3.8486070767025586e-61, 2.9834639673257564e-61,
      2.312799687506022e-61, 1.7928965970796005e-61, 1.389864511476955e-61,
      1.0774315503803206e-61, 8.352315899636446e-62, 6.474766852956449e-62,
      5.019279239901396e-62, 3.890976256017876e-62, 3.01630881672013e-62,
      2.338261217542056e-62, 1.8126345323641177e-62, 1.4051654807723758e-62,
      1.0892929562469744e-62, 8.444266250243055e-63, 6.54604733245212e-63,
      5.074536307695191e-63, 3.9338118761311447e-63, 3.0495152539009e-63,
      2.3640030526625629e-63, 1.8325897618807338e-63, 1.4206348978981035e-63,
      1.1012849439116865e-63, 8.537228879010389e-64, 6.618112536227833e-64,
      5.130401698595798e-64, 3.9771190720726254e-64, 3.08308725957523e-64,
      2.3900282787363133e-64, 1.8527646778139725e-64, 1.4362746172903504e-64,
      1.1134089509448579e-64, 8.631214930072952e-65, 6.690971103285461e-65,
      5.186882109610804e-65, 4.020903035403949e-65, 3.117028858273748e-65,
      2.416340015604297e-65, 1.8731616986838308e-65, 1.4520865138007503e-65,
      1.12566643074305e-65, 8.726235670250623e-66, 6.764631767733337e-66,
      5.243984311474913e-66, 4.065169014840462e-66, 3.1513441188329977e-66,
      2.442941417453725e-66, 1.8937832696357088e-66, 1.4680724829211138e-66,
      1.1380588527032182e-66, 8.822302490399319e-67, 6.839103359833293e-67,
      5.301715149461618e-67, 4.109922316880437e-67, 3.186037154883201e-67,
      2.4698356731961425e-67, 1.9146318627335245e-67, 1.4842344410106526e-67,
      1.1505877023988544e-67, 8.91942690677647e-68, 6.914394807059191e-68,
      5.360081544203774e-68, 4.155168306441193e-68, 3.2211121253413886e-68,
      2.497026006849708e-68, 1.93570997725606e-68, 1.5005743255257098e-68,
      1.1632544817580778e-68, 9.017620562421585e-69, 6.990515135167146e-69,
      5.419090492523247e-69, 4.2009124075022374e-69, 3.256573234909961e-69,
      2.524515677925684e-69, 1.9570201399965706e-69, 1.5170940952520165e-69,
      1.1760607092436807e-69, 9.116895228551983e-70, 7.067473469277497e-70,
      5.4787490682696616e-70, 4.247160103755476e-70, 3.292424734580741e-70,
      2.552307981819177e-70, 1.978564905565688e-70, 1.5337957305395073e-70,
      1.1890079200351597e-70, 9.2172628059739e-71, 7.145279034968716e-71,
      5.53906442316841e-71, 4.293916939262586e-71, 3.3286709221445702e-71,
      2.580406250204181e-71, 2.000346856697663e-71, 1.5506812335397191e-71,
      1.202097666212747e-71, 9.318735326509127e-72, 7.223941159383338e-72,
      5.600043787677971e-72, 4.3411885191196213e-72, 3.365316142706515e-72,
      2.6088138514329716e-72, 2.0223686045599757e-72, 1.5677526284458043e-72,
      1.215331516943472e-72, 9.421324954437354e-73, 7.303469272346084e-73,
      5.661694471856688e-73, 4.3889805101289434e-73, 3.402364789206753e-73,
      2.6375341909398962e-73, 2.0446327890663572e-73, 1.5850119617351858e-73,
      1.228711058669268e-73, 9.525043987954396e-74, 7.383872907494276e-74,
      5.7240238662390744e-74, 4.437298641478537e-74, 3.4398213029471835e-74,
      2.6665707116496077e-74, 2.0671420791932555e-74, 1.6024613024148845e-74,
      1.2422378952971518e-74, 9.629904860646474e-75, 7.465161703420722e-75,
      5.787039442721784e-75, 4.486148705428817e-75, 3.477690174123841e-75,
      2.695926894389795e-75, 2.089899173299786e-75, 1.6201027422695465e-75,
      1.2559136483914957e-75, 9.735920142980716e-76, 7.547345404829148e-76,
      5.85074875545931e-76, 4.53553655800699e-76, 3.51597594236517e-76,
      2.725606258308456e-76, 2.112906799451204e-76, 1.6379383961122012e-76,
      1.2697399573684169e-76, 9.843102543812084e-77, 7.630433863702385e-77,
      5.9151594417695684e-77, 4.585468119709055e-77, 3.554683197276225e-77,
      2.7556123612957656e-77, 2.1361677157459392e-77, 1.6559704020377794e-77,
      1.2837184796923068e-77, 9.95146491190687e-78, 7.714437040483393e-78,
      5.98027922304944e-78, 4.635949376209547e-78, 3.5938165789888584e-78,
      2.785948800410584e-78, 2.159684710646229e-78, 1.674200921679424e-78,
      1.2978508910745235e-78, 1.0061020237482983e-78, 7.799365005269297e-79,
      6.046115905700386e-79, 4.686986379079076e-79, 3.6333807787179724e-79,
      2.816619212311667e-79, 2.1834606033123933e-79, 1.6926321404676202e-79,
      1.3121388856742722e-79, 1.0171781653767178e-79, 7.885227939018562e-80,
      6.11267738206427e-80, 4.738585246509782e-80, 3.6733805393238865e-80,
      2.8476272736936174e-80, 2.207498243940788e-80, 1.711266267892181e-80,
      1.3265841763016973e-80, 1.0283762438569445e-80, 7.97203613477147e-81,
      6.179971631369466e-81, 4.790752164048765e-81, 3.713820655880904e-81,
      2.8789767017276396e-81, 2.2318005141054816e-81, 1.7301055377671147e-81,
      1.34118849462321e-81, 1.0396976015874718e-81, 8.059799998884024e-82,
      6.248006720687395e-82, 4.8434933853395975e-82, 3.75470597625213e-82,
      2.910671254507144e-82, 2.256370327103688e-82, 1.7491522084984085e-82,
      1.355953591369075e-82, 1.0511435957452098e-82, 8.148530052275419e-83,
      6.316790805899579e-83, 4.896815232871988e-83, 3.796041401670623e-83,
      2.9427147314982573e-83, 2.2812106283050067e-83, 1.768408563354761e-83,
      1.3708812365432838e-83, 1.0627155984481811e-83, 8.238236931689286e-84,
      6.3863321326753475e-84, 4.950724098739712e-84, 3.8378318873269436e-84,
      2.975110973995296e-84, 2.3063243955045085e-84, 1.7878769107412953e-84,
      1.385973219635741e-84, 1.0744149969200078e-84, 8.32893139096879e-85,
      6.456639037460318e-85, 5.0052264454068815e-85, 3.8800824429631703e-85,
      3.0078638655812507e-85, 2.3317146392797046e-85, 1.8075595844762865e-85,
      1.401231349836782e-85, 1.0862431936562082e-85, 8.42062430234578e-86,
      6.527719948475747e-86, 5.060328806482649e-86, 3.922798133473457e-86,
      3.0409773325933388e-86, 2.3573844033514476e-86, 1.8274589440709313e-86,
      1.4166574562540543e-86, 1.0982016065923235e-86, 8.513326657744113e-87,
      6.599583386728872e-87, 5.1160377875044365e-87, 3.965984079511196e-87,
      3.074455344593686e-87, 2.3833367649488054e-87, 1.847577375012202e-87,
      1.4322533881317869e-87, 1.1102916692738973e-87, 8.607049570097352e-88,
      6.672237967034403e-88, 5.172360066729793e-88, 4.009645458102871e-88,
      3.108301914845185e-88, 2.4095748351779505e-88, 1.8679172890488114e-88,
      1.4480210150724723e-88, 1.1225148310283247e-88, 8.701804274680948e-89,
      6.745692399047235e-89, 5.229302395936969e-89, 4.053787503268669e-89,
      3.1425211007926e-89, 2.4361017593951153e-89, 1.888481124480331e-89,
      1.4639622272609921e-89, 1.1348725571385963e-89, 8.797602130459108e-90,
      6.819955488306554e-90, 5.286871601234307e-90, 4.0984155066499195e-90,
      3.177117004548962e-90, 2.462920717583648e-90, 1.9092713464494847e-90,
      1.4800789356912066e-90, 1.147366329018951e-90, 8.894454621446477e-91,
      6.895036137291415e-91, 5.345074583878533e-91, 4.143534818143446e-91,
      3.212093773387317e-91, 2.4900349247352183e-91, 1.9302904472376655e-91,
      1.4963730723950382e-91, 1.1599976443924633e-91, 8.992373358084799e-92,
      6.970943346487943e-92, 5.4039183211020614e-92, 4.189150846542895e-92,
      3.247455600237895e-92, 2.5174476312352292e-92, 1.951540946563705e-92,
      1.5128465906740828e-92, 1.1727680174705904e-92, 9.091370078634778e-93,
      7.0476862154683045e-93, 5.4634098669494186e-93, 4.2352690601871336e-93,
      3.283206724190747e-93, 2.5451621232524597e-93, 1.9730253918859302e-93,
      1.5295014653337629e-93, 1.1856789791346882e-93, 9.191456650583199e-94,
      7.125273943981529e-94, 5.523556353122849e-94, 4.281894987615774e-94,
      3.319351431003914e-94, 2.5731817231330044e-94, 1.9947463587075455e-94,
      1.5463396929200642e-94, 1.1987320771195317e-94, 9.292645072065601e-95,
      7.203715833056362e-95, 5.584364989837263e-95, 4.329034218231931e-95,
      3.3558940536172006e-95, 2.601509789798551e-95, 2.0167064508853816e-95,
      1.5633632919588783e-95, 1.2119288761988543e-95, 9.394947473304572e-96,
      7.2830212861162456e-96, 5.645843066684569e-96, 4.376692402972258e-96,
      3.392838972671588e-96, 2.6301497191490345e-96, 2.0389083009420342e-96,
      1.5805743031979741e-96, 1.2252709583729266e-96, 9.498376118063881e-97,
      7.363199810106571e-97, 5.707997953507532e-97, 4.4248752549843685e-97,
      3.4301906170343806e-97, 2.659104944469733e-97, 2.0613545703814486e-97,
      1.597974789851643e-97, 1.238759923058205e-97, 9.602943405118654e-98,
      7.444261016634367e-98, 5.770837101283261e-98, 4.47358855031172e-98,
      3.467953464330128e-98, 2.6883789368428426e-98, 2.0840479500079736e-98,
      1.615566837848029e-98, 1.2523973872790659e-98, 9.708661869741685e-99,
      7.526214623120497e-99, 5.834368043016407e-99, 4.522838128586027e-99,
      3.506132041477389e-99, 2.71797520556358e-99, 2.1069911602489276e-99,
      1.6333525560791852e-99, 1.2661849858616488e-99, 9.815544185206145e-100,
      7.609070453964567e-100, 5.898598394642201e-100, 4.572629893727301e-100,
      3.5447309252314087e-100, 2.7478972985608677e-100, 2.1301869514807166e-100,
      1.6513340766538826e-100, 1.2801243716298373e-100, 9.923603164304826e-101,
      7.692838441722659e-101, 5.96353585593944e-101, 4.622969814651605e-101,
      3.58375474273277e-101, 2.7781488028226536e-101, 2.1536381043585437e-101,
      1.6695135551532025e-101, 1.2942172156033936e-101, 1.0032851760886094e-101,
      7.777528628298e-102, 6.0291882114535045e-102, 4.67386392598658e-102,
      3.623208172062078e-102, 2.8087333448259064e-102, 2.1773474301497457e-102,
      1.6878931708889413e-102, 1.308465207198278e-102, 1.0143303071406778e-102,
      7.863151166144786e-103, 6.095563331429571e-103, 4.725318328794878e-103,
      3.6630959428007715e-103, 2.8396545909713565e-103, 2.2013177710708046e-103,
      1.706475127164864e-103, 1.322870054429172e-103, 1.0254970336502144e-103,
      7.94971631948522e-104, 6.162669172756063e-104, 4.77733919130553e-104,
      3.703422836598076e-104, 2.870916248023007e-104, 2.2255520006280618e-104,
      1.7252616515408274e-104, 1.3374334841142298e-104, 1.0367866942573137e-104,
      8.037234465539964e-105, 6.230513779918505e-105, 4.829932749653383e-105,
      3.7441936877442274e-105, 2.9025220635524956e-105, 2.2500530239621884e-105,
      1.7442549960998164e-105, 1.3521572420820858e-105, 1.0482006423391117e-105,
      8.125716095772135e-106, 6.299105285963883e-106, 4.883105308626674e-106,
      3.7854133837499924e-106, 2.934475826388344e-106, 2.2748237781964466e-106,
      1.7634574377179171e-106, 1.3670430933811396e-106, 1.0597402461720257e-106,
      8.215171817144998e-107, 6.368451913475604e-107, 4.936863242422827e-107,
      3.8270868659325704e-107, 2.9667813670701534e-107, 2.2998672327887858e-107,
      1.7828712783372664e-107, 1.3820928224911478e-107, 1.07140688909578e-107,
      8.305612353393503e-108, 6.438561975559214e-108, 4.991212995412586e-108,
      3.869219130007948e-108, 2.9994425583077997e-108, 2.3251863898878112e-108,
      1.802498845241998e-108, 1.3973082335371394e-108, 1.0832019696792362e-108,
      8.397048546309814e-109, 6.509443876838932e-109, 5.046161082912537e-109,
      3.91181522668977e-109, 3.0324633154456846e-109, 2.3507842846926773e-109,
      1.8223424913372355e-109, 1.4126911505056936e-109, 1.0951269018880517e-109,
      8.489491357043004e-110, 6.581106114465198e-110, 5.101714091966161e-110,
      3.954880262294811e-110, 3.0658475969320984e-110, 2.3766639858169377e-110,
      1.842404595431152e-110, 1.428243417463593e-110, 1.1071831152541818e-110,
      8.582951867413052e-111, 6.653557279133278e-111, 5.157878682133469e-111,
      3.998419399355108e-111, 3.099599404793749e-111, 2.402828595656405e-111,
      1.862687562520136e-111, 1.443966898778886e-111, 1.119372055047248e-111,
      8.677441281239296e-112, 6.726806056113095e-112, 5.214661586289329e-112,
      4.042437857236828e-112, 3.133722785115514e-112, 2.429281250761058e-112,
      1.8831938240770953e-112, 1.4598634793443833e-112, 1.1316951824477948e-112,
      8.772970925683533e-113, 6.800861226290409e-113, 5.272069611430594e-113,
      4.0869409127659583e-113, 3.168221828525478e-113, 2.4560251222110427e-113,
      1.9039258383429382e-113, 1.4759350648036143e-113, 1.1441539747224519e-113,
      8.869552252607877e-114, 6.875731667219435e-114, 5.3301096394921044e-114,
      4.131933900860875e-114, 3.2031006706853048e-114, 2.483063415996815e-114,
      1.92488609062126e-114
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_2_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<2>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.0073195094892681825), "design.b()[0] == 0.0073195094892681825");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.0073195094892681825));
    static_assert(almost_equal(design.b()[1], 0.014639018978536365), "design.b()[1] == 0.014639018978536365");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.014639018978536365));
    static_assert(almost_equal(design.b()[2], 0.0073195094892681825), "design.b()[2] == 0.0073195094892681825");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.0073195094892681825));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.8095365005288773), "design.a()[1] == -1.8095365005288773");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.8095365005288773));
    static_assert(almost_equal(design.a()[2], 0.8508928283761326), "design.a()[2] == 0.8508928283761326");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.8508928283761326));
    std::cout << "max_deviation(cheby1,lowpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.0073195094892681825, 0.027883938565334623, 0.05154839597009665, 0.06955246069948168,
      0.08199555589206398, 0.08919226126274366, 0.0916272218523709, 0.0899097469288034,
      0.0847300228627726, 0.0768185101980015, 0.06690972931745455, 0.05571127802642285,
      0.04387858225511421, 0.03199556924973583, 0.020561179452407423, 0.009981404298643453,
      0.0005663552659229965, -0.007468264808884014, -0.01399600540137788,
      -0.018971589669099335, -0.022420683357345757, -0.024428255309586127,
      -0.025126220950876833, -0.024680986678297004, -0.023281425052150168,
      -0.021127713854383365, -0.01842137178098535, -0.015356724428827784,
      -0.01211394024523645, -0.00885369035514297, -0.005713410983962981,
      -0.0028050840901495356, -0.00021440161635889743, 0.0019988583847264144,
      0.003799440004302677, 0.005174411104852081, 0.006130369511465266,
      0.006690258092537323, 0.0068899787638035, 0.006774975430045873, 0.006396931813070084,
      0.005810703601294148, 0.00507157685694389, 0.004232917415716933,
      0.0033442501913322348, 0.0024497837159743892, 0.0015873745483568182,
      0.0007879087902669638, 7.506409593200356e-05, -0.0005345947175845122,
      -0.0010312401553561816, -0.0014111838906476551, -0.00167611390655922,
      -0.0018322230408909384, -0.0018892811669694233, -0.0018596977859133546,
      -0.0017576152278025799, -0.0015980653996135001, -0.001396215478450997,
      -0.0011667204830533035, -0.0009231935625179319, -0.0006777983566798925,
      -0.0004409620848612355, -0.00022120322712166946, -2.506383791722733e-05,
      0.00014286631001692284, 0.00027984844260684676, 0.00038483205290328895,
      0.0004582466134555656, 0.0005017631393469202, 0.0005180399582512189,
      0.0005104655563742479, 0.0004829095712337495, 0.00043949101455033974,
      0.00038437074156631707, 0.00032157313418296825, 0.00025484001645715643,
      0.0001875180378998809, 0.00012247919170074183, 6.207281429759342e-05,
      8.106357318579313e-06, -3.814856306864704e-05, -7.592885862207824e-05,
      -0.00010493570239218097, -0.00012527766241897522, -0.00013740546624195152,
      -0.0001420423420289676, -0.00014011347671706855, -0.00013267764017734033,
      -0.00012086348020753414, -0.00010581242650371461, -8.862957944682934e-05,
      -7.03434241704743e-05, -5.187472007535873e-05, -3.401448428100285e-05,
      -1.7410623566998273e-05, -2.5624781058336372e-06, 1.0177677066403246e-05,
      2.0597272385377037e-05, 2.8611403767344484e-05, 3.4247308091552195e-05,
      3.762651576111438e-05, 3.894576481117191e-05, 3.845765054891496e-05,
      3.64518504193963e-05, 3.323761479744929e-05, 2.9128059063599392e-05,
      2.4426638001666068e-05, 1.941603648748737e-05, 1.4349575622751326e-05,
      9.445114653775601e-06, 4.88132873004704e-06, 7.961621860124115e-07,
      -2.712803073413081e-06, -5.586364874390115e-06, -7.800426465517409e-06,
      -9.361758600734327e-06, -1.0303116959384766e-05, -1.0678012952871418e-05,
      -1.0555405860679967e-05, -1.0014547539891092e-05, -9.14017016226262e-06,
      -8.018164848533992e-06, -6.731856719473079e-06, -5.358941483861951e-06,
      -3.969111614991262e-06, -2.6223674656943245e-06, -1.3679810387528144e-06,
      -2.4405795172843177e-07, 7.2237348333239e-07, 1.5148283459380391e-06,
      2.1264747676340503e-06, 2.5589771337079204e-06, 2.8211603979606307e-06,
      2.9275774229057533e-06, 2.897053054548769e-06, 2.7512686125082883e-06,
      2.513439309552471e-06, 2.2071254411796407e-06, 1.855206564003606e-06,
      1.4790367843590238e-06, 1.0977890864555169e-06, 7.279876291079194e-07,
      3.8321932606967323e-07, 7.400990547667879e-08, -1.9215495088707732e-07,
      -4.106858951864016e-07, -5.796478479453884e-07, -6.994442553808517e-07,
      -7.724517133965028e-07, -8.026274695345921e-07, -7.951100792540338e-07,
      -7.558307526639154e-07, -6.911498709607331e-07, -6.0752995193141e-07,
      -5.112531546508636e-07, -4.0818836522913925e-07, -3.036101031962463e-07,
      -2.020690110628948e-07, -1.0731159171185816e-07, -2.2245169781984896e-08,
      5.105721710828406e-08, 1.1131815340636787e-07, 1.5799004188601355e-07,
      1.9116892911127516e-07, 2.1149456139821613e-07, 2.2004285772428847e-07,
      2.1821637719848485e-07, 2.0763760998084902e-07, 1.9004908375051362e-07,
      1.67223400704759e-07, 1.408854449150608e-07, 1.1264816257070523e-07,
      8.396254718839611e-08, 5.6081780153619267e-08, 3.003889894781119e-08,
      6.636899546481278e-09, -1.3550171707306469e-08, -3.016682051955848e-08,
      -4.305821890603233e-08, -5.224668752322581e-08, -5.7904358435211274e-08,
      -6.032371840830037e-08, -5.988756698320298e-08, -5.7039719009369785e-08,
      -5.2257552272462805e-08, -4.602726042765471e-08, -3.8822431306060106e-08,
      -3.1086340679898776e-08, -2.3218139749700912e-08, -1.5562927006481117e-08,
      -8.405535872038879e-09, -1.96774098860316e-09, 3.5915110497120076e-09,
      8.17330703181085e-09, 1.1733906408857487e-08, 1.4278323603133275e-08,
      1.5852850914099082e-08, 1.6536989211365102e-08, 1.6435208434694478e-08,
      1.5668904033495688e-08, 1.4368852781946143e-08, 1.2668405509042108e-08,
      1.069758838796239e-08, 8.5782212610472e-09, 6.420103241240772e-09,
      4.318264200940204e-09, 2.3512368851223288e-09, 5.802689254052662e-10,
      -9.50632802720529e-10, -2.2139514222797304e-09, -3.1973392747589925e-09,
      -3.901866734659964e-09, -4.339977217788857e-09, -4.5332767652511406e-09,
      -4.510274283789078e-09, -4.304173255316729e-09, -3.950798568010396e-09,
      -3.486724060014674e-09, -2.9476482859900516e-09, -2.367048667027383e-09,
      -1.77512817439014e-09, -1.1980544894852645e-09, -6.574794953090893e-10,
      -1.703171720042614e-10, 2.512494479542971e-10, 5.995667070187613e-10,
      8.711514874545782e-10, 1.0662134029037258e-09, 1.1880955168030929e-09,
      1.2426688657206245e-09, 1.2377127159187016e-09, 1.1823083107356369e-09,
      1.0862691695896039e-09, 9.59626049237128e-10, 8.12179716863014e-10,
      6.531299194340389e-10, 4.907845323720819e-10, 3.323489607779736e-10,
      1.8379253656724506e-10, 4.978595619898001e-11, -6.629824631834067e-11,
      -1.6233160971765204e-10, -2.3733227064750915e-10, -2.9133460396256264e-10,
      -3.252362727011931e-10, -3.4063238157922727e-10, -3.396455157604627e-10,
      -3.2475930741106654e-10, -2.986618870961128e-10, -2.6410422039277423e-10,
      -2.2377696890508343e-10, -1.8020820613538295e-10, -1.356831086997231e-10,
      -9.218566748225106e-11, -5.1361546010377683e-11, -1.4500468889657474e-11,
      1.7464043423922495e-11, 4.394016900870983e-11, 6.465131035680319e-11,
      7.96005312105096e-11, 8.902873035918178e-11, 9.336921603872969e-11,
      9.32010962657874e-11, 8.920358926379109e-11, 8.211300634166382e-11,
      7.268378777342984e-11, 6.16545987601902e-11, 4.972013312640234e-11,
      3.7508939781926165e-11, 2.5567290928372733e-11, 1.4348858294098116e-11,
      4.2097583321285515e-12, -4.591629257441292e-12, -1.1890773912241176e-11,
      -1.760980500801814e-11, -2.1747810683437016e-11, -2.436940044784641e-11,
      -2.5592263462964452e-11, -2.5574386794487117e-11, -2.4501512940719168e-11,
      -2.257531967086561e-11, -2.0002703309915936e-11, -1.6986444142304492e-11,
      -1.3717433895151918e-11, -1.036855382657075e-11, -7.090210481769689e-12,
      -4.007466571533732e-12, -1.2186477852244942e-12, 1.2047369170227419e-12,
      3.2169540856512605e-12, 4.796093835736833e-12, 5.9414236950313915e-12,
      6.670261192219008e-12, 7.0145662829353265e-12, 7.01743631249586e-12,
      6.729663003279333e-12, 6.206484608803758e-12, 5.504638452722519e-12,
      4.679790959358237e-12, 3.784395173578698e-12, 2.8660006333985858e-12,
      1.9660180437342594e-12, 1.1189220257552109e-12, 3.5185959297821145e-13,
      -3.153799506718954e-13, -8.700863365362967e-13, -1.3060984463335472e-12,
      -1.6230825880978134e-12, -1.825677385397446e-12, -1.9225605329922027e-12,
      -1.925487664762468e-12, -1.8483472410637363e-12, -1.7062681532835874e-12,
      -1.5148090912867088e-12, -1.2892510071006874e-12, -1.0440065635574817e-12,
      -7.921535476303033e-13, -5.450930607518021e-13, -3.1232801696405456e-13,
      -1.0135317064295515e-13, 8.235540801289388e-14, 2.3526580284855276e-13,
      3.556464315245252e-13, 4.433692147204857e-13, 4.996757792257622e-13,
      5.269218758108066e-13, 5.283138301503419e-13, 5.076491141493428e-13,
      4.69071152307534e-13, 4.168463808844506e-13, 3.55169461827167e-13,
      2.8800050902033165e-13, 2.189362853162393e-13, 1.5111563187586363e-13,
      8.715793663296152e-14, 2.913226022942675e-14, -2.1446174988994898e-14,
      -6.359606774292221e-14, -9.683100937668954e-14, -1.211058078947985e-13,
      -1.3675256836862896e-13, -1.4441070059172321e-13, -1.4495465410078718e-13,
      -1.3942270804264208e-13, -1.2894960359163916e-13, -1.147052320415372e-13,
      -9.784101126272513e-14, -7.944502180719392e-14, -6.05064519409088e-14,
      -4.188943399864403e-14, -2.431595378003727e-14, -8.357186935969022e-15,
      5.567635884180188e-15, 1.7185910783293164e-14, 2.636107141234328e-14,
      3.3077952679067294e-14, 3.742531612246525e-14, 3.9576682855449296e-14,
      3.9770519108475605e-14, 3.8290690359149345e-14, 3.54479523451321e-14,
      3.1563089817353443e-14, 2.695215466288058e-14, 2.191410086340421e-14,
      1.6720970276671877e-14, 1.1610654774914342e-14, 6.782149918336821e-15,
      2.3931249485637087e-15, -1.4404357817322511e-15, -4.642813979853216e-15,
      -7.175684885297797e-15, -9.034126597298182e-15, -1.0241843020622899e-14,
      -1.084591524622097e-14, -1.091136874407732e-14, -1.0515808512953064e-14,
      -9.744333924657983e-15, -8.68490186176198e-15, -7.424263068575772e-15,
      -6.044554302792597e-15, -4.620589439303179e-15, -3.2178573374010475e-15,
      -1.8912038887482913e-15, -6.841507355001186e-16, 3.7121609818183206e-16,
      1.2538680336092437e-15, 1.9530548579416043e-15, 2.467216735452385e-15,
      2.802678365469112e-15, 2.972211775312962e-15, 2.9935467733079297e-15,
      2.887898468312251e-15, 2.678570207416226e-15, 2.3896784637835545e-15,
      2.0450342249516796e-15, 1.6672038079225266e-15, 1.2767611884614203e-15,
      8.917342093769117e-16, 5.272386618269716e-16, 1.9528735948943152e-16,
      -9.52439911031684e-17, -3.385160920192998e-16, -5.31514795549709e-16,
      -6.73754508129205e-16, -7.669212471466228e-16, -8.144791106897127e-16,
      -8.212618905849938e-16, -7.930689333588527e-16, -7.362813294309524e-16,
      -6.575112724602784e-16, -5.632941441460192e-16, -4.598296880534804e-16,
      -3.527756570394609e-16, -2.4709464407182087e-16, -1.469525009325958e-16,
      -5.566485371067049e-17, 2.4313244569424128e-17, 9.136052830967453e-17,
      1.4463224524527992e-16, 1.839793085894215e-16, 2.0985073400347754e-16,
      2.2318588859373083e-16, 2.253025272203011e-16, 2.1778587466737573e-16,
      2.0238318488345112e-16, 1.8090732126379565e-16, 1.5515200043849267e-16,
      1.2682046565942411e-16, 9.746853714347298e-17, 6.846225089334342e-17,
      4.0949662652176807e-17, 1.5845870953824693e-17, -6.170092401543089e-18,
      -2.4648145366211196e-17, -3.935163133560979e-17, -5.0235283132260333e-17,
      -5.741855755385585e-17, -6.115613355273542e-17, -6.180721705661535e-17,
      -5.980509980882094e-17, -5.56281932864731e-17, -4.9773515682703975e-17,
      -4.2733362664518056e-17, -3.49756519943036e-17, -2.6928207089853192e-17,
      -1.896704217315754e-17, -1.1408536825615719e-17, -4.505243642932086e-18,
      1.5550393515201257e-18, 6.647379972192497e-18, 1.070550486051581e-17,
      1.3715793855862934e-17, 1.5709992305954955e-17, 1.6757133873214125e-17,
      1.6955125600848504e-17, 1.642239360893032e-17, 1.528992588343301e-17,
      1.369398202984443e-17, 1.1769672039974269e-17, 9.645540054481351e-18,
      7.43922726474411e-18, 5.254232413111156e-18, 3.1777402055556024e-18,
      1.2794482122132971e-18, -3.887081108133818e-19, -1.7920548226193965e-18,
      -2.9120396686558588e-18, -3.744595474797087e-18, -4.2981485213545114e-18,
      -4.59140719941065e-18, -4.651055164008608e-18, -4.509458627113835e-18,
      -4.202480499950623e-18, -3.7674758517514535e-18, -3.2415245498068468e-18,
      -2.659938806900352e-18, -2.055066367823603e-18, -1.4553947488752367e-18,
      -8.84948686549709e-19, -3.6296199513256545e-19, 9.620351236886362e-20,
      4.829255257419327e-19, 7.920124871278643e-19, 1.0222576378389443e-18,
      1.1758947633325562e-18, 1.2579928022411425e-18, 1.2758234720132312e-18,
      1.2382320872636418e-18, 1.1550371154196217e-18, 1.0364790168995488e-18,
      8.92733815093209e-19, 7.335018614253889e-19, 5.676775905434397e-19,
      4.031018471332335e-19, 2.463947151949423e-19, 1.0286375985182483e-19,
      -2.351976807564218e-20, -1.3008591437457086e-19, -2.1538240828482626e-19,
      -2.7905315774913233e-19, -3.2168952796695894e-19, -3.4466461202966693e-19,
      -3.499598835975179e-19, -3.3999253651946013e-19, -3.174505495668862e-19,
      -2.851411455284131e-19, -2.458569146457546e-19, -2.0226250515382376e-19,
      -1.5680350028549875e-19, -1.1163794209252104e-19, -6.858995720314022e-20,
      -2.9124106827599684e-20, 5.661568332933958e-21, 3.502630818114735e-20,
      5.856399524070445e-20, 7.617005256902362e-20, 8.800080681948224e-20,
      9.442812054782845e-20, 9.599187539362559e-20, 9.335259170780113e-20,
      8.724612375942418e-20, 7.844199467784455e-20, 6.77065515333411e-20,
      5.577174560962347e-20, 4.330999024502584e-20, 3.09152298206772e-20,
      1.9090076686221457e-20, 8.2386432195989e-21, -1.3354837247572879e-21,
      -9.426808976916927e-21, -1.592180140343544e-20, -2.078987664075798e-20,
      -2.4072293993931985e-20, -2.5869737697036545e-20, -2.632929229989691e-20,
      -2.5631441171377287e-20, -2.397762236656463e-20, -2.1578773394526625e-20,
      -1.8645191180816358e-20, -1.537793047446992e-20, -1.1961867036690127e-20,
      -8.560464261370751e-21, -5.31220566691486e-21, -2.3285924050282276e-21,
      3.0644475308400396e-22, 2.5359055437507137e-21, 4.3280620006177725e-21,
      5.674002326053136e-21, 6.584597395985982e-21, 7.087101441895922e-21,
      7.221582040072878e-21, 7.037352502192278e-21, 6.5895538523772595e-21,
      5.936005443207087e-21, 5.1344144016351925e-21, 4.24000580777342e-21,
      3.3036088793579125e-21, 2.3702103165618892e-21, 1.4779649785434833e-21,
      6.5763661507217735e-22, -6.757234177637046e-23, -6.8185289831302555e-22,
      -1.1763408864747301e-21, -1.5484480299584866e-21, -1.801033205354944e-21,
      -1.941471999949465e-21, -1.980678210559555e-21, -1.9321249165596693e-21,
      -1.8109056754100356e-21, -1.6328686836419026e-21, -1.413848831548527e-21,
      -1.169014814326293e-21, -9.123411450097989e-22, -6.562082810538417e-22,
      -4.1112829919493156e-22, -1.8558874352384225e-22, 1.3996515833759326e-23,
      1.8324333717319267e-22, 3.196759721484134e-22, 4.225448984962276e-22,
      4.926004248359401e-22, 5.318380251193043e-22, 5.432301500746375e-22,
      5.304576233160949e-22, 4.976517925180725e-22, 4.491564956779627e-22,
      3.8931673209675947e-22, 3.222987960047747e-22, 2.519446201391858e-22,
      1.8166125213901464e-22, 1.1434479605294445e-22, 5.233682546441736e-23,
      -2.5897709239095285e-24, -4.9219314462468767e-23, -8.686052854455443e-23,
      -1.1529693516289735e-22, -1.347250117688524e-22, -1.4568449106606368e-22,
      -1.4898485782800878e-22, -1.4563164961214698e-22, -1.3675563854292169e-22,
      -1.2354739335698889e-22, -1.0719912574849966e-22, -8.885513989466825e-23,
      -6.957165159141225e-23, -5.0286241656007205e-23, -3.17967703535451e-23,
      -1.4749214162588688e-23, 3.6640247803265793e-25, 1.3213019213014724e-23,
      2.3597671307282252e-23, 3.145798426845994e-23, 3.6845281485097776e-23,
      3.99055085103435e-23, 4.085908844646272e-23, 3.998070091805801e-23,
      3.7579832294873144e-23, 3.398278653670021e-23, 2.951668283655501e-23,
      2.4495805614965327e-23, 1.921052062706244e-23, 1.3918832945762583e-23,
      8.840542029182073e-24, 4.153848353349767e-24, -5.81359854063238e-27,
      -3.54499969278602e-24, -6.4098595891546765e-24, -8.582460074653203e-24,
      -1.0076171214107066e-23, -1.0930445870158211e-23, -1.1205298945532678e-23,
      -1.0975759439407981e-23, -1.0326528814068715e-23, -9.347035819846626e-24,
      -8.12703317785277e-24, -6.752837430651463e-24, -5.304271565891651e-24,
      -3.8523320662671666e-24, -2.4575688508916227e-24, -1.1691388105410606e-24,
      -2.447164139471012e-26, 9.50529500934009e-25, 1.740840570930938e-24,
      2.34131581919637e-24, 2.7554276769501536e-24, 2.993838116491014e-24,
      3.0728856990391216e-24, 3.0130634517231727e-24, 2.837551890570642e-24,
      2.570859635618816e-24, 2.2376117945569206e-24, 1.861514189554943e-24,
      1.4645100435737691e-24, 1.0661353054251621e-24, 6.830696565075962e-25,
      3.2887259038934986e-25, 1.38878843293492e-26, -2.547046950026988e-25,
      -4.727145436406191e-25, -6.386678227170246e-25, -7.534633218668629e-25,
      -8.199815126633107e-25, -8.426699399021711e-25, -8.2712562562523005e-25,
      -7.79692201540733e-25, -7.07086234855044e-25, -6.160638483599282e-25,
      -5.131354139819387e-25, -4.0433295092304997e-25, -2.9503198931876064e-25,
      -1.8982714527936128e-25, -9.245854432132501e-26, -5.784554185881823e-27,
      6.820495034647199e-26, 1.2834138284082073e-25, 1.7420331366925243e-25,
      2.0602249235446339e-25, 2.2457686956480823e-25, 2.310769814234437e-25,
      2.2705138458589722e-25, 2.1423602160778765e-25, 1.9447150601037387e-25,
      1.6961139407269176e-25, 1.4144359869238994e-25, 1.1162623577270667e-25,
      8.163840430028869e-26, 5.274570894868663e-26, 2.5979752849734226e-26,
      2.130365584260946e-27, -1.8251011098632537e-26, -3.483858355200019e-26,
      -4.7512034109629697e-26, -5.633085904056833e-26, -6.150509645460938e-26,
      -6.336419302927851e-26, -6.232557463122749e-26, -5.886426478718874e-26,
      -5.348465123108183e-26, -4.669524786564671e-26, -3.8987049253404653e-26,
      -3.081583714382814e-26, -2.25885814968415e-26, -1.4653887887615705e-26,
      -7.29628300844639e-27, -7.340023105723114e-28, 4.880150913236536e-27,
      9.455368507668336e-27, 1.295734902711091e-26, 1.5401290761821005e-26,
      1.6843882426838177e-26, 1.737477220501153e-26, 1.7107945734335596e-26,
      1.6173383191434296e-26, 1.4709298888346374e-26, 1.2855197467481074e-26,
      1.0745912104378439e-26, 8.506724851909195e-27, 6.249609575509909e-27,
      4.070585471481412e-27, 2.0481250212159775e-27, 2.4252499856118066e-28,
      -1.3038770549832198e-27, -2.5657759051718747e-27, -3.533405517416613e-27,
      -4.210625938004457e-27, -4.6127319103782524e-27, -4.764115345361227e-27,
      -4.6959001083982854e-27, -4.443651068059659e-27, -4.0452410782612785e-27,
      -3.538940558934671e-27, -2.9617754920492984e-27, -2.348181717588147e-27,
      -1.728967002405405e-27, -1.1305779158428756e-27, -5.746563825638101e-28,
      -7.786105899996289e-29, 3.480785664738519e-28, 6.961122877990415e-28,
      9.634630373149827e-28, 1.1511045794991702e-27, 1.263161963672888e-27,
      1.3062710479390549e-27, 1.2889296848630533e-27, 1.2208686447681607e-27,
      1.1124653499281297e-27, 9.742182820460648e-28, 8.162947527741003e-28,
      6.4815980086901755e-28, 4.78289466871466e-28, 3.139677219212656e-28,
      1.6116297555565646e-28, 2.447740387740682e-29, -9.283966434571132e-29,
      -1.8882440874696565e-28, -2.6268805523780545e-28, -3.1467428898059838e-28,
      -3.458952293864426e-28, -3.5815594716562674e-28, -3.5377648922325232e-28,
      -3.354191433949432e-28, -3.059273054211276e-28, -2.681808820531535e-28,
      -2.2497174463193872e-28, -1.7890139425254083e-28, -1.3230175880089635e-28,
      -8.717894827841153e-29, -4.517887124227321e-29, -7.572874690113636e-30,
      2.4738984368487035e-29, 5.120979996479944e-29, 7.161577784063214e-29,
      8.601731248376681e-29, 9.471411485360205e-29, 9.819713363425126e-29,
      9.709973648356622e-29, 9.215028058227147e-29, 8.412782683651885e-29,
      7.382236049055051e-29, 6.200049134078899e-29, 4.9377235016675273e-29,
      3.6594135620192653e-29, 2.420368894931071e-29, 1.2659771041379655e-29,
      2.3135724404998307e-30, -6.585614610291675e-30, -1.3885512213289017e-29,
      -1.952268893613973e-29, -2.3511935457799288e-29, -2.593398940258758e-29,
      -2.69223631660274e-29, -2.6649953235576375e-29, -2.5316017376252645e-29,
      -2.313400340564121e-29, -2.0320605937368194e-29, -1.7086320567042433e-29,
      -1.362766286543649e-29, -1.0121125738077258e-29, -6.718865849765425e-30,
      -3.546039691684479e-30, -6.9965348804051995e-31, 1.7512512184597703e-30,
      3.76428313672065e-30, 5.3214806317489685e-30, 6.426411914994414e-30,
      7.100817221718383e-30, 7.38100013562379e-30, 7.314154706249937e-30,
      6.954789829828782e-30, 6.361384265400589e-30, 5.59337623306787e-30,
      4.708562204952895e-30, 3.760951451746037e-30, 2.7990971164941977e-30,
      1.8649017826598743e-30, 9.928761832711892e-31, 2.0981414164386376e-31,
      -4.65164876179214e-31, -1.0202621706269412e-30, -1.4503961807049065e-30,
      -1.7564110651632753e-30, -1.9441582238798126e-30, -2.0235076898859983e-30,
      -2.00734073402177e-30, -1.9105681457228698e-30, -1.749210961746902e-30,
      -1.5395723490867657e-30, -1.2975212982101324e-30, -1.037901078720724e-30,
      -7.740683185711547e-31, -5.1756229191020355e-31, -2.7789867756352803e-31,
      -6.247775807560263e-32, 1.2340620804500146e-31, 2.7646991412883983e-31,
      3.952769435116353e-31, 4.800217899078002e-31, 5.322786334308807e-31,
      5.54730517147987e-31, 5.50893046852358e-31, 5.248448574443013e-31,
      4.809749838913902e-31, 4.2375506398330976e-31, 3.57542091140239e-31,
      2.8641531946221753e-31, 2.140489736836866e-31, 1.4362068951391615e-31,
      7.775414327783579e-32, 1.8493145614769424e-32, -3.269642089211994e-32,
      -7.490105201866881e-32, -1.0771503750512095e-31, -1.3118152402084037e-31,
      -1.4572380298934278e-31, -1.5207112250031047e-31, -1.511829079533818e-31,
      -1.4417476265911937e-31, -1.3224904333618278e-31, -1.1663219949737233e-31,
      -9.852045959309872e-32, -7.903486557254404e-32, -5.918612155182334e-32,
      -3.984924696541374e-32, -2.1747620534661234e-32, -5.445674698060925e-33,
      8.650747211040942e-33, 2.0287528381476372e-32, 2.935016434982746e-32,
      3.5847681282258703e-32, 3.9893843382643926e-32, 4.168683083028934e-32,
      4.1488456748128736e-32, 3.96038514451303e-32, 3.63623844441105e-32,
      3.210042872714629e-32, 2.714640531824747e-32, 2.1808386689792067e-32,
      1.6364390131338405e-32, 1.1055361418753813e-32, 6.080737810268731e-33,
      1.5963892715035023e-33, -2.28533153815496e-33, -5.4937470165201314e-33,
      -7.996563534786947e-33, -9.795483657725448e-33, -1.0921066655584004e-32,
      -1.1427161943153897e-32, -1.1385209338137324e-32, -1.0878661717399387e-32,
      -9.99774247915833e-33, -8.834704701259946e-33, -7.479713252856703e-33,
      -6.017427273410795e-33, -4.524319925349111e-33, -3.06673633276911e-33,
      -1.69965995388498e-33, -4.661327729683428e-34, 6.027441986598809e-34,
      1.4873166615469262e-33, 2.1784830709289056e-33, 2.6764975517954826e-33,
      2.9895643917578855e-33, 3.132313315578253e-33, 3.1242363747160374e-33,
      2.9881568198760828e-33, 2.748788509472342e-33, 2.4314319320287806e-33,
      2.060840400124792e-33, 1.6602779321423337e-33, 1.2507792023401743e-33,
      8.506120351658725e-34, 4.749344722685253e-34, 1.3563158247624879e-34,
      -1.5868803728662637e-34, -4.025597364977839e-34, -5.934200239597521e-34,
      -7.312800007209424e-34, -8.183410108091831e-34, -8.585770207905705e-34,
      -8.57305960372269e-34, -8.207693978153418e-34, -7.557366904590909e-34,
      -6.6914633182294746e-34, -5.677937815762776e-34, -4.580717576532532e-34,
      -3.457659085951609e-34, -2.359060587726722e-34, -1.3267089212448112e-34,
      -3.9342048276832584e-35, 4.1697838280486723e-35, 1.0892962709407544e-34,
      1.6163174466407493e-34, 1.9979110312177192e-34, 2.2399800120719162e-34,
      2.353317424102527e-34, 2.352430848266242e-34, 2.25438856584644e-34,
      2.0777318582335545e-34, 1.8414885727334173e-34, 1.5643136502083978e-34,
      1.2637732282521936e-34, 9.557805186203407e-35, 6.541841583243819e-35,
      3.705033237600625e-35, 1.1379867915560809e-35, -1.0933575743291001e-35,
      -2.946775238600056e-35, -4.401967234254136e-35, -5.458130467153856e-35,
      -6.131083954590073e-35, -6.450136132795183e-35, -6.45486139854039e-35,
      -6.19193272906853e-35, -5.712133009888936e-35, -5.067642024318041e-35,
      -4.309670201772475e-35, -3.486485280079217e-35, -2.64185490550547e-35,
      -1.8139075595550574e-35, -1.0343965448952249e-35, -3.28337370246216e-36,
      2.8602214580020507e-36, 7.969474264154476e-36, 1.198731264483157e-35,
      1.491031127677688e-35, 1.6780834128585377e-35, 1.767845493073071e-35,
      1.771111805592918e-35, 1.700644407005046e-35, 1.5703517952646015e-35,
      1.3945427626637724e-35, 1.1872749499702413e-35, 9.618109225203051e-36,
      7.301882306675342e-36, 5.029042394231429e-36, 2.887116486672286e-36,
      9.451665570611368e-37, -7.463133291146076e-37, -2.1547166548883852e-36,
      -3.264005775852881e-36, -4.072904640515728e-36, -4.5927505037351654e-36,
      -4.8451443250564654e-36, -4.859527040370903e-36, -4.6707929962203523e-36,
      -4.3170337051238714e-36, -3.8374858001216977e-36, -3.27073760603353e-36,
      -2.6532299354513138e-36, -2.0180692400209782e-36, -1.3941556263041395e-36,
      -8.056148497147152e-37, -2.7151245186443526e-37, 1.9418020605878157e-37,
      5.824041686498518e-37, 8.88655056484066e-37, 1.1124902307669459e-36,
      1.2569414645921037e-36, 1.327871500209534e-36, 1.3333094697311771e-36,
      1.2827958154460187e-36, 1.1867623849750333e-36, 1.0559680934330956e-36,
      9.010052060992636e-37, 7.318861299069225e-37, 5.5771579809797315e-37,
      3.864504344541134e-37, 2.2473979391632423e-37, 7.784695701308064e-38,
      -5.036256872385839e-38, -1.573723237995512e-37, -2.41917815542606e-37,
      -3.0385213564663302e-37, -3.4398539591461054e-37, -3.6390852644787286e-37,
      -3.6581105501123752e-37, -3.5230130100039017e-37, -3.262360600942478e-37,
      -2.905654080804604e-37, -2.4819678782078098e-37, -2.0188112496587617e-37,
      -1.5412239761088933e-37, -1.0711090260795904e-37
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.0073195094892681825, 0.027883938565334623, 0.05154839597009665, 0.06955246069948168,
      0.08199555589206398, 0.08919226126274366, 0.0916272218523709, 0.0899097469288034,
      0.0847300228627726, 0.0768185101980015, 0.06690972931745455, 0.05571127802642285,
      0.04387858225511421, 0.03199556924973583, 0.020561179452407423, 0.009981404298643453,
      0.0005663552659229965, -0.007468264808884014, -0.01399600540137788,
      -0.018971589669099335, -0.022420683357345757, -0.024428255309586127,
      -0.025126220950876833, -0.024680986678297004, -0.023281425052150168,
      -0.021127713854383365, -0.01842137178098535, -0.015356724428827784,
      -0.01211394024523645, -0.00885369035514297, -0.005713410983962981,
      -0.0028050840901495356, -0.00021440161635889743, 0.0019988583847264144,
      0.003799440004302677, 0.005174411104852081, 0.006130369511465266,
      0.006690258092537323, 0.0068899787638035, 0.006774975430045873, 0.006396931813070084,
      0.005810703601294148, 0.00507157685694389, 0.004232917415716933,
      0.0033442501913322348, 0.0024497837159743892, 0.0015873745483568182,
      0.0007879087902669638, 7.506409593200356e-05, -0.0005345947175845122,
      -0.0010312401553561816, -0.0014111838906476551, -0.00167611390655922,
      -0.0018322230408909384, -0.0018892811669694233, -0.0018596977859133546,
      -0.0017576152278025799, -0.0015980653996135001, -0.001396215478450997,
      -0.0011667204830533035, -0.0009231935625179319, -0.0006777983566798925,
      -0.0004409620848612355, -0.00022120322712166946, -2.506383791722733e-05,
      0.00014286631001692284, 0.00027984844260684676, 0.00038483205290328895,
      0.0004582466134555656, 0.0005017631393469202, 0.0005180399582512189,
      0.0005104655563742479, 0.0004829095712337495, 0.00043949101455033974,
      0.00038437074156631707, 0.00032157313418296825, 0.00025484001645715643,
      0.0001875180378998809, 0.00012247919170074183, 6.207281429759342e-05,
      8.106357318579313e-06, -3.814856306864704e-05, -7.592885862207824e-05,
      -0.00010493570239218097, -0.00012527766241897522, -0.00013740546624195152,
      -0.0001420423420289676, -0.00014011347671706855, -0.00013267764017734033,
      -0.00012086348020753414, -0.00010581242650371461, -8.862957944682934e-05,
      -7.03434241704743e-05, -5.187472007535873e-05, -3.401448428100285e-05,
      -1.7410623566998273e-05, -2.5624781058336372e-06, 1.0177677066403246e-05,
      2.0597272385377037e-05, 2.8611403767344484e-05, 3.4247308091552195e-05,
      3.762651576111438e-05, 3.894576481117191e-05, 3.845765054891496e-05,
      3.64518504193963e-05, 3.323761479744929e-05, 2.9128059063599392e-05,
      2.4426638001666068e-05, 1.941603648748737e-05, 1.4349575622751326e-05,
      9.445114653775601e-06, 4.88132873004704e-06, 7.961621860124115e-07,
      -2.712803073413081e-06, -5.586364874390115e-06, -7.800426465517409e-06,
      -9.361758600734327e-06, -1.0303116959384766e-05, -1.0678012952871418e-05,
      -1.0555405860679967e-05, -1.0014547539891092e-05, -9.14017016226262e-06,
      -8.018164848533992e-06, -6.731856719473079e-06, -5.358941483861951e-06,
      -3.969111614991262e-06, -2.6223674656943245e-06, -1.3679810387528144e-06,
      -2.4405795172843177e-07, 7.2237348333239e-07, 1.5148283459380391e-06,
      2.1264747676340503e-06, 2.5589771337079204e-06, 2.8211603979606307e-06,
      2.9275774229057533e-06, 2.897053054548769e-06, 2.7512686125082883e-06,
      2.513439309552471e-06, 2.2071254411796407e-06, 1.855206564003606e-06,
      1.4790367843590238e-06, 1.0977890864555169e-06, 7.279876291079194e-07,
      3.8321932606967323e-07, 7.400990547667879e-08, -1.9215495088707732e-07,
      -4.106858951864016e-07, -5.796478479453884e-07, -6.994442553808517e-07,
      -7.724517133965028e-07, -8.026274695345921e-07, -7.951100792540338e-07,
      -7.558307526639154e-07, -6.911498709607331e-07, -6.0752995193141e-07,
      -5.112531546508636e-07, -4.0818836522913925e-07, -3.036101031962463e-07,
      -2.020690110628948e-07, -1.0731159171185816e-07, -2.2245169781984896e-08,
      5.105721710828406e-08, 1.1131815340636787e-07, 1.5799004188601355e-07,
      1.9116892911127516e-07, 2.1149456139821613e-07, 2.2004285772428847e-07,
      2.1821637719848485e-07, 2.0763760998084902e-07, 1.9004908375051362e-07,
      1.67223400704759e-07, 1.408854449150608e-07, 1.1264816257070523e-07,
      8.396254718839611e-08, 5.6081780153619267e-08, 3.003889894781119e-08,
      6.636899546481278e-09, -1.3550171707306469e-08, -3.016682051955848e-08,
      -4.305821890603233e-08, -5.224668752322581e-08, -5.7904358435211274e-08,
      -6.032371840830037e-08, -5.988756698320298e-08, -5.7039719009369785e-08,
      -5.2257552272462805e-08, -4.602726042765471e-08, -3.8822431306060106e-08,
      -3.1086340679898776e-08, -2.3218139749700912e-08, -1.5562927006481117e-08,
      -8.405535872038879e-09, -1.96774098860316e-09, 3.5915110497120076e-09,
      8.17330703181085e-09, 1.1733906408857487e-08, 1.4278323603133275e-08,
      1.5852850914099082e-08, 1.6536989211365102e-08, 1.6435208434694478e-08,
      1.5668904033495688e-08, 1.4368852781946143e-08, 1.2668405509042108e-08,
      1.069758838796239e-08, 8.5782212610472e-09, 6.420103241240772e-09,
      4.318264200940204e-09, 2.3512368851223288e-09, 5.802689254052662e-10,
      -9.50632802720529e-10, -2.2139514222797304e-09, -3.1973392747589925e-09,
      -3.901866734659964e-09, -4.339977217788857e-09, -4.5332767652511406e-09,
      -4.510274283789078e-09, -4.304173255316729e-09, -3.950798568010396e-09,
      -3.486724060014674e-09, -2.9476482859900516e-09, -2.367048667027383e-09,
      -1.77512817439014e-09, -1.1980544894852645e-09, -6.574794953090893e-10,
      -1.703171720042614e-10, 2.512494479542971e-10, 5.995667070187613e-10,
      8.711514874545782e-10, 1.0662134029037258e-09, 1.1880955168030929e-09,
      1.2426688657206245e-09, 1.2377127159187016e-09, 1.1823083107356369e-09,
      1.0862691695896039e-09, 9.59626049237128e-10, 8.12179716863014e-10,
      6.531299194340389e-10, 4.907845323720819e-10, 3.323489607779736e-10,
      1.8379253656724506e-10, 4.978595619898001e-11, -6.629824631834067e-11,
      -1.6233160971765204e-10, -2.3733227064750915e-10, -2.9133460396256264e-10,
      -3.252362727011931e-10, -3.4063238157922727e-10, -3.396455157604627e-10,
      -3.2475930741106654e-10, -2.986618870961128e-10, -2.6410422039277423e-10,
      -2.2377696890508343e-10, -1.8020820613538295e-10, -1.356831086997231e-10,
      -9.218566748225106e-11, -5.1361546010377683e-11, -1.4500468889657474e-11,
      1.7464043423922495e-11, 4.394016900870983e-11, 6.465131035680319e-11,
      7.96005312105096e-11, 8.902873035918178e-11, 9.336921603872969e-11,
      9.32010962657874e-11, 8.920358926379109e-11, 8.211300634166382e-11,
      7.268378777342984e-11, 6.16545987601902e-11, 4.972013312640234e-11,
      3.7508939781926165e-11, 2.5567290928372733e-11, 1.4348858294098116e-11,
      4.2097583321285515e-12, -4.591629257441292e-12, -1.1890773912241176e-11,
      -1.760980500801814e-11, -2.1747810683437016e-11, -2.436940044784641e-11,
      -2.5592263462964452e-11, -2.5574386794487117e-11, -2.4501512940719168e-11,
      -2.257531967086561e-11, -2.0002703309915936e-11, -1.6986444142304492e-11,
      -1.3717433895151918e-11, -1.036855382657075e-11, -7.090210481769689e-12,
      -4.007466571533732e-12, -1.2186477852244942e-12, 1.2047369170227419e-12,
      3.2169540856512605e-12, 4.796093835736833e-12, 5.9414236950313915e-12,
      6.670261192219008e-12, 7.0145662829353265e-12, 7.01743631249586e-12,
      6.729663003279333e-12, 6.206484608803758e-12, 5.504638452722519e-12,
      4.679790959358237e-12, 3.784395173578698e-12, 2.8660006333985858e-12,
      1.9660180437342594e-12, 1.1189220257552109e-12, 3.5185959297821145e-13,
      -3.153799506718954e-13, -8.700863365362967e-13, -1.3060984463335472e-12,
      -1.6230825880978134e-12, -1.825677385397446e-12, -1.9225605329922027e-12,
      -1.925487664762468e-12, -1.8483472410637363e-12, -1.7062681532835874e-12,
      -1.5148090912867088e-12, -1.2892510071006874e-12, -1.0440065635574817e-12,
      -7.921535476303033e-13, -5.450930607518021e-13, -3.1232801696405456e-13,
      -1.0135317064295515e-13, 8.235540801289388e-14, 2.3526580284855276e-13,
      3.556464315245252e-13, 4.433692147204857e-13, 4.996757792257622e-13,
      5.269218758108066e-13, 5.283138301503419e-13, 5.076491141493428e-13,
      4.69071152307534e-13, 4.168463808844506e-13, 3.55169461827167e-13,
      2.8800050902033165e-13, 2.189362853162393e-13, 1.5111563187586363e-13,
      8.715793663296152e-14, 2.913226022942675e-14, -2.1446174988994898e-14,
      -6.359606774292221e-14, -9.683100937668954e-14, -1.211058078947985e-13,
      -1.3675256836862896e-13, -1.4441070059172321e-13, -1.4495465410078718e-13,
      -1.3942270804264208e-13, -1.2894960359163916e-13, -1.147052320415372e-13,
      -9.784101126272513e-14, -7.944502180719392e-14, -6.05064519409088e-14,
      -4.188943399864403e-14, -2.431595378003727e-14, -8.357186935969022e-15,
      5.567635884180188e-15, 1.7185910783293164e-14, 2.636107141234328e-14,
      3.3077952679067294e-14, 3.742531612246525e-14, 3.9576682855449296e-14,
      3.9770519108475605e-14, 3.8290690359149345e-14, 3.54479523451321e-14,
      3.1563089817353443e-14, 2.695215466288058e-14, 2.191410086340421e-14,
      1.6720970276671877e-14, 1.1610654774914342e-14, 6.782149918336821e-15,
      2.3931249485637087e-15, -1.4404357817322511e-15, -4.642813979853216e-15,
      -7.175684885297797e-15, -9.034126597298182e-15, -1.0241843020622899e-14,
      -1.084591524622097e-14, -1.091136874407732e-14, -1.0515808512953064e-14,
      -9.744333924657983e-15, -8.68490186176198e-15, -7.424263068575772e-15,
      -6.044554302792597e-15, -4.620589439303179e-15, -3.2178573374010475e-15,
      -1.8912038887482913e-15, -6.841507355001186e-16, 3.7121609818183206e-16,
      1.2538680336092437e-15, 1.9530548579416043e-15, 2.467216735452385e-15,
      2.802678365469112e-15, 2.972211775312962e-15, 2.9935467733079297e-15,
      2.887898468312251e-15, 2.678570207416226e-15, 2.3896784637835545e-15,
      2.0450342249516796e-15, 1.6672038079225266e-15, 1.2767611884614203e-15,
      8.917342093769117e-16, 5.272386618269716e-16, 1.9528735948943152e-16,
      -9.52439911031684e-17, -3.385160920192998e-16, -5.31514795549709e-16,
      -6.73754508129205e-16, -7.669212471466228e-16, -8.144791106897127e-16,
      -8.212618905849938e-16, -7.930689333588527e-16, -7.362813294309524e-16,
      -6.575112724602784e-16, -5.632941441460192e-16, -4.598296880534804e-16,
      -3.527756570394609e-16, -2.4709464407182087e-16, -1.469525009325958e-16,
      -5.566485371067049e-17, 2.4313244569424128e-17, 9.136052830967453e-17,
      1.4463224524527992e-16, 1.839793085894215e-16, 2.0985073400347754e-16,
      2.2318588859373083e-16, 2.253025272203011e-16, 2.1778587466737573e-16,
      2.0238318488345112e-16, 1.8090732126379565e-16, 1.5515200043849267e-16,
      1.2682046565942411e-16, 9.746853714347298e-17, 6.846225089334342e-17,
      4.0949662652176807e-17, 1.5845870953824693e-17, -6.170092401543089e-18,
      -2.4648145366211196e-17, -3.935163133560979e-17, -5.0235283132260333e-17,
      -5.741855755385585e-17, -6.115613355273542e-17, -6.180721705661535e-17,
      -5.980509980882094e-17, -5.56281932864731e-17, -4.9773515682703975e-17,
      -4.2733362664518056e-17, -3.49756519943036e-17, -2.6928207089853192e-17,
      -1.896704217315754e-17, -1.1408536825615719e-17, -4.505243642932086e-18,
      1.5550393515201257e-18, 6.647379972192497e-18, 1.070550486051581e-17,
      1.3715793855862934e-17, 1.5709992305954955e-17, 1.6757133873214125e-17,
      1.6955125600848504e-17, 1.642239360893032e-17, 1.528992588343301e-17,
      1.369398202984443e-17, 1.1769672039974269e-17, 9.645540054481351e-18,
      7.43922726474411e-18, 5.254232413111156e-18, 3.1777402055556024e-18,
      1.2794482122132971e-18, -3.887081108133818e-19, -1.7920548226193965e-18,
      -2.9120396686558588e-18, -3.744595474797087e-18, -4.2981485213545114e-18,
      -4.59140719941065e-18, -4.651055164008608e-18, -4.509458627113835e-18,
      -4.202480499950623e-18, -3.7674758517514535e-18, -3.2415245498068468e-18,
      -2.659938806900352e-18, -2.055066367823603e-18, -1.4553947488752367e-18,
      -8.84948686549709e-19, -3.6296199513256545e-19, 9.620351236886362e-20,
      4.829255257419327e-19, 7.920124871278643e-19, 1.0222576378389443e-18,
      1.1758947633325562e-18, 1.2579928022411425e-18, 1.2758234720132312e-18,
      1.2382320872636418e-18, 1.1550371154196217e-18, 1.0364790168995488e-18,
      8.92733815093209e-19, 7.335018614253889e-19, 5.676775905434397e-19,
      4.031018471332335e-19, 2.463947151949423e-19, 1.0286375985182483e-19,
      -2.351976807564218e-20, -1.3008591437457086e-19, -2.1538240828482626e-19,
      -2.7905315774913233e-19, -3.2168952796695894e-19, -3.4466461202966693e-19,
      -3.499598835975179e-19, -3.3999253651946013e-19, -3.174505495668862e-19,
      -2.851411455284131e-19, -2.458569146457546e-19, -2.0226250515382376e-19,
      -1.5680350028549875e-19, -1.1163794209252104e-19, -6.858995720314022e-20,
      -2.9124106827599684e-20, 5.661568332933958e-21, 3.502630818114735e-20,
      5.856399524070445e-20, 7.617005256902362e-20, 8.800080681948224e-20,
      9.442812054782845e-20, 9.599187539362559e-20, 9.335259170780113e-20,
      8.724612375942418e-20, 7.844199467784455e-20, 6.77065515333411e-20,
      5.577174560962347e-20, 4.330999024502584e-20, 3.09152298206772e-20,
      1.9090076686221457e-20, 8.2386432195989e-21, -1.3354837247572879e-21,
      -9.426808976916927e-21, -1.592180140343544e-20, -2.078987664075798e-20,
      -2.4072293993931985e-20, -2.5869737697036545e-20, -2.632929229989691e-20,
      -2.5631441171377287e-20, -2.397762236656463e-20, -2.1578773394526625e-20,
      -1.8645191180816358e-20, -1.537793047446992e-20, -1.1961867036690127e-20,
      -8.560464261370751e-21, -5.31220566691486e-21, -2.3285924050282276e-21,
      3.0644475308400396e-22, 2.5359055437507137e-21, 4.3280620006177725e-21,
      5.674002326053136e-21, 6.584597395985982e-21, 7.087101441895922e-21,
      7.221582040072878e-21, 7.037352502192278e-21, 6.5895538523772595e-21,
      5.936005443207087e-21, 5.1344144016351925e-21, 4.24000580777342e-21,
      3.3036088793579125e-21, 2.3702103165618892e-21, 1.4779649785434833e-21,
      6.5763661507217735e-22, -6.757234177637046e-23, -6.8185289831302555e-22,
      -1.1763408864747301e-21, -1.5484480299584866e-21, -1.801033205354944e-21,
      -1.941471999949465e-21, -1.980678210559555e-21, -1.9321249165596693e-21,
      -1.8109056754100356e-21, -1.6328686836419026e-21, -1.413848831548527e-21,
      -1.169014814326293e-21, -9.123411450097989e-22, -6.562082810538417e-22,
      -4.1112829919493156e-22, -1.8558874352384225e-22, 1.3996515833759326e-23,
      1.8324333717319267e-22, 3.196759721484134e-22, 4.225448984962276e-22,
      4.926004248359401e-22, 5.318380251193043e-22, 5.432301500746375e-22,
      5.304576233160949e-22, 4.976517925180725e-22, 4.491564956779627e-22,
      3.8931673209675947e-22, 3.222987960047747e-22, 2.519446201391858e-22,
      1.8166125213901464e-22, 1.1434479605294445e-22, 5.233682546441736e-23,
      -2.5897709239095285e-24, -4.9219314462468767e-23, -8.686052854455443e-23,
      -1.1529693516289735e-22, -1.347250117688524e-22, -1.4568449106606368e-22,
      -1.4898485782800878e-22, -1.4563164961214698e-22, -1.3675563854292169e-22,
      -1.2354739335698889e-22, -1.0719912574849966e-22, -8.885513989466825e-23,
      -6.957165159141225e-23, -5.0286241656007205e-23, -3.17967703535451e-23,
      -1.4749214162588688e-23, 3.6640247803265793e-25, 1.3213019213014724e-23,
      2.3597671307282252e-23, 3.145798426845994e-23, 3.6845281485097776e-23,
      3.99055085103435e-23, 4.085908844646272e-23, 3.998070091805801e-23,
      3.7579832294873144e-23, 3.398278653670021e-23, 2.951668283655501e-23,
      2.4495805614965327e-23, 1.921052062706244e-23, 1.3918832945762583e-23,
      8.840542029182073e-24, 4.153848353349767e-24, -5.81359854063238e-27,
      -3.54499969278602e-24, -6.4098595891546765e-24, -8.582460074653203e-24,
      -1.0076171214107066e-23, -1.0930445870158211e-23, -1.1205298945532678e-23,
      -1.0975759439407981e-23, -1.0326528814068715e-23, -9.347035819846626e-24,
      -8.12703317785277e-24, -6.752837430651463e-24, -5.304271565891651e-24,
      -3.8523320662671666e-24, -2.4575688508916227e-24, -1.1691388105410606e-24,
      -2.447164139471012e-26, 9.50529500934009e-25, 1.740840570930938e-24,
      2.34131581919637e-24, 2.7554276769501536e-24, 2.993838116491014e-24,
      3.0728856990391216e-24, 3.0130634517231727e-24, 2.837551890570642e-24,
      2.570859635618816e-24, 2.2376117945569206e-24, 1.861514189554943e-24,
      1.4645100435737691e-24, 1.0661353054251621e-24, 6.830696565075962e-25,
      3.2887259038934986e-25, 1.38878843293492e-26, -2.547046950026988e-25,
      -4.727145436406191e-25, -6.386678227170246e-25, -7.534633218668629e-25,
      -8.199815126633107e-25, -8.426699399021711e-25, -8.2712562562523005e-25,
      -7.79692201540733e-25, -7.07086234855044e-25, -6.160638483599282e-25,
      -5.131354139819387e-25, -4.0433295092304997e-25, -2.9503198931876064e-25,
      -1.8982714527936128e-25, -9.245854432132501e-26, -5.784554185881823e-27,
      6.820495034647199e-26, 1.2834138284082073e-25, 1.7420331366925243e-25,
      2.0602249235446339e-25, 2.2457686956480823e-25, 2.310769814234437e-25,
      2.2705138458589722e-25, 2.1423602160778765e-25, 1.9447150601037387e-25,
      1.6961139407269176e-25, 1.4144359869238994e-25, 1.1162623577270667e-25,
      8.163840430028869e-26, 5.274570894868663e-26, 2.5979752849734226e-26,
      2.130365584260946e-27, -1.8251011098632537e-26, -3.483858355200019e-26,
      -4.7512034109629697e-26, -5.633085904056833e-26, -6.150509645460938e-26,
      -6.336419302927851e-26, -6.232557463122749e-26, -5.886426478718874e-26,
      -5.348465123108183e-26, -4.669524786564671e-26, -3.8987049253404653e-26,
      -3.081583714382814e-26, -2.25885814968415e-26, -1.4653887887615705e-26,
      -7.29628300844639e-27, -7.340023105723114e-28, 4.880150913236536e-27,
      9.455368507668336e-27, 1.295734902711091e-26, 1.5401290761821005e-26,
      1.6843882426838177e-26, 1.737477220501153e-26, 1.7107945734335596e-26,
      1.6173383191434296e-26, 1.4709298888346374e-26, 1.2855197467481074e-26,
      1.0745912104378439e-26, 8.506724851909195e-27, 6.249609575509909e-27,
      4.070585471481412e-27, 2.0481250212159775e-27, 2.4252499856118066e-28,
      -1.3038770549832198e-27, -2.5657759051718747e-27, -3.533405517416613e-27,
      -4.210625938004457e-27, -4.6127319103782524e-27, -4.764115345361227e-27,
      -4.6959001083982854e-27, -4.443651068059659e-27, -4.0452410782612785e-27,
      -3.538940558934671e-27, -2.9617754920492984e-27, -2.348181717588147e-27,
      -1.728967002405405e-27, -1.1305779158428756e-27, -5.746563825638101e-28,
      -7.786105899996289e-29, 3.480785664738519e-28, 6.961122877990415e-28,
      9.634630373149827e-28, 1.1511045794991702e-27, 1.263161963672888e-27,
      1.3062710479390549e-27, 1.2889296848630533e-27, 1.2208686447681607e-27,
      1.1124653499281297e-27, 9.742182820460648e-28, 8.162947527741003e-28,
      6.4815980086901755e-28, 4.78289466871466e-28, 3.139677219212656e-28,
      1.6116297555565646e-28, 2.447740387740682e-29, -9.283966434571132e-29,
      -1.8882440874696565e-28, -2.6268805523780545e-28, -3.1467428898059838e-28,
      -3.458952293864426e-28, -3.5815594716562674e-28, -3.5377648922325232e-28,
      -3.354191433949432e-28, -3.059273054211276e-28, -2.681808820531535e-28,
      -2.2497174463193872e-28, -1.7890139425254083e-28, -1.3230175880089635e-28,
      -8.717894827841153e-29, -4.517887124227321e-29, -7.572874690113636e-30,
      2.4738984368487035e-29, 5.120979996479944e-29, 7.161577784063214e-29,
      8.601731248376681e-29, 9.471411485360205e-29, 9.819713363425126e-29,
      9.709973648356622e-29, 9.215028058227147e-29, 8.412782683651885e-29,
      7.382236049055051e-29, 6.200049134078899e-29, 4.9377235016675273e-29,
      3.6594135620192653e-29, 2.420368894931071e-29, 1.2659771041379655e-29,
      2.3135724404998307e-30, -6.585614610291675e-30, -1.3885512213289017e-29,
      -1.952268893613973e-29, -2.3511935457799288e-29, -2.593398940258758e-29,
      -2.69223631660274e-29, -2.6649953235576375e-29, -2.5316017376252645e-29,
      -2.313400340564121e-29, -2.0320605937368194e-29, -1.7086320567042433e-29,
      -1.362766286543649e-29, -1.0121125738077258e-29, -6.718865849765425e-30,
      -3.546039691684479e-30, -6.9965348804051995e-31, 1.7512512184597703e-30,
      3.76428313672065e-30, 5.3214806317489685e-30, 6.426411914994414e-30,
      7.100817221718383e-30, 7.38100013562379e-30, 7.314154706249937e-30,
      6.954789829828782e-30, 6.361384265400589e-30, 5.59337623306787e-30,
      4.708562204952895e-30, 3.760951451746037e-30, 2.7990971164941977e-30,
      1.8649017826598743e-30, 9.928761832711892e-31, 2.0981414164386376e-31,
      -4.65164876179214e-31, -1.0202621706269412e-30, -1.4503961807049065e-30,
      -1.7564110651632753e-30, -1.9441582238798126e-30, -2.0235076898859983e-30,
      -2.00734073402177e-30, -1.9105681457228698e-30, -1.749210961746902e-30,
      -1.5395723490867657e-30, -1.2975212982101324e-30, -1.037901078720724e-30,
      -7.740683185711547e-31, -5.1756229191020355e-31, -2.7789867756352803e-31,
      -6.247775807560263e-32, 1.2340620804500146e-31, 2.7646991412883983e-31,
      3.952769435116353e-31, 4.800217899078002e-31, 5.322786334308807e-31,
      5.54730517147987e-31, 5.50893046852358e-31, 5.248448574443013e-31,
      4.809749838913902e-31, 4.2375506398330976e-31, 3.57542091140239e-31,
      2.8641531946221753e-31, 2.140489736836866e-31, 1.4362068951391615e-31,
      7.775414327783579e-32, 1.8493145614769424e-32, -3.269642089211994e-32,
      -7.490105201866881e-32, -1.0771503750512095e-31, -1.3118152402084037e-31,
      -1.4572380298934278e-31, -1.5207112250031047e-31, -1.511829079533818e-31,
      -1.4417476265911937e-31, -1.3224904333618278e-31, -1.1663219949737233e-31,
      -9.852045959309872e-32, -7.903486557254404e-32, -5.918612155182334e-32,
      -3.984924696541374e-32, -2.1747620534661234e-32, -5.445674698060925e-33,
      8.650747211040942e-33, 2.0287528381476372e-32, 2.935016434982746e-32,
      3.5847681282258703e-32, 3.9893843382643926e-32, 4.168683083028934e-32,
      4.1488456748128736e-32, 3.96038514451303e-32, 3.63623844441105e-32,
      3.210042872714629e-32, 2.714640531824747e-32, 2.1808386689792067e-32,
      1.6364390131338405e-32, 1.1055361418753813e-32, 6.080737810268731e-33,
      1.5963892715035023e-33, -2.28533153815496e-33, -5.4937470165201314e-33,
      -7.996563534786947e-33, -9.795483657725448e-33, -1.0921066655584004e-32,
      -1.1427161943153897e-32, -1.1385209338137324e-32, -1.0878661717399387e-32,
      -9.99774247915833e-33, -8.834704701259946e-33, -7.479713252856703e-33,
      -6.017427273410795e-33, -4.524319925349111e-33, -3.06673633276911e-33,
      -1.69965995388498e-33, -4.661327729683428e-34, 6.027441986598809e-34,
      1.4873166615469262e-33, 2.1784830709289056e-33, 2.6764975517954826e-33,
      2.9895643917578855e-33, 3.132313315578253e-33, 3.1242363747160374e-33,
      2.9881568198760828e-33, 2.748788509472342e-33, 2.4314319320287806e-33,
      2.060840400124792e-33, 1.6602779321423337e-33, 1.2507792023401743e-33,
      8.506120351658725e-34, 4.749344722685253e-34, 1.3563158247624879e-34,
      -1.5868803728662637e-34, -4.025597364977839e-34, -5.934200239597521e-34,
      -7.312800007209424e-34, -8.183410108091831e-34, -8.585770207905705e-34,
      -8.57305960372269e-34, -8.207693978153418e-34, -7.557366904590909e-34,
      -6.6914633182294746e-34, -5.677937815762776e-34, -4.580717576532532e-34,
      -3.457659085951609e-34, -2.359060587726722e-34, -1.3267089212448112e-34,
      -3.9342048276832584e-35, 4.1697838280486723e-35, 1.0892962709407544e-34,
      1.6163174466407493e-34, 1.9979110312177192e-34, 2.2399800120719162e-34,
      2.353317424102527e-34, 2.352430848266242e-34, 2.25438856584644e-34,
      2.0777318582335545e-34, 1.8414885727334173e-34, 1.5643136502083978e-34,
      1.2637732282521936e-34, 9.557805186203407e-35, 6.541841583243819e-35,
      3.705033237600625e-35, 1.1379867915560809e-35, -1.0933575743291001e-35,
      -2.946775238600056e-35, -4.401967234254136e-35, -5.458130467153856e-35,
      -6.131083954590073e-35, -6.450136132795183e-35, -6.45486139854039e-35,
      -6.19193272906853e-35, -5.712133009888936e-35, -5.067642024318041e-35,
      -4.309670201772475e-35, -3.486485280079217e-35, -2.64185490550547e-35,
      -1.8139075595550574e-35, -1.0343965448952249e-35, -3.28337370246216e-36,
      2.8602214580020507e-36, 7.969474264154476e-36, 1.198731264483157e-35,
      1.491031127677688e-35, 1.6780834128585377e-35, 1.767845493073071e-35,
      1.771111805592918e-35, 1.700644407005046e-35, 1.5703517952646015e-35,
      1.3945427626637724e-35, 1.1872749499702413e-35, 9.618109225203051e-36,
      7.301882306675342e-36, 5.029042394231429e-36, 2.887116486672286e-36,
      9.451665570611368e-37, -7.463133291146076e-37, -2.1547166548883852e-36,
      -3.264005775852881e-36, -4.072904640515728e-36, -4.5927505037351654e-36,
      -4.8451443250564654e-36, -4.859527040370903e-36, -4.6707929962203523e-36,
      -4.3170337051238714e-36, -3.8374858001216977e-36, -3.27073760603353e-36,
      -2.6532299354513138e-36, -2.0180692400209782e-36, -1.3941556263041395e-36,
      -8.056148497147152e-37, -2.7151245186443526e-37, 1.9418020605878157e-37,
      5.824041686498518e-37, 8.88655056484066e-37, 1.1124902307669459e-36,
      1.2569414645921037e-36, 1.327871500209534e-36, 1.3333094697311771e-36,
      1.2827958154460187e-36, 1.1867623849750333e-36, 1.0559680934330956e-36,
      9.010052060992636e-37, 7.318861299069225e-37, 5.5771579809797315e-37,
      3.864504344541134e-37, 2.2473979391632423e-37, 7.784695701308064e-38,
      -5.036256872385839e-38, -1.573723237995512e-37, -2.41917815542606e-37,
      -3.0385213564663302e-37, -3.4398539591461054e-37, -3.6390852644787286e-37,
      -3.6581105501123752e-37, -3.5230130100039017e-37, -3.262360600942478e-37,
      -2.905654080804604e-37, -2.4819678782078098e-37, -2.0188112496587617e-37,
      -1.5412239761088933e-37, -1.0711090260795904e-37
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_3_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<3>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.00046318147718540253), "design.b()[0] == 0.00046318147718540253");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.00046318147718540253));
    static_assert(almost_equal(design.b()[1], 0.0013895444315562076), "design.b()[1] == 0.0013895444315562076");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.0013895444315562076));
    static_assert(almost_equal(design.b()[2], 0.0013895444315562076), "design.b()[2] == 0.0013895444315562076");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.0013895444315562076));
    static_assert(almost_equal(design.b()[3], 0.00046318147718540253), "design.b()[3] == 0.00046318147718540253");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.00046318147718540253));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.804549226952794), "design.a()[1] == -2.804549226952794");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.804549226952794));
    static_assert(almost_equal(design.a()[2], 2.668987471655791), "design.a()[2] == 2.668987471655791");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.668987471655791));
    static_assert(almost_equal(design.a()[3], -0.8607327928855134), "design.a()[3] == -0.8607327928855134");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.8607327928855134));
    std::cout << "max_deviation(cheby1,lowpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.00046318147718540253, 0.0026885596853353814, 0.007693516858969136, 0.015262971606067242,
      0.02458598659603521, 0.03483799195808307, 0.04522251338973689, 0.05500856580293123,
      0.06356211114100258, 0.07037039695346049, 0.07505844054504357, 0.07739737700674787,
      0.07730482470192065, 0.07483781794742941, 0.07017919631635486, 0.06361860993866458,
      0.05552949163941827, 0.04634345560779665, 0.03652360891814575, 0.026538211172775536,
      0.016835996984395522, 0.007824297097646225, -0.00014913002660498637,
      -0.0068098987235701664, -0.011966040934936074, -0.015512177581609717,
      -0.017428955451799316, -0.017778119749232206, -0.0166937881880391,
      -0.014370645380486012, -0.011049881528312738, -0.0070037551489542035,
      -0.0025196664603317487, 0.0021154107346825473, 0.006629370025972663,
      0.010777630283710463, 0.014353492526035044, 0.01719583234412998, 0.019193926395832617,
      0.02028937205404034, 0.020475210426709863, 0.019792497627052125, 0.018324681684976835,
      0.016190228709879274, 0.013533999333909814, 0.010517904225034846,
      0.007311366274791505, 0.004082089074828602, 0.0009875798499743918,
      -0.0018321955805904355, -0.004260733015827925, -0.0062092860731075596,
      -0.00761943623614173, -0.008463929897289623, -0.008745864338614816,
      -0.00849638284480466, -0.007771103610009083, -0.006645555493219957,
      -0.005209924680561872, -0.0035634295958005095, -0.0018086375574679712,
      -4.601713733875558e-05, 0.0016310129464538895, 0.0031403216050088167,
      0.004414424950374623, 0.005402859389909425, 0.006073518023828476,
      0.006412956572345349, 0.006425727135223613, 0.006132843453128964,
      0.0055695181664731815, 0.004782339589675713, 0.00382607206351584,
      0.002760269924406124, 0.0016458909910467825, 0.0005420821529718298,
      -0.0004967115106009764, -0.0014231900084557317, -0.0021991017536993995,
      -0.002796548706752098, -0.003198669794922316, -0.003399712432731194,
      -0.0034045324452697187, -0.003227588933426926, -0.0028915215821256664,
      -0.002425412910982868, -0.0018628466647775286, -0.0012398759476996944,
      -0.0005930111495024092, 4.267119741503916e-05, 0.0006352109150024969,
      0.0011571672463974816, 0.0015866910312652904, 0.0019082350868441554,
      0.0021128925496446504, 0.0021983726297665407, 0.0021686410311909992,
      0.0020332674260095697, 0.0018065342584579897, 0.0015063694230198826,
      0.0011531698481667355, 0.0007685837662217655, 0.0003743166905507346,
      -8.97975376040641e-06, -0.00036268546731201587, -0.0006710157462104521,
      -0.0009216228924338982, -0.0011059794258164877, -0.001219539047507958,
      -0.0012616831077057744, -0.0012354707054387944, -0.0011472192545892018,
      -0.0010059490642216878, -0.000822730003496515, -0.0006099705788200703,
      -0.0003806897909543548, -0.00014781011968072145, 7.64938458722754e-05,
      0.00028136192692838067, 0.00045770724123953704, 0.0005985517932124571,
      0.0006992305135674608, 0.0007574627911423023, 0.0007732973614910424,
      0.0007489424503837989, 0.0006884980642987131, 0.0005976110946090865,
      0.0004830763525611652, 0.000352407748480537, 0.00021340361225658671,
      7.372872829108435e-05, -5.946681400179879e-05, -0.0001798751721586393,
      -0.0002822918592575443, -0.0003628018716022476, -0.00041888673213317314,
      -0.00044945267121279154, -0.0004547841697037226, -0.00043643058985544565,
      -0.0003970364751138655, -0.0003401282113303268, -0.0002698710547889711,
      -0.0001908110373901855, -0.00010761598848991441, -2.4828935786570913e-05,
      5.335443523691086e-05, 0.00012327464831502586, 0.00018195642118624773,
      0.00022721116050570595, 0.000257692008354077, 0.0002729020406023292,
      0.0002731585619190866, 0.0002595184683636762, 0.0002336712758835653,
      0.00019780758731558054, 0.00015447146435228676, 0.00010640538350011096,
      5.639621003835903e-05, 7.129966720680075e-06, -3.8937832468461715e-05,
      -7.969079242498477e-05, -0.00011343516709031848, -0.00013895585287329446,
      -0.00015554396827833968, -0.00016299665374120396, -0.0001615910959506907,
      -0.00015203595070658493, -0.000135404262405323, -0.00011305262710087827,
      -8.653170644283347e-05, -5.749327398987331e-05, -2.759878019394858e-05,
      1.566012965977594e-06, 2.8566412730325547e-05, 5.2181066596433494e-05,
      7.144889101111325e-05, 8.569936726042802e-05, 9.456585441550884e-05,
      9.798245985880312e-05, 9.616580710111047e-05, 8.958371414221472e-05,
      7.891331821863732e-05, 6.499153862262271e-05, 4.876095220090543e-05,
      3.121416923930896e-05, 1.3339652232430936e-05, -3.928364709933539e-06,
      -1.9753597828084632e-05, -3.343330520124204e-05, -4.442451746158926e-05,
      -5.236024281459613e-05, -5.705554013065936e-05, -5.85038778691076e-05,
      -5.686466168823333e-05, -5.24432003089922e-05, -4.566467345258477e-05,
      -3.704385910366603e-05, -2.715246734014652e-05, -1.6585917356250212e-05,
      -5.931290849936279e-06, 4.261989414312181e-06, 1.350745711780322e-05,
      2.140187552802228e-05, 2.76398136979396e-05, 3.202219177523569e-05,
      3.4458792806093223e-05, 3.49650461020549e-05, 3.36536572890555e-05,
      3.072188151335505e-05, 2.6435401153720973e-05, 2.1109873434237524e-05,
      1.5091255611273774e-05, 8.735998200216695e-06, 2.3921251595448444e-06,
      -3.617898391369222e-06, -9.011766088650774e-06, -1.3558835567610104e-05,
      -1.7088174808198776e-05, -1.9492987782491126e-05, -2.07314537462236e-05,
      -2.08241948289476e-05, -1.984874300726384e-05, -1.7931503834789903e-05,
      -1.523780617817055e-05, -1.1960682458351713e-05, -8.309042333697746e-06,
      -4.495886089081012e-06, -7.271555826969298e-07, 2.808254804334064e-06,
      5.9469013907944135e-06, 8.557294152775145e-06, 1.054430439463913e-05,
      1.1851402896823121e-05, 1.246077020163548e-05, 1.2391426153699863e-05,
      1.1695616199848717e-05, 1.0453763749007746e-05, 8.768348771444757e-06,
      6.757101687069572e-06, 4.5459085626666584e-06, 2.2618099247718767e-06,
      2.6443281905834882e-08, -2.049768293309519e-06, -3.872438897024624e-06,
      -5.366879020544092e-06, -6.48048829517329e-06, -7.183850717894896e-06,
      -7.470569675818486e-06, -7.355941634473167e-06, -6.874619445666665e-06,
      -6.077456888812058e-06, -5.027754033814101e-06, -3.797137788568293e-06,
      -2.4613137642942525e-06, -1.0959152005663864e-06, 2.2734645843552962e-07,
      1.4440548040561007e-06, 2.49984778375407e-06, 3.3524665411388848e-06,
      3.97304035502501e-06, 4.346597023592043e-06, 4.471828279455461e-06,
      4.360175664936474e-06, 4.034332232877513e-06, 3.5262783653335842e-06,
      2.874985255021673e-06, 2.123926946058227e-06, 1.3185414737091734e-06,
      5.037741491141825e-07, -2.7817770156586845e-07, -9.89818065210793e-07,
      -1.5999257588869604e-06, -2.084695204989369e-06, -2.428417387253871e-06,
      -2.6236992886602892e-06, -2.671243755342676e-06, -2.579232558245024e-06,
      -2.3623725770294966e-06, -2.040677898253959e-06, -1.6380688538923492e-06,
      -1.1808725398172966e-06, -6.963083066700105e-07, -2.1103648834700227e-07,
      2.5016020742094766e-07, 6.65504966287691e-07, 1.0171209532063991e-06,
      1.2916624596881905e-06, 1.4806698198479676e-06, 1.5806498348667873e-06,
      1.5928973100184363e-06, 1.5230853824721717e-06, 1.3806621148609287e-06,
      1.1780980132679225e-06, 9.300335202899403e-07, 6.523771107301412e-07,
      3.614035009591058e-07, 7.289792329545034e-08, -1.9861322931433934e-07,
      -4.4051237798227675e-07, -6.425967952746139e-07, -7.974252470575067e-07,
      -9.004990136749898e-07, -9.502799529914357e-07, -9.480563818311527e-07,
      -8.976745347035503e-07, -8.051589347888183e-07, -6.782489987343613e-07,
      -5.25881504796472e-07, -3.5764918611812794e-07, -1.83264755523043e-07,
      -1.2057287782973138e-08, 1.474756965154914e-07, 2.8804161583292044e-07,
      4.038380016528298e-07, 4.907412595205652e-07, 5.463963174954542e-07,
      5.702097073927023e-07, 5.632533630062457e-07, 5.280904469303132e-07,
      4.6853767944245617e-07, 3.8938084016300703e-07, 2.9606130312128573e-07,
      1.9435166010016967e-07, 9.00377472677367e-08, -1.1377179105646685e-08,
      -1.0493263109938951e-07, -1.8642473926528152e-07, -2.5256619176593403e-07,
      -3.0108798099683055e-07, -3.307819492531061e-07, -3.414862145482099e-07,
      -3.340183194074588e-07, -3.100632621266665e-07, -2.720253554817565e-07,
      -2.228540593296284e-07, -1.6585453164415907e-07, -1.0449365011031647e-07,
      -4.221171545542932e-08, 1.7750974828346986e-08, 7.250491114188468e-08,
      1.1963345533027803e-07, 1.5728206133345985e-07, 1.842124447239624e-07,
      1.998214563594455e-07, 2.0412623179246343e-07, 1.977187940144902e-07,
      1.8169461582770264e-07, 1.5756065181742467e-07, 1.2712900071933413e-07,
      9.240264909770195e-08, 5.54596877790014e-08, 1.8342011543965836e-08,
      -1.704614733982286e-08, -4.902538640565587e-08, -7.621058503168226e-08,
      -9.75603732341887e-08, -1.1240553044128338e-07, -1.204563793139663e-07,
      -1.2179030552272407e-07, -1.1682146608661e-07, -1.062555085831995e-07,
      -9.103268486981844e-08, -7.226309154982092e-08, -5.115790277682215e-08,
      -2.896038776754092e-08, -6.880244150405633e-09, 1.3965644177334043e-08,
      3.26034665746027e-08, 4.8241845871563196e-08, 6.02990756429075e-08,
      6.841771658203975e-08, 7.246671543767302e-08, 7.253183415030783e-08,
      6.889571605702807e-08, 6.200934893461809e-08, 5.2456996792769915e-08,
      4.0916856471013094e-08, 2.811975103803346e-08, 1.480810609097692e-08,
      1.6972794098838471e-09, -1.0558954132642713e-08, -2.1397301617980905e-08,
      -3.0367165370996175e-08, -3.714551830088336e-08, -4.1544209892473335e-08,
      -4.3509873826875905e-08, -4.31169729934278e-08, -4.055482894897698e-08,
      -3.6109728659979515e-08, -3.014337380425991e-08, -2.3069033488358097e-08,
      -1.5326780599157998e-08, -7.359139638940657e-09, 4.1164239093714697e-10,
      7.603660176725143e-09, 1.3891918071772685e-08, 1.9020808443495566e-08,
      2.2812157985457692e-08, 2.516875004723966e-08, 2.6073468198245198e-08,
      2.5584418980616647e-08, 2.3826571031990672e-08, 2.0980586742334025e-08,
      1.7269617155868338e-08, 1.2944879310234564e-08, 8.270838456317004e-09,
      3.5107787044371173e-09, -1.086530396203462e-09, -5.298470476621104e-09,
      -8.938042904726532e-09, -1.1860842340361099e-08, -1.3969358974195157e-08,
      -1.5214581934712593e-08, -1.559501586781264e-08, -1.5153346490841373e-08,
      -1.3971093816422457e-08, -1.216166998781397e-08, -9.862310048043224e-09,
      -7.225367789595509e-09, -4.40946586371036e-09, -1.5709616427630248e-09,
      1.1438588889897296e-09, 3.6055136378407906e-09, 5.706717239427012e-09,
      7.366255550179092e-09, 8.531253315764196e-09, 9.177834782921923e-09,
      9.310258941061643e-09, 8.958682956630923e-09, 8.175766254315784e-09,
      7.032371535331191e-09, 5.61264665093969e-09, 4.008782424280707e-09,
      2.3157368470637424e-09, 6.261969446024248e-10, -9.739819834383864e-10,
      -2.4096615746900147e-09, -3.6194805500752016e-09, -4.557993057731162e-09,
      -5.19684240155545e-09, -5.5249795755603184e-09, -5.547984030180304e-09,
      -5.286585729140681e-09, -4.774521151090987e-09, -4.055880313632539e-09,
      -3.1821165622657202e-09, -2.208895726224905e-09, -1.1929567533300933e-09,
      -1.891429967779588e-10, 7.522567958415907e-10, 1.5877445059138768e-09,
      2.282342083218748e-09, 2.8107626235103572e-09, 3.158003479734044e-09,
      3.319372665463855e-09, 3.299987883111618e-09, 3.1138115637082134e-09,
      2.7823044022062536e-09, 2.3327933948397715e-09, 1.796658044066998e-09,
      1.2074402225665345e-09, 5.989795062915835e-10, 3.667180657277197e-12,
      -5.49100614381345e-10, -1.0342060594815363e-09, -1.4317826815173767e-09,
      -1.7278509021388395e-09, -1.9146079427762226e-09, -1.9903821214005775e-09,
      -1.959277960199963e-09, -1.8305523847052017e-09, -1.6177731084190654e-09,
      -1.3378177303358397e-09, -1.0097759896755354e-09, -6.538180754792948e-10,
      -2.9008910393411473e-10, 6.231577222833102e-11, 3.8624917674761414e-10,
      6.672456100798365e-10, 8.940661749312144e-10, 1.0590397585792746e-09,
      1.158197894017768e-09, 1.19121123646544e-09, 1.1611451327138269e-09,
      1.074059726142732e-09, 9.384861371469286e-10, 7.648143105825233e-10,
      5.646300689475426e-10, 3.5003880420413077e-10, 1.3301123517954272e-10,
      -7.521701002301831e-11, -2.646652500364912e-10, -4.2702633304302574e-10,
      -5.55969882803872e-10, -6.473230319113375e-10, -6.991282251899909e-10,
      -7.115839711978748e-10, -6.868799633781285e-10, -6.289425559961637e-10,
      -5.431100013308534e-10, -4.357590412934001e-10, -3.1390537590121977e-10,
      -1.848002457368291e-10, -5.554396739373535e-11, 6.726509891328287e-11,
      1.77830802619098e-10, 2.7139701955179505e-10, 3.4441539356776303e-10,
      3.9463948415205816e-10, 4.2114580434556703e-10, 4.242859246075693e-10,
      4.055770317034899e-10, 3.6754093794271166e-10, 3.135034458422643e-10,
      2.4736713922260483e-10, 1.733710878215488e-10, 9.585065136046807e-11,
      1.9009617444045183e-11, -5.32845990975298e-11, -1.176739131612014e-10,
      -1.7144415365095089e-10, -2.1261717041839405e-10, -2.3999881867578746e-10,
      -2.5318354247704166e-10, -2.5251843898293e-10, -2.3903154342828116e-10,
      -2.1433055796051376e-10, -1.8047930714075778e-10, -1.3985981529574093e-10,
      -9.502806697169422e-11, -4.857125504516471e-11, -2.973685017879475e-12,
      3.950245169298977e-11, 7.69164264067062e-11, 1.0772480734002035e-10,
      1.308316022765914e-10, 1.4561199836857902e-10, 1.5191038437160371e-10,
      1.5001460211219934e-10, 1.406094457166015e-10, 1.2471326809234957e-10,
      1.0360213805472344e-10, 7.872630702203482e-11, 5.1623794549693394e-11,
      2.3835703601926872e-11, -3.172542665165794e-12, -2.8080453508603578e-11,
      -4.976936582173925e-11, -6.73649693371504e-11, -8.026432600168001e-11,
      -8.814711949445424e-11, -9.097169351711957e-11, -8.895717262327927e-11,
      -8.255357578729633e-11, -7.240230774551227e-11, -5.928973233982785e-11,
      -4.40966905582485e-11, -2.7746827160637898e-11, -1.1156444928606946e-11,
      4.811667448665653e-12, 1.9388365930491422e-11, 3.1930628541901723e-11,
      4.1945273790474027e-11, 4.910333999980492e-11, 5.3245063078766875e-11,
      5.437587387869663e-11, 5.26542637446692e-11, 4.837272038945618e-11,
      4.1933203099272167e-11, 3.381879913663065e-11, 2.4563279977040733e-11,
      1.4720259687195755e-11, 4.833555837680263e-12, -4.5898228195788335e-12,
      -1.3102873782257409e-11, -2.033707491857967e-11, -2.6015532788197268e-11,
      -2.9960517347518144e-11, -3.209540197972985e-11, -3.24413115613283e-11,
      -3.110902925182675e-11, -2.828691480299128e-11, -2.4225736420160845e-11,
      -1.9221410760427756e-11, -1.3596680872548335e-11, -7.68274209173113e-12,
      -1.801756056331441e-12, 3.748919734449566e-12, 8.710106226852339e-12,
      1.287127135924185e-11, 1.6077767897537776e-11, 1.8234703585035636e-11,
      1.93074880974346e-11, 1.931926746605617e-11, 1.8345600140213052e-11,
      1.6506844016457053e-11, 1.3958806734110384e-11, 1.0882260404678955e-11,
      7.47193666484687e-12, 3.9256002194524634e-12, 4.337521043360289e-13,
      -2.8295577617457747e-12, -5.714420124958285e-12, -8.100973667324256e-12,
      -9.903356869866122e-12, -1.1071643421195303e-11, -1.1591807274769297e-11,
      -1.1483860567171287e-11, -1.0798390449644155e-11, -9.611786258064612e-12,
      -8.020494274631963e-12, -6.134662685081105e-12, -4.071544386103209e-12,
      -1.9490112485602387e-12, 1.2049761998761263e-13, 2.03531634070145e-12,
      3.708960336468827e-12, 5.07344428324174e-12, 6.0814190899876314e-12,
      6.707103766595284e-12, 6.946051190095334e-12, 6.813843409450557e-12,
      6.343859819902214e-12, 5.5842985005322324e-12, 4.594656129582677e-12,
      3.4418847408868888e-12, 2.196444387561784e-12, 9.284603596351016e-13,
      -2.9582670290653786e-13, -1.4171579066198755e-12, -2.3857750692098132e-12,
      -3.163274672112093e-12, -3.723750049326317e-12, -4.054214691447888e-12,
      -4.1543366927623085e-12, -4.035547321275108e-12, -3.719614068518388e-12,
      -3.236789342816701e-12, -2.6236596175981956e-12, -1.9208261536076055e-12,
      -1.170547585976796e-12, -4.144672583914351e-13, 3.084649529878427e-13,
      9.637843726191446e-13, 1.5229460613338993e-12, 1.9643546835991807e-12,
      2.273966266425362e-12, 2.4454619109913113e-12, 2.4800153289880606e-12,
      2.3856952063250518e-12, 2.176559064603159e-12, 1.8715069456978238e-12,
      1.4929705809626807e-12, 1.0655166600740212e-12, 6.144415494509811e-13,
      1.6442969379025716e-13, -2.6166049625033374e-13, -6.43830544253507e-13,
      -9.657558392859942e-13, -1.2153539057381015e-12, -1.385095683579431e-12,
      -1.4720624013895466e-12, -1.4777634049555848e-12, -1.4077413843240685e-12,
      -1.2710003793074432e-12, -1.0792984359225055e-12, -8.463506786662728e-13,
      -5.869898441694525e-13, -3.163301128154652e-13, -4.8976616690020206e-14,
      2.0168236756777486e-13, 4.240704029245192e-13, 6.088828283335665e-13,
      7.493979005145435e-13, 8.416339643287836e-13, 8.843556936486175e-13,
      8.789399183524347e-13, 8.291179544216665e-13, 7.406164338035349e-13,
      6.207222247179903e-13, 4.777990649021181e-13, 3.2078400848400225e-13,
      1.5869079890764687e-13, 1.4498122092214292e-16, -1.4702783164505265e-13,
      -2.7614337009393226e-13, -3.819174443885144e-13, -4.606347544218285e-13,
      -5.102256243193552e-13, -5.302533602554759e-13, -5.218192912411362e-13,
      -4.873962411562871e-13, -4.306040562732898e-13, -3.5594278769725995e-13,
      -2.685001665305494e-13, -1.7365012547366454e-13, -7.675837431200953e-14,
      1.7090471773702006e-14, 1.0333185130074651e-13, 1.7811655873748448e-13,
      2.3845557007152205e-13, 2.823106339060082e-13, 3.086299040754882e-13,
      3.173307426858535e-13, 3.0923436211535807e-13, 2.859590939209804e-13,
      2.497806939252751e-13, 2.034691691344469e-13, 1.5011212781830771e-13,
      9.293462303220567e-14, 3.5124922906653127e-14, -2.0325338148340933e-14,
      -7.075951293394365e-14, -1.1396729143002654e-13, -1.4826531062758717e-13,
      -1.725451224900822e-13, -1.8628841839801486e-13, -1.8955108449158925e-13,
      -1.8291913783973808e-13, -1.6744080752643743e-13, -1.4453993443720558e-13,
      -1.1591644424269025e-13, -8.343989383033869e-14, -4.904201374789726e-14,
      -1.4613795269778974e-14, 1.8087959196545682e-14, 4.7520539008251264e-14,
      7.241858163935566e-14, 9.183865353116177e-14, 1.0518422391467997e-13,
      1.1221116621038785e-13, 1.1301490435541838e-13, 1.0800117666629947e-13,
      9.784308317968083e-14, 8.342759011134326e-14, 6.579497458546438e-14,
      4.607480256320946e-14, 2.542195168438042e-14, 4.95593637661835e-15,
      -1.4293609524898058e-14, -3.143295616903817e-14, -4.574007121921464e-14,
      -5.668909361312616e-14, -6.39630527846442e-14, -6.745502885505553e-14,
      -6.72585243702254e-14, -6.364831267898852e-14, -5.705342259510455e-14,
      -4.8024200628403197e-14, -3.7195554560632856e-14, -2.5248525749572856e-14,
      -1.2872268582023477e-14, -7.283455573531083e-16, 1.0581008522708308e-14,
      2.0539320752976594e-14, 2.8736046049538065e-14, 3.48798869851937e-14,
      3.880508010506576e-14, 4.047083320695719e-14, 3.9954433887984206e-14,
      3.7438834854022063e-14, 3.3195745160359534e-14, 2.756541171739748e-14,
      2.0934359063666556e-14, 1.371236844778267e-14, 6.3099240764054715e-15,
      -8.827575591084458e-16, -7.514160145874598e-15, -1.3286604589362184e-14,
      -1.796755571986082e-14, -2.139679736306257e-14, -2.348940666742404e-14,
      -2.423467763121412e-14, -2.3691339457203198e-14, -2.197957938692362e-14,
      -1.9270505942519372e-14, -1.5773773306316192e-14, -1.1724129551460651e-14,
      -7.367651535168503e-15, -2.9483904807849786e-15, 1.3039206262694902e-15,
      5.184547556303377e-15, 8.522394652540676e-15, 1.1186310102942184e-14,
      1.3088902893508132e-14, 1.4187855524193031e-14, 1.4484845338989924e-14,
      1.4022301097597902e-14, 1.287831547512645e-14, 1.1160105140089561e-14,
      8.996455970623729e-15, 6.529611283033513e-15, 3.907056467361472e-15,
      1.2736261596673066e-15, -1.235686944815505e-15, -3.501905504449656e-15,
      -5.426981599262321e-15, -6.9372914057428144e-15, -7.985634257050736e-15,
      -8.551741562057778e-15, -8.641376608401189e-15, -8.284172273962693e-15,
      -7.530407439948777e-15, -6.4469625746279184e-15, -5.112719529292121e-15,
      -3.6136798889399555e-15, -2.038070871698716e-15, -4.716890972303257e-16,
      1.0062975465095986e-15, 2.326908863676509e-15, 3.434136636388774e-15,
      4.2868679416780355e-15, 4.859911278428393e-15, 5.144137608183363e-15,
      5.145792653057293e-15, 4.885074986333894e-15, 4.394105084259896e-15,
      3.714432562461946e-15, 2.8942417890345943e-15, 1.98541993993765e-15,
      1.040646796325589e-15, 1.1065304085836407e-16, -7.582253116593101e-16,
      -1.526092968013063e-15, -2.16106629528883e-15, -2.6403231857781664e-15,
      -2.95061574459704e-15, -3.0882582295348455e-15, -3.0586285240879506e-15,
      -2.8752434694792105e-15, -2.558485769448406e-15, -2.1340723608136264e-15,
      -1.6313608664244331e-15, -1.0815920640883871e-15, -5.161625363239082e-16,
      3.498663150338904e-17, 5.447913150374953e-16, 9.902371588080728e-16,
      1.353241804780722e-15, 1.6212224367832006e-15, 1.7873423040381198e-15,
      1.8504467026268426e-15, 1.8147139682323835e-15, 1.6890597236659158e-15,
      1.4863424548711391e-15, 1.2224251636182625e-15, 9.151512502934551e-16,
      5.832929771870154e-16, 2.455280717281509e-16, -8.050539307880011e-17,
      -3.79033291982233e-16, -6.36815577579736e-16, -8.436391599987761e-16,
      -9.92621139690568e-16, -1.080320551984443e-15, -1.1066666733677013e-15,
      -1.0747207105121243e-15, -9.902949772607385e-16, -8.614591976070714e-16,
      -6.979671978787229e-16, -5.10638921051388e-16, -3.1073246563491743e-16,
      -1.093388690321873e-16, 8.317115252358804e-17, 2.576240401405787e-16,
      4.0642498841906826e-16, 5.238316899515781e-16, 6.061140184333808e-16,
      6.515996994859542e-16, 6.606118253763255e-16, 6.35309161605583e-16,
      5.794443616817964e-16, 4.980583051327538e-16, 3.9713072180170967e-16,
      2.832080460268892e-16, 1.6302910144987968e-16, 4.3167849041210234e-17,
      -7.028981920291533e-17, -1.7202121256493579e-16, -2.576833286128402e-16,
      -3.2406387125885553e-16, -3.6916380262669025e-16, -3.922121359864429e-16,
      -3.936170795647613e-16, -3.7486058989670166e-16, -3.383457708329784e-16,
      -2.8720828020179703e-16, -2.2510393925794983e-16, -1.5598507750558109e-16,
      -8.38778199925527e-17, -1.267159991797195e-17, 5.406925354587739e-17,
      1.1326383439756849e-16, 1.6243697729795895e-16, 1.9980192372451083e-16,
      2.2430196989731083e-16, 2.356119181835996e-16, 2.3410214331033883e-16,
      2.207697882436211e-16, 1.9714295574539945e-16, 1.6516471682461496e-16,
      1.270642963003632e-16, 8.522292089445354e-17, 4.204154999136592e-17,
      -1.8290500638245621e-19, -3.9367173590857805e-17, -7.373246434971449e-17,
      -1.0187326512179434e-16, -1.2280218061365802e-16, -1.3597024236747539e-16,
      -1.412634165790706e-16, -1.3897719625877485e-16, -1.2977214574105864e-16,
      -1.1461403044222642e-16, -9.470268960512862e-17, -7.13940850385834e-17,
      -4.6119988442168504e-17, -2.0309569931840477e-17, 4.683252482204952e-18,
      2.7643413371716747e-17, 4.7546658550642136e-17, 6.359804950827399e-17,
      7.525601698970231e-17, 8.224177511935602e-17, 8.453466709731245e-17,
      8.23546895031714e-17, 7.613400616908238e-17, 6.647969373656896e-17,
      5.4130246947991386e-17, 3.990850829381378e-17, 2.4673677602482072e-17,
      9.274913432590528e-18, -5.491223299643875e-18, -1.8917590378776396e-17,
      -3.041608513918807e-17, -3.953907231623042e-17, -4.5992114926994113e-17,
      -4.9637983622011013e-17, -5.0492366202357166e-17, -4.87120917262586e-17,
      -4.45770066619635e-17, -3.846688241890036e-17, -3.0834887805351596e-17,
      -2.2179224950601458e-17, -1.3014506085244875e-17, -3.844348555366861e-18,
      4.863502686448144e-18, 1.269843865973484e-17, 1.9323811719286136e-17,
      2.4488783777196142e-17, 2.803495080081846e-17, 2.989778092900591e-17,
      3.010316519109206e-17, 2.875960743687972e-17, 2.604676453245993e-17,
      2.2201182844983904e-17, 1.7500159202469744e-17, 1.2244683475291415e-17,
      6.742398027061587e-18, 1.2914412909430437e-18, -3.834064583288192e-18,
      -8.396260404475456e-18, -1.2203069419149552e-17, -1.511470019449966e-17,
      -1.704701801838942e-17, -1.7971837771291855e-17, -1.791434432026462e-17,
      -1.6947978089894023e-17, -1.5187228414880233e-17, -1.277885213817798e-17,
      -9.892078032057907e-18, -6.708369068555965e-18, -3.4112960398935913e-18,
      -1.770306243462367e-19, 2.834102047842834e-18, 5.484656858085556e-18,
      7.665431228638839e-18, 9.299003356939815e-18, 1.0341396777539542e-17,
      1.078192090960127e-17, 1.0641326643884383e-17, 9.968491915417571e-18,
      8.835911698136962e-18, 7.334308091079263e-18, 5.5666983512996036e-18,
      3.642262103089652e-18, 1.670334694591426e-18, -2.4517622609884856e-19,
      -2.0106967362958268e-18, -3.547013854880044e-18, -4.79228178406112e-18,
      -5.703927249841915e-18, -6.259435858550242e-18, -6.456059713482835e-18,
      -6.309538624677977e-18, -5.851970889139736e-18, -5.129003200314999e-18,
      -4.19653177511158e-18, -3.1171179093427942e-18, -1.956321140115665e-18,
      -7.791428086975802e-19, 3.532466478233795e-19, 1.3863502494085429e-18,
      2.2746428770326055e-18, 2.983247449135654e-18, 3.488948108082128e-18,
      3.780536369173403e-18, 3.858520470666931e-18, 3.734258447029748e-18,
      3.428600473165657e-18, 2.970144896622593e-18, 2.39322456803666e-18,
      1.735745455080033e-18, 1.0369982974274636e-18, 3.3555676625789006e-19,
      -3.3263696126556745e-19, -9.359150969826498e-19, -1.4481913669159022e-18,
      -1.849889850870559e-18, -2.1284753516778205e-18, -2.2785868660976003e-18,
      -2.3017958443729405e-18, -2.2060284912829834e-18, -2.004705666011225e-18
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.00046318147718540253, 0.0026885596853353814, 0.007693516858969136, 0.015262971606067243,
      0.024585986596035215, 0.03483799195808307, 0.045222513389736894, 0.05500856580293127,
      0.06356211114100269, 0.07037039695346069, 0.0750584405450439, 0.07739737700674838,
      0.07730482470192138, 0.07483781794743033, 0.07017919631635597, 0.06361860993866589,
      0.055529491639419795, 0.0463434556077984, 0.03652360891814769, 0.026538211172777607,
      0.016835996984397687, 0.007824297097648446, -0.000149130026602756,
      -0.00680989872356797, -0.011966040934933956, -0.015512177581607724,
      -0.017428955451797488, -0.017778119749230572, -0.016693788188037684,
      -0.014370645380484827, -0.011049881528311802, -0.007003755148953519,
      -0.002519666460331313, 0.002115410734682749, 0.006629370025972656,
      0.010777630283710279, 0.014353492526034722, 0.017195832344129556,
      0.019193926395832134, 0.020289372054039842, 0.020475210426709384,
      0.019792497627051715, 0.018324681684976536, 0.016190228709879125, 0.01353399933390985,
      0.010517904225035091, 0.007311366274791962, 0.004082089074829267,
      0.000987579849975246, -0.00183219558058942, -0.0042607330158267835,
      -0.006209286073106333, -0.007619436236140463, -0.008463929897288364,
      -0.00874586433861361, -0.008496382844803549, -0.007771103610008097,
      -0.006645555493219127, -0.005209924680561219, -0.0035634295958000472,
      -0.0018086375574677032, -4.601713733867601e-05, 0.0016310129464537945,
      0.003140321605008569, 0.004414424950374252, 0.005402859389908962,
      0.006073518023827955, 0.006412956572344808, 0.006425727135223086,
      0.006132843453128481, 0.005569518166472769, 0.00478233958967539, 0.003826072063515623,
      0.0027602699244060206, 0.0016458909910467944, 0.0005420821529719516,
      -0.0004967115106007554, -0.0014231900084554269, -0.0021991017536990287,
      -0.0027965487067516826, -0.0031986697949218787, -0.0033997124327307575,
      -0.003404532445269304, -0.0032275889334265513, -0.002891521582125349,
      -0.002425412910982621, -0.0018628466647773595, -0.0012398759476996077,
      -0.0005930111495024049, 4.26711974149654e-05, 0.000635210915002353,
      0.0011571672463972788, 0.0015866910312650427, 0.0019082350868438779,
      0.002112892549644359, 0.002198372629766251, 0.0021686410311907264,
      0.002033267426009327, 0.001806534258457787, 0.0015063694230197284,
      0.0011531698481666351, 0.0007685837662217215, 0.0003743166905507464,
      -8.979753760342296e-06, -0.00036268546731190517, -0.0006710157462103025,
      -0.000921622892433719, -0.0011059794258162896, -0.001219539047507752,
      -0.001261683107705571, -0.0012354707054386032, -0.0011472192545890314,
      -0.0010059490642215449, -0.000822730003496405, -0.0006099705788199964,
      -0.0003806897909543183, -0.00014781011968072167, 7.649384587224081e-05,
      0.0002813619269283156, 0.0004577072412394469, 0.000598551793212348,
      0.0006992305135673399, 0.0007574627911421764, 0.0007732973614909185,
      0.0007489424503836837, 0.0006884980642986125, 0.0005976110946090052,
      0.0004830763525611069, 0.00035240774848050414, 0.00021340361225658026,
      7.372872829110388e-05, -5.946681400175501e-05, -0.00017987517215857418,
      -0.0002822918592574617, -0.00036280187160215216, -0.00041888673213306965,
      -0.000449452671212685, -0.0004547841697036181, -0.00043643058985534764,
      -0.0003970364751137782, -0.0003401282113302538, -0.00026987105478891514,
      -0.0001908110373901485, -0.00010761598848989716, -2.482893578657316e-05,
      5.335443523689029e-05, 0.00012327464831498903, 0.0001819564211861974,
      0.00022721116050564535, 0.0002576920083540097, 0.000272902040602259,
      0.000273158561919017, 0.0002595184683636107, 0.00023367127588350673,
      0.00019780758731553126, 0.00015447146435224846, 0.00010640538350008478,
      5.639621003834538e-05, 7.129966720678732e-06, -3.8937832468451564e-05,
      -7.969079242496445e-05, -0.00011343516709028975, -0.00013895585287325942,
      -0.0001555439682783006, -0.00016299665374116317, -0.00016159109595065052,
      -0.00015203595070654755, -0.0001354042624052904, -0.00011305262710085206,
      -8.653170644281483e-05, -5.749327398986291e-05, -2.7598780193946614e-05,
      1.5660129659713918e-06, 2.8566412730311856e-05, 5.218106659641334e-05,
      7.144889101108796e-05, 8.56993672603991e-05, 9.45658544154779e-05,
      9.798245985877179e-05, 9.616580710108026e-05, 8.958371414218698e-05,
      7.891331821861328e-05, 6.49915386226033e-05, 4.8760952200891304e-05,
      3.1214169239300494e-05, 1.3339652232428193e-05, -3.928364709930788e-06,
      -1.975359782807688e-05, -3.343330520123e-05, -4.442451746157382e-05,
      -5.2360242814578326e-05, -5.705554013064026e-05, -5.8503877869088273e-05,
      -5.686466168821477e-05, -5.2443200308975305e-05, -4.566467345257031e-05,
      -3.704385910365461e-05, -2.715246734013855e-05, -1.6585917356245903e-05,
      -5.931290849935641e-06, 4.261989414309327e-06, 1.3507457117797217e-05,
      2.140187552801361e-05, 2.7639813697928845e-05, 3.2022191775223515e-05,
      3.445879280608031e-05, 3.4965046102041924e-05, 3.3653657289043104e-05,
      3.07218815133438e-05, 2.6435401153711347e-05, 2.1109873434229904e-05,
      1.5091255611268414e-05, 8.735998200213718e-06, 2.392125159544249e-06,
      -3.617898391367559e-06, -9.011766088647083e-06, -1.3558835567604698e-05,
      -1.708817480819204e-05, -1.9492987782483493e-05, -2.0731453746215512e-05,
      -2.0824194828939497e-05, -1.984874300725613e-05, -1.7931503834782958e-05,
      -1.5237806178164668e-05, -1.1960682458347122e-05, -8.309042333694594e-06,
      -4.495886089079362e-06, -7.27155582696771e-07, 2.8082548043328185e-06,
      5.9469013907919164e-06, 8.557294152771603e-06, 1.054430439463479e-05,
      1.1851402896818258e-05, 1.2460770201630371e-05, 1.2391426153694791e-05,
      1.1695616199843943e-05, 1.0453763749003497e-05, 8.768348771441218e-06,
      6.75710168706688e-06, 4.5459085626649e-06, 2.261809924771082e-06,
      2.6443281905984995e-08, -2.0497682933084906e-06, -3.872438897022825e-06,
      -5.366879020541663e-06, -6.480488295170392e-06, -7.183850717891706e-06,
      -7.470569675815183e-06, -7.355941634469926e-06, -6.874619445663646e-06,
      -6.077456888809399e-06, -5.027754033811913e-06, -3.797137788566658e-06,
      -2.4613137642932187e-06, -1.095915200565967e-06, 2.2734645843535378e-07,
      1.4440548040553776e-06, 2.4998477837528717e-06, 3.352466541137304e-06,
      3.973040355023153e-06, 4.34659702359002e-06, 4.471828279453387e-06,
      4.360175664934456e-06, 4.034332232875651e-06, 3.5262783653319617e-06,
      2.874985255020354e-06, 2.1239269460572584e-06, 1.3185414737085813e-06,
      5.037741491139722e-07, -2.781777015657115e-07, -9.898180652103012e-07,
      -1.5999257588861809e-06, -2.08469520498836e-06, -2.4284173872527e-06,
      -2.6236992886590263e-06, -2.6712437553413923e-06, -2.579232558243788e-06,
      -2.3623725770283684e-06, -2.04067789825299e-06, -1.6380688538915789e-06,
      -1.1808725398167513e-06, -6.963083066697044e-07, -2.1103648834693644e-07,
      2.501602074207846e-07, 6.655049662873213e-07, 1.0171209532058547e-06,
      1.29166245968751e-06, 1.4806698198471945e-06, 1.5806498348659663e-06,
      1.5928973100176105e-06, 1.523085382471382e-06, 1.3806621148602117e-06,
      1.1780980132673087e-06, 9.300335202894532e-07, 6.523771107297968e-07,
      3.614035009589116e-07, 7.289792329540577e-08, -1.986132293142424e-07,
      -4.4051237798205313e-07, -6.42596795274284e-07, -7.974252470570947e-07,
      -9.004990136745223e-07, -9.502799529909406e-07, -9.480563818306571e-07,
      -8.976745347030798e-07, -8.051589347883958e-07, -6.782489987340056e-07,
      -5.258815047961975e-07, -3.576491861179433e-07, -1.8326475552295185e-07,
      -1.2057287782974185e-08, 1.474756965154041e-07, 2.8804161583275675e-07,
      4.0383800165260283e-07, 4.907412595202906e-07, 5.463963174951488e-07,
      5.702097073923838e-07, 5.632533630059313e-07, 5.280904469300188e-07,
      4.685376794421957e-07, 3.8938084016279167e-07, 2.960613031211237e-07,
      1.9435166010006585e-07, 9.003774726769276e-08, -1.1377179105632303e-08,
      -1.0493263109932123e-07, -1.8642473926516624e-07, -2.5256619176578056e-07,
      -3.0108798099664907e-07, -3.3078194925290755e-07, -3.414862145480057e-07,
      -3.3401831940725965e-07, -3.100632621264822e-07, -2.720253554815955e-07,
      -2.228540593294972e-07, -1.6585453164406235e-07, -1.0449365011025683e-07,
      -4.221171545540725e-08, 1.775097482833296e-08, 7.250491114183778e-08,
      1.196334553302029e-07, 1.5728206133336229e-07, 1.8421244472384895e-07,
      1.9982145635932312e-07, 2.041262317923389e-07, 1.9771879401436999e-07,
      1.8169461582759255e-07, 1.5756065181732967e-07, 1.2712900071925805e-07,
      9.240264909764742e-08, 5.545968777896971e-08, 1.834201154395704e-08,
      -1.704614733980985e-08, -4.902538640562319e-08, -7.621058503163288e-08,
      -9.756037323412628e-08, -1.1240553044121194e-07, -1.2045637931389003e-07,
      -1.2179030552264715e-07, -1.1682146608653635e-07, -1.0625550858313263e-07,
      -9.10326848697613e-08, -7.226309154977575e-08, -5.1157902776790373e-08,
      -2.8960387767523212e-08, -6.88024415040191e-09, 1.3965644177324564e-08,
      3.2603466574581425e-08, 4.824184587153203e-08, 6.029907564286872e-08,
      6.841771658199585e-08, 7.246671543762662e-08, 7.253183415026148e-08,
      6.88957160569842e-08, 6.200934893457877e-08, 5.245699679273688e-08,
      4.091685647098766e-08, 2.8119751038016456e-08, 1.4808106090968688e-08,
      1.6972794098842578e-09, -1.0558954132634225e-08, -2.139730161796528e-08,
      -3.036716537097466e-08, -3.7145518300857427e-08, -4.1544209892444576e-08,
      -4.350987382684597e-08, -4.31169729933983e-08, -4.0554828948949414e-08,
      -3.610972865995515e-08, -3.0143373804239774e-08, -2.3069033488342933e-08,
      -1.5326780599148247e-08, -7.3591396389364525e-09, 4.1164239093596364e-10,
      7.603660176718994e-09, 1.3891918071762216e-08, 1.9020808443481603e-08,
      2.281215798544118e-08, 2.5168750047221625e-08, 2.6073468198226662e-08,
      2.5584418980598592e-08, 2.3826571031974e-08, 2.0980586742319513e-08,
      1.7269617155856602e-08, 1.2944879310226031e-08, 8.27083845631191e-09,
      3.510778704435503e-09, -1.0865303962017319e-09, -5.298470476616328e-09,
      -8.938042904719144e-09, -1.1860842340351636e-08, -1.3969358974184234e-08,
      -1.521458193470086e-08, -1.559501586780075e-08, -1.5153346490829938e-08,
      -1.3971093816412026e-08, -1.2161669987805e-08, -9.86231004803607e-09,
      -7.225367789590404e-09, -4.4094658637074246e-09, -1.570961642762259e-09,
      1.1438588889884349e-09, 3.605513637837642e-09, 5.706717239422297e-09,
      7.36625555017316e-09, 8.53125331575744e-09, 9.17783478291475e-09,
      9.310258941054455e-09, 8.958682956624097e-09, 8.175766254309656e-09,
      7.032371535326037e-09, 5.612646650935714e-09, 4.00878242427804e-09,
      2.315736847062437e-09, 6.261969446024624e-10, -9.739819834370921e-10,
      -2.4096615746876084e-09, -3.619480550071875e-09, -4.55799305772714e-09,
      -5.1968424015509806e-09, -5.524979575555654e-09, -5.54798403017569e-09,
      -5.286585729136344e-09, -4.774521151087124e-09, -4.055880313629312e-09,
      -3.1821165622632465e-09, -2.2088957262232545e-09, -1.1929567533292911e-09,
      -1.8914299677798534e-10, 7.522567958407955e-10, 1.5877445059124082e-09,
      2.282342083216728e-09, 2.8107626235079286e-09, 3.15800347973136e-09,
      3.319372665461071e-09, 3.299987883108882e-09, 3.1138115637056603e-09,
      2.782304402203998e-09, 2.3327933948379054e-09, 1.7966580440655886e-09,
      1.2074402225656215e-09, 5.989795062911787e-10, 3.6671806573656416e-12,
      -5.491006143808024e-10, -1.0342060594805987e-09, -1.4317826815161192e-09,
      -1.727850902137349e-09, -1.9146079427745914e-09, -1.9903821213988987e-09,
      -1.9592779601983268e-09, -1.83055238470369e-09, -1.617773108417747e-09,
      -1.337817730334769e-09, -1.0097759896747498e-09, -6.538180754788145e-10,
      -2.900891039339428e-10, 6.231577222820716e-11, 3.862491767472213e-10,
      6.672456100792132e-10, 8.940661749304086e-10, 1.05903975857834e-09,
      1.1581978940167614e-09, 1.1912112364644183e-09, 1.1611451327128431e-09,
      1.0740597261418344e-09, 9.38486137146157e-10, 7.648143105819091e-10,
      5.646300689471068e-10, 3.500388042038836e-10, 1.3301123517948404e-10,
      -7.52170100228983e-11, -2.646652500362107e-10, -4.270263330426098e-10,
      -5.559698828033512e-10, -6.473230319107453e-10, -6.991282251893622e-10,
      -7.115839711972439e-10, -6.868799633775276e-10, -6.289425559956213e-10,
      -5.431100013303931e-10, -4.3575904129303976e-10, -3.1390537590097074e-10,
      -1.8480024573669636e-10, -5.554396739371768e-11, 6.726509891319243e-11,
      1.7783080261891145e-10, 2.7139701955152834e-10, 3.444153935674352e-10,
      3.9463948415169e-10, 4.2114580434517996e-10, 4.242859246071842e-10,
      4.055770317031262e-10, 3.675409379423862e-10, 3.1350344584199097e-10,
      2.4736713922239384e-10, 1.733710878214065e-10, 9.585065136039687e-11,
      1.9009617444043684e-11, -5.328459909746642e-11, -1.176739131610809e-10,
      -1.7144415365078343e-10, -2.1261717041819154e-10, -2.399988186755627e-10,
      -2.531835424768078e-10, -2.525184389826995e-10, -2.390315434280656e-10,
      -2.1433055796032314e-10, -1.8047930714060018e-10, -1.3985981529562217e-10,
      -9.50280669716177e-11, -4.8571255045131434e-11, -2.97368501788821e-12,
      3.9502451692942304e-11, 7.691642640662503e-11, 1.0772480733991186e-10,
      1.3083160227646298e-10, 1.4561199836843853e-10, 1.5191038437145911e-10,
      1.5001460211205825e-10, 1.4060944571647084e-10, 1.2471326809223524e-10,
      1.0360213805463016e-10, 7.872630702196591e-11, 5.1623794549650703e-11,
      2.3835703601910774e-11, -3.1725426651563092e-12, -2.808045350857075e-11,
      -4.976936582168635e-11, -6.736496933708151e-11, -8.026432600159976e-11,
      -8.814711949436749e-11, -9.097169351703118e-11, -8.895717262319386e-11,
      -8.255357578721806e-11, -7.24023077454446e-11, -5.928973233977351e-11,
      -4.4096690558209295e-11, -2.7746827160614782e-11, -1.1156444928599957e-11,
      4.8116674486573e-12, 1.938836593046924e-11, 3.1930628541867815e-11,
      4.194527379043094e-11, 4.9103339999755516e-11, 5.3245063078714136e-11,
      5.4375873878643505e-11, 5.2654263744618435e-11, 4.8372720389410243e-11,
      4.193320309923308e-11, 3.381879913659995e-11, 2.4563279977019443e-11,
      1.4720259687184342e-11, 4.833555837678663e-12, -4.589822819571187e-12,
      -1.3102873782241515e-11, -2.0337074918556885e-11, -2.6015532788169214e-11,
      -2.996051734748661e-11, -3.2095401979696664e-11, -3.2441311561295244e-11,
      -3.110902925179549e-11, -2.8286914802963274e-11, -2.422573642013727e-11,
      -1.922141076040949e-11, -1.3596680872535927e-11, -7.682742091724792e-12,
      -1.801756056331063e-12, 3.748919734444389e-12, 8.710106226842264e-12,
      1.2871271359227738e-11, 1.6077767897520634e-11, 1.8234703585016556e-11,
      1.93074880974147e-11, 1.9319267466036528e-11, 1.8345600140194664e-11,
      1.6506844016440767e-11, 1.3958806734096893e-11, 1.0882260404668753e-11,
      7.471936664840248e-12, 3.925600219449512e-12, 4.3375210433664435e-13,
      -2.829557761741871e-12, -5.71442012495152e-12, -8.10097366731517e-12,
      -9.903356869855337e-12, -1.107164342118348e-11, -1.1591807274757104e-11,
      -1.1483860567159365e-11, -1.0798390449633086e-11, -9.611786258054894e-12,
      -8.020494274623989e-12, -6.134662685075154e-12, -4.071544386099438e-12,
      -1.9490112485586837e-12, 1.2049761998703124e-13, 2.0353163406989144e-12,
      3.7089603364646055e-12, 5.073444283236168e-12, 6.081419089981088e-12,
      6.707103766588173e-12, 6.946051190088059e-12, 6.813843409443502e-12,
      6.343859819895725e-12, 5.5842985005266e-12, 4.594656129578127e-12,
      3.441884740883577e-12, 2.196444387559793e-12, 9.284603596344413e-13,
      -2.9582670290592545e-13, -1.417157906618109e-12, -2.3857750692070623e-12,
      -3.1632746721085655e-12, -3.723750049322247e-12, -4.054214691443519e-12,
      -4.154336692757885e-12, -4.035547321270859e-12, -3.719614068514518e-12,
      -3.236789342813384e-12, -2.6236596175955646e-12, -1.92082615360575e-12,
      -1.1705475859757595e-12, -4.1446725839121607e-13, 3.0846495298728706e-13,
      9.637843726178938e-13, 1.5229460613320628e-12, 1.964354683596891e-12,
      2.273966266422766e-12, 2.445461910988562e-12, 2.4800153289853084e-12,
      2.385695206322436e-12, 2.176559064600802e-12, 1.8715069456958277e-12,
      1.4929705809611223e-12, 1.0655166600729499e-12, 6.144415494504186e-13,
      1.6442969379019756e-13, -2.6166049624992156e-13, -6.438305442526761e-13,
      -9.657558392848152e-13, -1.215353905736658e-12, -1.3850956835778142e-12,
      -1.47206240138785e-12, -1.477763404953899e-12, -1.4077413843224784e-12,
      -1.2710003793060235e-12, -1.079298435921317e-12, -8.463506786653607e-13,
      -5.869898441688448e-13, -3.16330112815173e-13, -4.897661669003772e-14,
      2.0168236756746914e-13, 4.2407040292395993e-13, 6.088828283327991e-13,
      7.493979005136205e-13, 8.416339643277621e-13, 8.843556936475556e-13,
      8.789399183513891e-13, 8.291179544206889e-13, 7.406164338026702e-13,
      6.207222247172742e-13, 4.777990649015765e-13, 3.207840084836503e-13,
      1.586907989074889e-13, 1.4498122095240707e-16, -1.47027831644849e-13,
      -2.761433700935779e-13, -3.8191744438803806e-13, -4.606347544212629e-13,
      -5.102256243187357e-13, -5.302533602548383e-13, -5.218192912405143e-13,
      -4.873962411557116e-13, -4.306040562727869e-13, -3.559427876968502e-13,
      -2.685001665302471e-13, -1.736501254734777e-13, -7.675837431193973e-14,
      1.7090471773659215e-14, 1.0333185130060102e-13, 1.7811655873725073e-13,
      2.3845557007121796e-13, 2.8231063390565406e-13, 3.0862990407510545e-13,
      3.173307426854635e-13, 3.0923436211498103e-13, 2.8595909392063463e-13,
      2.4978069392497603e-13, 2.0346916913420645e-13, 1.5011212781813396e-13,
      9.293462303210267e-14, 3.51249229066211e-14, -2.0325338148305424e-14,
      -7.075951293384722e-14, -1.1396729142987846e-13, -1.482653106273987e-13,
      -1.725451224898659e-13, -1.8628841839778378e-13, -1.8955108449135628e-13,
      -1.8291913783951533e-13, -1.674408075262356e-13, -1.4453993443703362e-13,
      -1.159164442425549e-13, -8.343989383024436e-14, -4.904201374784594e-14,
      -1.4613795269770315e-14, 1.808795919651418e-14, 4.752053900818398e-14,
      7.241858163925848e-14, 9.183865353104167e-14, 1.0518422391454465e-13,
      1.1221116621024525e-13, 1.1301490435527622e-13, 1.0800117666616496e-13,
      9.784308317956035e-14, 8.342759011124198e-14, 6.579497458538617e-14,
      4.6074802563156724e-14, 2.5421951684354098e-14, 4.955936376617978e-15,
      -1.4293609524874237e-14, -3.1432956168993023e-14, -4.574007121915192e-14,
      -5.668909361305026e-14, -6.396305278455989e-14, -6.745502885496767e-14,
      -6.725852437013871e-14, -6.364831267890735e-14, -5.705342259503267e-14,
      -4.8024200628343654e-14, -3.7195554560587835e-14, -2.524852574954365e-14,
      -1.287226858201047e-14, -7.283455573558405e-16, 1.0581008522691067e-14,
      2.0539320752946728e-14, 2.873604604949797e-14, 3.4879886985146134e-14,
      3.880508010501367e-14, 4.047083320690356e-14, 3.995443388793187e-14,
      3.74388348539736e-14, 3.319574516031714e-14, 2.756541171736289e-14,
      2.093435906364099e-14, 1.371236844776681e-14, 6.309924076399457e-15,
      -8.827575591049872e-16, -7.514160145862497e-15, -1.3286604589342653e-14,
      -1.7967555719835367e-14, -2.1396797363032903e-14, -2.348940666739195e-14,
      -2.4234677631181404e-14, -2.369133945717156e-14, -2.1979579386894605e-14,
      -1.927050594249428e-14, -1.5773773306296032e-14, -1.1724129551446109e-14,
      -7.367651535159929e-15, -2.9483904807823994e-15, 1.3039206262663586e-15,
      5.184547556295089e-15, 8.522394652528011e-15, 1.1186310102926094e-14,
      1.3088902893489674e-14, 1.4187855524173311e-14, 1.4484845338970035e-14,
      1.4022301097578866e-14, 1.287831547510918e-14, 1.1160105140074808e-14,
      8.996455970612071e-15, 6.529611283025331e-15, 3.907056467356943e-15,
      1.2736261596664062e-15, -1.2356869448129833e-15, -3.501905504444079e-15,
      -5.426981599254187e-15, -6.9372914057327154e-15, -7.985634257039321e-15,
      -8.551741562045719e-15, -8.641376608389144e-15, -8.28417227395127e-15,
      -7.530407439938511e-15, -6.446962574619249e-15, -5.112719529285377e-15,
      -3.6136798889353454e-15, -2.038070871696326e-15, -4.716890972301219e-16,
      1.0062975465077592e-15, 2.326908863672863e-15, 3.434136636383634e-15,
      4.286867941671769e-15, 4.859911278421397e-15, 5.144137608176045e-15,
      5.14579265305005e-15, 4.885074986327091e-15, 4.394105084253849e-15,
      3.714432562456911e-15, 2.894241789030758e-15, 1.9854199399351243e-15,
      1.0406467963244107e-15, 1.1065304085849825e-16, -7.582253116579626e-16,
      -1.5260929680106565e-15, -2.1610662952855622e-15, -2.6403231857742655e-15,
      -2.950615744592751e-15, -3.0882582295304145e-15, -3.058628524083613e-15,
      -2.8752434694751806e-15, -2.5584857694448662e-15, -2.134072360810722e-15,
      -1.6313608664222675e-15, -1.0815920640870183e-15, -5.161625363233504e-16,
      3.498663150316388e-17, 5.447913150365533e-16, 9.902371588065118e-16,
      1.3532418047786647e-15, 1.6212224367807865e-15, 1.7873423040354964e-15,
      1.8504467026241585e-15, 1.81471396822978e-15, 1.6890597236635199e-15,
      1.4863424548690587e-15, 1.2224251636165818e-15, 9.151512502922322e-16,
      5.832929771862809e-16, 2.455280717279085e-16, -8.050539307857213e-17,
      -3.790332919815788e-16, -6.368155775787183e-16, -8.43639159997472e-16,
      -9.926211396890637e-16, -1.0803205519828288e-15, -1.1066666733660668e-15,
      -1.0747207105105544e-15, -9.90294977259309e-16, -8.614591976058452e-16,
      -6.979671978777482e-16, -5.106389210506966e-16, -3.107324656345244e-16,
      -1.0933886903209145e-16, 8.317115252340296e-17, 2.576240401401421e-16,
      4.0642498841842026e-16, 5.238316899507667e-16, 6.061140184324589e-16,
      6.515996994849767e-16, 6.606118253753464e-16, 6.353091616046527e-16,
      5.794443616809594e-16, 4.980583051320464e-16, 3.971307218011591e-16,
      2.8320804602651277e-16, 1.6302910144968443e-16, 4.316784904119351e-17,
      -7.028981920276514e-17, -1.7202121256463797e-16, -2.576833286124201e-16,
      -3.240638712583431e-16, -3.69163802626118e-16, -3.92212135985844e-16,
      -3.9361707956416816e-16, -3.748605898961443e-16, -3.3834577083248263e-16,
      -2.8720828020138386e-16, -2.251039392576345e-16, -1.559850775053728e-16,
      -8.387781999245465e-17, -1.2671599917981452e-17, 5.406925354576828e-17,
      1.1326383439737223e-16, 1.6243697729769158e-16, 1.9980192372419085e-16,
      2.2430196989695816e-16, 2.3561191818323445e-16, 2.341021433099806e-16,
      2.2076978824328747e-16, 1.9714295574510572e-16, 1.6516471682437332e-16,
      1.270642963001824e-16, 8.522292089433856e-17, 4.2041549991318055e-17,
      -1.8290500636542945e-19, -3.936717359078126e-17, -7.373246434958647e-17,
      -1.0187326512162494e-16, -1.2280218061345876e-16, -1.3597024236725847e-16,
      -1.412634165788483e-16, -1.3897719625855887e-16, -1.2977214574085953e-16,
      -1.1461403044205311e-16, -9.470268960498811e-17, -7.139408503848053e-17,
      -4.611998844210591e-17, -2.030956993181856e-17, 4.683252482187901e-18,
      2.7643413371664294e-17, 4.75466585505594e-17, 6.359804950816726e-17,
      7.525601698957866e-17, 8.22417751192229e-17, 8.453466709717728e-17,
      8.23546895030412e-17, 7.613400616896348e-17, 6.64796937364667e-17,
      5.4130246947909886e-17, 3.990850829375579e-17, 2.467367760244894e-17,
      9.274913432582245e-18, -5.49122329962859e-18, -1.891759037873994e-17,
      -3.041608513913375e-17, -3.953907231616223e-17, -4.5992114926916485e-17,
      -4.9637983621928546e-17, -5.049236620227438e-17, -4.871209172617971e-17,
      -4.457700666189224e-17, -3.846688241883982e-17, -3.083488780530411e-17,
      -2.217922495056854e-17, -1.3014506085227187e-17, -3.844348555364245e-18,
      4.863502686436602e-18, 1.2698438659710712e-17, 1.932381171925152e-17,
      2.448878377715353e-17, 2.8034950800770584e-17, 2.9897780928955584e-17,
      3.0103165191042016e-17, 2.875960743683249e-17, 2.6046764532417726e-17,
      2.2201182844948532e-17, 1.750015920244254e-17, 1.22446834752732e-17,
      6.742398027052666e-18, 1.291441290943227e-18, -3.834064583279545e-18,
      -8.396260404459372e-18, -1.2203069419127365e-17, -1.511470019447292e-17,
      -1.7047018018359794e-17, -1.7971837771261043e-17, -1.791434432023426e-17,
      -1.6947978089865615e-17, -1.5187228414855067e-17, -1.2778852138157091e-17,
      -9.89207803204204e-18, -6.708369068545563e-18, -3.4112960398887857e-18,
      -1.7703062434686607e-19, 2.8341020478371944e-18, 5.484656858075555e-18,
      7.665431228625304e-18, 9.299003356923694e-18, 1.034139677752185e-17,
      1.078192090958303e-17, 1.0641326643866562e-17, 9.968491915401057e-18,
      8.83591169812251e-18, 7.334308091067471e-18, 5.566698351290891e-18,
      3.64226210308425e-18, 1.6703346945893799e-18, -2.4517622609766643e-19,
      -2.0106967362917003e-18, -3.547013854873387e-18, -4.792281784052446e-18,
      -5.703927249831805e-18, -6.259435858539307e-18, -6.4560597134716886e-18,
      -6.309538624667198e-18, -5.851970889129844e-18, -5.1290032003064335e-18,
      -4.196531775104682e-18, -3.117117909337796e-18, -1.9563211401126868e-18,
      -7.791428086966304e-19, 3.532466478223969e-19, 1.3863502494058152e-18,
      2.2746428770283955e-18, 2.9832474491302814e-18, 3.48894810807595e-18,
      3.7805363691667925e-18, 3.8585204706602576e-18, 3.734258447023356e-18,
      3.4286004731598545e-18, 2.970144896617636e-18, 2.393224568032743e-18,
      1.7357454550772843e-18, 1.0369982974259429e-18, 3.355567662575904e-19,
      -3.3263696126471493e-19, -9.35915096980768e-19, -1.448191366913158e-18,
      -1.849889850867152e-18, -2.12847535167397e-18, -2.2785868660935327e-18,
      -2.301795844368878e-18, -2.206028491279132e-18, -2.0047056660077666e-18
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_4_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<4>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 2.9197290346000113e-05), "design.b()[0] == 2.9197290346000113e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 2.9197290346000113e-05));
    static_assert(almost_equal(design.b()[1], 0.00011678916138400045), "design.b()[1] == 0.00011678916138400045");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.00011678916138400045));
    static_assert(almost_equal(design.b()[2], 0.00017518374207600067), "design.b()[2] == 0.00017518374207600067");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.00017518374207600067));
    static_assert(almost_equal(design.b()[3], 0.00011678916138400045), "design.b()[3] == 0.00011678916138400045");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.00011678916138400045));
    static_assert(almost_equal(design.b()[4], 2.9197290346000113e-05), "design.b()[4] == 2.9197290346000113e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 2.9197290346000113e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.7924678746144798), "design.a()[1] == -3.7924678746144798");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.7924678746144798));
    static_assert(almost_equal(design.a()[2], 5.4556356635217735), "design.a()[2] == 5.4556356635217735");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 5.4556356635217735));
    static_assert(almost_equal(design.a()[3], -3.5265749430978452), "design.a()[3] == -3.5265749430978452");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -3.5265749430978452));
    static_assert(almost_equal(design.a()[4], 0.8640670304915903), "design.a()[4] == 0.8640670304915903");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.8640670304915903));
    std::cout << "max_deviation(cheby1,lowpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      2.9197290346000113e-05, 0.00022751894704699737, 0.000878752261128013, 0.00231113483236086,
      0.004777083922534976, 0.008410621780245053, 0.0132260728248077, 0.01912393720932057,
      0.025903250217866963, 0.03327940646655056, 0.04090616852587656, 0.048400402755560595,
      0.05536799717133431, 0.061429418171395855, 0.06624345101223478, 0.06952783449258443,
      0.07107573087975591, 0.07076725210092835, 0.06857557493278815, 0.06456750264095099,
      0.05889864958979557, 0.05180372120256699, 0.04358261876641334, 0.03458330421977801,
      0.025182504900989472, 0.015765416723783218, 0.006705574752664999,
      -0.0016539950917490824, -0.009017344659827052, -0.015149060238048177,
      -0.019883980877820978, -0.02313278449829735, -0.02488329287419204,
      -0.025197589972653686, -0.02420527632302512, -0.02209338310507633,
      -0.019093633355615633, -0.015467856543260314, -0.0114924319803133,
      -0.007442654322375612, -0.003577881881086601, -0.0001282495263936704,
      0.0027163911124691046, 0.004814792347057156, 0.006079553276089961,
      0.00647913067084183, 0.0060366492984260806, 0.004825719101064472,
      0.0029636237928945125, 0.0006023757542673071, -0.00208177053043908,
      -0.004899693871683843, -0.007660996423566168, -0.01018515101636952,
      -0.012311601077486991, -0.013908292540664793, -0.014878226673499105,
      -0.015163750562392143, -0.014748440208198696, -0.0136565716790025,
      -0.011950310624786464, -0.009724872411208223, -0.007102007926192505,
      -0.004222248829792573, -0.0012363972760458773, 0.0017032327744840974,
      0.0044513226263407, 0.006877338947124721, 0.008872200697279238, 0.010353496043515965,
      0.011269016679601777, 0.011598480306181172, 0.011353418275586225,
      0.010575308550272777, 0.009332128540765892, 0.00771358318582701, 0.005825326880449174,
      0.0037825407531586717, 0.0017032477983767447, -0.00029825277968632737,
      -0.002117472976010711, -0.003665027483936948, -0.004870868954828208,
      -0.00568727612969587, -0.0060904811377207775, -0.006080902566781506,
      -0.00568202974997532, -0.0049380767543749995, -0.003910587980686258,
      -0.002674227955841938, -0.0013120235350017103, 8.96540330706918e-05,
      0.0014460772719291919, 0.00267884474317283, 0.0037200098390164343,
      0.004515449668669881, 0.0050273185149846186, 0.005235487778272209,
      0.005137934828152927, 0.004750103257933409, 0.004103313354663941,
      0.003242351184134259, 0.002222405064471614, 0.0011055475011898727,
      -4.302228924928878e-05, -0.0011587557707855845, -0.002181340928180518,
      -0.00305790455897863, -0.003745668366188181, -0.004213933381866264,
      -0.004445309871967777, -0.004436155333880018, -0.004196228851621447,
      -0.003747613370695067, -0.003122996083096725, -0.002363429116923433,
      -0.0015157165983072877, -0.0006295889050016382, 0.00024516988131293273,
      0.0010614795845963114, 0.0017774579593634035, 0.0023585233073552814,
      0.0027790049354959982, 0.003023192261720085, 0.003085787473822134,
      0.002971761283368816, 0.0026956445419803916, 0.002280318510537057,
      0.0017553918552576132, 0.0011552717779457376, 0.0005170492422012013,
      -0.00012167638408437827, -0.0007249097864390716, -0.001260194409330543,
      -0.0017002692200273391, -0.0020243669696207323, -0.0022190966851821743,
      -0.0022788786404550985, -0.00220592627230238, -0.0020097949479794975,
      -0.0017065407611529578, -0.0013175524373439575, -0.0008681349946647295,
      -0.0003859343474203686, 0.00010070281948973067, 0.0005643399000042036,
      0.0009799434753160151, 0.0013261804497148272, 0.0015864551438622898,
      0.0017496394140021987, 0.001810467903554591, 0.0017695903325300267,
      0.0016332921567659099, 0.001412912917490924, 0.0011240072108334815,
      0.0007853056667999712, 0.0004175420753936552, 4.221750129768608e-05,
      -0.00031962720582705056, -0.0006485625304240457, -0.0009277841371240689,
      -0.0011439387097977182, -0.0012877236191142062, -0.0013542364256511836,
      -0.0013430651438263753, -0.0012581249956172928, -0.0011072612531058488,
      -0.0009016499722216617, -0.000655038346763827, -0.0003828736039924083,
      -0.00010137353413221034, 0.00017340721060439963, 0.00042646292452576764,
      0.0006446274711843258, 0.0008172296878259776, 0.0009365827260422043,
      0.0009982870049431766, 0.0010013376689010345, 0.0009480386985595427,
      0.0008437364932459396, 0.0006963952558016943, 0.0005160443858349987,
      0.0003141339542982193, 0.0001028379480460639, -0.0001056537700534922,
      -0.00029981491374923993, -0.00046939701512313916, -0.0006059469828928524,
      -0.000703203193328994, -0.0007573531196306462, -0.0007671439174468321,
      -0.0007338459241434422, -0.0006610772168284726, -0.0005545047680796016,
      -0.00042144396026208564, -0.00027038297172348857, -0.00011046162758961923,
      4.90643875001783e-05, 0.0001993435264525378, 0.00033240430127003633,
      0.0004415624718348267, 0.0005217396941982098, 0.0005696795710302758,
      0.0005840533406777969, 0.0005654539056533464, 0.0005162831694994444,
      0.00044054338216576675, 0.0003435480916662017, 0.00023157212591924095,
      0.00011146261490712305, -9.765682798363977e-06, -0.0001253275779335382,
      -0.0002290353801268293, -0.0003156183004166779, -0.0003809775684257299,
      -0.00042236573792439397, -0.00043848335215976677, -0.00042949102283185094,
      -0.0003969397645753798, -0.000343626857727734, -0.00027338835428335467,
      -0.00019084240589957533, -0.0001010997404458766, -9.458763431303583e-06,
      7.889710983317236e-05, 0.00015918314109826436, 0.00022726297704175565,
      0.00027985189416371, 0.0003146642010715792, 0.00033049891584771324,
      0.0003272615155707349, 0.00030592320416704237, 0.000268422561784368,
      0.0002175174432911221, 0.00015659743525949844, 8.946894737934445e-05,
      2.012603541318885e-05, -4.7479697317781e-05, -0.00010965727619353707,
      -0.00016317096269283823, -0.0002054014418381879, -0.0002344660077350664,
      -0.00024929276205450904, -0.000249646606648905, -0.00023610758637891943,
      -0.0002100047668860851, -0.0001733111742604459, -0.00012850726088093668,
      -7.842180315613103e-05, -2.6060022848847276e-05, 2.5570972095684968e-05,
      7.36296015449479e-05, 0.0001155910621473526, 0.00014937466572772818,
      0.0001734411739714169, 0.0001868559591028795, 0.00018931589530439205,
      0.00018113999105559054, 0.00016322578997435885, 0.00013697538849235234,
      0.00010419644964854786, 6.69847602736237e-05, 2.7595633946936066e-05,
      -1.1688220532555881e-05, -4.868486528473401e-05, -8.14303664734242e-05,
      -0.00010827902468597258, -0.00012798173120401915, -0.000139738998476631,
      -0.0001432267658876108, -0.0001385946758532138, -0.0001264380599812323,
      -0.00010774628655098708, -8.383132591679819e-05, -5.6241331083477155e-05,
      -2.6664665301092918e-05, 3.1698855229692112e-06, 3.15910038662203e-05,
      5.707546620433976e-05, 7.832676169315661e-05, 9.433782759844214e-05,
      0.00010443507010757399, 0.00010830199826483098, 0.00010598200278536944,
      9.786099155255454e-05, 8.463168501480334e-05, 6.724232041662576e-05,
      4.683326724752731e-05, 2.4665583530156455e-05, 2.045823652670507e-06,
      -1.9748562036040536e-05, -3.9539108896753785e-05, -5.630780801946723e-05,
      -6.924709320977444e-05, -7.779604019550977e-05, -8.166133635274109e-05,
      -8.082248667154148e-05, -7.552162113719016e-05, -6.623911046754798e-05,
      -5.365693677461081e-05, -3.861236629053701e-05, -2.2044905170831065e-05,
      -4.939769340309003e-06, 1.172884088800333e-05, 2.7051496539275553e-05,
      4.023145791329596e-05, 5.0624330626180116e-05, 5.776759613789918e-05,
      6.139879405686003e-05, 6.146181584076527e-05, 5.810145356586254e-05,
      5.164699507508762e-05, 4.2586233511129326e-05, 3.1531735847189856e-05,
      1.918156918111605e-05, 6.276900636318568e-06, -6.441039670124626e-06,
      -1.8272211112252033e-05, -2.8595008925039086e-05, -3.689759812879929e-05,
      -4.280183690615893e-05, -4.607876596774751e-05, -4.665515231785681e-05,
      -4.4611094910397504e-05, -4.0169196782357934e-05, -3.3676256616339134e-05,
      -2.557880938862774e-05, -1.639413281807149e-05, -6.6785214932262396e-06,
      3.0052922501431184e-06, 1.2119722212450399e-05, 2.0181200667426966e-05,
      2.6784845048910784e-05, 3.162372100201027e-05, 3.450185429803536e-05,
      3.534052719988749e-05, 3.4177787881135586e-05, 3.1161482163789996e-05,
      2.6536464476174243e-05, 2.062694156928073e-05, 1.381513377844026e-05,
      6.517594324587806e-06, -8.393982109187546e-07, -7.84396631780645e-06,
      -1.4120956239867119e-05, -1.9351289583547163e-05, -2.3287390364086226e-05,
      -2.5763992016859978e-05, -2.6703914901187367e-05, -2.611870172880669e-05,
      -2.4104289183605595e-05, -2.083216283020324e-05, -1.6536675190249785e-05,
      -1.149939214018948e-05, -6.031462215800807e-06, -4.550721142076124e-07,
      4.914941637336244e-06, 9.788308019495423e-06, 1.3914454561050068e-05,
      1.709480243427109e-05, 1.9191657284400213e-05, 2.0133342448360852e-05,
      1.991544500959111e-05, 1.8598266839817285e-05, 1.6300780143536452e-05,
      1.3191569102755613e-05, 9.477386935643815e-06, 5.390064240486107e-06,
      1.1725656756579723e-06, -2.9349936921192337e-06, -6.708592501614993e-06,
      -9.952101358841051e-06, -1.2507038738666362e-05, -1.4259826458262747e-05,
      -1.5146244834432717e-05, -1.5152955934151721e-05, -1.4316131956026052e-05,
      -1.2717385341857619e-05, -1.0477339209167043e-05, -7.747293945428645e-06,
      -4.699532815832376e-06, -1.5168626227028832e-06, 1.617996738297635e-06,
      4.532577073497303e-06, 7.073833879062546e-06, 9.115856344228245e-06,
      1.0565747044693448e-05, 1.136742016035748e-05, 1.1503193320983843e-05,
      1.099317615740921e-05, 9.892581121955772e-06, 8.28719255137778e-06,
      6.2873226363672645e-06, 4.020653511239121e-06, 1.6244100796677803e-06,
      -7.626730346365272e-07, -3.008134818047718e-06, -4.992898708405834e-06,
      -6.617343166375261e-06, -7.806037366360056e-06, -8.510933922662517e-06,
      -8.712905077867918e-06, -8.421605685601737e-06, -7.673740126585032e-06,
      -6.52989591366105e-06, -5.070179743845507e-06, -3.388948604931109e-06,
      -1.5889667481431346e-06, 2.246624546295006e-07, 1.95044272286107e-06,
      3.4959833061293532e-06, 4.78276226295589e-06, 5.749920044537325e-06,
      6.356912555779045e-06, 6.5849234335077505e-06, 6.437008496958558e-06,
      5.937017004157659e-06, 5.1274005645675825e-06, 4.0660778552614305e-06,
      2.8225688469358585e-06, 1.4736440195406885e-06, 9.875083972018964e-08,
      -1.2245187284825175e-06, -2.4246691501856624e-06, -3.4400267878874804e-06,
      -4.221764002938632e-06, -4.736082736725279e-06, -4.965470974366261e-06,
      -4.9090006857608505e-06, -4.581690485591852e-06, -4.013007336939181e-06,
      -3.244626447762262e-06, -2.327604841174409e-06, -1.3191502501339224e-06,
      -2.7918196074647786e-07, 7.331163623249026e-07, 1.6625596990997184e-06,
      2.4608666087253105e-06, 3.08905929169884e-06, 3.5192461908660075e-06,
      3.735713581613975e-06, 3.7352941122417706e-06, 3.5270218244675976e-06,
      3.1311224956681272e-06, 2.577423104819478e-06, 1.9032930684438536e-06,
      1.1512512700580319e-06, 3.6638593724857507e-07, -4.0626127383347285e-07,
      -1.1241999231888604e-06, -1.7497493995686104e-06, -2.251936030076736e-06,
      -2.607938130905906e-06, -2.804017362696986e-06, -2.835905901999124e-06,
      -2.708650490934106e-06, -2.43594460790887e-06, -2.039007190419845e-06,
      -1.5450891479479344e-06, -9.85706241460867e-07, -3.9470803841524514e-07,
      1.937027832994869e-07, 7.46888493464753e-07, 1.2355275915737847e-06,
      1.6351087822799263e-06, 1.9270951940188718e-06, 2.0997077515902145e-06,
      2.1482999301801527e-06, 2.0753200118519653e-06, 1.8898800822768068e-06,
      1.6069720912439943e-06, 1.2463892662266943e-06, 8.314251438105322e-07,
      3.874318571515716e-07, -5.967624161478725e-08, -4.848880791437459e-07,
      -8.654502064174181e-07, -1.1820392402271021e-06, -1.4196947111940376e-06,
      -1.5684703590823266e-06, -1.6237793278472063e-06, -1.5864267672551365e-06,
      -1.4623410135763398e-06, -1.262030831836642e-06, -9.998103050909118e-07,
      -6.928441590018569e-07, -3.600741097233269e-07, -2.1090927023548694e-08,
      3.0498276210193494e-07, 6.005372032828147e-07, 8.503926492557934e-07,
      1.0425431611985538e-06, 1.16869288536256e-06, 1.224563582752222e-06,
      1.2099658011089735e-06, 1.1286395480151136e-06, 9.878829078471497e-07,
      7.979980800780647e-07, 5.715932523243571e-07, 3.227851484703443e-07,
      6.635075675389003e-08, -1.8312244430465476e-07, -4.1204040957976666e-07,
      -6.085177669362118e-07, -7.62968253885061e-07, -8.685426783270642e-07,
      -9.213963654157064e-07, -9.20778291105984e-07, -8.689443501660938e-07,
      -7.70906891697404e-07, -6.340412628917382e-07, -4.6757719760295464e-07,
      -2.820081382459683e-07, -8.845477189506715e-08, 1.0197989785520164e-07,
      2.788277012021897e-07, 4.328114840868404e-07, 5.563119030671127e-07,
      6.43722569473352e-07, 6.916784175464377e-07, 6.991498547623364e-07,
      6.674030309738494e-07, 5.998339995367664e-07, 5.016912385921243e-07,
      3.7970661237730765e-07, 2.4165911354989143e-07, 9.589845700817855e-08,
      -4.9143294684795975e-08, -1.854243988739271e-07, -3.0572474186323325e-07,
      -4.0401350523989046e-07, -4.757353728035369e-07, -5.180027348682222e-07,
      -5.296870990869281e-07, -5.114088082591591e-07, -4.65429862195968e-07,
      -3.954598337046549e-07, -3.0638929004947525e-07, -2.0396856685911649e-07,
      -9.445204114401762e-08, 1.5770866929431154e-08, 1.2053687730495486e-07,
      2.1424244307717064e-07, 2.921323350140742e-07, 3.5052902765206695e-07,
      3.8699258098603554e-07, 4.004050078798007e-07, 3.9097756939319375e-07,
      3.6018379402247394e-07, 3.1062503417334467e-07, 2.4583884444451985e-07,
      1.7006322100459458e-07, 8.797165596531891e-08, 4.394963542719743e-09,
      -7.595409197894114e-08, -1.487381583583448e-07, -2.1022107354441625e-07,
      -2.574508074139911e-07, -2.883911659974988e-07, -3.0199705749726514e-07,
      -2.9823147626810954e-07, -2.780256809426218e-07, -2.4318714281533084e-07,
      -1.9626255708226707e-07, -1.4036540732276428e-07, -7.897915195037507e-08,
      -1.5747998149716153e-08, 4.573257753546211e-08, 1.0211389385503568e-07,
      1.504701666275384e-07, 1.8844375998347004e-07, 2.1435278550313826e-07,
      2.2725662559800423e-07, 2.2697748279298553e-07, 2.1407858260417887e-07,
      1.8980204386713173e-07, 1.5597154967587373e-07, 1.1486669768914797e-07,
      6.907719883063564e-08, 2.134587546722288e-08, -2.5590338414295635e-08,
      -6.915246364393455e-08, -1.0705643443251428e-07, -1.3742795494529552e-07,
      -1.588897803217631e-07, -1.7061771056553084e-07, -1.7236348106363485e-07,
      -1.6444465116174797e-07, -1.477034245746223e-07, -1.2343798402287115e-07,
      -9.331130324594453e-08, -5.924344673529617e-08, -2.3294036742711914e-08,
      1.245816319176814e-08, 4.603172718998718e-08, 7.564878996626541e-08,
      9.982552849487126e-08, 1.1744252106221977e-07, 1.277919042049262e-07,
      1.3059966717712044e-07, 1.2602287617326706e-07, 1.1462302433023635e-07,
      9.731798244964576e-08, 7.531611343465755e-08, 5.003695800354729e-08,
      2.3023463440681854e-08, -4.1490087756667774e-09, -2.996169889748673e-08,
      -5.303461673651763e-08, -7.21975732446861e-08, -8.654658557888872e-08,
      -9.548312435703959e-08, -9.873473181206642e-08, -9.635663739013573e-08,
      -8.87150703516935e-08, -7.645395843697375e-08, -6.044755605477319e-08,
      -4.1742222810115296e-08, -2.1491043163045254e-08, -8.85223068567409e-10,
      1.8913784706547812e-08, 3.683767961983076e-08, 5.196689451173084e-08,
      6.357559057731927e-08, 7.116400197587091e-08, 7.447685565578113e-08,
      7.350741983635494e-08, 6.8487552909311e-08, 5.986488815803991e-08,
      4.826895841720489e-08, 3.4468605337573135e-08, 1.932340552507327e-08,
      3.732065272585229e-09, -1.141921832850182e-08, -2.5305554782940643e-08,
      -3.720671855581332e-08, -4.654288146847117e-08, -5.2901047432518624e-08,
      -5.605110469641282e-08, -5.5951033636718355e-08, -5.274143081535284e-08,
      -4.673009789945307e-08, -3.8367965832733174e-08, -2.8218054063964043e-08,
      -1.691948162009505e-08, -5.148738389582234e-09, 6.419514295743447e-09,
      1.7149912767252737e-08, 2.6480116535566823e-08, 3.3949068911165045e-08,
      3.921844705960159e-08, 4.208639073734841e-08, 4.2493066485221404e-08,
      4.051809682904456e-08, 3.6370335523971165e-08, 3.037087583868967e-08,
      2.2930518608259555e-08, 1.4523184134781665e-08, 5.65691608447784e-09,
      -3.155808937074674e-09, -1.1426785006058026e-08, -1.8718237331132796e-08,
      -2.4665089354831248e-08, -2.899225908617385e-08, -3.1526228631326684e-08,
      -3.220048099673296e-08, -3.105475639129947e-08, -2.8228426185427916e-08,
      -2.3948597651514812e-08, -1.851383037144169e-08, -1.2274552811763778e-08,
      -5.611405981713386e-09, 1.087194525064528e-09, 7.446996954478221e-09,
      1.3128152156096002e-08, 1.7842697007923043e-08, 2.136842401624007e-08,
      2.3558515381220982e-08, 2.4346581356705825e-08, 2.374701344814442e-08,
      2.1850827439648477e-08, 1.8817414963193373e-08, 1.4862832618117256e-08,
      1.0245424202933033e-08, 5.249686982576989e-09, 1.693527895095992e-10,
      -4.709341880339803e-09, -9.123273605222787e-09, -1.2846114683044505e-08,
      -1.5699399635964022e-08, -1.7560468408709243e-08, -1.8366973978325102e-08,
      -1.8117846258313935e-08, -1.687080588000006e-08, -1.4736709546231932e-08,
      -1.187117327322925e-08, -8.464052780270769e-09, -4.727455471662888e-09,
      -8.830121526895233e-10, 2.85085243363579e-09, 6.2709418021618415e-09,
      9.199962998949773e-09, 1.1495316829007172e-08, 1.3055592174801174e-08,
      1.3824498379332097e-08, 1.3792123292048481e-08, 1.2993558073190703e-08,
      1.1505074685383988e-08, 9.438170470407658e-09, 6.931899844560461e-09,
      4.143991017909143e-09, 1.2412925708082254e-09, -1.609890620578992e-09,
      -4.253029704528535e-09, -6.549676576168412e-09, -8.386417379481967e-09,
      -9.680143961617547e-09, -1.038141980292316e-08, -1.0475832273438266e-08,
      -9.983339621113722e-09, -8.955732341520119e-09, -7.472428543067716e-09,
      -5.634906511401896e-09, -3.56014092016044e-09, -1.373449358450613e-09,
      7.988282338170047e-10, 2.836402889559926e-09, 4.6314793365684265e-09,
      6.094235777382355e-09, 7.157075781587168e-09, 7.777466684610975e-09,
      7.93926525943177e-09, 7.652519733941047e-09, 6.951822472437389e-09,
      5.893365208049085e-09, 4.550914606071338e-09, 3.0109769743258248e-09,
      1.367454892776504e-09, -2.838857693078185e-10, -1.850822659235806e-09,
      -3.2496619217603863e-09, -4.4095414643287465e-09, -5.2758413509966834e-09,
      -5.812548630334581e-09, -6.003488432413543e-09, -5.852399925212331e-09,
      -5.381900894123386e-09, -4.631444738467533e-09, -3.6544254390264416e-09,
      -2.514627003691947e-09, -1.2822422143426325e-09, -2.970012620873261e-11,
      1.1724575341174518e-09, 2.259423624036648e-09, 3.175493873831485e-09,
      3.876788661766343e-09, 4.333203667537165e-09, 4.529512886197959e-09,
      4.465597835004175e-09, 4.155826500338623e-09, 3.627651910791768e-09,
      2.919540747032586e-09, 2.078375095685028e-09, 1.1564938286617048e-09,
      2.0855322781799658e-10, -7.116109285289692e-10, -1.5539452522677156e-09,
      -2.2748070886889626e-09, -2.839126905411082e-09, -3.222003747755306e-09,
      -3.4096685265029287e-09, -3.399787794424744e-09, -3.201118505939026e-09,
      -2.832559936216869e-09, -2.321680565874199e-09, -1.7028237232081937e-09,
      -1.014914906116633e-09, -2.9910520060196863e-10, 4.0361125036302806e-10,
      1.0546720610594177e-09, 1.6199915814788243e-09, 2.0716717850399546e-09,
      2.389297734131672e-09, 2.5607627893383618e-09, 2.5825971761882947e-09,
      2.4598022577668446e-09, 2.2052202715680136e-09, 1.8384939041700664e-09,
      1.3846906439829777e-09, 8.726823940851576e-10, 3.333806879018054e-10,
      -2.0206828255480677e-10, -7.04026709146641e-10, -1.1459518528888137e-09,
      -1.5057445685146323e-09, -1.7667945170524268e-09, -1.918676501258834e-09,
      -1.9574736668732936e-09, -1.8857250854363665e-09, -1.7120162408851166e-09,
      -1.4502500451232658e-09, -1.118652223257101e-09, -7.385774547555864e-10,
      -3.331909867389809e-10, 7.389573849979729e-11, 4.5995760357313295e-10,
      8.043836519129559e-10, 1.0897362592765775e-09, 1.3025897048956085e-09,
      1.4341106404803488e-09, 1.48035887676528e-09, 1.4423033682420007e-09,
      1.3255643387042845e-09, 1.1399072759486103e-09, 8.985272636260794e-10,
      6.171721878676784e-10, 3.1316030645416387e-10, 4.351241796505423e-12,
      -2.918704027489078e-10, -5.595427656603701e-10, -7.849559006512565e-10,
      -9.573211821508764e-10, -1.0692503278882036e-09, -1.1170252903661798e-09,
      -1.100652686113921e-09, -1.023708685159572e-09, -8.929916980588077e-10,
      -7.180101736438967e-10, -5.103408620546834e-10, -2.828986374366484e-10,
      -4.916218913930399e-11, 1.7759949464679655e-10, 3.850568373544341e-10,
      5.624667899623317e-10, 7.012047716262164e-10, 7.951566173800855e-10,
      8.40954536967974e-10, 8.380504342429775e-10, 7.886292637957391e-10,
      6.973738922406712e-10, 5.711007189738561e-10, 4.1829170353762187e-10,
      2.485531462073137e-10, 7.203438385807241e-11, -1.0115958383363744e-10,
      -2.6152859818653094e-10, -4.006808994528899e-10, -5.117540816048733e-10,
      -5.897334495013791e-10, -6.316543242279869e-10, -6.366818596753564e-10,
      -6.060690173765902e-10, -5.430001002672454e-10, -4.5233330724384773e-10,
      -3.402608306371975e-10, -2.1390883796746125e-10, -8.090209662405222e-11,
      5.108106086193875e-11, 1.7473826335405284e-10, 2.835338604872383e-10,
      3.720307796201024e-10, 4.3614745955833275e-10, 4.73328675330956e-10,
      4.826243250000021e-10, 4.646756177433076e-10, 4.216132788898228e-10,
      3.568770921059096e-10, 2.74970089328127e-10, 1.8116378291471824e-10,
      8.11728778875737e-11, -1.9181165429904013e-11, -1.14298532340621e-10,
      -1.991034765483791e-10, -2.6930501414538294e-10, -3.2160311476136245e-10,
      -3.5383117962171003e-10, -3.650295245545144e-10, -3.5544864501915824e-10,
      -3.2648499868437713e-10, -2.8055568285084334e-10, -2.2092151958407234e-10,
      -1.5147053733253693e-10, -7.647554367418027e-11, -3.4035672163137855e-13,
      7.265071134758634e-11, 1.3856631244120406e-10, 1.9403217907049978e-10,
      2.3639575910778093e-10, 2.638438470989076e-10, 2.754686186910476e-10,
      2.7128053695147305e-10, 2.5216961956114877e-10, 2.1981936773701237e-10,
      1.7658011344336543e-10, 1.2531051913193153e-10, 6.919737370333144e-11,
      1.156461478067238e-11, -4.4317347149570994e-11, -9.541140411055417e-11,
      -1.3907307384081834e-10, -1.7318135414752426e-10, -1.9623500907642156e-10,
      -2.074103646945685e-10, -2.0657899723081956e-10, -1.9428599550893425e-10,
      -1.7169164532759872e-10, -1.4048130071292248e-10, -1.0274977941729886e-10,
      -6.086777448252799e-11, -1.7338463245807563e-11, 2.5347299215905313e-11,
      6.484908487160861e-11, 9.910088861273486e-11, 1.2641470097735446e-10,
      1.4555874235984871e-10, 1.5580705764880972e-10, 1.569589011788103e-10,
      1.4932808828928002e-10, 1.3370415382551092e-10, 1.1128865041036277e-10,
      8.3611164329924e-11, 5.2430565408409186e-11, 1.9627599800313196e-11,
      -1.2904837400603386e-11, -4.33675469855866e-11, -7.015125889949217e-11,
      -9.191829786291856e-11, -1.0766574185261667e-10, -1.1676732753960715e-10,
      -1.1899265360092435e-10, -1.1450355640265108e-10, -1.0382880812927879e-10,
      -8.781944601557453e-11, -6.758802330736912e-11, -4.4435830627461925e-11,
      -1.9772637669347744e-11, 4.966267640813816e-12, 2.8401013444759234e-11,
      4.928163189394926e-11, 6.655222327574018e-11, 7.940165448008148e-11,
      8.729852985916409e-11, 9.0009141751081e-11, 8.759810883140555e-11,
      8.041238600778822e-11, 6.9050226545373e-11, 5.4317448852850146e-11,
      3.7173969125400526e-11, 1.8673979724511964e-11, -9.663362715052362e-14,
      -1.808203837253647e-11, -3.431396390220279e-11, -4.796194827159472e-11,
      -5.837382831575142e-11, -6.510462521732944e-11, -6.7932700153216e-11,
      -6.686280982240468e-11, -6.21164360627038e-11, -5.4110456417468555e-11,
      -4.3425827019563365e-11, -3.0768435539378934e-11, -1.6924628037395117e-11,
      -2.7141059375208783e-12, 1.1057076324245589e-11, 2.3640801465631033e-11,
      3.4386115257980614e-11, 4.277141562542598e-11, 4.8428105957838035e-11,
      5.115475094656029e-11, 5.0921341742688154e-11, 4.786384399199726e-11,
      4.226973585064851e-11, 3.455571511879699e-11, 2.5239141432194448e-11,
      1.4905063040025257e-11, 4.170846576892452e-12, -6.34952222452432e-12,
      -1.6079466534857976e-11, -2.4510350910658733e-11, -3.1226964340206794e-11,
      -3.592674549496841e-11, -3.843194027856425e-11, -3.869430873244075e-11,
      -3.679242889702179e-11, -3.2922055230919855e-11, -2.738035669515456e-11,
      -2.0545165928200475e-11, -1.2850601566314631e-11, -4.760571012008186e-12,
      3.2582837142362386e-12, 1.0762668331498358e-11, 1.7356335748728786e-11,
      2.271018272601751e-11, 2.6577775041499033e-11, 2.8805627108555e-11,
      2.933788190798556e-11, 2.821536343637678e-11, 2.5569288197703247e-11,
      2.161020758695162e-11, 1.6612994658987346e-11, 1.0898875110026033e-11,
      4.815625251254396e-12, -1.282884884724248e-12, -7.056637666637964e-12,
      -1.2197814429820212e-11, -1.6446587947100146e-11, -1.960358806093102e-11,
      -2.1538484975704285e-11, -2.219437384085639e-11, -2.158789105827347e-11,
      -1.9805233168287532e-11, -1.6994470092905973e-11, -1.3354734458312902e-11,
      -9.123018397841518e-12, -4.559411994647978e-12, 6.833040893882248e-14,
      4.500009222599813e-12, 8.497145916826742e-12, 1.1855352005503084e-11,
      1.441428703571407e-11, 1.6064751585561353e-11, 1.675263956982796e-11,
      1.647966038770318e-11, 1.5300924922770798e-11
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      2.9197290346000113e-05, 0.00022751894704699737, 0.000878752261128013, 0.0023111348323608598,
      0.0047770839225349734, 0.00841062178024504, 0.013226072824807669,
      0.019123937209320506, 0.025903250217866856, 0.03327940646655038, 0.04090616852587626,
      0.04840040275556011, 0.05536799717133354, 0.06142941817139464, 0.0662434510122329,
      0.06952783449258162, 0.07107573087975182, 0.07076725210092247, 0.06857557493277988,
      0.06456750264093963, 0.058898649589780354, 0.0518037212025471, 0.04358261876638804,
      0.03458330421974668, 0.02518250490095168, 0.015765416723738726, 0.00670557475261379,
      -0.0016539950918067958, -0.009017344659890814, -0.015149060238117277,
      -0.01988398087789445, -0.02313278449837399, -0.024883292874270446,
      -0.0251975899727323, -0.024205276323102272, -0.022093383105150282,
      -0.019093633355684616, -0.015467856543322602, -0.01149243198036729,
      -0.007442654322419907, -0.0035778818811200903, -0.00012824952641559296,
      0.0027163911124591204, 0.0048147923470590655, 0.006079553276103298,
      0.006479130670865718, 0.006036649298459268, 0.004825719101105391,
      0.0029636237929413487, 0.0006023757543180889, -0.0020817705303863934,
      -0.004899693871631264, -0.007660996423515581, -0.0101851510163226,
      -0.012311601077445118, -0.013908292540628999, -0.014878226673470024,
      -0.015163750562370005, -0.014748440208183333, -0.013656571678993375,
      -0.01195031062478271, -0.009724872411208707, -0.007102007926195906,
      -0.004222248829797472, -0.0012363972760508406, 0.001703232774480427,
      0.004451322626339524, 0.006877338947127014, 0.008872200697285693,
      0.010353496043526955, 0.011269016679617336, 0.011598480306200996,
      0.011353418275609697, 0.01057530855029901, 0.009332128540793771, 0.007713583185855268,
      0.005825326880476467, 0.003782540753183656, 0.0017032477983981607,
      -0.00029825277966958073, -0.002117472975999514, -0.0036650274839319093,
      -0.0048708689548296324, -0.0056872761297037415, -0.006090481137734762,
      -0.006080902566800973, -0.005682029749999374, -0.0049380767544025305,
      -0.0039105879807160016, -0.002674227955872545, -0.0013120235350318223,
      8.965403304237537e-05, 0.0014460772719038454, 0.0026788447431514433,
      0.003720009838999766, 0.004515449668658426, 0.005027318514978587,
      0.005235487778271526, 0.005137934828157241, 0.004750103257942122,
      0.004103313354676242, 0.003242351184149178, 0.002222405064488078,
      0.001105547501206763, -4.302228923307227e-05, -0.0011587557707710633,
      -0.0021813409281685797, -0.003057904558969981, -0.0037456683661833134,
      -0.004213933381865432, -0.004445309871970991, -0.004436155333887046,
      -0.0041962288516318395, -0.003747613370708187, -0.0031229960831117847,
      -0.0023634291169395446, -0.0015157165983235173, -0.0006295889050170573,
      0.00024516988129919405, 0.0010614795845850168, 0.0017774579593551694,
      0.0023585233073505456, 0.0027790049354949977, 0.003023192261722847,
      0.00308578747382848, 0.002971761283378374, 0.0026956445419926214,
      0.002280318510551283, 0.0017553918552730653, 0.0011552717779615943,
      0.0005170492422166365, -0.00012167638407014945, -0.0007249097864267508,
      -0.0012601944093207117, -0.0017002692200204306, -0.0020243669696170113,
      -0.002219096685181727, -0.0022788786404578315, -0.00220592627230803,
      -0.0020097949479876507, -0.0017065407611630775, -0.0013175524373554178,
      -0.0008681349946768514, -0.00038593434743246024, 0.00010070281947833663,
      0.0005643398999941139, 0.0009799434753077442, 0.001326180449708771,
      0.0015864551438587087, 0.0017496394140012071, 0.0018104679035561568,
      0.0017695903325339764, 0.001633292156771942, 0.0014129129174986282,
      0.0011240072108423648, 0.0007853056668094872, 0.00041754207540323733,
      4.2217501306779446e-05, -0.00031962720581895797, -0.0006485625304173955,
      -0.0009277841371192097, -0.0011439387097948886, -0.0012877236191135243,
      -0.0013542364256526442, -0.0013430651438298543, -0.0012581249956225568,
      -0.0011072612531125713, -0.0009016499722294441, -0.000655038346772222,
      -0.00038287360400094604, -0.00010137353414042523, 0.0001734072105969427,
      0.00042646292451945026, 0.0006446274711794563, 0.0008172296878227764,
      0.0009365827260407944, 0.0009982870049435797, 0.0010013376689031728,
      0.0009480386985632457, 0.000843736493250957, 0.000696395255807712,
      0.0005160443858416581, 0.00031413395430513873, 0.00010283794805285964,
      -0.00010565377004718472, -0.0002998149137437465, -0.00046939701511872987,
      -0.0006059469828897285, -0.0007032031933272791, -0.0007573531196303821,
      -0.0007671439174479785, -0.0007338459241458814, -0.0006610772168320189,
      -0.0005545047680840134, -0.00042144396026708104, -0.0002703829717287621,
      -0.00011046162759486034, 4.9064387495267844e-05, 0.0001993435264482277,
      0.00033240430126655354, 0.00044156247183234424, 0.0005217396941968387,
      0.0005696795710300604, 0.0005840533406787147, 0.0005654539056553116,
      0.0005162831695023152, 0.000440543382169355, 0.00034354809167028513,
      0.00023157212592357632, 0.00011146261491146025, -9.765682794267587e-06,
      -0.0001253275779299044, -0.0002290353801238472, -0.0003156183004144944,
      -0.00038097756842444267, -0.00042236573792404794, -0.0004384833521603529,
      -0.0004294910228333084, -0.00039693976457760133, -0.0003436268577305733,
      -0.00027338835428663606, -0.00019084240590310444, -0.0001010997404494516,
      -9.45876343472667e-06, 7.889710983008405e-05, 0.00015918314109566908,
      0.00022726297703977913, 0.00027985189416243947, 0.0003146642010710599,
      0.00033049891584794737, 0.00032726151557168275, 0.00030592320416862574,
      0.0002684225617864759, 0.0002175174432936182, 0.0001565974352622295,
      8.946894738214954e-05, 2.0126035415908582e-05, -4.747969731529564e-05,
      -0.00010965727619141683, -0.00016317096269118894, -0.00020540144183708544,
      -0.00023446600773455327, -0.00024929276205459334, -0.000249646606649561,
      -0.00023610758638009028, -0.00021000476688768692, -0.00017331117426237351,
      -0.00012850726088307023, -7.842180315834329e-05, -2.6060022851010964e-05,
      2.557097209369012e-05, 7.362960154322865e-05, 0.00011559106214599671,
      0.00014937466572680013, 0.00017344117397095508, 0.00018685595910289515,
      0.0001893158953048694, 0.0001811399910564888, 0.00016322578997561536,
      0.00013697538849388665, 0.00010419644965026672, 6.698476027542669e-05,
      2.759563394872143e-05, -1.168822053088546e-05, -4.868486528326615e-05,
      -8.143036647223229e-05, -0.0001082790246851122, -0.0001279817312035255,
      -0.00013973899847651776, -0.00014322676588787012, -0.00013859467585381746,
      -0.00012643805998213404, -0.00010774628655212576, -8.383132591810181e-05,
      -5.6241331084867204e-05, -2.6664665302488974e-05, 3.1698855216449222e-06,
      3.15910038650387e-05, 5.7075466203361206e-05, 7.832676169242794e-05,
      9.433782759799459e-05, 0.0001044350701074219, 0.00010830199826497174,
      0.00010598200278578415, 9.786099155320969e-05, 8.463168501565314e-05,
      6.724232041761522e-05, 4.683326724859561e-05, 2.4665583531240623e-05,
      2.045823653708945e-06, -1.974856203510466e-05, -3.9539108895969535e-05,
      -5.630780801887345e-05, -6.924709320939792e-05, -7.779604019536422e-05,
      -8.166133635282683e-05, -8.082248667184594e-05, -7.552162113768893e-05,
      -6.623911046820662e-05, -5.3656936775387095e-05, -3.86123662913836e-05,
      -2.204490517169833e-05, -4.939769341147863e-06, 1.1728840887238657e-05,
      2.705149653862513e-05, 4.0231457912792084e-05, 5.06243306258458e-05,
      5.776759613774717e-05, 6.139879405689246e-05, 6.146181584097396e-05,
      5.8101453566229766e-05, 5.1646995075587406e-05, 4.2586233511729194e-05,
      3.1531735847852934e-05, 1.918156918180325e-05, 6.276900636990853e-06,
      -6.441039669504061e-06, -1.8272211111715807e-05, -2.8595008924613957e-05,
      -3.689759812850488e-05, -4.280183690600687e-05, -4.607876596774112e-05,
      -4.6655152317991166e-05, -4.461109491066005e-05, -4.016919678272944e-05,
      -3.3676256616795014e-05, -2.557880938913961e-05, -1.639413281860887e-05,
      -6.678521493758349e-06, 3.0052922496456373e-06, 1.2119722212013907e-05,
      2.018120066707347e-05, 2.678484504865687e-05, 3.162372100186637e-05,
      3.450185429800542e-05, 3.5340527199968994e-05, 3.417778788131995e-05,
      3.116148216406323e-05, 2.6536464476517924e-05, 2.062694156967319e-05,
      1.381513377885789e-05, 6.517594325006442e-06, -8.393982105224734e-07,
      -7.843966317453807e-06, -1.4120956239576216e-05, -1.935128958333202e-05,
      -2.3287390363956152e-05, -2.576399201681921e-05, -2.6703914901235008e-05,
      -2.6118701728936938e-05, -2.4104289183808235e-05, -2.083216283046436e-05,
      -1.653667519055267e-05, -1.149939214051565e-05, -6.031462216131102e-06,
      -4.550721145232992e-07, 4.9149416370524384e-06, 9.788308019258396e-06,
      1.3914454560871592e-05, 1.7094802434159266e-05, 1.919165728435915e-05,
      2.0133342448390573e-05, 1.991544500968771e-05, 1.859826683997329e-05,
      1.630078014374135e-05, 1.3191569102996546e-05, 9.47738693590638e-06,
      5.390064240755211e-06, 1.1725656759186927e-06, -2.934993691880825e-06,
      -6.708592501411092e-06, -9.952101358681507e-06, -1.250703873855822e-05,
      -1.4259826458209954e-05, -1.5146244834436015e-05, -1.5152955934208737e-05,
      -1.4316131956131528e-05, -1.2717385342003815e-05, -1.0477339209344258e-05,
      -7.747293945625821e-06, -4.6995328160377685e-06, -1.5168626229047362e-06,
      1.6179967381104326e-06, 4.532577073334623e-06, 7.073833878932519e-06,
      9.115856344136872e-06, 1.0565747044644352e-05, 1.1367420160351794e-05,
      1.1503193321020235e-05, 1.0993176157484046e-05, 9.892581122063408e-06,
      8.287192551510949e-06, 6.287322636517534e-06, 4.020653511397412e-06,
      1.6244100798248948e-06, -7.626730344893893e-07, -3.008134817918483e-06,
      -4.992898708301144e-06, -6.617343166300148e-06, -7.806037366317717e-06,
      -8.510933922654208e-06, -8.712905077892955e-06, -8.421605685657602e-06,
      -7.673740126667577e-06, -6.5298959137647825e-06, -5.070179743963957e-06,
      -3.3889486050572275e-06, -1.5889667482697048e-06, 2.2466245450946015e-07,
      1.9504427227539247e-06, 3.4959833060405215e-06, 4.7827622628895784e-06,
      5.74992004449634e-06, 6.356912555764697e-06, 6.584923433519831e-06,
      6.437008496995407e-06, 5.937017004216313e-06, 5.127400564643991e-06,
      4.066077855350714e-06, 2.8225688470326083e-06, 1.4736440196392904e-06,
      9.875083981513964e-08, -1.2245187283963115e-06, -2.4246691501126147e-06,
      -3.4400267878311066e-06, -4.221764002901389e-06, -4.73608273670847e-06,
      -4.965470974370008e-06, -4.909000685784132e-06, -4.581690485632607e-06,
      -4.013007336994459e-06, -3.244626447828422e-06, -2.327604841247347e-06,
      -1.3191502502093187e-06, -2.7918196082004463e-07, 7.331163622571841e-07,
      1.6625596990413843e-06, 2.4608666086792374e-06, 3.0890592916671096e-06,
      3.5192461908498237e-06, 3.735713581613628e-06, 3.735294112256656e-06,
      3.5270218244962807e-06, 3.1311224957084566e-06, 2.577423104868732e-06,
      1.9032930684989142e-06, 1.1512512701155733e-06, 3.663859373052574e-07,
      -4.062612737808167e-07, -1.124199923143054e-06, -1.7497493995319889e-06,
      -2.251936030051036e-06, -2.6079381308921888e-06, -2.804017362695604e-06,
      -2.8359059020097246e-06, -2.7086504909556757e-06, -2.435944607939816e-06,
      -2.0390071904581054e-06, -1.545089147991111e-06, -9.857062415063722e-07,
      -3.947080384604525e-07, 1.9370278325709393e-07, 7.468884934274443e-07,
      1.235527591543466e-06, 1.6351087822580455e-06, 1.9270951940063556e-06,
      2.0997077515874362e-06, 2.148299930186931e-06, 2.0753200118675944e-06,
      1.889880082300114e-06, 1.6069720912734238e-06, 1.246389266260408e-06,
      8.314251438465232e-07, 3.874318571877812e-07, -5.967624158035255e-08,
      -4.848880791129068e-07, -8.654502063917277e-07, -1.1820392402077697e-06,
      -1.419694711181874e-06, -1.568470359077715e-06, -1.6237793278500957e-06,
      -1.5864267672650626e-06, -1.4623410135924656e-06, -1.2620308318578179e-06,
      -9.998103051157517e-07, -6.928441590288247e-07, -3.600741097508283e-07,
      -2.109092705002171e-08, 3.049827620779341e-07, 6.00537203262536e-07,
      8.503926492402304e-07, 1.0425431611883983e-06, 1.1686928853581758e-06,
      1.2245635827536365e-06, 1.209965801115889e-06, 1.1286395480269358e-06,
      9.878829078630337e-07, 7.979980800969711e-07, 5.715932523451186e-07,
      3.2278514849173574e-07, 6.635075677469858e-08, -1.831224442855628e-07,
      -4.120404095633858e-07, -6.085177669233476e-07, -7.629682538762922e-07,
      -8.685426783227191e-07, -9.213963654158541e-07, -9.207782911104413e-07,
      -8.68944350174445e-07, -7.709068917090324e-07, -6.340412629058687e-07,
      -4.675771976187018e-07, -2.820081382623902e-07, -8.84547719112197e-08,
      1.0197989784021214e-07, 2.7882770118915864e-07, 4.3281148407642414e-07,
      5.563119030597973e-07, 6.437225694694323e-07, 6.916784175460082e-07,
      6.991498547652929e-07, 6.67403030979903e-07, 5.998339995454665e-07,
      5.016912386028893e-07, 3.797066123894623e-07, 2.4165911356270836e-07,
      9.589845702092102e-08, -4.914329467283276e-08, -1.8542439886337808e-07,
      -3.0572474185463073e-07, -4.040135052336386e-07, -4.757353727998938e-07,
      -5.180027348672914e-07, -5.296870990886583e-07, -5.114088082633531e-07,
      -4.654298622022992e-07, -3.954598337126904e-07, -3.063892900587035e-07,
      -2.0396856686897913e-07, -9.445204115394206e-08, 1.5770866919999346e-08,
      1.205368772965218e-07, 2.1424244307016775e-07, 2.92132335008837e-07,
      3.5052902764882006e-07, 3.869925809848846e-07, 4.0040500788073095e-07,
      3.9097756939607535e-07, 3.601837940270734e-07, 3.10625034179342e-07,
      2.458388444515299e-07, 1.700632210121908e-07, 8.797165597305846e-08,
      4.394963550168798e-09, -7.59540919721837e-08, -1.4873815835262628e-07,
      -2.10221073540013e-07, -2.574508074110958e-07, -2.88391165996213e-07,
      -3.019970574975971e-07, -2.9823147626997746e-07, -2.7802568094586164e-07,
      -2.431871428197088e-07, -1.9626255708749532e-07, -1.4036540732851894e-07,
      -7.897915195631537e-08, -1.574799815550416e-08, 4.573257753014276e-08,
      1.0211389385046299e-07, 1.5047016662393806e-07, 1.8844375998100486e-07,
      2.1435278550190146e-07, 2.2725662559801693e-07, 2.2697748279419838e-07,
      2.1407858260647754e-07, 1.898020438703457e-07, 1.559715496797878e-07,
      1.1486669769351607e-07, 6.90771988351958e-08, 2.1345875471712438e-08,
      -2.5590338410125354e-08, -6.915246364030492e-08, -1.0705643442960811e-07,
      -1.3742795494324826e-07, -1.5888978032065712e-07, -1.7061771056539283e-07,
      -1.723634810644365e-07, -1.6444465116340962e-07, -1.477034245770194e-07,
      -1.2343798402584286e-07, -9.331130324930399e-08, -5.924344673884199e-08,
      -2.3294036746239926e-08, 1.2458163188453411e-08, 4.603172718706199e-08,
      7.564878996387771e-08, 9.982552849313353e-08, 1.1744252106120411e-07,
      1.277919042046619e-07, 1.3059966717759396e-07, 1.260228761744244e-07,
      1.1462302433198751e-07, 9.731798245187115e-08, 7.531611343721579e-08,
      5.003695800628382e-08, 2.3023463443438056e-08, -4.1490087730445644e-09,
      -2.996169889513883e-08, -5.3034616734563715e-08, -7.219757324321935e-08,
      -8.654658557797165e-08, -9.54831243567017e-08, -9.87347318123039e-08,
      -9.6356637390913e-08, -8.871507035294643e-08, -7.645395843861432e-08,
      -6.044755605669533e-08, -4.174222281220146e-08, -2.149104316517339e-08,
      -8.85223070617934e-10, 1.8913784704685478e-08, 3.68376796182524e-08,
      5.196689451051271e-08, 6.357559057651461e-08, 7.116400197550793e-08,
      7.44768556558624e-08, 7.35074198368583e-08, 6.848755291019168e-08,
      5.986488815923387e-08, 4.826895841863316e-08, 3.44686053391468e-08,
      1.932340552669882e-08, 3.7320652741699165e-09, -1.1419218327044839e-08,
      -2.5305554781687692e-08, -3.720671855482636e-08, -4.6542881467794916e-08,
      -5.290104743217874e-08, -5.605110469641523e-08, -5.5951033637049704e-08,
      -5.2741430815981924e-08, -4.673009790033329e-08, -3.836796583380569e-08,
      -2.8218054065161516e-08, -1.6919481621345772e-08, -5.148738390814286e-09,
      6.4195142945981644e-09, 1.7149912766254866e-08, 2.6480116534766446e-08,
      3.394906891059932e-08, 3.9218447059293174e-08, 4.2086390737304755e-08,
      4.249306648543492e-08, 4.051809682949363e-08, 3.63703355246219e-08,
      3.037087583949825e-08, 2.2930518609175042e-08, 1.4523184135749113e-08,
      5.6569160854415116e-09, -3.1558089361681718e-09, -1.1426785005256861e-08,
      -1.8718237330477437e-08, -2.4665089354352503e-08, -2.8992259085891525e-08,
      -3.15262286312489e-08, -3.220048099685616e-08, -3.105475639160905e-08,
      -2.822842618589951e-08, -2.394859765211599e-08, -1.8513830372134107e-08,
      -1.2274552812505527e-08, -5.611405982461485e-09, 1.0871945243517084e-09,
      7.446996953838701e-09, 1.3128152155562224e-08, 1.784269700752029e-08,
      2.1368424015985334e-08, 2.355851538112236e-08, 2.434658135676242e-08,
      2.3747013448346747e-08, 2.185082743997931e-08, 1.8817414963629026e-08,
      1.4862832618629151e-08, 1.0245424203489481e-08, 5.2496869831450735e-09,
      1.693527900570615e-10, -4.7093418798427955e-09, -9.123273604802074e-09,
      -1.2846114682720655e-08, -1.5699399635751387e-08, -1.7560468408615394e-08,
      -1.8366973978350678e-08, -1.8117846258452865e-08, -1.687080588024017e-08,
      -1.4736709546555869e-08, -1.1871173273615666e-08, -8.46405278069566e-09,
      -4.727455472101036e-09, -8.830121531159487e-10, 2.8508524332444466e-09,
      6.270941801826082e-09, 9.199962998686208e-09, 1.1495316828827742e-08,
      1.3055592174712667e-08, 1.3824498379335975e-08, 1.3792123292141002e-08,
      1.2993558073363334e-08, 1.1505074685624066e-08, 9.438170470699257e-09,
      6.931899844885412e-09, 4.143991018248126e-09, 1.2412925711418933e-09,
      -1.6098906202689358e-09, -4.253029704258359e-09, -6.549676575951531e-09,
      -8.386417379328307e-09, -9.680143961533128e-09, -1.0381419802909917e-08,
      -1.0475832273494102e-08, -9.98333962123278e-09, -8.95573234169325e-09,
      -7.472428543283117e-09, -5.634906511645867e-09, -3.5601409204182164e-09,
      -1.3734493587072326e-09, 7.988282335758576e-10, 2.8364028893471507e-09,
      4.631479336394843e-09, 6.09423577725618e-09, 7.15707578151366e-09,
      7.777466684592251e-09, 7.93926525946682e-09, 7.652519734025904e-09,
      6.951822472565471e-09, 5.893365208211664e-09, 4.550914606258105e-09,
      3.010976974525524e-09, 1.3674548929775995e-09, -2.8388576911649083e-10,
      -1.8508226590644323e-09, -3.249661921617647e-09, -4.409541464221392e-09,
      -5.275841350929233e-09, -5.8125486303091605e-09, -6.003488432429857e-09,
      -5.852399925267778e-09, -5.381900894213292e-09, -4.6314447385854946e-09,
      -3.654425439164752e-09, -2.5146270038420756e-09, -1.2822422144957314e-09,
      -2.9700126356142807e-11, 1.1724575339837277e-09, 2.2594236239235265e-09,
      3.17549387374446e-09, 3.876788661709233e-09, 4.33320366751197e-09,
      4.529512886204821e-09, 4.465597835041441e-09, 4.155826500403009e-09,
      3.627651910878605e-09, 2.9195407471361343e-09, 2.0783750957988404e-09,
      1.1564938287790141e-09, 2.0855322793210553e-10, -7.116109284243173e-10,
      -1.5539452521780058e-09, -2.2748070886186328e-09, -2.839126905363315e-09,
      -3.222003747731902e-09, -3.409668526504258e-09, -3.3997877944497815e-09,
      -3.201118505985464e-09, -2.8325599362812964e-09, -2.321680565952332e-09,
      -1.702823723295148e-09, -1.0149149062072196e-09, -2.9910520069099513e-10,
      4.036112502804673e-10, 1.0546720609876792e-09, 1.6199915814214939e-09,
      2.071671784999678e-09, 2.389297734110044e-09, 2.5607627893358786e-09,
      2.582597176204369e-09, 2.4598022577998806e-09, 2.2052202716155323e-09,
      1.8384939042288777e-09, 1.3846906440493862e-09, 8.726823941551886e-10,
      3.333806879714356e-10, -2.0206828248942293e-10, -7.040267090889643e-10,
      -1.1459518528417425e-09, -1.5057445684803632e-09, -1.7667945170323598e-09,
      -1.9186765012535264e-09, -1.9574736668824624e-09, -1.8857250854589365e-09,
      -1.71201624091931e-09, -1.450250045166729e-09, -1.1186522233070592e-09,
      -7.385774548090133e-10, -3.3319098679277595e-10, 7.389573844863421e-11,
      4.5995760352733904e-10, 8.043836518748633e-10, 1.0897362592479988e-09,
      1.3025897048777567e-09, 1.4341106404737932e-09, 1.4803588767699406e-09,
      1.4423033682571774e-09, 1.3255643387287208e-09, 1.139907275980584e-09,
      8.985272636635175e-10, 6.171721879082857e-10, 3.131603064955598e-10,
      4.351241836359893e-12, -2.918704027127466e-10, -5.595427656297632e-10,
      -7.849559006276823e-10, -9.573211821353629e-10, -1.0692503278812894e-09,
      -1.1170252903679042e-09, -1.1006526861238413e-09, -1.023708685176807e-09,
      -8.929916980821042e-10, -7.180101736717143e-10, -5.103408620852917e-10,
      -2.828986374682309e-10, -4.916218917006237e-11, 1.7759949461854273e-10,
      3.850568373301587e-10, 5.624667899432284e-10, 7.012047716131433e-10,
      7.951566173735312e-10, 8.409545369680444e-10, 8.380504342494049e-10,
      7.886292638079128e-10, 6.973738922576846e-10, 5.711007189945687e-10,
      4.18291703560732e-10, 2.4855314623143813e-10, 7.203438388182639e-11,
      -1.0115958381156286e-10, -2.615285981672993e-10, -4.006808994374602e-10,
      -5.117540815939544e-10, -5.897334494954004e-10, -6.316543242270851e-10,
      -6.366818596793797e-10, -6.06069017385118e-10, -5.430001002796233e-10,
      -4.5233330725923283e-10, -3.4026083065461316e-10, -2.1390883798585664e-10,
      -8.09020966423636e-11, 5.1081060844728303e-11, 1.7473826333885867e-10,
      2.8353386047482735e-10, 3.720307796110562e-10, 4.361474595530225e-10,
      4.733286753295301e-10, 4.826243250023866e-10, 4.6467561774921904e-10,
      4.216132788987923e-10, 3.5687709211731615e-10, 2.749700893412379e-10,
      1.811637829287341e-10, 8.117287790167578e-11, -1.9181165416507726e-11,
      -1.1429853232865258e-10, -1.991034765384532e-10, -2.693050141379766e-10,
      -3.216031147567939e-10, -3.5383117962012665e-10, -3.6502952455589157e-10,
      -3.554486450233074e-10, -3.264849986909624e-10, -2.805556828594058e-10,
      -2.2092151959406036e-10, -1.514705373433408e-10, -7.64755436851681e-11,
      -3.4035673218522826e-13, 7.265071133803657e-11, 1.3856631243315066e-10,
      1.9403217906433283e-10, 2.3639575910377055e-10, 2.638438470971937e-10,
      2.754686186916373e-10, 2.7128053695424514e-10, 2.521696195658658e-10,
      2.198193677433382e-10, 1.7658011345088747e-10, 1.2531051914018693e-10,
      6.91973737118346e-11, 1.1564614788942952e-11, -4.431734714198159e-11,
      -9.541140410403906e-11, -1.3907307383569548e-10, -1.7318135414402167e-10,
      -1.962350090746682e-10, -2.0741036469459104e-10, -2.0657899723254498e-10,
      -1.942859955121979e-10, -1.7169164533215703e-10, -1.4048130071846958e-10,
      -1.0274977942348615e-10, -6.086777448898527e-11, -1.733846325216445e-11,
      2.5347299209998817e-11, 6.484908486646346e-11, 9.910088860860724e-11,
      1.2641470097443373e-10, 1.4555874235824952e-10, 1.558070576485685e-10,
      1.5695890117988632e-10, 1.4932808829156077e-10, 1.3370415382882107e-10,
      1.112886504144766e-10, 8.361116433457987e-11, 5.243056541332555e-11,
      1.962759980520502e-11, -1.2904837396008559e-11, -4.3367546981533975e-11,
      -7.015125889618713e-11, -9.191829786051676e-11, -1.076657418512174e-10,
      -1.1676732753925e-10, -1.1899265360158927e-10, -1.1450355640426186e-10,
      -1.0382880813170949e-10, -8.781944601865848e-11, -6.758802331090988e-11,
      -4.4435830631245424e-11, -1.9772637673154888e-11, 4.966267637194849e-12,
      2.8401013441521475e-11, 4.928163189125698e-11, 6.655222327372085e-11,
      7.940165447882014e-11, 8.729852985870031e-11, 9.000914175140842e-11,
      8.759810883247407e-11, 8.04123860095085e-11, 6.905022654762298e-11,
      5.431744885548312e-11, 3.717396912825419e-11, 1.8673979727418076e-11,
      -9.663362435653694e-14, -1.8082038370006477e-11, -3.431396390006799e-11,
      -4.796194826995915e-11, -5.837382831468722e-11, -6.510462521687408e-11,
      -6.793270015337159e-11, -6.686280982313922e-11, -6.211643606395436e-11,
      -5.4110456419145954e-11, -4.3425827021558234e-11, -3.076843554156854e-11,
      -1.692462803965072e-11, -2.7141059397151155e-12, 1.1057076322231662e-11,
      2.3640801463901676e-11, 3.4386115256620187e-11, 4.277141562449503e-11,
      4.842810595737085e-11, 5.1154750946564076e-11, 5.0921341743143646e-11,
      4.7863843992860875e-11, 4.226973585185573e-11, 3.4555715120266784e-11,
      2.5239141433834447e-11, 1.4905063041737307e-11, 4.170846578578307e-12,
      -6.349522222957533e-12, -1.6079466533492795e-11, -2.451035090956318e-11,
      -3.1226964339431164e-11, -3.5926745494543203e-11, -3.843194027849923e-11,
      -3.8694308732725275e-11, -3.6792428897626166e-11, -3.292205523179777e-11,
      -2.7380356696246302e-11, -2.0545165929436787e-11, -1.285060156762092e-11,
      -4.760571013308888e-12, 3.2582837130134084e-12, 1.076266833041851e-11,
      1.7356335747846505e-11, 2.2710182725374228e-11, 2.6577775041121244e-11,
      2.8805627108453373e-11, 2.933788190815498e-11, 2.8215363436797252e-11,
      2.5569288198341582e-11, 2.1610207587763815e-11, 1.6612994659921446e-11,
      1.0898875111025341e-11, 4.815625252260819e-12, -1.2828848837669164e-12,
      -7.056637665780986e-12, -1.219781442910725e-11, -1.6446587946565137e-11,
      -1.960358806059667e-11, -2.153848497558122e-11, -2.2194373840943054e-11,
      -2.1587891058556678e-11, -1.9805233168743683e-11, -1.699447009350277e-11,
      -1.3354734459011498e-11, -9.123018398598941e-12, -4.5594119954196794e-12,
      6.83304081964229e-14, 4.500009221926934e-12, 8.497145916258136e-12,
      1.1855352005066322e-11, 1.4414287035428288e-11, 1.606475158543652e-11,
      1.6752639569864688e-11, 1.6479660387893073e-11, 1.530092492309727e-11
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_5_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<5>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 1.8385495176675801e-06), "design.b()[0] == 1.8385495176675801e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 1.8385495176675801e-06));
    static_assert(almost_equal(design.b()[1], 9.1927475883379e-06), "design.b()[1] == 9.1927475883379e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 9.1927475883379e-06));
    static_assert(almost_equal(design.b()[2], 1.83854951766758e-05), "design.b()[2] == 1.83854951766758e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 1.83854951766758e-05));
    static_assert(almost_equal(design.b()[3], 1.83854951766758e-05), "design.b()[3] == 1.83854951766758e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 1.83854951766758e-05));
    static_assert(almost_equal(design.b()[4], 9.1927475883379e-06), "design.b()[4] == 9.1927475883379e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 9.1927475883379e-06));
    static_assert(almost_equal(design.b()[5], 1.8385495176675801e-06), "design.b()[5] == 1.8385495176675801e-06");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 1.8385495176675801e-06));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -4.778383188900917), "design.a()[1] == -4.778383188900917");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -4.778383188900917));
    static_assert(almost_equal(design.a()[2], 9.210384180893838), "design.a()[2] == 9.210384180893838");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 9.210384180893838));
    static_assert(almost_equal(design.a()[3], -8.949598120670977), "design.a()[3] == -8.949598120670977");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -8.949598120670977));
    static_assert(almost_equal(design.a()[4], 4.383239904163896), "design.a()[4] == 4.383239904163896");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 4.383239904163896));
    static_assert(almost_equal(design.a()[5], -0.8655839419012752), "design.a()[5] == -0.8655839419012752");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.8655839419012752));
    std::cout << "max_deviation(cheby1,lowpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      1.8385495176675801e-06, 1.7978041695522553e-05, 8.735771999060503e-05, 0.000286683764272684,
      0.0007273169095993138, 0.001541375671808536, 0.0028647715772412256,
      0.004820520011761956, 0.0075034821463619145, 0.010967560495852964, 0.0152161792083646,
      0.020196643550221133, 0.025798706889944678, 0.031857394720637755,
      0.038159861061561995, 0.04445579934624877, 0.05047071232158515, 0.05592117570681168,
      0.0605311173765517, 0.06404808300677473, 0.06625847199442592, 0.06700080174958034,
      0.06617618830095562, 0.0637554075471215, 0.05978211289254187, 0.05437201810920811,
      0.04770809478284471, 0.040032067264113125, 0.03163270102688859, 0.02283156064439798,
      0.013967051336342712, 0.005377646046304099, -0.002614765815990728,
      -0.009720492345345107, -0.015695773051484285, -0.020353909778916005,
      -0.023573230593980796, -0.025301510501253774, -0.025556678298859714,
      -0.024423849656382363, -0.022048930368391548, -0.018629219164131447,
      -0.014401596248173679, -0.009629003618328177, -0.004586000199875671,
      0.0004557943879765075, 0.0052415696491095315, 0.00954577055082504,
      0.013182484112067551, 0.01601326399429149, 0.017952049577713555, 0.018967009690355224,
      0.01907931945788588, 0.018359051331306567, 0.016918518508425448, 0.014903542128917993,
      0.012483215843461515, 0.009838807661062765, 0.007152466598910126,
      0.004596390136462687, 0.0023230596207095278, 0.0004570684961126559,
      -0.0009110417273693757, -0.0017286533331681495, -0.001982510495333728,
      -0.001697728607110531, -0.0009345215483207141, 0.00021707762776681724,
      0.0016441183682252708, 0.0032187894576196432, 0.00480711067406289,
      0.0062777178225540894, 0.007510210950476819, 0.008402577544721384,
      0.00887727191311042, 0.008885623924014492, 0.00841035879860351, 0.007466127906184859,
      0.006098071313779936, 0.004378549047726388, 0.002402282964939724,
      0.0002802389734448251, -0.0018673545871529687, -0.003918415569066853,
      -0.00575639255112073, -0.007277186820049294, -0.008395211387544857,
      -0.009048247211121609, -0.009200835752200938, -0.008846039256465855,
      -0.008005499940272887, -0.006727830585925722, -0.005085465932168298,
      -0.003170191154589993, -0.001087635851410666, 0.0010489245408410609,
      0.0031250857196365575, 0.0050317660215679315, 0.00667122150023404,
      0.007962287751050807, 0.008844564500673335, 0.009281326980068366,
      0.009261026919731838, 0.00879733078828774, 0.007927728567581178, 0.006710827925543381,
      0.005222521488911912, 0.003551275035662098, 0.0017928286694418663,
      4.462925713616568e-05, -0.001599680440239597, -0.0030554023464031974,
      -0.004251269391403273, -0.005133038849358248, -0.00566601178382891,
      -0.005836364406903081, -0.005651248670601874, -0.0051376914526499624,
      -0.004340390089482636, -0.003318562888044437, -0.0021420632940503635,
      -0.0008870030047456821, 0.00036884926544305304, 0.001550621254065206,
      0.0025905812305506964, 0.0034318364010141843, 0.004031287665496642,
      0.004361691467584427, 0.004412735478683906, 0.004191094704311369,
      0.003719494711455624, 0.0030348655603270047, 0.0021857204691726837,
      0.0012289344971841542, 0.00022612845613337925, -0.000760119569255206,
      -0.0016700089450547352, -0.0024499807941265753, -0.0030557170447725115,
      -0.003454511934896135, -0.003626894780697703, -0.003567429835740512,
      -0.003284669108045233, -0.0028002840771378726, -0.002147449446695364,
      -0.0013685937152265858, -0.0005126651755781196, 0.0003679137914178463,
      0.0012204177343591712, 0.0019949257570682126, 0.0026471857944803286,
      0.0031410745697504055, 0.003450520117009706, 0.0035607886122416797,
      0.003469076901230453, 0.003184394113520783, 0.0027267575986035155,
      0.0021257676852075493, 0.0014186602322107736, 0.0006479637342114396,
      -0.00014109257155982009, -0.000903262505305355, -0.00159590033116617,
      -0.002181361417050307, -0.0026290523865375934, -0.0029170208498159513,
      -0.003033004422542472, -0.0029748922426730915, -0.002750587525958359,
      -0.002377294759845631, -0.0018802878938817442, -0.001291244501268378,
      -0.0006462538097507528, 1.637744851938714e-05, 0.0006583889874649558,
      0.0012437678123682343, 0.0017407602547362079, 0.0021235837922925476,
      0.0023737476306131093, 0.002480916138194362, 0.002443277491673808,
      0.002267409577554058, 0.0019676645497897424, 0.0015651207645293215,
      0.0010861745731814525, 0.0005608633697850559, 2.1024391183260827e-05,
      -0.0005015995450328155, -0.0009771961244751598, -0.0013795566014938305,
      -0.0016874933156823656, -0.0018859264740279224, -0.001966586251413242,
      -0.0019283000549501425, -0.0017768596949227413, -0.0015244877317523494,
      -0.0011889450105288333, -0.0007923410802448327, -0.000359724763713206,
      8.245719627930268e-05, 0.000507940224771456, 0.0008921678372362889,
      0.0012136761761653552, 0.0014552605311112174, 0.0016048619659500725,
      0.0016561301257111772, 0.001608638309237003, 0.0014677477547666799,
      0.0012441385585845186, 0.0009530435533343191, 0.0006132377564952779,
      0.0002458487857278824, -0.00012693772198763041, -0.0004831995462586756,
      -0.0008025485807652631, -0.0010672782410746057, -0.0012633241540353406,
      -0.00138098726267226, -0.0014153836606606365, -0.001366602315548299,
      -0.0012395693263199496, -0.0010436344554042654, -0.0007919113951687061,
      -0.0005004166980196313, -0.00018706279548493096, 0.0001294324746937553,
      0.00043065423544656517, 0.0006995519509570565, 0.000921393408586036,
      0.0010845587474836394, 0.001181132679076445, 0.0012072658886108966,
      0.0011632907913324709, 0.0010535914817028568, 0.0008862419945628482,
      0.0006724400741878111, 0.0004257747935515841, 0.00016137498631740377,
      -0.00010500888463528014, -0.0003579343452046891, -0.000583153748863289,
      -0.0007684080112224483, -0.0009040836724442561, -0.0009836988249465242,
      -0.0010041943055098066, -0.0009660184908293354, -0.0008730063313645365,
      -0.0007320651864081169, -0.0005526909008478349, -0.0003463467877419628,
      -0.00012574525948670905, 9.59235692729165e-05, 0.0003057701004406442,
      0.0004919449367231575, 0.0006442981360500319, 0.0007549219411680619,
      0.0008185486291873443, 0.0008327843033665242, 0.0007981694929729659,
      0.0007180677300498324, 0.0005983932290568247, 0.0004471978377160921,
      0.00027414505454104263, 8.99047156842827e-05, -9.449434724906856e-05,
      -0.0002683149438745789, -0.0004217275769404198, -0.0005463570623399576,
      -0.0006357298441941298, -0.0006855987068100479, -0.000694129335857004,
      -0.000661941625478064, -0.000592007257114305, -0.0004894133834013326,
      -0.0003610097627643285, -0.0002149629924164322, -6.0246245957298926e-05,
      9.390409808307564e-05, 0.00023853247374608626, 0.00036547716621265574,
      0.0004678233988822658, 0.0005402717602447974, 0.0005794028459760363,
      0.0005838255362060696, 0.0005542034267769593, 0.0004931611592469054,
      0.0004050793242725455, 0.0002957928522692283, 0.00017221301011607296,
      4.189701868897446e-05, -8.740829786176154e-05, -0.00020822162268913352,
      -0.000313754612701569, -0.0003982876333519835, -0.00045747332741554554,
      -0.0004885523251453622, -0.0004904709287447823, -0.0004638965714047244,
      -0.00041113290172911177, -0.0003359421245373649, -0.00024328741034954126,
      -0.00013901248351642177, -2.947868713926052e-05, 7.881825365992217e-05,
      0.0001796289675567548, 0.00026730662837722333, 0.00033711857726942906,
      0.00038549647846603126, 0.0004102121360406957, 0.0004104707629268133,
      0.0003869185084745719, 0.00034156611624925823, 0.0002776354040683886,
      0.0001993395600858748, 0.00011161179618303407, 1.9799507310894605e-05,
      -7.06573733608262e-05, -0.00015454471938264317, -0.00022717085835445995,
      -0.00028462487979327234, -0.0003239826367212033, -0.00034344988825015335,
      -0.0003424359653980795, -0.0003215555556262055, -0.0002825604409406263,
      -0.0002282070429397967, -0.00016206919847335378, -8.830851633230845e-05,
      -1.1416795977935298e-05, 6.405377854765358e-05, 0.00013375667004928766,
      0.00019379789606682155, 0.00024094998884883828, 0.00027282146934808733,
      0.0002879731919747039, 0.000285976235605232, 0.00026740955489184745,
      0.0002337991528067974, 0.0001875038843653313, 0.00013155596342028094,
      6.946665771533338e-05, 5.009396645040481e-06, -5.800650145263602e-05,
      -0.00011595808680885133, -0.00016561421916482167, -0.00020431271255076807,
      -0.0002300996572229784, -0.00024182384567913518, -0.00023918202796162228,
      -0.00022271369262192296, -0.0001937470365302688, -0.0001543005769758444,
      -0.00010694731591093752, -5.465035507351199e-05, -5.802791591439597e-07,
      5.2074594807525035e-05, 0.00010029388841273319, 0.00014139607868007777,
      0.00017318513088363375, 0.00019406498464444874, 0.0002031161095601249,
      0.00020013070548483274, 0.00018560561681262586, 0.00016069451120614617,
      0.0001271231974067492, 8.70739932975536e-05, 4.304669373539051e-05,
      -2.2951566061612573e-06, -4.628336115434831e-05, -8.640015513066467e-05,
      -0.00012042037599704382, -0.00014653281135671825, -0.00016343423744382194,
      -0.0001703914222019574, -0.00016726835486266696, -0.00015451805731515878,
      -0.00013314040698389788, -0.00010460933642934313, -7.077446278911422e-05,
      -3.374354912051564e-05, 4.246859522766098e-06, 4.096479348880643e-05,
      7.431235668983235e-05, 0.00010244394854133106, 0.00012386664744560926,
      0.00013751740644064002, 0.0001428132024953047, 0.00013967195572036977,
      0.0001285037912540256, 0.00011017395055418037, 8.594027018546705e-05,
      5.736954464445176e-05, 2.6238199837076183e-05, -5.576531193567027e-06,
      -3.620835392456719e-05, -6.391001058382497e-05, -8.71515510038737e-05,
      -0.0001047033334596002, -0.00011569934639827278, -0.00011967770374423021,
      -0.00011659657702745572, -0.00010682530101031526, -9.111183850007726e-05,
      -7.052913113598413e-05, -4.640402114569831e-05, -2.023334203700845e-05,
      6.407602490095081e-06, 3.195865068547381e-05, 5.4964992545826166e-05,
      7.415882951405017e-05, 8.852797164254287e-05, 9.736774005894257e-05,
      0.00010031361008517513, 9.735321806192816e-05, 8.881759060043812e-05,
      7.535266556139261e-05, 5.787328991251577e-05, 3.75028384857856e-05,
      1.55023480810997e-05, -6.80643462249323e-06, -2.8119457917517726e-05,
      -4.72256297232148e-05, -6.307465523009077e-05, -7.483370759148384e-05,
      -8.192994107340899e-05, -8.407675893008087e-05, -8.128274805694463e-05,
      -7.384322850639743e-05, -6.231537708399593e-05, -4.7478812419101876e-05,
      -3.0284322450360382e-05, -1.1794031721532386e-05, 6.883285784976225e-06,
      2.4657860449044045e-05, 4.052170823176905e-05, 5.360497037933785e-05,
      6.322271296310553e-05, 6.890972518933163e-05, 7.044161875340916e-05,
      6.784137189061679e-05, 6.137133021860393e-05, 5.151152080757449e-05,
      3.8925907762669325e-05, 2.4418874083782983e-05, 8.884720661253375e-06,
      -6.7466963700876445e-06, -2.156492851357443e-05, -3.4731289641619584e-05,
      -4.552563211682871e-05, -5.338497788811135e-05, -5.793198035917508e-05,
      -5.899183799449849e-05, -5.6596988505321283e-05, -5.0979640242240884e-05,
      -4.255290230571789e-05, -3.188191654863567e-05, -1.9646937521928994e-05,
      -6.600721636856551e-06, 6.477146290578588e-06, 1.8826253890424078e-05,
      2.974900895081756e-05, 3.864946235709798e-05, 4.5065181446555944e-05,
      4.869050985322889e-05, 4.939009502439681e-05, 4.720215998994806e-05,
      4.233160572169177e-05, 3.5133618730626755e-05, 2.608899182498416e-05,
      1.577281470102219e-05, 4.8185314764006025e-06, -6.120422451534033e-06,
      -1.6409110863365205e-05, -2.546747553513386e-05, -3.280254743535806e-05,
      -3.803473177737426e-05, -4.091679997873538e-05, -4.1344681996133737e-05,
      -3.93596531659365e-05, -3.5142020424109097e-05, -2.8996903669435524e-05,
      -2.133315109463399e-05, -1.263679809708311e-05, -3.4407583066002528e-06,
      5.707391392658265e-06, 1.4277609438028355e-05, 2.178770210715404e-05,
      2.783004024646703e-05, 3.209322538951e-05, 3.437758298586638e-05,
      3.460374922346774e-05, 3.2814038816280906e-05, 2.9166708834916393e-05,
      2.3923643154761756e-05, 1.7432350091899852e-05, 1.010347203643504e-05,
      2.385234253615649e-06, -5.26360065938694e-06, -1.2400661591231675e-05,
      -1.862522012906863e-05, -2.3600342780074322e-05, -2.707074110472e-05,
      -2.8875398947437393e-05, -2.895438410775215e-05, -2.7349605531489614e-05,
      -2.419963518308704e-05, -1.9729055271956662e-05, -1.4233097059726491e-05,
      -8.058590293406165e-06, -1.5824291294138607e-06, 4.8111278371649305e-06,
      1.0752973612318562e-05, 1.5910182140363266e-05, 2.0004369618419083e-05,
      2.2826393257390805e-05, 2.4246632477393102e-05, 2.4220374441266264e-05,
      2.2788123051669846e-05, 2.0070950255445785e-05, 1.626129323864574e-05,
      1.1609854722775158e-05, 6.409472195130103e-06, 9.769746195143714e-07,
      -4.365865384952622e-06, -9.31115322963694e-06, -1.3582380840031331e-05,
      -1.694964043284684e-05, -1.92417218057398e-05, -2.0354474507494456e-05,
      -2.0255049861212247e-05, -1.8981887485489883e-05, -1.664056176479957e-05,
      -1.33958410629685e-05, -9.460522930739815e-06, -5.081780631011581e-06,
      -5.258810338319791e-07, 3.937794650917469e-06, 8.052480443271816e-06,
      1.15885986218056e-05, 1.4356360974994426e-05, 1.6215719527005353e-05,
      1.7083160221296597e-05, 1.693503005462052e-05, 1.58072978308375e-05,
      1.379185852901622e-05, 1.1029689063004158e-05, 7.701337787289736e-06,
      4.015371962369639e-06, 1.9550917450179386e-07, -3.5327844219074272e-06,
      -6.955436299079314e-06, -9.88189388393626e-06, -1.215555809620597e-05,
      -1.3661963730571505e-05, -1.4334292279458993e-05, -1.4155968891087453e-05,
      -1.3160271201371774e-05, -1.142705327555233e-05, -9.076852667887386e-06,
      -6.262793374404302e-06, -3.160814345597415e-06, 4.116379488280514e-08,
      3.1544760187047675e-06, 6.000690603102447e-06, 8.421696692242128e-06,
      1.0288339810463578e-05, 1.1507142903683485e-05, 1.2024774137882276e-05,
      1.1830062680127825e-05, 1.0953511456638653e-05, 9.46440263210706e-06,
      7.465728789145769e-06, 5.087302792104446e-06, 2.4774955899767277e-06,
      -2.0588120314412235e-07, -2.804995366877204e-06, -5.1711615018646094e-06,
      -7.173230189716217e-06, -8.704732614976829e-06, -9.689399225073933e-06,
      -1.0084775717601516e-05, -9.883777607452083e-06, -9.11414863091396e-06,
      -7.835910924938448e-06, -6.137009187709383e-06, -4.127450471444492e-06,
      -1.9323205036983097e-06, 3.158875789536137e-07, 2.48516801112486e-06,
      4.451656142099506e-06, 6.1066031089638565e-06, 7.3622846491984195e-06,
      8.156529589916531e-06, 8.455642193371417e-06, 8.255591907884328e-06,
      7.581448109552266e-06, 6.485139954815942e-06, 5.0417165824593804e-06,
      3.3443652812351e-06, 1.498510434890039e-06, -3.8463925366366437e-07,
      -2.1947056159842354e-06, -3.828529392228921e-06, -5.195967192311042e-06,
      -6.224776293207264e-06, -6.8643281427725714e-06, -7.08796645145403e-06,
      -6.89390943669593e-06, -6.304683046591895e-06, -5.36515766488828e-06,
      -4.1393399554919784e-06, -2.7061397194813265e-06, -1.1543852441675835e-06,
      4.2260309782628625e-07, 1.932553931342402e-06, 3.2895757275516865e-06,
      4.41897346857417e-06, 5.261285231442163e-06, 5.7753252667595696e-06,
      5.940083600974282e-06, 5.755402645252553e-06, 5.2414244679254075e-06,
      4.436873958140079e-06, 3.3963089620795085e-06, 2.186524939178137e-06,
      8.823457375758564e-07, -4.3793849840110077e-07, -1.6972118145615912e-06,
      -2.823979695580033e-06, -3.756369987245076e-06, -4.4454671455770655e-06,
      -4.8578041238579894e-06, -4.976889866978289e-06, -4.8037096825320684e-06,
      -4.356197103627582e-06, -3.6677356313632423e-06, -2.784803516115036e-06,
      -1.7639214598598665e-06, -6.680992999107668e-07, 4.3699844941958793e-07,
      1.4869379167178261e-06, 2.4222250254409263e-06, 3.19162779773767e-06,
      3.7549292749125996e-06, 4.084966507579973e-06, 4.168856428465568e-06,
      4.008359319246469e-06, 3.6193819993837585e-06, 3.03067277242422e-06,
      2.2818057057630367e-06, 1.4205904660531762e-06, 5.000736255234173e-07,
      -4.24683388897521e-07, -1.2998565487654645e-06, -2.075951975263928e-06,
      -2.7105638595240256e-06, -3.1706463946264674e-06, -3.4341808609793976e-06,
      -3.4911573389103137e-06, -3.343832498521801e-06, -3.0062680009734216e-06,
      -2.5031957051917064e-06, -1.8682937283554621e-06, -1.141989361319429e-06,
      -3.68929194629856e-07, 4.0472764281378015e-07, 1.1340311576796062e-06,
      1.7778186023301773e-06, 2.301003153199116e-06, 2.676448030136004e-06,
      2.8863283786216705e-06, 2.9229156194377623e-06, 2.7887542728350945e-06,
      2.496237357445916e-06, 2.0666212305294447e-06, 1.5285521921549717e-06,
      9.162035838492545e-07, 2.671420743194122e-07, -3.799456445994769e-07,
      -9.87529957155972e-07, -1.5213868620891358e-06, -1.9524966274835644e-06,
      -2.258589021658306e-06, -2.425254896468793e-06, -2.446571247288159e-06,
      -2.3252165559324056e-06, -2.072083452081115e-06, -1.7054247348607006e-06,
      -1.2495949274874139e-06, -7.334713539787733e-07, -1.8865507713088605e-07,
      3.5243788110928217e-07, 8.584812187286084e-07, 1.30102841910415e-06,
      1.6560873243406685e-06, 1.9053935719962336e-06, 2.0373170484340264e-06,
      2.0473586006804858e-06, 1.9382191985610296e-06, 1.719449050784902e-06,
      1.4067083726930279e-06, 1.020693204500874e-06, 5.857976938368816e-07,
      1.2859763821411218e-07, -3.237518205947067e-07, -7.451089752934231e-07,
      -1.1118365531857645e-06, -1.4041070830353545e-06, -1.6069518150912486e-06,
      -1.7109991832319103e-06, -1.7128682849061142e-06, -1.615203821361636e-06,
      -1.4263601299194917e-06, -1.1597621151081655e-06, -8.329889018820253e-07,
      -4.6664090368574744e-07, -8.306194196529908e-08, 2.9500545797071376e-07,
      6.457516938504875e-07, 9.495416477161464e-07, 1.1899964986995237e-06,
      1.3548572602448373e-06, 1.4365857691981823e-06, 1.432675295906552e-06,
      1.3456605595724971e-06, 1.1828346668935487e-06, 9.556973113039155e-07,
      6.791735227087604e-07, 3.70654525314465e-07, 4.892120384943345e-08,
      -2.669841336565949e-07, -5.588707754462336e-07, -8.104331739441693e-07,
      -1.0081471733579316e-06, -1.1419805448833401e-06, -1.2058815653025031e-06,
      -1.1980232431427546e-06, -1.120795592000612e-06, -9.805531888281759e-07,
      -7.871392729774411e-07, -5.532200475374992e-07, -2.934729608998035e-07,
      -2.368004767574999e-08, 2.4021845412585816e-07, 4.830541734583749e-07,
      6.912907852888888e-07, 8.537662224938023e-07, 9.622769917060966e-07,
      1.01197491071879e-06, 1.0015582793980316e-06, 9.332519200403663e-07,
      8.12582935477963e-07, 6.47970713396715e-07, 4.501599946323087e-07,
      2.315341615247339e-07, 5.3518580242897765e-09, -2.1504665554601364e-07,
      -4.170165027148881e-07, -5.893238664879155e-07, -7.227604264343499e-07,
      -8.106235987277764e-07, -8.490383028723864e-07, -8.371058371008908e-07,
      -7.768758744441532e-07, -6.731479720658478e-07, -5.331187160556824e-07,
      -3.6589915492917975e-07, -1.8193404440346757e-07, 7.640720586056113e-09,
      1.9166350075823128e-07, 3.5959587309385027e-07, 5.021179084422543e-07,
      6.116366389851755e-07, 6.82680522972961e-07, 7.121600681372758e-07,
      6.994830832390399e-07, 6.465217810918203e-07, 5.57437635671486e-07,
      4.3837799850191777e-07, 2.970655503362732e-07, 1.4230732036180904e-07,
      -1.6546043650600943e-08, -1.7015800819550477e-07, -3.097480386549016e-07,
      -4.275865901286639e-07, -5.174157190383478e-07, -5.747728906203404e-07,
      -5.97201784050482e-07, -5.843408965812372e-07, -5.378880933565118e-07,
      -4.614465045713115e-07, -3.6026391742651586e-07, -2.4088366881992444e-07,
      -1.1072969956149338e-07, 2.2348355816732514e-08, 1.505425456503414e-07,
      2.6653896303057154e-07, 3.639292244377145e-07, 4.375582681072838e-07,
      4.837899879402186e-07, 5.00677488940311e-07, 4.88030645794563e-07,
      4.4737980803410257e-07, 3.8184055817396135e-07, 2.9589004385715984e-07,
      1.9507025730580922e-07, 8.56374640315483e-08, -2.5820407005696452e-08,
      -1.3277532654927036e-07, -2.2913669830570318e-07, -3.0959331326298516e-07,
      -3.699008230917383e-07, -4.070995042260718e-07, -4.196515432705407e-07,
      -4.0749203876027394e-07, -3.7199308206579254e-07, -3.158453457587387e-07,
      -2.4286627958943096e-07, -1.5774803164037115e-07, -6.576135951441569e-08,
      2.756608575637169e-08, 1.1677772729868214e-07, 1.9680306470691322e-07,
      2.6324176512787145e-07, 3.1260117606195094e-07, 3.4247472024267906e-07,
      3.516524044082433e-07, 3.4015885286153157e-07, 3.092186097247216e-07,
      2.611526849221237e-07, 1.9921420517261335e-07, 1.2737435622072163e-07,
      5.007238819523215e-08, -2.805482789830727e-08, -1.0244743421097463e-07,
      -1.6888534697574186e-07, -2.2372420312455608e-07, -2.640915113698442e-07,
      -2.88032687631402e-07, -2.945998434841912e-07, -2.838797133596188e-07,
      -2.5696073843684467e-07, -2.1584285845079533e-07, -1.6329679447200975e-07,
      -1.026823564990132e-07, -3.773743264325802e-08, 2.764929460259371e-08,
      8.966826591206227e-08, 1.448081719295766e-07, 1.9005185323287067e-07,
      2.2303822146484678e-07, 2.421817128531046e-07, 2.467434805857869e-07,
      2.3685149162530674e-07, 2.1346973754196785e-07, 1.783197187548709e-07,
      1.3376004839155974e-07, 8.263229685632427e-08, 2.8082940105366394e-08,
      -2.6627603243482646e-08, -7.831740696096133e-08, -1.2406572813946243e-07,
      -1.613756058991733e-07, -1.8830746554851518e-07, -2.0357674975921648e-07,
      -2.066108756623692e-07, -1.9756330579232267e-07, -1.7728507123449962e-07,
      -1.4725654738779506e-07, -1.0948451581756543e-07, -6.637142622538267e-08,
      -2.0565200873295452e-08, 2.520117089702463e-08, 6.827065660324544e-08,
      1.062144541001981e-07, 1.3696690635482558e-07, 1.5893568942291375e-07,
      1.7108154020036034e-07, 1.7296371413953476e-07, 1.6474945617930991e-07,
      1.4718790450532652e-07, 1.2155090118792295e-07, 8.954503912563612e-08,
      5.3200828655479635e-08, 1.4746037547728635e-08, -2.3529012755780648e-08,
      -5.940615433441554e-08, -9.086625953964972e-08, -1.1620114846098781e-07,
      -1.341044211588493e-07, -1.437365070230705e-07, -1.447608479329269e-07,
      -1.3734989152270157e-07, -1.2216135995076387e-07, -1.0028697342549693e-07,
      -7.317734884502938e-08, -4.254807740734188e-08, -1.0272943338711516e-08,
      2.1729167922897578e-08, 5.160693368622046e-08, 7.768229812417658e-08,
      9.854326480314803e-08, 1.1311873615419617e-07, 1.2073153697387053e-07,
      1.2112713020034557e-07, 1.1447701214280421e-07, 1.0135727224799114e-07,
      8.27042318581914e-08, 5.975035607859895e-08, 3.394469254032647e-08,
      6.862874900661084e-09, -1.9887800746698812e-08, -4.47625806350654e-08,
      -6.636728722771341e-08, -8.353523553778751e-08, -9.538886414335711e-08,
      -1.0138291324676902e-07, -1.0132713922769725e-07, -9.538779783330356e-08,
      -8.406838195477764e-08, -6.817129173688545e-08, -4.874317700740506e-08,
      -2.700756649266037e-08, -4.289039273442566e-09, 1.8066429504514938e-08,
      3.877021926504268e-08, 5.666436150150613e-08, 7.078527396891e-08,
      8.041448758206144e-08, 8.511377029649977e-08, 8.474302841404546e-08,
      7.946040968034332e-08, 6.970508177073355e-08, 5.6164153211162003e-08,
      3.9726085256127714e-08, 2.1423664567103797e-08, 2.370130123629841e-09,
      -1.6307651426590443e-08, -3.3535001277789775e-08, -4.8350439470025025e-08,
      -5.99584773342914e-08, -6.777134665324032e-08, -7.143754001931731e-08,
      -7.085586014995157e-08, -6.617455264748407e-08, -5.7775974509283204e-08,
      -4.62480785880379e-08, -3.23447254347138e-08, -1.6937428661822025e-08,
      -9.61567280880582e-10, 1.4639661912835827e-08, 2.8970235772402872e-08,
      4.1232074610794755e-08, 5.076875544052236e-08, 5.7099819924609155e-08,
      5.994393786808291e-08, 5.922988121135206e-08, 5.509499961092598e-08,
      4.7871622923415386e-08, 3.806250565260251e-08, 2.630703481506803e-08,
      1.3340412753869088e-08, -5.16251470056474e-11, -1.3079807541737616e-08,
      -2.4997263203395212e-08, -3.514175673251552e-08, -4.2971870556682415e-08,
      -4.8095194895238754e-08, -5.028710376931178e-08, -4.949928021343991e-08,
      -4.585777175974454e-08, -3.9650971245513654e-08, -3.130849248638547e-08,
      -2.1372413057687103e-08, -1.046276007356077e-08, 7.606013274288687e-10,
      1.1637366345807746e-08, 2.154515280577615e-08, 2.9934627200974707e-08,
      3.635944158670694e-08, 4.049938241196949e-08, 4.217556971808162e-08,
      4.135703814397122e-08, 3.8158549736773977e-08, 3.2830001864168596e-08,
      2.5738271891275853e-08, 1.7342756877768398e-08, 8.166198838930136e-09,
      -1.2373829298450978e-09, -1.0315712025637827e-08, -1.8550284133652755e-08,
      -2.548557169592403e-08, -3.07537839575034e-08, -3.409386409231947e-08,
      -3.536377534312789e-08, -3.454554342961271e-08, -3.174295754911436e-08,
      -2.7172261314606215e-08, -2.1146563189999814e-08, -1.405504109536624e-08,
      -6.33828925101107e-09, 1.5386569368625922e-09, 9.113988670250925e-09,
      1.5955858625749238e-08, 2.168665527319116e-08, 2.600347309754571e-08,
      2.8693692319450813e-08, 2.9644895023474183e-08, 2.884869437550773e-08,
      2.639841854447789e-08, 2.248094943493837e-08, 1.7363347738553553e-08,
      1.1375181606173903e-08, 4.887701058209015e-09, -1.708847324887732e-09,
      -8.028397760127876e-09, -1.3711375270299986e-08, -1.844486595128775e-08,
      -2.1979533667962654e-08, -2.4142388328208866e-08, -2.4844775936895096e-08,
      -2.4085255120477115e-08, -2.1947330841322606e-08, -1.8592315503756808e-08
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      1.8385495176675801e-06, 1.7978041695522556e-05, 8.735771999060504e-05, 0.000286683764272684,
      0.0007273169095993136, 0.0015413756718085359, 0.0028647715772412265,
      0.004820520011761961, 0.0075034821463619275, 0.010967560495852992,
      0.01521617920836465, 0.020196643550221213, 0.025798706889944793, 0.031857394720637915,
      0.03815986106156218, 0.044455799346248916, 0.05047071232158509, 0.05592117570681104,
      0.06053111737654976, 0.06404808300677027, 0.06625847199441716, 0.06700080174956485,
      0.06617618830093043, 0.06375540754708328, 0.059782112892487166, 0.054372018109133655,
      0.047708094782747824, 0.040032067263992055, 0.031632701026742864, 0.02283156064422859,
      0.013967051336152139, 0.005377646046096306, -0.002614765816210427,
      -0.009720492345570275, -0.01569577305170765, -0.02035390977912984,
      -0.02357323059417729, -0.025301510501425442, -0.025556678298999755,
      -0.02442384965648502, -0.022048930368452402, -0.018629219164147618,
      -0.014401596248143982, -0.009629003618253194, -0.004586000199757728,
      0.00045579438813344523, 0.005241569649300062, 0.009545770551042582,
      0.013182484112304648, 0.016013263994540155, 0.017952049577965618,
      0.018967009690602697, 0.01907931945812128, 0.01835905133152322, 0.016918518508617694,
      0.01490354212908135, 0.012483215843592764, 0.00983880766116, 0.007152466598972739,
      0.004596390136491321, 0.0023230596207059755, 0.0004570684960797119,
      -0.0009110417274280919, -0.0017286533332483939, -0.001982510495430845,
      -0.0016977286072196712, -0.000934521548437044, 0.00021707762764791922,
      0.0016441183681080431, 0.0032187894575078, 0.0048071106739595105,
      0.006277717822461548, 0.007510210950396758, 0.008402577544654725,
      0.008877271913057415, 0.00888562392397481, 0.008410358798576337, 0.007466127906169018,
      0.006098071313774009, 0.004378549047728842, 0.002402282964949025,
      0.00028023897345953486, -0.0018673545871341144, -0.003918415569044887,
      -0.00575639255109642, -0.007277186820023136, -0.008395211387517082,
      -0.009048247211092217, -0.009200835752169735, -0.0088460392564325,
      -0.008005499940236962, -0.006727830585886811, -0.005085465932126058,
      -0.003170191154544223, -0.0010876358513613733, 0.0010489245408936193,
      0.0031250857196918514, 0.005031766021625153, 0.006671221500292117,
      0.007962287751108441, 0.008844564500729044, 0.009281326980120562,
      0.009261026919778904, 0.008797330788328103, 0.007927728567613377,
      0.006710827925566129, 0.00522252148892417, 0.003551275035663136,
      0.0017928286694313083, 4.462925711402011e-05, -0.0015996804402729206,
      -0.003055402346446891, -0.00425126939145615, -0.0051330388494187805,
      -0.0056660117838952815, -0.005836364406973262, -0.0056512486706737,
      -0.005137691452721225, -0.004340390089551167, -0.0033185628881081965,
      -0.0021420632941075127, -0.0008870030047946522, 0.0003688492654035078,
      0.0015506212540359664, 0.0025905812305322493, 0.0034318364010066126,
      0.004031287665499633, 0.004361691467597294, 0.004412735478705623, 0.00419109470434061,
      0.0037194947114908257, 0.003034865560366431, 0.0021857204692145,
      0.0012289344972265057, 0.0002261284561744684, -0.0007601195692170464,
      -0.0016700089450209761, -0.002449980794098436, -0.003055717044750915,
      -0.0034545119348816803, -0.0036268947806906483, -0.003567429835740772,
      -0.0032846691080523935, -0.0028002840771512156, -0.00214744944671391,
      -0.0013685937152491448, -0.0005126651756033555, 0.0003679137913913449,
      0.0012204177343328171, 0.001994925757043347, 0.0026471857944581536,
      0.0031410745697319263, 0.0034505201169956826, 0.0035607886122325945,
      0.003469076901226491, 0.003184394113521827, 0.0027267575986091525,
      0.0021257676852170977, 0.0014186602322233208, 0.0006479637342258955,
      -0.00014109257154465923, -0.0009032625052907358, -0.001595900331153309,
      -0.0021813614170403174, -0.002629052386531419, -0.0029170208498143116,
      -0.003033004422545819, -0.002974892242681582, -0.0027505875259718473,
      -0.0023772947598636744, -0.0018802878939036282, -0.0012912445012931582,
      -0.0006462538097773072, 1.6377448492297644e-05, 0.0006583889874386184,
      0.0012437678123439133, 0.001740760254715074, 0.0021235837922756124,
      0.0023737476306011696, 0.0024809161381879573, 0.0024432774916731937,
      0.00226740957755919, 0.001967664549800279, 0.0015651207645446439,
      0.0010861745732006942, 0.0005608633698071506, 2.1024391206999924e-05,
      -0.0005015995450087164, -0.0009771961244519902, -0.0013795566014728144,
      -0.0016874933156645947, -0.0018859264740142968, -0.0019665862514044205,
      -0.0019283000549465076, -0.001776859694924383, -0.001524487731759066,
      -0.0011889450105401485, -0.0007923410802600266, -0.00035972476373136186,
      8.245719625924285e-05, 0.0005079402247506286, 0.0008921678372158429,
      0.0012136761761463869, 0.0014552605310947095, 0.0016048619659368415,
      0.0016561301257018298, 0.0016086383092319071, 0.0014677477547659493,
      0.0012441385585880128, 0.0009530435533416571, 0.0006132377565058668,
      0.00024584878574095744, -0.0001269377219729571, -0.0004831995462433589,
      -0.0008025485807502671, -0.0010672782410608471, -0.0012633241540236358,
      -0.0013809872626632793, -0.0014153836606548692, -0.0013666023155460276,
      -0.0012395693263212383, -0.00104363445540896, -0.000791911395176448,
      -0.0005004166980298811, -0.00018706279549700339, 0.00012943247468064894,
      0.0004306542354332685, 0.0006995519509444167, 0.0009213934085748532,
      0.0010845587474746189, 0.0011811326790701574, 0.001207265888607745,
      0.0011632907913326682, 0.001053591481706415, 0.0008862419945695788,
      0.0006724400741973376, 0.00042577479356336267, 0.00016137498633075553,
      -0.00010500888462112954, -0.0003579343451905646, -0.0005831537488500183,
      -0.0007684080112108147, -0.000904083672434953, -0.0009836988249401154,
      -0.0010041943055066947, -0.0009660184908297403, -0.0008730063313684845,
      -0.0007320651864154416, -0.0005526909008581881, -0.00034634678775483546,
      -0.00012574525950146182, 9.592356925701639e-05, 0.000305770100424381,
      0.0004919449367073228, 0.0006442981360353811, 0.0007549219411552727,
      0.0008185486291769811, 0.0008327843033590087, 0.0007981694929685572,
      0.0007180677300486164, 0.0005983932290587132, 0.0004471978377208314,
      0.0002741450545482313, 8.99047156933977e-05, -9.449434723863932e-05,
      -0.0002683149438634996, -0.0004217275769293674, -0.0005463570623295826,
      -0.0006357298441850193, -0.0006855987068026932, -0.000694129335851774,
      -0.0006619416254751871, -0.0005920072571138585, -0.0004894133834032415,
      -0.0003610097627683743, -0.00021496299242226881, -6.024624596447705e-05,
      9.390409807507916e-05, 0.00023853247373783516, 0.00036547716620471943,
      0.00046782339887518475, 0.0005402717602390508, 0.0005794028459720136,
      0.0005838255362040487, 0.0005542034267770915, 0.0004931611592492089,
      0.0004050793242769069, 0.00029579285227541194, 0.0001722130101237368,
      4.1897018697691746e-05, -8.740829785247603e-05, -0.00020822162267979414,
      -0.00031375461269268887, -0.0003982876333440446, -0.00045747332740897137,
      -0.000488552325140494, -0.0004904709287418608, -0.00046389657140387706,
      -0.00041113290173034743, -0.00033594212454057495, -0.00024328741035450774,
      -0.0001390124835228315, -2.9478687146724244e-05, 7.881825365184599e-05,
      0.00017962896754853392, 0.00026730662836932465, 0.0003371185772622922,
      0.00038549647846004387, 0.000410212136036172, 0.0004104707629239771,
      0.0003869185084735451, 0.0003415661162500556, 0.0002776354040709184,
      0.00019933956008994565, 0.0001116117961883673, 1.9799507317141494e-05,
      -7.065737335406347e-05, -0.00015454471937578792, -0.00022717085834793609,
      -0.00028462487978747977, -0.000323982636716495, -0.0003434498882468157,
      -0.0003424359653963167, -0.00032155555562612953, -0.00028256044094225163,
      -0.00022820704294304055, -0.00016206919847804176, -8.830851633818522e-05,
      -1.1416795984680118e-05, 6.405377854040783e-05, 0.00013375667004193295,
      0.00019379789605975193, 0.00024094998884242723, 0.0002728214693426667,
      0.0002879731919705454, 0.00028597623560253245, 0.0002674095548907186,
      0.00023379915280726064, 0.00018750388436731785, 0.00013155596342363682,
      6.946665771982933e-05, 5.009396650385842e-06, -5.8006501446775955e-05,
      -0.00011595808680283573, -0.0001656142191590134, -0.00020431271254551308,
      -0.0002300996572185863, -0.00024182384567586222, -0.00023918202795965746,
      -0.00022271369262137823, -0.00019374703653117365, -0.00015430057697814572,
      -0.00010694731591450428, -5.465035507814439e-05, -5.802791645862668e-07,
      5.2074594801568706e-05, 0.00010029388840658114, 0.00014139607867405212,
      0.00017318513087804198, 0.00019406498463956626, 0.00020311610955617998,
      0.0002001307054819945, 0.0001856056168109956, 0.00016069451120575298,
      0.00012712319740754987, 8.707399329943688e-05, 4.304669373818518e-05,
      -2.295156602674803e-06, -4.628336115042392e-05, -8.640015512657468e-05,
      -0.00012042037599306245, -0.00014653281135310541, -0.0001634342374408083,
      -0.00017039142219973144, -0.0001672683548613648, -0.00015451805731485772,
      -0.00013314040698461343, -0.00010460933643102971, -7.077446279166924e-05,
      -3.3743549123786696e-05, 4.2468595189712205e-06, 4.096479348470768e-05,
      7.431235668566396e-05, 0.00010244394853732756, 0.00012386664744199185,
      0.00013751740643760404, 0.00014281320249300887, 0.00013967195571892805,
      0.00012850379125350152, 0.00011017395055458435, 8.594027018675653e-05,
      5.736954464653478e-05, 2.62381998398176e-05, -5.576531190336928e-06,
      -3.620835392104226e-05, -6.391001058021157e-05, -8.715155100037859e-05,
      -0.00010470333345641874, -0.00011569934639557798, -0.00011967770374216308,
      -0.00011659657702611761, -0.00010682530100976259, -9.11118385003187e-05,
      -7.05291311369807e-05, -4.640402114736638e-05, -2.0233342039225235e-05,
      6.407602487483742e-06, 3.1958650682643855e-05, 5.496499254296461e-05,
      7.415882951134394e-05, 8.852797164016771e-05, 9.736774005705289e-05,
      0.00010031361008389524, 9.735321806134535e-05, 8.8817590600598e-05,
      7.535266556229704e-05, 5.787328991412352e-05, 3.7502838488015485e-05,
      1.550234808383604e-05, -6.806434619393288e-06, -2.811945791421547e-05,
      -4.722562971988031e-05, -6.307465522689292e-05, -7.48337075885807e-05,
      -8.192994107093898e-05, -8.407675892815532e-05, -8.128274805564198e-05,
      -7.38432285057596e-05, -6.231537708402673e-05, -4.747881241976765e-05,
      -3.0284322451592903e-05, -1.179403172323351e-05, 6.883285782928196e-06,
      2.465786044678678e-05, 4.0521708229447867e-05, 5.360497037709717e-05,
      6.32227129610806e-05, 6.890972518764088e-05, 7.044161875214777e-05,
      6.78413718898517e-05, 6.13713302183707e-05, 5.151152080787612e-05,
      3.892590776347699e-05, 2.441887408503856e-05, 8.884720662873656e-06,
      -6.746696368205434e-06, -2.156492851154608e-05, -3.4731289639566776e-05,
      -4.5525632114871706e-05, -5.338497788636197e-05, -5.7931980357730324e-05,
      -5.899183799343519e-05, -5.6596988504692006e-05, -5.09796402420714e-05,
      -4.2552902306006294e-05, -3.188191654935316e-05, -1.9646937523022253e-05,
      -6.6007216382514046e-06, 6.477146288972311e-06, 1.8826253888706895e-05,
      2.974900894909421e-05, 3.864946235547118e-05, 4.506518144512041e-05,
      4.8690509852065985e-05, 4.939009502357005e-05, 4.720215998949973e-05,
      4.233160572164084e-05, 3.513361873096817e-05, 2.6088991825689576e-05,
      1.5772814702042097e-05, 4.8185314776676325e-06, -6.1204224501008145e-06,
      -1.6409110861855295e-05, -2.5467475533639896e-05, -3.280254743397032e-05,
      -3.803473177617543e-05, -4.0916799977795845e-05, -4.134468199550765e-05,
      -3.93596531656589e-05, -3.5142020424194145e-05, -2.8996903669876035e-05,
      -2.1333151095402216e-05, -1.2636798098132713e-05, -3.440758307869328e-06,
      5.707391391243315e-06, 1.4277609436548353e-05, 2.1787702105692223e-05,
      2.7830040245104202e-05, 3.209322538831991e-05, 3.437758298491161e-05,
      3.4603749222796265e-05, 3.281403881592366e-05, 2.916670883488581e-05,
      2.3923643155051438e-05, 1.7432350092485382e-05, 1.0103472037275768e-05,
      2.3852342546573806e-06, -5.263600658208537e-06, -1.2400661589987167e-05,
      -1.862522012783064e-05, -2.36003427789133e-05, -2.7070741103700272e-05,
      -2.8875398946613592e-05, -2.8954384107166383e-05, -2.7349605531169398e-05,
      -2.419963518304413e-05, -1.972905527218677e-05, -1.4233097060209964e-05,
      -8.058590294109545e-06, -1.5824291302921689e-06, 4.811127836165294e-06,
      1.0752973611256512e-05, 1.5910182139299494e-05, 2.0004369617412517e-05,
      2.2826393256495244e-05, 2.424663247665428e-05, 2.422037444071943e-05,
      2.278812305133802e-05, 2.0070950255338815e-05, 1.6261293238760133e-05,
      1.1609854723094681e-05, 6.409472195627084e-06, 9.769746201516424e-07,
      -4.365865384219302e-06, -9.31115322885611e-06, -1.3582380839252874e-05,
      -1.694964043211903e-05, -1.9241721805106487e-05, -2.0354474506992613e-05,
      -2.025504986086996e-05, -1.898188748532494e-05, -1.664056176481866e-05,
      -1.3395841063167098e-05, -9.460522931102704e-06, -5.081780631513996e-06,
      -5.258810344412889e-07, 3.937794650239645e-06, 8.052480442567205e-06,
      1.1588598621116732e-05, 1.4356360974362102e-05, 1.621571952646628e-05,
      1.7083160220881297e-05, 1.6935030054351606e-05, 1.5807297830728477e-05,
      1.3791858529070871e-05, 1.1029689063216532e-05, 7.701337787644702e-06,
      4.01537196284393e-06, 1.955091750655188e-07, -3.5327844212889255e-06,
      -6.955436298443352e-06, -9.881893883320596e-06, -1.21555580956466e-05,
      -1.3661963730100628e-05, -1.433429227910321e-05, -1.4155968890866337e-05,
      -1.3160271201296864e-05, -1.1427053275626633e-05, -9.076852668105377e-06,
      -6.262793374752415e-06, -3.1608143460549903e-06, 4.1163794342186604e-08,
      3.1544760181116466e-06, 6.000690602489647e-06, 8.421696691642827e-06,
      1.02883398099094e-05, 1.1507142903202728e-05, 1.2024774137498373e-05,
      1.1830062679858135e-05, 1.0953511456493636e-05, 9.464402632089862e-06,
      7.465728789252247e-06, 5.087302792323608e-06, 2.4774955902915643e-06,
      -2.0588120275548365e-07, -2.804995366440107e-06, -5.17116150140631e-06,
      -7.173230189264256e-06, -8.70473261455744e-06, -9.689399224710563e-06,
      -1.0084775717313535e-05, -9.883777607253789e-06, -9.1141486308139e-06,
      -7.83591092493909e-06, -6.1370091878071456e-06, -4.1274504716301335e-06,
      -1.932320503957633e-06, 3.158875786387835e-07, 2.4851680107754876e-06,
      4.451656141738027e-06, 6.106603108612804e-06, 7.3622846488790855e-06,
      8.156529589647737e-06, 8.455642193168453e-06, 8.255591907758116e-06,
      7.5814481095088016e-06, 6.485139954856035e-06, 5.041716582578725e-06,
      3.344365281424626e-06, 1.4985104351365493e-06, -3.8463925337662274e-07,
      -2.1947056156753263e-06, -3.828529391917862e-06, -5.195967192017407e-06,
      -6.224776292949327e-06, -6.8643281425662435e-06, -7.08796645131197e-06,
      -6.893909436626869e-06, -6.304683046600191e-06, -5.3651576649737335e-06,
      -4.139339955649912e-06, -2.706139719702922e-06, -1.154385244440465e-06,
      4.226030975172763e-07, 1.932553931014275e-06, 3.289575727222294e-06,
      4.418973468261158e-06, 5.261285231161967e-06, 5.775325266526487e-06,
      5.940083600799698e-06, 5.755402645144351e-06, 5.241424467887587e-06,
      4.436873958172609e-06, 3.3963089621784157e-06, 2.186524939335824e-06,
      8.823457377816121e-07, -4.379384981604138e-07, -1.6972118143007281e-06,
      -2.823979695314484e-06, -3.7563699869901624e-06, -4.44546714534707e-06,
      -4.857804123665362e-06, -4.976889866832993e-06, -4.803709682441073e-06,
      -4.356197103594539e-06, -3.6677356313883598e-06, -2.784803516195147e-06,
      -1.7639214599886996e-06, -6.680993000793832e-07, 4.369984492222141e-07,
      1.4869379165041214e-06, 2.4222250252239664e-06, 3.1916277975304057e-06,
      3.7549292747271112e-06, 4.084966507426787e-06, 4.168856428353081e-06,
      4.008359319180511e-06, 3.619381999367315e-06, 3.030672772457323e-06,
      2.281805705842833e-06, 1.420590466174163e-06, 5.000736256778194e-07,
      -4.246833887192449e-07, -1.2998565485740268e-06, -2.0759519750705626e-06,
      -2.7105638593398243e-06, -3.170646394461736e-06, -3.4341808608430728e-06,
      -3.4911573388094685e-06, -3.343832498461272e-06, -3.006268000955572e-06,
      -2.503195705216337e-06, -1.8682937284198807e-06, -1.1419893614186667e-06,
      -3.68929194757011e-07, 4.0472764266709564e-07, 1.1340311575227418e-06,
      1.7778186021728765e-06, 2.3010031530509393e-06, 2.6764480300057796e-06,
      2.8863283785169984e-06, 2.9229156193646075e-06, 2.7887542727974794e-06,
      2.4962373574457344e-06, 2.066621230566399e-06, 1.5285521922266388e-06,
      9.16203583951269e-07, 2.671420744457576e-07, -3.7994564445608885e-07,
      -9.875299570036562e-07, -1.5213868619363507e-06, -1.952496627338619e-06,
      -2.258589021528885e-06, -2.425254896361526e-06, -2.4465712472082617e-06,
      -2.3252165558834124e-06, -2.072083452064712e-06, -1.7054247348766723e-06,
      -1.2495949275336964e-06, -7.334713540516154e-07, -1.8865507722510425e-07,
      3.5243788099997235e-07, 8.584812186112039e-07, 1.3010284189859386e-06,
      1.6560873242288e-06, 1.905393571897309e-06, 2.037317048353727e-06,
      2.0473586006232653e-06, 1.938219198529883e-06, 1.7194490507812255e-06,
      1.4067083727165783e-06, 1.0206932045498243e-06, 5.857976939079671e-07,
      1.2859763830285696e-07, -3.237518204936991e-07, -7.451089751861338e-07,
      -1.111836553078397e-06, -1.4041070829339683e-06, -1.6069518150014104e-06,
      -1.710999183158381e-06, -1.7128682848525927e-06, -1.61520382133057e-06,
      -1.4263601299119645e-06, -1.1597621151238644e-06, -8.329889019192939e-07,
      -4.6664090374171504e-07, -8.306194203607777e-08, 2.9500545788977765e-07,
      6.457516937645232e-07, 9.495416476304476e-07, 1.189996498619235e-06,
      1.3548572601746573e-06, 1.4365857691421002e-06, 1.432675295867631e-06,
      1.3456605595527174e-06, 1.1828346668937175e-06, 9.556973113236463e-07,
      6.79173522746524e-07, 3.706545253677047e-07, 4.892120391473805e-08,
      -2.669841335832717e-07, -5.588707753693219e-07, -8.104331738682144e-07,
      -1.0081471732873263e-06, -1.1419805448220704e-06, -1.205881565253925e-06,
      -1.1980232431094135e-06, -1.1207955919841137e-06, -9.805531888291144e-07,
      -7.871392729953867e-07, -5.532200475710476e-07, -2.9347296094668053e-07,
      -2.3680047732964826e-08, 2.402184540618226e-07, 4.830541733913453e-07,
      6.912907852227722e-07, 8.537662224323586e-07, 9.622769916527254e-07,
      1.0119749106763438e-06, 1.0015582793686641e-06, 9.332519200254249e-07,
      8.125829354779316e-07, 6.479707134112078e-07, 4.501599946601134e-07,
      2.3153416156390296e-07, 5.351858072271866e-09, -2.150466554922108e-07,
      -4.170165026585132e-07, -5.893238664322787e-07, -7.227604263826289e-07,
      -8.106235986828359e-07, -8.490383028366186e-07, -8.371058370760894e-07,
      -7.768758744314237e-07, -6.731479720655609e-07, -5.33118716067471e-07,
      -3.6589915495197966e-07, -1.819340444355973e-07, 7.640720546782143e-09,
      1.916635007143631e-07, 3.595958730481446e-07, 5.021179083975087e-07,
      6.116366389440642e-07, 6.826805229378824e-07, 7.121600681102198e-07,
      6.994830832214811e-07, 6.465217810846441e-07, 5.574376356749501e-07,
      4.383779985156511e-07, 2.970655503593112e-07, 1.4230732039266362e-07,
      -1.654604361384394e-08, -1.7015800815506506e-07, -3.09748038613169e-07,
      -4.27586590088056e-07, -5.174157190011692e-07, -5.747728905886515e-07,
      -5.972017840259843e-07, -5.843408965651829e-07, -5.378880933496412e-07,
      -4.614465045738215e-07, -3.6026391743806214e-07, -2.4088366883965406e-07,
      -1.1072969958810561e-07, 2.2348355784900612e-08, 1.5054254561521074e-07,
      2.665389629942041e-07, 3.6392922440219135e-07, 4.375582680745846e-07,
      4.837899879121102e-07, 5.006774889182508e-07, 4.880306457796228e-07,
      4.473798080269161e-07, 3.818405581746985e-07, 2.9589004386552795e-07,
      1.9507025732108114e-07, 8.563746405261495e-08, -2.5820406980252558e-08,
      -1.3277532652108552e-07, -2.291366982765323e-07, -3.0959331323459706e-07,
      -3.6990082306581305e-07, -4.07099504204105e-07, -4.196515432537606e-07,
      -4.0749203874957586e-07, -3.7199308206169406e-07, -3.1584534576135844e-07,
      -2.4286627959849035e-07, -1.5774803165521953e-07, -6.576135953407638e-08,
      2.756608573313728e-08, 1.1677772727329631e-07, 1.9680306468089502e-07,
      2.6324176510274607e-07, 3.1260117603916083e-07, 3.424747202235016e-07,
      3.516524043937192e-07, 3.4015885285240913e-07, 3.092186097214185e-07,
      2.6115268492470865e-07, 1.9921420518080895e-07, 1.273743562339273e-07,
      5.007238821256581e-08, -2.8054827877952108e-08, -1.0244743418885976e-07,
      -1.6888534695320784e-07, -2.237242031029427e-07, -2.6409151135041256e-07,
      -2.880326876152635e-07, -2.945998434722461e-07, -2.8387971335250874e-07,
      -2.569607384349213e-07, -2.1584285845410572e-07, -1.6329679448029995e-07,
      -1.0268235651174917e-07, -3.7737432659662186e-08, 2.7649294583492545e-08,
      8.966826589136901e-08, 1.448081719084635e-07, 1.9005185321250866e-07,
      2.2303822144633837e-07, 2.4218171283742233e-07, 2.4674348057372074e-07,
      2.3685149161742332e-07, 2.134697375385833e-07, 1.7831971875603883e-07,
      1.3376004839707445e-07, 8.263229686573862e-08, 2.8082940118023064e-08,
      -2.6627603228408467e-08, -7.831740694441068e-08, -1.2406572812243574e-07,
      -1.6137560588267157e-07, -1.8830746553348243e-07, -2.0357674974648716e-07,
      -2.0661087565262268e-07, -1.9756330578604803e-07, -1.7728507123197213e-07,
      -1.472565473890658e-07, -1.0948451582246389e-07, -6.637142623353224e-08,
      -2.0565200884140627e-08, 2.5201170884181407e-08, 6.827065658919961e-08,
      1.0621445408579429e-07, 1.3696690634090727e-07, 1.589356894102742e-07,
      1.7108154018969766e-07, 1.729637141314136e-07, 1.6474945617413213e-07,
      1.4718790450331212e-07, 1.2155090118910186e-07, 8.954503912985152e-08,
      5.32008286624021e-08, 1.474603755687992e-08, -2.35290127449957e-08,
      -5.940615432267113e-08, -9.086625952765759e-08, -1.1620114844945469e-07,
      -1.3410442114843584e-07, -1.4373650701435398e-07, -1.447608479263698e-07,
      -1.3734989151862782e-07, -1.2216135994934334e-07, -1.0028697342673959e-07,
      -7.317734884878874e-08, -4.254807741332743e-08, -1.0272943346509132e-08,
      2.1729167913798492e-08, 5.160693367639488e-08, 7.76822981142288e-08,
      9.854326479367572e-08, 1.1311873614575562e-07, 1.2073153696694508e-07,
      1.2112713019531904e-07, 1.1447701213994073e-07, 1.0135727224742242e-07,
      8.270423185991198e-08, 5.975035608246951e-08, 3.394469254608497e-08,
      6.862874907940883e-09, -1.9887800738345208e-08, -4.4762580626138435e-08,
      -6.636728721873614e-08, -8.353523552927472e-08, -9.538886413578558e-08,
      -1.0138291324055076e-07, -1.0132713922315708e-07, -9.538779783066225e-08,
      -8.406838195414139e-08, -6.817129173824253e-08, -4.8743177010629226e-08,
      -2.7007566497520713e-08, -4.289039279619257e-09, 1.806642949741022e-08,
      3.877021925744279e-08, 5.666436149386248e-08, 7.078527396166609e-08,
      8.041448757562743e-08, 8.511377029122945e-08, 8.474302841021712e-08,
      7.946040967814535e-08, 6.97050817702556e-08, 5.6164153212392114e-08,
      3.972608525895545e-08, 2.1423664571329036e-08, 2.370130128976615e-09,
      -1.630765142045609e-08, -3.3535001271238994e-08, -4.835043946344373e-08,
      -5.995847732805758e-08, -6.777134664770235e-08, -7.143754001477451e-08,
      -7.08558601466381e-08, -6.617455264555684e-08, -5.777597450881482e-08,
      -4.624807858901451e-08, -3.234472543703804e-08, -1.6937428665320814e-08,
      -9.615672853169618e-10, 1.4639661907747318e-08, 2.8970235766978427e-08,
      4.1232074605362184e-08, 5.076875543540177e-08, 5.709981992009457e-08,
      5.994393786442582e-08, 5.9229881208747855e-08, 5.5094999609504e-08,
      4.787162292323303e-08, 3.8062505653643645e-08, 2.63070348172457e-08,
      1.3340412757032239e-08, -5.16251430618519e-11, -1.3079807537258596e-08,
      -2.499726319865175e-08, -3.514175672778742e-08, -4.2971870552242e-08,
      -4.80951948913353e-08, -5.028710376615761e-08, -4.949928021119898e-08,
      -4.5857771758524154e-08, -3.965097124535961e-08, -3.13084924872809e-08,
      -2.1372413059554946e-08, -1.0462760076269724e-08, 7.606013240554823e-10,
      1.163736634198066e-08, 2.154515280172714e-08, 2.993462719694267e-08,
      3.635944158292389e-08, 4.0499382408647313e-08, 4.217556971540029e-08,
      4.135703814206917e-08, 3.815854973574107e-08, 3.2830001864042163e-08,
      2.5738271892039787e-08, 1.7342756879355453e-08, 8.166198841227136e-09,
      -1.2373829269895435e-09, -1.0315712022403577e-08, -1.855028413023699e-08,
      -2.5485571692529376e-08, -3.075378395432603e-08, -3.4093864089537845e-08,
      -3.536377534089289e-08, -3.454554342803959e-08, -3.174295754827702e-08,
      -2.717226131453403e-08, -2.1146563190677126e-08, -1.4055041096734536e-08,
      -6.3382892529735156e-09, 1.538656934434504e-09, 9.113988667509081e-09,
      1.595585862285947e-08, 2.1686655270323253e-08, 2.6003473094863435e-08,
      2.869369231710259e-08, 2.9644895021584836e-08, 2.8848694374171836e-08,
      2.6398418543755084e-08, 2.2480949434850775e-08, 1.736334773908551e-08,
      1.1375181607273848e-08, 4.88770105979341e-09, -1.708847322928692e-09,
      -8.028397757923174e-09, -1.3711375267989756e-08, -1.8444865949014805e-08,
      -2.197953366586404e-08, -2.4142388326407988e-08, -2.484477593549482e-08,
      -2.408525511955424e-08, -2.1947330840923997e-08, -1.8592315503897376e-08
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_9_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<9>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 2.883661955666759e-11), "design.b()[0] == 2.883661955666759e-11");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 2.883661955666759e-11));
    static_assert(almost_equal(design.b()[1], 2.595295760100083e-10), "design.b()[1] == 2.595295760100083e-10");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 2.595295760100083e-10));
    static_assert(almost_equal(design.b()[2], 1.0381183040400332e-09), "design.b()[2] == 1.0381183040400332e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 1.0381183040400332e-09));
    static_assert(almost_equal(design.b()[3], 2.4222760427600773e-09), "design.b()[3] == 2.4222760427600773e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 2.4222760427600773e-09));
    static_assert(almost_equal(design.b()[4], 3.6334140641401164e-09), "design.b()[4] == 3.6334140641401164e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 3.6334140641401164e-09));
    static_assert(almost_equal(design.b()[5], 3.6334140641401164e-09), "design.b()[5] == 3.6334140641401164e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 3.6334140641401164e-09));
    static_assert(almost_equal(design.b()[6], 2.4222760427600773e-09), "design.b()[6] == 2.4222760427600773e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 2.4222760427600773e-09));
    static_assert(almost_equal(design.b()[7], 1.0381183040400332e-09), "design.b()[7] == 1.0381183040400332e-09");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - 1.0381183040400332e-09));
    static_assert(almost_equal(design.b()[8], 2.595295760100083e-10), "design.b()[8] == 2.595295760100083e-10");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 2.595295760100083e-10));
    static_assert(almost_equal(design.b()[9], 2.883661955666759e-11), "design.b()[9] == 2.883661955666759e-11");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - 2.883661955666759e-11));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -8.71735144068649), "design.a()[1] == -8.71735144068649");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -8.71735144068649));
    static_assert(almost_equal(design.a()[2], 33.9128623819697), "design.a()[2] == 33.9128623819697");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 33.9128623819697));
    static_assert(almost_equal(design.a()[3], -77.27190553532162), "design.a()[3] == -77.27190553532162");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -77.27190553532162));
    static_assert(almost_equal(design.a()[4], 113.6422420516901), "design.a()[4] == 113.6422420516901");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 113.6422420516901));
    static_assert(almost_equal(design.a()[5], -111.86712644977325), "design.a()[5] == -111.86712644977325");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -111.86712644977325));
    static_assert(almost_equal(design.a()[6], 73.7058620042268), "design.a()[6] == 73.7058620042268");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 73.7058620042268));
    static_assert(almost_equal(design.a()[7], -31.342923748408754), "design.a()[7] == -31.342923748408754");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -31.342923748408754));
    static_assert(almost_equal(design.a()[8], 7.805765865103746), "design.a()[8] == 7.805765865103746");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 7.805765865103746));
    static_assert(almost_equal(design.a()[9], -0.8674251140358897), "design.a()[9] == -0.8674251140358897");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.8674251140358897));
    std::cout << "max_deviation(cheby1,lowpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      2.883661955666759e-11, 5.109085230468528e-10, 4.513955142895038e-09, 2.667389952134784e-08,
      1.1927984795636036e-07, 4.328164799498592e-07, 1.3335100739633408e-06,
      3.60157782086442e-06, 8.729676122001753e-06, 1.933148845597614e-05,
      3.96563385013645e-05, 7.618857489232898e-05, 0.00013829206885531526,
      0.00023884255403019104, 0.00039477583341797785, 0.0006274700589433664,
      0.0009628770101555084, 0.0014313217317985013, 0.0020669025965572574,
      0.0029064447093713683, 0.003987987714996227, 0.005348822973171331,
      0.007023132582975121, 0.009039321256719954, 0.01141716865758137, 0.014164961530435102,
      0.017276788913096183, 0.020730197412391876, 0.024484405024474937,
      0.028479260064336792, 0.032635106101587985, 0.036853674970379724, 0.04102007946977848,
      0.045005917728115574, 0.04867343557598203, 0.051880625461011465, 0.05448707462157942,
      0.05636031571147526, 0.057382383970512374, 0.05745625006957189, 0.056511779932693185,
      0.05451087424773593, 0.05145146202690065, 0.04737006427786905, 0.04234270417030506,
      0.03648401641136395, 0.029944497179614782, 0.022905932319624622, 0.015575140335810811,
      0.008176262461705552, 0.0009419191134294042, -0.005896374930237815,
      -0.012118089900772878, -0.017523376246065855, -0.02194208987231938,
      -0.02524168064866894, -0.027333522241938663, -0.02817733023260774,
      -0.027783405199151456, -0.026212543591426468, -0.023573576257029244,
      -0.020018616213989537, -0.01573621706453876, -0.010942754687137846,
      -0.005872441260889608, -0.000766456731093719, 0.0041382659618446095,
      0.008620042345551797, 0.012482671418508881, 0.015564387033120242,
      0.017745072424061287, 0.018951373256477083, 0.019159453208945687, 0.0183952589674434,
      0.016732291944230537, 0.014287014941275905, 0.01121214617963101, 0.007688203784608522,
      0.003913754853194895, 9.48896154187237e-05, -0.0035655207173496857,
      -0.006878216123008339, -0.009677046722109277, -0.011827087754234522,
      -0.013230958726751743, -0.01383303576693197, -0.013621363381319612,
      -0.012627198712704374, -0.010922250885702242, -0.008613802930233339,
      -0.005838017144519342, -0.0027518203674037067, 0.00047616172720414685,
      0.003675106395944418, 0.006681400097777582, 0.009347430915804346, 0.01154929077589302,
      0.013192979263905863, 0.014218791036265208, 0.01460367571966599, 0.014361476573784143,
      0.013541075277353681, 0.012222588079478625, 0.010511866573743256,
      0.008533648474619349, 0.006423774949090272, 0.004320937481084759,
      0.002358436582829762, 0.00065642615694236, -0.0006849181945990978,
      -0.0015909287321551457, -0.0020163757695313093, -0.0019475980899598677,
      -0.0014027401275789816, -0.0004301132110131195, 0.0008951937048982785,
      0.0024762290927211822, 0.004200310104136105, 0.0059459947121185824,
      0.007590476385167334, 0.009016964721351162, 0.010121622790456308,
      0.010819663993207551, 0.011050265827855926, 0.0107800315598693, 0.010004818867767842,
      0.008749851759346422, 0.007068132635670785, 0.005037269433373383,
      0.002754922642683684, 0.00033315358593812364, -0.0021079855919578635,
      -0.004447241376706183, -0.006568933115172648, -0.008369324655803728,
      -0.009762235641105552, -0.010683584515204556, -0.011094622094963327,
      -0.010983694119229295, -0.010366458677080512, -0.009284574582294813,
      -0.007802964302484991, -0.006005834910392638, -0.003991708186448707,
      -0.0018677627490600451, 0.0002561757910563463, 0.002273647731138381,
      0.004087233929209278, 0.005613578204339963, 0.00678748844435801, 0.007564907002833701,
      0.007924611429281428, 0.007868583499567539, 0.007421063226208877,
      0.006626380350808453, 0.0055457243438609555, 0.004253071278924915,
      0.002830528975938197, 0.0013633883104378804, -6.482261565126345e-05,
      -0.0013769937436437308, -0.002506535890787611, -0.0034007099525496,
      -0.004023014020587426, -0.004354521289653086, -0.004394127635957479,
      -0.004157734343621267, -0.0036764545977059637, -0.002993988318798463,
      -0.002163355476199915, -0.0012432106836151313, -0.0002939799974234509,
      0.0006259363239841513, 0.0014636635549880013, 0.002174849308339461,
      0.002725990044797153, 0.0030959672491864057, 0.0032767266639023643,
      0.00327309002170045, 0.0031017438327123094, 0.00278950053572612,
      0.0023709706496634828, 0.0018858179195005917, 0.0013757909833569323,
      0.0008817337182111529, 0.0004407719088438209, 8.385681909743072e-05,
      -0.00016618200304639372, -0.000295959735501066, -0.0003021640831293035,
      -0.0001914643687449761, 2.0273589982320282e-05, 0.000309396944031655,
      0.0006463898542630351, 0.0009981704151520799, 0.001330596705931681,
      0.001611007278958394, 0.0018106221038072558, 0.0019066421022661782,
      0.001883907969846766, 0.001736010363111412, 0.0014657815747781792,
      0.001085140957760463, 0.0006143098032376035, 8.045328660640123e-05,
      -0.0004841552373508547, -0.0010443212834960812, -0.0015643188859480756,
      -0.002010321627612931, -0.0023527120279843473, -0.002568115164169743,
      -0.002641021326871773, -0.0025648901630006236, -0.002342663272637581,
      -0.0019866513266716714, -0.0015178028921351491, -0.0009644026235252588,
      -0.00036028368903075203, 0.00025732913405783486, 0.0008502053479991657,
      0.0013815685061683586, 0.0018184700803026213, 0.0021339232794331253,
      0.002308658248314662, 0.0023323845402894137, 0.0022044785255045246,
      0.0019340504050077145, 0.0015393853733064629, 0.0010467936520884794,
      0.0004889420410956538, -9.722711415162833e-05, -0.0006728571625337153,
      -0.0011996681949819968, -0.0016424190561947407, -0.0019711831382828535,
      -0.0021632924211799943, -0.002204825107895117, -0.002091540991209076,
      -0.0018292035553148824, -0.0014332665548071784, -0.000927942978321477,
      -0.00034471336364322834, 0.0002796340723709651, 0.0009053093221691282,
      0.0014920282799179615, 0.002001565013225435, 0.0024001882288989633,
      0.002660828432717064, 0.0027648387821161795, 0.002703237711537538,
      0.002477353507172684, 0.002098828119861784, 0.0015889773208839358,
      0.0009775443486852425, 0.00030092197716204486, -0.00040004888706276923,
      -0.0010825694567060686, -0.0017045093337470958, -0.002227007186281457,
      -0.0026168854138794995, -0.002848729472319341, -0.0029065028287613287,
      -0.0027845967764806336, -0.002488248812464327, -0.002033301849499798,
      -0.0014453168260074936, -0.0007580908185617543, -1.1669130397757438e-05,
      0.000750029200621158, 0.001481829349330237, 0.0021400040278098283,
      0.002684898788929614, 0.003083320536235775, 0.003310544743613291,
      0.0033518199311222685, 0.003203278336900074, 0.0028721976080894954,
      0.00237659751582198, 0.0017441957948351808, 0.0010107857829397444,
      0.00021813325447508046, -0.000588481388286597, -0.0013629283066060168,
      -0.002060941373846846, -0.0026427173256486428, -0.003075246184866015,
      -0.0033342347514609544, -0.003405509722355902, -0.0032858185127961972,
      -0.002982982162251877, -0.0025153936155119065, -0.0019108938177856798,
      -0.0012050950923447393, -0.00043925396102284867, 0.00034217802461584653,
      0.0010941783073345514, 0.0017737954196852847, 0.002342652165447297,
      0.0027691621067920773, 0.0030303295805672106, 0.003113029134091616,
      0.0030146920111582785, 0.0027433631864908874, 0.0023171302594991172,
      0.0017629629908515708, 0.0011150371490884752, 0.0004126465516869522,
      -0.00030216904609960734, -0.0009871366211825642, -0.0016022523053470378,
      -0.0021121246360134103, -0.0024880205011894203, -0.002709494625537486,
      -0.002765509407826945, -0.00265498324752644, -0.0023867402614327696,
      -0.001978870370416372, -0.0014575439504025574, -0.0008553574800714212,
      -0.00020931396745215575, 0.0004414372029755795, 0.0010579631879717387,
      0.0016038707884254728, 0.002047451009306688, 0.0023635185027538405,
      0.002534838965640232, 0.0025530634430371117, 0.0024191189830862457,
      0.0021430383129381544, 0.0017432451288405607, 0.001245344162829308,
      0.0006804944522954982, 8.346846446899165e-05, -0.0005094824952078101,
      -0.0010628258404973023, -0.0015438751572163754, -0.0019247202185740022,
      -0.0021838455929412935, -0.0023073439732805325, -0.0022896559054050927,
      -0.0021337969845451506, -0.0018510650059487752, -0.0014602510715486239,
      -0.0009864083614311275, -0.0004592583963067866, 8.866439759810767e-05,
      0.00062401437195146, 0.0011146596651462415, 0.0015316076775228598,
      0.0018507156667688669, 0.002054085539124881, 0.0021310622891190546,
      0.0020787805676698995, 0.0019022319619967157, 0.0016138550076026832,
      0.0012326789175867922, 0.0007830787513761137, 0.00029322265248735765,
      -0.00020669048702770835, -0.0006862930488273943, -0.001116895811191095,
      -0.001473207923926783, -0.0017348266365547014, -0.001887409006459324,
      -0.0019234583078571663, -0.0018426822144978205, -0.0016519065074161454,
      -0.0013645554073974352, -0.0009997359714684975, -0.0005809877256247944,
      -0.00013477841146570125, 0.00031115875593572566, 0.000729542415834515,
      0.001095209031042814, 0.001386626027725421, 0.0015871612732373183,
      0.0016860341394499684, 0.0016788938719399273, 0.001567994545047368,
      0.0013619610481940183, 0.0010751657569996551, 0.0007267592453944777,
      0.00033941915337448465, -6.210210277867107e-05, -0.000452538676379369,
      -0.0008076839776019465, -0.0011058774556474815, -0.0013293146823789657,
      -0.0014651019181345284, -0.0015059930373514992, -0.0014507670309963534,
      -0.0013042269916222673, -0.0010768251013019148, -0.0007839412169103211,
      -0.0004448637641637108, -8.153952978045588e-05, 0.0002828274886142474,
      0.0006252395448192458, 0.0009243393876441795, 0.0011617265445926263,
      0.00132307515418921, 0.0013989859997070014, 0.0013855225740445481,
      0.0012844011132675266, 0.0011028263028574539, 0.000852986424077563,
      0.0005512427011006371, 0.0002170662449802671, -0.0001282088615000062,
      -0.00046273703711050907, -0.0007655321903796896, -0.0010177727601022703,
      -0.0012039602253215691, -0.0013128603301167177, -0.0013381703917132032,
      -0.0012788735658626395, -0.0011392607175711514, -0.0009286213443590319,
      -0.0006606255273087537, -0.00035243787440986194, -2.3620709561369968e-05,
      0.0003051036355398832, 0.0006131533988697748, 0.0008813695379444779,
      0.0010931999483626362, 0.0012357129499379772, 0.0013003783962730088,
      0.0012835696483420502, 0.0011867573143490451, 0.0010163849822656997,
      0.0007834369499125481, 0.0005027269638339686, 0.00019195404372170707,
      -0.00012941444583447763, -0.0004413620572236757, -0.000724568611002673,
      -0.0009616043246832209, -0.0011379991275105895, -0.0012431218111516682,
      -0.0012708158860994297, -0.0012197544274930496, -0.001093493826539298,
      -0.0009002251099661327, -0.0006522401847967093, -0.00036514785602607437,
      -5.688968028923647e-05, 0.00025338226263094197, 0.0005464954946142061,
      0.0008044412566606748, 0.0010114795812694172, 0.001155097645451202,
      0.0012267632283117624, 0.0012224281154147969, 0.001142752003439407,
      0.0009930348761805728, 0.0007828638620417921, 0.0005254981287959358,
      0.00023703134696070622, -6.461531352770777e-05, -0.00036080660629588153,
      -0.0006333438695044881, -0.0008655819059399435, -0.0010434436064498042,
      -0.001156270577308112, -0.0011974585182686539, -0.0011648396632922553,
      -0.001060790385061891, -0.0008920590917619858, -0.0006693267555338001,
      -0.0004065287481562034, -0.00011998112378808603, 0.000172633793912336,
      0.0004533593923425822, 0.0007050668498750296, 0.000912499675472596,
      0.0010631970471652093, 0.0011482401442564454, 0.0011627768915347496,
      0.0011062944128102225, 0.000982624156015655, 0.0007996811299248001,
      0.0005689549675014097, 0.00030478560707062567, 2.346934470356379e-05,
      -0.0002577489195357341, -0.0005217348385110625, -0.000752510061618355,
      -0.000936220140095906, -0.0010619662574739234, -0.0011224508879350142,
      -0.001114399214764028, -0.00103873212077135, -0.0009004819205529358,
      -0.0007084577908225715, -0.0004746831008333712, -0.0002136406214803951,
      5.8626932662692944e-05, 0.00032550508400022173, 0.0005708235430831178,
      0.0007798377325631319, 0.0009401162505967486, 0.0010422808289581552,
      0.0010805547479596032, 0.001053087695717084, 0.000962038948208857,
      0.000813415635745187, 0.0006166778332621688, 0.0003841363507607722,
      0.00013018154882982885, -0.0001296084848017539, -0.0003794250807493658,
      -0.0006041925900864575, -0.0007904796512161628, -0.0009273029917790318,
      -0.0010067756341886978, -0.0010245612535581296, -0.00098010857205145,
      -0.0008766533045812177, -0.0007209894525578306, -0.0005230257974898397,
      -0.00029515641806906936, -5.148515961581144e-05, 0.0001930474394192922,
      0.0004235807155888371, 0.0006262376968501635, 0.0007889611746678994,
      0.0009022316394107213, 0.00095962432405923, 0.0009581727838355869,
      0.0008985185236533178, 0.0007848394170172201, 0.0006245632211954941,
      0.000427885552966298, 0.0002071234535699928, -2.4054566842805032e-05,
      -0.0002514739350648159, -0.0004613226189445021, -0.000640989723459026,
      -0.0007798231760462763, -0.0008697609908248629, -0.0009057987259456684,
      -0.0008862660848470358, -0.0008128975095708195, -0.0006906943317368111,
      -0.000527588799801677, -0.00033393231006577633, -0.00012184070609218322,
      9.556205430932309e-05, 0.0003049547305555122, 0.0004936340936831105,
      0.0006502848311098165, 0.0007656574380375094, 0.0008331135217967359,
      0.0008490064214419103, 0.0008128754068053188, 0.0007274433183430276,
      0.0005984196210176811, 0.0004341227266445929, 0.0002449463648251421,
      4.270409298430446e-05, -0.00016010682396603654, -0.0003510763815009689,
      -0.0005186401586314026, -0.0006527787164496927, -0.0007456158257601276,
      -0.0007918798598150192, -0.00078920139327759, -0.0007382303242690737,
      -0.0006425670393936291, -0.0005085135776369152, -0.00034466171564324303,
      -0.00016134472679118312, 3.0012331979332963e-05, 0.00021760305899420175,
      0.0003899667828765427, 0.0005366875729031916, 0.0006490226164893283,
      0.0007204221168559269, 0.0007469098610192381, 0.0007273024317915799,
      0.0006632551302536097, 0.0005591334071364442, 0.00042171930921146815,
      0.00025977247404996, 8.347394489922671e-05, -9.62119970958201e-05,
      -0.00026821808171083317, -0.00042205426297163345, -0.0005484461683770902,
      -0.0006398929988881063, -0.0006911113901151194, -0.0006993390468495097,
      -0.0006644808051068565, -0.0005890896020383455, -0.0004781850328807553,
      -0.0003389221166114065, -0.00018013197052904302, -1.1763759368194548e-05,
      0.00015573692088851894, 0.0003120744794441069, 0.00044773466736040563,
      0.0005545621801080359, 0.000626249537110924, 0.0006587080100659073,
      0.0006502988753860593, 0.0006019120366511773, 0.0005168885509592705,
      0.0004007932098736462, 0.00026105247983456564, 0.00010648124061602478,
      -5.327161666383309e-05, -0.00020832395163382649, -0.00034917017477923014,
      -0.0004672625358461335, -0.0005555284310440854, -0.0006087924998109031,
      -0.0006240784030621593, -0.0006007727847370699, -0.0005406425369195002,
      -0.00044770557794930957, -0.0003279643505943626, -0.00018901960184527838,
      -3.958920978041898e-05, 0.0001110375562113782, 0.0002535762493060668,
      0.000379318260153411, 0.0004806615838134653, 0.0005515690611730944,
      0.0005879265476329536, 0.0005877798438993793, 0.0005514368515095371,
      0.0004814298102824525, 0.0003823411142427884, 0.00026050455413283635,
      0.0001236013880206049, -1.9823060337051737e-05, -0.0001608919089442858,
      -0.0002909452018077731, -0.0004020705361466254, -0.0004875833777133903,
      -0.0005424279699425332, -0.0005634748618742443, -0.0005496976286525086,
      -0.0005022189228293126, -0.0004242241018111541, -0.00032074882429664183,
      -0.0001983546959323781, -6.47138035429404e-05, 7.18715990604417e-05,
      0.00020298422437993143, 0.000320609782812345, 0.00041762607553269115,
      0.00048823334940528186, 0.0005282999649595371, 0.0005356028400647006,
      0.000509948759762859, 0.00045317006993538834, 0.00036899603664209205,
      0.000262808774793647, 0.00014129966270605464, 1.2048137675290402e-05,
      -0.00011695064638131837, -0.00023777989490927107, -0.00034308648312327255,
      -0.0004265277872692484, -0.00048315292569970974, -0.0005096955435383238,
      -0.0005047608879083579, -0.00046889654667166443, -0.00040454344755877763,
      -0.00031587108838705994, -0.00020850803917637443, -8.918509215631609e-05,
      3.468634667998585e-05, 0.00015547424158402016, 0.00026579576364718876,
      0.00035896808384043404, 0.0004294126285255724, 0.00047298838044319185,
      0.0004872343575466273, 0.0004715071327486527, 0.00042700580856843817,
      0.00035668382337123144, 0.00026505391004856115, 0.0001578990279345752,
      4.190774957487644e-05, -7.57429345610316e-05, -0.00018783139331235996,
      -0.0002875342956905329, -0.00036884157134924565, -0.0004269181827211907,
      -0.00045839096643297784, -0.00046154357162334417, -0.0004364082941435976,
      -0.0003847500163031846, -0.0003099441136185984, -0.00021675667321485346,
      -0.00011104128711437577, 6.283204962878423e-07, 0.00011136679841487676,
      0.00021440144048348988, 0.00030348610081111396, 0.00037327947730955756,
      0.0004196648794551976, 0.00043999236956753776, 0.0004332290802272461,
      0.0004000092532223799, 0.00034258175883345506, 0.00026465915369756335,
      0.00017117833419994042, 6.79881752373916e-05, -3.851610997592447e-05,
      -0.00014178905273458945, -0.00023553694214198157, -0.00031410109656454174,
      -0.00037279907364357176, -0.0004082032694090326, -0.0004183403630739625,
      -0.00040280005027392134, -0.00036274716018689854, -0.00030083721923891433,
      -0.00022104143774491578, -0.00012839259399215056, -2.8668039566036134e-05,
      7.197023455804598e-05, 0.00016735606847299508, 0.0002516966674801283,
      0.0003199241037243031, 0.0003679994774714282, 0.00039315150875506716,
      0.00039403549950219616, 0.0003708036018378641, 0.0003250828370705639,
      0.00025986299006963394, 0.0001793020059330172, 8.846150442816283e-05,
      -7.010798613982239e-06, -0.00010123186377986288, -0.00018844553051738683,
      -0.0002633738698645538, -0.0003215362611846996, -0.00035951692533588587,
      -0.000375164967414866, -0.000367715251656089, -0.000337823379630228,
      -0.00028751336164479406, -0.0002200419312068341, -0.00013968852483384328,
      -5.148442606769119e-05, 3.910181594442004e-05, 0.00012650305040228844,
      0.00020539532086402625, 0.00027102182992005735, 0.0003194793806369769,
      0.000347950069966612, 0.0003548645106456025, 0.00033998717034026526,
      0.00030441926879138303, 0.0002505197635886921, 0.00018174996905524678,
      0.00010245198398034483, 1.7575072095908162e-05, -6.763279324061212e-05,
      -0.00014794902198768162, -0.00021849614647466062, -0.0002750376534955343,
      -0.00031423198918211675, -0.00033382953332048966, -0.0003328009650385099,
      -0.0003113897454664065, -0.00027108615551465305, -0.000214525156027033,
      -0.0001453149863092731, -6.78076020538777e-05, 1.3174477529217794e-05,
      9.26377974634877e-05, 0.00016572547844823852, 0.0002280136975949369,
      0.0002757790628604784, 0.00030622074502371444, 0.00031762414283671107,
      0.0003094565543092639, 0.0002823895766040302, 0.0002382474935305424,
      0.00017988545260732213, 0.00011100550459356763, 3.5922317814861965e-05,
      -4.070663714008727e-05, -0.00011416958608037202, -0.0001799897865388633,
      -0.00023419795524935944, -0.00027357123233001483, -0.0002958243204850713,
      -0.000299741492893732, -0.0002852418857296041, -0.0002533746465452286,
      -0.00020624483961712622, -0.00014687524683861756, -7.901308887618848e-05,
      -6.893990830541532e-06, 6.502196770115281e-05, 0.00013232569400430116,
      0.00019092902720541528, 0.00023731268163266692, 0.00026873717393240256,
      0.00028340411767083327, 0.000280558420559992, 0.0002605256242347357,
      0.00022468265279212496, 0.0001753643344722792, 0.00011571197901955651,
      4.9473792709019485e-05, -1.9230217241331007e-05, -8.616412771486143e-05,
      -0.00014723690396410238, -0.00019875208676374437, -0.00023763114477892743,
      -0.00026159701932683974, -0.00026930694485216393, -0.00026042683222148293,
      -0.00023564315139750543, -0.00019661211760162384, -0.00014584983169716533,
      -8.657061552634713e-05, -2.2483898352348357e-05, 4.2437535610949514e-05,
      0.00010420348120256237, 0.00015905122367705486, 0.00020367441519968566,
      0.0002354220151926064, 0.00025245534726226664, 0.0002538539955329348,
      0.0002396644795731183, 0.00021088920785813968, 0.00016941689358468317,
      0.00011789919669034595, 5.9581613473271705e-05, -1.9006267767533204e-06,
      -6.274884373668702e-05, -0.00011923530047345529, -0.0001679312657018393,
      -0.00020591480977995053, -0.00023094576108455647, -0.00024159736971462705,
      -0.00023733696889426462, -0.00021855111747965056, -0.000186514150009669,
      -0.00014330254052489296, -9.166078921246375e-05, -3.482746577009553e-05,
      2.366758594585602e-05, 8.022220161225599e-05, 0.00013138344404337705,
      0.00017405813551701443, 0.0002056995558206375, 0.00022445905665516535,
      0.00022929358929653712, 0.0002200229218503524, 0.00019733346010824843,
      0.0001627288865008287, 0.00011843109118004854, 6.723788832236938e-05,
      1.2346606219365607e-05, -4.284534397144428e-05, -9.495049756711067e-05,
      -0.00014079899506196168, -0.00017763115581820288, -0.00020326328423019924,
      -0.0002162167653969073, -0.00021580284195227414, -0.0002021582452245371,
      -0.00017622990800639422, -0.00013971012335675724, -9.492654096412371e-05,
      -4.469412499614621e-05, 7.861530020526937e-06, 5.9498451381546295e-05,
      0.0001070580502711053, 0.0001476580988881912, 0.00017886714700173292,
      0.00019884983915119002, 0.00020647446634156747, 0.00020137647433712564,
      0.0001839744037711046, 0.00015543768339269294, 0.0001176086546135905,
      7.288399171605404e-05, 2.4063128251480782e-05, -2.5826740824882728e-05,
      -7.371815588495944e-05, -0.000116691788195326, -0.00015215417651763107,
      -0.00017799399740662082, -0.00019270746861756367, -0.00019548545629886004,
      -0.0001862572668267545, -0.00016568880178501316, -0.0001351355719011111,
      -9.655382899524472e-05, -5.2375615228698945e-05, -5.3556922967828535e-06,
      4.16000297591797e-05, 8.561389107404762e-05, 0.00012401264455421952,
      0.00015448961057395474, 0.00017524300100345757, 0.00018508213319288862,
      0.00018349529250610386, 0.00017067540544847114, 0.00014750230395036454,
      0.00011548303261941823, 7.665421056164191e-05, 3.3452751710881697e-05,
      -1.1436865776648971e-05, -5.5249221849247386e-05, -9.530813823898477e-05,
      -0.00012918996171289794, -0.00015486999611764364, -0.0001708432491203042,
      -0.00017621230835442796, -0.00017073723705774303, -0.0001548447504220703,
      -0.00012959645292467633, -9.661842821017384e-05, -5.799682276661075e-05,
      -1.614611001686517e-05, 2.6341660288602017e-05, 6.685722693715264e-05,
      0.00010293418584283716, 0.00013239895352194905, 0.00015350151871569074,
      0.0001650191298158089, 0.00016632679089183732, 0.0001574305252892809,
      0.0001389616820422321, 0.00011213296279670069, 7.865918757945394e-05,
      4.0647953616742964e-05, 4.671433120725845e-07, -3.940240220135437e-05,
      -7.65198884650326e-05, -0.00010863382581916881, -0.00013381842332272492,
      -0.00015058886708220324, -0.00015798859560699143, -0.00015564345946153546,
      -0.00014377972553277938, -0.00012320512808077421, -9.525444054448535e-05,
      -6.170320432420835e-05, -2.4655171841882792e-05, 1.358941462791701e-05,
      5.067647242432083e-05, 8.434282015446116e-05, 0.0001125541219513628,
      0.0001336276366324838, 0.00014633237652956804, 0.00014996072805729304,
      0.00014436738572841715, 0.0001299734900109201, 0.00010773601016722642,
      7.908454323165171e-05, 4.5829679178517515e-05, 1.0048790085612517e-05,
      -2.604356468184979e-05, -6.023254317680726e-05, -9.043878170784806e-05,
      -0.00011484469980007391, -0.00013200368733234306, -0.0001409256261252997,
      -0.00014113370440393502, -0.0001326892849901934, -0.00011618357379748973,
      -9.269688092351119e-05, -6.372824645927636e-05, -3.1099996246206985e-05,
      3.1567091175955706e-06, 3.692815502814608e-05, 6.814834208738969e-05,
      9.492522448240135e-05, 0.00011565521333633155, 0.00012911902553492554,
      0.00013455316075104804, 0.00013169283189167044, 0.00012078395953584288,
      0.00010256375761572619, 7.821136700652165e-05, 4.9271817450315374e-05,
      1.7558205438524845e-05, -1.4961730371857172e-05, -4.628755059912616e-05,
      -7.450902582334688e-05, -9.792247351159394e-05, -0.00011513344514961705,
      -0.00012513958434602862, -0.00012738874467759713, -0.00012180901437150579,
      -0.00010880904558057975, -8.924892004814856e-05, -6.438358723965642e-05,
      -3.578257518070172e-05, -5.231097453102355e-06, 2.5381223145255298e-05,
      5.4177087364834286e-05, 7.940650601823596e-05, 9.955300570468884e-05,
      0.00011342461717238567, 0.0001202241972401367, 0.00011959494838286659,
      0.00011163855569193068, 9.690506152926117e-05, 7.6355338318093e-05,
      5.1298692537669324e-05, 2.330963614472555e-05, -5.870895386204304e-06,
      -3.444369042600291e-05, -6.066206426124515e-05, -8.293850222869815e-05,
      -9.994064007025436e-05, -0.00011067078748497154, -0.00011452425888651733,
      -0.00011132311479429579, -0.00010132345359542734, -8.519603075804753e-05
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      2.883661955666759e-11, 5.109085230468528e-10, 4.513955142895038e-09, 2.6673899521347845e-08,
      1.1927984795636046e-07, 4.3281647994986007e-07, 1.3335100739633454e-06,
      3.6015778208644403e-06, 8.729676122001833e-06, 1.933148845597645e-05,
      3.965633850136561e-05, 7.618857489233263e-05, 0.00013829206885532618,
      0.00023884255403022118, 0.00039477583341805515, 0.0006274700589435534,
      0.0009628770101559407, 0.0014313217317994645, 0.0020669025965593265,
      0.002906444709375671, 0.003987987715004939, 0.0053488229731885875,
      0.007023132583008552, 0.00903932125678306, 0.011417168657696928, 0.014164961530639805,
      0.017276788913446733, 0.0207301974129728, 0.024484405025408537, 0.02847926006579596,
      0.03263510610381294, 0.03685367497370016, 0.041020079474643416, 0.045005917735134154,
      0.048673435585979696, 0.051880625475107016, 0.05448707464128895, 0.05636031573884782,
      0.05738238400829959, 0.05745625012142956, 0.056511780003407175, 0.05451087434345802,
      0.051451462155371906, 0.04737006444860021, 0.04234270439467729, 0.03648401670261059,
      0.02994449755264494, 0.02290593279065459, 0.01557514092177784, 0.00817626317945117,
      0.0009419199786543296, -0.005896373904228487, -0.012118088704497714,
      -0.01752337487541407, -0.021942088330145958, -0.02524167894635317,
      -0.027333520400811172, -0.028177328285145492, -0.02778340318983992,
      -0.026212541577194295, -0.02357357430717262, -0.020018614409520723,
      -0.015736215496916058, -0.010942753456360853, -0.005872440472973647,
      -0.0007664564949687619, 0.00413826553793333, 0.008620041158033793,
      0.012482669372734066, 0.015564384047702521, 0.017745068435145638, 0.01895136822174586,
      0.01915944711117782, 0.018395251817446008, 0.01673228378297677, 0.014287005841105602,
      0.011212136244401632, 0.007688193148721185, 0.003913743679462541,
      9.48780917887542e-05, -0.003565532382159205, -0.006878227704853861,
      -0.009677057987599933, -0.011827098467555938, -0.013230968656915332,
      -0.013833044695204175, -0.01362137110856881, -0.012627205066395981,
      -0.010922255726275608, -0.008613806156607435, -0.005838018698497887,
      -0.002751820236783351, 0.00047616350697753205, 0.0036751097416779606,
      0.006681404880044907, 0.009347436962065662, 0.011549297875158048,
      0.013192987172817302, 0.014218799486424667, 0.01460368442597333, 0.01436148524351711,
      0.013541083619679322, 0.012222595815062725, 0.010511873444110571,
      0.008533654250916812, 0.006423779439918382, 0.0043209405390890404,
      0.002358438109783785, 0.0006564261071052514, -0.0006849198130061134,
      -0.0015909318574388411, -0.0020163802889934584, -0.0019476038442733281,
      -0.001402746916927435, -0.0004301208027752708, 0.0008951855672059271,
      0.0024762206795853436, 0.004200301689657347, 0.005945986563505601,
      0.0075904687525399795, 0.009016957828270347, 0.010121616825573653,
      0.01081965910338469, 0.011050262113044388, 0.010780029069968774, 0.010004817601596662,
      0.008749851665766473, 0.007068133616813922, 0.005037271349821906, 0.00275492532036798,
      0.00033315682443471687, -0.002107982010110802, -0.004447237676107698,
      -0.006568929517532846, -0.008369321370259957, -0.0097622328553322,
      -0.010683582387729177, -0.011094620749042402, -0.010983693638559408,
      -0.010366459103528796, -0.009284575915730457, -0.0078029665026864035,
      -0.006005837900898253, -0.00399171186011896, -0.001867766975029496,
      0.00025617115942980575, 0.00227364284777152, 0.004087228946710359,
      0.005613573265817805, 0.006787483676072383, 0.007564902508086952, 0.00792460728387949,
      0.007868579749088094, 0.007421059885210183, 0.00662637740400004, 0.005545721749143372,
      0.004253068972096272, 0.002830526876766951, 0.0013633863297197767,
      -6.48245684940431e-05, -0.0013769957528977695, -0.0025065380272013145,
      -0.003400712266966253, -0.004023016538871626, -0.004354524009250276,
      -0.004394130524331746, -0.004157737338706405, -0.0036764576103852265,
      -0.002993991237306359, -0.0021633581722218624, -0.0012432130197546807,
      -0.00029398183561845086, 0.0006259351135803185, 0.0014636630851819902,
      0.0021748496666604326, 0.0027259912863537975, 0.0030959693910739476,
      0.0032767296815355653, 0.00327309384734626, 0.0031017483563760373,
      0.002789505608414417, 0.0023709760889133197, 0.0018858235169333978,
      0.001375796513898569, 0.000881738950518279, 0.00044077661640132417,
      8.386079140452839e-05, -0.00016617894979912084, -0.0002959577488438683,
      -0.0003021632663449997, -0.00019146477497087553, 2.0271961237004987e-05,
      0.0003093941477329738, 0.0006463859979827474, 0.0009981656545444027,
      0.0013305912377614322, 0.0016110013320176093, 0.001810615928171935,
      0.0019066359574355938, 0.0018839021123696644, 0.0017360050343329355,
      0.0014657769893367722, 0.0010851372934255574, 0.0006143071926085808,
      8.04518110950221e-05, -0.00048415555095329395, -0.0010443204637025224,
      -0.001564317014491445, -0.0020103188347207926, -0.0023527084852778125,
      -0.0025681110755753486, -0.002641016918036682, -0.002564885669775944,
      -0.0023426589292379423, -0.001986647354129293, -0.001517799487643211,
      -0.0009643999512100361, -0.00036028187260811386, 0.00025733001639344775,
      0.0008502052662300499, 0.001381567478565134, 0.0018184681710420592,
      0.002133920593905246, 0.0023086549264229894, 0.002332380748150408,
      0.002204474446030226, 0.001934046227905579, 0.0015393812850499576,
      0.0010467898264005559, 0.0004889386304459516, -9.722998560324947e-05,
      -0.0006728594042056486, -0.0011996697531177537, -0.001642419914973383,
      -0.0019711833188007385, -0.0021632919784309148, -0.00220482412598527,
      -0.002091539577136627, -0.0018292018317161726, -0.0014332646521191292,
      -0.0009279410268302491, -0.00034471148588212505, 0.0002796357684450401,
      0.0009053107488490637, 0.0014920293739759795, 0.0020015657384981627,
      0.002400188577129918, 0.0026608284226641455, 0.002764838457034432,
      0.002703237135241072, 0.002477352758958929, 0.00209882728864175,
      0.0015889764989007534, 0.0009775436252180685, 0.0003009214326030885,
      -0.000400049186402755, -0.0010825694627615242, -0.0017045090195983727,
      -0.0022270065476427963, -0.0026168844691143384, -0.0028487282610145186,
      -0.0029065014089794195, -0.002784595220888199, -0.0024882472035987284,
      -0.002033300274484716, -0.001445315371054911, -0.0007580895636045905,
      -1.166814418258367e-05, 0.000750029864686516, 0.0014818296563313953,
      0.002140003963305892, 0.0026848983596570774, 0.003083319769515002,
      0.003310543685516339, 0.0033518186435357593, 0.0032032768936821492,
      0.002872196090571805, 0.002376596007943162, 0.0017441943782095005,
      0.0010107845321627275, 0.00021813223294752244, -0.0005884821317722934,
      -0.0013629287403250435, -0.002060941484517347, -0.0026427171186634356,
      -0.003075245683392883, -0.003334233994493605, -0.0034055087618611287,
      -0.0032858174101558714, -0.002982980984237981, -0.002515392430056685,
      -0.0019108926898158552, -0.0012050940799385262, -0.00043925311212218693,
      0.00034217867474587365, 0.0010941787377589053, 0.0017737956244841362,
      0.0023426521534160483, 0.0027691619002024846, 0.0030303292130950564,
      0.0031130286480677634, 0.0030146914543403257, 0.0027433626085796607,
      0.002317129708636358, 0.0017629625103318311, 0.0011150367744998196,
      0.000412646308662948, -0.0003021691433776917, -0.0009871365706464934,
      -0.0016022521168355475, -0.0021121243302280493, -0.0024880201078969046,
      -0.0027094941811529345, -0.0027655089525528012, -0.0026549828222503973,
      -0.0023867399046028533, -0.0019788701151115633, -0.001457543821803051,
      -0.0008553574935047917, -0.0002093141271522157, 0.00044143690430906596,
      0.0010579627687788576, 0.00160387027708072, 0.0020474504421809786,
      0.0023635179216730203, 0.002534838414911116, 0.0025530629662428275,
      0.002419118619870127, 0.0021430380959983984, 0.001743245081346026,
      0.0012453442964409165, 0.0006804947659393137, 8.346894395866833e-05,
      -0.0005094818766568307, -0.001062825120878131, -0.0015438743835400962,
      -0.0019247194440067917, -0.002183844873444203, -0.002307343363962442,
      -0.0022896554568216697, -0.002133796739184204, -0.0018510649951345326,
      -0.001460251312974535, -0.0009864088574941714, -0.0004592591333680937,
      8.86634489582902e-05, 0.0006240132556783273, 0.001114658437511549,
      0.0015316064041000891, 0.0018507144187538507, 0.0020540843892171983,
      0.002131061307210523, 0.0020787798166024955, 0.0019022314936521158,
      0.0016138548595691538, 0.0012326791106172658, 0.0007830792878057362,
      0.00029322351572232943, -0.00020668933190218052, -0.0006862916533398645,
      -0.0011168942407643572, -0.001473206254295613, -0.0017348249495244897,
      -0.0018874073852514545, -0.0019234568323146565, -0.0018426809564360568,
      -0.001651905526397681, -0.001364554747187013, -0.0009997356573860118,
      -0.0005809877629619996, -0.00013477878507014868, 0.00031115808087510085,
      0.000729541491837384, 0.0010952079253301725, 0.001386624818326154,
      0.0015871600444338323, 0.001686032976829032, 0.0016788928573400364,
      0.0015679937517017954, 0.0013619605363586476, 0.0010751655703272525,
      0.0007267594082737744, 0.00033941966939585725, -6.210125113564722e-05,
      -0.0004525375268136926, -0.0008076825858655382, -0.0011058758923485404,
      -0.0013293130289007914, -0.0014651002619092805, -0.0015059914667671546,
      -0.0014507656302373462, -0.001304225835748603, -0.0010768242518576906,
      -0.0007839407183213753, -0.0004448636411374283, -8.153978586136205e-05,
      0.00028282687124802275, 0.0006252386043071705, 0.000924338180205007,
      0.001161725141229894, 0.0013230736365363882, 0.0013989844552589215,
      0.0013855210910577844, 0.0012843997756315575, 0.0011028251852395559,
      0.0008529855876274595, 0.0005512421899670016, 0.00021706608384231734,
      -0.00012820866874340426, -0.0004627365074209356, -0.000765531360428448,
      -0.0010177716839618713, -0.0012039589711408958, -0.0013128589759811274,
      -0.0013381690209384167, -0.0012788722620038688, -0.0011392595594446437,
      -0.0009286204013711888, -0.0006606248553684178, -0.0003524375126634658,
      -2.36206781406441e-05, 0.000305103336629007, 0.0006131527896568524,
      0.0008813686572142954, 0.0010931988512670988, 0.0012357117046476265,
      0.0013003770798719217, 0.0012835683422137024, 0.0011867560993295567,
      0.0010163839338530568, 0.0007834361338152986, 0.0005027264321209292,
      0.00019195383179683976, -0.00012941432125835884, -0.00044136159903920244,
      -0.0007245678414638956, -0.0009616032840260572, -0.0011379978715278212,
      -0.0012431204078739509, -0.0012708144117856803, -0.0012197529621729081,
      -0.0010934924493749064, -0.0009002238947088394, -0.0006522391956061512,
      -0.00036514714389500184, -5.6889280279043766e-05, 0.0002533823331893403,
      0.0005464952368586124, 0.0008044406898436874, 0.0010114787413465977,
      0.001155096582708406, 0.0012267620041850787, 0.00122242679870312,
      0.0011427506661437225, 0.0009930335892236132, 0.0007828626911258051,
      0.0005254971306447885, 0.00023703056616626635, -6.461584687425859e-05,
      -0.0003608068780569139, -0.0006333438819592072, -0.0008655816772452642,
      -0.0010434431691470076, -0.0011562699759808505, -0.0011974578065081492,
      -0.00116483890016571, -0.0010607896313078735, -0.000892058405950296,
      -0.0006693261904264167, -0.00040652834749054363, -0.00011998091967507833,
      0.00017263378282307727, 0.0004533591618273023, 0.0007050664101818362,
      0.0009124990504579586, 0.0010631962725861344, 0.0011482392653350535,
      0.0011627759599558, 0.0011062934833456087, 0.00098262328299107, 0.0007996803637514294,
      0.0005689543514893097, 0.00030478517472089743, 2.346911764482521e-05,
      -0.0002577489328426703, -0.0005217346432253466, -0.000752509676106346,
      -0.0009362195946859013, -0.001061965592462497, -0.00112245015097521,
      -0.001114398457803351, -0.001038731396734488, -0.000900481279978813,
      -0.0007084572786668731, -0.00047468275363605605, -0.0002136404650737405,
      5.86268847647295e-05, 0.00032550483143385927, 0.0005708230986394799,
      0.0007798371213693383, 0.0009401155085281817, 0.0010422800003843256,
      0.0010805538829670176, 0.0010530868469843504, 0.0009620381677300226,
      0.000813414971605747, 0.0006166773266678712, 0.0003841360335026055,
      0.00013018144134051746, -0.000129608374681993, -0.00037942475822475263,
      -0.0006041920730512232, -0.0007904789691199689, -0.0009273021837867736,
      -0.0010067747467526651, -0.0010245603375563345, -0.0009801076796719778,
      -0.0008766524861471563, -0.0007209887534898356, -0.0005230252555936104,
      -0.00029515606131364587, -5.1485004537029815e-05, 0.00019304738859560137,
      0.0004235804670547251, 0.0006262372705535347, 0.0007889606009275744,
      0.0009022309569003532, 0.000959623577290624, 0.0009581720203023885,
      0.0008985177908162339, 0.0007848387593206986, 0.0006245626773026548,
      0.00042788515338410763, 0.00020712321881122885, -2.4054627448727175e-05,
      -0.0002514738238413685, -0.00046132234959264825, -0.0006409893200584894,
      -0.0007798226714003609, -0.000869760424256612, -0.0009057981406871532,
      -0.0008862655251885761, -0.0008128970179514291, -0.0006906939459602916,
      -0.0005275885505543968, -0.0003339322188928188, -0.00012184078395945483,
      9.556180777642633e-05, 0.0003049543271088642, 0.000493633555761525,
      0.0006502841904646939, 0.0007656567337603606, 0.0008331127978719042,
      0.0008490057239775237, 0.0008128747811156719, 0.0007274428060649783,
      0.0005984192574416862, 0.0004341225384278311, 0.00024494636823060796,
      4.270429275726957e-05, -0.00016010643501220928, -0.0003510758221615447,
      -0.0005186394582670447, -0.00065277791328536, -0.0007456149646289126,
      -0.0007918789894841533, -0.0007892005635197964, -0.0007382295828583528,
      -0.0006425664292094436, -0.000508513134054318, -0.0003446614643691755,
      -0.0001613446822800309, 3.001216743312004e-05, 0.00021760269542987805,
      0.00038996624209538313, 0.0005366868871849356, 0.0006490218266736934,
      0.0007204212699047832, 0.0007469090072066358, 0.0007273016216914348,
      0.0006632544117071057, 0.0005591328223823792, 0.0004217188923527926,
      0.00025977224900927, 8.34739239862348e-05, -9.621181391897053e-05,
      -0.00026821770682285064, -0.0004220537203452635, -0.0005484454921382049,
      -0.0006398922312685115, -0.0006911105789232882, -0.0006993382426122352,
      -0.0006644800580542729, -0.0005890889591137395, -0.00047818453495455867,
      -0.0003389217960658976, -0.00018013184935739766, -1.1763847900052994e-05,
      0.00015573662456093394, 0.0003120739893077454, 0.0004477340086036412,
      0.0005545613875792901, 0.0006262486532092418, 0.0006587070821928151,
      0.0006502979531138408, 0.0006019111687790223, 0.0005168877826346453,
      0.00040079257995139124, 0.0002610520186309954, 0.00010648096819065694,
      -5.3271691598825116e-05, -0.00020832383211475962, -0.00034916987528293216,
      -0.00046726208129604355, -0.0005555278551949427, -0.0006087918431137153,
      -0.0006240777101419669, -0.0006007721016386529, -0.0005406419082892733,
      -0.00044770504432448376, -0.00032796394596288974, -0.0001890193516226593,
      -3.958912932326397e-05, 0.00011103746246845153, 0.000253575988041972,
      0.00037931784867339756, 0.0004806610489172663, 0.0005515684374514181,
      0.0005879258752995752, 0.000587779166293606, 0.000551436212422973,
      0.0004814292512736667, 0.00038234067210316165, 0.0002605042586565994,
      0.00012360126021259045, -1.9823009509912175e-05, -0.0001608916791854372,
      -0.0002909448034731195, -0.0004020699895816019, -0.00048758271198955626,
      -0.0005424272210743939, -0.0005634740706280268, -0.0005496968380826197,
      -0.0005022181756937774, -0.0004242234380235792, -0.00032074827856885417,
      -0.00019835429574914035, -6.471356758888067e-05, 7.18716619299706e-05,
      0.00020298411556614356, 0.0003206095137776121, 0.00041762566699963226,
      0.00048823283000426005, 0.0005282993694116008, 0.0005356022070145686,
      0.0005099481293969002, 0.00045316948153150614, 0.0003689955262013249,
      0.0002628083728970236, 0.00014129939272526532, 1.204801444302425e-05,
      -0.00011695061736451125, -0.00023777971768818758, -0.0003430861709137734,
      -0.00042652736152494415, -0.0004831524146820695, -0.000509694980482559,
      -0.0005047603089014375, -0.0004688959883755007, -0.0004045429449200081,
      -0.00031587067247449183, -0.0002085077352781354, -8.918491825168746e-05,
      3.468638098308174e-05, 0.00015547413558432245, 0.00026579552552960604,
      0.0003589677301056478, 0.00042941218290946996, 0.00047298787239699624,
      0.00048723382037511577, 0.0004715066015241716, 0.0004270053179513249,
      0.0003566834054719935, 0.000265053592463516, 0.0001578988320749094,
      4.1907689390024176e-05, -7.57428533899353e-05, -0.00018783117366282719,
      -0.00028753394875901, -0.00036884111590035666, -0.00042691764387641726,
      -0.00045839037407736656, -0.0004615429585318771, -0.0004364076939454487,
      -0.0003847494614112291, -0.0003099436332527215, -0.00021675629164081555,
      -0.00011104102220570523, 6.284582867428544e-07, 0.00011136680661316793,
      0.00021440132465162123, 0.00030348587410333256, 0.00037327915955938845,
      0.0004196644958536644, 0.00043999194901799904, 0.00043322865348180184,
      0.0004000088509176755, 0.00034258140954918884, 0.0002646588821587899,
      0.00017117815973454725, 6.798811058355951e-05, -3.8516059439816095e-05,
      -0.00014178888929186663, -0.00023553667555504677, -0.0003141007434216205,
      -0.0003727986562779633, -0.0004082028144603822, -0.0004183398997830062,
      -0.00040279960861830237, -0.00036274676897504954, -0.0003008369042811008,
      -0.000221041220215252, -0.00012839248908308817, -2.8668055518279133e-05,
      7.197009699084963e-05, 0.0001673558160926107, 0.00025169631424201857,
      0.00031992366989184355, 0.0003679989883794587, 0.0003931509932601747,
      0.0003940349882162353, 0.0003708031252542928, 0.0003250824236994303,
      0.000259862664696129, 0.00017930178810650563, 8.846140727404658e-05,
      -7.010769187404756e-06, -0.00010123170943192951, -0.00018844526036276794,
      -0.0002633734999063987, -0.0003215358133294056, -0.00035951642605120505,
      -0.000375164446114705, -0.00036771473891177643, -0.0003378229053182468,
      -0.0002875129531443881, -0.00022004161175732942, -0.00013968831215122794,
      -5.148433130363944e-05, 3.910178883926674e-05, 0.00012650290487402116,
      0.00020539506750055916, 0.0002710214857636325, 0.0003194789681084654,
      0.00034794961546948843, 0.00035486404293666956, 0.0003399867187679629,
      0.00030441886151001766, 0.0002505194258577399, 0.00018174972172700567,
      0.00010245184226704189, 1.757504468968898e-05, -6.76327046434559e-05,
      -0.00014794882273196918, -0.00021849584856131402, -0.0002750372747928982,
      -0.00031423155228474197, -0.00033382906412776745, -0.00033280049114222206,
      -0.00031138929444737254, -0.0002710857532535657, -0.00021452482513301487,
      -0.00014531474476178565, -6.780746213989478e-05, 1.3174509919525312e-05,
      9.263772314174576e-05, 0.0001657253048175403, 0.00022801343813383124,
      0.00027577873623581473, 0.0003062203738895079, 0.0003176237523951698,
      0.00030945617072430134, 0.0002823892253661187, 0.0002382471978741546,
      0.00017988523207834533, 0.00011100537385423865, 3.592228575860401e-05,
      -4.0706567911077865e-05, -0.00011416941938461242, -0.00017998953234636878,
      -0.00023419762903256796, -0.00027357085407701365, -0.00029582391343788275,
      -0.0002997410820910341, -0.0002852414964449005, -0.0002533743027174549,
      -0.00020624456237064637, -0.00014687505318355294, -7.901299066844622e-05,
      -6.893994054501646e-06, 6.502186328453366e-05, 0.00013232549482394384,
      0.00019092874546495505, 0.00023731233454099362, 0.0002687367826289218,
      0.00028340370591304123, 0.0002805580132552819, 0.00026052524590756645,
      0.00022468232608124417, 0.00017536407875041156, 0.0001157118092200185,
      4.9473718430620095e-05, -1.923019229717194e-05, -8.616400594150826e-05,
      -0.0001472366936709582, -0.00019875180163388137, -0.0002376308029979095,
      -0.0002615966424376199, -0.00026930655640754864, -0.0002604264563178024,
      -0.0002356428111800926, -0.0001966118338340769, -0.00014584962148209222,
      -8.657049125565472e-05, -2.248386695075762e-05, 4.2437473103703925e-05,
      0.00010420332968632202, 0.0001590509936804377, 0.00020367412222410347,
      0.00023542167875236056, 0.0002524549896804237, 0.00025385364056738967,
      0.00023966415095734076, 0.00021088892784597554, 0.0001694166815879724,
      0.00011789906809209458, 5.958157868806701e-05, -1.9005629387647203e-06,
      -6.274868236466883e-05, -0.00011923504849294044, -0.00016793093545916418,
      -0.00020591441830067, -0.00023094532905213393, -0.0002415969202324631,
      -0.00023733652610696587, -0.00021855070513759117, -0.00018651379006388803,
      -0.00014330225183705402, -9.166058645714863e-05, -3.4827358594595956e-05,
      2.366759345508406e-05, 8.022211112620578e-05, 0.00013138326284052766,
      0.00017405787599823102, 0.00020569923472063588, 0.00022445869400044573,
      0.00022929320717474396, 0.00022002254306701643, 0.00019733310681316376,
      0.00016272857886756012, 0.00011843084621820841, 6.723771889361839e-05,
      1.2346520315138565e-05, -4.284534364888746e-05, -9.495041369752943e-05,
      -0.000140798835471169, -0.00017763093293067303, -0.00020326301424650997,
      -0.0002162164672487951, -0.0002158025361012435, -0.00020215795237899165,
      -0.0001762296478366257, -0.000139709913286605, -9.492639511276882e-05,
      -4.469405333369297e-05, 7.861522253670058e-06, 5.949836395807727e-05,
      0.00010705788794815027, 0.00014765787107095824, 0.00017886686712280218,
      0.0001988495238060544, 0.00020647413423572264, 0.00020137614511118673,
      0.00018397409677743312, 0.00015543741649945517, 0.00011760844310991938,
      7.28838473852206e-05, 2.4063058668142626e-05, -2.5826732731501745e-05,
      -7.371807197679879e-05, -0.00011669163497310033, -0.00015215396468174308,
      -0.00017799374116041542, -0.0001927071847576829, -0.00019548516315032223,
      -0.00018625698308961456, -0.00016568854536451772, -0.00013513535879385982,
      -9.655367229999304e-05, -5.2375524342353755e-05, -5.355672344372664e-06,
      4.1599978226488365e-05, 8.561377209554281e-05, 0.0001240124664912043,
      0.0001544893855742186, 0.00017524274423298488, 0.0001850818618833109,
      0.00018349502487751977, 0.0001706751595746442, 0.00014750209663653093,
      0.00011548287836182073, 7.665412065254258e-05, 3.3452733543548756e-05,
      -1.1436809161045944e-05, -5.524909194597374e-05, -9.530794098509388e-05,
      -0.00012918970712057307, -0.00015486969765916993, -0.00017084292290344392,
      -0.00017621197213964419, -0.00017073690917816526, -0.00015484444867275846,
      -0.0001295961934892895, -9.661822469051671e-05, -5.799668537389977e-05,
      -1.6146044973355932e-05, 2.6341651102109837e-05, 6.68571460676441e-05,
      0.00010293404008134345, 0.00013239875346237766, 0.00015350127808453642,
      0.00016501886461491489, 0.00016632651840757764, 0.000157430263029409,
      0.00013896144666572738, 0.00011213276910201024, 7.865904761259293e-05,
      4.064787595304387e-05, 4.6713255445705255e-07, -3.9402345678182056e-05,
      -7.651976851026395e-05, -0.0001086336502432095, -0.00013381820339369602,
      -0.00015058861681377906, -0.00015798833088228996, -0.00015564319704753564,
      -0.00014377948204611225, -0.00012320491896835226, -9.525427914115924e-05,
      -6.170310104457149e-05, -2.4655133554815573e-05, 1.3589385004818465e-05,
      5.067637608693641e-05, 8.434266232246932e-05, 0.00011255391153363845,
      0.0001336273856694332, 0.00014633209944775382, 0.00014996044078295368,
      0.0001443671047148207, 0.00012997323123941512, 0.00010773578818308757,
      7.908437027330859e-05, 4.582956445268443e-05, 1.0048739231598689e-05,
      -2.60435499071934e-05, -6.0232464975714834e-05, -9.043864607671474e-05,
      -0.00011484451613461653, -0.00013200346782843688, -0.00014092538501338448,
      -0.00014113345706479258, -0.0001326890470068247, -0.00011618336000135958,
      -9.26967044933878e-05, -6.372811812729771e-05, -3.1099923658902e-05,
      3.1567218453761916e-06, 3.6928107540457824e-05, 6.81482377831741e-05,
      9.492507028200227e-05, 0.00011565501923431942, 0.00012911880396793357,
      0.00013455292582041707, 0.0001316925984892886, 0.00012078374242714519,
      0.0001025635705360692, 7.821122182595398e-05, 4.927172345722123e-05,
      1.7558168785023078e-05, -1.4961707030033806e-05, -4.628746824763075e-05,
      -7.450888901171238e-05, -9.79222900594489e-05, -0.00011513322565598616,
      -0.00012513934153294165, -0.00012738849260910122, -0.00012180876759647074,
      -0.00010880881825197832, -8.924872507254226e-05, -6.438343550838135e-05,
      -3.578247492889009e-05, -5.231053784543243e-06, 2.5381208539801052e-05,
      5.417701628024532e-05, 7.940638359580581e-05, 9.955284009123316e-05,
      0.00011342441900005949, 0.00012022397896009103, 0.00011959472349452001,
      0.00011163833791566134, 9.690486397338813e-05, 7.635517269095051e-05,
      5.129856845241083e-05, 2.330956055844367e-05, -5.870918565997609e-06,
      -3.4443660544986366e-05, -6.066198392123067e-05, -8.293837709150636e-05,
      -9.99404784762877e-05, -0.00011067059991147584, -0.00011452405728013027,
      -0.00011132291181989544, -0.00010132326184807514, -8.519586198669528e-05
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_lowpass_48_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev1<48>(3.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      4.0875685865923555e-58, 3.8874074520628476e-56, 1.847857019181176e-54, 5.854886721331379e-53,
      1.3914022032301893e-51, 2.6459953940350254e-50, 4.1951300964297854e-49,
      5.704854220626379e-48, 6.794051807261265e-47, 7.199865707564689e-46,
      6.875617950244607e-45, 5.97778047138053e-44, 4.771952237915985e-43,
      3.522799644245746e-42, 2.4197621820870643e-41, 1.554711292154133e-40,
      9.387063925697373e-40, 5.3479423966934e-39, 2.8853473507343576e-38,
      1.4790282671604234e-37, 7.224277960221693e-37, 3.3713576541429946e-36,
      1.5068048059834657e-35, 6.464134525139698e-35, 2.667139041017687e-34,
      1.0604105995192326e-33, 4.069540139540984e-33, 1.5099216957982446e-32,
      5.424343838371215e-32, 1.889406761076376e-31, 6.389268412321863e-31,
      2.1001487772983676e-30, 6.717617396142126e-30, 2.093195510568514e-29,
      6.360178130343631e-29, 1.8862713717264882e-28, 5.465145951516146e-28,
      1.5482032176269406e-27, 4.2916957340132475e-27, 1.1650175635255438e-26,
      3.0991988010952113e-26, 8.084903040898145e-26, 2.069611715672303e-25,
      5.20185338402838e-25, 1.2845060270931847e-24, 3.117917192205819e-24,
      7.44343997507772e-24, 1.7485706278176726e-23, 4.043921992882478e-23,
      9.211552136536886e-23, 2.0675919617433728e-22, 4.574904416142207e-22,
      9.982968872294948e-22, 2.1491455014291518e-21, 4.5662660993218174e-21,
      9.578558330262511e-21, 1.9844061261442106e-20, 4.061574520812935e-20,
      8.215387734525833e-20, 1.6427157433263223e-19, 3.2480546298868744e-19,
      6.352311207146686e-19, 1.2291478069210325e-18, 2.3537066270843493e-18,
      4.461534058135129e-18, 8.373433142282071e-18, 1.556361070709796e-17,
      2.8655037864173076e-17, 5.2271906836562196e-17, 9.44935193632228e-17,
      1.6931228281016112e-16, 3.0075376897244277e-16, 5.297248981201538e-16,
      9.253033697351337e-16, 1.6031990934398689e-15, 2.7557061203662763e-15,
      4.699921554261625e-15, 7.954784009070225e-15, 1.3363241637537297e-14,
      2.2284573400443997e-14, 3.6894979141735637e-14, 6.065408347045043e-14,
      9.902392589408065e-14, 1.6056956068993272e-13, 2.586325533777925e-13,
      4.1385886463452797e-13, 6.57992636604123e-13, 1.0395335914216174e-12,
      1.6321206588817915e-12, 2.5468789367806836e-12, 3.950493139141814e-12,
      6.091505033798514e-12, 9.33835115615195e-12, 1.4234061842122797e-11,
      2.1574467845911914e-11, 3.251938349271361e-11, 4.8749786865033424e-11,
      7.268879848658343e-11, 1.0781065815825009e-10, 1.5907041211864402e-10,
      2.334982825286232e-10, 3.410174990443383e-10, 4.955637338129046e-10,
      7.166094517106701e-10, 1.0312290223525473e-09, 1.4768822530991042e-09,
      2.105147430950228e-09, 2.9867028411023065e-09, 4.2179414734631986e-09,
      5.929711310628069e-09, 8.298808038826178e-09, 1.1563013906908237e-08,
      1.6040682378102666e-08, 2.2156120787167096e-08, 3.0472331122613094e-08,
      4.173304211529262e-08, 5.691641498539017e-08, 7.730334254579924e-08,
      1.0456389997500468e-07, 1.408662594246232e-07, 1.8901326431481581e-07,
      2.526128875769897e-07, 3.3628998591821617e-07, 4.4594812328430556e-07,
      5.890917833686685e-07, 7.752210329622121e-07, 1.016312641133442e-06,
      1.3274038045072764e-06, 1.7272969703813022e-06, 2.239406772625901e-06,
      2.892772775214997e-06, 3.7232645169738325e-06, 4.775008215684027e-06,
      6.1020673494026376e-06, 7.770412096982186e-06, 9.860215175085114e-06,
      1.2468513817550597e-05, 1.571227934034485e-05, 1.9731936729186783e-05,
      2.469537675645411e-05, 3.0802502030059845e-05, 3.829034582372246e-05,
      4.7438798235447734e-05, 5.857696784943848e-05, 7.209019830296179e-05,
      8.842774764571929e-05, 0.0001081111237922018, 0.0001317430513929454,
      0.00016001702380787655, 0.00019372736832495293, 0.000233779723172719,
      0.000281201791162805, 0.00033715419702231073, 0.0004029412338339476,
      0.0004800212388598668, 0.0005700162909431548, 0.0006747208714363917,
      0.0007961090792153255, 0.0009363399390690141, 0.0010977602931540058,
      0.0012829047190686857, 0.0014944918775206834, 0.0017354166598524431,
      0.0020087374834090346, 0.00231765807361276, 0.0026655030785138023,
      0.0030556868874348437, 0.0034916750730104155, 0.003976937948196536,
      0.004514895829201327, 0.005108855723890663, 0.005761939324660349, 0.00647700237597203,
      0.007256545709833568, 0.008102618496598771, 0.009016714541578173, 0.009999662766852,
      0.011051513347757379, 0.01217142131874103, 0.013357529816096416, 0.014606855476525954,
      0.015915178850035974, 0.017276943001615194, 0.01868516375555059, 0.020131355265279836,
      0.021605474755961442, 0.02309589037185289, 0.024589376051762656, 0.026071137239682355,
      0.027524871001933057, 0.028932863756423767, 0.03027612931612002, 0.03153458930293575,
      0.03268729719916008, 0.033712706374733586, 0.03458898136856295, 0.03529435052421851,
      0.03580749680391145, 0.03610798225433248, 0.036176700204038424, 0.03599634787016384,
      0.035551910682667054, 0.03483114834151837, 0.033825071453738316, 0.03252839660245619,
      0.030939966929165806, 0.029063124812012436, 0.02690602304332586, 0.024481861090089423,
      0.021809033596337124, 0.018911179282766963, 0.015817119831890217,
      0.012560680220411702, 0.00918038426424902, 0.005719021850859426, 0.002223087407992868,
      -0.001257907458621122, -0.004672240605759527, -0.007966894947953527,
      -0.011088568863840274, -0.013984763511932147, -0.016604925579173205,
      -0.018901620720386834, -0.02083171011972102, -0.022357500342886787,
      -0.023447835071102707, -0.024079096522561842, -0.024236084467143613,
      -0.023912741796442503, -0.02311269767031142, -0.0218496023404089,
      -0.020147231835984877, -0.018039345738235898, -0.015569287182245773,
      -0.012789320889282498, -0.009759712291949198, -0.006547558483229654,
      -0.0032253895825055394, 0.00013043307110410525, 0.0034414879699178943,
      0.0066291928503882805, 0.009616785456274375, 0.012331333594808855,
      0.014705718699789715, 0.016680534912735433, 0.018205845186488084,
      0.019242737228745383, 0.01976462530565485, 0.019758249027157775, 0.01922432718073684,
      0.018177833345862635, 0.01664787021767742, 0.014677131040284074, 0.012320948982435423,
      0.009645948314015667, 0.006728324450590961, 0.0036517928853764823,
      0.0005052592670455461, -0.002619726048701253, -0.005631656186336263,
      -0.008441818446424, -0.010967022211447056, -0.01313221635844913,
      -0.014872908945669533, -0.01613730540237588, -0.016888087919908132,
      -0.017103768124283904, -0.016779557202859334, -0.015927712147173454,
      -0.01457733324646827, -0.012773605914705931, -0.010576498773964023,
      -0.008058949005473761, -0.005304584635232973, -0.00240505094949927,
      0.0005429760457286149, 0.0034409929412423444, 0.006191982602180149,
      0.008703725075048841, 0.010891989768785486, 0.012683494264959756,
      0.014018520651220792, 0.014853089976186295, 0.015160609068259404,
      0.014932921161130402, 0.014180711990100294, 0.012933245595354274,
      0.011237428205908466, 0.009156223408229833, 0.006766466396874127,
      0.004156148509376615, 0.0014212645276870366, -0.0013376664996678682,
      -0.004019281689852964, -0.00652512078600165, -0.008763298398020793,
      -0.010651962065036031, -0.012122401906241573, -0.013121688703519355,
      -0.013614733383692791, -0.013585681526114269, -0.013038581000739966,
      -0.011997288257103323, -0.01050460810679923, -0.008620691937386004,
      -0.006420748968850563, -0.00399215320616987, -0.0014310539803470425,
      0.0011613806812058446, 0.0036829421091580583, 0.006034423840685245,
      0.008123567927283262, 0.009868755163513238, 0.011202288048720891,
      0.012073129980869743, 0.012448984717261424, 0.012317625776718235,
      0.011687415226415608, 0.010586984023576468, 0.009064080447554064,
      0.007183627744572251, 0.005025065460507093, 0.002679079625033744,
      0.00024385362742420036, -0.002179006909751538, -0.004488706696878552,
      -0.006589473926015326, -0.00839457627372226, -0.00982996873446188,
      -0.01083741636695968, -0.011376956043650197, -0.011428588394272573,
      -0.01099312324039505, -0.01009213760243445, -0.008767043315638016,
      -0.007077299787641214, -0.005097844788848215, -0.0029158507330572705,
      -0.0006269441224755258, 0.0016689496892875336, 0.0038719566741307124,
      0.005886609670279259, 0.007626018161918924, 0.009015668075366707,
      0.009996682514832272, 0.01052839716614548, 0.010590133626872332, 0.010182088924890724,
      0.009325298449721697, 0.008060670727723644, 0.0064471340858903705,
      0.004558975390049929, 0.002482487876137981, 0.0003120769109316262,
      -0.001854002176936864, -0.003918082481080141, -0.0057874994354481886,
      -0.007378779716819334, -0.00862141388872819, -0.009461039679950996,
      -0.009861888998417945, -0.00980838492093254, -0.009305813496653926,
      -0.008380037515130341, -0.007076263484068207, -0.005456916901704955,
      -0.0035987224491055994, -0.0015891230121689523, 0.00047779730424408405,
      0.002505697296018676, 0.004400466036863088, 0.006074604111305308,
      0.007451293582172686, 0.00846796552274654, 0.009079196974230343, 0.009258800269699769,
      0.009001005376268533, 0.008320678500351546, 0.007252565682134048,
      0.005849596326265059, 0.004180326375700352, 0.002325641986806578,
      0.00037488011540195434, -0.0015784493613524393, -0.0034411358797741282,
      -0.005124720909516975, -0.006549717764279394, -0.007649395860379557,
      -0.008372947339926766, -0.008687883399625224, -0.008581544574534278,
      -0.008061651864835205, -0.007155871918974138, -0.005910417261944561,
      -0.004387749461729195, -0.0026634968672597367, -0.0008227369760611963,
      0.0010441753046436443, 0.002846029813439371, 0.004495217507714474,
      0.005912002918491816, 0.0070284033256739886, 0.007791484387521659,
      0.008165910472498254, 0.008135624502290826, 0.007704574943438656,
      0.006896454583265131, 0.005753464577947326, 0.004334165547390844,
      0.0027105228105771917, 0.0009642929404497679, -0.0008170683456871763,
      -0.0025447730175387003, -0.004133124548810205, -0.005503778044332168,
      -0.006589624096005874, -0.0073381025400485215, -0.007713780790085374,
      -0.007700068265329911, -0.007299981788837084, -0.006535924530503928,
      -0.005448490718436544, -0.004094357438381225, -0.0025433709009052763,
      -0.0008749752416951656, 0.0008258348420195963, 0.0024728322288868564,
      0.003982927201330458, 0.005280367299079017, 0.0063005542181976005,
      0.006993284306658218, 0.007325248610271982, 0.007281666214941667,
      0.006866968896827644, 0.006104503578248719, 0.005035269318333313,
      0.003715754971591576, 0.002214989688239, 0.0006109587370735418, -0.001013430376192702,
      -0.0025746235288128115, -0.003992717076070245, -0.005195555207335572,
      -0.006122416807344947, -0.006727102409069138, -0.0069802629599084115,
      -0.006870851451227791, -0.006406623953799617, -0.00561366590570243,
      -0.0045349700590055384, -0.003228141681186209, -0.001762351867025224,
      -0.00021469878704069478, 0.0013338326565983394, 0.002802601581273328,
      0.004115511401738768, 0.005204960592959727, 0.0060153381810585, 0.00650588224817754,
      0.006652753284990798, 0.006450215524381688, 0.005910866278543804,
      0.005064903319825779, 0.003958470865522955, 0.0026511730911905067,
      0.0012128877588333488, -0.0002799507966775704, -0.0017484023626307852,
      -0.0031151909528843178, -0.004308774059986585, -0.0052670964447231045,
      -0.005940830848147864, -0.006295935452116827, -0.006315394347906404,
      -0.006000050767217568, -0.0053684910776916886, -0.004455987983505932,
      -0.0033125613197223106, -0.0020002616300356037, -0.0005898228803995624,
      0.0008431360063880707, 0.002222157383457503, 0.0034740226117195116,
      0.00453264371996896, 0.005342561740607944, 0.00586186585237949, 0.0060643787637673675,
      0.005940993311828382, 0.00550009090946858, 0.004767021798948501,
      0.0037826774125072587, 0.00260123379879682, 0.0012871894326240473,
      -8.814159767074683e-05, -0.001450491059721236, -0.0027266440276377617,
      -0.003848376190081593, -0.004756109102552853, -0.005402087103719447,
      -0.005752905820464371, -0.005791257540036161, -0.00551680131270903,
      -0.004946113155936565, -0.004111721585996705, -0.0030602832035530503,
      -0.001849999522978371, -0.000547417144492733, 0.0007762134920429676,
      0.0020488219551525995, 0.003201432711999536, 0.0041718982757552375,
      0.004908248172924616, 0.005371472640644718, 0.0055375911370117905,
      0.005398895037811973, 0.004964299149943688, 0.004258785419886017,
      0.0033219717897952084, 0.0022058868453215114, 0.0009720741034330633,
      -0.0003118138523447076, -0.0015757436496073244, -0.0027511468698334252,
      -0.0037746723549067665, -0.0045916397901724785, -0.005159006136588596,
      -0.005447683651021888, -0.00544408420250909, -0.005150807376288525,
      -0.004586437096243982, -0.003784460586409342, -0.002791371729762522,
      -0.0016640656131465127, -0.0004666698116058797, 0.0007330113645456265,
      0.0018672425410155426, 0.00287208576825767, 0.003690906193834662,
      0.004277462103474886, 0.00459840996170856, 0.004635087844026811, 0.004384480902910344,
      0.0038593180111308697, 0.0030872969501607684, 0.0021094837836941826,
      0.000977977700634602, -0.0002470268985774754, -0.0015006162020339516,
      -0.002716781924738652, -0.0038320932893486496, -0.004789211860207428,
      -0.0055400543014385815, -0.0060484282092763365, -0.006291995932899238,
      -0.0062634590740448665, -0.005970900026565636, -0.005437264039833708,
      -0.004699013232045214, -0.0038040300660932033, -0.002808889463757553,
      -0.0017756536557035755, -0.000768370106904309, 0.00015053103115082926,
      0.0009237383912458968, 0.0015022644134651674, 0.001848175641453051,
      0.001936697040620227, 0.0017575745192526685, 0.0013156216700793686,
      0.0006304226344882227, -0.0002647896557114502, -0.0013250144419030374,
      -0.002496015506858161, -0.003717360913444428, -0.00492579801994511,
      -0.006058773352374146, -0.007057899333650564, -0.007872173439384626,
      -0.008460769847522946, -0.008795248236630767, -0.008861057660681081,
      -0.008658253495272829, -0.008201390039676118, -0.007518597948059854,
      -0.006649901619972911, -0.005644874412767655, -0.004559766641466113,
      -0.0034542707206587707, -0.0023881078336198103, -0.00141763007271124,
      -0.0005926305629695307, 4.645823936206209e-05, 0.00047082037070393933,
      0.0006648399685152146, 0.0006269247729397212, 0.00036952496720297524,
      -8.165143626151413e-05, -0.0006891798692518934, -0.001406127516459904,
      -0.0021788013869538467, -0.0029498785349734834, -0.00366173948937529,
      -0.004259814830161677, -0.004695754546445601, -0.004930240317930869,
      -0.004935281562098494, -0.004695865784045692, -0.004210870748263244,
      -0.0034931881430556215, -0.0025690533200647347, -0.0014766208020649545,
      -0.00026386799394856916, 0.001014052523480491, 0.002297860739751659,
      0.0035274233234539407, 0.004645068063258756, 0.005598750886975435,
      0.006344896681804849, 0.006850754279875553, 0.007096134160292899,
      0.007074433020600326, 0.006792890334721982, 0.006272065986827628,
      0.0055445725297311715, 0.004653138018452417, 0.003648113293590557,
      0.0025845688758387945, 0.001519149507716046, 0.0005068675525691975,
      -0.0004019807959317214, -0.0011646003585760144, -0.0017480246378280913,
      -0.002130855010867359, -0.0023043145490864313, -0.002272559428820637,
      -0.0020522339240574075, -0.0016712986776505963, -0.0011672038170801998,
      -0.0005845161086694413, 2.785942616849009e-05, 0.0006196999617542829,
      0.0011425503597915002, 0.0015526933728302061, 0.001813831349032326,
      0.0018993233355278016, 0.0017938475680391028, 0.00149439288490391,
      0.0010105216644051586, 0.0003638891915597053, -0.0004129525327392442,
      -0.0012783971097439953, -0.00218416541588748, -0.0030780887402855305,
      -0.003907132385503209, -0.004620484946676369, -0.00517253480594116,
      -0.00552556200055483, -0.005651990143292281, -0.005536068521264614,
      -0.005174887389326631, -0.0045786678950310265, -0.0037703097964051522,
      -0.0027842227481719678, -0.001664507976505855, -0.00046259427299912123,
      0.0007655367163847557, 0.001962377728351742, 0.0030720034240061234,
      0.004043081919078149, 0.004831620048373261, 0.005403287950333053,
      0.0057351932327519405, 0.005817007038737291, 0.005651381897306853,
      0.0052536421261240385, 0.0046507693791755025, 0.0038797462761937145,
      0.0029853575826665484, 0.0020175790266260102, 0.0010287067878205732,
      7.039467358492982e-05, -0.0008092297739488567, -0.0015682047213750046,
      -0.002172978833062276, -0.002600135171475446, -0.002837499174681379,
      -0.0028845722604622427, -0.0027522724192356124, -0.0024620038640450663,
      -0.002044117024036165, -0.0015358556106917932, -0.000978917093396576,
      -0.0004167749792419262, 0.00010807546584915413, 0.0005567827396106612,
      0.0008965566268725845, 0.0011026939188254798, 0.0011600923926719596,
      0.0010641639930613735, 0.0008210942080607582, 0.0004474337261172117,
      -3.095170979673398e-05, -0.0005805091139447146, -0.001162105233241402,
      -0.0017334856903211187, -0.002251938344443582, -0.002677000729762417,
      -0.002973048710115888, -0.003111610389788255, -0.003073265426224847,
      -0.002849014249365789, -0.0024410328659618193, -0.001862765080656827,
      -0.001138342973378656, -0.000301366044102878, 0.0006068927499977614,
      0.001539751999721689, 0.002447727940578087, 0.003281331390262795,
      0.003993893746177089, 0.004544258173099869, 0.004899179580044395,
      0.005035293570747742, 0.004940539280118071, 0.004614952430649081,
      0.004070781220538263, 0.0033319166702924278, 0.002432668531710839,
      0.001415955503879371, 0.0003310121180852302, -0.0007692577007014502,
      -0.0018311303095192018, -0.0028029538130476656, -0.0036379178677641653,
      -0.004296545817392073, -0.004748769584955993, -0.0049754721844007576,
      -0.00496941370987448, -0.004735492387527265, -0.004290330636843853,
      -0.0036612148432007942, -0.002884454432755848, -0.0020032587247090544,
      -0.0010652570168317036, -0.00011980689349376648, 0.0007847532706481324,
      0.0016037497997836753, 0.0022985667518619544, 0.0028386521365109064,
      0.003203026764319456, 0.003381215271385776, 0.003373553437693198,
      0.0031908629112597214, 0.0028535216691377226, 0.002389993795560294,
      0.0018349133681660407, 0.001226842595338442, 0.0006058423767011562,
      1.1003140822266306e-05, -0.0005219153750757774, -0.0009625947946006123,
      -0.0012878950037142004, -0.0014831167702199265, -0.0015427191268916403,
      -0.0014704541830146075, -0.0012789176756362428, -0.00098854910100186,
      -0.0006261485488435246, -0.00022300640972475864, 0.00018723478914992975,
      0.0005708514067536819, 0.0008963000495901276, 0.00113632792048994,
      0.0012698005538587327, 0.0012831330583349782, 0.0011712355956808903,
      0.0009379138216544819, 0.000595698582995138, 0.00016511427528167723,
      -0.0003265701999536103, -0.0008470320663398287, -0.001360923786168711,
      -0.0018321164833818842, -0.0022260199338804748, -0.0025118361314049494,
      -0.0026646068307233646, -0.002666927312279037, -0.002510218203839613,
      -0.0021954733712221757, -0.001733433093615919, -0.0011441661097129768,
      -0.00045607960851702347, 0.0002955892754088952, 0.0010707154794158302,
      0.0018265500805435789, 0.002520175003512472, 0.0031110047447681427,
      0.003563187751359309, 0.0038477650743784795, 0.0039444573397885915,
      0.003842972168282314, 0.003543751699392731, 0.003058112220756106,
      0.0024077631724227235, 0.0016237289158624708, 0.0007447315041124502,
      -0.00018487578593615124, -0.0011175080496677611, -0.0020049457465365498,
      -0.0028009816095984634, -0.003463966817065277, -0.003959111345068576,
      -0.004260407419425684, -0.0043520665832619205, -0.004229388828597607,
      -0.003899014865594462, -0.003378548012747459, -0.002695568315137041,
      -0.001886096228917824, -0.0009925945283982814, -6.162318283195765e-05,
      0.00085871868929919, 0.0017214181534884528, 0.002483092391287152,
      0.0031063081037286176, 0.0035615470695232083, 0.0038287097551811507,
      0.003898076213011763, 0.0037706753356574777, 0.0034580479755777966,
      0.0029814244545941994, 0.0023703705294191788, 0.0016609859898556675,
      0.0008937650065724541, 0.00011124569005705151, -0.0006444129552728071,
      -0.0013337859677019076, -0.0019223342854988647, -0.0023822321645396807,
      -0.0026937694001075594, -0.002846253915157583, -0.0028383707000419443,
      -0.0026779857734170217, -0.0023814168175991476, -0.001972223457701356,
      -0.001479597950511384, -0.0009364596986513598, -0.00037737320084015713,
      0.00016358212050252246, 0.0006548607692310549, 0.0010692960685908584,
      0.001385632605874923, 0.0015896582914138476, 0.0016748737597467268,
      0.001642666016024407, 0.0015019841142818837, 0.0012685453531600314,
      0.0009636291196920653, 0.0006125403704445047, 0.00024284432026951448,
      -0.00011751294878956216, -0.0004420773039974559, -0.0007076337258605086,
      -0.0008957176932588922, -0.0009937963969846916, -0.0009960468979873347,
      -0.0009036842756833466, -0.000724821539290425, -0.00047387281397401207,
      -0.00017054022004591135, 0.00016154884957858152, 0.0004964653025167654,
      0.0008077575717941295, 0.0010702714545386338, 0.001261892898516415,
      0.0013651008115495584, 0.0013682287835320211, 0.0012663527686532995,
      0.001061745156023952, 0.0007638628182171293, 0.0003888659941070718,
      -4.130557125799402e-05, -0.0005002447677763471, -0.0009586983039206688,
      -0.0013863977191326477, -0.0017539870846239515, -0.002034927254006657,
      -0.0022072569133672983, -0.0022550984626602878, -0.0021698114926878213,
      -0.0019507174350517258, -0.0016053446134194052, -0.0011491718715467855,
      -0.0006048794491276952, -1.1459726302522783e-06, 0.0006289415119519332,
      0.0012497733283704786, 0.0018252887746887578, 0.0023211111751176823,
      0.0027066189415822744, 0.0029568277755065513, 0.0030539692329536717,
      0.0029886679275403375, 0.0027606426692442, 0.002378884485067554, 0.001861295109186492,
      0.001233801350389468, 0.0005289918512940259, -0.00021564870860548191,
      -0.0009598086537961246, -0.0016626037608772858, -0.002284887610007722,
      -0.0027914842418966575, -0.0031532132706165988, -0.0033485889960418883,
      -0.0033650934486533866, -0.0031999476181767826, -0.002860333947771314,
      -0.002363054830263551, -0.0017336444664407538, -0.0010049831230732487,
      -0.000215491700148512, 0.0005929911124119447, 0.0013775283685944486,
      0.00209646894262154, 0.0027117602503594794, 0.003191057862713905,
      0.0035095120462566155, 0.003651129999937929, 0.003609637129794214,
      0.0033887896692076543, 0.00300212260880612, 0.0024721493920144082,
      0.001829061260254158, 0.0011090026649188262, 0.000352023146883621,
      -0.0004001758628198826, -0.0011065697727631935, -0.001729082020344424,
      -0.002234668865441964, -0.0025971005985277553, -0.002798340361592022,
      -0.0028294457744628327, -0.0026909467184580474, -0.0023926832764936414,
      -0.001953119150554988, -0.0013981760327630567, -0.0007596616354818188,
      -7.338681454560023e-05, 0.0006229158493684877, 0.0012917494575368988,
      0.0018979607264954558, 0.0024106774619638933, 0.0028049661117135376,
      0.0030631177579031285, 0.0031754939117984056, 0.003140890240712434,
      0.0029664052617504317, 0.0026668303406169325, 0.002263605290134525,
      0.0017834088232821458, 0.0012564736257745616, 0.0007147307005300053,
      0.00018989607665071176, -0.0002883854600900787, -0.0006942302810179603,
      -0.0010069419448116574, -0.0012120933166061322, -0.0013022068166335826,
      -0.0012770000857373395, -0.001143191212342778, -0.000913884484399872,
      -0.0006075827811318245, -0.0002468946923397348, 0.00014297805386217062,
      0.0005358752751828809, 0.0009063317151750258, 0.0012311463135213378,
      0.0014907715039284622, 0.001670439450619875, 0.0017609598830645539,
      0.001759145758195106, 0.0016678469909983686, 0.0014955974308067195,
      0.001255904561068089, 0.0009662335570899052, 0.00064675598738205,
      0.0003189474570359457, 4.1270310714251345e-06, -0.00027796614558769613,
      -0.000510467108721361, -0.0006804675912475836, -0.0007798186430920428,
      -0.000805603898798743, -0.0007602557488999737, -0.0006513100058501911,
      -0.000490818126332522, -0.0002944581704641323, -8.040504773738684e-05,
      0.00013196399926190727, 0.0003234422538306836, 0.00047635342240291153,
      0.0005758082615761839, 0.0006107744287935608, 0.0005748882189369553,
      0.0004669536049323426, 0.0002910942764279965, 5.6546877619078617e-05,
      -0.00022289304653176422, -0.0005297382581733298, -0.0008439355422035495,
      -0.0011441782016214114, -0.0014093210439028493, -0.0016198063415294877,
      -0.0017590078317827678, -0.0018144043265906947, -0.0017785046740930119,
      -0.0016494610344606811, -0.001431326768924665, -0.0011339374966704066,
      -0.0007724176649379906, -0.0003663388166356044, 6.14218698665562e-05,
      0.00048605466634484907
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby1_highpass_1_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<1>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.888075988526405), "design.b()[0] == 0.888075988526405");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.888075988526405));
    static_assert(almost_equal(design.b()[1], -0.888075988526405), "design.b()[1] == -0.888075988526405");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.888075988526405));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.77615197705281), "design.a()[1] == -0.77615197705281");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.77615197705281));
    std::cout << "max_deviation(cheby1,highpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.888075988526405, -0.19879405425850716, -0.15429439823908392, -0.11975590224143859,
      -0.0929487802884356, -0.07214237958551656, -0.05599345054459296,
      -0.043459427342194566, -0.033731120453227265, -0.02618047582797882,
      -0.020320028074069064, -0.015771429963457307, -0.012241026547087317,
      -0.009500896955677754, -0.007374139955924313, -0.005723453305854777,
      -0.004442269598908627, -0.0034478763317945245, -0.0026760760315559106,
      -0.002077041702635758, -0.0016121000239218784, -0.0012512346207738483,
      -0.0009711482246705453, -0.0007537586145893703, -0.0005850312389341268,
      -0.0004540731527363774, -0.0003524297752229419, -0.0002735390668115638,
      -0.00021230788750697596, -0.00016478318663244498, -0.00012789679608983436,
      -9.926735114384505e-05, -7.704655084709086e-05, -5.979983276506943e-05,
      -4.641375842803604e-05, -3.6024130366371696e-05, -2.796020000546756e-05,
      -2.170136451303564e-05, -1.6843556971536303e-05, -1.3073160044059543e-05,
      -1.0146759014524615e-05, -7.875427069801701e-06, -6.112528290361809e-06,
      -4.744250917355551e-06, -3.6822597291401185e-06, -2.857993168794048e-06,
      -2.2182370483629256e-06, -1.7216890706586745e-06, -1.3362923760619453e-06,
      -1.0371659696010759e-06, -8.049984178377697e-07, -6.24801113529169e-07,
      -4.849406195304617e-07, -3.7638762060178233e-07, -2.921339958682763e-07,
      -2.267403784575001e-07, -1.7598499301749107e-07, -1.3659110026215066e-07,
      -1.0601545251628683e-07, -8.228410306866433e-08, -6.386496927676102e-08,
      -4.9568922168575035e-08, -3.847301694151638e-08, -2.986090816234419e-08,
      -2.3176602906795835e-08, -1.7988566167477492e-08, -1.3961861195232945e-08,
      -1.083652617001696e-08, -8.410791211243179e-09, -6.528052227184792e-09,
      -5.066760642433476e-09, -3.932576289878109e-09, -3.0522768622998986e-09,
      -2.3690307211866137e-09, -1.8387278779478346e-09, -1.4271322777313298e-09,
      -1.1076715388770516e-09, -8.597214548245522e-10, -6.672745068767942e-10,
      -5.179064277493628e-10, -4.019740978260262e-10, -3.119929907516899e-10,
      -2.421539765985432e-10, -1.879482876881592e-10, -1.4587643507285508e-10,
      -1.1322228348721234e-10, -8.787769917503358e-11, -6.820644995355441e-11,
      -5.29385709792048e-11, -4.1088376527860316e-11, -3.189082467598906e-11,
      -2.4752126622113447e-11, -1.9211412014014845e-11, -1.4910975416653728e-11,
      -1.1573183049421638e-11, -8.982548904602674e-12, -6.971823091280919e-12,
      -5.4111942759601185e-12, -4.1999091355032946e-12, -3.2597677789630404e-12,
      -2.530075206375211e-12, -1.9637228735204163e-12, -1.5241473906666964e-12,
      -1.182970010585838e-12, -9.181645125103817e-13, -7.126352016446623e-13,
      -5.531132206739325e-13, -4.2929991976011996e-13, -3.332019814704298e-13,
      -2.586153766761879e-13, -2.007248359034804e-13, -1.5579297823008717e-13,
      -1.2091902806422754e-13, -9.385154269535443e-14, -7.284306041245556e-14,
      -5.6537285353704664e-14, -4.3881525804476755e-14, -3.4058733009238536e-14,
      -2.643475296103429e-14, -2.0517385773609388e-14, -1.5924609532142125e-14,
      -1.2359917172166134e-14, -9.593174149385722e-15, -7.445761082257637e-15,
      -5.779042184657135e-15, -4.485415017093225e-15, -3.4813637334192706e-15,
      -2.7020673445333188e-15, -2.0972149115893716e-15, -1.627757499934725e-15,
      -1.2633872017368762e-15, -9.805804744112938e-16, -7.61079473873708e-16,
      -5.907133383413909e-16, -4.584833254251361e-16, -3.5585273947446624e-16,
      -2.761958072827655e-16, -2.1436992187621535e-16, -1.6638363868488098e-16,
      -1.2913899011451078e-16, -1.0023148249198083e-16, -7.779486329908504e-17,
      -6.038063695413794e-17, -4.686455074766212e-17, -3.63740137164897e-17,
      -2.823176265939951e-17, -2.191213840377863e-17, -1.7007149543547586e-17,
      -1.3200132742257255e-17, -1.02453091252625e-17, -7.951916933089685e-18,
      -6.1718960489772766e-18, -4.79032932057814e-18, -3.718023572900768e-18,
      -2.8857513468358836e-18, -2.2397816131294805e-18, -1.7384109271969784e-18,
      -1.3492710780741434e-18, -1.0472394148274229e-18, -8.128169422659321e-19,
      -6.308694767217229e-19, -4.896505916198369e-19, -3.800432747508145e-19,
      -2.9497133906346894e-19, -2.289425879880262e-19, -1.7769424229849344e-19,
      -1.3791773747087674e-19, -1.070451246086714e-19, -8.308328509888472e-20,
      -6.448525598954164e-20, -5.0050358927039305e-20, -3.8846685033424314e-20,
      -3.015093139064009e-20, -2.3401705008828935e-20, -1.8163279609009226e-20,
      -1.40974653782955e-20, -1.0941775624797593e-20, -8.492480783654897e-21,
      -6.591455750316745e-21, -5.115971412264455e-21, -3.9707713261747136e-21,
      -3.0819220152351125e-21, -2.392039865247313e-21, -1.856586470600839e-21,
      -1.44099325972634e-21, -1.1184297674563723e-21, -8.680714752059779e-22,
      -6.737553917042691e-22, -5.229365793212589e-22, -4.058782599134287e-22,
      -3.15023213874562e-22, -2.445058902662715e-22, -1.8977373013122405e-22,
      -1.4729325583403597e-22, -1.1432195172213236e-22, -8.873120884966893e-23,
      -6.886890317495634e-23, -5.345273535670091e-23, -4.1487446225984055e-23,
      -3.2200563411169666e-23, -2.4992530953793712e-23, -1.939800231134054e-23,
      -1.5055797844821937e-23, -1.1685587263365983e-23, -9.069791657484643e-24,
      -7.039536726413789e-24, -5.4637503477419284e-24, -4.240700634522876e-24,
      -3.291428181574036e-24, -2.5546484904560234e-24, -1.982795476542419e-24,
      -1.5389506292097672e-24, -1.1944595734478269e-24, -9.270821594411869e-25,
      -7.195566509406657e-25, -5.584853172290964e-25, -4.334694831223289e-25,
      -3.364381963174553e-25, -2.6112717122787435e-25, -2.0267437021072232e-25,
      -1.5730611313698527e-25, -1.2209345071376413e-25, -9.476307315668785e-26,
      -7.355054658216335e-26, -5.708640214306089e-26, -4.430772388616848e-26,
      -3.438952749295968e-26, -2.6691499753572623e-26, -2.0716660304239982e-26,
      -1.6079276853067332e-26, -1.2479962519087696e-26, -9.686347582734882e-27,
      -7.518077826760385e-27, -5.835170968876967e-27, -4.528979483935019e-27,
      -3.51517638048778e-27, -2.7283110974049314e-27, -2.1175840522659593e-27,
      -1.6435670487417252e-27, -1.2756578142997421e-27, -9.901043346116113e-28,
      -7.6847143679735905e-28, -5.964506249788838e-28, -4.629363317917448e-28,
      -3.5930894916973834e-28, -2.7887835127086e-28, -2.16451983696106e-28,
      -1.679996350827353e-28, -1.3039324891361562e-28, -1.0120497793864195e-28,
      -7.855044371466297e-29, -6.096708218751114e-29, -4.731972137497793e-29,
      -3.6727295298777235e-29, -2.8505962857948324e-29, -2.2124959429990563e-29,
      -1.7172331003800388e-29, -1.3328338659204936e-29, -1.034481640117131e-29,
      -8.029149702017448e-30, -6.2318404152738225e-30, -4.836855258992382e-30,
      -3.7541347719852186e-30, -2.9137791253990277e-30, -2.261535428873663e-30,
      -1.755295194295268e-30, -1.3623758353635686e-30, -1.0574106981064074e-30,
      -8.207114038920801e-31, -6.369967787206252e-31, -4.944063091802846e-31,
      -3.8373443433766077e-31, -2.978362398744171e-31, -2.311661864165038e-31,
      -1.7942009261492787e-31, -1.3925725960607456e-31, -1.0808479736221118e-31,
      -8.389022916203255e-32, -6.511156721952486e-32, -5.053647162644116e-32,
      -3.922398236613555e-32, -3.0443771461360663e-32, -2.3628993408678995e-32,
      -1.833968994991402e-32, -1.4234386613161315e-32, -1.1048047311939207e-32,
      -8.574963763734599e-33, -6.655475078378814e-33, -5.165660140309422e-33,
      -4.009337330684054e-33, -3.1118550958820644e-33, -2.415272484970726e-33,
      -1.8746185143312825e-33, -1.4549888661180264e-33, -1.1292924850273326e-33,
      -8.76502594924845e-34, -6.802992219428368e-34, -5.280155860984212e-34,
      -4.098203410649878e-34, -3.180828679540472e-34, -2.4688064682916164e-34,
      -1.9161690213253036e-34, -1.4872383742689825e-34, -1.1543230045376778e-34,
      -8.959300821294585e-35, -6.953779045458657e-35, -5.397189354121139e-35,
      -4.1890391877295004e-35, -3.251331047507949e-35, -2.5235270205764785e-35,
      -1.958640486166621e-35, -1.5202026856739e-35, -1.1799083200067889e-35,
      -9.157881753143289e-36, -7.107908028318017e-36, -5.5168168688885696e-36,
      -4.281888319826156e-36, -3.323396084952406e-36, -2.5794604418653784e-36,
      -2.0020533216833285e-36, -1.553897643789661e-36, -1.2060607283650485e-36,
      -9.360864187662845e-37, -7.265453246177364e-37, -5.639095901205317e-37,
      -4.376795432510905e-37, -3.3970584280990474e-37, -2.6366336151329867e-37,
      -2.0464283931493655e-37, -1.5883394432398853e-37, -1.2327927991015964e-37,
      -9.568345683191718e-38, -7.426490419133973e-38, -5.764085221374585e-38,
      -4.4738061404707683e-38, -3.472353480877388e-38, -2.6950740192091917e-38,
      -2.091787028312877e-38, -1.623544637598462e-38, -1.260117380305534e-38,
      -9.780425960427479e-39, -7.591096945604416e-39, -5.891844902330415e-39,
      -4.5729670694322724e-39, -3.549317431937253e-39, -2.7548097419861013e-39,
      -2.138151027646854e-39, -1.6595301473456033e-39, -1.2880476048410312e-39,
      -9.99720695035503e-40, -7.75935193952415e-40, -6.022436348510224e-40,
      -4.674325878570916e-40, -3.62798727204193e-40, -2.8158694939177747e-40,
      -2.1855426748269765e-40, -1.6963132680002445e-40, -1.316596896659303e-40,
      -1.0218792843237122e-40, -7.931336268371597e-41, -6.155922325367272e-41,
      -4.77793128341734e-41, -3.708400811846838e-41, -2.878282621819169e-41,
      -2.2339847474416936e-41, -1.733911678432693e-41, -1.3457789772504908e-41,
      -1.044529013869077e-41, -8.107132592035061e-42, -6.292366989537284e-42,
      -4.8838330792712015e-42, -3.790596700072256e-42, -2.942079122970939e-42,
      -2.2835005279396916e-42, -1.7723434493615272e-42, -1.3756078722385462e-42,
      -1.0676807696873569e-42, -8.28682540254108e-43, -6.431835919673707e-43,
      -4.992082165134026e-43, -3.874614442078847e-43, -3.0072896595368673e-43,
      -2.3341138148200115e-43, -1.8116270520388286e-43, -1.4060979181222907e-43,
      -1.091345679080456e-43, -8.470501064663375e-44, -6.574396147966411e-44,
      -5.102730568172509e-44, -3.9604944188549015e-44, -3.0739455733008517e-44,
      -2.3858489340701897e-44, -1.851781367127917e-44, -1.4372637691658884e-44,
      -1.1155351159844779e-44, -8.658247857431882e-45, -6.720116192359012e-45,
      -5.2158314687240496e-45, -4.048277906424433e-45, -3.1420789007305344e-45,
      -2.438730750857924e-45, -1.8928256937778617e-45, -1.469120404442044e-45,
      -1.1402607064363163e-45, -8.850156016561808e-46, -6.869066089480269e-46,
      -5.331439225856525e-46, -4.138007095685445e-46, -3.211722388374815e-46,
      -2.4927846814818856e-46, -1.934779758899125e-46, -1.501683135031315e-46,
      -1.165534334161417e-46, -9.046317777823143e-47, -7.021317428305415e-47,
      -5.449609403494599e-47, -4.229725112687918e-47, -3.282909508602647e-47,
      -2.5480367055874133e-47, -1.9776637266447996e-47, -1.5349676113809892e-47,
      -1.191368146285384e-47, -9.246827421371423e-48, -7.176943384563567e-48,
      -5.570398797125099e-48, -4.3234760393612404e-48, -3.3556744756906796e-48,
      -2.6045133786529727e-48, -2.0214982081019986e-48, -1.568989830827079e-48,
      -1.2177745591721913e-48, -9.451781317061105e-49, -7.33601875590779e-49,
      -5.693865461094327e-49, -4.419304934701071e-49, -3.4300522622674756e-49,
      -2.6622418447533647e-49, -2.0663042711980442e-49, -1.6037661452830278e-49,
      -1.2447662643917862e-49, -9.661277970763257e-50, -7.498619997864662e-50,
      -5.820068736510396e-50, -4.517257856425794e-50, -3.5060786161222183e-50,
      -2.72124984960584e-50, -2.1121034508262346e-50, -1.6393132690988446e-50,
      -1.2723562348199734e-50, -9.875418071709917e-51, -7.664825260580701e-51,
      -5.94906927976403e-51, -4.6173818831129885e-51, -3.583790077385973e-51,
      -2.781565753905366e-51, -2.1589177591960398e-51, -1.6756482870944286e-51,
      -1.3005577308734954e-51, -1.00943045408878e-51, -7.834714426383224e-52,
      -6.080929091681512e-52, -4.7197251368265536e-52, -3.6632239960937736e-52,
      -2.8432185469554775e-52, -2.2067696964127115e-52, -1.7127886627709554e-52,
      -1.3293843068833157e-52, -1.031804258050465e-52, -8.008369148173763e-53,
      -6.215711547323794e-53, -4.824336806245344e-53, -3.744418550135963e-53,
      -2.906237860601244e-53, -2.2556822612913843e-53, -1.750752246704261e-53,
      -1.3588498176091613e-53, -1.0546739724552009e-53, -8.185872888672451e-54,
      -6.35348142644612e-54, -4.9312671703044635e-54, -3.8274127636074254e-54,
      -2.970653983471063e-54, -2.3056789624108712e-54, -1.7895572851242694e-54,
      -1.388968424898461e-54, -1.0780505890488678e-54, -8.367310960532251e-55,
      -6.494304944632754e-55, -5.040567622360552e-55, -3.912246525563524e-55,
      -3.0364978755341163e-55, -2.3567838294124617e-55, -1.8292224286845746e-55,
      -1.4197546044928753e-55, -1.1019453432069755e-55, -8.552770567342314e-56,
      -6.638249785121821e-56, -5.152290694892693e-56, -3.99896060919176e-56,
      -3.1038011829804942e-56, -2.409021424549161e-56, -1.8697667414264082e-56,
      -1.451223152985697e-56, -1.1263697193346612e-56, -8.742340845540161e-57,
      -6.78538513133553e-57, -5.266490084750813e-57, -4.0875966914083645e-57,
      -3.172596253431127e-57, -2.4624168544909073e-57, -1.9112097099412792e-57,
      -1.4833891949334516e-57, -1.1513354563863746e-57, -8.93611290725284e-58,
      -6.935781700131426e-58, -5.3832206789637066e-58, -4.178197372889251e-58,
      -3.242916151484849e-58, -2.5169957823914556e-58, -1.9535712527367126e-58,
      -1.5162681901251344e-58, -1.1768545535079091e-58, -9.134179884087658e-59,
      -7.089511775790642e-59, -5.502538581119085e-59, -4.270806198544941e-59,
      -3.3147946746100524e-59, -2.5727844402227184e-59, -1.99687172980957e-59,
      -1.5498759410125623e-59, -1.2029392758034847e-59, -9.336636971893501e-60,
      -7.246649244759502e-60, -5.62450113832834e-60, -4.365467678449322e-60,
      -3.3882663693885816e-60, -2.6298096413824944e-60, -2.0411319524315642e-60,
      -1.584228600305421e-60, -1.2296021602306584e-60, -9.543581476514316e-61,
      -7.407269631161162e-61, -5.749166968788975e-61, -4.462227309232274e-61,
      -3.4633665481196705e-61, -2.6880987935816484e-61, -2.0863731931516697e-61,
      -1.6193426787346527e-61, -1.256856021625894e-61, -9.75511286055667e-62,
      -7.571450133094353e-62, -5.8765959899579435e-62, -4.5611315959464735e-62,
      -3.540131305791894e-62, -2.7476799120169246e-62, -2.1326171960202273e-62,
      -1.6552350529879195e-62, -1.2847139588636865e-62, -9.971332791193926e-63,
      -7.73926965973668e-63, -6.006849447349452e-63, -4.662228074418857e-63,
      -3.618597537431311e-63, -2.808581632835742e-63, -2.1798861870396702e-63,
      -1.6919229738209517e-63, -1.3131893611522013e-63, -1.0192345189029976e-63,
      -7.910808869270313e-64, -6.139989943971058e-64, -4.765565334097509e-64,
      -3.698802955834117e-64, -2.8708332268994273e-64, -2.2282028848468888e-64,
      -1.7294240743486874e-64, -1.3422959144684597e-64, -1.0418256278046046e-64,
      -8.086150207648289e-65, -6.2760814704122095e-65, -4.871193041404943e-65,
      -3.7807861096923375e-65, -2.93446461385151e-65, -2.2775905116323604e-65,
      -1.7677563785201776e-65, -1.3720476081361514e-65, -1.064917463665453e-65,
      -8.265377948220054e-66, -6.415189435599693e-66, -4.979161963609003e-66,
      -3.864586402121279e-66, -2.9995063764978364e-66, -2.328072804301306e-66,
      -1.8069383097813384e-66, -1.4024587415492488e-66, -1.0885211249884453e-66,
      -8.448578232235307e-67, -6.557380698234769e-67, -5.0895239932228516e-67,
      -3.9502441095976285e-67, -3.065989775505417e-67, -2.3796740258822304e-67,
      -1.846988699929713e-67, -1.433543931044646e-67, -1.1126479562723592e-67,
      -8.635839110245601e-68, -6.7027235989271034e-68, -5.202332172945797e-68,
      -4.037800401317321e-68, -3.1339467644270688e-68, -2.4324189771883265e-68,
      -1.8879267981654937e-68, -1.4653181169271293e-68, -1.137309553464292e-68,
      -8.827250584423588e-69, -6.851287993040941e-69, -5.317640721156905e-69,
      -4.1272973589824627e-69, -3.20341000505908e-69, -2.486333008737357e-69,
      -1.9297722803431612e-69, -1.497796570650054e-69, -1.1625177695329583e-69,
      -9.022904651820286e-70, -7.003145284269312e-70, -5.43550505797369e-70,
      -4.2187779970268283e-70, -3.274412883139267e-70, -2.5414420329357338e-70,
      -1.9725452584281826e-70, -1.53099490215518e-70, -1.1882847201655163e-70,
      -9.222895348581106e-71, -7.158368458952391e-71, -5.5559818318883754e-71,
      -4.312286283289656e-71, -3.34698952439298e-71, -2.597772536532656e-71,
      -2.0162662901633142e-71, -1.5649290673751911e-71, -1.2146227895906647e-71,
      -9.427318795141938e-72, -7.31703212115653e-72, -5.679128946994557e-72,
      -4.4078671601476684e-72, -3.421174810934768e-72, -2.6553515933502937e-72,
      -2.0609563889491597e-72, -1.5996153759025103e-72, -1.2415446365308072e-72,
      -9.636273242426984e-73, -7.479212528530796e-73, -5.805005590817323e-73,
      -4.505566566115481e-73, -3.497004398033571e-73, -2.7142068772961278e-73,
      -2.1066370339437234e-73, -1.6350704988280885e-73, -1.2690632002861451e-73,
      -9.849859119070578e-74, -7.644987628958279e-74, -5.933672262760243e-74,
      -4.605431457924783e-74, -3.574514731249526e-74, -2.7743666756637135e-74,
      -2.1533301803858236e-74, -1.671311476753941e-74, -1.2971917069536228e-74,
      -1.0068179079685637e-74, -7.814437098019749e-75, -6.065190803182852e-75,
      -4.707509833092892e-75, -3.6537430639505916e-75, -2.8358599027282434e-75,
      -2.2010582701473156e-75, -1.708355727983277e-75, -1.325943675783713e-75,
      -1.029133805420199e-75, -7.987642377287694e-76, -6.199624423122651e-76,
      -4.8118507529915326e-76, -3.7347274752174305e-76, -2.898716113643458e-76,
      -2.249844242519208e-76, -1.746221056892165e-76, -1.3553329256781013e-76,
      -1.0519443298298275e-76, -8.16468671346914e-77, -6.337037734675883e-77,
      -4.918504366426947e-77, -3.817506888145154e-77, -2.9629655186465816e-77,
      -2.299711545236849e-77, -1.7849256624867533e-77, -1.3853735818313903e-77,
      -1.0752604444951664e-77, -8.345655198416067e-78, -6.477496782051692e-78,
      -5.027521933742635e-78, -3.902121088550713e-78, -3.028638997578099e-78,
      -2.350684145749482e-78, -1.8244881471501564e-78, -1.416080082520012e-78,
      -1.0990933557130137e-78, -8.530634810022629e-79, -6.621069073314586e-79,
      -5.1389558514563326e-79, -3.988610744094939e-79, -3.095768114723367e-79,
      -2.4027865427395916e-79, -1.86492752558322e-79, -1.4474671860416214e-79,
      -1.123454518165272e-79, -8.719714454028879e-80, -6.767823612830478e-80,
      -5.252859677443067e-80, -4.077017423828423e-80, -3.1643851339831846e-80,
      -2.4560437778975697e-80, -1.9062632339434512e-80, -1.479549977808293e-80,
      -1.1483556404243479e-80, -8.912985006751033e-81, -6.917830934431867e-81,
      -5.369288156676382e-81, -4.167383618170612e-81, -3.2345230343806132e-81,
      -2.510481447957367e-81, -1.9485151391865116e-81, -1.5123438775969423e-81,
      -1.1738086905805796e-81, -9.11053935875887e-82, -7.071163135318137e-82,
      -5.488297247540119e-82, -4.259752759331759e-82, -3.3062155259115075e-82,
      -2.5661257169989126e-82, -1.9917035486147658e-82, -1.545864646960448e-82,
      -1.1998259019943958e-82, -9.312472459521214e-83, -7.227893910707234e-83,
      -5.609944148723387e-83, -4.3541692421875e-83, -3.379497065746364e-83,
      -2.6230033290232106e-83, -2.035849219637467e-83, -1.5801283968030406e-83,
      -1.226419779175967e-83, -9.518881363040975e-84, -7.388098589255399e-84,
      -5.734287326711654e-84, -4.450678445616123e-84, -3.4544028747912813e-84,
      -2.6811416208061638e-84, -2.0809733697472796e-84, -1.6151515951235993e-84,
      -1.2536031037951815e-84, -9.729865274501691e-85, -7.551854169261969e-85,
      -5.861386543887183e-85, -4.549326754308775e-85, -3.530968954615999e-85,
      -2.7405685350373015e-85, -2.127097686717925e-85, -1.6509510749305763e-85,
      -1.2813889408248287e-85, -9.945525597947969e-86, -7.719239355676647e-86,
      -5.9913028872522894e-86, -4.650161581063073e-86, -3.609232104757125e-86,
      -2.8013126337497174e-86, -2.1742443390278576e-86, -1.687544042332352e-86,
      -1.3097906448199459e-86, -1.016596598502276e-86, -7.890334597927033e-87,
      -6.124098797789255e-87, -4.753231389570867e-87, -3.689229940404904e-87,
      -2.863403112047687e-87, -2.2224359865149814e-87, -1.724948084806915e-87,
      -1.3388218663363454e-87, -1.0391292384784875e-87, -8.065222128584589e-88,
      -6.259838100471002e-88, -4.858585717711075e-88, -3.771000910481997e-88,
      -2.9268698121385484e-88, -2.271695791267521e-88, -1.763181179654834e-88,
      -1.3684965584914053e-88, -1.0621613094630708e-88, -8.24398600288764e-89,
      -6.398586034936934e-89, -4.966275201358802e-89, -3.854584316122976e-89,
      -2.9917432376756013e-89, -2.3220474287562927e-89, -1.8022617026395908e-89,
      -1.398828983670282e-89, -1.0857038812344622e-89, -8.426712139140371e-90,
      -6.540409286848713e-90, -5.0763515987221875e-90, -3.940020329563419e-90,
      -3.0580545684189115e-90, -2.373515099213716e-90, -1.8422084368194222e-90,
      -1.4298337203807613e-90, -1.1097682689303026e-90, -8.61348836000729e-91,
      -6.685376019941025e-91, -5.188867815218673e-91, -4.027350013447668e-91,
      -3.1258356752210685e-91, -2.4261235392650378e-91, -1.88304058157492e-91,
      -1.4615256702600473e-91, -1.134366038485769e-91, -8.804404434722935e-92,
      -6.833555908782735e-92, -5.303877928902632e-92, -4.116615340564541e-92,
      -3.1951191353450954e-92, -2.4798980338173607e-92, -1.924777761836721e-92,
      -1.4939200652368536e-92, -1.1595090121924468e-92, -8.999552122237184e-93,
      -6.985020172264203e-93, -5.42143721645662e-93, -4.207859214020489e-93,
      -3.2659382481218863e-93, -2.5348644282121927e-93, -1.9674400375177343e-93,
      -1.5270324748522441e-93, -1.1852092743804147e-93, -9.199025215316853e-94,
      -7.139841607826827e-94, -5.541602179758706e-94, -4.301125487859881e-94,
      -3.3383270509546787e-94, -2.5910491406473507e-94, -2.0110479131544257e-94,
      -1.5608788137427353e-94, -1.211479177226269e-94, -9.402919585624802e-95,
      -7.29809462645128e-95, -5.66443057303865e-95, -4.3964589881423297e-95,
      -3.412320335678266e-95, -2.6484791748741942e-95, -2.0556223477618007e-95,
      -1.5954753492892605e-95, -1.2383313466898822e-95, -9.611333229798207e-96,
      -7.459855288421248e-96, -5.789981430636012e-96, -4.493905534487198e-96,
      -3.4879536652808038e-96, -2.707182133176291e-96, -2.101184764906822e-96,
      -1.6308387094356737e-96, -1.2657786885827514e-96, -9.824366316548156e-97,
      -7.625201339879884e-97, -5.918315095373508e-97, -4.5935119620956385e-97,
      -3.5652633909962623e-97, -2.7671862296357544e-97, -2.147757063005102e-97,
      -1.6669858906805465e-97, -1.2938343947708457e-97, -1.0042121234803178e-97,
      -7.794212250196492e-98, -6.049493247559238e-98, -4.695326144260727e-98,
      -3.6442866697757106e-98, -2.8285203036936187e-98, -2.1953616258458167e-98,
      -1.703934266246102e-98, -1.3225119495149411e-98, -1.0264702642919877e-98,
      -7.966969250161466e-99, -6.1835789346317656e-99, -4.7993970153765534e-99,
      -3.725061482145868e-99, -2.891213834010786e-99, -2.2440213333499065e-99,
      -1.7417015944282128e-99, -1.351825135951489e-99, -1.0492217518984318e-99,
      -8.143555371027807e-100, -6.320636601462262e-100, -4.905774594457289e-100,
      -3.8076266504634725e-100, -2.955296952636193e-100, -2.293759572566726e-100,
      -1.7803060271314726e-100, -1.381788042717126e-100, -1.0724775212228301e-100,
      -8.324055484417966e-101, -6.46073212132829e-101, -5.014510009177548e-101,
      -3.892021857574258e-101, -3.020800459489011e-101, -2.344600248914433e-101,
      -1.8197661185934475e-101, -1.4124150707200227e-101, -1.0962487495585302e-101,
      -8.50855634311524e-102, -6.603932827574121e-102, -5.125655520445608e-102,
      -3.978287665885508e-102, -3.0877558371618465e-102, -2.396567797669522e-102,
      -1.860100834302298e-102, -1.4437209400613101e-102, -1.1205468619411273e-102,
      -8.697146622759282e-103, -6.750307545972786e-103, -5.23926454752128e-103,
      -4.066465536861338e-103, -3.156195266052044e-103, -2.4496871957110136e-103,
      -1.9013295601120573e-103, -1.475720697109923e-103, -1.1453835366396177e-103,
      -8.889916964465789e-104, -6.899926627805438e-104, -5.355391693690519e-104,
      -4.156597850950093e-104, -3.226151639828376e-104, -2.503983973524959e-104,
      -1.943472111559948e-104, -1.508429721734253e-104, -1.1707707107692604e-104,
      -9.086960018390851e-105, -7.052861983673898e-105, -5.4740927725091e-105,
      -4.248727927953436e-105, -3.2976585812405484e-105, -2.5594842274750162e-105,
      -1.986548743390218e-105, -1.5418637346940931e-105, -1.1967205860288497e-105,
      -9.28837048826089e-106, -7.209187118062665e-106, -5.595424834627987e-106,
      -4.3429000478469045e-106, -3.370750458279118e-106, -2.616214632345003e-106,
      -2.0305801592890644e-106, -1.5760388051964173e-106, -1.223245634565148e-106,
      -9.494245176889587e-107, -7.368977164666959e-107, -5.719446195213271e-107,
      -4.4391594720619523e-107, -3.445462400693593e-107, -2.6742024541594533e-107,
      -2.075587521835336e-107, -1.6109713586186387e-107, -1.2503586049673078e-107,
      -9.704683032703695e-108, -7.532308922503833e-108, -5.846216461973871e-108,
      -4.537552465239704e-108, -3.521830316876648e-108, -2.733475563288335e-108,
      -2.1215924626717847e-108, -1.6466781844030457e-108, -1.2780725283941555e-108,
      -9.919785197300075e-109, -7.699260892823653e-109, -5.975796563810461e-109,
      -4.638126317466878e-109, -3.5998909111225866e-109, -2.794062447842237e-109,
      -2.1686170929017663e-109, -1.6831764441262232e-109, -1.3064007248372868e-109,
      -1.0139655054056843e-109, -7.869913316839736e-110, -6.108248780099399e-110,
      -4.7409293670045635e-110, -3.679681701268319e-110, -2.855992227364454e-110,
      -2.2166840137163794e-110, -1.720483679747326e-110, -1.3353568095229808e-110,
      -1.0364398277821943e-110, -8.04434821429424e-111, -6.243636770625716e-111,
      -4.846011023520772e-111, -3.761241036725359e-111, -2.919294666826548e-111,
      -2.2658163272571497e-111, -1.7586178220391735e-111, -1.3649546994560113e-111,
      -1.0594122885703073e-111, -8.222649422878861e-112, -6.382025606179575e-112,
      -4.953421791837936e-112, -3.8446081169114863e-112, -2.984000190934131e-112,
      -2.3160376477194884e-112, -1.7975971992062205e-112, -1.395208620108502e-112,
      -1.0828939288983367e-112, -8.404902638529291e-113, -6.523481799830889e-113,
      -5.063213296206768e-113, -3.929823010090958e-113, -3.050139898749722e-113,
      -2.3673721127022545e-113, -1.8374405456935425e-113, -1.426133112257037e-113,
      -1.1068960346187764e-113, -8.591195456612789e-114, -6.668073338897135e-114
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.888075988526405, -0.19879405425850716, -0.15429439823908392, -0.11975590224143859,
      -0.0929487802884356, -0.07214237958551656, -0.05599345054459296,
      -0.043459427342194566, -0.033731120453227265, -0.02618047582797882,
      -0.020320028074069064, -0.015771429963457307, -0.012241026547087317,
      -0.009500896955677754, -0.007374139955924313, -0.005723453305854777,
      -0.004442269598908627, -0.0034478763317945245, -0.0026760760315559106,
      -0.002077041702635758, -0.0016121000239218784, -0.0012512346207738483,
      -0.0009711482246705453, -0.0007537586145893703, -0.0005850312389341268,
      -0.0004540731527363774, -0.0003524297752229419, -0.0002735390668115638,
      -0.00021230788750697596, -0.00016478318663244498, -0.00012789679608983436,
      -9.926735114384505e-05, -7.704655084709086e-05, -5.979983276506943e-05,
      -4.641375842803604e-05, -3.6024130366371696e-05, -2.796020000546756e-05,
      -2.170136451303564e-05, -1.6843556971536303e-05, -1.3073160044059543e-05,
      -1.0146759014524615e-05, -7.875427069801701e-06, -6.112528290361809e-06,
      -4.744250917355551e-06, -3.6822597291401185e-06, -2.857993168794048e-06,
      -2.2182370483629256e-06, -1.7216890706586745e-06, -1.3362923760619453e-06,
      -1.0371659696010759e-06, -8.049984178377697e-07, -6.24801113529169e-07,
      -4.849406195304617e-07, -3.7638762060178233e-07, -2.921339958682763e-07,
      -2.267403784575001e-07, -1.7598499301749107e-07, -1.3659110026215066e-07,
      -1.0601545251628683e-07, -8.228410306866433e-08, -6.386496927676102e-08,
      -4.9568922168575035e-08, -3.847301694151638e-08, -2.986090816234419e-08,
      -2.3176602906795835e-08, -1.7988566167477492e-08, -1.3961861195232945e-08,
      -1.083652617001696e-08, -8.410791211243179e-09, -6.528052227184792e-09,
      -5.066760642433476e-09, -3.932576289878109e-09, -3.0522768622998986e-09,
      -2.3690307211866137e-09, -1.8387278779478346e-09, -1.4271322777313298e-09,
      -1.1076715388770516e-09, -8.597214548245522e-10, -6.672745068767942e-10,
      -5.179064277493628e-10, -4.019740978260262e-10, -3.119929907516899e-10,
      -2.421539765985432e-10, -1.879482876881592e-10, -1.4587643507285508e-10,
      -1.1322228348721234e-10, -8.787769917503358e-11, -6.820644995355441e-11,
      -5.29385709792048e-11, -4.1088376527860316e-11, -3.189082467598906e-11,
      -2.4752126622113447e-11, -1.9211412014014845e-11, -1.4910975416653728e-11,
      -1.1573183049421638e-11, -8.982548904602674e-12, -6.971823091280919e-12,
      -5.4111942759601185e-12, -4.1999091355032946e-12, -3.2597677789630404e-12,
      -2.530075206375211e-12, -1.9637228735204163e-12, -1.5241473906666964e-12,
      -1.182970010585838e-12, -9.181645125103817e-13, -7.126352016446623e-13,
      -5.531132206739325e-13, -4.2929991976011996e-13, -3.332019814704298e-13,
      -2.586153766761879e-13, -2.007248359034804e-13, -1.5579297823008717e-13,
      -1.2091902806422754e-13, -9.385154269535443e-14, -7.284306041245556e-14,
      -5.6537285353704664e-14, -4.3881525804476755e-14, -3.4058733009238536e-14,
      -2.643475296103429e-14, -2.0517385773609388e-14, -1.5924609532142125e-14,
      -1.2359917172166134e-14, -9.593174149385722e-15, -7.445761082257637e-15,
      -5.779042184657135e-15, -4.485415017093225e-15, -3.4813637334192706e-15,
      -2.7020673445333188e-15, -2.0972149115893716e-15, -1.627757499934725e-15,
      -1.2633872017368762e-15, -9.805804744112938e-16, -7.61079473873708e-16,
      -5.907133383413909e-16, -4.584833254251361e-16, -3.5585273947446624e-16,
      -2.761958072827655e-16, -2.1436992187621535e-16, -1.6638363868488098e-16,
      -1.2913899011451078e-16, -1.0023148249198083e-16, -7.779486329908504e-17,
      -6.038063695413794e-17, -4.686455074766212e-17, -3.63740137164897e-17,
      -2.823176265939951e-17, -2.191213840377863e-17, -1.7007149543547586e-17,
      -1.3200132742257255e-17, -1.02453091252625e-17, -7.951916933089685e-18,
      -6.1718960489772766e-18, -4.79032932057814e-18, -3.718023572900768e-18,
      -2.8857513468358836e-18, -2.2397816131294805e-18, -1.7384109271969784e-18,
      -1.3492710780741434e-18, -1.0472394148274229e-18, -8.128169422659321e-19,
      -6.308694767217229e-19, -4.896505916198369e-19, -3.800432747508145e-19,
      -2.9497133906346894e-19, -2.289425879880262e-19, -1.7769424229849344e-19,
      -1.3791773747087674e-19, -1.070451246086714e-19, -8.308328509888472e-20,
      -6.448525598954164e-20, -5.0050358927039305e-20, -3.8846685033424314e-20,
      -3.015093139064009e-20, -2.3401705008828935e-20, -1.8163279609009226e-20,
      -1.40974653782955e-20, -1.0941775624797593e-20, -8.492480783654897e-21,
      -6.591455750316745e-21, -5.115971412264455e-21, -3.9707713261747136e-21,
      -3.0819220152351125e-21, -2.392039865247313e-21, -1.856586470600839e-21,
      -1.44099325972634e-21, -1.1184297674563723e-21, -8.680714752059779e-22,
      -6.737553917042691e-22, -5.229365793212589e-22, -4.058782599134287e-22,
      -3.15023213874562e-22, -2.445058902662715e-22, -1.8977373013122405e-22,
      -1.4729325583403597e-22, -1.1432195172213236e-22, -8.873120884966893e-23,
      -6.886890317495634e-23, -5.345273535670091e-23, -4.1487446225984055e-23,
      -3.2200563411169666e-23, -2.4992530953793712e-23, -1.939800231134054e-23,
      -1.5055797844821937e-23, -1.1685587263365983e-23, -9.069791657484643e-24,
      -7.039536726413789e-24, -5.4637503477419284e-24, -4.240700634522876e-24,
      -3.291428181574036e-24, -2.5546484904560234e-24, -1.982795476542419e-24,
      -1.5389506292097672e-24, -1.1944595734478269e-24, -9.270821594411869e-25,
      -7.195566509406657e-25, -5.584853172290964e-25, -4.334694831223289e-25,
      -3.364381963174553e-25, -2.6112717122787435e-25, -2.0267437021072232e-25,
      -1.5730611313698527e-25, -1.2209345071376413e-25, -9.476307315668785e-26,
      -7.355054658216335e-26, -5.708640214306089e-26, -4.430772388616848e-26,
      -3.438952749295968e-26, -2.6691499753572623e-26, -2.0716660304239982e-26,
      -1.6079276853067332e-26, -1.2479962519087696e-26, -9.686347582734882e-27,
      -7.518077826760385e-27, -5.835170968876967e-27, -4.528979483935019e-27,
      -3.51517638048778e-27, -2.7283110974049314e-27, -2.1175840522659593e-27,
      -1.6435670487417252e-27, -1.2756578142997421e-27, -9.901043346116113e-28,
      -7.6847143679735905e-28, -5.964506249788838e-28, -4.629363317917448e-28,
      -3.5930894916973834e-28, -2.7887835127086e-28, -2.16451983696106e-28,
      -1.679996350827353e-28, -1.3039324891361562e-28, -1.0120497793864195e-28,
      -7.855044371466297e-29, -6.096708218751114e-29, -4.731972137497793e-29,
      -3.6727295298777235e-29, -2.8505962857948324e-29, -2.2124959429990563e-29,
      -1.7172331003800388e-29, -1.3328338659204936e-29, -1.034481640117131e-29,
      -8.029149702017448e-30, -6.2318404152738225e-30, -4.836855258992382e-30,
      -3.7541347719852186e-30, -2.9137791253990277e-30, -2.261535428873663e-30,
      -1.755295194295268e-30, -1.3623758353635686e-30, -1.0574106981064074e-30,
      -8.207114038920801e-31, -6.369967787206252e-31, -4.944063091802846e-31,
      -3.8373443433766077e-31, -2.978362398744171e-31, -2.311661864165038e-31,
      -1.7942009261492787e-31, -1.3925725960607456e-31, -1.0808479736221118e-31,
      -8.389022916203255e-32, -6.511156721952486e-32, -5.053647162644116e-32,
      -3.922398236613555e-32, -3.0443771461360663e-32, -2.3628993408678995e-32,
      -1.833968994991402e-32, -1.4234386613161315e-32, -1.1048047311939207e-32,
      -8.574963763734599e-33, -6.655475078378814e-33, -5.165660140309422e-33,
      -4.009337330684054e-33, -3.1118550958820644e-33, -2.415272484970726e-33,
      -1.8746185143312825e-33, -1.4549888661180264e-33, -1.1292924850273326e-33,
      -8.76502594924845e-34, -6.802992219428368e-34, -5.280155860984212e-34,
      -4.098203410649878e-34, -3.180828679540472e-34, -2.4688064682916164e-34,
      -1.9161690213253036e-34, -1.4872383742689825e-34, -1.1543230045376778e-34,
      -8.959300821294585e-35, -6.953779045458657e-35, -5.397189354121139e-35,
      -4.1890391877295004e-35, -3.251331047507949e-35, -2.5235270205764785e-35,
      -1.958640486166621e-35, -1.5202026856739e-35, -1.1799083200067889e-35,
      -9.157881753143289e-36, -7.107908028318017e-36, -5.5168168688885696e-36,
      -4.281888319826156e-36, -3.323396084952406e-36, -2.5794604418653784e-36,
      -2.0020533216833285e-36, -1.553897643789661e-36, -1.2060607283650485e-36,
      -9.360864187662845e-37, -7.265453246177364e-37, -5.639095901205317e-37,
      -4.376795432510905e-37, -3.3970584280990474e-37, -2.6366336151329867e-37,
      -2.0464283931493655e-37, -1.5883394432398853e-37, -1.2327927991015964e-37,
      -9.568345683191718e-38, -7.426490419133973e-38, -5.764085221374585e-38,
      -4.4738061404707683e-38, -3.472353480877388e-38, -2.6950740192091917e-38,
      -2.091787028312877e-38, -1.623544637598462e-38, -1.260117380305534e-38,
      -9.780425960427479e-39, -7.591096945604416e-39, -5.891844902330415e-39,
      -4.5729670694322724e-39, -3.549317431937253e-39, -2.7548097419861013e-39,
      -2.138151027646854e-39, -1.6595301473456033e-39, -1.2880476048410312e-39,
      -9.99720695035503e-40, -7.75935193952415e-40, -6.022436348510224e-40,
      -4.674325878570916e-40, -3.62798727204193e-40, -2.8158694939177747e-40,
      -2.1855426748269765e-40, -1.6963132680002445e-40, -1.316596896659303e-40,
      -1.0218792843237122e-40, -7.931336268371597e-41, -6.155922325367272e-41,
      -4.77793128341734e-41, -3.708400811846838e-41, -2.878282621819169e-41,
      -2.2339847474416936e-41, -1.733911678432693e-41, -1.3457789772504908e-41,
      -1.044529013869077e-41, -8.107132592035061e-42, -6.292366989537284e-42,
      -4.8838330792712015e-42, -3.790596700072256e-42, -2.942079122970939e-42,
      -2.2835005279396916e-42, -1.7723434493615272e-42, -1.3756078722385462e-42,
      -1.0676807696873569e-42, -8.28682540254108e-43, -6.431835919673707e-43,
      -4.992082165134026e-43, -3.874614442078847e-43, -3.0072896595368673e-43,
      -2.3341138148200115e-43, -1.8116270520388286e-43, -1.4060979181222907e-43,
      -1.091345679080456e-43, -8.470501064663375e-44, -6.574396147966411e-44,
      -5.102730568172509e-44, -3.9604944188549015e-44, -3.0739455733008517e-44,
      -2.3858489340701897e-44, -1.851781367127917e-44, -1.4372637691658884e-44,
      -1.1155351159844779e-44, -8.658247857431882e-45, -6.720116192359012e-45,
      -5.2158314687240496e-45, -4.048277906424433e-45, -3.1420789007305344e-45,
      -2.438730750857924e-45, -1.8928256937778617e-45, -1.469120404442044e-45,
      -1.1402607064363163e-45, -8.850156016561808e-46, -6.869066089480269e-46,
      -5.331439225856525e-46, -4.138007095685445e-46, -3.211722388374815e-46,
      -2.4927846814818856e-46, -1.934779758899125e-46, -1.501683135031315e-46,
      -1.165534334161417e-46, -9.046317777823143e-47, -7.021317428305415e-47,
      -5.449609403494599e-47, -4.229725112687918e-47, -3.282909508602647e-47,
      -2.5480367055874133e-47, -1.9776637266447996e-47, -1.5349676113809892e-47,
      -1.191368146285384e-47, -9.246827421371423e-48, -7.176943384563567e-48,
      -5.570398797125099e-48, -4.3234760393612404e-48, -3.3556744756906796e-48,
      -2.6045133786529727e-48, -2.0214982081019986e-48, -1.568989830827079e-48,
      -1.2177745591721913e-48, -9.451781317061105e-49, -7.33601875590779e-49,
      -5.693865461094327e-49, -4.419304934701071e-49, -3.4300522622674756e-49,
      -2.6622418447533647e-49, -2.0663042711980442e-49, -1.6037661452830278e-49,
      -1.2447662643917862e-49, -9.661277970763257e-50, -7.498619997864662e-50,
      -5.820068736510396e-50, -4.517257856425794e-50, -3.5060786161222183e-50,
      -2.72124984960584e-50, -2.1121034508262346e-50, -1.6393132690988446e-50,
      -1.2723562348199734e-50, -9.875418071709917e-51, -7.664825260580701e-51,
      -5.94906927976403e-51, -4.6173818831129885e-51, -3.583790077385973e-51,
      -2.781565753905366e-51, -2.1589177591960398e-51, -1.6756482870944286e-51,
      -1.3005577308734954e-51, -1.00943045408878e-51, -7.834714426383224e-52,
      -6.080929091681512e-52, -4.7197251368265536e-52, -3.6632239960937736e-52,
      -2.8432185469554775e-52, -2.2067696964127115e-52, -1.7127886627709554e-52,
      -1.3293843068833157e-52, -1.031804258050465e-52, -8.008369148173763e-53,
      -6.215711547323794e-53, -4.824336806245344e-53, -3.744418550135963e-53,
      -2.906237860601244e-53, -2.2556822612913843e-53, -1.750752246704261e-53,
      -1.3588498176091613e-53, -1.0546739724552009e-53, -8.185872888672451e-54,
      -6.35348142644612e-54, -4.9312671703044635e-54, -3.8274127636074254e-54,
      -2.970653983471063e-54, -2.3056789624108712e-54, -1.7895572851242694e-54,
      -1.388968424898461e-54, -1.0780505890488678e-54, -8.367310960532251e-55,
      -6.494304944632754e-55, -5.040567622360552e-55, -3.912246525563524e-55,
      -3.0364978755341163e-55, -2.3567838294124617e-55, -1.8292224286845746e-55,
      -1.4197546044928753e-55, -1.1019453432069755e-55, -8.552770567342314e-56,
      -6.638249785121821e-56, -5.152290694892693e-56, -3.99896060919176e-56,
      -3.1038011829804942e-56, -2.409021424549161e-56, -1.8697667414264082e-56,
      -1.451223152985697e-56, -1.1263697193346612e-56, -8.742340845540161e-57,
      -6.78538513133553e-57, -5.266490084750813e-57, -4.0875966914083645e-57,
      -3.172596253431127e-57, -2.4624168544909073e-57, -1.9112097099412792e-57,
      -1.4833891949334516e-57, -1.1513354563863746e-57, -8.93611290725284e-58,
      -6.935781700131426e-58, -5.3832206789637066e-58, -4.178197372889251e-58,
      -3.242916151484849e-58, -2.5169957823914556e-58, -1.9535712527367126e-58,
      -1.5162681901251344e-58, -1.1768545535079091e-58, -9.134179884087658e-59,
      -7.089511775790642e-59, -5.502538581119085e-59, -4.270806198544941e-59,
      -3.3147946746100524e-59, -2.5727844402227184e-59, -1.99687172980957e-59,
      -1.5498759410125623e-59, -1.2029392758034847e-59, -9.336636971893501e-60,
      -7.246649244759502e-60, -5.62450113832834e-60, -4.365467678449322e-60,
      -3.3882663693885816e-60, -2.6298096413824944e-60, -2.0411319524315642e-60,
      -1.584228600305421e-60, -1.2296021602306584e-60, -9.543581476514316e-61,
      -7.407269631161162e-61, -5.749166968788975e-61, -4.462227309232274e-61,
      -3.4633665481196705e-61, -2.6880987935816484e-61, -2.0863731931516697e-61,
      -1.6193426787346527e-61, -1.256856021625894e-61, -9.75511286055667e-62,
      -7.571450133094353e-62, -5.8765959899579435e-62, -4.5611315959464735e-62,
      -3.540131305791894e-62, -2.7476799120169246e-62, -2.1326171960202273e-62,
      -1.6552350529879195e-62, -1.2847139588636865e-62, -9.971332791193926e-63,
      -7.73926965973668e-63, -6.006849447349452e-63, -4.662228074418857e-63,
      -3.618597537431311e-63, -2.808581632835742e-63, -2.1798861870396702e-63,
      -1.6919229738209517e-63, -1.3131893611522013e-63, -1.0192345189029976e-63,
      -7.910808869270313e-64, -6.139989943971058e-64, -4.765565334097509e-64,
      -3.698802955834117e-64, -2.8708332268994273e-64, -2.2282028848468888e-64,
      -1.7294240743486874e-64, -1.3422959144684597e-64, -1.0418256278046046e-64,
      -8.086150207648289e-65, -6.2760814704122095e-65, -4.871193041404943e-65,
      -3.7807861096923375e-65, -2.93446461385151e-65, -2.2775905116323604e-65,
      -1.7677563785201776e-65, -1.3720476081361514e-65, -1.064917463665453e-65,
      -8.265377948220054e-66, -6.415189435599693e-66, -4.979161963609003e-66,
      -3.864586402121279e-66, -2.9995063764978364e-66, -2.328072804301306e-66,
      -1.8069383097813384e-66, -1.4024587415492488e-66, -1.0885211249884453e-66,
      -8.448578232235307e-67, -6.557380698234769e-67, -5.0895239932228516e-67,
      -3.9502441095976285e-67, -3.065989775505417e-67, -2.3796740258822304e-67,
      -1.846988699929713e-67, -1.433543931044646e-67, -1.1126479562723592e-67,
      -8.635839110245601e-68, -6.7027235989271034e-68, -5.202332172945797e-68,
      -4.037800401317321e-68, -3.1339467644270688e-68, -2.4324189771883265e-68,
      -1.8879267981654937e-68, -1.4653181169271293e-68, -1.137309553464292e-68,
      -8.827250584423588e-69, -6.851287993040941e-69, -5.317640721156905e-69,
      -4.1272973589824627e-69, -3.20341000505908e-69, -2.486333008737357e-69,
      -1.9297722803431612e-69, -1.497796570650054e-69, -1.1625177695329583e-69,
      -9.022904651820286e-70, -7.003145284269312e-70, -5.43550505797369e-70,
      -4.2187779970268283e-70, -3.274412883139267e-70, -2.5414420329357338e-70,
      -1.9725452584281826e-70, -1.53099490215518e-70, -1.1882847201655163e-70,
      -9.222895348581106e-71, -7.158368458952391e-71, -5.5559818318883754e-71,
      -4.312286283289656e-71, -3.34698952439298e-71, -2.597772536532656e-71,
      -2.0162662901633142e-71, -1.5649290673751911e-71, -1.2146227895906647e-71,
      -9.427318795141938e-72, -7.31703212115653e-72, -5.679128946994557e-72,
      -4.4078671601476684e-72, -3.421174810934768e-72, -2.6553515933502937e-72,
      -2.0609563889491597e-72, -1.5996153759025103e-72, -1.2415446365308072e-72,
      -9.636273242426984e-73, -7.479212528530796e-73, -5.805005590817323e-73,
      -4.505566566115481e-73, -3.497004398033571e-73, -2.7142068772961278e-73,
      -2.1066370339437234e-73, -1.6350704988280885e-73, -1.2690632002861451e-73,
      -9.849859119070578e-74, -7.644987628958279e-74, -5.933672262760243e-74,
      -4.605431457924783e-74, -3.574514731249526e-74, -2.7743666756637135e-74,
      -2.1533301803858236e-74, -1.671311476753941e-74, -1.2971917069536228e-74,
      -1.0068179079685637e-74, -7.814437098019749e-75, -6.065190803182852e-75,
      -4.707509833092892e-75, -3.6537430639505916e-75, -2.8358599027282434e-75,
      -2.2010582701473156e-75, -1.708355727983277e-75, -1.325943675783713e-75,
      -1.029133805420199e-75, -7.987642377287694e-76, -6.199624423122651e-76,
      -4.8118507529915326e-76, -3.7347274752174305e-76, -2.898716113643458e-76,
      -2.249844242519208e-76, -1.746221056892165e-76, -1.3553329256781013e-76,
      -1.0519443298298275e-76, -8.16468671346914e-77, -6.337037734675883e-77,
      -4.918504366426947e-77, -3.817506888145154e-77, -2.9629655186465816e-77,
      -2.299711545236849e-77, -1.7849256624867533e-77, -1.3853735818313903e-77,
      -1.0752604444951664e-77, -8.345655198416067e-78, -6.477496782051692e-78,
      -5.027521933742635e-78, -3.902121088550713e-78, -3.028638997578099e-78,
      -2.350684145749482e-78, -1.8244881471501564e-78, -1.416080082520012e-78,
      -1.0990933557130137e-78, -8.530634810022629e-79, -6.621069073314586e-79,
      -5.1389558514563326e-79, -3.988610744094939e-79, -3.095768114723367e-79,
      -2.4027865427395916e-79, -1.86492752558322e-79, -1.4474671860416214e-79,
      -1.123454518165272e-79, -8.719714454028879e-80, -6.767823612830478e-80,
      -5.252859677443067e-80, -4.077017423828423e-80, -3.1643851339831846e-80,
      -2.4560437778975697e-80, -1.9062632339434512e-80, -1.479549977808293e-80,
      -1.1483556404243479e-80, -8.912985006751033e-81, -6.917830934431867e-81,
      -5.369288156676382e-81, -4.167383618170612e-81, -3.2345230343806132e-81,
      -2.510481447957367e-81, -1.9485151391865116e-81, -1.5123438775969423e-81,
      -1.1738086905805796e-81, -9.11053935875887e-82, -7.071163135318137e-82,
      -5.488297247540119e-82, -4.259752759331759e-82, -3.3062155259115075e-82,
      -2.5661257169989126e-82, -1.9917035486147658e-82, -1.545864646960448e-82,
      -1.1998259019943958e-82, -9.312472459521214e-83, -7.227893910707234e-83,
      -5.609944148723387e-83, -4.3541692421875e-83, -3.379497065746364e-83,
      -2.6230033290232106e-83, -2.035849219637467e-83, -1.5801283968030406e-83,
      -1.226419779175967e-83, -9.518881363040975e-84, -7.388098589255399e-84,
      -5.734287326711654e-84, -4.450678445616123e-84, -3.4544028747912813e-84,
      -2.6811416208061638e-84, -2.0809733697472796e-84, -1.6151515951235993e-84,
      -1.2536031037951815e-84, -9.729865274501691e-85, -7.551854169261969e-85,
      -5.861386543887183e-85, -4.549326754308775e-85, -3.530968954615999e-85,
      -2.7405685350373015e-85, -2.127097686717925e-85, -1.6509510749305763e-85,
      -1.2813889408248287e-85, -9.945525597947969e-86, -7.719239355676647e-86,
      -5.9913028872522894e-86, -4.650161581063073e-86, -3.609232104757125e-86,
      -2.8013126337497174e-86, -2.1742443390278576e-86, -1.687544042332352e-86,
      -1.3097906448199459e-86, -1.016596598502276e-86, -7.890334597927033e-87,
      -6.124098797789255e-87, -4.753231389570867e-87, -3.689229940404904e-87,
      -2.863403112047687e-87, -2.2224359865149814e-87, -1.724948084806915e-87,
      -1.3388218663363454e-87, -1.0391292384784875e-87, -8.065222128584589e-88,
      -6.259838100471002e-88, -4.858585717711075e-88, -3.771000910481997e-88,
      -2.9268698121385484e-88, -2.271695791267521e-88, -1.763181179654834e-88,
      -1.3684965584914053e-88, -1.0621613094630708e-88, -8.24398600288764e-89,
      -6.398586034936934e-89, -4.966275201358802e-89, -3.854584316122976e-89,
      -2.9917432376756013e-89, -2.3220474287562927e-89, -1.8022617026395908e-89,
      -1.398828983670282e-89, -1.0857038812344622e-89, -8.426712139140371e-90,
      -6.540409286848713e-90, -5.0763515987221875e-90, -3.940020329563419e-90,
      -3.0580545684189115e-90, -2.373515099213716e-90, -1.8422084368194222e-90,
      -1.4298337203807613e-90, -1.1097682689303026e-90, -8.61348836000729e-91,
      -6.685376019941025e-91, -5.188867815218673e-91, -4.027350013447668e-91,
      -3.1258356752210685e-91, -2.4261235392650378e-91, -1.88304058157492e-91,
      -1.4615256702600473e-91, -1.134366038485769e-91, -8.804404434722935e-92,
      -6.833555908782735e-92, -5.303877928902632e-92, -4.116615340564541e-92,
      -3.1951191353450954e-92, -2.4798980338173607e-92, -1.924777761836721e-92,
      -1.4939200652368536e-92, -1.1595090121924468e-92, -8.999552122237184e-93,
      -6.985020172264203e-93, -5.42143721645662e-93, -4.207859214020489e-93,
      -3.2659382481218863e-93, -2.5348644282121927e-93, -1.9674400375177343e-93,
      -1.5270324748522441e-93, -1.1852092743804147e-93, -9.199025215316853e-94,
      -7.139841607826827e-94, -5.541602179758706e-94, -4.301125487859881e-94,
      -3.3383270509546787e-94, -2.5910491406473507e-94, -2.0110479131544257e-94,
      -1.5608788137427353e-94, -1.211479177226269e-94, -9.402919585624802e-95,
      -7.29809462645128e-95, -5.66443057303865e-95, -4.3964589881423297e-95,
      -3.412320335678266e-95, -2.6484791748741942e-95, -2.0556223477618007e-95,
      -1.5954753492892605e-95, -1.2383313466898822e-95, -9.611333229798207e-96,
      -7.459855288421248e-96, -5.789981430636012e-96, -4.493905534487198e-96,
      -3.4879536652808038e-96, -2.707182133176291e-96, -2.101184764906822e-96,
      -1.6308387094356737e-96, -1.2657786885827514e-96, -9.824366316548156e-97,
      -7.625201339879884e-97, -5.918315095373508e-97, -4.5935119620956385e-97,
      -3.5652633909962623e-97, -2.7671862296357544e-97, -2.147757063005102e-97,
      -1.6669858906805465e-97, -1.2938343947708457e-97, -1.0042121234803178e-97,
      -7.794212250196492e-98, -6.049493247559238e-98, -4.695326144260727e-98,
      -3.6442866697757106e-98, -2.8285203036936187e-98, -2.1953616258458167e-98,
      -1.703934266246102e-98, -1.3225119495149411e-98, -1.0264702642919877e-98,
      -7.966969250161466e-99, -6.1835789346317656e-99, -4.7993970153765534e-99,
      -3.725061482145868e-99, -2.891213834010786e-99, -2.2440213333499065e-99,
      -1.7417015944282128e-99, -1.351825135951489e-99, -1.0492217518984318e-99,
      -8.143555371027807e-100, -6.320636601462262e-100, -4.905774594457289e-100,
      -3.8076266504634725e-100, -2.955296952636193e-100, -2.293759572566726e-100,
      -1.7803060271314726e-100, -1.381788042717126e-100, -1.0724775212228301e-100,
      -8.324055484417966e-101, -6.46073212132829e-101, -5.014510009177548e-101,
      -3.892021857574258e-101, -3.020800459489011e-101, -2.344600248914433e-101,
      -1.8197661185934475e-101, -1.4124150707200227e-101, -1.0962487495585302e-101,
      -8.50855634311524e-102, -6.603932827574121e-102, -5.125655520445608e-102,
      -3.978287665885508e-102, -3.0877558371618465e-102, -2.396567797669522e-102,
      -1.860100834302298e-102, -1.4437209400613101e-102, -1.1205468619411273e-102,
      -8.697146622759282e-103, -6.750307545972786e-103, -5.23926454752128e-103,
      -4.066465536861338e-103, -3.156195266052044e-103, -2.4496871957110136e-103,
      -1.9013295601120573e-103, -1.475720697109923e-103, -1.1453835366396177e-103,
      -8.889916964465789e-104, -6.899926627805438e-104, -5.355391693690519e-104,
      -4.156597850950093e-104, -3.226151639828376e-104, -2.503983973524959e-104,
      -1.943472111559948e-104, -1.508429721734253e-104, -1.1707707107692604e-104,
      -9.086960018390851e-105, -7.052861983673898e-105, -5.4740927725091e-105,
      -4.248727927953436e-105, -3.2976585812405484e-105, -2.5594842274750162e-105,
      -1.986548743390218e-105, -1.5418637346940931e-105, -1.1967205860288497e-105,
      -9.28837048826089e-106, -7.209187118062665e-106, -5.595424834627987e-106,
      -4.3429000478469045e-106, -3.370750458279118e-106, -2.616214632345003e-106,
      -2.0305801592890644e-106, -1.5760388051964173e-106, -1.223245634565148e-106,
      -9.494245176889587e-107, -7.368977164666959e-107, -5.719446195213271e-107,
      -4.4391594720619523e-107, -3.445462400693593e-107, -2.6742024541594533e-107,
      -2.075587521835336e-107, -1.6109713586186387e-107, -1.2503586049673078e-107,
      -9.704683032703695e-108, -7.532308922503833e-108, -5.846216461973871e-108,
      -4.537552465239704e-108, -3.521830316876648e-108, -2.733475563288335e-108,
      -2.1215924626717847e-108, -1.6466781844030457e-108, -1.2780725283941555e-108,
      -9.919785197300075e-109, -7.699260892823653e-109, -5.975796563810461e-109,
      -4.638126317466878e-109, -3.5998909111225866e-109, -2.794062447842237e-109,
      -2.1686170929017663e-109, -1.6831764441262232e-109, -1.3064007248372868e-109,
      -1.0139655054056843e-109, -7.869913316839736e-110, -6.108248780099399e-110,
      -4.7409293670045635e-110, -3.679681701268319e-110, -2.855992227364454e-110,
      -2.2166840137163794e-110, -1.720483679747326e-110, -1.3353568095229808e-110,
      -1.0364398277821943e-110, -8.04434821429424e-111, -6.243636770625716e-111,
      -4.846011023520772e-111, -3.761241036725359e-111, -2.919294666826548e-111,
      -2.2658163272571497e-111, -1.7586178220391735e-111, -1.3649546994560113e-111,
      -1.0594122885703073e-111, -8.222649422878861e-112, -6.382025606179575e-112,
      -4.953421791837936e-112, -3.8446081169114863e-112, -2.984000190934131e-112,
      -2.3160376477194884e-112, -1.7975971992062205e-112, -1.395208620108502e-112,
      -1.0828939288983367e-112, -8.404902638529291e-113, -6.523481799830889e-113,
      -5.063213296206768e-113, -3.929823010090958e-113, -3.050139898749722e-113,
      -2.3673721127022545e-113, -1.8374405456935425e-113, -1.426133112257037e-113,
      -1.1068960346187764e-113, -8.591195456612789e-114, -6.668073338897135e-114
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_2_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<2>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.6223034126127684), "design.b()[0] == 0.6223034126127684");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.6223034126127684));
    static_assert(almost_equal(design.b()[1], -1.244606825225537), "design.b()[1] == -1.244606825225537");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -1.244606825225537));
    static_assert(almost_equal(design.b()[2], 0.6223034126127684), "design.b()[2] == 0.6223034126127684");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.6223034126127684));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.71842244534351), "design.a()[1] == -1.71842244534351");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.71842244534351));
    static_assert(almost_equal(design.a()[2], 0.7976852925060938), "design.a()[2] == 0.7976852925060938");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.7976852925060938));
    std::cout << "max_deviation(cheby1,highpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.6223034126127684, -0.17522667317789198, -0.1752123153165493, -0.1613130352917863,
      -0.1374396535779438, -0.10750234984680068, -0.07510086063765445, -0.04330196120172268,
      -0.014504210071227305, 0.009616977448909287, 0.028095824957804872,
      0.040609174758576554, 0.04737209104234848, 0.04901192308430164, 0.0464351684177726,
      0.04069914546061919, 0.03289767416392777, 0.02406699193138869, 0.015115268288576594,
      0.006776530795947415, -0.000412284584763745, -0.006114018034469014,
      -0.010177592472073543, -0.012612341079357367, -0.013554814171001888,
      -0.013232217930836124, -0.011926064387164266, -0.009938871096851572,
      -0.007565933015083976, -0.005073377815013394, -0.0026829728208080566,
      -0.0005635218491602699, 0.0011717993653136867, 0.0024631594218753033,
      0.0032980213175311615, 0.003702567813339181, 0.0037317925364823107,
      0.003459312166849479, 0.0029677636519280883, 0.0023404292342646357,
      0.0016545047111212637, 0.0009762120531931603, 0.00035777062917852383,
      -0.00016390891773431545, -0.0005670531322129706, -0.000843689097109855,
      -0.000997484337729375, -0.0010411010906204872, -0.0009933728962819492,
      -0.0008765632535667754, -0.0007139070203541891, -0.0005275722323434381,
      -0.0003371188352455602, -0.0001584759627590631, -3.413914750427928e-06,
      0.00012054739697502345, 0.0002098745822759006, 0.00026449430727313103,
      0.0002870990867313855, 0.00028237429581347176, 0.00025622360893638014,
      0.0002150545778710221, 0.00016516880914605467, 0.00011228391505341802,
      6.119847004228373e-05, 1.5597596918227622e-05, -2.2013858838901412e-05,
      -5.027108279750035e-05, -6.882682560384968e-05, -7.817305857347655e-05,
      -7.943219195974226e-05, -7.414056245217574e-05, -6.404291535040385e-05,
      -5.091194695713829e-05, -3.640214072305475e-05, -2.194254437649073e-05,
      -8.669108493989767e-06, 2.6060543120988638e-06, 1.1393522568490217e-05,
      1.750007371698808e-05, 2.098407408771744e-05, 2.209995248527095e-05,
      2.1238367115084252e-05, 1.8867679690422134e-05, 1.5481111187025498e-05,
      1.1552618349877461e-05, 7.503223969374938e-06, 3.678354733780049e-06,
      3.3575592971360656e-07, -2.3571989459794737e-06, -4.318491143915445e-06,
      -5.540689181002778e-06, -6.076447779987955e-06, -6.022177983055495e-06,
      -5.5015527911583735e-06, -4.650188994631405e-06, -3.602481396011094e-06,
      -2.4811975214467157e-06, -1.3900990860598504e-06, -4.09562700076128e-07,
      4.050598594897949e-07, 1.0227660964647636e-06, 1.4344339240018211e-06,
      1.6491179785430851e-06, 1.689654505099898e-06, 1.5880630693482458e-06,
      1.3811506748542814e-06, 1.1066257660797528e-06, 7.999269749607776e-07,
      4.918733704982282e-07, 2.0715625712581704e-07, -3.6378191483481974e-08,
      -2.2775860032609448e-07, -3.623671426060384e-07, -4.410201455873098e-07,
      -4.688039768816005e-07, -4.5380799250574906e-07, -4.0587580277133906e-07,
      -3.35470128260533e-07, -2.527182396903648e-07, -1.666771080430639e-07,
      -8.483206063711251e-08, -1.28214394001546e-08, 4.5636637856372485e-08,
      8.865049646066529e-08, 1.1593532809139746e-07, 1.2851067280048513e-07,
      1.2835571850617302e-07, 1.1805827404619117e-07, 1.004865191180636e-07,
      7.850494104161964e-08, 5.474803436067634e-08, 3.145801422586594e-08,
      1.038645592853369e-08, -7.245276284257274e-09, -2.0735568525036773e-08,
      -2.985301603828638e-08, -3.4759634777216995e-08, -3.591842476242296e-08,
      -3.399577787846042e-08, -2.976750859028727e-08, -2.4035222882553497e-08,
      -1.7557562683192903e-08, -1.0998766004805459e-08, -4.8951168491020576e-09,
      3.616752116731472e-10, 4.526273517290985e-09, 7.489547008861046e-09,
      9.259663870879324e-09, 9.937712735553935e-09, 9.690890936801453e-09,
      8.725877210873738e-09, 7.264462082909735e-09, 5.52291078129088e-09,
      3.69593928869463e-09, 1.9456403282607042e-09, 3.9523559806156905e-10,
      -8.72826951452526e-10, -1.8151590479253345e-09, -2.4229688277466404e-09,
      -2.7157583418780766e-09, -2.7340534927179345e-09, -2.5319384013394392e-09,
      -2.1700255190228434e-09, -1.7093305345771915e-09, -1.2063545162410418e-09,
      -7.095188502863136e-10, -2.569618625725401e-10, 1.2440371938729805e-10,
      4.1875284218843583e-10, 6.20359265779694e-10, 7.320063030838056e-10,
      7.630445989697949e-10, 7.27322303676123e-10, 6.411775175115825e-10,
      5.216395329874406e-10, 3.849392062595664e-10, 2.453839886753252e-10,
      1.1461301052537068e-10, 1.2143710324001843e-12, -8.933831038688287e-11,
      -1.544896437100758e-10, -1.9421461507155524e-10, -2.105086371206764e-10,
      -2.068206249345304e-10, -1.8748556027080274e-10, -1.5720162424995689e-10,
      -1.2058432557029838e-10, -8.181738799435017e-11, -4.440849293467647e-11,
      -1.1048023948468935e-11, 1.6438829346610548e-11, 3.706169953933592e-11,
      5.0574643955163274e-11, 5.7345030700000897e-11, 5.820033822702822e-11,
      5.426947994820806e-11, 4.6832338617539674e-11, 3.718777586166789e-11,
      2.6546841004217122e-11, 1.5954545568746545e-11, 6.240624579028197e-12,
      -2.0026769992429443e-12, -8.419499549015088e-12, -1.2870751015650754e-11,
      -1.5401276473211006e-11, -1.619909038981425e-11, -1.5551508791504615e-11,
      -1.3802285610346822e-11, -1.1312947550599277e-11, -8.430542759601528e-12,
      -5.463062028521599e-12, -2.662928442937486e-12, -2.1823177448723424e-13,
      1.749164474361379e-12, 3.1798837702060495e-12, 4.069100868933395e-12,
      4.455887750169733e-12, 4.411235606950928e-12, 4.025970155314513e-12,
      3.399539713731609e-12, 2.6303881669501863e-12, 1.8083552351190913e-12,
      1.0092962708248596e-12, 2.918989911060424e-13, -3.0349501292848897e-13,
      -7.543761743687913e-13, -1.054243442105698e-12, -1.2098808144596353e-12,
      -1.238131859269209e-12, -1.1625294458833555e-12, -1.0100771188564387e-12,
      -8.08406551484397e-13, -5.834603010248209e-13, -3.5777726076325943e-13,
      -1.493947744404251e-13, 2.867032528851216e-14, 1.6843774483947133e-13,
      2.6657730456117883e-13, 3.237321118157621e-13, 3.436637320582905e-13,
      3.3232312651211274e-13, 2.969360150744921e-13, 2.4517224275651174e-13,
      1.8444799288770747e-13, 1.213892787991935e-13, 6.146661015380239e-14,
      8.79516016143488e-15, -3.391721026809315e-14, -6.529986531413877e-14,
      -8.515749444002961e-14, -9.424780767124472e-14, -9.402866726520409e-14,
      -8.640088230396835e-14, -7.34679304972196e-14, -5.732822770593357e-14,
      -3.9909825613147936e-14, -2.285205603691515e-14, -7.434005097991549e-15,
      5.45398778498555e-15, 1.5302251557431684e-14, 2.1945166698992426e-14,
      2.55046860127618e-14, 2.6322488188387786e-14, 2.4888441597849024e-14,
      2.177179498132254e-14, 1.7559997355320806e-14, 1.2808452947496967e-14,
      8.002981408319715e-15, 3.5353883457487548e-15, -3.085698792758212e-16,
      -3.3503806932057387e-15, -5.5112277292415866e-15, -6.798068028061697e-15,
      -7.285727381125544e-15, -7.0972385789392065e-15, -6.384336496874223e-15,
      -5.3096243030277654e-15, -4.031486252697858e-15, -2.692387249471629e-15,
      -1.4108013903311363e-15, -2.7667506443240165e-16, 6.499308789267954e-16,
      1.3375554399705432e-15, 1.7800449866712317e-15, 1.991920956441014e-15,
      2.0030459750315028e-15, 1.853153111761442e-15, 1.5866995874128739e-15,
      1.2483872030135655e-15, 8.795696656333795e-16, 5.156521444709449e-16,
      1.844884330381367e-16, -9.429906745471297e-17, -3.092093437611574e-16,
      -4.561312974234455e-16, -5.37174513692369e-16, -5.592435139890463e-16,
      -5.325203977700384e-16, -4.689946780927998e-16, -3.811472923206668e-16,
      -2.808619051274816e-16, -1.786038124502871e-16, -8.28773891930621e-17,
      5.12685762832284e-20, 6.619817551283503e-17, 1.1371553445277596e-16,
      1.4260601579055788e-16, 1.5434816901305629e-16, 1.5148063661068974e-16,
      1.371864616397733e-16, 1.149104189552355e-16, 8.803302035550443e-17,
      5.96155669539761e-17, 3.22220827531159e-17, 7.816689275071317e-18,
      -1.2270707207516372e-17, -2.732151675644903e-17, -3.716174496702649e-17,
      -4.206560457389135e-17, -4.264310167266012e-17, -3.972374896439433e-17,
      -3.424640680248324e-17, -2.716274380965034e-17, -1.93592136120971e-17,
      -1.1599985954158246e-17, -4.491116256441354e-18, 1.535503209193359e-18,
      6.2211405642731535e-18, 9.465699254714525e-18, 1.1303557729439019e-17,
      1.1873638235732463e-17, 1.1387244698404498e-17, 1.0096670291175388e-17,
      8.266907233503521e-18, 6.152073549071248e-18, 3.97747095745014e-18,
      1.9275567804743612e-18, 1.3958675211310716e-19, -1.2977146863510313e-18,
      -2.3413683438668447e-18, -2.9882919957461714e-18, -3.2674729464886407e-18,
      -3.2311822760783706e-18, -2.946121035133663e-18, -2.4852139344382607e-18,
      -1.9205699867502094e-18, -1.3179319688520432e-18, -7.327534450518492e-19,
      -2.0788501880300588e-19, 2.272723637892893e-19, 5.563767531733008e-19,
      7.747984787325354e-19, 8.8761754337336e-19, 9.072565582724092e-19,
      8.510105737010911e-19, 7.386904580090134e-19, 5.905436447952327e-19,
      4.255609401027127e-19, 2.6022549129788656e-19, 1.0771362211182991e-19,
      -2.2480541237279068e-20, -1.245526388067766e-19, -1.9610165303977376e-19,
      -2.376316740335231e-19, -2.519241979177982e-19, -2.4335690481696155e-19,
      -2.172337399613689e-19, -1.7917711083323614e-19, -1.346178095443575e-19,
      -8.840331939859494e-20, -4.453160151449644e-20, -6.0060758766258814e-21,
      2.520122798502579e-20, 4.809731421214742e-20, 6.254885538614547e-20,
      6.911883687002336e-20, 6.888105866886589e-20, 6.323167766925674e-20,
      5.371332673117308e-20, 4.1863206971665264e-20, 2.909234374913932e-20,
      1.6599271987734017e-20, 5.318026826863887e-21, -4.102378466701991e-21,
      -1.1291731021416768e-20, -1.6131557066802293e-20, -1.8713581979213807e-20,
      -1.9289933488445898e-20, -1.8220705560802937e-20, -1.5923573168525012e-20,
      -1.2829036697926554e-20, -9.343704493175516e-21, -5.822897632772857e-21,
      -2.5528623373652553e-21, 2.5794386103090747e-22, 2.4796372607430724e-21,
      4.055306300934402e-21, 4.990759196623792e-21, 5.3413744299202045e-21,
      5.1976824997724476e-21, 4.671078446862669e-21, 3.8807711618643234e-21,
      2.9427536925849067e-21, 1.9612599170544425e-21, 1.022881722575926e-21,
      1.932747203900542e-22, -4.838100884363546e-22, -9.855625171210341e-22,
      -1.3076845587982798e-21, -1.4609857725153547e-21, -1.4674700040272049e-21,
      -1.3563265294925277e-21, -1.1601627120884663e-21, -9.117279202913988e-22,
      -6.412889899281469e-22, -3.747334414605787e-22, -1.3240356131490546e-22,
      7.139410325634769e-23, 2.2830160303720893e-22, 3.353685728277939e-22,
      3.9419205201175445e-22, 4.0986989183952514e-22, 3.8988841949498303e-22,
      3.4304582667823228e-22, 2.7848939039569967e-22, 2.0491980864918118e-22,
      1.2999190784061262e-22, 5.991949464371887e-23, -7.256285198575256e-25,
      -4.904383594719677e-23, -8.36992052992945e-23, -1.047090464205616e-22,
      -1.1316875053791326e-22, -1.1094685471381072e-22, -1.0038051750509326e-22,
      -8.399546010093218e-23, -6.426762147643371e-23, -4.3436980094148265e-23,
      -2.3377745115623692e-23, -5.52380175622533e-24, 9.155858529163683e-24,
      2.0139888222564966e-23, 2.7305342279384704e-23, 3.085682042282503e-23,
      3.1243982863406546e-23, 2.90763296096166e-23, 2.504255181991943e-23,
      1.9839922646376898e-23, 1.411729311584163e-23, 8.433458858282243e-24,
      3.231087905448863e-24, -1.174872116605704e-24, -4.5963179165543566e-24,
      -6.96123766574965e-24, -8.295931850477198e-24, -8.70303859329219e-24,
      -8.337954036645581e-24, -7.385841478832185e-24, -6.040932470350334e-24,
      -4.489296827408539e-24, -2.895745447407278e-24, -1.3950679199078914e-24,
      -8.742247211013877e-26, 9.625964234561147e-25, 1.7238829201111553e-24,
      2.1945100934534116e-24, 2.3959793497481e-24, 2.366776267382723e-24,
      2.15588397253443e-24, 1.8167767888158275e-24, 1.4022730748398976e-24,
      9.604814021009042e-25, 5.319401918281157e-25, 1.4793607703624347e-25,
      -1.7010419225901072e-25, -4.103172949077717e-25, -5.694088369235054e-25,
      -6.51180854537479e-25, -6.647947417782901e-25, -6.229608153920596e-25,
      -5.402128596872815e-25, -4.313872231039789e-25, -3.103856338210831e-25,
      -1.892623966252319e-25, -7.764269531604424e-26, 1.7548879864344614e-26,
      9.209082517366683e-26, 1.442524576208902e-25, 1.7442716415591719e-25,
      1.8467149011110236e-25, 1.7820565016122912e-25, 1.5892285751727855e-25,
      1.3094457926072136e-25, 9.824767801311128e-26, 6.437845009093658e-26,
      3.2258645858759166e-26, 4.0802383082015085e-27, -1.872067426653089e-26,
      -3.5424772939943624e-26, -4.594151841298752e-26, -5.0689116049479017e-26,
      -5.045844120060865e-26, -4.627495555336763e-26, -3.926996585167119e-26,
      -3.0569539291090396e-26, -2.1206308264525422e-26, -1.2056524213444094e-26,
      -3.802241610247483e-27, 3.0834547181396283e-27, 8.331670007900589e-27,
      1.1857702270003208e-26, 1.373049110365777e-26, 1.4136069394417214e-26,
      1.3339128124026412e-26, 1.1646122519867719e-26, 9.372532019970935e-27,
      6.816028743996313e-27, 4.2364858359165534e-27, 1.8430264674342253e-27,
      -2.122843942198867e-28, -1.834949374595346e-27, -2.98388205227591e-27,
      -3.6638577642806184e-27, -3.9158565910125126e-27, -3.806490406341315e-27,
      -3.417537342027922e-27, -2.836391463136369e-27, -2.1479994797082144e-27,
      -1.4286227645830548e-27, -7.415498313142343e-28, -1.347045066237754e-28,
      3.6004414642852027e-28, 7.2615974630538985e-28, 9.606472866971897e-28,
      1.071550909881027e-27, 1.0750829229835842e-27, 9.92686224476881e-28,
      8.482764534359116e-28, 6.658460961020486e-28, 4.67547225801055e-28,
      2.7230800914141986e-28, 9.498464938189439e-29, -5.399234046279472e-29,
      -1.6854950755368021e-28, -2.465703610366865e-28, -2.8926257952717947e-28,
      -3.003897586905848e-28, -2.854559983240163e-28, -2.5091750215099486e-28,
      -2.034782161050861e-28, -1.4950833259522243e-28, -9.460689416510919e-29,
      -4.3314012399243215e-29, 1.0347569404415328e-30, 3.6329100202232604e-29,
      6.160333081394114e-29, 7.688135745729682e-29, 8.297457932342819e-29,
      8.125825139072514e-29, 7.344840148100867e-29, 6.139686965042251e-29,
      4.691704926163238e-29, 3.1647930594420444e-29, 1.695947411833763e-29,
      3.89845221275089e-30, -6.829135288345477e-30, -1.4845077355429512e-29,
      -2.0062613350383202e-29, -2.2634345221005468e-29, -2.2891715264592318e-29,
      -2.1282553034786432e-29, -1.8312032242388105e-29, -1.4491027682343698e-29,
      -1.0294468429783176e-29, -6.130965957115333e-30, -2.323843451737602e-30,
      8.972366259160151e-31, 3.3955273002960386e-30, 5.119237866214369e-30,
      6.088451064606116e-30, 6.378990212075258e-30, 6.105132090677312e-30,
      5.4027693431940814e-30, 4.41426602881825e-30, 3.275864179769915e-30,
      2.1081234460158296e-30, 1.0095379707385095e-30, 5.31936406695026e-32,
      -7.138844454085456e-31, -1.2691868391885646e-30, -1.611544029144947e-30,
      -1.756901756278978e-30, -1.733594441978293e-30, -1.5775929088563891e-30,
      -1.3281082746571841e-30, -1.0238284080607001e-30, -6.999572790421419e-31,
      -3.8612943592763898e-31, -1.051878626313831e-31, 1.2725258791967313e-31,
      3.0258051428042035e-31, 4.184536294461949e-31, 4.777160831353758e-31,
      4.871237339563915e-31, 4.560172645794961e-31, 3.9505886470989125e-31,
      3.1511975526547815e-31, 2.2637621436611643e-31, 1.376435737052368e-31,
      5.595282973931489e-32, -1.3645655848123318e-32, -6.80817506479971e-32,
      -1.0610826945515053e-31, -1.2803102068831335e-31, -1.3537037369338978e-31,
      -1.3049502640164862e-31, -1.1626262623801606e-31, -9.569434317620056e-32,
      -7.17023201881891e-32, -4.688090626690517e-32, -2.3365315334413845e-32,
      -2.7552728847186315e-33, 1.390344562888217e-32, 2.6089833693265124e-32,
      3.374278172046871e-32, 3.7172876855732596e-32, 3.696258524021982e-32,
      3.386507896675842e-32, 2.8710001190681894e-32, 2.2322235030566012e-32,
      1.545748400911842e-32, 8.756368890060658e-33, 2.716933187165977e-33,
      -2.3159877080346007e-33, -6.147102904750336e-33, -8.715890273035168e-33,
      -1.0074127897693975e-32, -1.035907001476148e-32, -9.765274767435234e-33,
      -8.517589550491212e-33, -6.847201004523485e-33, -4.972027981921354e-33,
      -3.0821329468683156e-33, -1.3302928403238307e-33, 1.7256704557308037e-34,
      1.357698117891875e-33, 2.195444725561162e-33, 2.6896856736097697e-33,
      2.87074226435969e-33, 2.7876252385690843e-33, 2.500368896307806e-33,
      2.073042379228764e-33, 1.5678550601905892e-33, 1.0406019098242832e-33,
      5.375387562140819e-34, 9.364582509972828e-35, -2.6786367221990606e-34,
      -5.3500284402147466e-34, -7.056899837626226e-34, -7.859096074269257e-34,
      -7.876061882972272e-34, -7.265316169777057e-34, -6.2022636517472015e-34,
      -4.86267321706273e-34, -3.408672305327448e-34, -1.9786560907812616e-34,
      -6.81119273081619e-35, 4.07894215724305e-35, 1.2442534022060826e-34,
      1.8127817572643723e-34, 2.1226022211018864e-34, 2.201497952984328e-34,
      2.0899349221723174e-34, 1.8352885409902817e-34, 1.4866906728077174e-34,
      1.090779944782711e-34, 6.885094558404598e-35, 3.130509834337146e-35,
      -1.1260030205954102e-36, -2.690656539308004e-35, -4.533864984972526e-35,
      -5.644798205742464e-35, -6.083550519461677e-35, -5.951337252138565e-35,
      -5.37415273829149e-35, -4.4877704934098203e-35, -3.425002946409281e-35,
      -2.3057734197415346e-35, -1.2302183212195948e-35, -2.7475323107726165e-36,
      5.091849421945896e-36, 1.0941614449969803e-35, 1.4740622463581094e-35,
      1.6602651576739434e-35, 1.677199138010328e-35, 1.5577675461309195e-35,
      1.3390256309043168e-35, 1.05840343834429e-35, 7.506631726185069e-36,
      4.456835884152916e-36, 1.670797094303299e-36, -6.840172074366683e-37,
      -2.5082007911480172e-36, -3.764518070743782e-36, -4.468277466916441e-36,
      -4.675487592766125e-36, -4.470183604138777e-36, -3.9520961521143624e-36,
      -3.2255710181256534e-36, -2.390364661485088e-36, -1.534665725759176e-36,
      -7.304452950509936e-37, -3.103331175990506e-38, 5.2933712936088826e-37,
      9.343796206160842e-37, 1.1834144696696565e-36, 1.2882651058417502e-36,
      1.269791356036912e-36, 1.1544078393382317e-36, 9.708664529373084e-37,
      7.4750454916466415e-37, 5.100827047852895e-37, 2.802641839345181e-37,
      7.472679273000481e-38, -9.515041964501529e-38, -2.2311708031872443e-37,
      -3.0750930843259515e-37, -3.5045368428548447e-37, -3.569318244841034e-37,
      -3.3380790899178857e-37, -2.889037364263374e-37, -2.3018500569366118e-37,
      -1.6510081886816462e-37, -1.0009775929038237e-37, -4.031174130133742e-38,
      1.0573909335654002e-38, 5.032652628880245e-38, 7.804758040950426e-38,
      9.397398413694553e-38, 9.922959661093388e-38, 9.555670103436865e-38,
      8.505279006258402e-38, 6.99324484671161e-38, 5.232812938418892e-38,
      3.4137746445470677e-38, 1.6921690531218972e-38, 1.8474345631492794e-39,
      -1.0323510641473898e-38, -1.9213823780942924e-38, -2.478255344031335e-38,
      -2.7260311441897484e-38, -2.7076052658726884e-38, -2.4782947113721883e-38,
      -2.0989403596993887e-38, -1.629966983787581e-38, -1.1266779953297877e-38,
      -6.359080656114655e-39, -1.9402422685689472e-39, 1.738389249529572e-39,
      4.5349898266715836e-39, 6.406340770556477e-39, 7.391305086242806e-39,
      7.591140749126228e-39, 7.148851289338885e-39, 6.229405185101146e-39,
      5.002216159398198e-39, 3.626815627553487e-39, 2.2422071192222594e-39,
      9.600015560498671e-40, -1.3888742027526647e-40, -1.0044463824208185e-39,
      -1.6152747562283327e-39, -1.974492290131495e-39, -2.104530953119964e-39,
      -2.0414497667569482e-39, -1.829319711308786e-39, -1.5151095972903148e-39,
      -1.1443769101365313e-39, -7.579423260181537e-40, -3.896124750059846e-40,
      -6.491937600358125e-41, 1.992292282269231e-40, 3.9414520899033925e-40,
      5.183857486596511e-40, 5.764018695196095e-40, 5.769932225698939e-40,
      5.317308105863802e-40, 4.534791522726347e-40, 3.5511490658354377e-40,
      2.4850377592321336e-40, 1.437645281676957e-40, 4.882038486141033e-41,
      -3.078480456729289e-41, -9.184460212238369e-41, -1.3327123993474435e-40,
      -1.557532017135256e-40, -1.6134128974864131e-40, -1.530104553971217e-40,
      -1.3423702702019056e-40, -1.0862173035773504e-40, -7.957911733503329e-41,
      -5.010458465621809e-41, -2.2621751399086412e-41, 1.0939649102206244e-42,
      1.99249322379217e-41, 3.33668110601924e-41, 4.144445165500003e-41,
      4.460286151836089e-41, 4.35869288185263e-41, 3.932171016846297e-41,
      3.2802657278730455e-41, 2.5002472657110844e-41, 1.6798612936705417e-41,
      8.92300880620937e-42, 1.933492138475468e-42, -3.7951966009641063e-42,
      -8.064069265626153e-42, -1.0830105116098551e-41, -1.217810626599293e-41,
      -1.2288115581853878e-41, -1.1401877367874165e-41, -9.791192915749347e-42,
      -7.73029578980073e-42, -5.4736232093549e-42, -3.2396537220628176e-42,
      -1.200864940310984e-42, 5.2063085964564506e-43, 1.8525760561258433e-42,
      2.7682086969884717e-42, 3.279179285079572e-42, 3.4268559216110594e-42,
      3.2730330454561424e-42, 2.890900881456302e-42, 2.3569386397110534e-42,
      1.7441871455462798e-42, 1.1171550515495282e-42, 5.2843188213114226e-43,
      1.693105301932534e-44, -3.924276389356162e-43, -6.8786211490027825e-43,
      -8.690039415942619e-43, -9.446183859994715e-43, -9.300617734460842e-43,
      -8.447308335031189e-43, -7.097078267654151e-43, -5.457484971378009e-43,
      -3.717029716068511e-43, -2.034071798359665e-43, -5.30374697425534e-44,
      7.111413729546153e-44, 1.6451133927513292e-43, 2.25973276514061e-43,
      2.570892746193242e-43, 2.6153242078824917e-43, 2.443468488426559e-43,
      2.112705439238764e-43, 1.6814015712672485e-43, 1.2040841434230963e-43,
      7.278959139439418e-44, 2.9035246424669566e-44, -8.168367340604288e-45,
      -3.7197694817154336e-44, -5.740556719744881e-44, -6.897496108899699e-44,
      -7.27365446406525e-44, -6.997179889535444e-44, -6.222023787527785e-44,
      -5.110517845047147e-44, -3.818811707323588e-44, -2.485746830321379e-44,
      -1.225353212883631e-44, -1.2283077705201111e-45, 7.663710717772005e-45,
      1.414929555525388e-44, 1.820123774235938e-44, 1.999073050575593e-44,
      1.983366034741731e-44, 1.8136295403427053e-44, 1.5344797940933289e-44,
      1.1901789097101006e-44, 8.211981890242761e-45, 4.6177718836807314e-45,
      1.3847056762201074e-45, -1.3040194015490843e-45, -3.3454155611558425e-45,
      -4.7086400915333504e-45, -5.4228440298801925e-45, -5.562723949822474e-45,
      -5.233386766434938e-45, -4.5558662035606974e-45, -3.654307088599453e-45,
      -2.6454958580212526e-45, -1.6310924426104613e-45, -6.926327264826452e-46,
      1.1086282862095513e-46, 7.430121120801222e-46, 1.1883750426840102e-45,
      1.449440512874052e-45, 1.5428018169826436e-45, 1.494987891537604e-45,
      1.3383504296762545e-45, 1.1073215645365643e-45, 8.352637767405647e-46,
      5.52041895627722e-46, 2.823635541476148e-46, 4.486416820481085e-47,
      -1.4814166064848675e-46, -2.903574418863182e-46, -3.807863214032464e-46,
      -4.2273790061671755e-46, -4.226946487462935e-46, -3.891561660253633e-46,
      -3.315573859158621e-46, -2.5933150375074567e-46, -1.8116262646311573e-46,
      -1.0444899714614147e-46, -3.4976738408147067e-47, 2.3212616495019673e-47,
      6.778951100820472e-47, 9.79746544966984e-47, 1.1428714944447713e-46,
      1.1824066188933523e-46, 1.120222291086012e-46, 9.81826759123249e-47,
      7.93608294379475e-47, 5.805655403309306e-47, 3.646071910603002e-47,
      1.6344058799383269e-47, -9.981818962017703e-49, -1.4752713499091508e-47,
      -2.455515898871504e-47, -3.0428113772404957e-47, -3.2701064495519865e-47,
      -3.1922184380777526e-47, -2.877063994695271e-47, -2.397625646652617e-47,
      -1.8251420925718567e-47, -1.223814422546496e-47, -6.471411686606395e-48,
      -1.3584314391009515e-48, 2.827790848746616e-48, 5.942940045071876e-48,
      7.956794394453783e-48, 8.932538212213464e-48, 9.002856293805493e-48,
      8.345355970846088e-48, 7.159400958568833e-48, 5.645907583746686e-48,
      3.9911054684410605e-48, 2.3547477762989937e-48, 8.628052988988317e-49,
      -3.956836771260683e-49, -1.3681988092574123e-48, -2.0355124937920063e-48,
      -2.4064782897403375e-48, -2.511647928311374e-48, -2.3964598363497064e-48,
      -2.1146257597801875e-48, -1.7221996035701262e-48, -1.2726605864054202e-48,
      -8.131952224553929e-49, -3.8223029058567145e-49, -8.159241743701809e-51,
      2.9087845700115966e-49, 5.063605765146325e-49, 6.38111913063133e-49,
      6.926294494581454e-49, 6.81217504231407e-49, 6.181191244427817e-49,
      5.187925932154533e-49, 3.984403020746492e-49, 2.708555367454617e-49,
      1.4761426488233228e-49, 3.7606187970983375e-50, -5.31264105675903e-50,
      -1.2129151941155481e-49, -1.6605191303322671e-49, -1.8859487330821066e-49,
      -1.916284945504389e-49, -1.7885934952285097e-49, -1.5449668905163784e-49,
      -1.2281710565600634e-49, -8.781193443402788e-50, -5.292860025050292e-50,
      -2.0907406066544886e-50, 6.292610114098726e-51, 2.7490892783598375e-50,
      4.222144466237572e-50, 5.062519733131705e-50, 5.331604995854255e-50,
      5.123652160440507e-50, 4.55165598398878e-50, 3.734605834067955e-50,
      2.7868414547979914e-50, 1.8099307603951682e-50, 8.872032021420598e-51,
      8.083474811995423e-52, -5.688007002800137e-51, -1.041920579987004e-50,
      -1.3367357579344618e-50, -1.465952007312796e-50, -1.4528303790913756e-50,
      -1.3272079769543374e-50, -1.1218025513300422e-50, -8.69036400135918e-51,
      -5.985262595222981e-51, -3.353034034497494e-51, -9.87573000884973e-52,
      9.775983234550377e-52, 2.4676993596373717e-51, 3.4607341633619674e-51,
      3.9785557781788613e-51, 4.076262805886447e-51, 3.8311060690857716e-51,
      3.3318837709634924e-51, 2.6695668919588858e-51, 1.929648986050742e-51,
      1.1864778821871332e-51, 4.99617607782029e-52, -8.788184520298515e-53,
      -5.495557529398161e-52, -8.742668854227143e-52, -1.063987297598751e-51
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.6223034126127684, -0.17522667317789198, -0.1752123153165493, -0.1613130352917863,
      -0.1374396535779438, -0.10750234984680068, -0.07510086063765445, -0.04330196120172268,
      -0.014504210071227305, 0.009616977448909287, 0.028095824957804872,
      0.040609174758576554, 0.04737209104234848, 0.04901192308430164, 0.0464351684177726,
      0.04069914546061919, 0.03289767416392777, 0.02406699193138869, 0.015115268288576594,
      0.006776530795947415, -0.000412284584763745, -0.006114018034469014,
      -0.010177592472073543, -0.012612341079357367, -0.013554814171001888,
      -0.013232217930836124, -0.011926064387164266, -0.009938871096851572,
      -0.007565933015083976, -0.005073377815013394, -0.0026829728208080566,
      -0.0005635218491602699, 0.0011717993653136867, 0.0024631594218753033,
      0.0032980213175311615, 0.003702567813339181, 0.0037317925364823107,
      0.003459312166849479, 0.0029677636519280883, 0.0023404292342646357,
      0.0016545047111212637, 0.0009762120531931603, 0.00035777062917852383,
      -0.00016390891773431545, -0.0005670531322129706, -0.000843689097109855,
      -0.000997484337729375, -0.0010411010906204872, -0.0009933728962819492,
      -0.0008765632535667754, -0.0007139070203541891, -0.0005275722323434381,
      -0.0003371188352455602, -0.0001584759627590631, -3.413914750427928e-06,
      0.00012054739697502345, 0.0002098745822759006, 0.00026449430727313103,
      0.0002870990867313855, 0.00028237429581347176, 0.00025622360893638014,
      0.0002150545778710221, 0.00016516880914605467, 0.00011228391505341802,
      6.119847004228373e-05, 1.5597596918227622e-05, -2.2013858838901412e-05,
      -5.027108279750035e-05, -6.882682560384968e-05, -7.817305857347655e-05,
      -7.943219195974226e-05, -7.414056245217574e-05, -6.404291535040385e-05,
      -5.091194695713829e-05, -3.640214072305475e-05, -2.194254437649073e-05,
      -8.669108493989767e-06, 2.6060543120988638e-06, 1.1393522568490217e-05,
      1.750007371698808e-05, 2.098407408771744e-05, 2.209995248527095e-05,
      2.1238367115084252e-05, 1.8867679690422134e-05, 1.5481111187025498e-05,
      1.1552618349877461e-05, 7.503223969374938e-06, 3.678354733780049e-06,
      3.3575592971360656e-07, -2.3571989459794737e-06, -4.318491143915445e-06,
      -5.540689181002778e-06, -6.076447779987955e-06, -6.022177983055495e-06,
      -5.5015527911583735e-06, -4.650188994631405e-06, -3.602481396011094e-06,
      -2.4811975214467157e-06, -1.3900990860598504e-06, -4.09562700076128e-07,
      4.050598594897949e-07, 1.0227660964647636e-06, 1.4344339240018211e-06,
      1.6491179785430851e-06, 1.689654505099898e-06, 1.5880630693482458e-06,
      1.3811506748542814e-06, 1.1066257660797528e-06, 7.999269749607776e-07,
      4.918733704982282e-07, 2.0715625712581704e-07, -3.6378191483481974e-08,
      -2.2775860032609448e-07, -3.623671426060384e-07, -4.410201455873098e-07,
      -4.688039768816005e-07, -4.5380799250574906e-07, -4.0587580277133906e-07,
      -3.35470128260533e-07, -2.527182396903648e-07, -1.666771080430639e-07,
      -8.483206063711251e-08, -1.28214394001546e-08, 4.5636637856372485e-08,
      8.865049646066529e-08, 1.1593532809139746e-07, 1.2851067280048513e-07,
      1.2835571850617302e-07, 1.1805827404619117e-07, 1.004865191180636e-07,
      7.850494104161964e-08, 5.474803436067634e-08, 3.145801422586594e-08,
      1.038645592853369e-08, -7.245276284257274e-09, -2.0735568525036773e-08,
      -2.985301603828638e-08, -3.4759634777216995e-08, -3.591842476242296e-08,
      -3.399577787846042e-08, -2.976750859028727e-08, -2.4035222882553497e-08,
      -1.7557562683192903e-08, -1.0998766004805459e-08, -4.8951168491020576e-09,
      3.616752116731472e-10, 4.526273517290985e-09, 7.489547008861046e-09,
      9.259663870879324e-09, 9.937712735553935e-09, 9.690890936801453e-09,
      8.725877210873738e-09, 7.264462082909735e-09, 5.52291078129088e-09,
      3.69593928869463e-09, 1.9456403282607042e-09, 3.9523559806156905e-10,
      -8.72826951452526e-10, -1.8151590479253345e-09, -2.4229688277466404e-09,
      -2.7157583418780766e-09, -2.7340534927179345e-09, -2.5319384013394392e-09,
      -2.1700255190228434e-09, -1.7093305345771915e-09, -1.2063545162410418e-09,
      -7.095188502863136e-10, -2.569618625725401e-10, 1.2440371938729805e-10,
      4.1875284218843583e-10, 6.20359265779694e-10, 7.320063030838056e-10,
      7.630445989697949e-10, 7.27322303676123e-10, 6.411775175115825e-10,
      5.216395329874406e-10, 3.849392062595664e-10, 2.453839886753252e-10,
      1.1461301052537068e-10, 1.2143710324001843e-12, -8.933831038688287e-11,
      -1.544896437100758e-10, -1.9421461507155524e-10, -2.105086371206764e-10,
      -2.068206249345304e-10, -1.8748556027080274e-10, -1.5720162424995689e-10,
      -1.2058432557029838e-10, -8.181738799435017e-11, -4.440849293467647e-11,
      -1.1048023948468935e-11, 1.6438829346610548e-11, 3.706169953933592e-11,
      5.0574643955163274e-11, 5.7345030700000897e-11, 5.820033822702822e-11,
      5.426947994820806e-11, 4.6832338617539674e-11, 3.718777586166789e-11,
      2.6546841004217122e-11, 1.5954545568746545e-11, 6.240624579028197e-12,
      -2.0026769992429443e-12, -8.419499549015088e-12, -1.2870751015650754e-11,
      -1.5401276473211006e-11, -1.619909038981425e-11, -1.5551508791504615e-11,
      -1.3802285610346822e-11, -1.1312947550599277e-11, -8.430542759601528e-12,
      -5.463062028521599e-12, -2.662928442937486e-12, -2.1823177448723424e-13,
      1.749164474361379e-12, 3.1798837702060495e-12, 4.069100868933395e-12,
      4.455887750169733e-12, 4.411235606950928e-12, 4.025970155314513e-12,
      3.399539713731609e-12, 2.6303881669501863e-12, 1.8083552351190913e-12,
      1.0092962708248596e-12, 2.918989911060424e-13, -3.0349501292848897e-13,
      -7.543761743687913e-13, -1.054243442105698e-12, -1.2098808144596353e-12,
      -1.238131859269209e-12, -1.1625294458833555e-12, -1.0100771188564387e-12,
      -8.08406551484397e-13, -5.834603010248209e-13, -3.5777726076325943e-13,
      -1.493947744404251e-13, 2.867032528851216e-14, 1.6843774483947133e-13,
      2.6657730456117883e-13, 3.237321118157621e-13, 3.436637320582905e-13,
      3.3232312651211274e-13, 2.969360150744921e-13, 2.4517224275651174e-13,
      1.8444799288770747e-13, 1.213892787991935e-13, 6.146661015380239e-14,
      8.79516016143488e-15, -3.391721026809315e-14, -6.529986531413877e-14,
      -8.515749444002961e-14, -9.424780767124472e-14, -9.402866726520409e-14,
      -8.640088230396835e-14, -7.34679304972196e-14, -5.732822770593357e-14,
      -3.9909825613147936e-14, -2.285205603691515e-14, -7.434005097991549e-15,
      5.45398778498555e-15, 1.5302251557431684e-14, 2.1945166698992426e-14,
      2.55046860127618e-14, 2.6322488188387786e-14, 2.4888441597849024e-14,
      2.177179498132254e-14, 1.7559997355320806e-14, 1.2808452947496967e-14,
      8.002981408319715e-15, 3.5353883457487548e-15, -3.085698792758212e-16,
      -3.3503806932057387e-15, -5.5112277292415866e-15, -6.798068028061697e-15,
      -7.285727381125544e-15, -7.0972385789392065e-15, -6.384336496874223e-15,
      -5.3096243030277654e-15, -4.031486252697858e-15, -2.692387249471629e-15,
      -1.4108013903311363e-15, -2.7667506443240165e-16, 6.499308789267954e-16,
      1.3375554399705432e-15, 1.7800449866712317e-15, 1.991920956441014e-15,
      2.0030459750315028e-15, 1.853153111761442e-15, 1.5866995874128739e-15,
      1.2483872030135655e-15, 8.795696656333795e-16, 5.156521444709449e-16,
      1.844884330381367e-16, -9.429906745471297e-17, -3.092093437611574e-16,
      -4.561312974234455e-16, -5.37174513692369e-16, -5.592435139890463e-16,
      -5.325203977700384e-16, -4.689946780927998e-16, -3.811472923206668e-16,
      -2.808619051274816e-16, -1.786038124502871e-16, -8.28773891930621e-17,
      5.12685762832284e-20, 6.619817551283503e-17, 1.1371553445277596e-16,
      1.4260601579055788e-16, 1.5434816901305629e-16, 1.5148063661068974e-16,
      1.371864616397733e-16, 1.149104189552355e-16, 8.803302035550443e-17,
      5.96155669539761e-17, 3.22220827531159e-17, 7.816689275071317e-18,
      -1.2270707207516372e-17, -2.732151675644903e-17, -3.716174496702649e-17,
      -4.206560457389135e-17, -4.264310167266012e-17, -3.972374896439433e-17,
      -3.424640680248324e-17, -2.716274380965034e-17, -1.93592136120971e-17,
      -1.1599985954158246e-17, -4.491116256441354e-18, 1.535503209193359e-18,
      6.2211405642731535e-18, 9.465699254714525e-18, 1.1303557729439019e-17,
      1.1873638235732463e-17, 1.1387244698404498e-17, 1.0096670291175388e-17,
      8.266907233503521e-18, 6.152073549071248e-18, 3.97747095745014e-18,
      1.9275567804743612e-18, 1.3958675211310716e-19, -1.2977146863510313e-18,
      -2.3413683438668447e-18, -2.9882919957461714e-18, -3.2674729464886407e-18,
      -3.2311822760783706e-18, -2.946121035133663e-18, -2.4852139344382607e-18,
      -1.9205699867502094e-18, -1.3179319688520432e-18, -7.327534450518492e-19,
      -2.0788501880300588e-19, 2.272723637892893e-19, 5.563767531733008e-19,
      7.747984787325354e-19, 8.8761754337336e-19, 9.072565582724092e-19,
      8.510105737010911e-19, 7.386904580090134e-19, 5.905436447952327e-19,
      4.255609401027127e-19, 2.6022549129788656e-19, 1.0771362211182991e-19,
      -2.2480541237279068e-20, -1.245526388067766e-19, -1.9610165303977376e-19,
      -2.376316740335231e-19, -2.519241979177982e-19, -2.4335690481696155e-19,
      -2.172337399613689e-19, -1.7917711083323614e-19, -1.346178095443575e-19,
      -8.840331939859494e-20, -4.453160151449644e-20, -6.0060758766258814e-21,
      2.520122798502579e-20, 4.809731421214742e-20, 6.254885538614547e-20,
      6.911883687002336e-20, 6.888105866886589e-20, 6.323167766925674e-20,
      5.371332673117308e-20, 4.1863206971665264e-20, 2.909234374913932e-20,
      1.6599271987734017e-20, 5.318026826863887e-21, -4.102378466701991e-21,
      -1.1291731021416768e-20, -1.6131557066802293e-20, -1.8713581979213807e-20,
      -1.9289933488445898e-20, -1.8220705560802937e-20, -1.5923573168525012e-20,
      -1.2829036697926554e-20, -9.343704493175516e-21, -5.822897632772857e-21,
      -2.5528623373652553e-21, 2.5794386103090747e-22, 2.4796372607430724e-21,
      4.055306300934402e-21, 4.990759196623792e-21, 5.3413744299202045e-21,
      5.1976824997724476e-21, 4.671078446862669e-21, 3.8807711618643234e-21,
      2.9427536925849067e-21, 1.9612599170544425e-21, 1.022881722575926e-21,
      1.932747203900542e-22, -4.838100884363546e-22, -9.855625171210341e-22,
      -1.3076845587982798e-21, -1.4609857725153547e-21, -1.4674700040272049e-21,
      -1.3563265294925277e-21, -1.1601627120884663e-21, -9.117279202913988e-22,
      -6.412889899281469e-22, -3.747334414605787e-22, -1.3240356131490546e-22,
      7.139410325634769e-23, 2.2830160303720893e-22, 3.353685728277939e-22,
      3.9419205201175445e-22, 4.0986989183952514e-22, 3.8988841949498303e-22,
      3.4304582667823228e-22, 2.7848939039569967e-22, 2.0491980864918118e-22,
      1.2999190784061262e-22, 5.991949464371887e-23, -7.256285198575256e-25,
      -4.904383594719677e-23, -8.36992052992945e-23, -1.047090464205616e-22,
      -1.1316875053791326e-22, -1.1094685471381072e-22, -1.0038051750509326e-22,
      -8.399546010093218e-23, -6.426762147643371e-23, -4.3436980094148265e-23,
      -2.3377745115623692e-23, -5.52380175622533e-24, 9.155858529163683e-24,
      2.0139888222564966e-23, 2.7305342279384704e-23, 3.085682042282503e-23,
      3.1243982863406546e-23, 2.90763296096166e-23, 2.504255181991943e-23,
      1.9839922646376898e-23, 1.411729311584163e-23, 8.433458858282243e-24,
      3.231087905448863e-24, -1.174872116605704e-24, -4.5963179165543566e-24,
      -6.96123766574965e-24, -8.295931850477198e-24, -8.70303859329219e-24,
      -8.337954036645581e-24, -7.385841478832185e-24, -6.040932470350334e-24,
      -4.489296827408539e-24, -2.895745447407278e-24, -1.3950679199078914e-24,
      -8.742247211013877e-26, 9.625964234561147e-25, 1.7238829201111553e-24,
      2.1945100934534116e-24, 2.3959793497481e-24, 2.366776267382723e-24,
      2.15588397253443e-24, 1.8167767888158275e-24, 1.4022730748398976e-24,
      9.604814021009042e-25, 5.319401918281157e-25, 1.4793607703624347e-25,
      -1.7010419225901072e-25, -4.103172949077717e-25, -5.694088369235054e-25,
      -6.51180854537479e-25, -6.647947417782901e-25, -6.229608153920596e-25,
      -5.402128596872815e-25, -4.313872231039789e-25, -3.103856338210831e-25,
      -1.892623966252319e-25, -7.764269531604424e-26, 1.7548879864344614e-26,
      9.209082517366683e-26, 1.442524576208902e-25, 1.7442716415591719e-25,
      1.8467149011110236e-25, 1.7820565016122912e-25, 1.5892285751727855e-25,
      1.3094457926072136e-25, 9.824767801311128e-26, 6.437845009093658e-26,
      3.2258645858759166e-26, 4.0802383082015085e-27, -1.872067426653089e-26,
      -3.5424772939943624e-26, -4.594151841298752e-26, -5.0689116049479017e-26,
      -5.045844120060865e-26, -4.627495555336763e-26, -3.926996585167119e-26,
      -3.0569539291090396e-26, -2.1206308264525422e-26, -1.2056524213444094e-26,
      -3.802241610247483e-27, 3.0834547181396283e-27, 8.331670007900589e-27,
      1.1857702270003208e-26, 1.373049110365777e-26, 1.4136069394417214e-26,
      1.3339128124026412e-26, 1.1646122519867719e-26, 9.372532019970935e-27,
      6.816028743996313e-27, 4.2364858359165534e-27, 1.8430264674342253e-27,
      -2.122843942198867e-28, -1.834949374595346e-27, -2.98388205227591e-27,
      -3.6638577642806184e-27, -3.9158565910125126e-27, -3.806490406341315e-27,
      -3.417537342027922e-27, -2.836391463136369e-27, -2.1479994797082144e-27,
      -1.4286227645830548e-27, -7.415498313142343e-28, -1.347045066237754e-28,
      3.6004414642852027e-28, 7.2615974630538985e-28, 9.606472866971897e-28,
      1.071550909881027e-27, 1.0750829229835842e-27, 9.92686224476881e-28,
      8.482764534359116e-28, 6.658460961020486e-28, 4.67547225801055e-28,
      2.7230800914141986e-28, 9.498464938189439e-29, -5.399234046279472e-29,
      -1.6854950755368021e-28, -2.465703610366865e-28, -2.8926257952717947e-28,
      -3.003897586905848e-28, -2.854559983240163e-28, -2.5091750215099486e-28,
      -2.034782161050861e-28, -1.4950833259522243e-28, -9.460689416510919e-29,
      -4.3314012399243215e-29, 1.0347569404415328e-30, 3.6329100202232604e-29,
      6.160333081394114e-29, 7.688135745729682e-29, 8.297457932342819e-29,
      8.125825139072514e-29, 7.344840148100867e-29, 6.139686965042251e-29,
      4.691704926163238e-29, 3.1647930594420444e-29, 1.695947411833763e-29,
      3.89845221275089e-30, -6.829135288345477e-30, -1.4845077355429512e-29,
      -2.0062613350383202e-29, -2.2634345221005468e-29, -2.2891715264592318e-29,
      -2.1282553034786432e-29, -1.8312032242388105e-29, -1.4491027682343698e-29,
      -1.0294468429783176e-29, -6.130965957115333e-30, -2.323843451737602e-30,
      8.972366259160151e-31, 3.3955273002960386e-30, 5.119237866214369e-30,
      6.088451064606116e-30, 6.378990212075258e-30, 6.105132090677312e-30,
      5.4027693431940814e-30, 4.41426602881825e-30, 3.275864179769915e-30,
      2.1081234460158296e-30, 1.0095379707385095e-30, 5.31936406695026e-32,
      -7.138844454085456e-31, -1.2691868391885646e-30, -1.611544029144947e-30,
      -1.756901756278978e-30, -1.733594441978293e-30, -1.5775929088563891e-30,
      -1.3281082746571841e-30, -1.0238284080607001e-30, -6.999572790421419e-31,
      -3.8612943592763898e-31, -1.051878626313831e-31, 1.2725258791967313e-31,
      3.0258051428042035e-31, 4.184536294461949e-31, 4.777160831353758e-31,
      4.871237339563915e-31, 4.560172645794961e-31, 3.9505886470989125e-31,
      3.1511975526547815e-31, 2.2637621436611643e-31, 1.376435737052368e-31,
      5.595282973931489e-32, -1.3645655848123318e-32, -6.80817506479971e-32,
      -1.0610826945515053e-31, -1.2803102068831335e-31, -1.3537037369338978e-31,
      -1.3049502640164862e-31, -1.1626262623801606e-31, -9.569434317620056e-32,
      -7.17023201881891e-32, -4.688090626690517e-32, -2.3365315334413845e-32,
      -2.7552728847186315e-33, 1.390344562888217e-32, 2.6089833693265124e-32,
      3.374278172046871e-32, 3.7172876855732596e-32, 3.696258524021982e-32,
      3.386507896675842e-32, 2.8710001190681894e-32, 2.2322235030566012e-32,
      1.545748400911842e-32, 8.756368890060658e-33, 2.716933187165977e-33,
      -2.3159877080346007e-33, -6.147102904750336e-33, -8.715890273035168e-33,
      -1.0074127897693975e-32, -1.035907001476148e-32, -9.765274767435234e-33,
      -8.517589550491212e-33, -6.847201004523485e-33, -4.972027981921354e-33,
      -3.0821329468683156e-33, -1.3302928403238307e-33, 1.7256704557308037e-34,
      1.357698117891875e-33, 2.195444725561162e-33, 2.6896856736097697e-33,
      2.87074226435969e-33, 2.7876252385690843e-33, 2.500368896307806e-33,
      2.073042379228764e-33, 1.5678550601905892e-33, 1.0406019098242832e-33,
      5.375387562140819e-34, 9.364582509972828e-35, -2.6786367221990606e-34,
      -5.3500284402147466e-34, -7.056899837626226e-34, -7.859096074269257e-34,
      -7.876061882972272e-34, -7.265316169777057e-34, -6.2022636517472015e-34,
      -4.86267321706273e-34, -3.408672305327448e-34, -1.9786560907812616e-34,
      -6.81119273081619e-35, 4.07894215724305e-35, 1.2442534022060826e-34,
      1.8127817572643723e-34, 2.1226022211018864e-34, 2.201497952984328e-34,
      2.0899349221723174e-34, 1.8352885409902817e-34, 1.4866906728077174e-34,
      1.090779944782711e-34, 6.885094558404598e-35, 3.130509834337146e-35,
      -1.1260030205954102e-36, -2.690656539308004e-35, -4.533864984972526e-35,
      -5.644798205742464e-35, -6.083550519461677e-35, -5.951337252138565e-35,
      -5.37415273829149e-35, -4.4877704934098203e-35, -3.425002946409281e-35,
      -2.3057734197415346e-35, -1.2302183212195948e-35, -2.7475323107726165e-36,
      5.091849421945896e-36, 1.0941614449969803e-35, 1.4740622463581094e-35,
      1.6602651576739434e-35, 1.677199138010328e-35, 1.5577675461309195e-35,
      1.3390256309043168e-35, 1.05840343834429e-35, 7.506631726185069e-36,
      4.456835884152916e-36, 1.670797094303299e-36, -6.840172074366683e-37,
      -2.5082007911480172e-36, -3.764518070743782e-36, -4.468277466916441e-36,
      -4.675487592766125e-36, -4.470183604138777e-36, -3.9520961521143624e-36,
      -3.2255710181256534e-36, -2.390364661485088e-36, -1.534665725759176e-36,
      -7.304452950509936e-37, -3.103331175990506e-38, 5.2933712936088826e-37,
      9.343796206160842e-37, 1.1834144696696565e-36, 1.2882651058417502e-36,
      1.269791356036912e-36, 1.1544078393382317e-36, 9.708664529373084e-37,
      7.4750454916466415e-37, 5.100827047852895e-37, 2.802641839345181e-37,
      7.472679273000481e-38, -9.515041964501529e-38, -2.2311708031872443e-37,
      -3.0750930843259515e-37, -3.5045368428548447e-37, -3.569318244841034e-37,
      -3.3380790899178857e-37, -2.889037364263374e-37, -2.3018500569366118e-37,
      -1.6510081886816462e-37, -1.0009775929038237e-37, -4.031174130133742e-38,
      1.0573909335654002e-38, 5.032652628880245e-38, 7.804758040950426e-38,
      9.397398413694553e-38, 9.922959661093388e-38, 9.555670103436865e-38,
      8.505279006258402e-38, 6.99324484671161e-38, 5.232812938418892e-38,
      3.4137746445470677e-38, 1.6921690531218972e-38, 1.8474345631492794e-39,
      -1.0323510641473898e-38, -1.9213823780942924e-38, -2.478255344031335e-38,
      -2.7260311441897484e-38, -2.7076052658726884e-38, -2.4782947113721883e-38,
      -2.0989403596993887e-38, -1.629966983787581e-38, -1.1266779953297877e-38,
      -6.359080656114655e-39, -1.9402422685689472e-39, 1.738389249529572e-39,
      4.5349898266715836e-39, 6.406340770556477e-39, 7.391305086242806e-39,
      7.591140749126228e-39, 7.148851289338885e-39, 6.229405185101146e-39,
      5.002216159398198e-39, 3.626815627553487e-39, 2.2422071192222594e-39,
      9.600015560498671e-40, -1.3888742027526647e-40, -1.0044463824208185e-39,
      -1.6152747562283327e-39, -1.974492290131495e-39, -2.104530953119964e-39,
      -2.0414497667569482e-39, -1.829319711308786e-39, -1.5151095972903148e-39,
      -1.1443769101365313e-39, -7.579423260181537e-40, -3.896124750059846e-40,
      -6.491937600358125e-41, 1.992292282269231e-40, 3.9414520899033925e-40,
      5.183857486596511e-40, 5.764018695196095e-40, 5.769932225698939e-40,
      5.317308105863802e-40, 4.534791522726347e-40, 3.5511490658354377e-40,
      2.4850377592321336e-40, 1.437645281676957e-40, 4.882038486141033e-41,
      -3.078480456729289e-41, -9.184460212238369e-41, -1.3327123993474435e-40,
      -1.557532017135256e-40, -1.6134128974864131e-40, -1.530104553971217e-40,
      -1.3423702702019056e-40, -1.0862173035773504e-40, -7.957911733503329e-41,
      -5.010458465621809e-41, -2.2621751399086412e-41, 1.0939649102206244e-42,
      1.99249322379217e-41, 3.33668110601924e-41, 4.144445165500003e-41,
      4.460286151836089e-41, 4.35869288185263e-41, 3.932171016846297e-41,
      3.2802657278730455e-41, 2.5002472657110844e-41, 1.6798612936705417e-41,
      8.92300880620937e-42, 1.933492138475468e-42, -3.7951966009641063e-42,
      -8.064069265626153e-42, -1.0830105116098551e-41, -1.217810626599293e-41,
      -1.2288115581853878e-41, -1.1401877367874165e-41, -9.791192915749347e-42,
      -7.73029578980073e-42, -5.4736232093549e-42, -3.2396537220628176e-42,
      -1.200864940310984e-42, 5.2063085964564506e-43, 1.8525760561258433e-42,
      2.7682086969884717e-42, 3.279179285079572e-42, 3.4268559216110594e-42,
      3.2730330454561424e-42, 2.890900881456302e-42, 2.3569386397110534e-42,
      1.7441871455462798e-42, 1.1171550515495282e-42, 5.2843188213114226e-43,
      1.693105301932534e-44, -3.924276389356162e-43, -6.8786211490027825e-43,
      -8.690039415942619e-43, -9.446183859994715e-43, -9.300617734460842e-43,
      -8.447308335031189e-43, -7.097078267654151e-43, -5.457484971378009e-43,
      -3.717029716068511e-43, -2.034071798359665e-43, -5.30374697425534e-44,
      7.111413729546153e-44, 1.6451133927513292e-43, 2.25973276514061e-43,
      2.570892746193242e-43, 2.6153242078824917e-43, 2.443468488426559e-43,
      2.112705439238764e-43, 1.6814015712672485e-43, 1.2040841434230963e-43,
      7.278959139439418e-44, 2.9035246424669566e-44, -8.168367340604288e-45,
      -3.7197694817154336e-44, -5.740556719744881e-44, -6.897496108899699e-44,
      -7.27365446406525e-44, -6.997179889535444e-44, -6.222023787527785e-44,
      -5.110517845047147e-44, -3.818811707323588e-44, -2.485746830321379e-44,
      -1.225353212883631e-44, -1.2283077705201111e-45, 7.663710717772005e-45,
      1.414929555525388e-44, 1.820123774235938e-44, 1.999073050575593e-44,
      1.983366034741731e-44, 1.8136295403427053e-44, 1.5344797940933289e-44,
      1.1901789097101006e-44, 8.211981890242761e-45, 4.6177718836807314e-45,
      1.3847056762201074e-45, -1.3040194015490843e-45, -3.3454155611558425e-45,
      -4.7086400915333504e-45, -5.4228440298801925e-45, -5.562723949822474e-45,
      -5.233386766434938e-45, -4.5558662035606974e-45, -3.654307088599453e-45,
      -2.6454958580212526e-45, -1.6310924426104613e-45, -6.926327264826452e-46,
      1.1086282862095513e-46, 7.430121120801222e-46, 1.1883750426840102e-45,
      1.449440512874052e-45, 1.5428018169826436e-45, 1.494987891537604e-45,
      1.3383504296762545e-45, 1.1073215645365643e-45, 8.352637767405647e-46,
      5.52041895627722e-46, 2.823635541476148e-46, 4.486416820481085e-47,
      -1.4814166064848675e-46, -2.903574418863182e-46, -3.807863214032464e-46,
      -4.2273790061671755e-46, -4.226946487462935e-46, -3.891561660253633e-46,
      -3.315573859158621e-46, -2.5933150375074567e-46, -1.8116262646311573e-46,
      -1.0444899714614147e-46, -3.4976738408147067e-47, 2.3212616495019673e-47,
      6.778951100820472e-47, 9.79746544966984e-47, 1.1428714944447713e-46,
      1.1824066188933523e-46, 1.120222291086012e-46, 9.81826759123249e-47,
      7.93608294379475e-47, 5.805655403309306e-47, 3.646071910603002e-47,
      1.6344058799383269e-47, -9.981818962017703e-49, -1.4752713499091508e-47,
      -2.455515898871504e-47, -3.0428113772404957e-47, -3.2701064495519865e-47,
      -3.1922184380777526e-47, -2.877063994695271e-47, -2.397625646652617e-47,
      -1.8251420925718567e-47, -1.223814422546496e-47, -6.471411686606395e-48,
      -1.3584314391009515e-48, 2.827790848746616e-48, 5.942940045071876e-48,
      7.956794394453783e-48, 8.932538212213464e-48, 9.002856293805493e-48,
      8.345355970846088e-48, 7.159400958568833e-48, 5.645907583746686e-48,
      3.9911054684410605e-48, 2.3547477762989937e-48, 8.628052988988317e-49,
      -3.956836771260683e-49, -1.3681988092574123e-48, -2.0355124937920063e-48,
      -2.4064782897403375e-48, -2.511647928311374e-48, -2.3964598363497064e-48,
      -2.1146257597801875e-48, -1.7221996035701262e-48, -1.2726605864054202e-48,
      -8.131952224553929e-49, -3.8223029058567145e-49, -8.159241743701809e-51,
      2.9087845700115966e-49, 5.063605765146325e-49, 6.38111913063133e-49,
      6.926294494581454e-49, 6.81217504231407e-49, 6.181191244427817e-49,
      5.187925932154533e-49, 3.984403020746492e-49, 2.708555367454617e-49,
      1.4761426488233228e-49, 3.7606187970983375e-50, -5.31264105675903e-50,
      -1.2129151941155481e-49, -1.6605191303322671e-49, -1.8859487330821066e-49,
      -1.916284945504389e-49, -1.7885934952285097e-49, -1.5449668905163784e-49,
      -1.2281710565600634e-49, -8.781193443402788e-50, -5.292860025050292e-50,
      -2.0907406066544886e-50, 6.292610114098726e-51, 2.7490892783598375e-50,
      4.222144466237572e-50, 5.062519733131705e-50, 5.331604995854255e-50,
      5.123652160440507e-50, 4.55165598398878e-50, 3.734605834067955e-50,
      2.7868414547979914e-50, 1.8099307603951682e-50, 8.872032021420598e-51,
      8.083474811995423e-52, -5.688007002800137e-51, -1.041920579987004e-50,
      -1.3367357579344618e-50, -1.465952007312796e-50, -1.4528303790913756e-50,
      -1.3272079769543374e-50, -1.1218025513300422e-50, -8.69036400135918e-51,
      -5.985262595222981e-51, -3.353034034497494e-51, -9.87573000884973e-52,
      9.775983234550377e-52, 2.4676993596373717e-51, 3.4607341633619674e-51,
      3.9785557781788613e-51, 4.076262805886447e-51, 3.8311060690857716e-51,
      3.3318837709634924e-51, 2.6695668919588858e-51, 1.929648986050742e-51,
      1.1864778821871332e-51, 4.99617607782029e-52, -8.788184520298515e-53,
      -5.495557529398161e-52, -8.742668854227143e-52, -1.063987297598751e-51
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_3_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<3>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.6604677182208086), "design.b()[0] == 0.6604677182208086");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.6604677182208086));
    static_assert(almost_equal(design.b()[1], -1.9814031546624258), "design.b()[1] == -1.9814031546624258");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -1.9814031546624258));
    static_assert(almost_equal(design.b()[2], 1.9814031546624258), "design.b()[2] == 1.9814031546624258");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 1.9814031546624258));
    static_assert(almost_equal(design.b()[3], -0.6604677182208086), "design.b()[3] == -0.6604677182208086");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.6604677182208086));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.2494386556009194), "design.a()[1] == -2.2494386556009194");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.2494386556009194));
    static_assert(almost_equal(design.a()[2], 1.6631254973536018), "design.a()[2] == 1.6631254973536018");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 1.6631254973536018));
    static_assert(almost_equal(design.a()[3], -0.3711775928119479), "design.a()[3] == -0.3711775928119479");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.3711775928119479));
    std::cout << "max_deviation(cheby1,highpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.6604677182208086, -0.4957215385200031, -0.2321327388504102, -0.11303812614226216,
      -0.052207181121345175, -0.015602732773383227, 0.009772484276949003,
      0.028553770781511337, 0.04218570319350614, 0.05103297443456861, 0.0552339467028863,
      0.05502952158939273, 0.0508668445860221, 0.04340244941643366, 0.033458926621296986,
      0.021960715572168478, 0.00986290523126479, -0.0019182218831035255,
      -0.012566846079466001, -0.021417216204893338, -0.027988472871621012,
      -0.032003366112983586, -0.033390856734776674, -0.0322737636861645,
      -0.028943598778996035, -0.023825468468395332, -0.017436390562100605,
      -0.010340562170464182, -0.0031050345749574007, 0.0037410703266130656,
      0.009741185403025958, 0.014537810290228294, 0.0178897000947836, 0.019679289709975473,
      0.019910648049028187, 0.018698908710389914, 0.01625265301432892, 0.012851100511727644,
      0.008818176553654512, 0.004495574904262447, 0.00021682625517627924,
      -0.0037158583424229006, -0.007050547996392662, -0.009599355404962888,
      -0.011246458328429878, -0.01195029080372831, -0.011740240110402629,
      -0.010708549923911743, -0.008998413645545916, -0.006789431138449703,
      -0.00428169146599146, -0.0016797357721554818, 0.0008224429652772757,
      0.0030543784581003007, 0.00487933082634502, 0.0062012130820882135,
      0.006968025754763863, 0.007171849165300857, 0.006845684789926044,
      0.006057637806837806, 0.004903081432545545, 0.003495533817116085,
      0.0019570085633823404, 0.00040857325719994685, -0.0010382265340802676,
      -0.0022885377729481363, -0.0032695710723196136, -0.00393394046117682,
      -0.004260904668041247, -0.004255598502219401, -0.00394647912904245,
      -0.003381320668734193, -0.0026221661629766404, -0.0017396859327083961,
      -0.0008073958480411389, 0.00010383927679268132, 0.0009306482677702422,
      0.0016210511921074806, 0.0021372131638371077, 0.002456954119670496,
      0.00257401174507888, 0.0024971441145783023, 0.0022482342519991334,
      0.0018596164691792702, 0.0013708814031941812, 0.0008254322331331066,
      0.0002670593218718892, -0.00026322337203571477, -0.0007298760463021231,
      -0.0011049114545867728, -0.0013692576920550877, -0.0015133684034638198,
      -0.0015371003807960679, -0.001448929209487827, -0.0012646149787926913,
      -0.001005459924842826, -0.0006963170621662488, -0.0003635132222800921,
      -3.284222825988934e-05, 0.0002722342398465688, 0.0005320670068966937,
      0.000731902087913713, 0.0008625218930248623, 0.0009204364143311455,
      0.0009076487532696893, 0.0008310477219465413, 0.0007015024587995011,
      0.0005327489712931787, 0.00034016579701677606, 0.00013953568928510576,
      -5.4116956294730464e-05, -0.00022753621436005675, -0.00037003294501747043,
      -0.0004740321322624099, -0.0005353513209123032, -0.0005532129676493395,
      -0.0005300123081276193, -0.00047087799648718755, -0.0003830744414563522,
      -0.0002753019471755429, -0.00015695333221254668, -3.738385383308593e-05,
      7.475448874075863e-05, 0.0001720721171178245, 0.00024886352665373613,
      0.00030137290264449734, 0.0003278978946418683, 0.0003287378054600737,
      0.00030600304659418267, 0.00026331120675716143, 0.00020540104517077014,
      0.00013769894343913076, 6.587283068533087e-05, -4.593466587287498e-06,
      -6.877674324180113e-05, -0.00012261903472639697, -0.00016314463318617886,
      -0.0001885813872264029, -0.00019838570108825018, -0.00019317758355008992,
      -0.0001745979914027435, -0.00014510523331054534, -0.00010773014009745442,
      -6.581099034897692e-05, -2.272885402943993e-05, 1.8337759129475383e-05,
      5.46230359266267e-05, 8.393673240105092e-05, 0.0001047721319865634,
      0.0001163560108868891, 0.00011864193886266199, 0.0001122521827213226,
      9.837670944115665e-05, 7.86401350839158e-05, 5.49488408924913e-05,
      2.9330863209771504e-05, 3.7806152067286264e-06, -1.988086598531201e-05,
      -4.012146679887592e-05, -5.578312355537625e-05, -6.613301201063404e-05,
      -7.088000798755877e-05, -7.015817690565522e-05, -6.448125880484337e-05,
      -5.4673854001095694e-05, -4.17861982408701e-05, -2.700000739047184e-05,
      -1.1532878111653165e-05, 3.451798409334026e-06, 1.6923434669559224e-05,
      2.804670824927824e-05, 3.622478422099451e-05, 4.11218340540523e-05,
      4.26649904905892e-05, 4.102733634441995e-05, 3.65947461564264e-05,
      2.9920315900903328e-05, 2.1670687717155265e-05, 1.2568792168665e-05,
      3.337404503091069e-06, -5.35251832658227e-06, -1.292543013098125e-05,
      -1.8934282703209575e-05, -2.3081629881520706e-05, -2.5228252194033458e-05,
      -2.538973999746992e-05, -2.3722296946000823e-05, -2.049968970924117e-05,
      -1.608374012748613e-05, -1.089101520251753e-05, -5.358417776116756e-06,
      8.976905298322943e-08, 5.0711504006409374e-06, 9.269019927258349e-06,
      1.24494524526846e-05, 1.447103361012968e-05, 1.528715309130046e-05,
      1.4941325920807007e-05, 1.3556465425014278e-05, 1.1319385942556682e-05,
      8.462046383222781e-06, 5.2411510679525245e-06, 1.917705138637405e-06,
      -1.262009900910722e-06, -4.082800330367169e-06, -6.373318865028264e-06,
      -8.014610286552696e-06, -8.944189079512682e-06, -9.155735094085352e-06,
      -8.694799283276833e-06, -7.651163700693978e-06, -6.148684718928569e-06,
      -4.333558320759844e-06, -2.3619797964133804e-06, -3.881313132076062e-07,
      1.4466714984609998e-06, 3.022995898808012e-06, 4.249981928585217e-06,
      5.069424122450368e-06, 5.457173614753464e-06, 5.421986826151769e-06,
      5.002118817436872e-06, 4.2600954568439876e-06, 3.276192069492322e-06,
      2.1411941304672916e-06, 9.49018258039047e-07, -2.102671127161931e-07,
      -1.256556150654318e-06, -2.1245910692481697e-06, -2.767373146247148e-06,
      -3.157980038156805e-06, -3.289794130023992e-06, -3.1752598662891243e-06,
      -2.8433832148330773e-06, -2.3362583378124883e-06, -1.7049520049308017e-06,
      -1.0050942729383803e-06, -2.9251550492221525e-07, 3.807622473831292e-07,
      9.69922839686147e-07, 1.4399513255104914e-06, 1.7673091830567779e-06,
      1.9406474532098166e-06, 1.960588100864104e-06, 1.8386679693087977e-06,
      1.595591594802345e-06, 1.258976202749969e-06, 8.607930230970358e-07,
      4.3471352454086757e-07, 1.3558337902238663e-08, -3.7297741510289565e-07,
      -7.001831130636356e-07, -9.496781603045831e-07, -1.110191235127659e-06,
      -1.1777653991576082e-06, -1.1554229195030076e-06, -1.0523594236730816e-06,
      -8.827647753004685e-07, -6.643865174135692e-07, -4.1696034621426686e-07,
      -1.6063106773385255e-07, 8.552226189307325e-08, 3.0476036862616005e-07,
      4.836828464848833e-07, 6.129040995904362e-07, 6.873851191845653e-07,
      7.064264575598904e-07, 6.733515310676974e-07, 5.949290630923869e-07,
      4.805980038754316e-07, 3.4156703419434546e-07, 1.8986363350574599e-07,
      3.7404963065315354e-08, -1.048448505369873e-07, -2.2757808099290309e-07,
      -3.2366890420881843e-07, -3.884984948462544e-07, -4.2007340893946113e-07,
      -4.189462565284843e-07, -3.879610430151051e-07, -3.3185620250652157e-07,
      -2.567657304165972e-07, -1.6966269364032147e-07, -7.778977479153639e-08,
      1.1881339583705423e-08, 9.312551221370145e-08, 1.6084614683925243e-07,
      2.11344213514016e-07, 2.4246461900942106e-07, 2.536198219989083e-07,
      2.4569937777714055e-07, 2.2088151905431012e-07, 1.8236852242248833e-07,
      1.340712212672621e-07, 8.02695187058863e-08, 2.5275200850032612e-08,
      -2.6879036224580446e-08, -7.270432736386682e-08, -1.0945912570300129e-07,
      -1.3528206392076605e-07, -1.4925065833608308e-07, -1.5136792518356554e-07,
      -1.4248395758721162e-07, -1.2416356623216131e-07, -9.85140047713227e-08,
      -6.79884699991474e-08, -3.5181472998644904e-08, -2.6313984917736774e-09,
      2.7356238659567086e-08, 5.285395217882554e-08, 7.241814894801072e-08,
      8.515145092025492e-08, 9.072069803427262e-08, 8.93330900616811e-08,
      8.167571054753316e-08, 6.882585100490628e-08, 5.214101435653839e-08,
      3.313817918475908e-08, 1.3371864499422529e-08, -5.6801856399534074e-09,
      -2.2716168365677633e-08, -3.6688429185082534e-08, -4.685688964362873e-08,
      -5.28159695019252e-08, -5.4495318366637485e-08, -5.2136517641668294e-08,
      -4.624944911138496e-08, -3.7553167889161735e-08, -2.6906816550281477e-08,
      -1.5236361414542872e-08, -3.4627421387520235e-09, 7.563547736767679e-09,
      1.711731544122443e-08, 2.4639929650544817e-08, 2.9765185912729575e-08,
      3.23292284692982e-08, 3.236516637440727e-08, 3.008406221717404e-08,
      2.5844804246147822e-08, 2.0115955326180108e-08, 1.3432984384945187e-08,
      6.354328355764277e-09, -5.804751272337207e-10, -6.887765888558513e-09,
      -1.216961955274167e-08, -1.613505293724366e-08, -1.8611791578312834e-08,
      -1.954855557618835e-08, -1.900850155805732e-08, -1.7155036970507503e-08,
      -1.4231665493751844e-08, -1.0537808952814303e-08, -6.402674378644754e-09,
      -2.1591998305582543e-09, 1.8800648857342208e-09, 5.4435816576673965e-09,
      8.316772562026826e-09, 1.0352548197688303e-08, 1.1476121132222303e-08,
      1.1684243240559521e-08, 1.1039392660528554e-08, 9.659752750970595e-09,
      7.706055112417482e-09, 5.366492347633053e-09, 2.8409423635425822e-09,
      3.2569030288873104e-10, -2.000301612809215e-09, -3.986725469871756e-09,
      -5.520252823909295e-09, -6.529512448439349e-09, -6.986647643574186e-09,
      -6.905630799123631e-09, -6.337729736650641e-09, -5.364690655207681e-09,
      -4.090318031672131e-09, -2.6311889475969472e-09, -1.107238881736095e-09,
      3.6709708471060036e-10, 1.6906012087805808e-09, 2.781392925859707e-09,
      3.581148999895128e-09, 4.0572827857546036e-09, 4.203099254317437e-09,
      4.036085750308699e-09, 3.5946182240749345e-09, 2.933452328084986e-09,
      2.1184244326281194e-09, 1.2208081851038072e-09, 3.1175920829303274e-10,
      -5.427623241933089e-10, -1.2862685977591883e-09, -1.8749824124451482e-09,
      -2.279893028710503e-09, -2.487582534015224e-09, -2.499867542140498e-09,
      -2.3323819503461995e-09, -2.01229156629088e-09, -1.57537736100677e-09,
      -1.0627492388467533e-09, -5.174565016399849e-10, 1.875392240923369e-11,
      5.083121954224576e-10, 9.201587162988358e-10, 1.2314146486834865e-09,
      1.4283263862269714e-09, 1.5064777832742176e-09, 1.4703168530757116e-09,
      1.3320887025194343e-09, 1.1103011698179671e-09, 8.278723550461891e-10,
      5.101193700916288e-10, 1.8274552333273335e-10, -1.3003001886907334e-10,
      -4.0707841037714897e-10, -6.316106289126038e-10, -7.92011109641124e-10,
      -8.822310487975311e-10, -9.01750466539256e-10, -8.551481824842939e-10,
      -7.513435817917252e-10, -6.025921177018296e-10, -4.233271788401477e-10,
      -2.2894410665945565e-10, -3.46181903360008e-11, 1.457617225116739e-10,
      3.004775257464384e-10, 4.2063622774959105e-10, 5.005670414814634e-10,
      5.379545420478644e-10, 5.33720674481468e-10, 4.916852706731138e-10,
      4.180480640063921e-10, 3.207443199334435e-10, 2.0873083264391247e-10,
      9.125922102991978e-11, -2.2810445808207637e-11, -1.2561002790955885e-10,
      -2.1074204029746017e-10, -2.7361277803168664e-10, -3.1160832678031535e-10,
      -3.241141513424048e-10, -3.1239007971324754e-10, -2.7932184041703024e-10,
      -2.2907734898779416e-10, -1.6670036697672522e-10, -9.767587775833125e-11,
      -2.750064337717828e-11, 3.871079157446484e-11, 9.655947496859378e-11,
      1.426160884591299e-10, 1.7458419589167666e-10, 1.9136869932855318e-10,
      1.9305261852980946e-10, 1.8079160101130197e-10, 1.5664065687132218e-10,
      1.2333123348773431e-10, 8.401876494933277e-11, 4.202124059333512e-11,
      5.682430680656211e-13, -3.742248581319556e-11, -6.952730278166763e-11,
      -9.394819307233686e-11, -1.095884553035388e-10, -1.1607184911967817e-10,
      -1.1370861415959282e-10, -1.0341527940902847e-10, -8.659790115435057e-11,
      -6.501016803514172e-11, -4.0598642029269914e-11, -1.5347287192096446e-11,
      8.867537968715581e-12, 3.040214111136327e-11, 4.794335381825639e-11,
      6.057448869888382e-11, 6.780737581278793e-11, 6.95810543054646e-11,
      6.623003053035957e-11, 5.84269438175418e-11, 4.710590172867295e-11,
      3.337359956413565e-11, 1.841561105687772e-11, 3.40495821515439e-12,
      -1.0580695318480307e-11, -2.26280356953192e-11, -3.203950983554767e-11,
      -3.8364965829264145e-11, -4.141293124639572e-11, -4.124244364727014e-11,
      -3.813766078039853e-11, -3.25685209220034e-11, -2.514144481907462e-11,
      -1.6544445401152782e-11, -7.491042299195097e-12, 1.3329078999221532e-12,
      9.315910585577857e-12, 1.5958269221068337e-11, 2.089836478214977e-11,
      2.3926842410630755e-11, 2.4988712857675623e-11, 2.4174239705030073e-11,
      2.1700211532177845e-11, 1.7883750508605377e-11, 1.3111160705819967e-11,
      7.80446253231906e-12, 2.3882015008712925e-12, -2.741118787459814e-12,
      -7.241015753085985e-12, -1.0842949309864124e-11, -1.3365273265774215e-11,
      -1.4718879659698247e-11, -1.490574995007314e-11, -1.4011116031956494e-11,
      -1.2190331532224423e-11, -9.651839039574694e-12, -6.637780962171833e-12,
      -3.4038393943622575e-12, -1.9981152801710272e-13, 2.747752751552239e-12,
      5.249783989567961e-12, 7.165043816173475e-12, 8.40618117248932e-12,
      8.941423999078815e-12, 8.792154252384266e-12, 8.026887498147487e-12,
      6.752391344975598e-12, 5.10281949760657e-12, 3.2278059958662875e-12,
      1.2804587301717392e-12, -5.938808300105997e-13, -2.2673727986942157e-12,
      -3.6373400801004724e-12, -4.631483123130697e-12, -5.210482117598783e-12,
      -5.3680213521725955e-12, -5.128451827177441e-12, -4.542458812103318e-12,
      -3.681212691354328e-12, -2.6295494603972983e-12, -1.4787504421830941e-12,
      -3.194713179001436e-13, 7.646865938870381e-13, 1.702557448683068e-12,
      2.439448171920324e-12, 2.9396568418130257e-12, 3.1874204554088472e-12,
      3.1863570372034332e-12, 2.9575692100918695e-12, 2.5366579274688375e-12,
      1.9699519695017576e-12, 1.3102890526134847e-12, 6.126880792243892e-13,
      -6.976885307674389e-14, -6.895679851135329e-13, -1.2076904365150855e-12,
      -1.595684088633792e-12, -1.8368048980164613e-12, -1.9262246759547083e-12,
      -1.8703693648171347e-12, -1.6855085977703918e-12, -1.3957606525118265e-12,
      -1.0307048392682464e-12, -6.228052025538623e-13, -2.048456782422253e-13,
      1.9244088404173976e-13, 5.423966981141401e-13, 8.240006326772838e-13,
      1.0228948411670818e-12, 1.1318482350500613e-12, 1.1506712520515231e-12,
      1.0856343802511321e-12, 9.484739457418965e-13, 7.550911242372121e-13,
      5.240631165569223e-13, 2.7508880683885486e-13, 2.74855703060804e-14,
      -2.0115961828741964e-13, -3.9610137297503766e-13, -5.462500218716472e-13,
      -6.446555647762715e-13, -6.886547617816704e-13, -6.796993029168204e-13,
      -6.22904293699511e-13, -5.263729725296407e-13, -4.003648495016656e-13,
      -2.5637997336864973e-13, -1.0623188603183905e-13, 3.882349873828262e-14,
      1.6884553573891322e-13, 2.758084285314735e-13, 3.540132378837381e-13,
      4.002987115270156e-13, 4.140528617505179e-13, 3.9704130044667373e-13,
      3.530800896156162e-13, 2.8758963635056416e-13, 2.0707157945626606e-13,
      1.185525760493398e-13, 2.9037552653720204e-14, -5.4989288198938834e-14,
      -1.2798406491817296e-13, -1.8566012674773702e-13, -2.2518829591387835e-13,
      -2.452759841161292e-13, -2.4612976224878534e-13, -2.2931390803098806e-13,
      -1.9752383509709015e-13, -1.5429779539668224e-13, -1.0369268333550228e-13,
      -4.995015412251473e-14, 2.8222537363475194e-15, 5.0933460975667294e-14,
      9.13375558655051e-14, 1.2179704860304072e-13, 1.4097453067843263e-13,
      1.4845223584861617e-13, 1.4468419669157938e-13, 1.3089011325863607e-13,
      1.0890344736791e-13, 8.098847137154942e-14, 4.964197525613832e-14,
      1.7395105794769307e-14, -1.3370505545247532e-14, -4.058038711684677e-14,
      -6.258958925946413e-14, -7.826399707487904e-14, -8.70182490011744e-14,
      -8.881121706232519e-14, -8.41029581001354e-14, -7.377946964843738e-14,
      -5.905335076162625e-14, -4.134950632839206e-14, -2.218533051232276e-14,
      -3.054402347148452e-15, 1.4678287909891952e-14, 2.9863065069968437e-14,
      4.1629572351980437e-14, 4.9425395890680255e-14, 5.302869346902724e-14,
      5.2536121278054543e-14, 4.8329009288986485e-14, 4.102204164374468e-14,
      3.139958962642233e-14, 2.0345292595339244e-14, 8.770492178881256e-15,
      -2.453266637788653e-15, -1.2553185243982891e-14, -2.090211966688776e-14,
      -2.705111111556285e-14, -3.074642793454961e-14, -3.1931209352208496e-14,
      -3.0732894693212033e-14, -2.7438537994741926e-14, -2.2460796669709993e-14,
      -1.6297813987646716e-14, -9.490379636503816e-15, -2.579661257199624e-15,
      3.931519238702406e-15, 9.611395493810816e-15, 1.4124122213106743e-14,
      1.724568141880305e-14, 1.887044928823418e-14, 1.900874327430496e-14,
      1.7776287073268224e-14, 1.5377029625609806e-14, 1.2081108139274431e-14,
      8.199941052055269e-15, 4.060474234460411e-15, -1.950669976612325e-17,
      -3.753322974273829e-15, -6.903270643514353e-15, -9.293477147141251e-15,
      -1.0817250703998698e-14, -1.1438862458406349e-14, -1.119010440928371e-14,
      -1.016231068031015e-14, -8.494795945205253e-15, -6.360840384086297e-15,
      -3.952430526508941e-15, -1.4649520929058897e-15, 9.17066696743586e-16,
      3.0322308069465275e-15, 4.751862792291753e-15, 5.986438091144224e-15,
      6.6886772135679415e-15, 6.8533562439415045e-15, 6.514126518461725e-15,
      5.737823593584489e-15, 4.616884557895929e-15, 3.2605756755657283e-15,
      1.7857580870010912e-15, 3.07890824858361e-16, -1.0671056530179788e-15,
      -2.2496163986545416e-15, -3.1713612922830764e-15, -3.78847399743412e-15,
      -4.0825752286538714e-15, -4.059933082945591e-15, -3.748932117090616e-15,
      -3.1961750394566278e-15, -2.461611280744645e-15, -1.6131229666819145e-15,
      -7.210012292634014e-16, 1.4728295078896756e-16, 9.316643911442633e-16,
      1.5831523640117483e-15, 2.06639745256165e-15, 2.36106619085741e-15,
      2.4620259506536914e-15, 2.3784273937730854e-15, 2.131843250607061e-15,
      1.7536762392133321e-15, 1.2820832101482159e-15, 7.586763110781739e-16,
      2.2525586974421243e-16, -2.7919409666121727e-16, -7.21055126976038e-16,
      -1.0740245230728341e-15, -1.3203777053180036e-15, -1.4515105875461636e-15,
      -1.4677840338839054e-15, -1.3777404943280748e-15, -1.1968018797938857e-15,
      -9.455856111154734e-16, -6.479915044614703e-16, -3.292156396745046e-16,
      -1.3839383705278841e-17, 2.7587615300529574e-16, 5.213856459860669e-16,
      7.088714932518582e-16, 8.298322233673961e-16, 8.81241095135401e-16,
      8.652998695719484e-16, 7.888395677733745e-16, 6.624408892544196e-16,
      4.993608675024537e-16, 3.1435887692674814e-16, 1.2251443302003642e-16,
      -6.187799728797125e-17, -2.262646651634362e-16, -3.605829968673324e-16,
      -4.577705240036901e-16, -5.140163098401204e-16, -5.287586553423846e-16,
      -5.044506890199642e-16, -4.461302146322368e-16, -3.6084111202706197e-16,
      -2.569602032717459e-16, -1.434856994327721e-16, -2.934134831339872e-17,
      7.725529242977316e-17, 1.6932070912963628e-16, 2.4150045062767463e-16,
      2.903142938795081e-16, 3.14246691092731e-16, 3.136891058684346e-16,
      2.9075087692712027e-16, 2.489632418468026e-16, 1.929067104460832e-16,
      1.2779490658877608e-16, 5.904831092356714e-17, -8.110766019652722e-18,
      -6.901481628253932e-17, -1.1983796387656498e-16, -1.5779838230482185e-16,
      -1.8126896104981503e-16, -1.8979606195295927e-16, -1.8403279113059244e-16,
      -1.6559878095000733e-16, -1.3688271731178427e-16, -1.0080656908650689e-16,
      -6.057161281903635e-17, -1.9405949468071972e-17, 1.9668561159889498e-17,
      5.403492569490512e-17, 8.163391143958273e-17, 1.0106414251469785e-16,
      1.1162670295105312e-16, 1.1331574707097599e-16, 1.0676035102454623e-16,
      9.31258831696319e-17, 7.398536576889389e-17, 5.117256104738513e-17,
      2.6628829828196845e-17, 2.2552380955843562e-18, -2.0219958074582192e-17,
      -3.935027433193555e-17, -5.4050606513961185e-17, -6.36442744467601e-17,
      -6.78768894104381e-17, -6.689885728468903e-17, -6.122041871756977e-17,
      -5.164476150031865e-17, -3.918584035905385e-17, -2.4978072050463795e-17,
      -1.0185048831363339e-17, 4.086120054623152e-18, 1.6859190148752785e-17,
      2.7347521666741485e-17, 3.49942995767442e-17, 3.949292323639243e-17,
      4.078778352414095e-17, 3.9057029215048244e-17, 3.468007670971718e-17,
      2.819347529623716e-17, 2.0239267427403528e-17, 1.151017027971167e-17,
      2.6957665469196618e-18, -5.566533629972312e-18, -1.2732656706778184e-17,
      -1.8382878035171277e-17, -2.2241322988498083e-17, -2.4183535373520946e-17,
      -2.423258035929277e-17, -2.254492941711708e-17, -1.9387999902073644e-17,
      -1.5111660330250982e-17, -1.0116248548510487e-17, -4.819684065188797e-18,
      3.7389754980032947e-19, 5.101874275236195e-18, 9.065555932830373e-18,
      1.2046137150876318e-17, 1.3913590750587477e-17, 1.4628462260992056e-17,
      1.4237037135174334e-17, 1.2860786221929754e-17, 1.0681327611325435e-17,
      7.922358912955914e-18, 4.830107757890092e-18, 1.6538234647998829e-18,
      -1.3722988251484909e-18, -4.044590226159146e-18, -6.2018902220948635e-18,
      -7.733477046438393e-18, -8.582721714363472e-18, -8.746565818945198e-18,
      -8.271213331208192e-18, -7.244664353884378e-18, -5.786891505345554e-18,
      -4.038560495090966e-18, -2.149224353286577e-18, -2.6587986666901396e-19,
      1.47732620865962e-18, 2.967602344315785e-18, 4.119771893337929e-18,
      4.8800294102229e-18, 5.2271366113199414e-18, 5.171188825936203e-18,
      4.750245433373777e-18, 4.025245698067117e-18, 3.073718392979084e-18,
      1.982836881255996e-18, 8.423715060853565e-19, -2.619481520569922e-19,
      -1.2542212084915862e-18, -2.072971590502694e-18, -2.6743244409973278e-18,
      -3.033655676764628e-18, -3.1457257860092927e-18, -3.023416385158685e-18,
      -2.695277937880184e-18, -2.202164426679355e-18, -1.5932727423300075e-18,
      -9.219202650784077e-19, -2.413846505126319e-19, 3.9890199445611584e-19,
      9.565623883068806e-19, 1.3987077613072306e-18, 1.7034874904409847e-18,
      1.8607185938203174e-18, 1.871627832248913e-18, 1.747799844063899e-18,
      1.5094736106754341e-18, 1.1833641179434903e-18, 8.002050798931902e-19,
      3.922119831384572e-19, -9.346430702400196e-21, -3.7630377672841656e-19,
      -6.8534767463777475e-19, -9.192763316784265e-19, -1.067712053426479e-18,
      -1.1272665598117935e-18, -1.1011926108429619e-18, -9.985902579623278e-19,
      -8.332621069049888e-19, -6.223290966084844e-19, -3.8472599859997333e-19,
      -1.3969436777324753e-19, 9.461909091159597e-20, 3.023674354822299e-19,
      4.7094215577769025e-19, 5.916009846370706e-19, 6.597662333286598e-19,
      6.75000162835527e-19, 6.406864432600759e-19, 5.634653123646197e-19,
      4.52483630717562e-19, 3.185290938513484e-19, 1.731202915377792e-19,
      2.7621403057420405e-20, -1.0755725691016016e-19, -2.2362293800169448e-19,
      -3.1389241873041828e-19, -3.7409157411790066e-19, -4.024573863638546e-19,
      -3.996517992446201e-19, -3.685094751136053e-19, -3.136515247687017e-19,
      -2.4100415293163913e-19, -1.572646695391846e-19, -6.935749305847416e-20,
      1.6080114459353642e-20, 9.314832471551018e-20, 1.5704424664490392e-19,
      2.0431262334979766e-19, 2.3297899292480705e-19, 2.4256572473840404e-19,
      2.3399968198547933e-19, 2.0942727022954593e-19, 1.719579215157217e-19,
      1.2536040151246424e-19, 7.37376393320429e-20, 2.1205143545543193e-20,
      -2.840430643153741e-20, -7.179080031136681e-20, -1.0637820093951371e-19,
      -1.3043716892012015e-19, -1.431372479965713e-19, -1.4453028181854659e-19,
      -1.3547215043638555e-19, -1.174936342699563e-19, -9.263393723564145e-20,
      -6.325192699929367e-20, -3.183047103565988e-20, -7.884412601432427e-22,
      2.7686819719629465e-20, 5.1776321673811493e-20, 7.012835187253742e-20,
      8.191563191692141e-20, 8.685014928883969e-20, 8.51581798180799e-20,
      7.752065086075938e-20, 6.498603783825307e-20, 4.886434276285699e-20,
      3.0611333570231035e-20, 1.1712143763227334e-20, -6.427391326633528e-21,
      -2.2574546318735952e-20, -3.574321339652228e-20, -4.5243565956330415e-20,
      -5.070634238370261e-20, -5.2082158416748313e-20, -4.961800741578634e-20,
      -4.3814556381140434e-20, -3.5368913730248044e-20, -2.510818843143939e-20,
      -1.3919368958991245e-20, -2.680846484007765e-21, 7.799660770061252e-21,
      1.6836884715134163e-20, 2.3906654476089188e-20, 2.866975974824812e-20,
      3.098057354790984e-20, 3.0881105731664054e-20, 2.858214358018846e-20,
      2.443391901385532e-20, 1.8889284669205774e-20, 1.2462664650845354e-20,
      5.688071899800959e-21, -9.207273250832627e-22, -6.90523517852651e-21,
      -1.189033301062729e-20, -1.5604055363602785e-20, -1.7888317888391353e-20,
      -1.8700596589116982e-20, -1.810720297337469e-20, -1.626934608330469e-20,
      -1.3423587456454347e-20, -9.858560237188603e-21, -5.889932637142532e-21,
      -1.8355541341965194e-21, 2.0074540651859047e-21, 5.382190637848335e-21,
      8.086943067005511e-21, 9.984945826738906e-21, 1.1008670471375322e-20,
      1.1158802971758504e-20, 1.0498430358326652e-20, 9.143257134502534e-21,
      7.248886451044858e-21, 4.996323432498235e-21, 2.576887354437754e-21,
      1.776613560543628e-22, -2.031525436473711e-21, -3.908782132621169e-21,
      -5.347939959042458e-21, -6.283124364587002e-21, -6.6900598622629565e-21,
      -6.584290409170371e-21, -6.01670320732428e-21, -5.0669038278038394e-21,
      -3.83509788481467e-21, -2.433185894614864e-21, -9.75774496341309e-22,
      4.282462288317534e-22, 1.683004982554932e-21, 2.711403614333143e-21,
      3.4590430067053224e-21, 3.896194304170074e-21, 4.017839723347794e-21,
      3.841943152460191e-21, 3.406223774534823e-21, 2.763789888642338e-21,
      1.9780414134006656e-21, 1.117267325764454e-21, 2.4935007967068897e-22,
      -5.630534185421176e-22, -1.266550003599665e-21, -1.8200448782594312e-21,
      -2.1966405119443365e-21, -2.384360018177579e-21, -2.3857426265455128e-21,
      -2.216435482861419e-21, -1.902967272406976e-21
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.6604677182208086, -0.4957215385200033, -0.23213273885041052, -0.11303812614226268,
      -0.05220718112134584, -0.015602732773384002, 0.009772484276948178,
      0.028553770781510526, 0.042185703193505404, 0.051032974434567994, 0.05523394670288583,
      0.055029521589392436, 0.05086684458602198, 0.04340244941643372, 0.033458926621297194,
      0.0219607155721688, 0.009862905231265198, -0.0019182218831030678,
      -0.01256684607946553, -0.021417216204892887, -0.027988472871620616,
      -0.03200336611298326, -0.03339085673477644, -0.03227376368616437,
      -0.02894359877899602, -0.023825468468395422, -0.017436390562100786,
      -0.010340562170464428, -0.0031050345749576943, 0.003741070326612748,
      0.00974118540302564, 0.014537810290228003, 0.017889700094783353, 0.019679289709975286,
      0.01991064804902807, 0.018698908710389865, 0.016252653014328926, 0.012851100511727696,
      0.0088181765536546, 0.004495574904262564, 0.00021682625517641308,
      -0.0037158583424227614, -0.0070505479963925265, -0.009599355404962765,
      -0.011246458328429776, -0.011950290803728234, -0.011740240110402582,
      -0.010708549923911724, -0.008998413645545926, -0.00678943113844974,
      -0.004281691465991519, -0.0016797357721555573, 0.0008224429652771898,
      0.0030543784581002114, 0.004879330826344933, 0.0062012130820881355,
      0.0069680257547637976, 0.007171849165300811, 0.006845684789926019,
      0.006057637806837804, 0.004903081432545567, 0.003495533817116131,
      0.0019570085633824072, 0.00040857325720002925, -0.001038226534080176,
      -0.0022885377729480426, -0.0032695710723195243, -0.003933940461176741,
      -0.0042609046680411825, -0.004255598502219355, -0.003946479129042424,
      -0.003381320668734187, -0.0026221661629766526, -0.0017396859327084239,
      -0.0008073958480411788, 0.00010383927679263297, 0.0009306482677701896,
      0.0016210511921074277, 0.0021372131638370583, 0.002456954119670453,
      0.002574011745078846, 0.0024971441145782793, 0.002248234251999122,
      0.001859616469179271, 0.0013708814031941938, 0.0008254322331331292,
      0.00026705932187191957, -0.00026322337203567954, -0.000729876046302086,
      -0.0011049114545867368, -0.0013692576920550556, -0.0015133684034637938,
      -0.0015371003807960494, -0.0014489292094878173, -0.0012646149787926902,
      -0.001005459924842833, -0.0006963170621662627, -0.0003635132222801114,
      -3.2842228259912214e-05, 0.00027223423984654437, 0.0005320670068966698,
      0.0007319020879136913, 0.0008625218930248444, 0.0009204364143311324,
      0.0009076487532696815, 0.0008310477219465387, 0.0007015024587995033,
      0.0005327489712931851, 0.0003401657970167859, 0.00013953568928511828,
      -5.4116956294716423e-05, -0.00022753621436004233, -0.0003700329450174567,
      -0.00047403213226239786, -0.0005353513209122936, -0.0005532129676493328,
      -0.0005300123081276159, -0.00047087799648718777, -0.00038307444145635575,
      -0.0002753019471755491, -0.00015695333221255481, -3.738385383309531e-05,
      7.475448874074878e-05, 0.00017207211711781496, 0.00024886352665372756,
      0.00030137290264449024, 0.00032789789464186304, 0.0003287378054600705,
      0.00030600304659418153, 0.0002633112067571623, 0.00020540104517077274,
      0.00013769894343913477, 6.587283068533592e-05, -4.593466587281874e-06,
      -6.877674324179539e-05, -0.0001226190347263915, -0.000163144633186174,
      -0.000188581387226399, -0.00019838570108824744, -0.00019317758355008843,
      -0.0001745979914027433, -0.00014510523331054626, -0.00010773014009745637,
      -6.581099034897971e-05, -2.272885402944332e-05, 1.8337759129471697e-05,
      5.4623035926623013e-05, 8.39367324010475e-05, 0.00010477213198656048,
      0.00011635601088688686, 0.00011864193886266054, 0.00011225218272132201,
      9.837670944115687e-05, 7.864013508391676e-05, 5.4948840892492834e-05,
      2.9330863209773455e-05, 3.780615206730822e-06, -1.988086598530975e-05,
      -4.012146679887377e-05, -5.578312355537436e-05, -6.613301201063252e-05,
      -7.088000798755772e-05, -7.015817690565466e-05, -6.448125880484331e-05,
      -5.46738540010961e-05, -4.1786198240870906e-05, -2.700000739047295e-05,
      -1.1532878111654473e-05, 3.45179840933263e-06, 1.692343466955784e-05,
      2.804670824927697e-05, 3.6224784220993426e-05, 4.1121834054051466e-05,
      4.266499049058866e-05, 4.1027336344419715e-05, 3.659474615642647e-05,
      2.992031590090368e-05, 2.1670687717155854e-05, 1.256879216866577e-05,
      3.3374045030919466e-06, -5.352518326581355e-06, -1.2925430130980368e-05,
      -1.8934282703208786e-05, -2.3081629881520062e-05, -2.5228252194032997e-05,
      -2.538973999746966e-05, -2.3722296946000755e-05, -2.049968970924128e-05,
      -1.608374012748639e-05, -1.089101520251791e-05, -5.358417776117215e-06,
      8.976905298272799e-08, 5.0711504006404335e-06, 9.26901992725788e-06,
      1.2449452452684194e-05, 1.4471033610129358e-05, 1.528715309130024e-05,
      1.4941325920806898e-05, 1.3556465425014281e-05, 1.1319385942556787e-05,
      8.462046383222966e-06, 5.2411510679527684e-06, 1.9177051386376846e-06,
      -1.2620099009104307e-06, -4.0828003303668875e-06, -6.373318865028013e-06,
      -8.01461028655249e-06, -8.944189079512531e-06, -9.155735094085266e-06,
      -8.694799283276812e-06, -7.65116370069402e-06, -6.148684718928666e-06,
      -4.333558320759985e-06, -2.3619797964135515e-06, -3.881313132077934e-07,
      1.4466714984608103e-06, 3.022995898807834e-06, 4.249981928585062e-06,
      5.069424122450246e-06, 5.457173614753383e-06, 5.42198682615173e-06,
      5.002118817436875e-06, 4.260095456844029e-06, 3.276192069492397e-06,
      2.1411941304673924e-06, 9.490182580391639e-07, -2.1026711271606963e-07,
      -1.2565561506541974e-06, -2.12459106924806e-06, -2.7673731462470564e-06,
      -3.157980038156737e-06, -3.28979413002395e-06, -3.1752598662891104e-06,
      -2.843383214833091e-06, -2.3362583378125265e-06, -1.7049520049308601e-06,
      -1.005094272938453e-06, -2.9251550492229635e-07, 3.8076224738304627e-07,
      9.699228396860685e-07, 1.4399513255104224e-06, 1.7673091830567224e-06,
      1.940647453209777e-06, 1.9605881008640815e-06, 1.8386679693087929e-06,
      1.5955915948023569e-06, 1.2589762027499954e-06, 8.607930230970741e-07,
      4.3471352454091416e-07, 1.3558337902289485e-08, -3.7297741510284456e-07,
      -7.00183113063588e-07, -9.49678160304542e-07, -1.110191235127627e-06,
      -1.1777653991575866e-06, -1.1554229195029968e-06, -1.0523594236730816e-06,
      -8.827647753004786e-07, -6.643865174135882e-07, -4.169603462142929e-07,
      -1.6063106773388325e-07, 8.552226189304037e-08, 3.0476036862612754e-07,
      4.836828464848535e-07, 6.12904099590411e-07, 6.873851191845463e-07,
      7.064264575598788e-07, 6.733515310676934e-07, 5.949290630923902e-07,
      4.805980038754414e-07, 3.415670341943606e-07, 1.8986363350576483e-07,
      3.740496306533616e-08, -1.0484485053696622e-07, -2.2757808099288326e-07,
      -3.2366890420880117e-07, -3.8849849484624077e-07, -4.2007340893945176e-07,
      -4.189462565284795e-07, -3.879610430151048e-07, -3.3185620250652533e-07,
      -2.5676573041660443e-07, -1.6966269364033136e-07, -7.778977479154793e-08,
      1.1881339583693221e-08, 9.312551221368952e-08, 1.6084614683924163e-07,
      2.1134421351400704e-07, 2.4246461900941434e-07, 2.5361982199890416e-07,
      2.456993777771391e-07, 2.2088151905431128e-07, 1.8236852242249177e-07,
      1.3407122126726742e-07, 8.026951870589295e-08, 2.5275200850039998e-08,
      -2.6879036224572916e-08, -7.270432736385969e-08, -1.0945912570299503e-07,
      -1.3528206392076107e-07, -1.4925065833607967e-07, -1.5136792518356377e-07,
      -1.424839575872114e-07, -1.2416356623216253e-07, -9.851400477132514e-08,
      -6.79884699991508e-08, -3.518147299864893e-08, -2.6313984917780052e-09,
      2.7356238659562778e-08, 5.2853952178821555e-08, 7.241814894800732e-08,
      8.515145092025229e-08, 9.072069803427087e-08, 8.93330900616803e-08,
      8.167571054753327e-08, 6.88258510049072e-08, 5.2141014356540005e-08,
      3.313817918476122e-08, 1.3371864499425004e-08, -5.680185639950807e-09,
      -2.2716168365675105e-08, -3.668842918508025e-08, -4.685688964362683e-08,
      -5.2815969501923794e-08, -5.4495318366636624e-08, -5.2136517641668e-08,
      -4.6249449111385203e-08, -3.755316788916245e-08, -2.6906816550282562e-08,
      -1.523636141454421e-08, -3.4627421387534926e-09, 7.563547736766194e-09,
      1.7117315441223037e-08, 2.4639929650543602e-08, 2.9765185912728616e-08,
      3.232922846929755e-08, 3.236516637440696e-08, 3.008406221717408e-08,
      2.5844804246148186e-08, 2.0115955326180746e-08, 1.3432984384946034e-08,
      6.354328355765257e-09, -5.804751272326901e-10, -6.887765888557508e-09,
      -1.216961955274076e-08, -1.6135052937242898e-08, -1.861179157831226e-08,
      -1.9548555576187984e-08, -1.900850155805717e-08, -1.7155036970507562e-08,
      -1.4231665493752089e-08, -1.0537808952814696e-08, -6.402674378645257e-09,
      -2.1591998305588217e-09, 1.880064885733635e-09, 5.443581657666837e-09,
      8.316772562026331e-09, 1.0352548197687901e-08, 1.1476121132222014e-08,
      1.1684243240559352e-08, 1.103939266052851e-08, 9.659752750970667e-09,
      7.706055112417653e-09, 5.3664923476332994e-09, 2.84094236354288e-09,
      3.2569030288905447e-10, -2.0003016128088917e-09, -3.986725469871456e-09,
      -5.520252823909039e-09, -6.52951244843915e-09, -6.986647643574055e-09,
      -6.905630799123571e-09, -6.33772973665065e-09, -5.364690655207753e-09,
      -4.090318031672254e-09, -2.631188947597107e-09, -1.1072388817362777e-09,
      3.6709708471040887e-10, 1.6906012087803951e-09, 2.7813929258595405e-09,
      3.5811489998949905e-09, 4.057282785754503e-09, 4.203099254317377e-09,
      4.036085750308681e-09, 3.594618224074957e-09, 2.933452328085042e-09,
      2.118424432628201e-09, 1.2208081851039056e-09, 3.1175920829313986e-10,
      -5.427623241932013e-10, -1.2862685977590878e-09, -1.8749824124450614e-09,
      -2.279893028710435e-09, -2.4875825340151782e-09, -2.4998675421404756e-09,
      -2.3323819503462007e-09, -2.0122915662909023e-09, -1.5753773610068093e-09,
      -1.0627492388468052e-09, -5.174565016400449e-10, 1.8753922409170618e-11,
      5.083121954223963e-10, 9.201587162987806e-10, 1.2314146486834405e-09,
      1.4283263862269372e-09, 1.506477783274197e-09, 1.4703168530757052e-09,
      1.3320887025194415e-09, 1.1103011698179864e-09, 8.278723550462177e-10,
      5.101193700916638e-10, 1.827455233327716e-10, -1.3003001886903488e-10,
      -4.0707841037711304e-10, -6.316106289125729e-10, -7.920111096411e-10,
      -8.822310487975154e-10, -9.01750466539249e-10, -8.551481824842958e-10,
      -7.51343581791735e-10, -6.02592117701846e-10, -4.233271788401689e-10,
      -2.2894410665947974e-10, -3.461819033602577e-11, 1.457617225116499e-10,
      3.00477525746417e-10, 4.2063622774957353e-10, 5.005670414814506e-10,
      5.379545420478568e-10, 5.337206744814657e-10, 4.916852706731164e-10,
      4.18048064006399e-10, 3.2074431993345387e-10, 2.0873083264392534e-10,
      9.125922102993395e-11, -2.281044580819329e-11, -1.2561002790954535e-10,
      -2.1074204029744844e-10, -2.7361277803167733e-10, -3.116083267803089e-10,
      -3.241141513424015e-10, -3.123900797132474e-10, -2.793218404170331e-10,
      -2.290773489877996e-10, -1.6670036697673261e-10, -9.767587775833989e-11,
      -2.750064337718743e-11, 3.871079157445588e-11, 9.655947496858563e-11,
      1.4261608845912307e-10, 1.745841958916715e-10, 1.913686993285499e-10,
      1.930526185298082e-10, 1.807916010113026e-10, 1.5664065687132456e-10,
      1.233312334877381e-10, 8.401876494933755e-11, 4.202124059334047e-11,
      5.682430680711012e-13, -3.742248581319036e-11, -6.952730278166307e-11,
      -9.39481930723332e-11, -1.0958845530353623e-10, -1.1607184911967674e-10,
      -1.1370861415959253e-10, -1.0341527940902919e-10, -8.659790115435217e-11,
      -6.5010168035144e-11, -4.0598642029272654e-11, -1.5347287192099406e-11,
      8.867537968712641e-12, 3.040214111136056e-11, 4.794335381825409e-11,
      6.057448869888207e-11, 6.78073758127868e-11, 6.958105430546413e-11,
      6.623003053035977e-11, 5.84269438175426e-11, 4.7105901728674257e-11,
      3.3373599564137314e-11, 1.841561105687958e-11, 3.404958215156303e-12,
      -1.0580695318478483e-11, -2.2628035695317583e-11, -3.203950983554636e-11,
      -3.836496582926322e-11, -4.1412931246395224e-11, -4.124244364727007e-11,
      -3.8137660780398854e-11, -3.256852092200406e-11, -2.5141444819075545e-11,
      -1.6544445401153887e-11, -7.49104229919629e-12, 1.3329078999209657e-12,
      9.31591058557676e-12, 1.59582692210674e-11, 2.0898364782149048e-11,
      2.3926842410630287e-11, 2.4988712857675416e-11, 2.417423970503012e-11,
      2.1700211532178126e-11, 1.7883750508605855e-11, 1.3111160705820594e-11,
      7.804462532319784e-12, 2.388201500872055e-12, -2.74111878745907e-12,
      -7.241015753085311e-12, -1.0842949309863561e-11, -1.3365273265773796e-11,
      -1.4718879659697988e-11, -1.4905749950073045e-11, -1.4011116031956553e-11,
      -1.219033153222462e-11, -9.651839039575006e-12, -6.637780962172229e-12,
      -3.4038393943627017e-12, -1.9981152801755993e-13, 2.7477527515518024e-12,
      5.249783989567575e-12, 7.165043816173163e-12, 8.406181172489096e-12,
      8.94142399907869e-12, 8.79215425238424e-12, 8.026887498147555e-12,
      6.752391344975747e-12, 5.102819497606782e-12, 3.227805995866541e-12,
      1.2804587301720123e-12, -5.938808300103291e-13, -2.267372798693967e-12,
      -3.637340080100262e-12, -4.631483123130537e-12, -5.2104821175986805e-12,
      -5.3680213521725535e-12, -5.128451827177458e-12, -4.542458812103387e-12,
      -3.681212691354441e-12, -2.6295494603974437e-12, -1.478750442183259e-12,
      -3.1947131790031447e-13, 7.646865938868741e-13, 1.7025574486829218e-12,
      2.4394481719202045e-12, 2.939656841812939e-12, 3.187420455408796e-12,
      3.186357037203418e-12, 2.9575692100918876e-12, 2.536657927468885e-12,
      1.9699519695018286e-12, 1.3102890526135716e-12, 6.126880792244841e-13,
      -6.976885307664836e-14, -6.895679851134438e-13, -1.2076904365150086e-12,
      -1.5956840886337319e-12, -1.8368048980164213e-12, -1.92622467595469e-12,
      -1.8703693648171375e-12, -1.6855085977704136e-12, -1.395760652511864e-12,
      -1.0307048392682953e-12, -6.22805202553918e-13, -2.0484567824228325e-13,
      1.9244088404168397e-13, 5.423966981140903e-13, 8.24000632677243e-13,
      1.0228948411670523e-12, 1.1318482350500446e-12, 1.1506712520515197e-12,
      1.0856343802511412e-12, 9.484739457419165e-13, 7.550911242372407e-13,
      5.24063116556957e-13, 2.7508880683889253e-13, 2.7485570306118264e-14,
      -2.0115961828738425e-13, -3.9610137297500707e-13, -5.462500218716232e-13,
      -6.446555647762551e-13, -6.886547617816622e-13, -6.796993029168203e-13,
      -6.229042936995183e-13, -5.263729725296542e-13, -4.0036484950168406e-13,
      -2.5637997336867144e-13, -1.0623188603186222e-13, 3.882349873825975e-14,
      1.6884553573889224e-13, 2.7580842853145574e-13, 3.540132378837245e-13,
      4.002987115270068e-13, 4.1405286175051406e-13, 3.9704130044667484e-13,
      3.530800896156219e-13, 2.875896363505738e-13, 2.0707157945627873e-13,
      1.1855257604935445e-13, 2.903755265373563e-14, -5.4989288198923795e-14,
      -1.2798406491815935e-13, -1.8566012674772566e-13, -2.251882959138699e-13,
      -2.4527598411612397e-13, -2.461297622487834e-13, -2.293139080309893e-13,
      -1.9752383509709426e-13, -1.5429779539668867e-13, -1.0369268333551041e-13,
      -4.9950154122523845e-14, 2.8222537363381666e-15, 5.0933460975658396e-14,
      9.133755586549724e-14, 1.2179704860303435e-13, 1.4097453067842814e-13,
      1.484522358486137e-13, 1.446841966915789e-13, 1.3089011325863746e-13,
      1.08903447367913e-13, 8.098847137155366e-14, 4.9641975256143383e-14,
      1.739510579477476e-14, -1.3370505545242111e-14, -4.058038711684176e-14,
      -6.258958925945987e-14, -7.826399707487577e-14, -8.70182490011723e-14,
      -8.881121706232432e-14, -8.410295810013574e-14, -7.37794696484388e-14,
      -5.905335076162853e-14, -4.134950632839498e-14, -2.2185330512326043e-14,
      -3.0544023471518284e-15, 1.467828790988873e-14, 2.986306506996559e-14,
      4.162957235197814e-14, 4.9425395890678627e-14, 5.3028693469026337e-14,
      5.253612127805436e-14, 4.8329009288986965e-14, 4.102204164374575e-14,
      3.1399589626423845e-14, 2.0345292595341074e-14, 8.770492178883238e-15,
      -2.4532666377866712e-15, -1.2553185243981051e-14, -2.0902119666886183e-14,
      -2.705111111556163e-14, -3.0746427934548805e-14, -3.193120935220812e-14,
      -3.073289469321207e-14, -2.7438537994742336e-14, -2.2460796669710718e-14,
      -1.629781398764768e-14, -9.49037963650493e-15, -2.5796612572007945e-15,
      3.931519238701264e-15, 9.611395493809782e-15, 1.4124122213105883e-14,
      1.7245681418802415e-14, 1.8870449288233802e-14, 1.900874327430484e-14,
      1.777628707326835e-14, 1.5377029625610153e-14, 1.2081108139274958e-14,
      8.199941052055923e-15, 4.0604742344611365e-15, -1.95066997653833e-17,
      -3.753322974273129e-15, -6.903270643513739e-15, -9.293477147140762e-15,
      -1.0817250703998357e-14, -1.1438862458406167e-14, -1.1190104409283687e-14,
      -1.0162310680310275e-14, -8.494795945205507e-15, -6.360840384086654e-15,
      -3.952430526509367e-15, -1.464952092906348e-15, 9.170666967431301e-16,
      3.0322308069461063e-15, 4.751862792291393e-15, 5.986438091143947e-15,
      6.688677213567761e-15, 6.853356243941424e-15, 6.514126518461741e-15,
      5.737823593584592e-15, 4.616884557896102e-15, 3.26057567556595e-15,
      1.7857580870013413e-15, 3.0789082485861937e-16, -1.0671056530177315e-15,
      -2.2496163986543223e-15, -3.171361292282898e-15, -3.788473997433992e-15,
      -4.082575228653798e-15, -4.0599330829455734e-15, -3.748932117090651e-15,
      -3.196175039456709e-15, -2.461611280744762e-15, -1.6131229666820557e-15,
      -7.210012292635548e-16, 1.4728295078881373e-16, 9.3166439114412e-16,
      1.5831523640116246e-15, 2.066397452561554e-15, 2.3610661908573465e-15,
      2.4620259506536622e-15, 2.37842739377309e-15, 2.1318432506070972e-15,
      1.7536762392133953e-15, 1.2820832101482987e-15, 7.586763110782685e-16,
      2.2525586974431144e-16, -2.7919409666112133e-16, -7.210551269759516e-16,
      -1.0740245230727627e-15, -1.3203777053179516e-15, -1.4515105875461333e-15,
      -1.4677840338838975e-15, -1.3777404943280878e-15, -1.1968018797939169e-15,
      -9.45585611115519e-16, -6.479915044615259e-16, -3.2921563967456534e-16,
      -1.3839383705339978e-17, 2.7587615300523865e-16, 5.213856459860176e-16,
      7.088714932518195e-16, 8.298322233673696e-16, 8.812410951353876e-16,
      8.652998695719476e-16, 7.888395677733855e-16, 6.624408892544403e-16,
      4.993608675024817e-16, 3.143588769267808e-16, 1.2251443302007093e-16,
      -6.187799728793752e-17, -2.2626466516340563e-16, -3.605829968673069e-16,
      -4.577705240036711e-16, -5.140163098401085e-16, -5.287586553423802e-16,
      -5.044506890199668e-16, -4.461302146322454e-16, -3.608411120270757e-16,
      -2.569602032717633e-16, -1.4348569943279163e-16, -2.934134831341889e-17,
      7.72552924297538e-17, 1.6932070912961908e-16, 2.415004506276607e-16,
      2.903142938794981e-16, 3.1424669109272533e-16, 3.1368910586843324e-16,
      2.9075087692712303e-16, 2.4896324184680884e-16, 1.9290671044609223e-16,
      1.2779490658878697e-16, 5.904831092357897e-17, -8.110766019640889e-18,
      -6.901481628252834e-17, -1.1983796387655556e-16, -1.5779838230481453e-16,
      -1.8126896104981015e-16, -1.8979606195295698e-16, -1.8403279113059268e-16,
      -1.655987809500099e-16, -1.3688271731178883e-16, -1.0080656908651296e-16,
      -6.057161281904338e-17, -1.940594946807938e-17, 1.9668561159882263e-17,
      5.4034925694898556e-17, 8.163391143957725e-17, 1.0106414251469376e-16,
      1.1162670295105055e-16, 1.1331574707097503e-16, 1.0676035102454684e-16,
      9.312588316963388e-17, 7.3985365768897e-17, 5.117256104738906e-17,
      2.6628829828201258e-17, 2.255238095588892e-18, -2.0219958074577866e-17,
      -3.9350274331931714e-17, -5.405060651395807e-17, -6.364427444675786e-17,
      -6.787688941043679e-17, -6.689885728468866e-17, -6.122041871757026e-17,
      -5.164476150031988e-17, -3.918584035905566e-17, -2.4978072050466008e-17,
      -1.018504883136576e-17, 4.086120054620712e-18, 1.6859190148750502e-17,
      2.7347521666739506e-17, 3.499429957674265e-17, 3.949292323639138e-17,
      4.078778352414044e-17, 3.905702921504826e-17, 3.468007670971768e-17,
      2.8193475296238075e-17, 2.0239267427404767e-17, 1.151017027971313e-17,
      2.695766546921224e-18, -5.5665336299707685e-18, -1.273265670677677e-17,
      -1.8382878035170084e-17, -2.224132298849718e-17, -2.418353537352038e-17,
      -2.4232580359292553e-17, -2.2544929417117205e-17, -1.938799990207408e-17,
      -1.511166033025167e-17, -1.0116248548511359e-17, -4.819684065189782e-18,
      3.7389754979931104e-19, 5.101874275235216e-18, 9.065555932829502e-18,
      1.2046137150875612e-17, 1.3913590750586975e-17, 1.4628462260991776e-17,
      1.4237037135174278e-17, 1.2860786221929908e-17, 1.0681327611325772e-17,
      7.922358912956396e-18, 4.830107757890671e-18, 1.65382346480051e-18,
      -1.3722988251478642e-18, -4.044590226158564e-18, -6.201890222094364e-18,
      -7.733477046438004e-18, -8.582721714363211e-18, -8.746565818945074e-18,
      -8.271213331208198e-18, -7.244664353884503e-18, -5.7868915053457805e-18,
      -4.03856049509127e-18, -2.1492243532869305e-18, -2.6587986666938836e-19,
      1.477326208659253e-18, 2.967602344315451e-18, 4.119771893337649e-18,
      4.880029410222689e-18, 5.22713661131981e-18, 5.171188825936154e-18,
      4.750245433373807e-18, 4.025245698067217e-18, 3.073718392979241e-18,
      1.982836881256194e-18, 8.423715060855776e-19, -2.619481520567657e-19,
      -1.2542212084913709e-18, -2.0729715905025043e-18, -2.6743244409971745e-18,
      -3.0336556767645193e-18, -3.145725786009233e-18, -3.0234163851586753e-18,
      -2.6952779378802214e-18, -2.2021644266794323e-18, -1.5932727423301165e-18,
      -9.219202650785387e-19, -2.4138465051277406e-19, 3.9890199445597322e-19,
      9.565623883067477e-19, 1.398707761307116e-18, 1.7034874904408951e-18,
      1.8607185938202573e-18, 1.871627832248884e-18, 1.7477998440639005e-18,
      1.5094736106754636e-18, 1.1833641179435433e-18, 8.002050798932606e-19,
      3.9221198313853884e-19, -9.346430702314107e-21, -3.763037767283326e-19,
      -6.853476746376988e-19, -9.192763316783633e-19, -1.0677120534264322e-18,
      -1.127266559811765e-18, -1.1011926108429525e-18, -9.985902579623369e-19,
      -8.332621069050144e-19, -6.223290966085233e-19, -3.8472599860002148e-19,
      -1.3969436777330068e-19, 9.461909091154209e-20, 3.0236743548217925e-19,
      4.709421557776462e-19, 5.916009846370358e-19, 6.59766233328636e-19,
      6.750001628355148e-19, 6.40686443260075e-19, 5.634653123646292e-19,
      4.524836307175804e-19, 3.185290938513735e-19, 1.7312029153780882e-19,
      2.762140305745199e-20, -1.0755725691012905e-19, -2.23622938001666e-19,
      -3.138924187303943e-19, -3.740915741178824e-19, -4.0245738636384293e-19,
      -3.9965179924461537e-19, -3.685094751136071e-19, -3.1365152476870945e-19,
      -2.410041529316519e-19, -1.5726466953920102e-19, -6.93574930584928e-20,
      1.608011445933431e-20, 9.314832471549159e-20, 1.570442466448873e-19,
      2.0431262334978406e-19, 2.329789929247972e-19, 2.4256572473839826e-19,
      2.339996819854777e-19, 2.0942727022954814e-19, 1.7195792151572722e-19,
      1.2536040151247233e-19, 7.373763933205275e-20, 2.120514354555393e-20,
      -2.8404306431526634e-20, -7.179080031135677e-20, -1.0637820093950508e-19,
      -1.304371689201134e-19, -1.4313724799656683e-19, -1.445302818185445e-19,
      -1.3547215043638579e-19, -1.174936342699586e-19, -9.263393723564547e-20,
      -6.325192699929895e-20, -3.183047103566595e-20, -7.884412601495863e-22,
      2.7686819719623326e-20, 5.1776321673805986e-20, 7.012835187253289e-20,
      8.191563191691809e-20, 8.685014928883774e-20, 8.515817981807935e-20,
      7.752065086076017e-20, 6.498603783825501e-20, 4.8864342762859876e-20,
      3.06113335702346e-20, 1.1712143763231258e-20, -6.427391326629556e-21,
      -2.257454631873222e-20, -3.5743213396519035e-20, -4.524356595632785e-20,
      -5.070634238370085e-20, -5.2082158416747417e-20, -4.9618007415786285e-20,
      -4.3814556381141156e-20, -3.536891373024942e-20, -2.510818843144128e-20,
      -1.3919368958993466e-20, -2.6808464840101333e-21, 7.799660770058917e-21,
      1.6836884715132024e-20, 2.3906654476087383e-20, 2.8669759748246755e-20,
      3.098057354790898e-20, 3.0881105731663717e-20, 2.858214358018863e-20,
      2.443391901385594e-20, 1.888928466920676e-20, 1.2462664650846609e-20,
      5.688071899802368e-21, -9.207273250818153e-22, -6.90523517852513e-21,
      -1.189033301062607e-20, -1.5604055363601797e-20, -1.7888317888390648e-20,
      -1.8700596589116588e-20, -1.8107202973374605e-20, -1.6269346083304895e-20,
      -1.3423587456454807e-20, -9.858560237189271e-21, -5.889932637143349e-21,
      -1.835554134197416e-21, 2.0074540651849986e-21, 5.3821906378474854e-21,
      8.086943067004775e-21, 9.984945826738325e-21, 1.1008670471374923e-20,
      1.1158802971758303e-20, 1.0498430358326649e-20, 9.143257134502713e-21,
      7.248886451045196e-21, 4.996323432498694e-21, 2.5768873544382912e-21,
      1.7766135605493381e-22, -2.0315254364731495e-21, -3.908782132620656e-21,
      -5.3479399590420265e-21, -6.283124364586676e-21, -6.690059862262749e-21,
      -6.584290409170288e-21, -6.016703207324319e-21, -5.066903827803989e-21,
      -3.8350978848149115e-21, -2.433185894615173e-21, -9.757744963416582e-22,
      4.282462288313926e-22, 1.6830049825545863e-21, 2.7114036143328356e-21,
      3.459043006705072e-21, 3.896194304169894e-21, 4.017839723347692e-21,
      3.8419431524601676e-21, 3.406223774534873e-21, 2.7637898886424518e-21,
      1.97804141340083e-21, 1.1172673257646534e-21, 2.49350079670906e-22,
      -5.630534185418998e-22, -1.2665500035994621e-21, -1.8200448782592563e-21,
      -2.1966405119441996e-21, -2.3843600181774865e-21, -2.3857426265454673e-21,
      -2.21643548286142e-21, -1.9029672724070202e-21
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_4_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<4>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.5048105091118545), "design.b()[0] == 0.5048105091118545");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.5048105091118545));
    static_assert(almost_equal(design.b()[1], -2.019242036447418), "design.b()[1] == -2.019242036447418");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.019242036447418));
    static_assert(almost_equal(design.b()[2], 3.0288630546711275), "design.b()[2] == 3.0288630546711275");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 3.0288630546711275));
    static_assert(almost_equal(design.b()[3], -2.019242036447418), "design.b()[3] == -2.019242036447418");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -2.019242036447418));
    static_assert(almost_equal(design.b()[4], 0.5048105091118545), "design.b()[4] == 0.5048105091118545");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.5048105091118545));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.250731503963597), "design.a()[1] == -3.250731503963597");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.250731503963597));
    static_assert(almost_equal(design.a()[2], 4.134196301741499), "design.a()[2] == 4.134196301741499");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 4.134196301741499));
    static_assert(almost_equal(design.a()[3], -2.4455697906426783), "design.a()[3] == -2.4455697906426783");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -2.4455697906426783));
    static_assert(almost_equal(design.a()[4], 0.578523156302169), "design.a()[4] == 0.578523156302169");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.578523156302169));
    std::cout << "max_deviation(cheby1,highpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.5048105091118545, -0.3782386109456102, -0.28767485379567015, -0.15613374894903986,
      -0.030487560411774917, 0.06167155744196848, 0.11110981885566412, 0.12199339636842998,
      0.10567783214945503, 0.07523400250735685, 0.041736400987594874, 0.01250820775153591,
      -0.00903271886002164, -0.0225296611589227, -0.029450625816960424,
      -0.031920467511468695, -0.03188242272311449, -0.030665347362341014,
      -0.028902478684826705, -0.026681592595166642, -0.023795700439626102,
      -0.019988906847603904, -0.015133416087721709, -0.00931473465273501,
      -0.0028330915738500016, 0.003853541787460179, 0.0102145843635642, 0.01573383950849346,
      0.019980505330681735, 0.022655592821031675, 0.023612747085736352, 0.02285736253754221,
      0.02053006520629508, 0.016880741954501385, 0.012238194373976614, 0.00697897679264136,
      0.0014975962497102181, -0.003820718400157107, -0.008623990571210379,
      -0.012613701494760779, -0.015560714512085568, -0.017316383565247596,
      -0.01781837428054299, -0.0170909166583611, -0.01523951501578618,
      -0.012440516107528159, -0.008926318362837596, -0.004967335130346251,
      -0.0008520584802788438, 0.0031333172950668404, 0.00672426739967797,
      0.009694989022548254, 0.011872046513187899, 0.013143816460115258,
      0.013465275334562411, 0.012858019995546033, 0.011405745836070656,
      0.009245706998741388, 0.006556930444696636, 0.0035461378295144758,
      0.0004324380127503323, -0.002568114608947021, -0.005257043245341987,
      -0.0074661116860806065, -0.009067354637655362, -0.009979916436850051,
      -0.010173380700549926, -0.009667525605136104, -0.008528684708380148,
      -0.006863115218452766, -0.004807960332891652, -0.00252052881940025,
      -0.00016669626406205437, 0.00209074465993443, 0.004102991861182577,
      0.005744693003212587, 0.00692138037667803, 0.007574469420134681, 0.007683593076991804,
      0.007266235445184278, 0.006374813166435855, 0.005091519443382937,
      0.003521383018472917, 0.0017840948992376843, 5.213948350691819e-06,
      -0.0016926233557209387, -0.0031978925819559764, -0.0044172420826661535,
      -0.00528099724861167, -0.005746805932321112, -0.005801262681939163,
      -0.005459494034576955, -0.004762826312877524, -0.0037747819519606297,
      -0.0025757525691581466, -0.0012567708654563723, 8.715470347895639e-05,
      0.0013636701023211424, 0.002489222353669355, 0.003394327589404854,
      0.004027643173395027, 0.004358622242038954, 0.004378635363299148,
      0.004100553327917006, 0.003556889803939053, 0.002796695810554216,
      0.0018814738982257323, 0.0008804341970648022, -0.00013455557838803122,
      -0.0010939694192873767, -0.0019352346242110237, -0.002606660461318277,
      -0.003070448501117309, -0.0033046223282340624, -0.0033037951087639744,
      -0.0030787760952289134, -0.0026550959033298264, -0.00207060012496307,
      -0.0013723172305600958, -0.0006128465440890284, 0.0001534665996009545,
      0.0008742991837340172, 0.0015028091530903016, 0.0020005638032587216,
      0.0023397634281485183, 0.002504641553446876, 0.0024919843992616316,
      0.0023107746179028867, 0.001981023557596575, 0.001531908437962426,
      0.0009993726734041485, 0.0004233767763618841, -0.00015499758882101802,
      -0.0006963871331223692, -0.0011657399131226745, -0.0015344970404898538,
      -0.0017822338756874204, -0.0018976740503188721, -0.0018790361940058424,
      -0.0017337203672441997, -0.0014773856956817166, -0.001132509664304537,
      -0.0007265505707569216, -0.00028985601121128777, 0.0001465290285010873,
      0.0005530011170997599, 0.0009033416101092077, 0.0011763412376840478,
      0.0013570103671408543, 0.001437311757860992, 0.0014163879259052946,
      0.0013002908125307406, 0.0011012548775263952, 0.0008365838445926581,
      0.0005272443341123169, 0.00019627524607402388, -0.00013287072030447795,
      -0.00043793774338328495, -0.0006993226225617702, -0.0009012838760080891,
      -0.0010328334167445774, -0.0010882648132302048, -0.001067298910282797,
      -0.0009748544357149357, -0.0008204763214790848, -0.0006174762015501724,
      -0.00038185659136541223, -0.0001311016633474939, 0.00011707720677415557,
      0.0003459539130814181, 0.0005408777420151795, 0.0006901727558631982,
      0.0007857941235209405, 0.0008237079746790102, 0.0008039816475440627,
      0.0007305914566787073, 0.0006109739534508486, 0.0004553628723811367,
      0.0002759665715767021, 8.60490932604852e-05, -0.00010101837676053572,
      -0.00027266991845798877, -0.00041796088353563814, -0.0005282365265839077,
      -0.0005976146247548015, -0.0006232578418619589, -0.0006054269722788402,
      -0.0005473214773922086, -0.0004547278704582927, -0.00033550860651182274,
      -0.00019897346465853178, -5.518146411782638e-05, 8.577612818350006e-05,
      0.0002144621707520707, 0.0003227042181028886, 0.0004040913176970169,
      0.00045432852149332947, 0.0004714315619531999, 0.00045575579348253853,
      0.00040986501867953636, 0.0003382564286972434, 0.00024696690999584836,
      0.00014309286597496962, 3.426010070823731e-05, -7.191797101329154e-05,
      -0.00016835648170745817, -0.0002489557783427248, -0.00030897032661467096,
      -0.0003452688305317531, -0.00035647289064757797, -0.0003429703479534108,
      -0.0003068081418733412, -0.00025147746728301616, -0.0001816107401644019,
      -0.0001026149743703999, -2.0269362018977247e-05, 5.96839921742012e-05,
      0.00013192809237096815, 0.00019191246583579355, 0.00023612693065751483,
      0.0002622922316124055, 0.00026945840957387913, 0.000258008450006345,
      0.00022957129713058774, 0.00018685428473645357, 0.00013341004392731527,
      7.335670602861026e-05, 1.1072527685967559e-05, -4.911316557149733e-05,
      -0.00010321157308352069, -0.00014782955861648479, -0.00018037268738244175,
      -0.0001991847644236846, -0.00020361730939929873, -0.000194027458446925,
      -0.00017170771053391854, -0.00013875540507566578, -9.789354717641111e-05,
      -5.225736736281101e-05, -5.162669981347381e-06, 4.0127474162022414e-05,
      8.062178051007507e-05, 0.00011379133389221316, 0.00013772006985488298,
      0.00015120677593453296, 0.00015381390834985447, 0.0001458623445129837,
      0.00012837490136134169, 0.0001029747972977759, 7.174801083719454e-05,
      3.708052972688943e-05, 1.4826854498705528e-06, -3.258691347129828e-05,
      -6.288588130841326e-05, -8.753035271529052e-05, -0.00010510643620960001,
      -0.0001147446705204392, -0.00011615412332918371, -0.00010961566478252148,
      -9.593674037530156e-05, -7.637247448283175e-05, -5.25199999037294e-05,
      -2.6194410417870615e-05, 7.044036117567266e-07, 2.6324581511400692e-05,
      4.8985780952764777e-05, 6.728537504583977e-05, 8.018094145948625e-05,
      8.704452982882422e-05, 8.768631566374657e-05, 8.234743616359916e-05,
      7.166390433889093e-05, 5.6605373990627276e-05, 3.839406235504975e-05,
      1.841024109989895e-05, -1.9086753696352467e-06, -2.1168302413445686e-05,
      -3.810995355098997e-05, -5.168985868450082e-05, -6.11401710334038e-05,
      -6.600845552631564e-05, -6.617396319979007e-05, -6.184064927417139e-05,
      -5.3508472928001383e-05, -4.192592044425635e-05, -2.8027833173313647e-05,
      -1.2863432366846456e-05, 2.4801255707831044e-06, 1.6953270565905094e-05,
      2.9613533672621522e-05, 3.968461204394482e-05, 4.6601453478309425e-05,
      5.0038940350822435e-05, 4.992297659606889e-05, 4.6424030461348614e-05,
      3.993437406947825e-05, 3.1031310546011535e-05, 2.0429525674591493e-05,
      8.926295625687764e-06, -2.656403582362167e-06, -1.3528814070727563e-05,
      -2.298552299533854e-05, -3.044947971011549e-05, -3.550528682176238e-05,
      -3.791999646355429e-05, -3.76505720707892e-05, -3.4838119380840304e-05,
      -2.9789883611639663e-05, -2.2950794467541615e-05, -1.4866968489691591e-05,
      -6.144013871686637e-06, 2.5967945665204148e-06, 1.0761398371062938e-05,
      1.7822029035640577e-05, 2.334999454529525e-05, 2.7040241329545674e-05,
      2.872640093555574e-05, 2.8385735596132733e-05, 2.613410923865338e-05,
      2.2211781667116242e-05, 1.696140998134016e-05, 1.0800106863076356e-05,
      4.1877240863568584e-06, -2.406313414399895e-06, -8.535305612818096e-06,
      -1.3804555226588705e-05, -1.7895776423767616e-05, -2.0585200572741033e-05,
      -2.1754438601558673e-05, -2.1393694175723438e-05, -1.9597459624020168e-05,
      -1.655333070349996e-05, -1.2525014215284683e-05, -7.830947471644772e-06,
      -2.820181509675051e-06, 2.1527099296415195e-06, 6.751948142511208e-06,
      1.0682478854085558e-05, 1.37081341913507e-05, 1.566496696660412e-05,
      1.6469073173367533e-05, 1.61186239861566e-05, 1.4690234311444992e-05,
      1.2330173503873153e-05, 9.241250789930803e-06, 5.666463405126388e-06,
      1.8706653816829527e-06, -1.8784082974227046e-06, -5.32844478429946e-06,
      -8.25897223944685e-06, -1.0494866355511983e-05, -1.191616110178469e-05,
      -1.2463666941401109e-05, -1.2140207051463576e-05, -1.1007588153551193e-05,
      -9.179706719781334e-06, -6.812435274802813e-06, -4.0911225491093e-06,
      -1.2166650370123657e-06, 1.6088393436016058e-06, 4.1958626769009445e-06,
      6.379735195774042e-06, 8.030684020473348e-06, 9.06104408454119e-06,
      9.429281234359223e-06, 9.140700320872678e-06, 8.244941912228404e-06,
      6.830584471592537e-06, 5.017350799364e-06, 2.9465573144446667e-06,
      7.705347885985229e-07, -1.3582143839621589e-06, -3.297374426589656e-06,
      -4.924009081872411e-06, -6.142018572956417e-06, -6.887433950781076e-06,
      -7.1312884544251475e-06, -6.879981874726828e-06, -6.173227906120401e-06,
      -5.079834397501091e-06, -3.691702059430216e-06, -2.116530456720561e-06,
      -4.6978548470692904e-07, 1.1334927079945248e-06, 2.586478050495866e-06,
      3.797433012365295e-06, 4.695244442574446e-06, 5.2333063178336425e-06,
      5.39156151856059e-06, 5.176648295157819e-06, 4.620228208909038e-06,
      3.7756922422381667e-06, 2.7135428469459657e-06, 1.5158259383493552e-06,
      2.700342099835254e-07, -9.370802559660286e-07, -2.0253599919451977e-06,
      -2.926380703916774e-06, -3.587558367285857e-06, -3.974993307311493e-06,
      -4.07491602803721e-06, -3.893700641642353e-06, -3.4565105300788263e-06,
      -2.8047307442904486e-06, -1.992416921017965e-06, -1.082046732257369e-06,
      -1.3989413238082815e-07, 7.686423858176833e-07, 1.5834383489283555e-06,
      2.253482643409539e-06, 2.739922649967632e-06, 3.0181448386242626e-06,
      3.0787937489151156e-06, 2.9277087737649668e-06, 2.584832556359236e-06,
      2.0822121441007827e-06, 1.4612700753359882e-06, 7.695640172810375e-07,
      5.7278282297336155e-08, -6.263023869237732e-07, -1.2360966265896194e-06,
      -1.7340938016135999e-06, -2.091610259421786e-06, -2.2908093174322443e-06,
      -2.3254155120220645e-06, -2.2006115014191007e-06, -1.9321620196341493e-06,
      -1.5448597073357248e-06, -1.0704293309856891e-06, -5.450574144736367e-07,
      -6.732088217148131e-09, 5.074176149542007e-07, 9.636024089657504e-07,
      1.3335132251534195e-06, 1.5959917957587586e-06, 1.738139468178314e-06,
      1.7558146996565956e-06, 1.6535134398770938e-06, 1.443668757557919e-06,
      1.1454438196843928e-06, 7.831233272907612e-07, 3.842309552735419e-07,
      -2.248689636595942e-08, -4.090680791104318e-07, -7.501966104677153e-07,
      -1.0247997954270131e-06, -1.2172842740030316e-06, -1.3183436258342537e-06,
      -1.3253023240157156e-06, -1.2419939095035742e-06, -1.0782029674323531e-06,
      -8.487287380171349e-07, -5.72151228205989e-07, -2.693971813682816e-07,
      3.7787608841528214e-08, 3.283516704153005e-07, 5.833348526591241e-07,
      7.870594637049487e-07, 9.280441227567049e-07, 9.995909915602367e-07,
      1.0000214749242014e-06, 9.325604784709992e-07, 8.048931602967197e-07,
      6.284392458762003e-07, 4.1740708235402153e-07, 1.8770171248401155e-07,
      -4.423224268079553e-08, -2.625513754185304e-07, -4.530612784168446e-07,
      -6.04104469325329e-07, -7.072355039970883e-07, -7.576471960222044e-07,
      -7.543304037002578e-07, -6.999687310010849e-07, -6.005874189215538e-07,
      -4.649915047794951e-07, -3.0404102437156617e-07, -1.2981990580444996e-07,
      4.524017313017006e-08, 2.0921943918777005e-07, 3.5149559896972817e-07,
      4.6340540772036987e-07, 5.387430049865293e-07, 5.740686641107063e-07,
      5.688156756576594e-07, 5.251973474897602e-07, 4.4792957962981285e-07,
      3.43796281720072e-07, 2.2109431949778848e-07, 8.90011744258952e-08,
      -4.308822990644906e-08, -1.6620911394826015e-07, -2.7241560227830727e-07,
      -3.5527339003162953e-07, -4.10227275256503e-07, -4.348243385095575e-07,
      -4.2878422766878766e-07, -3.9391877382591405e-07, -3.3391328821775165e-07,
      -2.5399071280317e-07, -1.6048677904338904e-07, -6.036908105748427e-08,
      3.9264729836424387e-08, 1.3167461613753732e-07, 2.1091923910588884e-07,
      2.722226527266482e-07, 3.1224512301747265e-07, 3.292440790890549e-07,
      3.2311929947713117e-07, 2.953445640633703e-07, 2.4879560546566726e-07,
      1.8749078199119734e-07, 1.1626606642411119e-07, 4.040941482101402e-08,
      -3.471881049965058e-08, -1.0405296363137858e-07, -1.6315243656347543e-07,
      -2.0847444438679388e-07, -2.3757339292904924e-07, -2.492166570932475e-07,
      -2.4341273684032604e-07, -2.2135388925834222e-07, -1.8528104367638217e-07,
      -1.3828372422783175e-07, -8.40515330935744e-08, -2.659627781018779e-08,
      3.003505478688531e-08, 8.203657859662363e-08, 1.2609078276008106e-07,
      1.5957134526768195e-07, 1.8068975506965737e-07, 1.8857836259342805e-07,
      1.8330713089265455e-07, 1.658359842290494e-07, 1.3790893511790878e-07,
      1.0189983955307448e-07, 6.06224624377938e-08, 1.711937722540603e-08,
      -2.5555004282274525e-08, -6.45422775503959e-08, -9.736507731111977e-08,
      -1.220777816651324e-07, -1.3737423071425551e-07, -1.4264711574307515e-07,
      -1.3799721963138425e-07, -1.241941760402931e-07, -1.0259362904848438e-07,
      -7.501841065636212e-08, -4.3613447139258955e-08, -1.0685443910179768e-08,
      2.1461073967062462e-08, 5.0680070873682215e-08, 7.512240065603578e-08,
      9.334772379397999e-08, 1.0440355765750461e-07, 1.0786759859956766e-07,
      1.0385212406749153e-07, 9.297191109155967e-08, 7.627951794029094e-08,
      5.517381478407013e-08, 3.1289195484679746e-08, 6.373873729878845e-09,
      -1.783397693081543e-08, -3.9723734075059606e-08, -5.7915803426937984e-08,
      -7.134468104993761e-08, -7.931689739128575e-08, -8.154105984542949e-08,
      -7.812923154589165e-08, -6.957086439489173e-08, -5.6682311359590574e-08,
      -4.053646208853172e-08, -2.2378187013089842e-08, -3.5319781413619583e-09,
      1.4691587944766797e-08, 3.108416260937139e-08, 4.461695846005386e-08,
      5.450235717136045e-08, 6.023633005271495e-08, 6.161967022796067e-08,
      5.875756492364836e-08, 5.203852800194218e-08, 4.209506702183104e-08,
      2.9749590154046143e-08, 1.594989965535287e-08, 1.6991264761972987e-09,
      -1.2014884276399558e-08, -2.428591926155651e-08, -3.4347166615563304e-08,
      -4.1616881029975516e-08, -4.572939877334729e-08, -4.6550068009990606e-08,
      -4.4173817089296205e-08, -3.8908206665219455e-08, -3.1242825888419266e-08,
      -2.1807734625327467e-08, -1.132427347290175e-08, -5.519293414794379e-10,
      9.764956655984932e-09, 1.8947014839755924e-08, 2.642298306010206e-08,
      3.176353169211034e-08, 3.470390786982836e-08, 3.5154373694178984e-08,
      3.3198288489852034e-08, 2.9078530648996003e-08, 2.3173714169343685e-08,
      1.596628104941733e-08, 8.005006862445334e-09, -1.3528009202209032e-10,
      -7.89390468425942e-09, -1.4761750540703717e-08, -2.031345472695903e-08,
      -2.423244490287219e-08, -2.6327447181903318e-08, -2.653973458202746e-08,
      -2.4941047802745284e-08, -2.1722756258702706e-08, -1.71773958398476e-08,
      -1.1674185259837566e-08, -5.630458232063706e-09, 5.188627368697895e-10,
      6.351589501578732e-09, 1.1486339629114971e-08, 1.5606553772602612e-08,
      1.847901450106995e-08, 1.996586130724104e-08, 2.0029583930788535e-08,
      1.8730976394756796e-08, 1.6220512716985173e-08, 1.2724030638857043e-08,
      8.52395547341893e-09, 3.937542490295759e-09, -7.062490412871335e-10,
      -5.089617972987343e-09, -8.926979974353774e-09, -1.1982876066284595e-08,
      -1.408565967721798e-08, -1.5136226442228566e-08, -1.5111421083446682e-08,
      -1.4062133710269932e-08, -1.2106457744057934e-08, -9.418599809916408e-09,
      -6.214488665054247e-09, -2.735210934928625e-09, 7.705026805703159e-10,
      4.063508615714992e-09, 6.930042505050793e-09, 9.195066146230868e-09,
      1.0732375379195462e-08, 1.1470931069695272e-08, 1.1397156333335099e-08,
      1.0553228662377771e-08, 9.031666133278785e-09, 6.966744705167333e-09,
      4.5234741220191814e-09, 1.884992340311733e-09, -7.606936089084375e-10,
      -3.2336905158910486e-09, -5.374057132830174e-09, -7.051746482221981e-09,
      -8.174064294175725e-09, -8.690251022359861e-09, -8.5930080741183e-09,
      -7.917004494773847e-09, -6.7346036254295535e-09, -5.149226975025007e-09,
      -3.286913818459492e-09, -1.2867319330317595e-09, 7.092571310999404e-10,
      2.565776802587235e-09, 4.163206288602824e-09, 5.4049829043385216e-09,
      6.2231007276144945e-09, 6.5814194909239155e-09, 6.476659333848626e-09,
      5.9371197913978384e-09, 5.019314094690765e-09, 3.8028426056128014e-09,
      2.383933900288311e-09, 8.681528354637647e-10, -6.371913793476456e-10,
      -2.030408110305516e-09, -3.2220699824123024e-09, -4.140521205867812e-09,
      -4.7359276907929275e-09, -4.982660792141824e-09, -4.8799291485224365e-09,
      -4.450695895023655e-09, -3.7390331965182515e-09, -2.80616515475489e-09,
      -1.7255276754252267e-09, -5.772255652873027e-10, 5.57709360668578e-10,
      1.6028603525582997e-09, 2.4914009804132885e-09, 3.1701918346187026e-09,
      3.6027608282256085e-09, 3.771015910869884e-09, 3.675631953785837e-09,
      3.3351462147926364e-09, 2.7838828667564543e-09, 2.068901031824247e-09,
      1.2462181414716762e-09, 3.7659810357221994e-10, -4.787899516128355e-10,
      -1.262541782193967e-09, -1.924741806515173e-09, -2.426008225957891e-09,
      -2.739683878638788e-09, -2.8530632194450246e-09, -2.767616255521824e-09,
      -2.4982401356558402e-09, -2.0716336807529664e-09, -1.5239453087579956e-09,
      -8.97887237918418e-10, -2.3953625023162445e-10, 4.049475094148669e-10,
      9.924572517447924e-10, 1.4857255003152673e-09, 1.8555862536708396e-09,
      2.0825837864110984e-09, 2.1578487956261286e-09, 2.083215952952411e-09,
      1.8706095954917154e-09, 1.5407727372364475e-09, 1.1214557115555877e-09,
      6.452121082064145e-10, 1.4696956464366423e-10, -3.384494150411484e-10,
      -7.786860641064579e-10, -1.1459288181860906e-09, -1.4185928256340627e-09,
      -1.5824999983164172e-09, -1.6315023665435406e-09, -1.5675319039670607e-09,
      -1.4000996842282441e-09, -1.145303559074535e-09, -8.244341960825929e-10,
      -4.6229246280284263e-10, -8.53455651350694e-11, 2.8014553834187013e-10,
      6.09899038742908e-10, 8.831697297720954e-10, 1.0839951647810826e-09,
      1.2020601850903953e-09, 1.2331386062115305e-09, 1.1791014328672307e-09,
      1.0475108799017252e-09, 8.508467055858307e-10, 6.054341908678476e-10,
      3.301601749633721e-10, 4.507398842079901e-11, -2.300264943833331e-10,
      -4.769270373426057e-10, -6.801607850788965e-10, -8.279322895938975e-10,
      -9.127500759708462e-10, -9.317381512716038e-10, -8.866200052421148e-10,
      -7.833911747271546e-10, -6.31716845564027e-10, -4.441079585643317e-10,
      -2.3494187268292234e-10, -1.9401165989006375e-11, 1.8759365581190023e-10,
      3.723848271098478e-10, 5.234464992824026e-10, 6.320694521482903e-10,
      6.928233091095928e-10, 7.037750662117074e-10, 6.664602539990281e-10,
      5.856200083764057e-10, 4.687326070292335e-10, 3.2538067096186056e-10,
      1.6650449897841207e-10, 3.597421832365791e-12, -1.5209955933327937e-10,
      -2.903491573557163e-10, -4.0256667940342543e-10, -4.823270539375079e-10,
      -5.257020830846484e-10, -5.314127994894867e-10, -5.007950475323069e-10,
      -4.3758917135057476e-10, -3.4757613207570457e-10, -2.380917781730761e-10,
      -1.1745781094938165e-10, 5.628122379045537e-12, 1.2269994324657502e-10,
      2.2608714118644547e-10, 3.0939897049297524e-10, 3.6789963310572173e-10,
      3.9875397215196454e-10, 4.011329259823341e-10, 3.761780025381272e-10,
      3.2683363609276055e-10, 2.575648497692009e-10, 1.7398463431449932e-10,
      8.242046423184898e-11, -1.0547843104194675e-11, -9.854624841821731e-11,
      -1.7582968271335814e-10, -2.376431867305003e-10, -2.804993264251371e-10,
      -3.023568872008942e-10, -3.026932361217589e-10, -2.824703063655853e-10,
      -2.440013801672754e-10, -1.9073225097005426e-10, -1.2695553519165527e-10,
      -5.7480582278792364e-11, 1.2716581917927153e-11, 7.883860636249857e-11,
      1.3658423685481374e-10, 1.8241754329520257e-10, 2.1377288493196445e-10,
      2.2918464301654553e-10, 2.283363583398272e-10, 2.1202962651676658e-10,
      1.8207853380788296e-10, 1.4114020524686334e-10, 9.249588918215684e-11,
      3.9799699435964736e-11, -1.3186452054962949e-11, -6.285311001719783e-11,
      -1.0598127467365875e-10, -1.399430099547784e-10, -1.628527566525348e-10,
      -1.7366133647324057e-10, -1.7218888923654954e-10, -1.59097302041451e-10,
      -1.358067703494942e-10, -1.0436471040690491e-10, -6.727810025546037e-11,
      -2.7322301825988664e-11, 1.265958440726959e-11, 4.995278113844603e-11,
      8.214921527257032e-11, 1.0729692054648684e-10, 1.2401164770991891e-10,
      1.3154483654284603e-10, 1.2980533320859732e-10, 1.1933549548619884e-10,
      1.0124539473362458e-10, 7.711149771352319e-11, 4.8848330098788885e-11,
      1.856306819383724e-11, -1.1596291055680799e-11, -3.958858317124535e-11,
      -6.361312222809007e-11, -8.222091024601509e-11, -9.439688871869636e-11,
      -9.960897488883441e-11, -9.782207451508183e-11, -8.947772267511044e-11,
      -7.544230717234059e-11, -5.6928826228502555e-11, -3.539870180318808e-11,
      -1.245122511100333e-11, 1.0291296372796934e-11, 3.129469861818387e-11,
      4.921305200885194e-11, 6.297139684687268e-11, 7.182630225418128e-11,
      7.540115306909973e-11, 7.369492619376025e-11, 6.706507380079841e-11,
      5.618685993235491e-11, 4.199298776835791e-11, 2.559851693473453e-11,
      8.216839832228808e-12, -8.927171181647713e-12, -2.468082157332774e-11,
      -3.803852569342853e-11, -4.8203324835867474e-11, -5.463143079338989e-11,
      -5.7057548438293966e-11, -5.550013818430205e-11, -5.024717906960804e-11,
      -4.182429097211907e-11, -3.0948186718128875e-11, -1.846928457533183e-11,
      -5.3078720348401156e-12, 7.611551454751712e-12, 1.9423213294340943e-11,
      2.9376140795530874e-11, 3.6879876960008654e-11, 4.15372101577702e-11,
      4.3162290544514954e-11, 4.178357232038055e-11, 3.7632076472655745e-11,
      3.111644231491176e-11, 2.2787065597055204e-11, 1.3292256517887012e-11,
      3.329758361032548e-12, -6.402870512618971e-12, -1.5255591715498856e-11,
      -2.266783074460414e-11, -2.82024296927115e-11, -3.156967003701928e-11,
      -3.26401894412393e-11, -3.14464240880596e-11, -2.8173003695815865e-11,
      -2.3137256612535234e-11, -1.6761600653117134e-11, -9.540064812268483e-12,
      -2.0014825930586193e-12, 5.327992668941427e-12, 1.1960475364898718e-11,
      1.7477709523852787e-11, 2.15562698886272e-11, 2.3985173657009396e-11,
      2.4675054844160673e-11, 2.3658664674402108e-11, 2.108306094162263e-11,
      1.719439674268357e-11, 1.2316679613133559e-11, 6.826218590142087e-12,
      1.1236907993384846e-12, -4.394167659505884e-12, -9.361307987957539e-12,
      -1.3465808359090546e-11, -1.6468567427002422e-11, -1.8216200114546284e-11,
      -1.864752572843256e-11, -1.779350125162508e-11, -1.5770904274149575e-11,
      -1.2770480306058556e-11, -9.040612215441142e-12, -4.867825049303683e-12,
      -5.555941870725424e-13, 3.59702724017781e-12, 7.315502830795778e-12,
      1.0367323957884823e-11, 1.2575867110663394e-11, 1.3829824214712287e-11,
      1.4087768462546484e-11, 1.3377768357998703e-11, 1.1792302751724896e-11,
      9.47903700188887e-12, 6.628275670410215e-12, 3.4580954184603765e-12,
      1.9827328517318335e-13, -2.9258437369920127e-12, -5.708430366951674e-12,
      -7.976259194857127e-12, -9.598966078778441e-12, -1.0495936676485788e-11,
      -1.0639501330289853e-11, -1.0054390388366746e-11, -8.8136580439343e-12,
      -7.031512935159527e-12, -4.853683634840626e-12, -2.4460857249933826e-12,
      1.7362658755229937e-14, 2.3669108859435455e-12, 4.448306166150872e-12,
      6.132553590308545e-12, 7.323515314308172e-12, 7.962932001742401e-12,
      8.032643670339738e-12, 7.553987361388285e-12, 6.584541694624153e-12,
      5.212560657135542e-12, 3.5495801421860238e-12, 1.7217826453376303e-12,
      -1.3923697737767775e-13, -1.9056505522230887e-12, -3.461899972631175e-12,
      -4.711978715252807e-12, -5.585053198239232e-12, -6.039118423358546e-12,
      -6.0625297389930124e-12, -5.673403946602383e-12, -4.9170278917074264e-12,
      -3.861541592102029e-12, -2.5922678440009047e-12, -1.2051350916578943e-12,
      2.003185573889997e-13, 1.5278661858758594e-12, 2.6909715064296437e-12,
      3.6182186864674435e-12, 4.2574674865921925e-12, 4.578510028624562e-12,
      4.57411743955375e-12, 4.259479010927295e-12, 3.67014549292025e-12,
      2.8586845597481768e-12, 1.890334369156492e-12, 8.379960552303692e-13,
      -2.2306473544263376e-13, -1.2204343422891225e-12, -2.0893353290442195e-12,
      -2.7766735332550312e-12, -3.244106984498736e-12, -3.4699731598842948e-12,
      -3.4499960132488284e-12, -3.1967806265044925e-12, -2.7381852569422467e-12,
      -2.114732637956014e-12, -1.3762801906064764e-12, -5.782090503858148e-13,
      2.225874209143024e-13, 9.716342021290074e-13, 1.620461192357281e-12,
      2.1296181210556992e-12, 2.4709393239498344e-12, 2.628938998107055e-12,
      2.601282027035384e-12, 2.3983407205513407e-12, 2.041909380069121e-12,
      1.563202468158807e-12, 1.000305027880388e-12, 3.9527345655421947e-13,
      -2.0890059562848111e-13, -7.712508778756114e-13, -1.2555242538933488e-12,
      -1.632425552697753e-12, -1.881287460839984e-12, -1.99107842870419e-12,
      -1.960710474908227e-12, -1.7986580330795824e-12, -1.5219452351200056e-12
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.5048105091118545, -0.37823861094560995, -0.2876748537956697, -0.15613374894903925,
      -0.03048756041177411, 0.06167155744196949, 0.11110981885566533, 0.12199339636843134,
      0.10567783214945649, 0.07523400250735832, 0.04173640098759619, 0.01250820775153691,
      -0.009032718860021091, -0.022529661158922694, -0.029450625816960996,
      -0.031920467511469805, -0.031882422723116054, -0.030665347362342908,
      -0.02890247868482879, -0.026681592595168772, -0.02379570043962815,
      -0.019988906847605747, -0.01513341608772325, -0.009314734652736183,
      -0.0028330915738507593, 0.0038535417874598597, 0.010214584363564318,
      0.015733839508493993, 0.019980505330682637, 0.022655592821032886, 0.02361274708573779,
      0.022857362537543786, 0.020530065206296712, 0.016880741954503002,
      0.012238194373978134, 0.006978976792642707, 0.0014975962497113188,
      -0.00382071840015632, -0.008623990571209956, -0.01261370149476075,
      -0.015560714512085932, -0.017316383565248325, -0.01781837428054403,
      -0.01709091665836239, -0.015239515015787646, -0.012440516107529704,
      -0.008926318362839128, -0.004967335130347678, -0.0008520584802800864,
      0.00313331729506585, 0.006724267399677286, 0.009694989022547914, 0.011872046513187923,
      0.013143816460115644, 0.013465275334563128, 0.012858019995547023,
      0.011405745836071842, 0.009245706998742678, 0.006556930444697934,
      0.0035461378295156896, 0.00043243801275138073, -0.0025681146089462027,
      -0.005257043245341444, -0.007466111686080363, -0.00906735463765542,
      -0.009979916436850391, -0.010173380700550514, -0.009667525605136885,
      -0.00852868470838105, -0.006863115218453712, -0.004807960332892568,
      -0.0025205288194010684, -0.00016669626406272224, 0.0020907446599339494,
      0.004102991861182305, 0.0057446930032125304, 0.006921380376678182,
      0.007574469420135016, 0.007683593076992286, 0.007266235445184865,
      0.006374813166436505, 0.005091519443383609, 0.003521383018473571,
      0.0017840948992382812, 5.213948351196029e-06, -0.0016926233557205568,
      -0.0031978925819557383, -0.004417242082666071, -0.005280997248611745,
      -0.005746805932321332, -0.005801262681939507, -0.005459494034577392,
      -0.004762826312878017, -0.003774781951961143, -0.0025757525691586457,
      -0.0012567708654568272, 8.71547034785726e-05, 0.0013636701023208527,
      0.0024892223536691757, 0.003394327589404795, 0.004027643173395088,
      0.004358622242039131, 0.00437863536329943, 0.004100553327917376,
      0.0035568898039394863, 0.00279669581055468, 0.0018814738982261925,
      0.0008804341970652248, -0.00013455557838767555, -0.0010939694192871115,
      -0.0019352346242108654, -0.0026066604613182334, -0.003070448501117378,
      -0.003304622328234235, -0.003303795108764235, -0.0030787760952292417,
      -0.0026550959033301994, -0.0020706001249634655, -0.0013723172305604905,
      -0.0006128465440893975, 0.00015346659960063411, 0.0008742991837337651,
      0.0015028091530901323, 0.0020005638032586435, 0.0023397634281485348,
      0.0025046415534469846, 0.002491984399261822, 0.002310774617903144,
      0.001981023557596879, 0.001531908437962754, 0.0009993726734044773,
      0.0004233767763621912, -0.00015499758882075255, -0.0006963871331221615,
      -0.0011657399131225358, -0.0015344970404897894, -0.0017822338756874306,
      -0.0018976740503189521, -0.0018790361940059824, -0.001733720367244388,
      -0.0014773856956819377, -0.0011325096643047745, -0.0007265505707571585,
      -0.0002898560112115088, 0.00014652902850089585, 0.0005530011170996093,
      0.0009033416101091066, 0.0011763412376840008, 0.0013570103671408625,
      0.0014373117578610518, 0.001416387925905399, 0.0013002908125308802,
      0.0011012548775265589, 0.0008365838445928336, 0.0005272443341124927,
      0.00019627524607418922, -0.00013287072030433242, -0.00043793774338316693,
      -0.0006993226225616855, -0.0009012838760080417, -0.0010328334167445691,
      -0.001088264813230235, -0.0010672989102828634, -0.000974854435715033,
      -0.0008204763214792056, -0.0006174762015503077, -0.00038185659136555236,
      -0.0001311016633476292, 0.00011707720677403426, 0.0003459539130813187,
      0.0005408777420151079, 0.0006901727558631582, 0.0007857941235209328,
      0.0008237079746790336, 0.0008039816475441139, 0.0007305914566787814,
      0.00061097395345094, 0.0004553628723812389, 0.000275966571576808,
      8.604909326058745e-05, -0.00010101837676044405, -0.00027266991845791363,
      -0.00041796088353558404, -0.0005282365265838777, -0.0005976146247547967,
      -0.0006232578418619791, -0.0006054269722788831, -0.0005473214773922703,
      -0.00045472787045836775, -0.00033550860651190514, -0.00019897346465861542,
      -5.518146411790558e-05, 8.577612818343037e-05, 0.00021446217075201467,
      0.00032270421810284936, 0.0004040913176969963, 0.00045432852149332795,
      0.00047143156195321673, 0.00045575579348257177, 0.0004098650186795831,
      0.0003382564286972998, 0.0002469669099959103, 0.0001430928659750325,
      3.426010070829659e-05, -7.191797101323989e-05, -0.00016835648170741746,
      -0.0002489557783426974, -0.0003089703266146584, -0.0003452688305317557,
      -0.000356472890647595, -0.0003429703479534403, -0.0003068081418733803,
      -0.00025147746728306153, -0.0001816107401644501, -0.00010261497437044753,
      -2.0269362019021184e-05, 5.968399217416361e-05, 0.00013192809237093904,
      0.00019191246583577444, 0.00023612693065750654, 0.0002622922316124081,
      0.000269458409573892, 0.0002580084500063667, 0.00022957129713061653,
      0.0001868542847364875, 0.0001334100439273522, 7.335670602864793e-05,
      1.1072527686003636e-05, -4.911316557146515e-05, -0.00010321157308349444,
      -0.00014782955861646606, -0.00018037268738243153, -0.0001991847644236833,
      -0.00020361730939930613, -0.00019402745844694029, -0.00017170771053394033,
      -0.0001387554050756923, -9.789354717644033e-05, -5.2257367362840775e-05,
      -5.162669981375557e-06, 4.012747416199775e-05, 8.06217805100555e-05,
      0.00011379133389219985, 0.00013772006985487652, 0.0001512067759345335,
      0.00015381390834986168, 0.00014586234451299682, 0.00012837490136135968,
      0.00010297479729779753, 7.174801083721836e-05, 3.708052972691388e-05,
      1.4826854498940529e-06, -3.25869134712772e-05, -6.288588130839585e-05,
      -8.75303527152778e-05, -0.00010510643620959261, -0.00011474467052043746,
      -0.00011615412332918757, -0.00010961566478253054, -9.593674037531506e-05,
      -7.637247448284863e-05, -5.2519999903748385e-05, -2.6194410417890334e-05,
      7.044036117376582e-07, 2.6324581511383586e-05, 4.898578095275075e-05,
      6.728537504582968e-05, 8.018094145948067e-05, 8.704452982882333e-05,
      8.768631566375025e-05, 8.2347436163607e-05, 7.166390433890218e-05,
      5.660537399064099e-05, 3.839406235506492e-05, 1.8410241099914537e-05,
      -1.9086753696202644e-06, -2.116830241343226e-05, -3.810995355097892e-05,
      -5.1689858684492786e-05, -6.114017103339921e-05, -6.600845552631466e-05,
      -6.617396319979265e-05, -6.184064927417722e-05, -5.350847292800999e-05,
      -4.192592044426707e-05, -2.8027833173325696e-05, -1.2863432366858979e-05,
      2.480125570770968e-06, 1.6953270565894154e-05, 2.961353367261248e-05,
      3.968461204393823e-05, 4.6601453478305664e-05, 5.003894035082166e-05,
      4.9922976596071055e-05, 4.642403046135344e-05, 3.993437406948528e-05,
      3.1031310546020216e-05, 2.0429525674601176e-05, 8.926295625697762e-06,
      -2.6564035823525412e-06, -1.3528814070718947e-05, -2.298552299533147e-05,
      -3.044947971011038e-05, -3.5505286821759485e-05, -3.7919996463553693e-05,
      -3.765057207079083e-05, -3.483811938084398e-05, -2.9789883611645077e-05,
      -2.295079446754835e-05, -1.4866968489699136e-05, -6.144013871694423e-06,
      2.596794566512954e-06, 1.0761398371056321e-05, 1.782202903563524e-05,
      2.334999454529151e-05, 2.7040241329543712e-05, 2.872640093555561e-05,
      2.838573559613437e-05, 2.6134109238656604e-05, 2.2211781667120785e-05,
      1.6961409981345675e-05, 1.0800106863082458e-05, 4.18772408636314e-06,
      -2.406313414393837e-06, -8.535305612812643e-06, -1.380455522658419e-05,
      -1.7895776423764302e-05, -2.0585200572739102e-05, -2.17544386015582e-05,
      -2.1393694175724407e-05, -1.9597459624022472e-05, -1.6553330703503413e-05,
      -1.2525014215289024e-05, -7.830947471649672e-06, -2.8201815096801533e-06,
      2.152709929636573e-06, 6.751948142506754e-06, 1.0682478854081887e-05,
      1.3708134191348043e-05, 1.5664966966602622e-05, 1.646907317336725e-05,
      1.611862398615749e-05, 1.4690234311446937e-05, 1.2330173503875962e-05,
      9.241250789934228e-06, 5.6664634051301525e-06, 1.8706653816867729e-06,
      -1.878408297419098e-06, -5.328444784296307e-06, -8.258972239444344e-06,
      -1.0494866355510265e-05, -1.1916161101783844e-05, -1.2463666941401158e-05,
      -1.2140207051464477e-05, -1.1007588153552845e-05, -9.179706719783588e-06,
      -6.812435274805493e-06, -4.091122549112204e-06, -1.216665037015282e-06,
      1.6088393435988784e-06, 4.195862676898586e-06, 6.379735195772202e-06,
      8.03068402047213e-06, 9.061044084540655e-06, 9.429281234359383e-06,
      9.140700320873496e-06, 8.244941912229803e-06, 6.830584471594404e-06,
      5.0173507993661905e-06, 2.946557314447019e-06, 7.705347886008691e-07,
      -1.3582143839599807e-06, -3.2973744265877906e-06, -4.924009081870976e-06,
      -6.142018572955494e-06, -6.8874339507807094e-06, -7.131288454425342e-06,
      -6.8799818747275465e-06, -6.1732279061215685e-06, -5.079834397502607e-06,
      -3.6917020594319602e-06, -2.116530456722405e-06, -4.697854847087438e-07,
      1.133492707992861e-06, 2.58647805049446e-06, 3.797433012364232e-06,
      4.6952444425737865e-06, 5.2333063178334155e-06, 5.391561518560796e-06,
      5.17664829515843e-06, 4.6202282089100015e-06, 3.775692242239406e-06,
      2.713542846947388e-06, 1.515825938350856e-06, 2.7003420998499795e-07,
      -9.370802559646859e-07, -2.0253599919440736e-06, -2.926380703915938e-06,
      -3.5875583672853544e-06, -3.9749933073113435e-06, -4.074916028037408e-06,
      -3.89370064164287e-06, -3.456510530079609e-06, -2.8047307442914278e-06,
      -1.9924169210190617e-06, -1.0820467322585014e-06, -1.3989413238191744e-07,
      7.686423858167095e-07, 1.5834383489275578e-06, 2.2534826434089635e-06,
      2.739922649967308e-06, 3.018144838624202e-06, 3.0787937489153117e-06,
      2.927708773765397e-06, 2.5848325563598625e-06, 2.0822121441015543e-06,
      1.4612700753368458e-06, 7.695640172819189e-07, 5.7278282298179164e-08,
      -6.263023869230253e-07, -1.2360966265890142e-06, -1.7340938016131734e-06,
      -2.09161025942156e-06, -2.290809317432225e-06, -2.325415512022244e-06,
      -2.2006115014194573e-06, -1.9321620196346516e-06, -1.544859707336333e-06,
      -1.0704293309863578e-06, -5.450574144743185e-07, -6.7320882177967465e-09,
      5.074176149536277e-07, 9.636024089652887e-07, 1.333513225153096e-06,
      1.5959917957585896e-06, 1.738139468178305e-06, 1.7558146996567411e-06,
      1.6535134398773782e-06, 1.443668757558319e-06, 1.1454438196848781e-06,
      7.831233272912965e-07, 3.842309552740899e-07, -2.2486896365435955e-08,
      -4.090680791099674e-07, -7.501966104673394e-07, -1.024799795426748e-06,
      -1.2172842740028906e-06, -1.3183436258342407e-06, -1.3253023240158251e-06,
      -1.2419939095037925e-06, -1.0782029674326606e-06, -8.48728738017507e-07,
      -5.721512282063981e-07, -2.69397181368699e-07, 3.7787608841130955e-08,
      3.283516704149495e-07, 5.833348526588414e-07, 7.870594637047508e-07,
      9.280441227566016e-07, 9.995909915602312e-07, 1.0000214749242901e-06,
      9.325604784711724e-07, 8.048931602969622e-07, 6.28439245876492e-07,
      4.174070823543396e-07, 1.8770171248433183e-07, -4.423224268049621e-08,
      -2.625513754182726e-07, -4.5306127841664475e-07, -6.041044693251983e-07,
      -7.072355039970324e-07, -7.576471960222239e-07, -7.543304037003481e-07,
      -6.999687310012369e-07, -6.005874189217544e-07, -4.6499150477972844e-07,
      -3.04041024371815e-07, -1.2981990580469708e-07, 4.5240173129940776e-08,
      2.0921943918757295e-07, 3.5149559896957486e-07, 4.6340540772026844e-07,
      5.387430049864844e-07, 5.740686641107185e-07, 5.688156756577256e-07,
      5.251973474898738e-07, 4.4792957962996415e-07, 3.437962817202493e-07,
      2.2109431949797906e-07, 8.900117442608588e-08, -4.308822990627094e-08,
      -1.6620911394810596e-07, -2.724156022781863e-07, -3.552733900315483e-07,
      -4.102272752564652e-07, -4.348243385095637e-07, -4.287842276688355e-07,
      -3.9391877382599854e-07, -3.3391328821786563e-07, -2.539907128033044e-07,
      -1.6048677904353378e-07, -6.0369081057629e-08, 3.9264729836289497e-08,
      1.3167461613742096e-07, 2.10919239105798e-07, 2.722226527265879e-07,
      3.1224512301744565e-07, 3.292440790890617e-07, 3.231192994771698e-07,
      2.95344564063437e-07, 2.4879560546575647e-07, 1.8749078199130221e-07,
      1.1626606642422395e-07, 4.0409414821126545e-08, -3.471881049954612e-08,
      -1.0405296363128907e-07, -1.6315243656340642e-07, -2.0847444438674922e-07,
      -2.3757339292903084e-07, -2.492166570932552e-07, -2.434127368403581e-07,
      -2.2135388925839521e-07, -1.8528104367645147e-07, -1.3828372422791187e-07,
      -8.405153309365947e-08, -2.6596277810271963e-08, 3.0035054786807576e-08,
      8.203657859655723e-08, 1.2609078276002992e-07, 1.5957134526764886e-07,
      1.806897550696438e-07, 1.88578362593434e-07, 1.833071308926787e-07,
      1.658359842290893e-07, 1.3790893511796106e-07, 1.0189983955313518e-07,
      6.06224624378586e-08, 1.711937722547047e-08, -2.5555004282214723e-08,
      -6.454227755034457e-08, -9.736507731108004e-08, -1.220777816651065e-07,
      -1.3737423071424466e-07, -1.4264711574307944e-07, -1.3799721963140273e-07,
      -1.241941760403239e-07, -1.0259362904852485e-07, -7.501841065640904e-08,
      -4.3613447139308744e-08, -1.068544391022883e-08, 2.1461073967017513e-08,
      5.068007087364432e-08, 7.512240065600722e-08, 9.334772379396231e-08,
      1.0440355765749856e-07, 1.0786759859957318e-07, 1.038521240675078e-07,
      9.297191109158519e-08, 7.627951794032366e-08, 5.5173814784107586e-08,
      3.128919548471928e-08, 6.373873729917742e-09, -1.783397693077974e-08,
      -3.9723734075029385e-08, -5.7915803426915035e-08, -7.134468104992318e-08,
      -7.931689739128047e-08, -8.154105984543336e-08, -7.812923154590407e-08,
      -6.957086439491153e-08, -5.668231135961609e-08, -4.0536462088560956e-08,
      -2.2378187013120647e-08, -3.5319781413921735e-09, 1.4691587944739183e-08,
      3.108416260934813e-08, 4.461695846003634e-08, 5.450235717134962e-08,
      6.023633005271127e-08, 6.161967022796408e-08, 5.875756492365832e-08,
      5.2038528001957733e-08, 4.2095067021850855e-08, 2.974959015406867e-08,
      1.5949899655376435e-08, 1.6991264762202215e-09, -1.2014884276378837e-08,
      -2.4285919261539317e-08, -3.4347166615550665e-08, -4.1616881029968105e-08,
      -4.5729398773345395e-08, -4.655006800999414e-08, -4.417381708930473e-08,
      -3.890820666523222e-08, -3.1242825888435274e-08, -2.180773462534552e-08,
      -1.132427347292055e-08, -5.519293414976888e-10, 9.764956655968443e-09,
      1.8947014839742242e-08, 2.6422983060091997e-08, 3.1763531692104426e-08,
      3.470390786982682e-08, 3.515437369418176e-08, 3.3198288489858784e-08,
      2.9078530649006115e-08, 2.317371416935633e-08, 1.5966281049431535e-08,
      8.005006862460057e-09, -1.3528009200786612e-10, -7.893904684246635e-09,
      -1.4761750540693172e-08, -2.031345472695134e-08, -2.4232444902867755e-08,
      -2.6327447181902312e-08, -2.653973458202982e-08, -2.4941047802750733e-08,
      -2.172275625871077e-08, -1.7177395839857634e-08, -1.1674185259848819e-08,
      -5.630458232075366e-09, 5.188627368585349e-10, 6.351589501568638e-09,
      1.1486339629106684e-08, 1.5606553772596633e-08, 1.84790145010666e-08,
      1.9965861307240436e-08, 2.00295839307906e-08, 1.873097639476127e-08,
      1.622051271699163e-08, 1.272403063886494e-08, 8.523955473427661e-09,
      3.9375424903046905e-09, -7.062490412786227e-10, -5.089617972979817e-09,
      -8.926979974347705e-09, -1.198287606628033e-08, -1.4085659677215726e-08,
      -1.513622644222838e-08, -1.511142108344849e-08, -1.4062133710273522e-08,
      -1.2106457744062993e-08, -9.41859980992254e-09, -6.214488665061003e-09,
      -2.73521093493553e-09, 7.705026805637332e-10, 4.0635086157091646e-09,
      6.9300425050460865e-09, 9.195066146227554e-09, 1.0732375379193705e-08,
      1.1470931069695118e-08, 1.1397156333336487e-08, 1.0553228662380539e-08,
      9.031666133282683e-09, 6.966744705172046e-09, 4.523474122024351e-09,
      1.884992340316984e-09, -7.606936089034711e-10, -3.233690515886695e-09,
      -5.374057132826705e-09, -7.051746482219595e-09, -8.174064294174542e-09,
      -8.690251022359914e-09, -8.593008074119533e-09, -7.917004494776117e-09,
      -6.734603625432657e-09, -5.149226975028691e-09, -3.2869138184634783e-09,
      -1.2867319330357606e-09, 7.092571310961979e-10, 2.5657768025839936e-09,
      4.163206288600281e-09, 5.4049829043368176e-09, 6.223100727613707e-09,
      6.5814194909240586e-09, 6.476659333849652e-09, 5.9371197913996425e-09,
      5.019314094693194e-09, 3.80284260561567e-09, 2.3839339002914112e-09,
      8.681528354668786e-10, -6.371913793447306e-10, -2.0304081103029916e-09,
      -3.222069982410326e-09, -4.140521205866495e-09, -4.735927690792331e-09,
      -4.982660792141956e-09, -4.879929148523256e-09, -4.4506958950250755e-09,
      -3.73903319652015e-09, -2.806165154757119e-09, -1.7255276754276247e-09,
      -5.772255652897027e-10, 5.577093606663363e-10, 1.6028603525563604e-09,
      2.49140098041177e-09, 3.17019183461769e-09, 3.6027608282251503e-09,
      3.77101591086999e-09, 3.675631953786478e-09, 3.3351462147937448e-09,
      2.783882866757932e-09, 2.068901031825975e-09, 1.246218141473525e-09,
      3.7659810357405876e-10, -4.787899516111296e-10, -1.2625417821925025e-09,
      -1.9247418065140373e-09, -2.4260082259571462e-09, -2.739683878638467e-09,
      -2.8530632194451297e-09, -2.767616255522328e-09, -2.49824013565669e-09,
      -2.0716336807540877e-09, -1.5239453087592985e-09, -8.978872379198056e-10,
      -2.3953625023299943e-10, 4.049475094135957e-10, 9.924572517437046e-10,
      1.485725500314427e-09, 1.8555862536702924e-09, 2.0825837864108685e-09,
      2.157848795626217e-09, 2.0832159529527983e-09, 1.8706095954923627e-09,
      1.5407727372373e-09, 1.1214557115565789e-09, 6.452121082074713e-10,
      1.4696956464471185e-10, -3.384494150401809e-10, -7.786860641056331e-10,
      -1.1459288181854587e-09, -1.4185928256336582e-09, -1.5824999983162574e-09,
      -1.6315023665436248e-09, -1.5675319039673715e-09, -1.40009968422875e-09,
      -1.1453035590751927e-09, -8.244341960833516e-10, -4.6229246280364645e-10,
      -8.534556513586215e-11, 2.8014553834114134e-10, 6.098990387422896e-10,
      8.831697297716245e-10, 1.083995164780785e-09, 1.2020601850902843e-09,
      1.2331386062116062e-09, 1.1791014328674803e-09, 1.0475108799021239e-09,
      8.508467055863446e-10, 6.054341908684361e-10, 3.3016017496399157e-10,
      4.507398842140554e-11, -2.3002649438278024e-10, -4.769270373421417e-10,
      -6.801607850785488e-10, -8.279322895936841e-10, -9.127500759707757e-10,
      -9.31738151271675e-10, -8.866200052423169e-10, -7.833911747274685e-10,
      -6.317168455644269e-10, -4.4410795856478636e-10, -2.349418726833981e-10,
      -1.9401165989469545e-11, 1.8759365581148085e-10, 3.7238482710949895e-10,
      5.234464992821449e-10, 6.32069452148137e-10, 6.928233091095496e-10,
      7.037750662117723e-10, 6.66460253999192e-10, 5.856200083766527e-10,
      4.687326070295425e-10, 3.2538067096220684e-10, 1.6650449897876972e-10,
      3.597421832709588e-12, -1.5209955933297223e-10, -2.903491573554648e-10,
      -4.0256667940324397e-10, -4.823270539374055e-10, -5.257020830846284e-10,
      -5.314127994895468e-10, -5.007950475324399e-10, -4.3758917135076853e-10,
      -3.475761320759432e-10, -2.3809177817334157e-10, -1.1745781094965483e-10,
      5.628122378783605e-12, 1.2269994324634178e-10, 2.2608714118625568e-10,
      3.093989704928401e-10, 3.678996331056482e-10, 3.987539721519551e-10,
      4.011329259823867e-10, 3.7617800253823573e-10, 3.268336360929151e-10,
      2.575648497693888e-10, 1.7398463431470632e-10, 8.242046423206001e-11,
      -1.0547843103994291e-11, -9.854624841804089e-11, -1.7582968271321677e-10,
      -2.376431867304021e-10, -2.8049932642508693e-10, -3.0235688720089337e-10,
      -3.026932361218054e-10, -2.824703063656741e-10, -2.4400138016739864e-10,
      -1.9073225097020202e-10, -1.2695553519181637e-10, -5.748058227895529e-11,
      1.2716581917773491e-11, 7.883860636236417e-11, 1.3658423685470688e-10,
      1.8241754329512927e-10, 2.137728849319281e-10, 2.2918464301654687e-10,
      2.2833635833986433e-10, 2.120296265168354e-10, 1.820785338079775e-10,
      1.411402052469763e-10, 9.249588918228004e-11, 3.979969943608964e-11,
      -1.3186452054844713e-11, -6.285311001709391e-11, -1.0598127467357557e-10,
      -1.3994300995472076e-10, -1.6285275665250558e-10, -1.7366133647324062e-10,
      -1.721888892365776e-10, -1.59097302041504e-10, -1.3580677034956744e-10,
      -1.0436471040699251e-10, -6.727810025555576e-11, -2.732230182608503e-11,
      1.2659584407178814e-11, 4.995278113836673e-11, 8.214921527250734e-11,
      1.072969205464437e-10, 1.2401164770989767e-10, 1.3154483654284722e-10,
      1.2980533320861984e-10, 1.1933549548624007e-10, 1.0124539473368077e-10,
      7.711149771358978e-11, 4.8848330098860824e-11, 1.8563068193909397e-11,
      -1.1596291055613338e-11, -3.9588583171186965e-11, -6.361312222804432e-11,
      -8.222091024598451e-11, -9.439688871868234e-11, -9.960897488883714e-11,
      -9.782207451510035e-11, -8.947772267514276e-11, -7.544230717238388e-11,
      -5.6928826228553336e-11, -3.539870180324261e-11, -1.2451225111057827e-11,
      1.0291296372746082e-11, 3.129469861813989e-11, 4.921305200881748e-11,
      6.297139684684966e-11, 7.182630225417078e-11, 7.5401153069102e-11,
      7.369492619377464e-11, 6.706507380082347e-11, 5.618685993238854e-11,
      4.199298776839753e-11, 2.5598516934777252e-11, 8.216839832271679e-12,
      -8.92717118160754e-12, -2.4680821573292828e-11, -3.8038525693401e-11,
      -4.820332483584887e-11, -5.4631430793381096e-11, -5.705754843829518e-11,
      -5.550013818431275e-11, -5.024717906962707e-11, -4.1824290972144763e-11,
      -3.0948186718159197e-11, -1.846928457536454e-11, -5.307872034872912e-12,
      7.611551454721044e-12, 1.9423213294314377e-11, 2.9376140795510026e-11,
      3.68798769599947e-11, 4.1537210157763775e-11, 4.316229054451615e-11,
      4.178357232038893e-11, 3.763207647267042e-11, 3.111644231493145e-11,
      2.2787065597078345e-11, 1.3292256517911854e-11, 3.329758361057299e-12,
      -6.402870512596005e-12, -1.5255591715479165e-11, -2.266783074458892e-11,
      -2.8202429692701595e-11, -3.156967003701514e-11, -3.264018944124094e-11,
      -3.144642408806665e-11, -2.8173003695827614e-11, -2.3137256612550692e-11,
      -1.676160065313511e-11, -9.540064812287657e-12, -2.001482593077654e-12,
      5.3279926689238056e-12, 1.1960475364883638e-11, 1.747770952384116e-11,
      2.1556269888619678e-11, 2.3985173657006323e-11, 2.4675054844162072e-11,
      2.3658664674407688e-11, 2.1083060941631822e-11, 1.7194396742695586e-11,
      1.231667961314746e-11, 6.826218590156853e-12, 1.1236907993530863e-12,
      -4.39416765949242e-12, -9.361307987946065e-12, -1.346580835908174e-11,
      -1.6468567426996758e-11, -1.8216200114544003e-11, -1.8647525728433673e-11,
      -1.779350125162938e-11, -1.5770904274156635e-11, -1.2770480306067788e-11,
      -9.040612215451821e-12, -4.86782504931502e-12, -5.555941870837319e-13,
      3.5970272401675283e-12, 7.315502830787068e-12, 1.036732395787821e-11,
      1.2575867110659236e-11, 1.3829824214710755e-11, 1.408776846254756e-11,
      1.3377768358002188e-11, 1.1792302751730438e-11, 9.479037001895996e-12,
      6.628275670418371e-12, 3.45809541846896e-12, 1.9827328518159086e-13,
      -2.9258437369843467e-12, -5.7084303669452375e-12, -7.976259194852302e-12,
      -9.598966078775481e-12, -1.049593667648482e-11, -1.0639501330290861e-11,
      -1.0054390388369579e-11, -8.813658043938685e-12, -7.0315129351651004e-12,
      -4.853683634846964e-12, -2.44608572500003e-12, 1.7362658748729622e-14,
      2.3669108859376204e-12, 4.448306166145895e-12, 6.132553590304813e-12,
      7.323515314305889e-12, 7.962932001741665e-12, 8.03264367034053e-12,
      7.553987361390481e-12, 6.5845416946275406e-12, 5.2125606571398375e-12,
      3.5495801421908956e-12, 1.7217826453427234e-12, -1.3923697737271548e-13,
      -1.9056505522185836e-12, -3.461899972627409e-12, -4.711978715250001e-12,
      -5.585053198237534e-12, -6.039118423358026e-12, -6.062529738993659e-12,
      -5.67340394660411e-12, -4.9170278917100736e-12, -3.861541592105379e-12,
      -2.5922678440046997e-12, -1.2051350916618557e-12, 2.0031855738515178e-13,
      1.5278661858723843e-12, 2.6909715064267627e-12, 3.6182186864653254e-12,
      4.257467486590946e-12, 4.5785100286242325e-12, 4.574117439554322e-12,
      4.259479010928694e-12, 3.670145492922349e-12, 2.8586845597508045e-12,
      1.890334369159448e-12, 8.379960552334389e-13, -2.2306473543966532e-13,
      -1.2204343422864543e-12, -2.0893353290420207e-12, -2.7766735332534306e-12,
      -3.2441069844978153e-12, -3.4699731598840856e-12, -3.449996013249313e-12,
      -3.1967806265056076e-12, -2.7381852569438878e-12, -2.1147326379580445e-12,
      -1.3762801906087398e-12, -5.782090503881465e-13, 2.2258742091206442e-13,
      9.716342021270111e-13, 1.6204611923556514e-12, 2.1296181210545307e-12,
      2.470939323949185e-12, 2.628938998106945e-12, 2.6012820270357977e-12,
      2.398340720552228e-12, 2.0419093800704016e-12, 1.5632024681603766e-12,
      1.000305027882126e-12, 3.9527345655600045e-13, -2.089005956267794e-13,
      -7.712508778741003e-13, -1.2555242538921218e-12, -1.63242555269688e-12,
      -1.881287460839509e-12, -1.9910784287041284e-12, -1.960710474908566e-12,
      -1.7986580330802823e-12, -1.5219452351210024e-12
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_5_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<5>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 0.4972954372523798), "design.b()[0] == 0.4972954372523798");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.4972954372523798));
    static_assert(almost_equal(design.b()[1], -2.486477186261899), "design.b()[1] == -2.486477186261899");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.486477186261899));
    static_assert(almost_equal(design.b()[2], 4.972954372523798), "design.b()[2] == 4.972954372523798");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 4.972954372523798));
    static_assert(almost_equal(design.b()[3], -4.972954372523798), "design.b()[3] == -4.972954372523798");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -4.972954372523798));
    static_assert(almost_equal(design.b()[4], 2.486477186261899), "design.b()[4] == 2.486477186261899");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 2.486477186261899));
    static_assert(almost_equal(design.b()[5], -0.4972954372523798), "design.b()[5] == -0.4972954372523798");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -0.4972954372523798));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.7559171355603063), "design.a()[1] == -3.7559171355603063");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.7559171355603063));
    static_assert(almost_equal(design.a()[2], 5.611665105307244), "design.a()[2] == 5.611665105307244");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 5.611665105307244));
    static_assert(almost_equal(design.a()[3], -4.060729635836472), "design.a()[3] == -4.060729635836472");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -4.060729635836472));
    static_assert(almost_equal(design.a()[4], 1.349148329696377), "design.a()[4] == 1.349148329696377");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 1.349148329696377));
    static_assert(almost_equal(design.a()[5], -0.13599378567575218), "design.a()[5] == -0.13599378567575218");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.13599378567575218));
    std::cout << "max_deviation(cheby1,highpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.4972954372523798, -0.6186767320497308, -0.141399619011926, -0.012850676006399886,
      0.04849417058741206, 0.08508848451681206, 0.10190200014833253, 0.10027710333509743,
      0.08314048174644306, 0.05514162943583073, 0.021839647768482323, -0.011228080004322294,
      -0.039345057743106315, -0.05917129528186628, -0.0690113968789634,
      -0.06880283535731099, -0.05987216307111448, -0.04453286657253269,
      -0.025609258554419867, -0.005967277309314442, 0.01188172320133683,
      0.026060054898812857, 0.03546615074431081, 0.039784130318868904, 0.039382853833254364,
      0.03513893008063296, 0.028223027516587562, 0.01988704973507495, 0.011282709968828145,
      0.003331739469179619, -0.0033434945400062123, -0.008430883389117245,
      -0.011891368677272647, -0.013889360922955049, -0.014708482129086535,
      -0.01466921347640155, -0.014061541427981876, -0.013100784447209163,
      -0.011909452010055686, -0.01052313525392596, -0.008914728152389785,
      -0.007029114843906399, -0.004819919166848378, -0.0022808204170374734,
      0.0005340743473035738, 0.00350372165649138, 0.006447716723614126,
      0.009145794700687396, 0.011365363537495912, 0.012892251635005895,
      0.013559772567735356, 0.013271867813250605, 0.01201729148470098, 0.009873302895199602,
      0.006998880790731861, 0.003618845147133995, 1.3038724850263084e-06,
      -0.0035685602991332175, -0.006815202426769037, -0.009497030188002794,
      -0.011426002006160112, -0.012480963798872428, -0.012614024040083278,
      -0.011850067738267286, -0.010280179080574874, -0.008050224195424727,
      -0.005346118080840401, -0.002377371941332373, 0.0006395791688608397,
      0.0034969874541800274, 0.006009352115693022, 0.008024252747317127,
      0.009430082434275344, 0.010160567304363526, 0.010196166438261822,
      0.009562597812280027, 0.008326838887080378, 0.0065910158315687015,
      0.0044846355071507735, 0.002155639646434407, -0.0002392222806140154,
      -0.002544194193864295, -0.004613978757319695, -0.006322368171757393,
      -0.007569572190504775, -0.008287830722273005, -0.008444981972798502,
      -0.008045768142428744, -0.007130794718698739, -0.0057732081172827895,
      -0.0040733086899013456, -0.0021514592286432568, -0.00013977032497642684,
      0.0018268679270033207, 0.0036197917447742976, 0.005124990298314019,
      0.006250382405583156, 0.006931461064497591, 0.007134947233128193,
      0.006860242541499414, 0.006138631313378554, 0.005030342582156101,
      0.003619730452097167, 0.0020089555114786075, 0.0003106427340663709,
      -0.0013599530347336705, -0.0028927266775573843, -0.0041899226759172,
      -0.005172288271536551, -0.005783800375998868, -0.005994696311102898,
      -0.0058026617926492385, -0.005232157711657862, -0.004331991519871962,
      -0.0031713514263245757, -0.001834615375540775, -0.00041531664410757174,
      0.000990309650600006, 0.002289761433174767, 0.0034002636718734568,
      0.0042539414699479874, 0.004801857681364714, 0.00501668424847318,
      0.0048938726096579566, 0.004451290546376139, 0.0037273940207527227,
      0.0027780964108168812, 0.0016725782184479985, 0.0004883429251492377,
      -0.0006941344018233028, -0.0017968020155691047, -0.002749113351602022,
      -0.003492469707720885, -0.003983748677383308, -0.004197711117085433,
      -0.004128159139757906, -0.0037878036286520325, -0.003206886199975117,
      -0.0024306816635341743, -0.0015160775935251832, -0.0005274832204632107,
      0.00046764280103367504, 0.0014033390891917336, 0.0022194597498445467,
      0.0028654848640487767, 0.0033035855564011946, 0.003510762087124055,
      0.0034799399821296498, 0.0032199815010867973, 0.0027546427804251983,
      0.002120575908642928, 0.0013645355448391443, 0.0005399977281210569,
      -0.0002965685764266851, -0.0010895206250768376, -0.0017876965812445725,
      -0.0023476688352790766, -0.0027363924394729735, -0.0029330910105532584,
      -0.0029302774120112396, -0.002733866681279045, -0.00236239988717285,
      -0.0018454558167617947, -0.0012213788408557994, -0.0005344927922915207,
      0.00016800023977269797, 0.0008392222040103665, 0.001435707951818683,
      0.0019201798181672143, 0.0022638336015371185, 0.0024479989167189324,
      0.0024650821663550647, 0.0023187504118553463, 0.002023365780367656,
      0.0016027292915768805, 0.0010882369331776144, 0.0005165867052189304,
      -7.279894995794738e-05, -0.000640456820181866, -0.0011494922918994144,
      -0.0015679440908553796, -0.0018707551219468458, -0.002041230448720067,
      -0.0020719007605657855, -0.001964751311044505, -0.001730819397827251,
      -0.001389205103695835, -0.0009655775169539948, -0.0004902896385617361,
      3.762199549682153e-06, 0.0004833855901995289, 0.0009172943849891798,
      0.0012781218302494344, 0.001544116874424989, 0.001700420620872647,
      0.0017398506081766274, 0.0016631552068067284, 0.0014787365268183576,
      0.0012018754067068269, 0.0008535240001755554, 0.0004587581765999613,
      4.500178836217873e-05, -0.00035985328011207116, -0.0007293040358111811,
      -0.001039948202178708, -0.0012729419692974935, -0.0014151146139581693,
      -0.0014596761695762003, -0.0014064830547456768, -0.0012618567925832581,
      -0.0010379806304864304, -0.0007519260557327786, -0.0004243841712448554,
      -7.81942508265715e-05, 0.0002632274516398481, 0.0005774519305583156,
      0.0008444915090538231, 0.001048050827689751, 0.0011764978883635185,
      0.0012234990085968128, 0.0011882853661949744, 0.001075544091356009,
      0.0008949518804378942, 0.0006603922167399494, 0.0003889170160249677,
      9.952866088900648e-05, -0.00018813192099021017, -0.00045510172816893733,
      -0.000684329565125848, -0.0008617481489802167, -0.0009771182266973197,
      -0.001024595455451843, -0.0010029905359528256, -0.0009157142096360292,
      -0.000770419799999126, -0.0005783756049142922, -0.00035361637471140097,
      -0.00011193629879791066, 0.0001302053927349911, 0.00035679137133536455,
      0.0005532921738706359, 0.000707583806521112, 0.0008106800248465127,
      0.0008572362099415953, 0.0008457980931925783, 0.0007787862138073053,
      0.0006622247213865407, 0.0005052397858442705, 0.00031936737944800045,
      0.00011772165375231367, -8.591712218000724e-05, -0.0002780324718294377,
      -0.00044625749591951794, -0.0005801592533274656, -0.0006718728059445552,
      -0.0007165473359694394, -0.0007125802439259445, -0.00066162984034592,
      -0.0005684121470798035, -0.0004403014349015537, -0.00028676653257149833,
      -0.00011868487754240395, 5.241684560913979e-05, 0.00021514318282349495,
      0.00035897931342952983, 0.0004749607392354467, 0.0005562212854517317,
      0.0005983866866442593, 0.0005997921761173785, 0.0005615147488508662,
      0.00048722328483816234, 0.0003828616665119166, 0.0002561906276407873,
      0.00011622266935007485, -2.740953897497261e-05, -0.0001651076199716998,
      -0.00028794089780535327, -0.00038821749661950436, -0.00045995717028179863,
      -0.0004992374327872609, -0.0005043937487441421, -0.0004760647413412742,
      -0.000417083878128603, -0.00033222919990169987, -0.00022785170851345087,
      -0.00011141045762125582, 9.052248176952141e-06, 0.00012545914069883796,
      0.0002302328494922463, 0.00031678237141539425, 0.0003799103847700496,
      0.0004161167589426143, 0.0004237811788230547, 0.0004032162832924501,
      0.0003565915221515434, 0.0002877364747133984, 0.00020184008917888737,
      0.00010506870850140548, 4.13045987056695e-06, -9.418366153788287e-05,
      -0.00018345101408195143, -0.0002580312343275251, -0.0003134165774921712,
      -0.00034649734330031165, -0.00035572728144693706, -0.00034118091516629405,
      -0.0003045020963318944, -0.00024875031414748326, -0.00017815785015195618,
      -9.781638898515228e-05, -1.3315822774555427e-05, 6.963950591028949e-05,
      0.0001456111109961819, 0.00020977818281097213, 0.0002582384854546622,
      0.00028823990574623293, 0.000298329340219276, 0.0002884114522107258,
      0.000259716002464857, 0.00021467853661779734, 0.00015674480221358994,
      9.011401119670109e-05, 1.943967190686538e-05, -5.0491018418871884e-05,
      -0.00011507741509623523, -0.0001702041459104283, -0.00021249918365888872,
      -0.00023953538097016224, -0.00024996376992919263, -0.0002435717747065432,
      -0.00022126464483819292, -0.00018497354001954954, -0.0001374984466889688,
      -8.229817910438417e-05, -2.324286332989556e-05, 3.5653659766435176e-05,
      9.050324962260538e-05, 0.00013779684033419533, 0.00017462548816104346,
      0.0001988554101510428, 0.00020924676544869754, 0.00020550994326894254,
      0.00018829743092805672, 0.00015913364838325344, 0.00012028916726924521,
      7.460922405421648e-05, 2.5309173389904103e-05, -2.42486501866063e-05,
      -7.078138051249507e-05, -0.00011130031617956711, -0.00014330001222597898,
      -0.00016491000424525393, -0.00017500020940414932, -0.00017323436757319538,
      -0.00016006948179003039, -0.0001367028449622674, -0.00010497165839675252,
      -6.721323746086108e-05, -2.6096175148921004e-05, 1.556554383063675e-05,
      5.500270317753008e-05, 8.967259823767552e-05, 0.00011742059182696631,
      0.00013661138421197031, 0.00014622219037150626, 0.00014589275943030456,
      0.00013593016900168486, 0.00011726937561125665, 9.139339846323116e-05,
      6.0219570513916193e-05, 2.596034889205319e-05, -9.031385561671825e-06,
      -4.2421869693605244e-05, -7.205015672418998e-05, -9.60659813817351e-05,
      -0.00011304313389876979, -0.00012206155249013429, -0.0001227536063452884,
      -0.0001153125379157856, -0.00010046359261685654, -7.940081503661858e-05,
      -5.3694674473461746e-05, -2.5177462441246354e-05, 4.185325349069369e-06,
      3.242871939784435e-05, 5.771813372147296e-05, 7.846687844926932e-05,
      9.343391516931582e-05, 0.00010179596106743978, 0.00010318991245867844,
      9.772363566802535e-05, 8.595531996852187e-05, 6.884365955105919e-05,
      4.76729944553879e-05, 2.3959076913546948e-05, -6.577525401412903e-07,
      -2.4524557425545017e-05, -4.608541578806371e-05, -6.398147257106535e-05,
      -7.71350953786225e-05, -8.481302771361788e-05, -8.666496846384308e-05,
      -8.273573308391382e-05, -7.345095095063201e-05, -5.957800377230486e-05,
      -4.2165497413299935e-05, -2.2465883807233042e-05, -1.8468308002150504e-06,
      1.8302479210744442e-05, 3.666378320652539e-05, 5.2074831105047755e-05,
      6.360172547244505e-05, 7.059409223631282e-05, 7.271992873977479e-05,
      6.997840919423421e-05, 6.269043383486453e-05, 5.146818522085562e-05,
      3.716630635789247e-05, 2.0818454958588872e-05, 3.5638469478016115e-06,
      -1.3431068436052587e-05, -2.9050485416508033e-05, -4.230153601713896e-05,
      -5.237638397764657e-05, -5.8700306993763544e-05, -6.096299150293248e-05,
      -5.913145345553075e-05, -5.344425845823288e-05, -4.438796004712061e-05,
      -3.265782375035315e-05, -1.910588386706534e-05, -4.680129666013755e-06,
      9.640904974488636e-06, 2.29136933323066e-05, 3.429107238540602e-05,
      4.30754692545598e-05, 4.8760712953893026e-05, 5.105999557351225e-05,
      4.99185323702829e-05, 4.551052318383075e-05, 3.822106659217585e-05,
      2.861465405597566e-05, 1.7392711575403214e-05, 5.34330945302464e-06,
      -6.713411171033143e-06, -1.7980365103970396e-05, -2.773554378219606e-05,
      -3.537758075406197e-05, -4.0462035641913215e-05, -4.272626483435251e-05,
      -4.2101562691977955e-05, -3.871213616867809e-05, -3.2861358526448895e-05,
      -2.5006575803608133e-05, -1.572445973240266e-05, -5.669468400625845e-06,
      4.471642026540393e-06, 1.4026134686527896e-05, 2.23793534102137e-05,
      2.9013680687733272e-05, 3.353996380543812e-05, 3.5719548257701284e-05,
      3.547573175004746e-05, 3.2894185404119954e-05, 2.8212630988317376e-05,
      2.18007648187991e-05, 1.413203517726604e-05, 5.749372404763645e-06,
      -2.772689728272631e-06, -1.0866894253644063e-05, -1.801054434639176e-05,
      -2.3758771409349462e-05, -2.777170433102531e-05, -2.983391924409558e-05,
      -2.9865105839739967e-05, -2.7921497362023588e-05, -2.4188234868938703e-05,
      -1.8963430639808767e-05, -1.2635222290625431e-05, -5.653535359674352e-06,
      1.5014274397403625e-06, 8.35179368167208e-06, 1.4453538774268213e-05,
      1.9424861757433583e-05, 2.296963405992646e-05, 2.4894512812853836e-05,
      2.511876947434195e-05, 2.367639323851576e-05, 2.071055193518508e-05,
      1.64609958756962e-05, 1.124543972457929e-05, 5.436325783297685e-06,
      -5.653629472514113e-07, -6.35742445272867e-06, -1.1563055774799046e-05,
      -1.585502836839786e-05, -1.897589301489202e-05, -2.0752992830061606e-05,
      -2.1107441117174695e-05, -2.005664390499493e-05, -1.7710385726634164e-05,
      -1.4260922092793948e-05, -9.967905505623711e-06, -5.139289598533338e-06,
      -1.095889566168593e-07, 4.782992592909172e-06, 9.219021063686519e-06,
      1.2918406202444979e-05, 1.565778449130637e-05, 1.7283653935323233e-05,
      1.772051443859238e-05, 1.6973619089489066e-05, 1.512630918942797e-05,
      1.2332264620529573e-05, 8.803327694984588e-06, 4.7938323045793485e-06,
      5.825744220144427e-07, -3.546316709104428e-06, -7.3223108464338815e-06,
      -1.050596681739903e-05, -1.2903865792063803e-05, -1.438007414783967e-05,
      -1.4863477908625688e-05, -1.4350622490918251e-05, -1.290399907360839e-05,
      -1.0646021542700477e-05, -7.749215786822211e-06, -4.423378483742785e-06,
      -9.006410847306183e-07, 2.5805136994857005e-06, 5.791196433850146e-06,
      8.526963798192977e-06, 1.062062938294177e-05, 1.1952244337107015e-05,
      1.2455669439824337e-05, 1.2121402054726447e-05, 1.0995578615024213e-05,
      9.175328338653791e-06, 6.800889991200253e-06, 4.045105636983081e-06,
      1.101061062361229e-06, -1.8312570425464146e-06, -4.5583770444793245e-06,
      -6.905942658116415e-06, -8.729688177127335e-06, -9.924109892273099e-06,
      -1.042832669304971e-05, -1.022882317905467e-05, -9.358983456343364e-06,
      -7.895538545590828e-06, -5.952250791926221e-06, -3.6713320015946216e-06,
      -1.2132275603460957e-06, 1.2545113599348557e-06, 3.568505853952977e-06,
      5.580227872367013e-06, 7.165390764436085e-06, 8.231468086250126e-06,
      8.722897449967679e-06, 8.62369191545946e-06, 7.957360736023659e-06,
      6.784221923196472e-06, 5.196359113502823e-06, 3.310623670405149e-06,
      1.2602006450794559e-06, -8.146627457594547e-07, -2.7761292969476625e-06,
      -4.497812834994659e-06, -5.872802900419616e-06, -6.82017188099835e-06,
      -7.289578071031524e-06, -7.263715073353464e-06, -6.7585074678387895e-06,
      -5.821104500481972e-06, -4.5258675989893605e-06, -2.9686744965480607e-06,
      -1.2599647428248212e-06, 4.829776241726469e-07, 2.1439722824338344e-06,
      3.6155897524241694e-06, 4.806000659163868e-06, 5.644597336045587e-06,
      6.086051453120645e-06, 6.112584374718271e-06, 5.734351487876883e-06,
      4.987969232567653e-06, 3.9333354960526695e-06, 2.6490025075583474e-06,
      1.2264496025628212e-06, -2.3633403232492476e-07, -1.641512687861539e-06,
      -2.8978660661906105e-06, -3.926628506677901e-06, -4.6663374395615994e-06,
      -5.076399051528087e-06, -5.139172313159309e-06, -4.860476152758145e-06,
      -4.2685315142628534e-06, -3.4114531446095145e-06, -2.35349851358561e-06,
      -1.1703574622489497e-06, 5.6178561829530744e-08, 1.2437975446373902e-06,
      2.315122165265647e-06, 3.202682325944196e-06, 3.853090154172893e-06,
      4.230164425576528e-06, 4.316828056015084e-06, 4.115688465694863e-06,
      3.6483002609299193e-06, 2.953196785819577e-06, 2.0828559820209274e-06,
      1.0998316820814367e-06, 7.232998775647556e-08, -9.304609653341957e-07,
      -1.8429721045616106e-06, -2.607483258838699e-06, -3.1777128283736606e-06,
      -3.521548404612546e-06, -3.6227625195844243e-06, -3.4816292529334537e-06,
      -3.114432490237282e-06, -2.551930145491428e-06, -1.8369058190862315e-06,
      -1.0209959040243442e-06, -1.6102264521151737e-07, 6.849103058205864e-07,
      1.4612949640761182e-06, 2.1188132470655182e-06, 2.6174189346565767e-06,
      2.9287183575273e-06, 3.037512593205759e-06, 2.942423306389146e-06,
      2.6555871705451355e-06, 2.201465801189234e-06, 1.6148752434802004e-06,
      9.38387653211495e-07, 2.1929492339482627e-07, -4.936524849231608e-07,
      -1.1535095122915575e-06, -1.7181874622213674e-06, -2.1530964182448045e-06,
      -2.433216195160243e-06, -2.5444753494996954e-06, -2.4843669651558505e-06,
      -2.261782420569243e-06, -1.8960965699021164e-06, -1.4155862879844543e-06,
      -8.553060372562502e-07, -2.545764532062649e-07, 3.4573695549811767e-07,
      9.059691068735259e-07, 1.390242509179581e-06, 1.768729831383949e-06,
      2.0194516549874296e-06, 2.1295039280660783e-06, 2.095650363023769e-06,
      1.924258851562375e-06, 1.6306049274385419e-06, 1.2376064808050765e-06,
      7.74089675935314e-07, 2.727141398920088e-07, -2.3229566599070089e-07,
      -7.074573864768289e-07, -1.1222224504435864e-06, -1.450910938349399e-06,
      -1.6742691272713222e-06, -1.7805575992489103e-06, -1.7661114694116384e-06,
      -1.6353508574485848e-06, -1.4002566894122525e-06, -1.0793618222012652e-06,
      -6.963380823808636e-07, -2.782842054407656e-07, 1.4616358307356175e-07,
      5.487683750553752e-07, 9.035474047380561e-07, 1.188424651537284e-06,
      1.3865777981110944e-06, 1.4873992905911478e-06, 1.4870190568329027e-06,
      1.3883669154932346e-06, 1.2007837628528535e-06, 9.39220186506599e-07,
      6.230873142877684e-07, 2.7484583177953694e-07, -8.15660592415503e-08,
      -4.2235721643390675e-07, -7.254517842953666e-07, -9.718990404543121e-07,
      -1.147036224519794e-06, -1.241334583533774e-06, -1.2508818079238503e-06,
      -1.1774794082088788e-06, -1.0283596484094417e-06, -8.155516645920183e-07,
      -5.549487332885316e-07, -2.651469151998162e-07, 3.386160532637213e-08,
      3.220499522969543e-07, 5.806812072176209e-07, 7.935097799517318e-07,
      9.477836363913699e-07, 1.0349868576498919e-06, 1.051280905170189e-06,
      9.976240745665332e-07, 8.795704796481456e-07, 7.067710506559376e-07,
      4.922180804374032e-07, 2.5129061009069845e-07, 6.694645170486375e-10,
      -2.428026113336281e-07, -4.6323880181734905e-07, -6.467308044348028e-07,
      -7.822112959535333e-07, -8.621038727949987e-07, -8.827236085255934e-07,
      -8.444089118401726e-07, -7.51383682237284e-07, -6.113666150327538e-07,
      -4.3496073555785933e-07, -2.3486981843229265e-07, -2.4998450519448e-08,
      1.8050144247399678e-07, 3.6817305042395057e-07, 5.261241400607558e-07,
      6.447681520866331e-07, 7.17391636476119e-07, 7.405155064072819e-07,
      7.140321519676713e-07, 6.411157845246727e-07, 5.279184461700032e-07,
      3.830779279775754e-07, 2.1707551923880191e-07, 4.149034664862159e-08,
      -1.317974448897477e-07, -2.91400536643822e-07, -4.2716292276287184e-07,
      -5.30795818761173e-07, -5.963719063266117e-07, -6.206493139348517e-07,
      -6.032088070570179e-07, -5.464004817814045e-07, -4.551089526979329e-07,
      -3.3635776425290685e-07, -1.9878378615334616e-07, -5.202006376666628e-08,
      9.396945916772775e-08, 2.295579934158879e-07, 3.460824988613607e-07,
      4.3638859673208814e-07, 4.952601285370493e-07, 5.19708281371944e-07,
      5.091052009080254e-07, 4.6515772457440244e-07, 3.917275598722848e-07,
      2.945142002546276e-07, 1.806254755832836e-07, 5.8067346246688126e-08,
      -6.481101972368401e-08, -1.7987892608039657e-07, -2.7975526684637336e-07,
      -3.5827485735134946e-07, -4.108610157293932e-07, -4.347824603254355e-07,
      -4.2928086403076815e-07, -3.9556434738902743e-07, -3.3667118835794594e-07,
      -2.572164817099318e-07, -1.630418519025412e-07, -6.079415380046909e-08,
      4.2536955270206476e-08, 1.4009082801697678e-07, 2.2558557096378285e-07,
      2.9371662763693395e-07, 3.4047932566423437e-07, 3.6339625179076555e-07,
      3.616371583451303e-07, 3.3602656063326876e-07, 2.889417466089156e-07,
      2.2411108513675535e-07, 1.4632882505801862e-07, 6.110763196490624e-08,
      -2.5706385082745748e-08, -1.0832963591837754e-07, -1.814215146205366e-07,
      -2.4042466622854015e-07, -2.818437190627121e-07, -3.034458263133438e-07,
      -3.043720065587622e-07, -2.851544845337701e-07, -2.4764158400695693e-07,
      -1.9483779032146e-07, -1.3067198827894743e-07, -5.971125492654837e-08,
      1.3159313534594458e-08, 8.306860435829763e-08, 1.4548103751743983e-07,
      1.9648670922439942e-07, 2.3304185441051952e-07, 2.531451610155698e-07,
      2.559401239747865e-07, 2.417387967393545e-07, 2.1196762654536992e-07,
      1.6904118973599022e-07, 1.1617424186554093e-07, 5.714627540507698e-08,
      -3.964490537116773e-09, -6.305922947442615e-08, -1.1629000625500582e-07,
      -1.6030690085527904e-07, -1.9246512349769355e-07, -2.109795803835667e-07,
      -2.1501818246613658e-07, -2.047294883219523e-07, -1.8120473883653873e-07,
      -1.4637867606158494e-07, -1.0287745852171382e-07, -5.382524326980514e-08,
      -2.623404773530518e-09, 4.728223171565191e-08, 9.263041385942127e-08,
      1.3055471336608845e-07, 1.5876164706215487e-07, 1.756658173894055e-07,
      1.8047437399777539e-07, 1.73216668625472e-07, 1.5471871632090817e-07,
      1.2652573512870014e-07, 9.077937414011114e-08, 5.005904491189046e-08,
      7.1988735751676375e-09, -3.490692829104202e-08, -7.349707782845769e-08,
      -1.0612190941237139e-07, -1.307963384705027e-07, -1.4611772898854495e-07,
      -1.5134188171750978e-07, -1.4641332274715207e-07, -1.3194920222581743e-07,
      -1.0917919890193633e-07, -7.984666514664252e-08, -4.607865863802122e-08,
      -1.0234343827609381e-08, 2.52575962498832e-08, 5.8061476318805625e-08,
      8.608631408746867e-08, 1.0761700787289101e-07, 1.2141690577284465e-07,
      1.2679580831184056e-07, 1.236399021309987e-07, 1.1240273894238388e-07,
      9.405897406061052e-08, 7.0024990983465e-08, 4.2052608684137097e-08,
      1.210366948865175e-08, -1.7785654726318378e-08, -4.564157438453355e-08,
      -6.968134707698546e-08, -8.842562245163363e-08, -1.0078751023456609e-07,
      -1.0613315262543077e-07, -1.0431061548426273e-07, -9.564609809248236e-08,
      -8.090865002043094e-08, -6.124663100732144e-08, -3.8100924495875183e-08,
      -1.310130808924192e-08, 1.2046686364581166e-08, 3.567667224142651e-08,
      5.6270422511359305e-08, 7.255396274471626e-08, 8.357476246506748e-08,
      8.875546548948186e-08, 8.792128138777491e-08, 8.129998363103633e-08,
      6.94953007934204e-08, 5.3436223156661276e-08, 3.4306266514276214e-08,
      1.3457943670864936e-08, -7.681478887130787e-09, -2.7706460111696757e-08,
      -4.532545845604054e-08, -5.9443022824815484e-08, -6.922656697971672e-08,
      -7.415385363740512e-08, -7.403860352227616e-08, -6.90331646296625e-08,
      -5.960872369441864e-08, -4.65150123478456e-08, -3.0722759680916104e-08,
      -1.3353189957603038e-08, 4.40040292428066e-09, 2.135359336571596e-08,
      3.6408852782042383e-08, 4.862559538310939e-08, 5.727784054828455e-08,
      6.189603609565584e-08, 6.229073279768824e-08, 5.8557066308078364e-08,
      5.106030113683456e-08, 4.040393568425661e-08, 2.7382976926783607e-08,
      1.292589867082727e-08, -1.9705556189498034e-09, -1.6309210909823008e-08,
      -2.9158380129278897e-08, -3.971156332214947e-08, -4.733715922602974e-08,
      -5.161519029848663e-08, -5.235898663679953e-08, -4.962082732561024e-08,
      -4.368162680727817e-08, -3.50258058815408e-08, -2.430343343709392e-08,
      -1.228250646887109e-08, 2.05194570893162e-10, 1.2320912058782771e-08,
      2.3274548182903738e-08, 3.2375488920833565e-08, 3.9075394002870804e-08,
      4.3000355298924126e-08, 4.39706033043422e-08, 4.200681664100135e-08,
      3.7323002074077905e-08, 3.0306801084114316e-08, 2.1488885491400415e-08,
      1.1503778059361522e-08, 1.0449337141680562e-09, -9.182785032558991e-09,
      -1.851002258398517e-08, -2.634615143149945e-08, -3.221604935311178e-08,
      -3.578818684470627e-08, -3.689241779087666e-08, -3.552659305850552e-08,
      -3.185188069918114e-08, -2.6177426208733807e-08, -1.89356726676809e-08,
      -1.0650240029316541e-08, -1.898700104122557e-09, 6.727145911236804e-09,
      1.4660790267264644e-08, 2.1397735370924008e-08, 2.652705816328582e-08,
      2.975588383615022e-08, 3.0925354841222534e-08, 3.001728384021939e-08,
      2.715131826591136e-08, 2.2573076234521676e-08, 1.663429709264004e-08,
      9.766547721126326e-09, 2.4504074101080474e-09, -4.817702230687373e-09,
      -1.1558782395095274e-08, -1.7342415889317154e-08, -2.1813820675935516e-08,
      -2.4715127909272284e-08, -2.5899643883118035e-08, -2.533835463917707e-08,
      -2.3118465972399357e-08, -1.943430392956637e-08, -1.4571396491042495e-08,
      -8.884984252084752e-09, -2.7745403142236824e-09, 3.343901991216505e-09,
      9.065721660539386e-09, 1.4024125423251416e-08, 1.791330479312515e-08,
      2.0506897747138682e-08, 2.167066959513777e-08, 2.1368740833203884e-08,
      1.9663135572087252e-08, 1.670687209937407e-08, 1.2731237600162517e-08,
      8.028255025035894e-09, 2.929638932387171e-09, -2.216268032106186e-09,
      -7.067995702224953e-09, -1.1313318217050302e-08, -1.4689050862777645e-08,
      -1.699703738800126e-08, -1.811538047004565e-08, -1.8004309598408696e-08,
      -1.67064524609034e-08, -1.4341652525964002e-08, -1.1096831881917376e-08,
      -7.2117115480638566e-09, -2.9614519559116747e-09, 1.3625506447870087e-09,
      5.472389687088957e-09, 9.10257698085245e-09, 1.2026946399246447e-08,
      1.4072473449657992e-08, 1.5129185860442212e-08, 1.5155622350130385e-08,
      1.4179606563872154e-08, 1.2294419488535565e-08, 9.65075539896927e-09,
      6.44511401884858e-09, 2.905498390550208e-09, -7.245589316159679e-10,
      -4.202537613969098e-09, -7.302929594368564e-09, -9.831655493762032e-09,
      -1.1637990005712587e-08, -1.2623279566151514e-08, -1.274596818679471e-08,
      -1.2022705238446547e-08, -1.0525574422226569e-08, -8.37573840618678e-09,
      -5.734022055197561e-09, -2.7891445130978267e-09, 2.555545933016033e-10,
      3.195974290372414e-09, 5.840763929846165e-09, 8.023604331416938e-09,
      9.613482006324523e-09, 1.0522335001382878e-08, 1.0709640459787486e-08,
      1.0183728467837466e-08, 8.999829312377674e-09, 7.255076970746469e-09,
      5.080886433919184e-09
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.4972954372523798, -0.6186767320497305, -0.14139961901192488, -0.012850676006398002,
      0.04849417058741458, 0.08508848451681485, 0.10190200014833513, 0.1002771033350994,
      0.08314048174644423, 0.05514162943583117, 0.021839647768482417, -0.011228080004321966,
      -0.03934505774310512, -0.059171295281863726, -0.06901139687895927,
      -0.06880283535730539, -0.05987216307110786, -0.04453286657252575,
      -0.025609258554413476, -0.005967277309309482, 0.011881723201339586,
      0.026060054898812864, 0.03546615074430785, 0.03978413031886314, 0.03938285383324626,
      0.035138930080623285, 0.028223027516577313, 0.01988704973506522, 0.011282709968819995,
      0.0033317394691739412, -0.003343494540008797, -0.008430883389116453,
      -0.01189136867726855, -0.013889360922948063, -0.014708482129077369,
      -0.014669213476391121, -0.014061541427971211, -0.013100784447199287,
      -0.01190945201004753, -0.010523135253920268, -0.008914728152387044,
      -0.007029114843906796, -0.004819919166851808, -0.002280820417043565,
      0.0005340743472954054, 0.0035037216564818615, 0.006447716723604054,
      0.009145794700677563, 0.01136536353748705, 0.012892251634998624, 0.013559772567730147,
      0.013271867813247757, 0.012017291484700609, 0.00987330289520164, 0.006998880790736078,
      0.003618845147140026, 1.3038724924113515e-06, -0.0035685602991249983,
      -0.006815202426760531, -0.00949703018799455, -0.011426002006152649,
      -0.012480963798866217, -0.012614024040078725, -0.011850067738264698,
      -0.010280179080574447, -0.008050224195426527, -0.0053461180808443585,
      -0.002377371941338272, 0.0006395791688533479, 0.0034969874541714097,
      0.006009352115683837, 0.008024252747307992, 0.009430082434266886,
      0.010160567304356336, 0.010196166438256413, 0.009562597812276792,
      0.008326838887079566, 0.006591015831570398, 0.0044846355071548934,
      0.0021556396464406905, -0.00023922228060598672, -0.00254419419385507,
      -0.004613978757309914, -0.0063223681717477385, -0.007569572190495924,
      -0.008287830722265573, -0.008444981972793007, -0.008045768142425556,
      -0.007130794718698062, -0.0057732081172846466, -0.004073308689905572,
      -0.0021514592286495183, -0.00013977032498424549, 0.0018268679269945276,
      0.00361979174476517, 0.005124990298305205, 0.006250382405575265, 0.006931461064491158,
      0.0071349472331236384, 0.006860242541497018, 0.006138631313378445,
      0.005030342582158243, 0.0036197304521013722, 0.0020089555114845533,
      0.00031064273407362233, -0.001359953034725623, -0.0028927266775490906,
      -0.0041899226759092145, -0.005172288271529396, -0.005783800375993001,
      -0.005994696311098684, -0.005802661792646935, -0.005232157711657594,
      -0.0043319915198737225, -0.0031713514263282255, -0.0018346153755460508,
      -0.0004153166441141052, 0.000990309650592664, 0.002289761433167116,
      0.0034002636718660135, 0.00425394146994125, 0.00480185768135913,
      0.0050166842484691155, 0.004893872609655674, 0.004451290546375777,
      0.0037273940207542934, 0.0027780964108202644, 0.0016725782184529522,
      0.0004883429251554151, -0.0006941344018163278, -0.0017968020155618078,
      -0.0027491133515948956, -0.0034924697077144064, -0.003983748677377905,
      -0.004197711117081458, -0.00412815913975561, -0.0037878036286515455,
      -0.0032068861999764386, -0.002430681663537176, -0.001516077593529621,
      -0.0005274832204687493, 0.0004676428010274386, 0.0014033390891852392,
      0.00221945974983824, 0.002865484864043079, 0.003303585556396476, 0.003510762087120611,
      0.003479939982127683, 0.0032199815010864096, 0.0027546427804263857,
      0.0021205759086455815, 0.0013645355448430592, 0.0005399977281259473,
      -0.000296568576421165, -0.0010895206250710692, -0.0017876965812389464,
      -0.002347668835273966, -0.002736392439468712, -0.0029330910105501177,
      -0.002930277412009411, -0.00273386668127863, -0.0023623998871738555,
      -0.0018454558167641313, -0.0012213788408592888, -0.0005344927922959116,
      0.00016800023976771351, 0.0008392222040051312, 0.0014357079518135501,
      0.0019201798181625246, 0.0022638336015331773, 0.0024479989167159907,
      0.0024650821663533013, 0.002318750411854858, 0.002023365780368452,
      0.0016027292915788863, 0.001088236933180677, 0.0005165867052228308,
      -7.279894995347948e-05, -0.0006404568201771347, -0.0011494922918947371,
      -0.0015679440908510658, -0.0018707551219431767, -0.002041230448717277,
      -0.002071900760564046, -0.0019647513110439135, -0.001730819397827825,
      -0.0013892051036975136, -0.0009655775169566444, -0.0004902896385651614,
      3.7621995457237165e-06, 0.0004833855901953099, 0.000917294384984984,
      0.001278121830245538, 0.0015441168744216424, 0.001700420620870059,
      0.0017398506081749516, 0.0016631552068060548, 0.0014787365268187083,
      0.0012018754067081561, 0.0008535240001777553, 0.00045875817660286983,
      4.500178836559065e-05, -0.0003598532801083906, -0.0007293040358074806,
      -0.001039948202175233, -0.0012729419692944692, -0.0014151146139557884,
      -0.0014596761695746096, -0.001406483054744968, -0.0012618567925834641,
      -0.0010379806304875233, -0.000751926055734672, -0.00042438417124741234,
      -7.819425082961422e-05, 0.00026322745163652646, 0.0005774519305549373,
      0.0008444915090506113, 0.0010480508276869151, 0.0011764978883612401,
      0.001223499008595234, 0.0011882853661941888, 0.0010755440913560559,
      0.0008949518804387574, 0.0006603922167415586, 0.00038891701602720427,
      9.952866089171185e-05, -0.00018813192098722338, -0.00045510172816587256,
      -0.0006843295651229109, -0.0008617481489776008, -0.0009771182266951938,
      -0.0010245954554503392, -0.0010029905359520308, -0.0009157142096359815,
      -0.0007704197999998124, -0.0005783756049156512, -0.0003536163747133274,
      -0.00011193629880026347, 0.0001302053927323781, 0.0003567913713326708,
      0.0005532921738680418, 0.0007075838065187865, 0.0008106800248446031,
      0.0008572362099402176, 0.0008457980931918104, 0.0007787862138071833,
      0.000662224721387057, 0.0005052397858453761, 0.00031936737944960843,
      0.00011772165375430597, -8.591712217777144e-05, -0.000278032471827112,
      -0.0004462574959172581, -0.0005801592533254195, -0.0006718728059428532,
      -0.0007165473359681856, -0.0007125802439252114, -0.0006616298403457442,
      -0.0005684121470801847, -0.00044030143490245567, -0.0002867665325728519,
      -0.0001186848775441127, 5.2416845607193616e-05, 0.0002151431828214426,
      0.0003589793134275076, 0.00047496073923358685, 0.0005562212854501538,
      0.0005983866866430625, 0.0005997921761166347, 0.0005615147488506159,
      0.0004872232848384126, 0.00038286166651264143, 0.0002561906276419301,
      0.0001162226693515527, -2.7409538973263262e-05, -0.00016510761996987595,
      -0.0002879408978035375, -0.00038821749661781664, -0.00045995717028034846,
      -0.0004992374327861404, -0.00050439374874342, -0.00047606474134099163,
      -0.00041708387812877093, -0.00033222919990229916, -0.00022785170851443364,
      -0.00011141045762254921, 9.052248175440533e-06, 0.00012545914069721353,
      0.00023023284949062, 0.000316782371413875, 0.00037991038476873707,
      0.00041611675894159215, 0.00042378117882238515, 0.00040321628329216986,
      0.00035659152215166166, 0.00028773647471389663, 0.00020184008917972196,
      0.0001050687085025112, 4.130459871862197e-06, -9.418366153649e-05,
      -0.0001834510140805567, -0.0002580312343262216, -0.00031341657749104333,
      -0.00034649734329942944, -0.0003557272814463522, -0.00034118091516603715,
      -0.0003045020963319733, -0.0002487503141478831, -0.00017815785015264137,
      -9.78163889860696e-05, -1.3315822775638108e-05, 6.963950590911708e-05,
      0.00014561111099499913, 0.0002097781828098569, 0.0002582384854536859,
      0.00028823990574545615, 0.0002983293402187447, 0.00028841145221046897,
      0.0002597160024648853, 0.00021467853661810306, 0.00015674480221414765,
      9.011401119746963e-05, 1.9439671907790607e-05, -5.049101841785345e-05,
      -0.00011507741509519214, -0.0001702041459094296, -0.00021249918365799945,
      -0.000239535380969439, -0.0002499637699286799, -0.00024357177470627064,
      -0.00022126464483817343, -0.00018497354001977863, -0.00013749844668942536,
      -8.229817910503213e-05, -2.3242863330686805e-05, 3.565365976555725e-05,
      9.050324962170172e-05, 0.00013779684033332702, 0.00017462548816026753,
      0.00019885541015040865, 0.0002092467654482439, 0.00020550994326869494,
      0.00018829743092802615, 0.00015913364838343613, 0.00012028916726962328,
      7.460922405475976e-05, 2.5309173390572358e-05, -2.4248650185860435e-05,
      -7.078138051172281e-05, -0.0001113003161788201, -0.0001433000122253059,
      -0.00016491000424469736, -0.00017500020940374312, -0.00017323436757296268,
      -0.0001600694817899824, -0.00013670284496240302, -0.0001049716583970585,
      -6.721323746131348e-05, -2.609617514948681e-05, 1.556554382999726e-05,
      5.5002703176860665e-05, 8.967259823702102e-05, 0.00011742059182636962,
      0.0001366113842114696, 0.00014622219037113262, 0.00014589275943008005,
      0.00013593016900162125, 0.00011726937561135478, 9.139339846348103e-05,
      6.021957051429792e-05, 2.5960348892538526e-05, -9.03138556111741e-06,
      -4.242186969302009e-05, -7.20501567236136e-05, -9.606598138120553e-05,
      -0.00011304313389832122, -0.00012206155248979481, -0.0001227536063450783,
      -0.00011531253791571608, -0.0001004635926169291, -7.940081503682525e-05,
      -5.369467447378576e-05, -2.517746244166343e-05, 4.185325348589227e-06,
      3.242871939733466e-05, 5.7718133720968426e-05, 7.846687844880345e-05,
      9.343391516891869e-05, 0.00010179596106713614, 0.0001031899124584861,
      9.772363566795425e-05, 8.595531996857365e-05, 6.884365955122736e-05,
      4.767299445565851e-05, 2.395907691389955e-05, -6.577525397320177e-07,
      -2.4524557425107528e-05, -4.608541578762763e-05, -6.398147257065951e-05,
      -7.713509537827304e-05, -8.481302771334665e-05, -8.66649684636662e-05,
      -8.273573308384076e-05, -7.345095095066508e-05, -5.95780037724393e-05,
      -4.21654974135244e-05, -2.246588380753048e-05, -1.846830800563983e-06,
      1.8302479210368394e-05, 3.666378320614781e-05, 5.2074831104693716e-05,
      6.360172547213746e-05, 7.059409223607102e-05, 7.271992873961326e-05,
      6.997840919416176e-05, 6.269043383488381e-05, 5.146818522096318e-05,
      3.7166306358079086e-05, 2.0818454958840312e-05, 3.5638469480996497e-06,
      -1.3431068435728832e-05, -2.905048541618065e-05, -4.230153601682975e-05,
      -5.237638397737561e-05, -5.8700306993547896e-05, -6.096299150278514e-05,
      -5.9131453455459874e-05, -5.344425845824137e-05, -4.438796004720603e-05,
      -3.2657823750508014e-05, -1.9105883867277742e-05, -4.680129666268204e-06,
      9.640904974210095e-06, 2.2913693332023113e-05, 3.429107238513661e-05,
      4.307546925432208e-05, 4.8760712953702024e-05, 5.105999557337949e-05,
      4.991853237021574e-05, 4.5510523183831954e-05, 3.822106659224357e-05,
      2.861465405610364e-05, 1.7392711575581372e-05, 5.343309453239842e-06,
      -6.713411170796129e-06, -1.7980365103727847e-05, -2.7735543781964195e-05,
      -3.5377580753855884e-05, -4.046203564174591e-05, -4.27262648342341e-05,
      -4.210156269191507e-05, -3.8712136168673543e-05, -3.286135852650157e-05,
      -2.5006575803713155e-05, -1.5724459732551822e-05, -5.669468400808244e-06,
      4.471642026337594e-06, 1.4026134686318573e-05, 2.2379353410011834e-05,
      2.901368068755202e-05, 3.353996380528897e-05, 3.571954825759329e-05,
      3.5475731749986744e-05, 3.2894185404109295e-05, 2.8212630988356156e-05,
      2.1800764818883418e-05, 1.4132035177389079e-05, 5.749372404916218e-06,
      -2.772689728101398e-06, -1.0866894253465973e-05, -1.8010544346218744e-05,
      -2.3758771409192795e-05, -2.7771704330894883e-05, -2.983391924399931e-05,
      -2.9865105839683327e-05, -2.792149736200933e-05, -2.4188234868966723e-05,
      -1.8963430639876174e-05, -1.2635222290726777e-05, -5.653535359802068e-06,
      1.5014274395954045e-06, 8.351793681519925e-06, 1.4453538774119134e-05,
      1.942486175729739e-05, 2.296963405981187e-05, 2.4894512812767923e-05,
      2.511876947428971e-05, 2.367639323849985e-05, 2.0710551935205686e-05,
      1.6460995875751088e-05, 1.1245439724663989e-05, 5.436325783405859e-06,
      -5.65362947127504e-07, -6.357424452597636e-06, -1.1563055774669758e-05,
      -1.585502836827887e-05, -1.8975893014790984e-05, -2.0752992829984804e-05,
      -2.1107441117126645e-05, -2.005664390497813e-05, -1.7710385726648974e-05,
      -1.4260922092838614e-05, -9.96790550569454e-06, -5.139289598624991e-06,
      -1.0958895672274202e-07, 4.7829925927964354e-06, 9.219021063574578e-06,
      1.2918406202341241e-05, 1.5657784491217514e-05, 1.7283653935254786e-05,
      1.7720514438548387e-05, 1.697361908947186e-05, 1.512630918943804e-05,
      1.2332264620565579e-05, 8.80332769504351e-06, 4.793832304656722e-06,
      5.825744221046925e-07, -3.5463167090075934e-06, -7.322310846337037e-06,
      -1.0505966817308592e-05, -1.2903865791985605e-05, -1.438007414777859e-05,
      -1.4863477908585342e-05, -1.4350622490900797e-05, -1.2903999073614422e-05,
      -1.0646021542729024e-05, -7.749215786870844e-06, -4.423378483807815e-06,
      -9.006410848073646e-07, 2.5805136994025786e-06, 5.791196433766285e-06,
      8.526963798113934e-06, 1.0620629382872659e-05, 1.1952244337052176e-05,
      1.2455669439787072e-05, 1.2121402054708819e-05, 1.0995578615026933e-05,
      9.175328338676193e-06, 6.800889991240364e-06, 4.045105637037781e-06,
      1.1010610624264963e-06, -1.8312570424752066e-06, -4.55837704440708e-06,
      -6.90594265804798e-06, -8.729688177067172e-06, -9.924109892224994e-06,
      -1.042832669301655e-05, -1.0228823179038268e-05, -9.358983456344377e-06,
      -7.89553854560874e-06, -5.9522507919594025e-06, -3.6713320016404766e-06,
      -1.2132275604012544e-06, 1.254511359874292e-06, 3.568505853891165e-06,
      5.580227872308082e-06, 7.165390764383865e-06, 8.231468086207901e-06,
      8.722897449937985e-06, 8.623691915443933e-06, 7.95736073602295e-06,
      6.784221923210243e-06, 5.196359113529789e-06, 3.3106236704431895e-06,
      1.2602006451257733e-06, -8.146627457081313e-07, -2.7761292968948505e-06,
      -4.497812834943884e-06, -5.872802900374178e-06, -6.820171880961119e-06,
      -7.289578071004754e-06, -7.263715073338659e-06, -6.7585074678366244e-06,
      -5.821104500492265e-06, -4.525867599011113e-06, -2.9686744965795483e-06,
      -1.2599647428637288e-06, 4.829776241290603e-07, 2.1439722823885477e-06,
      3.6155897523802e-06, 4.806000659124074e-06, 5.6445973360124884e-06,
      6.086051453096261e-06, 6.112584374704002e-06, 5.734351487873427e-06,
      4.987969232574981e-06, 3.933335496070041e-06, 2.6490025075843785e-06,
      1.226449602595587e-06, -2.3633403228775018e-07, -1.641512687822521e-06,
      -2.8978660661523767e-06, -3.926628506642967e-06, -4.6663374395322015e-06,
      -5.076399051506041e-06, -5.139172313145896e-06, -4.860476152754044e-06,
      -4.26853151426811e-06, -3.4114531446235523e-06, -2.3534985136072858e-06,
      -1.1703574622766375e-06, 5.61785617978191e-08, 1.2437975446038644e-06,
      2.3151221652325833e-06, 3.202682325913783e-06, 3.853090154147086e-06,
      4.230164425556922e-06, 4.316828056002821e-06, 4.115688465690561e-06,
      3.648300260933652e-06, 2.953196785830883e-06, 2.082855982038859e-06,
      1.0998316821046348e-06, 7.232998778327103e-08, -9.304609653056639e-07,
      -1.8429721045332687e-06, -2.6074832588124114e-06, -3.1777128283511075e-06,
      -3.5215484045951193e-06, -3.622762519573145e-06, -3.4816292529289127e-06,
      -3.1144324902396096e-06, -2.551930145500297e-06, -1.8369058191008903e-06,
      -1.020995904043676e-06, -1.6102264523412468e-07, 6.84910305796283e-07,
      1.461294964051771e-06, 2.1188132470427407e-06, 2.617418934636838e-06,
      2.9287183575118324e-06, 3.037512593195482e-06, 2.9424233063846127e-06,
      2.6555871705465034e-06, 2.2014658011962647e-06, 1.6148752434922842e-06,
      9.383876532277034e-07, 2.1929492341398128e-07, -4.93652484902402e-07,
      -1.1535095122706097e-06, -1.7181874622016222e-06, -2.1530964182275386e-06,
      -2.4332161951465353e-06, -2.5444753494903624e-06, -2.484366965151398e-06,
      -2.2617824205698413e-06, -1.8960965699075989e-06, -1.4155862879943362e-06,
      -8.553060372697703e-07, -2.545764532224411e-07, 3.457369554804183e-07,
      9.059691068555088e-07, 1.3902425091624431e-06, 1.7687298313687994e-06,
      2.019451654975218e-06, 2.1295039280575364e-06, 2.0956503630193684e-06,
      1.9242588515623014e-06, 1.6306049274426902e-06, 1.2376064808130657e-06,
      7.740896759465196e-07, 2.727141399056098e-07, -2.3229566597566235e-07,
      -7.074573864613816e-07, -1.1222224504287606e-06, -1.4509109383361582e-06,
      -1.6742691272605009e-06, -1.7805575992411625e-06, -1.7661114694073978e-06,
      -1.6353508574480417e-06, -1.4002566894153484e-06, -1.079361822207703e-06,
      -6.963380823901327e-07, -2.7828420545218e-07, 1.4616358306081295e-07,
      5.487683750421708e-07, 9.035474047252825e-07, 1.188424651525776e-06,
      1.3865777981015814e-06, 1.4873992905842083e-06, 1.4870190568289289e-06,
      1.388366915492412e-06, 1.2007837628551553e-06, 9.392201865117934e-07,
      6.230873142954395e-07, 2.748458317891157e-07, -8.156605923074512e-08,
      -4.223572164226209e-07, -7.254517842843594e-07, -9.71899040444306e-07,
      -1.147036224511427e-06, -1.2413345835275589e-06, -1.2508818079201433e-06,
      -1.1774794082078593e-06, -1.0283596484111063e-06, -8.155516645961855e-07,
      -5.549487332948592e-07, -2.6514691520782763e-07, 3.3861605317251914e-08,
      3.220499522873582e-07, 5.806812072081963e-07, 7.935097799430975e-07,
      9.477836363840763e-07, 1.0349868576443866e-06, 1.0512809051667893e-06,
      9.976240745654096e-07, 8.795704796493132e-07, 7.067710506592603e-07,
      4.922180804426054e-07, 2.5129061009738683e-07, 6.694645247418143e-10,
      -2.428026113254656e-07, -4.632388018092698e-07, -6.467308044273394e-07,
      -7.822112959471634e-07, -8.62103872790115e-07, -8.827236085224805e-07,
      -8.444089118389911e-07, -7.513836822380628e-07, -6.11366615035391e-07,
      -4.349607355621326e-07, -2.348698184378765e-07, -2.4998450525938283e-08,
      1.805014424670539e-07, 3.6817305041702724e-07, 5.261241400543105e-07,
      6.447681520810806e-07, 7.173916364718039e-07, 7.405155064044576e-07,
      7.140321519664854e-07, 6.411157845251603e-07, 5.279184461720874e-07,
      3.8307792798107576e-07, 2.170755192434497e-07, 4.149034665407971e-08,
      -1.3179744488386072e-07, -2.914005366379057e-07, -4.271629227573172e-07,
      -5.30795818756337e-07, -5.96371906322795e-07, -6.206493139322797e-07,
      -6.03208807055828e-07, -5.464004817816392e-07, -4.551089526995395e-07,
      -3.3635776425574367e-07, -1.9878378615719386e-07, -5.2020063771244385e-08,
      9.396945916274073e-08, 2.295579934108322e-07, 3.460824988565723e-07,
      4.363885967278764e-07, 4.952601285336773e-07, 5.197082813696123e-07,
      5.091052009068606e-07, 4.6515772457445115e-07, 3.917275598735124e-07,
      2.9451420025692293e-07, 1.8062547558646882e-07, 5.80673462505317e-08,
      -6.481101971945099e-08, -1.7987892607606206e-07, -2.797552668422251e-07,
      -3.5827485734765597e-07, -4.1086101572638675e-07, -4.347824603232973e-07,
      -4.2928086402961725e-07, -3.9556434738891456e-07, -3.3667118835885184e-07,
      -2.572164817117705e-07, -1.630418519051674e-07, -6.07941538036893e-08,
      4.253695526662007e-08, 1.4009082801327046e-07, 2.2558557096020472e-07,
      2.937166276337174e-07, 3.40479325661583e-07, 3.633962517888405e-07,
      3.616371583440406e-07, 3.360265606330657e-07, 2.8894174660959074e-07,
      2.2411108513824258e-07, 1.4632882506019957e-07, 6.110763196761932e-08,
      -2.570638507969353e-08, -1.0832963591519686e-07, -1.814215146174414e-07,
      -2.404246662257333e-07, -2.8184371906037246e-07, -3.0344582631161477e-07,
      -3.043720065577432e-07, -2.8515448453351084e-07, -2.476415840074557e-07,
      -1.948377903226648e-07, -1.3067198828076093e-07, -5.971125492883544e-08,
      1.3159313531996992e-08, 8.306860435556952e-08, 1.4548103751476504e-07,
      1.9648670922195377e-07, 2.3304185440845925e-07, 2.5314516101402177e-07,
      2.5594012397384037e-07, 2.417387967390577e-07, 2.1196762654572552e-07,
      1.6904118973695772e-07, 1.1617424186704004e-07, 5.714627540699408e-08,
      -3.964490534920046e-09, -6.305922947210295e-08, -1.1629000625271351e-07,
      -1.603069008531686e-07, -1.924651234958998e-07, -2.1097958038219994e-07,
      -2.1501818246527583e-07, -2.0472948832164102e-07, -1.8120473883678296e-07,
      -1.4637867606235402e-07, -1.0287745852294326e-07, -5.382524327140169e-08,
      -2.6234047753791144e-09, 4.728223171368e-08, 9.263041385745964e-08,
      1.3055471336426658e-07, 1.5876164706058964e-07, 1.7566581738819375e-07,
      1.8047437399698815e-07, 1.732166686251505e-07, 1.547187163210619e-07,
      1.2652573512930704e-07, 9.077937414111971e-08, 5.005904491322387e-08,
      7.198873576729368e-09, -3.49069282893613e-08, -7.349707782677246e-08,
      -1.061219094107936e-07, -1.3079633846913437e-07, -1.4611772898747154e-07,
      -1.51341881716795e-07, -1.4641332274683425e-07, -1.3194920222590742e-07,
      -1.0917919890241763e-07, -7.984666514747298e-08, -4.60786586391366e-08,
      -1.0234343828928185e-08, 2.5257596248453852e-08, 5.8061476317363505e-08,
      8.608631408610976e-08, 1.0761700787170317e-07, 1.2141690577190195e-07,
      1.2679580831119875e-07, 1.2363990213069197e-07, 1.1240273894242332e-07,
      9.405897406098398e-08, 7.00249909841386e-08, 4.2052608685058046e-08,
      1.2103669489752403e-08, -1.778565472511571e-08, -4.564157438331117e-08,
      -6.968134707582474e-08, -8.842562245060964e-08, -1.0078751023374278e-07,
      -1.06133152624857e-07, -1.0431061548396951e-07, -9.564609809248131e-08,
      -8.090865002071415e-08, -6.124663100786248e-08, -3.810092449663133e-08,
      -1.3101308090157424e-08, 1.204668636357107e-08, 3.567667224039108e-08,
      5.62704225103676e-08, 7.255396274383262e-08, 8.35747624643474e-08,
      8.875546548896858e-08, 8.792128138749691e-08, 8.129998363100576e-08,
      6.949530079363274e-08, 5.343622315709608e-08, 3.43062665148989e-08,
      1.345794367162945e-08, -7.681478886278648e-09, -2.7706460110815558e-08,
      -4.532545845518923e-08, -5.944302282404953e-08, -6.922656697908447e-08,
      -7.415385363694483e-08, -7.403860352201368e-08, -6.903316462960987e-08,
      -5.960872369457361e-08, -4.651501234819226e-08, -3.0722759681426316e-08,
      -1.3353189958238637e-08, 4.400402923565053e-09, 2.1353593364969755e-08,
      3.6408852781315656e-08, 4.8625595382449565e-08, 5.7277840547733346e-08,
      6.189603609524664e-08, 6.229073279744414e-08, 5.855706630801088e-08,
      5.1060301136943246e-08, 4.0403935684529383e-08, 2.7382976927197892e-08,
      1.2925898671351809e-08, -1.970555618352675e-09, -1.630921090919469e-08,
      -2.915838012866172e-08, -3.971156332158388e-08, -4.733715922555167e-08,
      -5.161519029812526e-08, -5.2358986636575536e-08, -4.962082732553466e-08,
      -4.3681626807351935e-08, -3.5025805881754905e-08, -2.43034334374303e-08,
      -1.2282506469304037e-08, 2.0519457039508016e-10, 1.232091205825445e-08,
      2.327454818238111e-08, 3.2375488920351173e-08, 3.9075394002459516e-08,
      4.300035529860922e-08, 4.397060330414183e-08, 4.200681664092554e-08,
      3.732300207412813e-08, 3.030680108428369e-08, 2.148888549167437e-08,
      1.150377805971903e-08, 1.0449337145831884e-09, -9.182785032115212e-09,
      -1.851002258354279e-08, -2.63461514310876e-08, -3.221604935275679e-08,
      -3.578818684443002e-08, -3.6892417790695225e-08, -3.55265930584283e-08,
      -3.185188069921041e-08, -2.6177426208864753e-08, -1.8935672667902148e-08,
      -1.0650240029611097e-08, -1.8987001044690564e-09, 6.727145910862582e-09,
      1.466079026688811e-08, 2.1397735370570064e-08, 2.6527058162977227e-08,
      2.975588383590616e-08, 3.0925354841057435e-08, 3.00172838401421e-08,
      2.7151318265924728e-08, 2.2573076234622512e-08, 1.6634297092819466e-08,
      9.76654772137049e-09, 2.4504074103991687e-09, -4.817702230369733e-09,
      -1.1558782394772789e-08, -1.7342415889011272e-08, -2.181382067566604e-08,
      -2.4715127909056128e-08, -2.5899643882968144e-08, -2.533835463910165e-08,
      -2.3118465972401465e-08, -1.9434303929643834e-08, -1.4571396491188215e-08,
      -8.884984252287292e-09, -2.7745403144681424e-09, 3.343901990947414e-09,
      9.065721660264135e-09, 1.4024125422988399e-08, 1.791330479289147e-08,
      2.0506897746949033e-08, 2.167066959500354e-08, 2.1368740833132486e-08,
      1.9663135572081714e-08, 1.670687209943296e-08, 1.2731237600280186e-08,
      8.028255025202949e-09, 2.9296389325912117e-09, -2.2162680318796674e-09,
      -7.0679957019915625e-09, -1.1313318216825677e-08, -1.4689050862576417e-08,
      -1.699703738783611e-08, -1.8115380469926516e-08, -1.8004309598342197e-08,
      -1.670645246089248e-08, -1.4341652526007843e-08, -1.1096831882011556e-08,
      -7.21171154820074e-09, -2.9614519560810085e-09, 1.3625506445973428e-09,
      5.4723896868920835e-09, 9.102576980661606e-09, 1.2026946399074099e-08,
      1.407247344951504e-08, 1.5129185860337312e-08, 1.5155622350069425e-08,
      1.4179606563857953e-08, 1.2294419488567764e-08, 9.650755399044455e-09,
      6.4451140189606e-09, 2.90549839069065e-09, -7.245589314571657e-10,
      -4.202537613802937e-09, -7.3029295942062334e-09, -9.831655493614162e-09,
      -1.1637990005588564e-08, -1.26232795660589e-08, -1.2745968186738788e-08,
      -1.2022705238430032e-08, -1.0525574422249504e-08, -8.375738406246598e-09,
      -5.7340220552893236e-09, -2.7891445132146147e-09, 2.5555459316817576e-10,
      3.1959742902316076e-09, 5.840763929707479e-09, 8.023604331289479e-09,
      9.613482006216409e-09, 1.0522335001300732e-08, 1.0709640459736042e-08,
      1.0183728467819304e-08, 8.999829312393114e-09, 7.255076970793598e-09,
      5.080886433994044e-09
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_9_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<9>(3.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 0.2912870226057862), "design.b()[0] == 0.2912870226057862");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.2912870226057862));
    static_assert(almost_equal(design.b()[1], -2.621583203452076), "design.b()[1] == -2.621583203452076");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.621583203452076));
    static_assert(almost_equal(design.b()[2], 10.486332813808303), "design.b()[2] == 10.486332813808303");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 10.486332813808303));
    static_assert(almost_equal(design.b()[3], -24.46810989888604), "design.b()[3] == -24.46810989888604");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -24.46810989888604));
    static_assert(almost_equal(design.b()[4], 36.70216484832906), "design.b()[4] == 36.70216484832906");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 36.70216484832906));
    static_assert(almost_equal(design.b()[5], -36.70216484832906), "design.b()[5] == -36.70216484832906");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -36.70216484832906));
    static_assert(almost_equal(design.b()[6], 24.46810989888604), "design.b()[6] == 24.46810989888604");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 24.46810989888604));
    static_assert(almost_equal(design.b()[7], -10.486332813808303), "design.b()[7] == -10.486332813808303");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - -10.486332813808303));
    static_assert(almost_equal(design.b()[8], 2.621583203452076), "design.b()[8] == 2.621583203452076");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 2.621583203452076));
    static_assert(almost_equal(design.b()[9], -0.2912870226057862), "design.b()[9] == -0.2912870226057862");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - -0.2912870226057862));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -6.801604866739711), "design.a()[1] == -6.801604866739711");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -6.801604866739711));
    static_assert(almost_equal(design.a()[2], 20.610151918226943), "design.a()[2] == 20.610151918226943");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 20.610151918226943));
    static_assert(almost_equal(design.a()[3], -36.26090008383307), "design.a()[3] == -36.26090008383307");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -36.26090008383307));
    static_assert(almost_equal(design.a()[4], 40.35669955097697), "design.a()[4] == 40.35669955097697");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 40.35669955097697));
    static_assert(almost_equal(design.a()[5], -28.83028298023701), "design.a()[5] == -28.83028298023701");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -28.83028298023701));
    static_assert(almost_equal(design.a()[6], 12.577637115380393), "design.a()[6] == 12.577637115380393");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 12.577637115380393));
    static_assert(almost_equal(design.a()[7], -2.7555713422502928), "design.a()[7] == -2.7555713422502928");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -2.7555713422502928));
    static_assert(almost_equal(design.a()[8], 0.025145268777939545), "design.a()[8] == 0.025145268777939545");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 0.025145268777939545));
    static_assert(almost_equal(design.a()[9], 0.07903755225982144), "design.a()[9] == 0.07903755225982144");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - 0.07903755225982144));
    std::cout << "max_deviation(cheby1,highpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.2912870226057862, -0.64036397287844, 0.1273603116802695, 0.15847300327761138,
      0.1795633343539762, 0.11206461141647739, 0.010456394752392684, -0.08043879812507196,
      -0.12902081584537528, -0.12670359953332622, -0.08495204858784333,
      -0.025895047570119067, 0.028385977386063244, 0.06349900109582704, 0.07536366162249042,
      0.0683199731090971, 0.05079115085153646, 0.030886736144479565, 0.01364159050699032,
      0.000442026010881294, -0.009834821812267747, -0.01898406443629802,
      -0.027938847738256084, -0.03612984067293193, -0.04179695424897978,
      -0.04289947029288482, -0.0381078570849781, -0.02744412213940467,
      -0.012370055768979787, 0.004624328167215294, 0.020708034815708473, 0.033400489313525,
      0.04105716202910306, 0.04305812277969012, 0.039725284267218997, 0.03206822548916344,
      0.02147623239246449, 0.00944693889659401, -0.002605702250075878,
      -0.013464921046897005, -0.022171255420361205, -0.028056990773076912,
      -0.030770400826402977, -0.03028933555933866, -0.026913314286677065,
      -0.021222655209831937, -0.014001038895308626, -0.006129435232673466,
      0.0015310175312294033, 0.008245647070968273, 0.013483617105522865,
      0.01695508231694695, 0.018606974660182657, 0.01858488931529656, 0.01717386657094125,
      0.01473225064869528, 0.011630881949229094, 0.008205999010816159, 0.0047298313682307,
      0.001399026321741846, -0.0016617005739968712, -0.004384911534925989,
      -0.006739680979481792, -0.008709600207699758, -0.010273923316945245,
      -0.011395298511732377, -0.012016231698560975, -0.012064846027480453,
      -0.01146880418442614, -0.010174704484313582, -0.008169129388501256,
      -0.0054970476762378, -0.002273561756035214, 0.0013139913586084542,
      0.005015018559026873, 0.008535346918767308, 0.011565463736864727,
      0.013813785316810795, 0.015040578467468105, 0.015087980418326166,
      0.013902040732445275, 0.01154374230783585, 0.008187378997314185, 0.004106268100036642,
      -0.00035265800413506257, -0.004802502476908489, -0.008854473014738167,
      -0.012156090884217811, -0.014425335022766578, -0.015477087724679997,
      -0.015239228027258717, -0.013756969821521386, -0.011185399862589623,
      -0.007771467364882198, -0.0038277602445238243, 0.0002988421466310967,
      0.004260190674030127, 0.007738162931618175, 0.010471256003238859, 0.01227420985994801,
      0.013049293674860074, 0.012788851088584699, 0.011569615033922342,
      0.009540070797298697, 0.006902697895638396, 0.0038932204989907404,
      0.0007590397042472399, -0.002261163724867004, -0.004955030023025804,
      -0.007150174111602126, -0.008723262125674688, -0.009604381314826223,
      -0.009777003408519377, -0.009274165285872576, -0.008171693008833594,
      -0.006579378210547465, -0.004630996384981462, -0.002473961485039221,
      -0.00025927130503463486, 0.0018677568188830063, 0.0037756060870125716,
      0.005353302460261857, 0.006515633590785122, 0.007206757099546955,
      0.007402147409571763, 0.007108857699926335, 0.006364104430256826,
      0.0052322264846565575, 0.0038001346749057877, 0.0021714495111417598,
      0.00045961919270390283, -0.001219595757791942, -0.00275580418742628,
      -0.0040513131662104455, -0.005027573490153762, -0.005630248562233438,
      -0.005832500898405063, -0.005636223287218793, -0.005071108325322628,
      -0.004191634299479642, -0.0030722278795848844, -0.001801025046816656,
      -0.000472773403868065, 0.000818511866050072, 0.0019865169696253755,
      0.0029586532808497743, 0.003680671202346872, 0.00411954657844445,
      0.004264494456463274, 0.0041261435532076625, 0.0037340707096062097,
      0.003133031272772615, 0.0023783161497861922, 0.001530711947198591,
      0.0006515357015953183, -0.000201835567018545, -0.0009796088612944016,
      -0.0016421746353819655, -0.002161567612787357, -0.0025218154356604194,
      -0.00271830582203832, -0.002756381235831669, -0.0026494166486179214,
      -0.002416649102427705, -0.002081009758311266, -0.001667165572816376,
      -0.0011999166938068719, -0.0007030263273444838, -0.000198491426353903,
      0.0002937967620983619, 0.0007560972677473094, 0.0011726890427371066,
      0.0015296905269179591, 0.0018149402576030822, 0.002018020918159521,
      0.002130470566326814, 0.0021461820439297695, 0.002061950582397847,
      0.001878095548115407, 0.001599059082722171, 0.00123387451240938,
      0.0007964015826648716, 0.00030524296909354137, -0.0002167151101754288,
      -0.0007431592626317657, -0.0012455834240542134, -0.0016948429573959787,
      -0.0020629342172707107, -0.0023248772813235126, -0.0024605613445575596,
      -0.0024564056328987664, -0.002306694225749483, -0.0020144605192842745,
      -0.0015918249621976917, -0.0010597261507296497, -0.00044702778936624166,
      0.00021097058914301518, 0.0008745461088414056, 0.001501973545542508,
      0.002052205030769458, 0.0024876328323085086, 0.002776745217017762,
      0.0028964840192791594, 0.002834124828431473, 0.002588526448779195,
      0.0021706342932034488, 0.0016031705159743285, 0.0009194989794971721,
      0.00016171188630096592, -0.0006219570815372607, -0.0013802353491993566,
      -0.002062228378422833, -0.0026209189791624385, -0.0030165024263052453,
      -0.003219313963342043, -0.003212126717154328, -0.0029916368596553944,
      -0.0025690067052251513, -0.0019694017145882384, -0.0012305294326754208,
      -0.00040026187129024553, 0.0004665078701391557, 0.0013115643221909236,
      0.0020773681234740153, 0.002711071788742402, 0.003168264085746872,
      0.0034161696412441586, 0.0034360663648645012, 0.003224737438732986,
      0.002794843049819074, 0.002174174678093617, 0.001403835789446542,
      0.0005354711237903487, -0.00037226348619206736, -0.0012577429305841033,
      -0.00206064057334405, -0.00272611922687473, -0.0032086477064835334,
      -0.0034751720403187226, -0.003507416734985957, -0.003303153940280721,
      -0.002876352268713595, -0.00225619695617078, -0.001485053162637964,
      -0.0006155187197374561, 0.0002932237786144329, 0.0011794974351483183,
      0.0019833764153265668, 0.002650789633725852, 0.003137198238071407,
      0.003410594356523161, 0.0034536180013284706, 0.0032646522032598185,
      0.002857828780689426, 0.002261953438819967, 0.0015184337566335072,
      0.0006783618355195638, -0.0002010397232404598, -0.0010603580952605325,
      -0.0018420424506611329, -0.002494289182465659, -0.0029744959433428697,
      -0.0032520530777382407, -0.0033102893685695613, -0.003147449330278794,
      -0.002776647231691149, -0.0022248138160681427, -0.0015307203714948186,
      -0.0007422266831980228, 8.704969296927014e-05, 0.0009014087967325815,
      0.0016468342295636214, 0.0022745933841887746, 0.002744430868322491,
      0.003027145534228469, 0.0031063867726424145, 0.002979561390676167,
      0.0026578044619671067, 0.0021650316437819526, 0.00153615217789288,
      0.0008145769630643271, 4.920107859696533e-05, -0.0007089279004420595,
      -0.0014100274196955282, -0.0020088536370051167, -0.0024676158435471864,
      -0.002758344558161877, -0.002864566559020041, -0.002782189369557781,
      -0.0025195523728105997, -0.0020966579888956303, -0.001543650406273465,
      -0.0008986576516341223, -0.00020515224313418044, 0.0004909860984924773,
      0.0011445067851432928, 0.0017137229148557987, 0.0021631545378004054,
      0.0024657146003197704, 0.002604305278581586, 0.002572733939121559,
      0.0023759043384831736, 0.002029286739223396, 0.0015577172015964844,
      0.0009936184296877332, 0.0003747696090781998, -0.00025822139156705297,
      -0.0008645746802295009, -0.0014059509076488558, -0.0018488537755299017,
      -0.0021666739204314143, -0.0023412520089349416, -0.002363872354070963,
      -0.002235636589493977, -0.0019672073674427276, -0.001577952069266371,
      -0.0010945536284808974, -0.0005491875194374666, 2.2611096970046648e-05,
      0.0005842495198596829, 0.0011004010197137215, 0.0015392038039026114,
      0.0018742005609943373, 0.0020859028423002007, 0.002162890380595908,
      0.0021023862325612337, 0.0019102823477336554, 0.0016006246741731359,
      0.0011946000810237663, 0.0007190972200940733, 0.000204938225346573,
      -0.0003151035259737426, -0.0008083734573169923, -0.001244364508676159,
      -0.0015965803089225544, -0.0018441209594898603, -0.001972898507269694,
      -0.001976413390270316, -0.001856051070997478, -0.0016208879837678516,
      -0.0012870259849290383, -0.0008765029070972822, -0.00041585190875283347,
      6.559736668317008e-05, 0.0005375683925995633, 0.0009707229567428905,
      0.001338466101708932, 0.0016185612616391575, 0.001794458883066773,
      0.001856260336406351, 0.0018012619566413167, 0.001634050173002938,
      0.0013661463050219716, 0.0010152270493228189, 0.0006039723147924832,
      0.00015861435994749592, -0.0002927201695377777, -0.0007217717434951439,
      -0.0011019038375760515, -0.0014097451374151535, -0.0016266176356131718,
      -0.0017396639356761154, -0.0017426060386076837, -0.00163609090660774,
      -0.001427603761786243, -0.001130956814760567, -0.0007653872929769927,
      -0.0003543226505036941, 7.610877966991725e-05, 0.00049872793144777,
      0.0008870125230665171, 0.0012167552769336877, 0.0014675695525799594,
      0.0016241488958264397, 0.0016772026046633706, 0.0016240098460504407,
      0.0014685588564994512, 0.0012212638265981426, 0.000898278576719258,
      0.0005204514178584006, 0.00011198807028237967, -0.00030109223148645195,
      -0.0006926094383388607, -0.001037879492929654, -0.0013152704741779342,
      -0.0015075598681757018, -0.0016030075267405557, -0.0015960770572658687,
      -0.0014877608270091151, -0.0012854890358426872, -0.0010026298050058828,
      -0.00065761325608657, -0.00027273645224584406, 0.00012727368535351245,
      0.0005168470840670944, 0.0008712050891662563, 0.0011679383067254544,
      0.0013884270087657063, 0.0015190137216849198, 0.0015518537358561822,
      0.0014853901328447192, 0.001324424177968653, 0.0010797780019892907,
      0.0007675727113818313, 0.0004081697288801766, 2.4844683976889444e-05,
      -0.0003577198384022833, -0.0007150250132408279, -0.0010243272494151984,
      -0.0012660893412903915, -0.0014252183701768673, -0.001492011562926972,
      -0.0014627504967912128, -0.0013399070074351354, -0.0011319494070049611,
      -0.0008527635035903954, -0.0005207277487131526, -0.0001575040161723774,
      0.00021337639644063264, 0.0005680391109644369, 0.0008838061405276204,
      0.001140648960709448, 0.0013224617962774715, 0.001418073911565912,
      0.001421937066862002, 0.0013344457211820863, 0.0011618716071610802,
      0.000915919396569603, 0.0006129346761532626, 0.00027281777242640047,
      -8.228433766186176e-05, -0.0004294219086627976, -0.0007463277798825069,
      -0.0010128478582626475, -0.0012122246361871893, -0.0013321518426605682,
      -0.0013655337590254314, -0.0013109023598533512, -0.001172467957481606,
      -0.0009598029485454046, -0.000687182016967193, -0.00037262419783972746,
      -3.670113201065164e-05, 0.0002988095611204373, 0.0006123375061133029,
      0.0008839075448570776, 0.0010964130393463986, 0.001236693275853776,
      0.001296347122737634, 0.0012722327459823626, 0.0011666239260448227,
      0.0009870159735730407, 0.0007455969390134836, 0.0004584212796434036,
      0.0001443420091087554, -0.0001762275860631734, -0.00048264125791378583,
      -0.0007553497696640636, -0.0009771478264463656, -0.0011342584501420469,
      -0.0012171865419658397, -0.0012212889231879784, -0.001147026931824273,
      -0.0009998884348126017, -0.0007899875294856652, -0.0005313708675035774,
      -0.00024107811531846402, 6.198060705148016e-05, 0.00035825634457848504,
      0.0006288217715666664, 0.0008565792671549237, 0.0010273395768419739,
      0.0011307031486064078, 0.0011606896101315333, 0.001116077589008363,
      0.0010004360584719638, 0.0008218483737295777, 0.0005923498548228278,
      0.0003271179114819568, 4.346914794613665e-05, -0.00024027032817586707,
      -0.0005059477531943126, -0.0007367434512951746, -0.0009182335057509022,
      -0.001039288385911715, -0.0010927517636368156, -0.0010758584012715497,
      -0.0009903671099528591, -0.0008424032404742241, -0.0006420237847001896,
      -0.0004025357432334842, -0.0001396138443471571, 0.00012972398040677333,
      0.0003882164982261828, 0.0006194634854291875, 0.0008089639431756402,
      0.0009450226714935867, 0.0010194687348936676, 0.0010281419339046565,
      0.000971118639226793, 0.0008526652495850556, 0.000680925006944561,
      0.0004673608257357133, 0.00022599209564134722, -2.752385542986605e-05,
      -0.0002769055819640643, -0.0005062911166024671, -0.0007012446027833213,
      -0.0008496622523576428, -0.0009425209619870435, -0.0009744234978747417,
      -0.0009439075560060918, -0.0008535013448583151, -0.0007095246257434245,
      -0.0005216503389817552, -0.0003022570151435819, -6.5615174445483e-05,
      0.00017303895051548905, 0.00039848238758705763, 0.000596474339917533,
      0.0007546535283582435, 0.0008633075798376057, 0.0009159667436877666,
      0.0009097858286806915, 0.0008456920469591331, 0.0007282915315595549,
      0.0005655426931818622, 0.0003682193195603373, 0.00014919946857281687,
      -7.737305521738269e-05, -0.0002970001806664068, -0.0004957554036350779,
      -0.0006611649855945705, -0.0007829888921758775, -0.0008538527118492458,
      -0.0008696916954735422, -0.000829980338394912, -0.0007377347879934677,
      -0.0005992899077035428, -0.0004238671343216984, -0.00022296242292948413,
      -9.594757576528341e-06, 0.00020253577726523622, 0.00039992603780601775,
      0.0005701278133092482, 0.0007025313581798145, 0.0007890252454348214,
      0.0008244916015774754, 0.0008071065950955841, 0.0007384286891154246,
      0.0006232708151363174, 0.00046936640373823786, 0.0002868522427293971,
      8.760260066837896e-05, -0.00011554176257221906, -0.0003095997423698978,
      -0.0004822781328595342, -0.0006227492045573877, -0.0007223285065672339,
      -0.0007750105341633026, -0.0007778292959734513, -0.0007310222328792996,
      -0.0006379886403728831, -0.0005050469088214429, -0.0003410076800210806,
      -0.0001565916122311761, 3.62698797880881e-05, 0.00022520538991057526,
      0.0003981960752142172, 0.0005443392903225711, 0.0006545348385788435,
      0.0007220506962809558, 0.0007429330949897551, 0.0007162360524496656,
      0.0006440571572561577, 0.000531378877174281, 0.00038572707493809673,
      0.00021666998672227253, 3.519091531338416e-05, -0.0001470243136028111,
      -0.0003183389683910616, -0.00046790780981605714, -0.0005863629506268212,
      -0.0006663998417405538, -0.0007032267719227327, -0.0006948502748820888,
      -0.000642179537120262, -0.000548944595005629, -0.00042143504539887385,
      -0.00026807740617814, -9.887942599591678e-05, 7.52220832106466e-05,
      0.00024306744609802952, 0.0003939887992833492, 0.0005184875097848504,
      0.0006088313531944678, 0.000659533943018549, 0.0006676867314401192, 0.000633123565292,
      0.0005584086466867274, 0.00044865011101957123, 0.0003111525651807107,
      0.0001549321157385125, -9.873983449021958e-06, -0.0001726644596000498,
      -0.0003230553672442792, -0.000451541894836585, -0.0005500984833763239,
      -0.0006126794004709152, -0.0006355885912973508, -0.0006176962453307011,
      -0.0005604895072324669, -0.00046795547144816256, -0.00034630534152395526,
      -0.00020355871933723383, -4.901577651365255e-05, 0.00010734800123343328,
      0.0002555251448529259, 0.00038611615102738953, 0.0004909251577778742,
      0.0005634736309984029, 0.0005993999084965636, 0.0005967200202526002,
      0.0005559342841791907, 0.00047997417183780243, 0.0003739942010123425,
      0.000245023482823271, 0.00010150040193880258, -4.727881819510476e-05,
      -0.00019176166918719853, -0.0003227521381491186, -0.0004319954383857293,
      -0.0005126975455418095, -0.000559946883436056, -0.0005710120426907377,
      -0.0005454975679396968, -0.00048534908033985667, -0.0003947087114709335,
      -0.0002796313872631645, -0.00014768130598391224, -7.435445968951735e-06,
      0.00013207335094269444, 0.00026193759500404, 0.0003739432997772621,
      0.00046108886719143033, 0.0005180219706586897, 0.0005413672289112338,
      0.0005299246824330382, 0.00048472751783746335, 0.0004089565833690807,
      0.0003077184133794095, 0.00018770214394987555, 5.673830647707763e-05,
      -7.671144569732717e-05, -0.00020410046486339086, -0.0003173438796679109,
      -0.00040933106748789524, -0.0004743713869714474, -0.0005085452801211103,
      -0.0005099391459105758, -0.0004787500041886143, -0.0004172544110516447,
      -0.0003296448081886571, -0.00022174492923397997, -0.00010062350917990114,
      2.5868131278779043e-05, 0.00014960441848128412, 0.0002627069022715546,
      0.00035804526089597494, 0.0004296861161100342, 0.00047326145530546173,
      0.0004862338415421801, 0.00046804238584737326, 0.00042012121261352994,
      0.00034579036448764613, 0.0002500272390996987, 0.00013913420681997126,
      2.032454922180568e-05, -9.874612282431203e-05, -0.0002104725718186055,
      -0.0003077850863806486, -0.0003845961755260009, -0.0004361806244902039,
      -0.0004594652354529098, -0.0004532105513586613, -0.00041807391292021786,
      -0.0003565508681386458, -0.00027279974529264856, -0.0001723616159497632,
      -6.179444418056429e-05, 5.175446997134352e-05, 0.00016100991845691972,
      0.0002590343334495672, 0.00033966770348843166, 0.0003979140028640953,
      0.0004302499382087058, 0.00043483698683360146, 0.0004116240405992134,
      0.00036233506218741503, 0.0002903435483238353, 0.00020044280277143646,
      9.852759241581036e-05, -8.79172115658103e-06, -0.00011461735744734423,
      -0.00021220690361695898, -0.00029540232487940826, -0.000359017938840796,
      -0.0003991629506113082, -0.00041347853446315527, -0.0004012750755625393,
      -0.0003635616819817481, -0.00030296702070461545, -0.00022355747475789238,
      -0.0001305651189172027, -3.0043657760878205e-05, 7.152509065275038e-05,
      0.00016764862230060022, 0.0002522382384118752, 0.0003199941730477366,
      0.0003667370325566642, 0.00038966485922157503, 0.0003875200568417337,
      0.0003606563046248102, 0.0003110020535432587, 0.00024192382854223765,
      0.00015799892628458713, 6.471279752815547e-05, -3.189892217160241e-05,
      -0.00012564040941014473, -0.00021055251055387275, -0.00028129107201491847,
      -0.00033346275620224305, -0.0003638972759387408, -0.0003708392192651147,
      -0.00035404791320003135, -0.00031479974355817656, -0.00025579362151952187,
      -0.00018096646331572852, -9.523123387161574e-05, -4.1549399393707226e-06,
      8.640235808602496e-05, 0.0001706641391247921, 0.0002433054470229373,
      0.00029978893074919456, 0.00033664772342299537, 0.0003516975591508348,
      0.00034416519425725265, 0.00031472565272549786, 0.00026544669973129755,
      0.00019964488280419662, 0.00012166308806623046, 3.6584484008834735e-05,
      -5.009834117757913e-05, -0.00013283754325036924, -0.00020638467750396406,
      -0.0002661232009120015, -0.0003083577833285882, -0.0003305423274460144,
      -0.00033143266485311093, -0.00031115482432530865, -0.0002711852364035805,
      -0.00021424489170335042, -0.00014411494672306332, -6.538622207006152e-05,
      1.6840847644783853e-05, 9.728623102722733e-05, 0.00017082895705716901,
      0.000232832715650818, 0.0002794377241947695, 0.0003078005132693951,
      0.0003162667669837863, 0.00030446675494057206, 0.000273327924942713,
      0.00022500456145190667, 0.00016272971119810856, 9.059949635739097e-05,
      1.3304166472587024e-05, -6.417648150057047e-05, -0.00013689356118733788,
      -0.00020024483411224068, -0.0002502656053433507, -0.00028387641497840425,
      -0.000299072079061412, -0.0002950405110387906, -0.0002722043379941642,
      -0.0002321833159246653, -0.00017768062308784233, -0.00011230094514607281,
      -4.0312553760997265e-05, 3.3630947718482564e-05, 0.00010479109652548248,
      0.0001686478822205972, 0.00022118650428379588, 0.00025914940543265205,
      0.0002802377839634263, 0.00028325015030212933, 0.0002681496201355567,
      0.00023605625882038104, 0.0001891656097862042, 0.00013059924396969678,
      6.419745847046135e-05, -5.732139908268231e-06, -7.469373130538304e-05,
      -0.00013829199823886198, -0.00019251193943144607, -0.0002339719893572948,
      -0.00026013450863977697, -0.00026946056992396654, -0.0002614996337953943,
      -0.00023690894836028232, -0.00019740203861212387, -0.0001456301856841691,
      -8.500504194637755e-05, -1.9474216963031752e-05, 4.6735429225968196e-05,
      0.00010939011371875599, 0.00016451955356346808, 0.00020866823077399688,
      0.00023911161874469455, 0.0002540238638195993, 0.0002525866324054908,
      0.00023503268003062603, 0.0002026219230875342, 0.00015755212360928994,
      0.00010281045489917589, 4.197593713839865e-05, -2.1014216652988544e-05,
      -8.211911180532305e-05, -0.00013745310742254753, -0.00018353260249848093,
      -0.00021749501817707492, -0.00023727623236873365, -0.00024173549486743032,
      -0.00023072029975279356, -0.0002050675911227473, -0.00016654177517955952,
      -0.00011771404304137265, -6.179121749879681e-05, -2.4054892269190415e-06,
      5.662119278995003e-05, 0.00011152281235704634, 0.00015882928263156342,
      0.0001955854721369106, 0.0002195354554194362, 0.00022926052354152048,
      0.00022426254146266878, 0.00020498780202846427, 0.00017279036784493954,
      0.00012983776504240426, 7.896554926320118e-05, 2.349047254044084e-05,
      -3.3005460918684716e-05, -8.690600947673064e-05, -0.00013479189792721575,
      -0.00017365744573089926, -0.00020109891331963978, -0.00021546278462269823,
      -0.0002159448640782274, -0.00020263428592115084, -0.0001765001020694872,
      -0.000139321801585034, -9.35686830399056e-05, -4.2236224358304254e-05,
      1.1349729995191265e-05, 6.374818331883896e-05, 0.00011162369307381648,
      0.00015195842963694234, 0.00018224212212938906, 0.00020062795443175443,
      0.00020604475182357676, 0.0001982586730654495, 0.0001778809054805092,
      0.00014632133855652161, 0.00010569164102807588, 5.866436731713845e-05,
      8.297469387927878e-06, -4.2164282183618253e-05, -8.949808928033261e-05,
      -0.0001307087101291193, -0.00016321773746616258, -0.00018502462677373295,
      -0.0001948294373332101, -0.0001921097801559999, -0.00017714745551951306,
      -0.00015100351407856837, -0.00011544377949295782, -7.282001580743254e-05,
      -2.5914709997777513e-05, 2.224030569863858e-05, 6.855958513250594e-05,
      0.00011010153229633801, 0.00014425497550783523, 0.00016890303347024847,
      0.0001825540068834267, 0.00018443122326708633, 0.00017451645308407828,
      0.0001535445260559521, 0.0001229499127522321, 8.476909679395095e-05,
      4.150535261295788e-05, -4.0351131151089114e-06, -4.892494724138603e-05,
      -9.030360184307068e-05, -0.0001255593984198271, -0.00015249413108692775,
      -0.00016945984997851385, -0.0001754593316750867, -0.00017020413522957837,
      -0.0001541269030422615, -0.0001283475159857821, -9.459566181820923e-05,
      -5.509513672646491e-05, -1.2417597177539813e-05, 3.0684636804670606e-05,
      7.145587112751623e-05, 0.00010731301331108384, 0.00013600901005208696,
      0.00015577341968526397, 0.00016542134149206728, 0.00016442401983747762,
      0.00015293694570195815, 0.0001317840278851495, 0.00010239922331762511,
      6.672972007847609e-05, 2.7107186200984003e-05, -1.3904419867361495e-05,
      -5.367455803230812e-05, -8.96746377584238e-05, -0.00011963858692203033,
      -0.00014170527486443275, -0.0001545338525527723, -0.0001573848789859693,
      -0.00015016234894091535, -0.00013341427565051575, -0.00010829214844150785,
      -7.647220838644336e-05, -4.00438975386696e-05, -1.372887099580181e-06,
      3.705235083705027e-05, 7.27804898419744e-05, 0.000103553545337698,
      0.0001274493796903117, 0.0001430015353084648, 0.00014928893983586226,
      0.00014599001542555897, 0.00013339804399014948, 0.00011239714124673499,
      8.440071307659342e-05, 5.1256647079996965e-05, 1.5125579521937601e-05,
      -2.1659757625065593e-05, -5.674496576682213e-05, -8.79044957058366e-05,
      -0.00011318263933223069, -0.00013101607667582115, -0.00014033031257098053,
      -0.0001406040704037176, -0.00013189780749249286, -0.00011484484056564835,
      -9.060597020093186e-05, -6.0790816059159395e-05, -2.73511726174685e-05,
      7.546564124941759e-06, 4.166157290820428e-05, 7.282232741302337e-05,
      9.906465315447235e-05, 0.0001187553547743064, 0.00013069364433264624,
      0.0001341840855931737, 0.0001290766422062527, 0.00011577155618533984,
      9.518904830858898e-05, 6.870607832772449e-05, 3.806448686598891e-05,
      5.2566309666168235e-06, -2.7603990354816296e-05, -5.841873039714237e-05,
      -8.523766837058636e-05, -0.00010638283252391951, -0.00012055299659847378,
      -0.00012690351701445473, -0.00012509632820487462, -0.00011531716106356438,
      -9.825916764561935e-05, -7.507428733010833e-05, -4.7295737918584785e-05,
      -1.673682970691824e-05, 1.462723241773017e-05, 4.478686501485196e-05,
      7.182671777447434e-05, 9.404715929186354e-05, 0.00011007094126933156,
      0.00011892835822484423, 0.00012011565051867339, 0.00011362315226913196,
      9.993164774909312e-05, 7.997744306066754e-05, 5.508865311209816e-05,
      2.689702032696988e-05, -2.7688933561462723e-06, -3.200216065690233e-05,
      -5.893992532989871e-05, -8.188196859911905e-05, -9.939786832820273e-05,
      -0.00011041600698854007, -0.00011428890164393447, -0.00011083088872673892,
      -0.00010032599580122616, -8.350575482922147e-05, -6.149863286600992e-05,
      -3.575455394234125e-05, -7.949546401612176e-06, 2.0123224435168174e-05,
      4.666896307866942e-05, 7.000585843064373e-05, 8.867149544927901e-05,
      0.00010151434011096742, 0.0001077645849594718, 0.00010708000967874919,
      9.956414394896615e-05, 8.575581179533361e-05, 6.659097192387563e-05,
      4.33395295968162e-05, 1.7521370626441806e-05
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.2912870226057862, -0.6403639728784398, 0.12736031168027004, 0.15847300327761277,
      0.17956333435398306, 0.1120646114165084, 0.01045639475249147, -0.0804387981248332,
      -0.12902081584490632, -0.12670359953254484, -0.08495204858671164,
      -0.025895047568678973, 0.02838597738766766, 0.06349900109735024, 0.07536366162361248,
      0.06831997310947288, 0.05079115085085696, 0.030886736142533112, 0.01364159050371203,
      0.0004420260063823962, -0.009834821817695103, -0.018984064442200698,
      -0.027938847744061718, -0.03612984067800737, -0.04179695425269969,
      -0.04289947029470319, -0.03810785708449498, -0.027444122136420838,
      -0.012370055763532816, 0.004624328174838446, 0.020708034824984872,
      0.03340048932373485, 0.04105716203939125, 0.043058122789144275, 0.03972528427495589,
      0.03206822549441479, 0.021476232394653405, 0.009446938895394264,
      -0.0026057022547034915, -0.013464921054694871, -0.022171255430792416,
      -0.028056990785368295, -0.030770400839609337, -0.03028933557242204,
      -0.026913314298593664, -0.021222655219618795, -0.014001038902162602,
      -0.006129435236016021, 0.0015310175317065121, 0.008245647075279479,
      0.013483617113388656, 0.016955082327816465, 0.018606974673276724,
      0.018584889329667523, 0.017173866585544616, 0.014732250662467652,
      0.011630881961166337, 0.008205999020045996, 0.0047298313740746535,
      0.0013990263237625856, -0.0016617005759654781, -0.00438491154076768,
      -0.006739680988805997, -0.008709600219868292, -0.010273923331115872,
      -0.011395298526916554, -0.012016231713692111, -0.0120648460414883,
      -0.011468804196312351, -0.010174704493223172, -0.008169129393784728,
      -0.005497047677499255, -0.0022735617531626814, 0.001313991365433035,
      0.005015018569339031, 0.008535346931852176, 0.011565463751807687,
      0.013813785332562934, 0.01504057848292167, 0.015087980432394406, 0.013902040744140715,
      0.011543742316341234, 0.008187379002040864, 0.00410626810066618,
      -0.0003526580076290445, -0.004802502484259803, -0.008854473025408894,
      -0.012156090897438845, -0.014425335037594706, -0.01547708774006703,
      -0.015239228042127281, -0.013756969834841558, -0.011185399873450722,
      -0.007771467372554772, -0.0038277602485077902, 0.0002988421465750662,
      0.004260190677867692, 0.0077381629390474, 0.010471256013714549, 0.012274209872722328,
      0.013049293689036474, 0.012788851103181268, 0.011569615047940032,
      0.009540070809789648, 0.006902697905769658, 0.003893220506099085,
      0.000759039707881506, -0.0022611637249185758, -0.004955030026724731,
      -0.0071501741186656715, -0.008723262135597886, -0.009604381326918156,
      -0.009777003421951105, -0.009274165299733442, -0.008171693022192249,
      -0.0065793782225136615, -0.004630996394764674, -0.002473961492000379,
      -0.0002592713087277871, 0.0018677568186817003, 0.003775606090290433,
      0.005353302466770961, 0.006515633600059426, 0.007206757110934418,
      0.0074021474222795355, 0.007108857713076041, 0.006364104442946136,
      0.005232226496022564, 0.0038001346841854363, 0.002171449517724789,
      0.0004596191961743015, -0.001219595757628973, -0.002755804190533685,
      -0.004051313172325497, -0.0050275734988102765, -0.005630248572798079,
      -0.005832500910124775, -0.005636223299275714, -0.005071108336892347,
      -0.004191634309788538, -0.0030722278879624343, -0.0018010250527391036,
      -0.00047277340699059943, 0.000818511865874545, 0.0019865169723417165,
      0.0029586532862101206, 0.0036806712099329624, 0.004119546587700723,
      0.00426449446673806, 0.004126143563799375, 0.0037340707198112474,
      0.0031330312819317324, 0.0023783161573263586, 0.001530711952667802,
      0.0006515357046883993, -0.0002018355664444672, -0.0009796088632153884,
      -0.0016421746396136365, -0.002161567619001374, -0.0025218154434096867,
      -0.002718305830788996, -0.0027563812449997176, -0.0026494166576077347,
      -0.0024166491106702784, -0.002081009765299527, -0.0016671655781355442,
      -0.0011999166971581252, -0.0007030263285606835, -0.00019849142540665784,
      0.0002937967651004792, 0.0007560972725690354, 0.0011726890490343944,
      0.0015296905342622167, 0.0018149402655100728, 0.002018020926121004,
      0.002130470573842865, 0.002146182050539721, 0.0020619505877079404,
      0.001878095551821535, 0.0015990590846264613, 0.001233874512429791,
      0.0007964015808374318, 0.0003052429655673299, -0.0002167151151500308,
      -0.0007431592687206393, -0.0012455834308616658, -0.001694842964490067,
      -0.002062934224210151, -0.0023248772876845493, -0.002460561349959219,
      -0.0024564056370250564, -0.0023066942283672892, -0.002014460520255976,
      -0.0015918249614878474, -0.001059726148405475, -0.00044702778559195636,
      0.00021097059411752253, 0.0008745461146968315, 0.0015019735519102612,
      0.002052205037254416, 0.002487632838513035, 0.002776745222565574,
      0.0028964840238376705, 0.002834124831731326, 0.002588526450629875,
      0.0021706342935040876, 0.0016031705147190954, 0.0009194989767749332,
      0.00016171188228927022, -0.0006219570865834754, -0.0013802353549636152,
      -0.0020622283845465527, -0.0026209189852667747, -0.0030165024320140854,
      -0.0032193139683048145, -0.0032121267210673014, -0.002991636862280206,
      -0.0025690067064034197, -0.0019694017142513286, -0.0012305294308487115,
      -0.0004002618680915788, 0.0004665078745067873, 0.0013115643274520332,
      0.002077368129297842, 0.0027110717947636093, 0.003168264091588426,
      0.0034161696465409277, 0.00343606636928609, 0.0032247374420043672,
      0.002794843051737728, 0.002174174678542104, 0.0014038357883997409,
      0.000535471121316917, -0.00037226348993406636, -0.0012577429353571156,
      -0.0020606405788458613, -0.002726119232757314, -0.0032086477123747857,
      -0.003475172045845771, -0.003507416739798602, -0.003303153944073549,
      -0.002876352271245392, -0.0022561969572800263, -0.0014850531622534178,
      -0.0006155187178831123, 0.00029322378182040004, 0.0011794974395006675,
      0.001983376420545812, 0.002650789639476057, 0.0031371982439818494,
      0.003410594362212443, 0.0034536180064294562, 0.0032646522074436936,
      0.0028578287836872347, 0.002261953440440165, 0.001518433756774322,
      0.0006783618341753601, -0.0002010397259791815, -0.0010603580992134074,
      -0.00184204245556997, -0.002494289188011396, -0.0029744959491663143,
      -0.003252053083463276, -0.0033102893738273416, -0.0031474493347314137,
      -0.002776647235053315, -0.0022248138181254953, -0.0015307203721177387,
      -0.0007422266823500403, 8.704969522903939e-05, 0.0009014088002531771,
      0.0016468342341119772, 0.002274593389464877, 0.0027444308739790137,
      0.0030271455398936187, 0.003106386777944487, 0.0029795613952681545,
      0.0026578044655496884, 0.0021650316461232946, 0.0015361521788438896,
      0.0008145769625683386, 4.920107669320787e-05, -0.0007089279036214244,
      -0.0014100274239345796, -0.002008853642018914, -0.0024676158490010537,
      -0.002758344563693913, -0.00286456656426531, -0.002782189374172546,
      -0.0025195523764949715, -0.002096657991413138, -0.0015436504074662712,
      -0.0008986576514329132, -0.00020515224156211819, 0.0004909861013219474,
      0.0011445067890345697, 0.0017137229195445997, 0.002163154542971665,
      0.002465714605628774, 0.0026043052836769495, 0.002572733943668539,
      0.0023759043421857557, 0.0020292867418436806, 0.00155771720297008,
      0.0009936184297341475, 0.0003747696078055663, -0.0002582213940631921,
      -0.0008645746837732302, -0.0014059509119962346, -0.0018488537803857728,
      -0.0021666739254695274, -0.002341252013820025, -0.0023638723584812338,
      -0.0022356365931425386, -0.001967207370096401, -0.0015779520707606904,
      -0.0010945536287302977, -0.0005491875184400355, 2.261109913348458e-05,
      0.0005842495230320132, 0.0011004010236730212, 0.0015392038083778376,
      0.0018742005656841108, 0.0020859028468933607, 0.002162890384792401,
      0.0021023862360918895, 0.0019102823503775114, 0.0016006246757711915,
      0.0011946000814883342, 0.0007190972194132193, 0.00020493822358346223,
      -0.0003151035286864385, -0.000808373460787149, -0.0012443645126659474,
      -0.0015965803131648825, -0.0018441209637063529, -0.001972898511188984,
      -0.001976413393645434, -0.0018560510736212277, -0.0016208879854852246,
      -0.0012870259856459735, -0.0008765029067853274, -0.0004158519074495419,
      6.559736887800982e-05, 0.0005375683955315123, 0.0009707229602136889,
      0.0013384661054898263, 0.0016185612654858476, 0.0017944588867350316,
      0.0018562603396673355, 0.001801261959295638, 0.0016340501748926255,
      0.001366146306039624, 0.0010152270494174262, 0.0006039723139716409,
      0.00015861435827596096, -0.00029272017194302037, -0.0007217717464729455,
      -0.0011019038409317613, -0.0014097451409331983, -0.001626617639070766,
      -0.0017396639388572463, -0.0017426060413165058, -0.001636090908680547,
      -0.0014276037631012874, -0.0011309568152451479, -0.0007653872926114146,
      -0.0003543226493218814, 7.610878158316677e-05, 0.0004987279339627066,
      0.0008870125260171554, 0.0012167552801287493, 0.0014675695558153175,
      0.0016241488988982388, 0.0016772026073809526, 0.0016240098482482237,
      0.0014685588580469905, 0.0012212638274077439, 0.0008982785767506947,
      0.0005204514171205024, 0.00011198806883149606, -0.00030109223355090137,
      -0.0006926094408813446, -0.0010378794957874651, -0.0013152704771714977,
      -0.0015075598711196197, -0.0016030075294547494, -0.0015960770595862077,
      -0.0014877608287969693, -0.0012854890369929104, -0.00100262980545281,
      -0.0006576132558076985, -0.0002727364512629849, 0.00012727368697568552,
      0.0005168470862250261, 0.0008712050917238129, 0.0011679383095222024,
      0.0013884270116267016, 0.001519013724431437, 0.0015518537383167469,
      0.0014853901348657616, 0.0013244241794241086, 0.0010797780027885313,
      0.0007675727114754218, 0.00040816972826308797, 2.4844682688947086e-05,
      -0.00035771984027876676, -0.0007150250155861147, -0.0010243272520795944,
      -0.0012660893441036798, -0.0014252183729591297, -0.0014920115655001167,
      -0.0014627504989904656, -0.001339907009119735, -0.0011319494080673407,
      -0.0008527635039632302, -0.0005207277483737936, -0.0001575040151443705,
      0.00021337639808905628, 0.0005680391131248218, 0.0008838061430584217,
      0.0011406489634453742, 0.0013224617990404066, 0.001418073914176673,
      0.0014219370691521249, 0.0013344457230048336, 0.0011618716084009163,
      0.0009159193971495107, 0.0006129346760394473, 0.0002728177716301242,
      -8.228433908538306e-05, -0.00042942191061831343, -0.0007463277822411783,
      -0.0010128478608705832, -0.0012122246388755122, -0.0013321518452563612,
      -0.0013655337613628585, -0.0013109023617842326, -0.0011724679588847702,
      -0.0009598029493342256, -0.0006871820170948533, -0.00037262419730189466,
      -3.670113084544043e-05, 0.00029880956283518143, 0.0006123375082651964,
      0.0008839075473065232, 0.0010964130419355734, 0.0012366932784167234,
      0.0012963471251108297, 0.001272232748015091, 0.0011666239276087046,
      0.000987015974570108, 0.0007455969393822932, 0.00045842127936281314,
      0.00014434200819914104, -0.00017622758754131472, -0.0004826412598637538,
      -0.0007553497719591543, -0.0009771478289379806, -0.0011342584526692185,
      -0.00121718654436558, -0.0012212889253057973, -0.0011470269335241772,
      -0.0009998884359859138, -0.000789987530058081, -0.000531370867439991,
      -0.00024107811462523504, 6.198060832697103e-05, 0.00035825634635097095,
      0.0006288217737186264, 0.0008565792695443541, 0.0010273395793117953,
      0.0011307031509948876, 0.001160689612283018, 0.001116077590783591,
      0.0010004360597572475, 0.0008218483744442177, 0.0005923498549242417,
      0.00032711791096818357, 4.346914685557361e-05, -0.0002402703297674314,
      -0.0005059477551791166, -0.000736743453540938, -0.0009182335081097768,
      -0.0010392883882301088, -0.0010927517657654262, -0.0010758584030749448,
      -0.0009903671113179917, -0.0008424032413173676, -0.0006420237849718986,
      -0.000402535742921328, -0.0001396138434761133, 0.00012972398177624322,
      0.0003882165000022325, 0.0006194634874946026, 0.0008089639453954092,
      0.0009450226737235734, 0.0010194687369898577, 0.0010281419357324045,
      0.0009711186406694821, 0.0008526652505516121, 0.0006809250073753247,
      0.00046736082560626017, 0.00022599209496398663, -2.7523856607037944e-05,
      -0.00027690558356050285, -0.0005062911185106834, -0.0007012446048761725,
      -0.0008496622544969033, -0.0009425209640326587, -0.0009744234996941244,
      -0.0009439075574828275, -0.0008535013458996927, -0.0007095246262862956,
      -0.0005216503389963473, -0.00030225701463503944, -6.561517345306605e-05,
      0.0001730389519214555, 0.0003984823893102414, 0.0005964743418422866,
      0.0007546535303574553, 0.0008633075817811661, 0.0009159667454510752,
      0.0009097858301526386, 0.0008456920480490431, 0.0007282915322026707,
      0.0005655426933430566, 0.0003682193192358651, 0.00014919946779004358,
      -7.737305640221221e-05, -0.00029700018217218235, -0.0004957554053613399,
      -0.0006611649874281644, -0.0007829888939983157, -0.000853852713544305,
      -0.0008696916969346144, -0.0008299803395316405, -0.0007377347887372541,
      -0.000599289908011601, -0.0004238671341794326, -0.00022296242235107395,
      -9.594756603706986e-06, 0.00020253577856611812, 0.0003999260393484504,
      0.0005701278149922587, 0.00070253135989454, 0.0007890252470715334,
      0.0008244916030326003, 0.0008071065962782615, 0.0007384286899531824,
      0.0006232708155795026, 0.0004693664037629252, 0.0002868522423386038,
      8.760259989153088e-05, -0.00011554176368150325, -0.0003095997437375239,
      -0.00048227813439588254, -0.0006227492061631608, -0.0007223285081398252,
      -0.0007750105356032885, -0.0007778292971908082, -0.000731022233798972,
      -0.0006379886409393677, -0.0005050469090021159, -0.00034100767980807116,
      -0.00015659161164167297, 3.626988071311606e-05, 0.00022520539110916615,
      0.0003981960766075314, 0.0005443392918200648, 0.0006545348400841582,
      0.0007220506976981333, 0.0007429330962293742, 0.0007162360534345012,
      0.0006440571579260029, 0.0005313788774896236, 0.00038572707488242745,
      0.0002166699863028926, 3.5190914560681344e-05, -0.00014702431463755572,
      -0.00031833896963918024, -0.00046790781119607515, -0.0005863629520498012,
      -0.000666399843115848, -0.000703226773163766, -0.0006948502759117978,
      -0.0006421795378758455, -0.0005489445954423225, -0.00042143504549252913,
      -0.00026807740592647394, -9.887942541837766e-05, 7.52220840743631e-05,
      0.000243067447190699, 0.00039398880053398487, 0.0005184875111132707,
      0.0006088313545163772, 0.0006595339442508181, 0.0006676867325059437,
      0.00063312356612563, 0.0005584086472374846, 0.0004486501112549167,
      0.0003111525650881798, 0.0001549321153263951, -9.873984152296865e-06,
      -0.0001726644605477937, -0.0003230553683745755, -0.0004515418960762867,
      -0.000550098484645765, -0.0006126794016890324, -0.0006355885923868818,
      -0.0006176962462231176, -0.0005604895078723236, -0.0004679554717965819,
      -0.00034630534156102543, -0.00020355871906317029, -4.9015775948652565e-05,
      0.00010734800205062766, 0.00025552514586765947, 0.0003861161521727447,
      0.0004909251589790992, 0.000563473632177821, 0.000599399909578635,
      0.0005967200211687961, 0.0005559342848723534, 0.00047997417226570716,
      0.00037399420115023893, 0.00024502348266525106, 0.00010150040149792821,
      -4.727881888789631e-05, -0.00019176167008531206, -0.00032275213919347125,
      -0.00043199543950865046, -0.00051269754667141, -0.0005599468845007862,
      -0.000571012043623851, -0.0005454975686833502, -0.00048534908084861176,
      -0.0003947087117144628, -0.00027963138722801486, -0.0001476813056742259,
      -7.435445406106006e-06, 0.00013207335172150893, 0.00026193759594821814,
      0.00037394330082601477, 0.0004610888682776483, 0.0005180219717132002,
      0.0005413672298671823, 0.0005299246832301225, 0.00048472751842574895,
      0.00040895658371215503, 0.0003077184134566716, 0.00018770214375780916,
      5.673830602941797e-05, -7.671144637054894e-05, -0.00020410046571786342,
      -0.00031734388064798155, -0.00040933106853023046, -0.0004743713880091651,
      -0.000508545281088106, -0.0005099391467457533, -0.0004787500048397467,
      -0.0004172544114786223, -0.00032964480836592826, -0.0002217449291520455,
      -0.00010062350884578445, 2.5868131842102127e-05, 0.00014960441923645237,
      0.0002627069031692823, 0.00035804526187825024, 0.0004296861171138524,
      0.00047326145626685426, 0.0004862338424002812, 0.00046804238654826204,
      0.00042012121311360085, 0.0003457903647562934, 0.00025002723912115506,
      0.00013913420659420036, 2.0324548764410592e-05, -9.87461234831453e-05,
      -0.00021047257263605762, -0.00030778508730399095, -0.00038459617649593344,
      -0.00043618062544460896, -0.0004594652363307947, -0.00045321055210404256,
      -0.00041807391348570037, -0.00035655086848846595, -0.00027279974540497863,
      -0.0001723616158181188, -6.179444381421723e-05, 5.175447054797768e-05,
      0.00016100991920587915, 0.00025903433432182153, 0.0003396677044270785,
      0.00039791400380806885, 0.0004302499390967572, 0.00043483698760829275,
      0.00041162404121066165, 0.00036233506259654007, 0.00029034354850489616,
      0.0002004428027136879, 9.852759212417218e-05, -8.791721661886975e-06,
      -0.00011461735813216673, -0.00021220690443551015, -0.00029540232577732434,
      -0.000359017939758763, -0.0003991629514890099, -0.000413478535243278,
      -0.0004012750761945606, -0.0003635616824252561, -0.0003029670209319337,
      -0.00022355747475583714, -0.0001305651186878542, -3.0043657321320126e-05,
      7.152509127169787e-05, 0.00016764862305655874, 0.0002522382392538404,
      0.00031999417391955794, 0.00036673703340083126, 0.00038966485998305,
      0.0003875200574715693, 0.0003606563050833095, 0.0003110020538024712,
      0.00024192382858763214, 0.0001579989261158037, 6.471279715880511e-05,
      -3.189892271505397e-05, -0.00012564041009031226, -0.00021055251132505825,
      -0.00028129107282620397, -0.00033346275700085916, -0.00036389727667348866,
      -0.000370839219889621, -0.00035404791367563213, -0.0003147997438562554,
      -0.0002557936216231649, -0.00018096646322060742, -9.523123358606116e-05,
      -4.154939483653352e-06, 8.640235868114183e-05, 0.00017066413982012212,
      0.0002433054477734249, 0.00029978893150679135, 0.00033664772413968314,
      0.00035169755978161314, 0.0003441651947629136, 0.0003147256530750231,
      0.0002654466999037395, 0.00019964488278992836, 0.00012166308786748915,
      3.658448363952093e-05, -5.009834169283582e-05, -0.00013283754387782232,
      -0.00020638467820293898, -0.00026612320163752086, -0.0003083577840342634,
      -0.00033054232808701586, -0.00033143266538902496, -0.00031115482472269797,
      -0.00027118523663808425, -0.00021424489176119052, -0.00014411494660186223,
      -6.538622177892112e-05, 1.684084808594495e-05, 9.728623158903006e-05,
      0.00017082895770273088, 0.00023283271633817924, 0.0002794377248796273,
      0.00030780051390796523, 0.0003162667675356048, 0.0003044667553710567,
      0.0002733279252253215, 0.00022500456156975587, 0.00016272971114495802,
      9.059949613793814e-05, 1.3304166102065596e-05, -6.41764819974539e-05,
      -0.00013689356177805484, -0.0002002448347585697, -0.0002502656060038454,
      -0.00028387641561104224, -0.0002990720796262559, -0.0002950405115004933,
      -0.0002722043383241623, -0.00023218331610292805, -0.0001776806231040736,
      -0.00011230094500029762, -4.031255346349983e-05, 3.363094814786299e-05,
      0.00010479109705865414, 0.0001686478828230356, 0.00022118650491676655,
      0.00025914940605569387, 0.00028023778453693565, 0.0002832501507898772,
      0.00026814962050697715, 0.00023605625905248674, 0.0001891656098650103,
      0.00013059924389106702, 6.419745824032712e-05, -5.7321402743282785e-06,
      -7.469373178317637e-05, -0.0001382919987971647, -0.00019251194003403515,
      -0.0002339719899652994, -0.00026013450921419547, -0.00026946057042818343,
      -0.00026149963419753075, -0.00023690894863522775, -0.00019740203874311793,
      -0.00014563018566383248, -8.500504177712498e-05, -1.947421665684301e-05,
      4.673542964839838e-05, 0.00010939011422942524, 0.00016451955412893096,
      0.00020866823135755962, 0.0002391116193087955, 0.00025402386432822285,
      0.00025258663282646377, 0.00023503268033765374, 0.00020262192326184824,
      0.00015755212364080244, 0.0001028104547870647, 4.197593689108785e-05,
      -2.1014217018448177e-05, -8.211911226442724e-05, -0.0001374531079449833,
      -0.00018353260305013108, -0.00021749501872224888, -0.00023727623287247914,
      -0.00024173549529777675, -0.00023072030008278302, -0.00020506759133212142,
      -0.00016654177525599634, -0.00011771404298119741, -6.179121730712811e-05,
      -2.4054889172472527e-06, 5.6621193196717534e-05, 0.00011152281283400397,
      0.00015882928314759162, 0.0001955854726587059, 0.00021953545591365454,
      0.00022926052397689744, 0.00022426254181198496, 0.00020498780227023522,
      0.00017279036796472797, 0.0001298377650336757, 7.896554912767284e-05,
      2.3490472287903275e-05, -3.300546127105933e-05, -8.690600990554585e-05,
      -0.0001347918984043961, -0.0001736574462255212, -0.00020109891379992953,
      -0.00021546278505806698, -0.00021594486444121374, -0.00020263428618914637,
      -0.00017650010222613997, -0.00013932180162124673, -9.356868295437079e-05,
      -4.223622415754339e-05, 1.1349730297288511e-05, 6.374818370194942e-05,
      0.00011162369351253379, 0.00015195843010245563, 0.00018224212259137913,
      0.0002006279548603816, 0.00020604475219142808, 0.00019825867334931566,
      0.0001778809056628722, 0.0001463213386266529, 0.00010569164098267239,
      5.866436716045549e-05, 8.297469131404875e-06, -4.2164282522205884e-05,
      -8.949808967812828e-05, -0.00013070871055975282, -0.00016321773790151832,
      -0.00018502462718579678, -0.00019482943769587302, -0.00019210978044670277,
      -0.0001771474557206303, -0.00015100351417844733, -0.00011544377948655572,
      -7.282001569651914e-05, -2.5914709790703107e-05, 2.2240305987582373e-05,
      6.855958548408101e-05, 0.00011010153268763933, 0.0001442549759137707,
      0.00016890303386512574, 0.00018255400724255026, 0.00018443122356827038,
      0.00017451645330898786, 0.00015354452619119625, 0.00012294991279014844,
      8.476909673303536e-05, 4.1505352457913844e-05, -4.0351133537053855e-06,
      -4.892494754778512e-05, -9.030360219736719e-05, -0.00012555939879923427,
      -0.0001524941314672264, -0.00016945985033558589, -0.0001754593319864368,
      -0.00017020413547574816, -0.00015412690320804715, -0.00012834751606117948,
      -9.459566179902618e-05, -5.509513661456172e-05, -1.2417596980681065e-05,
      3.0684637073342654e-05, 7.145587145035135e-05, 0.00010731301366707848,
      0.00013600901041824779, 0.0001557734200380916, 0.00016542134180906428,
      0.0001644240200985838, 0.00015293694589082213, 0.00013178402799015612,
      0.00010239922333261415, 6.672972000310758e-05, 2.710718604072815e-05,
      -1.3904420101608532e-05, -5.3674558324957225e-05, -8.967463809022646e-05,
      -0.0001196385872713445, -0.00014170527520863778, -0.0001545338528697391,
      -0.00015738487925548908, -0.00015016234914599281, -0.000133414275778443,
      -0.00010829214848465018, -7.64722083426883e-05, -4.00438974115138e-05,
      -1.3728868978540534e-06, 3.7052351099798097e-05, 7.278049014838961e-05,
      0.00010355354566776879, 0.0001274493800226768, 0.00014300153562179623,
      0.00014928894011023345, 0.0001459900156437102, 0.00013339804413857093,
      0.00011239714131650022, 8.440071306389378e-05, 5.125664698634509e-05,
      1.5125579354029293e-05, -2.1659757855820387e-05, -5.674496604506745e-05,
      -8.790449601328686e-05, -0.00011318263964886892, -0.00013101607698120136,
      -0.00014033031284554928, -0.00014060407063006902, -0.00013189780765647527,
      -0.00011484484065725076, -9.060597021489451e-05, -6.079081599527112e-05,
      -2.7351172480534954e-05, 7.546564325453126e-06, 4.166157315881605e-05,
      7.28223276971518e-05, 9.906465345352268e-05, 0.00011875535506888827,
      0.00013069364460383058, 0.00013418408582371034, 0.00012907664238166955,
      0.00011577155629485245, 9.518904834576305e-05, 6.87060782908505e-05,
      3.806448675814783e-05, 5.256630795436191e-06, -2.7603990577696085e-05,
      -5.841873065685423e-05, -8.523766865002212e-05, -0.00010638283280485059,
      -0.00012055299686273473, -0.0001269035172451137, -0.0001250963283873157,
      -0.0001153171611864126, -9.825916770144897e-05, -7.507428731589102e-05,
      -4.729573783585091e-05, -1.6736829561623093e-05, 1.4627232615624949e-05,
      4.47868652520537e-05, 7.182671803524719e-05, 9.404715955907064e-05,
      0.00011007094152556324, 0.00011892835845355766, 0.00012011565070526814,
      0.00011362315240189059, 9.99316478199244e-05, 7.997744306560319e-05,
      5.5088653051511616e-05, 2.6897020205504672e-05, -2.7688935299303187e-06,
      -3.200216087113727e-05, -5.8939925570226405e-05, -8.188196884966105e-05,
      -9.939786857261539e-05, -0.00011041600721108411, -0.00011428890183048829,
      -0.00011083088886569029, -0.00010032599588418593, -8.350575485151598e-05,
      -6.14986328269243e-05, -3.575455384510399e-05, -7.9495462531286e-06,
      2.012322462480963e-05, 4.666896329688106e-05, 7.000585866316571e-05,
      8.867149568109691e-05, 0.00010151434032726418, 0.00010776458514655722,
      0.0001070800098249121, 9.956414404519867e-05, 8.575581183588248e-05,
      6.659097190658612e-05, 4.333952952324656e-05, 1.752137050174152e-05
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby1_highpass_48_40_1000_rp_3_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev1<48>(3.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.002102346698682844, -0.025001513519500012, 0.12404744474116305, -0.3205644216674115,
      0.41759528298798687, -0.14269159306858611, -0.23183810844949612, 0.112422128735371,
      0.1778593579178677, 0.039750887381500226, -0.20805014057637514, -0.06597253984606583,
      0.026316782166980385, 0.10055424422391085, 0.12859599272031375, -0.012625175124655474,
      -0.12077585399047983, -0.10619340870426698, -0.0022066008818004707,
      0.046910127938349575, 0.06249757654818672, 0.08001216257913961, 0.03978306643563963,
      -0.039519356018341285, -0.09403007194122827, -0.08203736797274812,
      -0.023654313326347508, 0.03912954251590304, 0.06993539169406818, 0.056654092943048275,
      0.029359862253472, 0.008866105700190429, -0.01505961157300045, -0.04821345759343387,
      -0.0688145550255622, -0.05410309933753363, -0.010085055365542767, 0.03741938889565666,
      0.06374320568712716, 0.059833716598604585, 0.03430574869327062, 0.002824365983849578,
      -0.02306707285767156, -0.03815057654849831, -0.041110370683920525,
      -0.03474763392548663, -0.02387968757767789, -0.009846626994365153,
      0.009454930494641016, 0.03259785495377919, 0.05049657169075847, 0.05175313788297002,
      0.03236327001477271, 0.000233794895928924, -0.029778443482197943,
      -0.04582186273057061, -0.0451915356915337, -0.03275279957187549,
      -0.015522461099552184, 0.0011607718775410998, 0.0145234206953409,
      0.023753066121056758, 0.02896742354619309, 0.030189412333052893, 0.026889167184651654,
      0.01847031123569417, 0.0053135320020020116, -0.01054540927071727,
      -0.025698066222227083, -0.03632686455593476, -0.039192307101720156,
      -0.032500249130138575, -0.016872646101778615, 0.003963548086742653,
      0.023812480068979326, 0.03637918089746847, 0.038209385388056134, 0.030227053937614434,
      0.016801015271959457, 0.003081852186655305, -0.007530898250557053,
      -0.014312896742640618, -0.018375774593825642, -0.0210241562367484,
      -0.02251192659552709, -0.021887651191863866, -0.017830853323804265,
      -0.009789918690772365, 0.001351944267904866, 0.013433337316186211,
      0.023768759465759782, 0.0299903231925581, 0.0306155429352291, 0.025305176200621213,
      0.014931103917533545, 0.0014835980222607109, -0.012273705364456614,
      -0.023435106401891233, -0.029708892848916528, -0.03001198364601136,
      -0.024684244068055382, -0.015288305016120569, -0.0041130112150309294,
      0.006449606811672397, 0.014495227759984231, 0.019026009179740237,
      0.020079719347820643, 0.01851394617203387, 0.015508875222567211, 0.011988723938599245,
      0.008235304265075325, 0.0039051044273476516, -0.0015390094020422053,
      -0.008213059476755569, -0.015378910471733818, -0.021477557034381898,
      -0.02465360080091419, -0.023516169614303604, -0.01775611670207402,
      -0.008333118911952564, 0.0028193047383349218, 0.01339853686392807,
      0.021376028887780486, 0.025453131007685474, 0.02523262889449478, 0.02113686443610419,
      0.014174443722690167, 0.005662694710793257, -0.0030230196877829903,
      -0.010645544363538425, -0.016248262272051915, -0.019251104753579863,
      -0.019500502435692305, -0.01726308650387619, -0.013150276834120189,
      -0.007973202212777227, -0.002553704516714819, 0.0024550153050547133,
      0.00667498197983427, 0.009996525234272084, 0.012466046523187484, 0.014127106092009043,
      0.014896099680906008, 0.014535097685434373, 0.012735681306721843,
      0.009276312138322265, 0.004186962901616669, -0.002143158233545715,
      -0.008954825629843944, -0.015214520404061465, -0.019800194747870863,
      -0.02174087731230634, -0.02045830663888508, -0.01594864088361301,
      -0.008844944053864682, -0.0003244091290270706, 0.008132362371570737,
      0.01507244123526896, 0.019398463644027433, 0.02059606216761843, 0.01879629844055419,
      0.014665324972213914, 0.009171197451050292, 0.00331363826831016,
      -0.0020958151559832467, -0.006546111425306948, -0.009821515299999169,
      -0.011912918262786149, -0.01290308573369196, -0.01287962655059667,
      -0.011904124176173803, -0.010033240658164293, -0.007363640239364706,
      -0.004067083255325493, -0.00039448283051709345, 0.0033513837298165647,
      0.006857927099691175, 0.009838551604834635, 0.012049621628249754,
      0.013290475758160968, 0.013399737990518894, 0.012263237794237379,
      0.009841290363930125, 0.006210625143922573, 0.001605369630502473,
      -0.003562951822146238, -0.008722969012230065, -0.013205349753152407,
      -0.016343060647579073, -0.017592047731354907, -0.016646305545363678,
      -0.013519407367255046, -0.008569812552078717, -0.0024589347070621617,
      0.003953503628573572, 0.009756864649864291, 0.014148769999042788,
      0.016571811095138493, 0.016799062558624064, 0.014952392198594148, 0.01145379040723147,
      0.006925087288049371, 0.0020615350332088066, -0.002492307955828072,
      -0.006239960001683513, -0.008888123649298646, -0.010354793925821329,
      -0.010735690563621387, -0.010241869980030693, -0.009125662080503862,
      -0.00761298904930389, -0.005857681722459711, -0.003927739147814721,
      -0.0018251803290717044, 0.0004682553133039404, 0.0029353050996947863,
      0.005476872520491249, 0.007892628752555636, 0.009897849610762972,
      0.011174183474958245, 0.011440832235950275, 0.010525804421043096,
      0.008416851351482815, 0.005278251057062706, 0.0014301592011648166,
      -0.002702101449476158, -0.0066543037823789866, -0.00998896462400928,
      -0.012347771302307534, -0.013484817164845531, -0.013281429940919773,
      -0.011747709438953473, -0.009016629452114986, -0.0053341785644079945,
      -0.0010452451978574975, 0.0034280642801281886, 0.007619603185339767,
      0.011065479184305064, 0.01336059163908349, 0.01421752159568471, 0.013516309139409651,
      0.01133306816821309, 0.007938397733380167, 0.003762592188189539,
      -0.0006678363769964991, -0.004810926161243966, -0.008191645890298204,
      -0.01046976590948268, -0.011480603480473375, -0.01124244673053177,
      -0.009931984954521779, -0.007835700442196393, -0.005289343116060391,
      -0.002618593439998205, -9.203089437723189e-05, 0.002106519969532335,
      0.00388407304760161, 0.005225373613193255, 0.006166436837694241, 0.006762492047651009,
      0.007058392907015619, 0.007068355647026735, 0.006769466492546972,
      0.006110169858725494, 0.005031472626915056, 0.003495552537352804,
      0.0015145166881494242, -0.0008282801859068155, -0.003370527035032751,
      -0.005880134343850671, -0.008080884513147108, -0.009690528998342985,
      -0.01046460505507783, -0.010238013056928294, -0.008956797726217382,
      -0.006694395264992556, -0.0036493612157961217, -0.00012469739092193437,
      0.003508193432171262, 0.006855601472888927, 0.009550928035153663,
      0.011300340598225751, 0.011918274790685919, 0.01134804400094818, 0.009665178785344114,
      0.007063814353106902, 0.0038290092797356777, 0.00029984088320110356,
      -0.003170884204188878, -0.006254602007294132, -0.008678107109234695,
      -0.010245116660060513, -0.010847604979237879, -0.010467909190902626,
      -0.009173568734258423, -0.0071069870967498255, -0.004471458515562374,
      -0.001514276036570092, 0.0014929973325163472, 0.00427707793899015,
      0.0065876779750683725, 0.008222575584840835, 0.009049985023577472,
      0.009024411602324145, 0.008192359921616873, 0.00668558192019055, 0.004701814452377117,
      0.0024756271885084547, 0.00024434924347870664, -0.0017846300124731475,
      -0.0034590218937494703, -0.0046947206402975245, -0.005474995170381683,
      -0.005837118006592144, -0.005850511647724717, -0.005592182965231261,
      -0.005125468591738572, -0.004486934539078493, -0.00368402016633476,
      -0.002703283408679439, -0.0015265532806095002, -0.00015049512853339384,
      0.0013956035594841912, 0.003038533164555806, 0.004659564898163724,
      0.0061036560931858105, 0.007198282801945646, 0.0077787570441359005,
      0.007715589371562194, 0.00693903610315931, 0.005456446739663154,
      0.0033592557070139654, 0.0008181770223449811, -0.0019329646886676421,
      -0.004622616590284946, -0.006972640942423541, -0.008731038921210795,
      -0.009701973334221412, -0.009769289039901215, -0.008910674473875557,
      -0.007200856908396478, -0.00480360461657337, -0.0019536550181988494,
      0.0010691466505939459, 0.003970347579801889, 0.006472397335328816,
      0.008343498586398565, 0.009420536408421831, 0.009623632730902706,
      0.008960983152684723, 0.007523895475109368, 0.005473180409901799,
      0.003019060396915819, 0.0003974116837565012, -0.0021546461663065025,
      -0.004421048390807497, -0.006224816714697254, -0.007440494743458649,
      -0.008000522640163425, -0.007895839868185999, -0.007171544515235685,
      -0.005918730676045193, -0.004263700791053041, -0.0023556771483922647,
      -0.00035399571482103197, 0.001584380447739498, 0.0033163096309387617,
      0.004722254895491737, 0.005713861711633706, 0.0062388968260359634,
      0.006283263371997197, 0.005869998677910667, 0.005055384292204048,
      0.003922531458263441, 0.0025730262471033265, 0.001117405145487986,
      -0.0003346354282372301, -0.0016833328279606515, -0.002846326510892066,
      -0.0037637189317015207, -0.004400215174284728, -0.004744207373643534,
      -0.004804123061710799, -0.0046028138092360825, -0.004171130324780831,
      -0.0035420170794255553, -0.002746390015052171, -0.0018117089699397264,
      -0.0007635608621201996, 0.0003701643148739331, 0.001553639844304075,
      0.0027376743429249873, 0.003856344307010952, 0.004827313102799737,
      0.0055568210448349595, 0.00594938262690392, 0.005921156222303072,
      0.005414985609547159, 0.004414470449075999, 0.002954265316843855,
      0.0011241989966353464, -0.0009343009309099397, -0.0030397524610567164,
      -0.004989047075847929, -0.006580452918744099, -0.007638029562802264,
      -0.00803396167096181, -0.007705572871699109, -0.006664564340445803,
      -0.004997185102784114, -0.002855371001429269, -0.000440156928577606,
      0.002020330011889956, 0.004295389376990871, 0.00617573168059325, 0.007494173962037446,
      0.008140921507906828, 0.008072140552007147, 0.007311412992815052,
      0.0059444803725685206, 0.004108340671206436, 0.0019762108461042318,
      -0.00025989769361570674, -0.0024072045530766964, -0.004289122293701005,
      -0.005759734105505965, -0.006714696542531347, -0.007097862034213949,
      -0.006903328457908248, -0.006173034817175649, -0.004990403362009124,
      -0.003470848705383612, -0.001750205316109069, 2.7755109296508443e-05,
      0.001723545229168893, 0.0032128676612155453, 0.004395362929798093,
      0.0052006379988507176, 0.005591323352700078, 0.005563208534334034, 0.005142767367272,
      0.004382580649306037, 0.0033552826942317513, 0.0021466967209501915,
      0.0008487907935015196, -0.0004470033958925946, -0.001655691535268902,
      -0.0027035584815786762, -0.0035318033660129726, -0.004098929898979111,
      -0.004381932511004171, -0.004376366596669011, -0.004095414199360629,
      -0.0035680662390329874, -0.0028365512031235276, -0.0019531576376628727,
      -0.0009766273320351519, 3.166616355136355e-05, 0.001011503772782136,
      0.0019073035384728422, 0.002671043396741906, 0.0032644185190508317,
      0.003660116152856779, 0.003842205864567751, 0.003805764338354415,
      0.003555956412015761, 0.0031068538735313164, 0.002480273897127513,
      0.0017048550899541196, 0.000815470515990125, -0.00014707326346117118,
      -0.0011362518772006687, -0.0021002684605817405, -0.0029830915809903854,
      -0.00372641174688889, -0.004272717508659845, -0.00456949403237897,
      -0.004574306282086849, -0.004260286840795276, -0.0036213497930484015,
      -0.0026763376001542683, -0.0014713067731686952, -7.928305883744238e-05,
      0.0014029386339800085, 0.0028610353522346304, 0.004172131286836526,
      0.005215804573140378, 0.005886079844874223, 0.006103120817667351,
      0.005823242063320297, 0.005045933781739077, 0.003816842185123572,
      0.0022260526142312744, 0.00040154179777662693, -0.0015017601688510065,
      -0.003316300911631854, -0.0048781693599964, -0.006043529508155692,
      -0.006703371980900964, -0.006794875349730079, -0.00630803769233961,
      -0.00528678818604859, -0.00382444690574905, -0.0020540788463059415,
      -0.00013489174907626583, 0.0017637263599087547, 0.0034787036683068405,
      0.004868499804877804, 0.0058254651943136105, 0.006284195121148991,
      0.006225268534707237, 0.0056743329634011365, 0.0046970197135314164,
      0.0033905821699808537, 0.0018734028471317024, 0.00027359837425070736,
      -0.0012821206670522245, -0.0026783715345409615, -0.0038191067354938118,
      -0.004633303119647574, -0.005078202145451676, -0.005140194981255325,
      -0.004833605876567095, -0.004197722288290812, -0.003292461570181142,
      -0.00219306877078196, -0.000984226011856075, 0.00024606513038035805,
      0.0014124837091044177, 0.002437942268037691, 0.0032583814592646197,
      0.0038265265764829775, 0.004114377867638966, 0.004114282927701212,
      0.0038385390379346083, 0.0033175881755550794, 0.0025969846930803467,
      0.001733419933788734, 0.0007901644859957021, -0.00016767375084511115,
      -0.0010776841450596984, -0.001884137829638127, -0.0025411618466092646,
      -0.003014945333333175, -0.0032849273557624724, -0.003344012824377162,
      -0.0031979378305615636, -0.0028639523199977283, -0.0023690056282280525,
      -0.0017476135102737057, -0.0010395618565200678, -0.0002875715572628086,
      0.0004649806928111251, 0.0011762137549179144, 0.0018077075961935192,
      0.0023262312221745463, 0.0027051832914499682, 0.0029256984164272625,
      0.00297737946693113, 0.0028586301913318653, 0.0025765826611887444,
      0.0021466375292206884, 0.001591657433671217, 0.0009408704480171521,
      0.000228547827375555, -0.0005074826992865364, -0.0012274385562983405,
      -0.0018912655815250935, -0.0024603846325566585, -0.0028994909961224313,
      -0.0031783918324310347, -0.0032738485539731176, -0.0031713598198486125,
      -0.0028667813991858585, -0.002367639056348094, -0.0016939590480898755,
      -0.0008784271348692682, 3.4301002544274994e-05, 0.0009892726202992961,
      0.001923955254784217, 0.0027719594248787572, 0.003467609245298883,
      0.0039510801325473195, 0.004173710036436846, 0.004103005108887962,
      0.0037268178189276725, 0.003056187162244017, 0.002126403176745071,
      0.0009959907173299394, -0.0002565083054338661, -0.0015378556328856194,
      -0.0027472099508162534, -0.0037844449712625505, -0.004558968894610068,
      -0.004998212663985374, -0.00505492988377739, -0.004712520270735355,
      -0.003987748849185789, -0.0029304711794654013, -0.0016202669163220924,
      -0.0001601986029479581, 0.0013317852794646143, 0.002733028900381332,
      0.003926976810990437, 0.00481357774951609, 0.005318278688246761, 0.005398736032923915,
      0.005048594911546253, 0.004297978448843575, 0.003210655290014664,
      0.0018781804174141721, 0.00041159701935267483, -0.0010684843321188517,
      -0.0024424712796161214, -0.003602040131098299, -0.004459110729714499,
      -0.004952757270416943, -0.005053492368907546, -0.004764635290453175,
      -0.004120766382573627, -0.0031835473073130345, -0.0020354221854077723,
      -0.000771885594965211, 0.0005069049463656179, 0.0017043867378217538,
      0.00273500615120125, 0.0035302128083505102, 0.004042639704613983,
      0.004248279409127949, 0.004146667639491433, 0.0037592619327865735,
      0.003126338281211353, 0.0023028129295734586, 0.0013534281181359297,
      0.00034772454525097387, -0.0006448296181004509, -0.0015592593036014295,
      -0.002338843298054157, -0.002938085900289578, -0.0033248369407529177,
      -0.0034815465601842504, -0.003405672690700873, -0.0031092776590819476,
      -0.002617862402699639, -0.0019684995233124484, -0.0012073453844871178,
      -0.0003866393150443394, 0.0004386663488778714, 0.001214462802558366,
      0.0018910105520900024, 0.0024261947589300694, 0.0027882681183271996,
      0.0029578618862062707, 0.0029290945118555472, 0.002709679175932016,
      0.0023200190650113713, 0.0017913720888551468, 0.0011632532458367348,
      0.0004803118060943723, -0.00021103685416998448, -0.0008659335410313692,
      -0.0014440807618441832, -0.0019122086520969694, -0.002245846660865706,
      -0.0024303247270663275, -0.0024610057672805256, -0.002342819627921282,
      -0.0020892201404466306, -0.0017207176692612476, -0.0012631490882515305,
      -0.0007458380469204828, -0.0001997755014195455, 0.0003440802617814656,
      0.0008563175345640698, 0.0013103620140150708, 0.001683530620416734,
      0.0019578494954524198, 0.002120644793109346, 0.002164916248512603,
      0.002089501246331749, 0.0018990337650700206, 0.0016037002970588727,
      0.0012187950194685931, 0.0007640795972864799, 0.0002629586905083547,
      -0.0002585104005934543, -0.000772747630715322, -0.0012518859424894566,
      -0.001669072919947513, -0.0019997935680377017, -0.002223165606745942,
      -0.0023231553773584803, -0.0022896591890577576, -0.00211939152257876,
      -0.0018165183828201166, -0.0013929723947737835, -0.0008683877563738362,
      -0.0002696000765207234, 0.00037032942414923643, 0.0010135823191875161,
      0.0016195278396861333, 0.0021470864396074527, 0.002557407059421836,
      0.002816704751506406, 0.0028990618122640725, 0.0027889634378725505,
      0.002483324551357383, 0.001992773013759999, 0.0013419889755610166,
      0.0005689608193130476, -0.000276898115179526, -0.001137727416707907,
      -0.0019511395716396054, -0.0026548251382634744, -0.0031914972463537995,
      -0.003513766971424011, -0.003588513996943367, -0.003400330984623907,
      -0.002953676768557831, -0.0022734698477427494, -0.0014039821910584688,
      -0.0004060427861473566, 0.0006472833738463606, 0.001676227401560324,
      0.0026006220242569783, 0.003346455234050041, 0.0038521057791737327,
      0.004073705088362848, 0.00398913342608145, 0.0036002687963470267,
      0.0029332557742465146, 0.0020367345899040276, 0.000978152368201582,
      -0.00016154864586886264, -0.001294423212414347, -0.002332644336486344,
      -0.0031956435598808103, -0.0038166569016994706, -0.004148115598747103,
      -0.004165424264777528, -0.0038688135853828295, -0.0032831263930319823,
      -0.0024555785965079953, -0.0014517127612287991, -0.0003499157912093705,
      0.0007650107321997343, 0.0018086684965668938, 0.0027036910213900957,
      0.003385638575804784, 0.003807695712479688, 0.003943826072727377,
      0.0037901828945472705, 0.0033647284940668334, 0.002705167267572892,
      0.0018654310287442612, 0.0009110617491416398, -8.609262812887927e-05,
      -0.001053422447310462, -0.001922901882755334, -0.002635840541392439,
      -0.0031467183159204154, -0.0034258733145106496, -0.003460915954543813,
      -0.0032568466496856047, -0.0028349513289285667, -0.0022306313163827866,
      -0.0014903869571574516, -0.0006682151416217258, 0.00017830090029545093,
      0.0009919340205253326, 0.0017195332343138323, 0.002315301999875819,
      0.0027434600468869354, 0.00298016427012637, 0.003014615821866852,
      0.0028493304528622644, 0.0024995951008558886, 0.001992174317091951,
      0.0013633647010468809, 0.0006565239306692913, -8.07766936691833e-05,
      -0.0007998109893570106, -0.0014537926751236135, -0.0020008276941148014,
      -0.002406549910686354, -0.0026462789107101568, -0.002706560904381581,
      -0.002585985722035541, -0.002295214166587496, -0.001856199062380315,
      -0.0013006375897186857, -0.0006677482010578835, -1.5180347577192397e-06,
      0.0006523886602137188, 0.00124983876307786, 0.0017513178023345303,
      0.0021246636754814296, 0.0023472379011806248, 0.0024073689616060066,
      0.0023049609357641263, 0.002051229503840899, 0.0016676000646944067,
      0.001183872139553423, 0.0006358136636612836, 6.239245543674331e-05,
      -0.0004971239370973728, -0.0010059665573183547, -0.0014323470034766682,
      -0.0017514459199115917, -0.0019467822316680044, -0.0020108967760072774,
      -0.0019453451955956551, -0.0017600518480204693, -0.0014721238860352119,
      -0.001104258856627874, -0.0006828981974332581, -0.00023628273763510866,
      0.00020744375754314076, 0.0006219580417569717, 0.0009842114103525668,
      0.001275550002422881, 0.001482469269122053, 0.001596999755216602,
      0.001616745621295942, 0.0015446155415245854, 0.0013882975565638843,
      0.0011595356720557808, 0.0008732674620271195, 0.0005466798489343287,
      0.00019823572993097867, -0.0001532818636460599, -0.0004896681990810396,
      -0.0007941052559513597, -0.0010518550341620653, -0.0012508203418730803,
      -0.0013819633114449533, -0.0014395792651404411, -0.0014214302113641176,
      -0.001328747668492448, -0.0011661181575511174, -0.0009412661832756101,
      -0.0006647487154599432, -0.00034957234726081595, -1.0740120080935045e-05,
      0.00033526948642530896, 0.0006710924094803246, 0.0009791399217930112,
      0.0012423306372073078, 0.001444887391311613, 0.0015731825358668667,
      0.0016166017285568599, 0.0015683812102734295, 0.001426359051162158,
      0.0011935694990255616, 0.0008786039881598003, 0.0004956647990429879,
      6.424927661786322e-05, -0.00039157568050023496, -0.0008443183236169537,
      -0.0012645977467531714, -0.0016230012025622387, -0.0018921532357585146,
      -0.002048851760517114, -0.0020761010639267184, -0.0019648603985364618,
      -0.0017153320724654782, -0.0013376359243544905, -0.0008517571317637963,
      -0.0002867089189266626, 0.00032108334731100515, 0.0009301005800060376,
      0.0014966070146213563, 0.0019778826733239064, 0.0023355635066261266,
      0.0025388168033085787, 0.002567078114343877, 0.0024120992414442505,
      0.002079103804327966, 0.0015869142223291846, 0.0009669962618798411,
      0.00026145764302178007, -0.00047987237984498354, -0.0012030732292062326,
      -0.0018541972057807222, -0.00238344743429269, -0.002749131465957013,
      -0.0029210633424553373, -0.002883126113198733, -0.0026347712812815334,
      -0.0021913161342857965, -0.001582997265813748, -0.000852840498281817,
      -5.350512800688775e-05, 0.0007566544673190524, 0.0015180015874191378,
      0.0021741562728930493, 0.0026763015943517612, 0.0029869166809269555,
      0.003082642499920276, 0.0029560567341813536, 0.0026162222259904604,
      0.002087971885207344, 0.0014099934475561898, 0.0006318717190612277,
      -0.00018967368419373984, -0.0009950569406763597, -0.0017262674232626856,
      -0.002331142110046822, -0.0027671462310592727, -0.003004383469298787,
      -0.003027622042535044, -0.0028372031437519677, -0.0024487866737381765,
      -0.0018919786614575852, -0.0012079681087937481, -0.0004463718499971314,
      0.00033846071905586233, 0.00109139897620026, 0.0017604448669875604,
      0.0023003284057160735, 0.0026755373386533926, 0.002862583446405412,
      0.0028513701501660673, 0.0026455951342068914, 0.002262192118849594,
      0.001729882504513601, 0.0010869658167614882, 0.0003785241406292518,
      -0.0003467523789727215, -0.0010398955686284582, -0.0016549206318195561,
      -0.0021518085358874194, -0.0024990253674316604, -0.0026754311081784864,
      -0.002671473930903027, -0.0024896138984782496, -0.002143968878446237,
      -0.0016592227828383264, -0.001068879452159325, -0.00041298255561407027,
      0.00026454887038699493, 0.0009187993935735802, 0.0015067703940309042,
      0.001990146988263324, 0.002337748013791936, 0.002527507911301817,
      0.0025478675398474216, 0.0023984865113796465, 0.0020902307608118963,
      0.001644433622621612, 0.0010914741978435656, 0.00046876059130846934,
      -0.00018175506606124818, -0.0008163706664071551, -0.001392555339175328,
      -0.0018718045101835763, -0.0022222366501926595, -0.0024207537329758748,
      -0.0024546141462249453, -0.0023223046816302356, -0.0020336449995070767,
      -0.001609110576343193, -0.0010784149792213806, -0.00047844541909569665,
      0.00014930706879022108, 0.0007616434865503777, 0.0013166739867845354,
      0.0017767407468593788, 0.002111036321135467, 0.0022977282216603938,
      0.0023254359935406346, 0.002193954510345704, 0.0019141730623789255,
      0.0015071997475177878, 0.0010027600049439165, 0.0004369921563310696,
      -0.0001501927654906392, -0.0007179883438917384, -0.0012275930148910143,
      -0.001644920009277559, -0.0019429213238539229, -0.002103362434708374,
      -0.0021179288803647688, -0.0019885984937960976, -0.0017272695563387052,
      -0.0013546908833010152, -0.0008987904296624481, -0.0003925405987001087,
      0.0001284718954602677, 0.0006285878617871476, 0.0010745439243866105,
      0.0014376944029699656, 0.001695838511075957, 0.0018345389339419567,
      0.0018478588147353317, 0.0017384883745601796, 0.0015172764057584465,
      0.0012022225574316412, 0.0008170210035390246, 0.0003892727075936113,
      -5.149924656071552e-05, -0.00047588948234023867, -0.0008565660629451129,
      -0.0011700144823819604, -0.0013979617040108185, -0.0015283976534964964,
      -0.0015561414641038665, -0.0014829318857659775, -0.0013170535252919461,
      -0.0010725409764665336, -0.000768029584587034, -0.00042534298045943586,
      -6.792235406811621e-05, 0.0002807901417834239, 0.0005989018635235276,
      0.0008674501429534121, 0.001071524079252354, 0.0012010601848897802,
      0.0012512700261740528, 0.0012226861061273766, 0.0011208406921139062,
      0.0009556188848638403, 0.0007403498707765279, 0.0004907172115175982
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}
