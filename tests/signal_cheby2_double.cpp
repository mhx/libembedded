/*
 * Copyright (c) Marcus Holland-Moritz
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 */

#include <array>
#include <vector>

#include "embedded/signal/butterworth.h"
#include "embedded/signal/chebyshev.h"
#include "embedded/signal/filter.h"

#include <gtest/gtest.h>
#include <gmock/gmock.h>

using namespace embedded::signal;

namespace {

template <typename F1, typename F2>
constexpr bool almost_equal(F1 a, F2 b) noexcept {
  return (a < b ? b - a : a - b) / (b < 0 ? -b : b) < 1e-13;
}

template <typename T>
std::vector<typename T::value_type> impulse_response(T& filter, size_t len) {
    typename T::value_type x{1};
    std::vector<typename T::value_type> y;
    y.resize(len);
    for (size_t i = 0; i < len; ++i) {
        y[i] = filter(x);
        x = 0;
    }
    return y;
}

}

TEST(signal_generated, cheby2_lowpass_1_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<1>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.012537398169645247), "design.b()[0] == 0.012537398169645247");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.012537398169645247));
    static_assert(almost_equal(design.b()[1], 0.012537398169645247), "design.b()[1] == 0.012537398169645247");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 0.012537398169645247));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.9749252036607096), "design.a()[1] == -0.9749252036607096");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.9749252036607096));
    std::cout << "max_deviation(cheby2,lowpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.012537398169645247, 0.024760423633562047, 0.024139561053675925, 0.023534266476535132,
      0.022944149537641425, 0.02236882966080684, 0.021807935812713827, 0.02126110626362971,
      0.020727988354121183, 0.02020823826761841, 0.019701520808682024, 0.019207509186830028,
      0.018725884805785215, 0.018256337058007138, 0.01779856312437617, 0.01735226777890043,
      0.016917163198319672, 0.016492968776483267, 0.016079410943382673,
      0.015676222988721594, 0.015283144889910097, 0.014899923144371734,
      0.014526310606055533, 0.014162066326047416, 0.013806955397178253,
      0.013460748802528342, 0.013123223267730596, 0.012794161116977214,
      0.012473350132636942, 0.01216058341839241, 0.011855659265809268, 0.01155838102425108,
      0.011268556974056064, 0.010986000202893918, 0.010710528485222949,
      0.010441964164769814, 0.010180134039956042, 0.009924869252197467, 0.00967600517700453,
      0.009433381317813221, 0.009196841202478188, 0.008966232282361252,
      0.008741405833950272, 0.008522216862944885, 0.008308524010747276,
      0.008100189463297684, 0.007897078862195829, 0.007699061218050953,
      0.007506008826004596, 0.007317797183371614, 0.007134304909346337,
      0.006955413666722077, 0.006781008085573504, 0.006610975688852667,
      0.006445206819850686, 0.006283594571478324, 0.0061260347173198336,
      0.005972425644415616, 0.005822668287730339, 0.005676666066264256,
      0.005534324820766518, 0.005395552753010318, 0.005260260366590686,
      0.005128360409206783, 0.004999767816391443, 0.0048743996566516885,
      0.00475217507798484, 0.004633015255735718, 0.004516843341761319, 0.004403584414870174,
      0.004293165432504431, 0.004185515183633501, 0.004080564242828883,
      0.003978244925490558, 0.0038784912441960665, 0.003781238866144129,
      0.0036864250716653556, 0.003593988713773293, 0.003503870178729719,
      0.003416011347598758, 0.003330355558765014, 0.0032468475713915575,
      0.0031654335297941942, 0.0030860609287090435, 0.0030086785794310226,
      0.002933236576801404, 0.002859686267023151, 0.0027879802162832797,
      0.0027180721801620057, 0.0026499170738089523, 0.0025834709428671845,
      0.0025186909351263154, 0.002455535272886406, 0.0023939632260148356,
      0.002333935085678763, 0.0022754121387362435, 0.002218356642769483,
      0.002162731801744126, 0.0021085017422788855, 0.0020556314905102032,
      0.002004086949537028, 0.001953834877431157, 0.0019048428657989682,
      0.0018570793188807087, 0.0018105134331738667, 0.0017651151775674825,
      0.0017208552739745875, 0.0016777051784502808, 0.0016356370627832672,
      0.0015946237965489816, 0.0015546389296127298, 0.001515656675071558,
      0.0014776518926238526, 0.0014406000723559424, 0.00140447731893525,
      0.001369260336199796, 0.0013349264121341178, 0.001301453404221915,
      0.0012688197251659742, 0.001237004328966163, 0.0012059866973465159,
      0.0011757468265226586, 0.001146265214301036, 0.0011175228475016244,
      0.0010895011896960172, 0.001062182169252975, 0.001035548167683731,
      0.0010095820082795359, 0.0009842669450341147, 0.0009595866518438887,
      0.0009355252119790015, 0.0009120671078183565, 0.0008891972108420455,
      0.0008669007718747161, 0.0008451634115735839, 0.0008239711111549564,
      0.000803310203353287, 0.0007831673636069294, 0.0007635296014649066,
      0.0007443842522091544, 0.0007257189686868349, 0.0007075217133474526,
      0.0006897807504796395, 0.0006724846386425996, 0.0006556222232873351,
      0.0006391826295628925, 0.0006231552553029908, 0.0006075297641885098,
      0.0005922960790814257, 0.0005774443755258987, 0.000562965075412318,
      0.0005488488408002209, 0.0005350865678960998, 0.0005216693811822151,
      0.0005085886276926274, 0.0004958358714327555, 0.0004834028879388646,
      0.0004712816589739727, 0.0004594643673567574, 0.00044794339192012576,
      0.00043671130259619767, 0.00042576085562453175, 0.0004150849888805046,
      0.0004046768173208293, 0.0003945296285432773, 0.0003846368784577387,
      0.0003749921870658305, 0.0003655893343463297, 0.0003564222562437787,
      0.0003474850407576756, 0.0003387719241297268, 0.0003302772871267044,
      0.0003219956514165089, 0.0003139216760351028, 0.00030605015394203386,
      0.0002983760086623289, 0.00029089429101259064, 0.0002836001759091876,
      0.00027648895925647777, 0.00026955605491305924, 0.0002627969917340917,
      0.00025620741068778114, 0.0002497830620441681, 0.00024351980263440624,
      0.0002374135931787643, 0.00023146049568162764, 0.0002256566708918196,
      0.00021999837582660495, 0.00021448196135777814, 0.0002091038698582803,
      0.00020386063290782642, 0.00019874886905606382, 0.0001937652816418187,
      0.00018890665666702484, 0.00018416986072396295, 0.00017955183897447408,
      0.00017504961317984407, 0.0001706602797800879, 0.00016638100802139586,
      0.00016220903813053353, 0.0001581416795350182, 0.00015417630912792428,
      0.00015031036957619808, 0.00014654136767139144, 0.0001428668727217502,
      0.000139284514984621, 0.00013579198413816478, 0.00013238702779139213,
      0.000129067450031559, 0.00012583111000798611, 0.000122675920551389,
      0.00011959984682782796, 0.00011660090502640984, 0.00011367716107989567,
      0.00011082672941738858, 0.00010804777174829791, 0.00010533849587679519,
      0.00010269715454599736, 0.00010012204431113185, 9.76115044409568e-05,
      9.516391584672807e-05, 9.277770003802199e-05, 9.045131810474081e-05,
      8.818326972464406e-05, 8.59720921957659e-05, 8.381635949309436e-05,
      8.171468134890427e-05, 7.966570235615048e-05, 7.766810109434348e-05,
      7.57205892773434e-05, 7.382191092252296e-05, 7.197084154076346e-05,
      7.016618734676147e-05, 6.840678448913692e-05, 6.669149829984608e-05,
      6.50192225624153e-05, 6.338887879852373e-05, 6.179941557247478e-05,
      6.024980781310781e-05, 5.873905615271274e-05, 5.726618628252132e-05,
      5.583024832435923e-05, 5.443031621805391e-05, 5.306548712420303e-05,
      5.1734880841918397e-05, 5.0437639241169836e-05, 4.91729257093629e-05,
      4.7939924611793565e-05, 4.67378407656319e-05, 4.5565898927095496e-05,
      4.442334329148188e-05, 4.330943700573759e-05, 4.222346169324939e-05,
      4.116471699055133e-05, 4.0132520095648726e-05, 3.912620532766785e-05,
      3.814512369754732e-05, 3.7188642489494275e-05, 3.625614485293552e-05,
      3.5347029404700346e-05, 3.446070984117857e-05, 3.359661456020364e-05,
      3.2754186292416896e-05, 3.193288174187536e-05, 3.113217123567119e-05,
      3.0351538382336818e-05, 2.9590479738815564e-05, 2.8848504485782863e-05,
      2.812513411110875e-05, 2.7419902101257466e-05, 2.6732353640425155e-05,
      2.6062045317221606e-05, 2.5408544838706918e-05, 2.4771430751598613e-05,
      2.4150292170469443e-05, 2.354472851276056e-05, 2.2954349240439205e-05,
      2.2378773608134246e-05, 2.1817630417587194e-05, 2.1270557778260287e-05,
      2.07372028739473e-05, 2.0217221735236525e-05, 1.9710279017679193e-05,
      1.92160477855203e-05, 1.8734209300852305e-05, 1.8264452818055794e-05,
      1.7806475383394466e-05, 1.735998163963526e-05, 1.6924683635567585e-05,
      1.6500300640298807e-05, 1.608655896220625e-05, 1.5683191772428943e-05,
      1.5289938932785253e-05, 1.4906546828005475e-05, 1.4532768202171142e-05,
      1.4168361999255584e-05, 1.3813093207662908e-05, 1.3466732708665125e-05,
      1.3129057128639685e-05, 1.2799848695012136e-05, 1.2478895095810975e-05,
      1.2165989342744144e-05, 1.1860929637708856e-05, 1.1563519242648652e-05,
      1.127356635267377e-05, 1.0990883972362998e-05, 1.0715289795167225e-05,
      1.0446606085836929e-05, 1.0184659565797775e-05, 9.92928130140039e-06,
      9.680306594972252e-06, 9.437574878601433e-06, 9.200929610583698e-06,
      8.970218174466165e-06, 8.745291780622425e-06, 8.526005370295647e-06,
      8.312217522047788e-06, 8.103790360554558e-06, 7.900589467687346e-06,
      7.702483795824743e-06, 7.509345583337753e-06, 7.321050272194209e-06,
      7.137476427629232e-06, 6.958505659829943e-06, 6.784022547583908e-06,
      6.613914563842087e-06, 6.448072003148279e-06, 6.2863879108882555e-06,
      6.128758014312955e-06, 5.975080655291264e-06, 5.825256724749001e-06,
      5.679189598751838e-06, 5.536785076190919e-06, 5.3979513180310095e-06,
      5.262598788081977e-06, 5.130640195255425e-06, 5.001990437269218e-06,
      4.876566545763614e-06, 4.754287632793594e-06, 4.6350748386628874e-06,
      4.518851281066046e-06, 4.405542005505774e-06, 4.295073936953527e-06,
      4.187375832722223e-06, 4.082378236520647e-06, 3.98001343365994e-06,
      3.8802154073832776e-06, 3.782919796290565e-06, 3.688063852830709e-06,
      3.59558640283468e-06, 3.5054278060632787e-06, 3.4175299177441564e-06,
      3.3318360510732896e-06, 3.2482909406567212e-06, 3.166840706868992e-06,
      3.087432821105277e-06, 3.0100160719048213e-06, 2.9345405319238167e-06,
      2.860957525736434e-06, 2.7892195984432325e-06, 2.719280485066711e-06,
      2.651095080714256e-06, 2.5846194114892513e-06, 2.5198106061315816e-06,
      2.4566268683692483e-06, 2.3950274499632606e-06, 2.3349726244284215e-06,
      2.2764236614130604e-06, 2.219342801721186e-06, 2.163693232960957e-06,
      2.10943906580376e-06, 2.0565453108385876e-06, 2.0049778560067873e-06,
      1.95470344460263e-06, 1.9056896538255095e-06, 1.857904873869942e-06,
      1.8113182875398781e-06, 1.7658998503741834e-06, 1.7216202712704673e-06,
      1.6784509935947663e-06, 1.6363641767648978e-06, 1.5953326782956075e-06,
      1.5553300362939305e-06, 1.516330452393479e-06, 1.4783087751166484e-06,
      1.4412404836540124e-06, 1.4051016720504476e-06, 1.3698690337877862e-06,
      1.3355198467540568e-06, 1.3020319585896184e-06, 1.2693837724007362e-06,
      1.2375542328313876e-06, 1.2065228124843137e-06, 1.1762694986825616e-06,
      1.146774780562977e-06, 1.118019636493326e-06, 1.0899855218049282e-06,
      1.0626543568328945e-06, 1.0360085152562501e-06, 1.010030812730429e-06,
      9.847044958048054e-07, 9.600132311181161e-07, 9.359410948648052e-07,
      9.124725625254977e-07, 8.895924988549804e-07, 8.672861481212313e-07,
      8.455391245892037e-07, 8.243374032432275e-07, 8.03667310742044e-07,
      7.83515516600642e-07, 7.63869024593207e-07, 7.447151643716399e-07,
      7.260415832942399e-07, 7.078362384592808e-07, 6.90087388938345e-07,
      6.727835882044033e-07, 6.559136767497608e-07, 6.394667748891054e-07,
      6.234322757430183e-07, 6.077998383974217e-07, 5.925593812345527e-07,
      5.777010754311604e-07, 5.63215338619735e-07, 5.490928287086806e-07,
      5.353244378574455e-07, 5.21901286602725e-07, 5.08814718131948e-07,
      4.960562927003559e-07, 4.83617782188071e-07, 4.714911647936458e-07,
      4.5966861986067034e-07, 4.481425228341013e-07, 4.369054403430604e-07,
      4.2595012540693014e-07, 4.1526951276165617e-07, 4.0485671430324127e-07,
      3.947050146454932e-07, 3.848078667891608e-07, 3.751588878996658e-07,
      3.65751855190707e-07, 3.565807019110824e-07, 3.4763951343214074e-07,
      3.389225234333398e-07, 3.304241101834504e-07, 3.221387929150091e-07,
      3.140612282896804e-07, 3.061862069522493e-07, 2.985086501710218e-07,
      2.910236065624669e-07, 2.837262488979873e-07, 2.766118709907594e-07,
      2.69675884660636e-07, 2.6291381677515256e-07, 2.563213063647301e-07,
      2.498941018102136e-07, 2.436280581009326e-07, 2.3751913416151492e-07,
      2.3156339024573033e-07, 2.25756985395683e-07, 2.2009617496471408e-07,
      2.1457730820241703e-07, 2.0919682590020826e-07, 2.0395125809593454e-07,
      1.9883722183603693e-07, 1.9385141899382798e-07, 1.8899063414247528e-07,
      1.8425173248131936e-07, 1.7963165781418885e-07, 1.7512743057840894e-07,
      1.707361459232321e-07, 1.664549718364517e-07, 1.6228114731799036e-07,
      1.5821198059928536e-07, 1.5424484740732252e-07, 1.5037718927219898e-07,
      1.4660651187712367e-07, 1.4293038344979102e-07, 1.3934643319409082e-07,
      1.3585234976114244e-07, 1.3244587975866775e-07, 1.29124826297741e-07,
      1.258870475759789e-07, 1.2273045549625664e-07, 1.1965301432005965e-07,
      1.1665273935460195e-07, 1.1372769567286498e-07, 1.1087599686573109e-07,
      1.0809580382540708e-07, 1.053853235593531e-07, 1.027428080339521e-07,
      1.0016655304717393e-07, 9.765489712950731e-08, 9.520622047245055e-08,
      9.281894388387026e-08, 9.049152776955419e-08, 8.822247114030137e-08,
      8.601031064390938e-08, 8.385361962143424e-08, 8.175100718711445e-08,
      7.970111733136569e-08, 7.77026280462678e-08, 7.575425047298e-08,
      7.385472807053443e-08, 7.200283580547211e-08, 7.019737936179853e-08,
      6.843719437074952e-08, 6.672114565987054e-08, 6.504812652092515e-08,
      6.341705799616056e-08, 6.182688818246987e-08, 6.027659155300235e-08,
      5.876516829578422e-08, 5.72916436689233e-08, 5.5855067371981855e-08,
      5.4454512933112065e-08, 5.3089077111559025e-08, 5.17578793151458e-08,
      5.046006103236494e-08, 4.919478527871023e-08, 4.796123605689145e-08,
      4.6758617830584265e-08, 4.558615501137565e-08, 4.444309145857408e-08,
      4.3328689991561875e-08, 4.224223191437521e-08, 4.1183016552205174e-08,
      4.0150360799521004e-08, 3.9143598679523983e-08, 3.8162080914648e-08,
      3.720517450782968e-08, 3.627226233427809e-08, 3.5362742743480755e-08,
      3.447602917118925e-08, 3.3611549761134246e-08, 3.276874699622588e-08,
      3.1947077339001786e-08, 3.1146010881090755e-08, 3.036503100146608e-08,
      2.960363403326808e-08, 2.8861328938980996e-08, 2.8137636993754777e-08,
      2.743209147666749e-08, 2.6744237369729267e-08, 2.6073631064433665e-08,
      2.5419840075667194e-08, 2.4782442762792505e-08, 2.416102805772536e-08,
      2.3555195199830015e-08, 2.2964553477462047e-08, 2.2388721975991943e-08,
      2.182732933214695e-08, 2.1280013494512744e-08, 2.0746421490040484e-08,
      2.022620919640864e-08, 1.971904112009281e-08, 1.922459018000039e-08,
      1.8742537496530557e-08, 1.827257218592354e-08, 1.7814391159766523e-08,
      1.7367698929526922e-08, 1.6932207415986922e-08, 1.6507635763456425e-08,
      1.6093710158644568e-08, 1.5690163654072985e-08, 1.5296735995916967e-08,
      1.4913173456163454e-08, 1.4539228668977644e-08, 1.4174660471172657e-08,
      1.3819233746679411e-08, 1.3472719274916376e-08, 1.3134893582961415e-08,
      1.2805538801430405e-08, 1.2484442523969656e-08, 1.217139767027154e-08,
      1.1866202352524968e-08, 1.1568659745214596e-08, 1.1278577958184792e-08,
      1.0995769912886497e-08, 1.072005322172717e-08, 1.0451250070446007e-08,
      1.0189187103438578e-08, 9.93369531195693e-09, 9.684609925113046e-09,
      9.441770303615366e-09, 9.20501983616985e-09, 8.974205838478762e-09,
      8.749179454772036e-09, 8.529795561807723e-09, 8.315912675279612e-09,
      8.107392858571652e-09, 7.90410163380035e-09, 7.705907895087753e-09,
      7.512683824009097e-09, 7.324304807160587e-09, 7.1406493557941495e-09,
      6.961599027467326e-09, 6.78703834965778e-09, 6.616854745293158e-09,
      6.450938460148264e-09, 6.289182492062751e-09, 6.1314825219336464e-09,
      5.977736846438242e-09, 5.8278463124439305e-09, 5.681714253062714e-09,
      5.539246425309123e-09, 5.400350949321354e-09, 5.264938249106428e-09,
      5.132920994771144e-09, 5.004214046201589e-09, 4.878734398154868e-09,
      4.756401126727643e-09, 4.637135337166976e-09, 4.520860112989787e-09,
      4.4075004663781464e-09, 4.296983289818387e-09, 4.189237308952857e-09,
      4.084193036613907e-09, 3.9817827280104654e-09, 3.881940337038299e-09,
      3.784601473685787e-09, 3.689703362507737e-09, 3.59718480214046e-09,
      3.5069861258319974e-09, 3.419049162962043e-09, 3.333317201526748e-09,
      3.2497349515642114e-09, 3.168248509497065e-09, 3.0888053233691654e-09,
      3.0113541589539675e-09, 2.9358450667127215e-09, 2.8622293495811895e-09,
      2.7904595315641014e-09, 2.7204893271171e-09, 2.6522736112964254e-09,
      2.585768390657093e-09, 2.520930774880792e-09, 2.4577189491152064e-09,
      2.3960921470069276e-09, 2.336010624410556e-09, 2.2774356337570425e-09,
      2.2203293990647418e-09, 2.1646550915770543e-09, 2.1103768060109516e-09,
      2.0574595374010648e-09, 2.0058691585244022e-09, 1.955572397891139e-09,
      1.906536818287281e-09, 1.8587307958553686e-09, 1.812123499699728e-09,
      1.7666848720031152e-09, 1.7223856086419317e-09, 1.6791971402875104e-09,
      1.6370916139812822e-09, 1.5960418751719413e-09, 1.5560214502030257e-09,
      1.5170045292396175e-09, 1.478965949623153e-09, 1.441881179643607e-09,
      1.4057263027185877e-09, 1.3704780019691355e-09, 1.3361135451822817e-09,
      1.3026107701506687e-09, 1.2699480703797744e-09, 1.2381043811535267e-09,
      1.2070591659493189e-09, 1.176792403193666e-09, 1.1472845733499606e-09,
      1.1185166463300006e-09, 1.0904700692211697e-09, 1.063126754321357e-09,
      1.0364690674738982e-09, 1.0104798166950158e-09, 9.851422410864248e-10,
      9.604400000259506e-10, 9.363571626291917e-10, 9.12878197475429e-10,
      8.89987962591154e-10, 8.676716956847608e-10, 8.459150046260986e-10,
      8.247038581647492e-10, 8.040245768810411e-10, 7.838638243639648e-10,
      7.642085986103011e-10, 7.450462236394132e-10, 7.263643413182974e-10,
      7.081509033916183e-10, 6.903941637115889e-10, 6.73082670662686e-10,
      6.562052597763135e-10, 6.397510465306513e-10, 6.237094193310473e-10,
      6.080700326664241e-10, 5.928228004372879e-10, 5.77957889451035e-10,
      5.634657130803642e-10, 5.49336925080701e-10, 5.355624135626504e-10,
      5.221332951155881e-10, 5.090409090786021e-10, 4.962768119550889e-10,
      4.838327719674027e-10, 4.717007637480457e-10, 4.5987296316397576e-10,
      4.4834174227069306e-10, 4.3709966439285277e-10, 4.2613947932822977e-10,
      4.154541186719431e-10, 4.0503669125792475e-10, 3.9488047871469223e-10,
      3.849789311325598e-10, 3.7532566283949317e-10, 3.659144482828837e-10,
      3.5673921801458656e-10, 3.477940547766331e-10, 3.3907318968509295e-10,
      3.3057099850962566e-10, 3.222819980463209e-10, 3.142008425814898e-10,
      3.063223204441255e-10, 2.9864135064481017e-10, 2.911529795989009e-10,
      2.8385237793188087e-10, 2.7673483736481566e-10, 2.6979576767790624e-10,
      2.630306937501802e-10, 2.5643525267341215e-10, 2.5000519093841187e-10,
      2.437363616918658e-10, 2.3762472206196263e-10, 2.3166633055107843e-10,
      2.258573444938394e-10, 2.201940175789234e-10, 2.1467269743300175e-10,
      2.092898232652631e-10, 2.0404192357100056e-10, 1.9892561389278066e-10,
      1.9393759463775087e-10, 1.890746489496774e-10, 1.843336406343414e-10,
      1.7971151213695532e-10, 1.7520528257029524e-10, 1.7081204579227725e-10,
      1.6652896853173834e-10, 1.6235328856121289e-10, 1.582823129155264e-10,
      1.5431341615505774e-10, 1.504440386725495e-10, 1.46671685042375e-10,
      1.429939224111969e-10, 1.3940837892897984e-10, 1.3591274221934505e-10,
      1.325047578882805e-10, 1.2918222807024488e-10, 1.2594301001072773e-10,
      1.2278501468435152e-10, 1.1970620544762462e-10, 1.1670459672547618e-10,
      1.1377825273072584e-10, 1.1092528621566257e-10, 1.0814385725492733e-10,
      1.0543217205891473e-10, 1.0278848181692842e-10, 1.0021108156934408e-10,
      9.769830910805275e-11, 9.524854390447529e-11, 9.286020606445661e-11,
      9.053175530936582e-11, 8.8261689982745e-11, 8.604854608186607e-11,
      8.389089631357123e-11, 8.178734917378789e-11, 7.973654805012473e-11,
      7.77371703469698e-11, 7.578792663252681e-11, 7.388755980723912e-11,
      7.203484429306545e-11, 7.022858524308433e-11, 6.846761777091749e-11,
      6.675080619947536e-11, 6.507704332854006e-11, 6.344524972071375e-11,
      6.185437300527142e-11, 6.030338719946974e-11, 5.879129204687367e-11,
      5.731711237227457e-11, 5.587989745278356e-11, 5.447872040469458e-11,
      5.311267758572172e-11, 5.178088801222535e-11, 5.048249279105119e-11,
      4.9216654565615886e-11, 4.798255697588186e-11, 4.677940413187322e-11,
      4.560642010039314e-11, 4.446284840461166e-11, 4.3347951536201276e-11,
      4.22610104797056e-11, 4.1201324248834364e-11, 4.016820943438577e-11,
      3.9160999763504584e-11, 3.81790456699917e-11, 3.722171387538819e-11,
      3.628838698056349e-11, 3.53784630675445e-11, 3.4491355311328716e-11,
      3.3626491601431044e-11, 3.27833141729203e-11, 3.196127924670735e-11,
      3.115985667885297e-11, 3.0378529618669254e-11, 2.961679417539402e-11,
      2.8874159093223332e-11, 2.8150145434492486e-11, 2.744428627080118e-11,
      2.6756126381883655e-11, 2.6085221962029607e-11, 2.5431140333866528e-11,
      2.479345966931891e-11, 2.417176871756433e-11, 2.3565666539810974e-11,
      2.2974762250725583e-11, 2.2398674766345022e-11, 2.1837032558308916e-11,
      2.1289473414254866e-11, 2.0755644204221688e-11, 2.0235200652910057e-11,
      1.972780711765366e-11, 1.923313637195769e-11, 1.875086939446505e-11,
      1.8280695163214207e-11, 1.7822310455055958e-11, 1.7375419650099824e-11,
      1.6939734541063866e-11, 1.6514974147405047e-11, 1.610086453411022e-11,
      1.5697138635030903e-11, 1.5303536080647894e-11, 1.4919803030154664e-11,
      1.4545692007751208e-11, 1.4180961743042801e-11, 1.3825377015440734e-11,
      1.347870850246465e-11, 1.3140732631848687e-11, 1.2811231437356013e-11,
      1.2489992418208795e-11, 1.2176808402042929e-11, 1.1871477411299142e-11,
      1.1573802532964328e-11, 1.1283591791579084e-11, 1.100065802542955e-11,
      1.0724818765843723e-11, 1.045589611951439e-11, 1.019371665377279e-11,
      9.938111284739003e-12, 9.688915168276968e-12, 9.445967593683761e-12,
      9.209111880044603e-12, 8.978195275186744e-12, 8.753068857167058e-12,
      8.533587438229808e-12, 8.319609471172668e-12, 8.110996958060581e-12,
      7.907615361228608e-12, 7.709333516516357e-12, 7.516023548678043e-12,
      7.32756078891363e-12, 7.143823694467851e-12, 6.9646937702452726e-12,
      6.790055492390848e-12, 6.619796233786666e-12, 6.453806191416864e-12,
      6.291978315553835e-12, 6.13420824072009e-12, 5.980394218381237e-12,
      5.8304370513266574e-12, 5.6842400296955885e-12, 5.54170886860733e-12,
      5.402751647355361e-12, 5.26727875012616e-12, 5.135202808204474e-12,
      5.006438643627795e-12, 4.880903214253674e-12, 4.758515560204475e-12,
      4.639196751655003e-12, 4.5228698379293564e-12, 4.409459797874158e-12,
      4.2988934914761745e-12, 4.191099612693108e-12, 4.086008643467149e-12,
      3.98355280889163e-12, 3.8836660335018636e-12, 3.786283898661985e-12,
      3.6913436010203006e-12, 3.5987839120063735e-12, 3.508545138343699e-12,
      3.420569083552523e-12, 3.33479901041797e-12, 3.251179604399272e-12,
      3.1696569379565054e-12, 3.090178435771827e-12, 3.0126928408427812e-12,
      2.93715018142581e-12, 2.8635017388086477e-12, 2.791700015890817e-12,
      2.7216987065519608e-12, 2.6534526657882603e-12, 2.586917880597672e-12,
      2.5220514415952167e-12, 2.458811515340003e-12, 2.3971573173561503e-12,
      2.337049085830205e-12, 2.278448055968088e-12, 2.221316434995036e-12,
      2.1656173777824166e-12, 2.1113149630856942e-12, 2.058374170378224e-12,
      2.006760857265934e-12, 1.9564417374683307e-12, 1.907384359351625e-12,
      1.859557085000135e-12, 1.8129290698124722e-12, 1.7674702426093453e-12,
      1.7231512862401596e-12, 1.6799436186759012e-12, 1.6378193745761124e-12,
      1.5967513873180724e-12, 1.5567131714765922e-12, 1.5176789057431257e-12,
      1.4796234162731796e-12, 1.4425221604512845e-12, 1.4063512110630553e-12,
      1.3710872408641347e-12, 1.3367075075360668e-12, 1.3031898390193994e-12,
      1.2705126192145553e-12, 1.238654774041252e-12, 1.2075957578474778e-12,
      1.1773155401592612e-12, 1.147794592762686e-12, 1.1190138771098228e-12,
      1.0909548320404542e-12, 1.063599361811675e-12, 1.036929824427648e-12,
      1.0109290202619885e-12, 9.855801809654406e-13, 9.608669586516912e-13,
      9.367734153543467e-13, 9.13284012748275e-13, 8.90383602128682e-13,
      8.680574146414615e-13, 8.462910517585158e-13, 8.250704759919071e-13,
      8.043820018408486e-13, 7.842122869656986e-13, 7.645483235832645e-13,
      7.453774300778682e-13, 7.26687242822762e-13, 7.084657082066207e-13,
      6.907010748599685e-13, 6.733818860765257e-13, 6.564969724245896e-13,
      6.400354445436822e-13, 6.239866861218221e-13, 6.083403470488887e-13,
      5.930863367416646e-13, 5.782148176362515e-13, 5.637161988436625e-13,
      5.495811299644986e-13, 5.358004950587217e-13, 5.223654067666333e-13,
      5.092672005772693e-13, 4.964974292405137e-13, 4.840478573193265e-13,
      4.719104558785745e-13, 4.600773973070376e-13, 4.485410502692528e-13,
      4.372939747839399e-13, 4.263289174258338e-13, 4.156388066478308e-13,
      4.0521674822043073e-13, 3.950560207855339e-13, 3.8515007152172615e-13,
      3.7549251191825573e-13, 3.6607711365497687e-13, 3.5689780458560307e-13,
      3.479486648216792e-13, 3.392239229147476e-13, 3.3071795213424514e-13,
      3.2242526683873176e-13, 3.1434051893810917e-13, 3.064584944445492e-13,
      2.9877411010990655e-13, 2.9128241014744793e-13, 2.83978563035783e-13,
      2.768578584029364e-13, 2.6991570398855063e-13, 2.631476226822615e-13,
      2.5654924963633535e-13, 2.5011632945070647e-13, 2.4384471342859914e-13,
      2.377303569009644e-13, 2.317693166180059e-13, 2.2595774820611285e-13,
      2.202919036885599e-13, 2.1476812906837468e-13, 2.0938286197181473e-13,
      2.041326293509337e-13, 1.990140452437552e-13, 1.940238085906097e-13,
      1.891587011052267e-13, 1.8441558519920842e-13, 1.797914019585472e-13,
      1.7528316917088115e-13, 1.708879794022159e-13, 1.6660299812187247e-13,
      1.6242546187445133e-13, 1.5835267649763428e-13, 1.5438201538467457e-13,
      1.5051091779045464e-13, 1.467368871800193e-13, 1.4305748961851887e-13,
      1.3947035220152435e-13, 1.3597316152470201e-13, 1.3256366219186067e-13
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.012537398169645247, 0.024760423633562047, 0.024139561053675925, 0.023534266476535132,
      0.022944149537641425, 0.02236882966080684, 0.021807935812713827, 0.02126110626362971,
      0.020727988354121183, 0.02020823826761841, 0.019701520808682024, 0.019207509186830028,
      0.018725884805785215, 0.018256337058007138, 0.01779856312437617, 0.01735226777890043,
      0.016917163198319672, 0.016492968776483267, 0.016079410943382673,
      0.015676222988721594, 0.015283144889910097, 0.014899923144371734,
      0.014526310606055533, 0.014162066326047416, 0.013806955397178253,
      0.013460748802528342, 0.013123223267730596, 0.012794161116977214,
      0.012473350132636942, 0.01216058341839241, 0.011855659265809268, 0.01155838102425108,
      0.011268556974056064, 0.010986000202893918, 0.010710528485222949,
      0.010441964164769814, 0.010180134039956042, 0.009924869252197467, 0.00967600517700453,
      0.009433381317813221, 0.009196841202478188, 0.008966232282361252,
      0.008741405833950272, 0.008522216862944885, 0.008308524010747276,
      0.008100189463297684, 0.007897078862195829, 0.007699061218050953,
      0.007506008826004596, 0.007317797183371614, 0.007134304909346337,
      0.006955413666722077, 0.006781008085573504, 0.006610975688852667,
      0.006445206819850686, 0.006283594571478324, 0.0061260347173198336,
      0.005972425644415616, 0.005822668287730339, 0.005676666066264256,
      0.005534324820766518, 0.005395552753010318, 0.005260260366590686,
      0.005128360409206783, 0.004999767816391443, 0.0048743996566516885,
      0.00475217507798484, 0.004633015255735718, 0.004516843341761319, 0.004403584414870174,
      0.004293165432504431, 0.004185515183633501, 0.004080564242828883,
      0.003978244925490558, 0.0038784912441960665, 0.003781238866144129,
      0.0036864250716653556, 0.003593988713773293, 0.003503870178729719,
      0.003416011347598758, 0.003330355558765014, 0.0032468475713915575,
      0.0031654335297941942, 0.0030860609287090435, 0.0030086785794310226,
      0.002933236576801404, 0.002859686267023151, 0.0027879802162832797,
      0.0027180721801620057, 0.0026499170738089523, 0.0025834709428671845,
      0.0025186909351263154, 0.002455535272886406, 0.0023939632260148356,
      0.002333935085678763, 0.0022754121387362435, 0.002218356642769483,
      0.002162731801744126, 0.0021085017422788855, 0.0020556314905102032,
      0.002004086949537028, 0.001953834877431157, 0.0019048428657989682,
      0.0018570793188807087, 0.0018105134331738667, 0.0017651151775674825,
      0.0017208552739745875, 0.0016777051784502808, 0.0016356370627832672,
      0.0015946237965489816, 0.0015546389296127298, 0.001515656675071558,
      0.0014776518926238526, 0.0014406000723559424, 0.00140447731893525,
      0.001369260336199796, 0.0013349264121341178, 0.001301453404221915,
      0.0012688197251659742, 0.001237004328966163, 0.0012059866973465159,
      0.0011757468265226586, 0.001146265214301036, 0.0011175228475016244,
      0.0010895011896960172, 0.001062182169252975, 0.001035548167683731,
      0.0010095820082795359, 0.0009842669450341147, 0.0009595866518438887,
      0.0009355252119790015, 0.0009120671078183565, 0.0008891972108420455,
      0.0008669007718747161, 0.0008451634115735839, 0.0008239711111549564,
      0.000803310203353287, 0.0007831673636069294, 0.0007635296014649066,
      0.0007443842522091544, 0.0007257189686868349, 0.0007075217133474526,
      0.0006897807504796395, 0.0006724846386425996, 0.0006556222232873351,
      0.0006391826295628925, 0.0006231552553029908, 0.0006075297641885098,
      0.0005922960790814257, 0.0005774443755258987, 0.000562965075412318,
      0.0005488488408002209, 0.0005350865678960998, 0.0005216693811822151,
      0.0005085886276926274, 0.0004958358714327555, 0.0004834028879388646,
      0.0004712816589739727, 0.0004594643673567574, 0.00044794339192012576,
      0.00043671130259619767, 0.00042576085562453175, 0.0004150849888805046,
      0.0004046768173208293, 0.0003945296285432773, 0.0003846368784577387,
      0.0003749921870658305, 0.0003655893343463297, 0.0003564222562437787,
      0.0003474850407576756, 0.0003387719241297268, 0.0003302772871267044,
      0.0003219956514165089, 0.0003139216760351028, 0.00030605015394203386,
      0.0002983760086623289, 0.00029089429101259064, 0.0002836001759091876,
      0.00027648895925647777, 0.00026955605491305924, 0.0002627969917340917,
      0.00025620741068778114, 0.0002497830620441681, 0.00024351980263440624,
      0.0002374135931787643, 0.00023146049568162764, 0.0002256566708918196,
      0.00021999837582660495, 0.00021448196135777814, 0.0002091038698582803,
      0.00020386063290782642, 0.00019874886905606382, 0.0001937652816418187,
      0.00018890665666702484, 0.00018416986072396295, 0.00017955183897447408,
      0.00017504961317984407, 0.0001706602797800879, 0.00016638100802139586,
      0.00016220903813053353, 0.0001581416795350182, 0.00015417630912792428,
      0.00015031036957619808, 0.00014654136767139144, 0.0001428668727217502,
      0.000139284514984621, 0.00013579198413816478, 0.00013238702779139213,
      0.000129067450031559, 0.00012583111000798611, 0.000122675920551389,
      0.00011959984682782796, 0.00011660090502640984, 0.00011367716107989567,
      0.00011082672941738858, 0.00010804777174829791, 0.00010533849587679519,
      0.00010269715454599736, 0.00010012204431113185, 9.76115044409568e-05,
      9.516391584672807e-05, 9.277770003802199e-05, 9.045131810474081e-05,
      8.818326972464406e-05, 8.59720921957659e-05, 8.381635949309436e-05,
      8.171468134890427e-05, 7.966570235615048e-05, 7.766810109434348e-05,
      7.57205892773434e-05, 7.382191092252296e-05, 7.197084154076346e-05,
      7.016618734676147e-05, 6.840678448913692e-05, 6.669149829984608e-05,
      6.50192225624153e-05, 6.338887879852373e-05, 6.179941557247478e-05,
      6.024980781310781e-05, 5.873905615271274e-05, 5.726618628252132e-05,
      5.583024832435923e-05, 5.443031621805391e-05, 5.306548712420303e-05,
      5.1734880841918397e-05, 5.0437639241169836e-05, 4.91729257093629e-05,
      4.7939924611793565e-05, 4.67378407656319e-05, 4.5565898927095496e-05,
      4.442334329148188e-05, 4.330943700573759e-05, 4.222346169324939e-05,
      4.116471699055133e-05, 4.0132520095648726e-05, 3.912620532766785e-05,
      3.814512369754732e-05, 3.7188642489494275e-05, 3.625614485293552e-05,
      3.5347029404700346e-05, 3.446070984117857e-05, 3.359661456020364e-05,
      3.2754186292416896e-05, 3.193288174187536e-05, 3.113217123567119e-05,
      3.0351538382336818e-05, 2.9590479738815564e-05, 2.8848504485782863e-05,
      2.812513411110875e-05, 2.7419902101257466e-05, 2.6732353640425155e-05,
      2.6062045317221606e-05, 2.5408544838706918e-05, 2.4771430751598613e-05,
      2.4150292170469443e-05, 2.354472851276056e-05, 2.2954349240439205e-05,
      2.2378773608134246e-05, 2.1817630417587194e-05, 2.1270557778260287e-05,
      2.07372028739473e-05, 2.0217221735236525e-05, 1.9710279017679193e-05,
      1.92160477855203e-05, 1.8734209300852305e-05, 1.8264452818055794e-05,
      1.7806475383394466e-05, 1.735998163963526e-05, 1.6924683635567585e-05,
      1.6500300640298807e-05, 1.608655896220625e-05, 1.5683191772428943e-05,
      1.5289938932785253e-05, 1.4906546828005475e-05, 1.4532768202171142e-05,
      1.4168361999255584e-05, 1.3813093207662908e-05, 1.3466732708665125e-05,
      1.3129057128639685e-05, 1.2799848695012136e-05, 1.2478895095810975e-05,
      1.2165989342744144e-05, 1.1860929637708856e-05, 1.1563519242648652e-05,
      1.127356635267377e-05, 1.0990883972362998e-05, 1.0715289795167225e-05,
      1.0446606085836929e-05, 1.0184659565797775e-05, 9.92928130140039e-06,
      9.680306594972252e-06, 9.437574878601433e-06, 9.200929610583698e-06,
      8.970218174466165e-06, 8.745291780622425e-06, 8.526005370295647e-06,
      8.312217522047788e-06, 8.103790360554558e-06, 7.900589467687346e-06,
      7.702483795824743e-06, 7.509345583337753e-06, 7.321050272194209e-06,
      7.137476427629232e-06, 6.958505659829943e-06, 6.784022547583908e-06,
      6.613914563842087e-06, 6.448072003148279e-06, 6.2863879108882555e-06,
      6.128758014312955e-06, 5.975080655291264e-06, 5.825256724749001e-06,
      5.679189598751838e-06, 5.536785076190919e-06, 5.3979513180310095e-06,
      5.262598788081977e-06, 5.130640195255425e-06, 5.001990437269218e-06,
      4.876566545763614e-06, 4.754287632793594e-06, 4.6350748386628874e-06,
      4.518851281066046e-06, 4.405542005505774e-06, 4.295073936953527e-06,
      4.187375832722223e-06, 4.082378236520647e-06, 3.98001343365994e-06,
      3.8802154073832776e-06, 3.782919796290565e-06, 3.688063852830709e-06,
      3.59558640283468e-06, 3.5054278060632787e-06, 3.4175299177441564e-06,
      3.3318360510732896e-06, 3.2482909406567212e-06, 3.166840706868992e-06,
      3.087432821105277e-06, 3.0100160719048213e-06, 2.9345405319238167e-06,
      2.860957525736434e-06, 2.7892195984432325e-06, 2.719280485066711e-06,
      2.651095080714256e-06, 2.5846194114892513e-06, 2.5198106061315816e-06,
      2.4566268683692483e-06, 2.3950274499632606e-06, 2.3349726244284215e-06,
      2.2764236614130604e-06, 2.219342801721186e-06, 2.163693232960957e-06,
      2.10943906580376e-06, 2.0565453108385876e-06, 2.0049778560067873e-06,
      1.95470344460263e-06, 1.9056896538255095e-06, 1.857904873869942e-06,
      1.8113182875398781e-06, 1.7658998503741834e-06, 1.7216202712704673e-06,
      1.6784509935947663e-06, 1.6363641767648978e-06, 1.5953326782956075e-06,
      1.5553300362939305e-06, 1.516330452393479e-06, 1.4783087751166484e-06,
      1.4412404836540124e-06, 1.4051016720504476e-06, 1.3698690337877862e-06,
      1.3355198467540568e-06, 1.3020319585896184e-06, 1.2693837724007362e-06,
      1.2375542328313876e-06, 1.2065228124843137e-06, 1.1762694986825616e-06,
      1.146774780562977e-06, 1.118019636493326e-06, 1.0899855218049282e-06,
      1.0626543568328945e-06, 1.0360085152562501e-06, 1.010030812730429e-06,
      9.847044958048054e-07, 9.600132311181161e-07, 9.359410948648052e-07,
      9.124725625254977e-07, 8.895924988549804e-07, 8.672861481212313e-07,
      8.455391245892037e-07, 8.243374032432275e-07, 8.03667310742044e-07,
      7.83515516600642e-07, 7.63869024593207e-07, 7.447151643716399e-07,
      7.260415832942399e-07, 7.078362384592808e-07, 6.90087388938345e-07,
      6.727835882044033e-07, 6.559136767497608e-07, 6.394667748891054e-07,
      6.234322757430183e-07, 6.077998383974217e-07, 5.925593812345527e-07,
      5.777010754311604e-07, 5.63215338619735e-07, 5.490928287086806e-07,
      5.353244378574455e-07, 5.21901286602725e-07, 5.08814718131948e-07,
      4.960562927003559e-07, 4.83617782188071e-07, 4.714911647936458e-07,
      4.5966861986067034e-07, 4.481425228341013e-07, 4.369054403430604e-07,
      4.2595012540693014e-07, 4.1526951276165617e-07, 4.0485671430324127e-07,
      3.947050146454932e-07, 3.848078667891608e-07, 3.751588878996658e-07,
      3.65751855190707e-07, 3.565807019110824e-07, 3.4763951343214074e-07,
      3.389225234333398e-07, 3.304241101834504e-07, 3.221387929150091e-07,
      3.140612282896804e-07, 3.061862069522493e-07, 2.985086501710218e-07,
      2.910236065624669e-07, 2.837262488979873e-07, 2.766118709907594e-07,
      2.69675884660636e-07, 2.6291381677515256e-07, 2.563213063647301e-07,
      2.498941018102136e-07, 2.436280581009326e-07, 2.3751913416151492e-07,
      2.3156339024573033e-07, 2.25756985395683e-07, 2.2009617496471408e-07,
      2.1457730820241703e-07, 2.0919682590020826e-07, 2.0395125809593454e-07,
      1.9883722183603693e-07, 1.9385141899382798e-07, 1.8899063414247528e-07,
      1.8425173248131936e-07, 1.7963165781418885e-07, 1.7512743057840894e-07,
      1.707361459232321e-07, 1.664549718364517e-07, 1.6228114731799036e-07,
      1.5821198059928536e-07, 1.5424484740732252e-07, 1.5037718927219898e-07,
      1.4660651187712367e-07, 1.4293038344979102e-07, 1.3934643319409082e-07,
      1.3585234976114244e-07, 1.3244587975866775e-07, 1.29124826297741e-07,
      1.258870475759789e-07, 1.2273045549625664e-07, 1.1965301432005965e-07,
      1.1665273935460195e-07, 1.1372769567286498e-07, 1.1087599686573109e-07,
      1.0809580382540708e-07, 1.053853235593531e-07, 1.027428080339521e-07,
      1.0016655304717393e-07, 9.765489712950731e-08, 9.520622047245055e-08,
      9.281894388387026e-08, 9.049152776955419e-08, 8.822247114030137e-08,
      8.601031064390938e-08, 8.385361962143424e-08, 8.175100718711445e-08,
      7.970111733136569e-08, 7.77026280462678e-08, 7.575425047298e-08,
      7.385472807053443e-08, 7.200283580547211e-08, 7.019737936179853e-08,
      6.843719437074952e-08, 6.672114565987054e-08, 6.504812652092515e-08,
      6.341705799616056e-08, 6.182688818246987e-08, 6.027659155300235e-08,
      5.876516829578422e-08, 5.72916436689233e-08, 5.5855067371981855e-08,
      5.4454512933112065e-08, 5.3089077111559025e-08, 5.17578793151458e-08,
      5.046006103236494e-08, 4.919478527871023e-08, 4.796123605689145e-08,
      4.6758617830584265e-08, 4.558615501137565e-08, 4.444309145857408e-08,
      4.3328689991561875e-08, 4.224223191437521e-08, 4.1183016552205174e-08,
      4.0150360799521004e-08, 3.9143598679523983e-08, 3.8162080914648e-08,
      3.720517450782968e-08, 3.627226233427809e-08, 3.5362742743480755e-08,
      3.447602917118925e-08, 3.3611549761134246e-08, 3.276874699622588e-08,
      3.1947077339001786e-08, 3.1146010881090755e-08, 3.036503100146608e-08,
      2.960363403326808e-08, 2.8861328938980996e-08, 2.8137636993754777e-08,
      2.743209147666749e-08, 2.6744237369729267e-08, 2.6073631064433665e-08,
      2.5419840075667194e-08, 2.4782442762792505e-08, 2.416102805772536e-08,
      2.3555195199830015e-08, 2.2964553477462047e-08, 2.2388721975991943e-08,
      2.182732933214695e-08, 2.1280013494512744e-08, 2.0746421490040484e-08,
      2.022620919640864e-08, 1.971904112009281e-08, 1.922459018000039e-08,
      1.8742537496530557e-08, 1.827257218592354e-08, 1.7814391159766523e-08,
      1.7367698929526922e-08, 1.6932207415986922e-08, 1.6507635763456425e-08,
      1.6093710158644568e-08, 1.5690163654072985e-08, 1.5296735995916967e-08,
      1.4913173456163454e-08, 1.4539228668977644e-08, 1.4174660471172657e-08,
      1.3819233746679411e-08, 1.3472719274916376e-08, 1.3134893582961415e-08,
      1.2805538801430405e-08, 1.2484442523969656e-08, 1.217139767027154e-08,
      1.1866202352524968e-08, 1.1568659745214596e-08, 1.1278577958184792e-08,
      1.0995769912886497e-08, 1.072005322172717e-08, 1.0451250070446007e-08,
      1.0189187103438578e-08, 9.93369531195693e-09, 9.684609925113046e-09,
      9.441770303615366e-09, 9.20501983616985e-09, 8.974205838478762e-09,
      8.749179454772036e-09, 8.529795561807723e-09, 8.315912675279612e-09,
      8.107392858571652e-09, 7.90410163380035e-09, 7.705907895087753e-09,
      7.512683824009097e-09, 7.324304807160587e-09, 7.1406493557941495e-09,
      6.961599027467326e-09, 6.78703834965778e-09, 6.616854745293158e-09,
      6.450938460148264e-09, 6.289182492062751e-09, 6.1314825219336464e-09,
      5.977736846438242e-09, 5.8278463124439305e-09, 5.681714253062714e-09,
      5.539246425309123e-09, 5.400350949321354e-09, 5.264938249106428e-09,
      5.132920994771144e-09, 5.004214046201589e-09, 4.878734398154868e-09,
      4.756401126727643e-09, 4.637135337166976e-09, 4.520860112989787e-09,
      4.4075004663781464e-09, 4.296983289818387e-09, 4.189237308952857e-09,
      4.084193036613907e-09, 3.9817827280104654e-09, 3.881940337038299e-09,
      3.784601473685787e-09, 3.689703362507737e-09, 3.59718480214046e-09,
      3.5069861258319974e-09, 3.419049162962043e-09, 3.333317201526748e-09,
      3.2497349515642114e-09, 3.168248509497065e-09, 3.0888053233691654e-09,
      3.0113541589539675e-09, 2.9358450667127215e-09, 2.8622293495811895e-09,
      2.7904595315641014e-09, 2.7204893271171e-09, 2.6522736112964254e-09,
      2.585768390657093e-09, 2.520930774880792e-09, 2.4577189491152064e-09,
      2.3960921470069276e-09, 2.336010624410556e-09, 2.2774356337570425e-09,
      2.2203293990647418e-09, 2.1646550915770543e-09, 2.1103768060109516e-09,
      2.0574595374010648e-09, 2.0058691585244022e-09, 1.955572397891139e-09,
      1.906536818287281e-09, 1.8587307958553686e-09, 1.812123499699728e-09,
      1.7666848720031152e-09, 1.7223856086419317e-09, 1.6791971402875104e-09,
      1.6370916139812822e-09, 1.5960418751719413e-09, 1.5560214502030257e-09,
      1.5170045292396175e-09, 1.478965949623153e-09, 1.441881179643607e-09,
      1.4057263027185877e-09, 1.3704780019691355e-09, 1.3361135451822817e-09,
      1.3026107701506687e-09, 1.2699480703797744e-09, 1.2381043811535267e-09,
      1.2070591659493189e-09, 1.176792403193666e-09, 1.1472845733499606e-09,
      1.1185166463300006e-09, 1.0904700692211697e-09, 1.063126754321357e-09,
      1.0364690674738982e-09, 1.0104798166950158e-09, 9.851422410864248e-10,
      9.604400000259506e-10, 9.363571626291917e-10, 9.12878197475429e-10,
      8.89987962591154e-10, 8.676716956847608e-10, 8.459150046260986e-10,
      8.247038581647492e-10, 8.040245768810411e-10, 7.838638243639648e-10,
      7.642085986103011e-10, 7.450462236394132e-10, 7.263643413182974e-10,
      7.081509033916183e-10, 6.903941637115889e-10, 6.73082670662686e-10,
      6.562052597763135e-10, 6.397510465306513e-10, 6.237094193310473e-10,
      6.080700326664241e-10, 5.928228004372879e-10, 5.77957889451035e-10,
      5.634657130803642e-10, 5.49336925080701e-10, 5.355624135626504e-10,
      5.221332951155881e-10, 5.090409090786021e-10, 4.962768119550889e-10,
      4.838327719674027e-10, 4.717007637480457e-10, 4.5987296316397576e-10,
      4.4834174227069306e-10, 4.3709966439285277e-10, 4.2613947932822977e-10,
      4.154541186719431e-10, 4.0503669125792475e-10, 3.9488047871469223e-10,
      3.849789311325598e-10, 3.7532566283949317e-10, 3.659144482828837e-10,
      3.5673921801458656e-10, 3.477940547766331e-10, 3.3907318968509295e-10,
      3.3057099850962566e-10, 3.222819980463209e-10, 3.142008425814898e-10,
      3.063223204441255e-10, 2.9864135064481017e-10, 2.911529795989009e-10,
      2.8385237793188087e-10, 2.7673483736481566e-10, 2.6979576767790624e-10,
      2.630306937501802e-10, 2.5643525267341215e-10, 2.5000519093841187e-10,
      2.437363616918658e-10, 2.3762472206196263e-10, 2.3166633055107843e-10,
      2.258573444938394e-10, 2.201940175789234e-10, 2.1467269743300175e-10,
      2.092898232652631e-10, 2.0404192357100056e-10, 1.9892561389278066e-10,
      1.9393759463775087e-10, 1.890746489496774e-10, 1.843336406343414e-10,
      1.7971151213695532e-10, 1.7520528257029524e-10, 1.7081204579227725e-10,
      1.6652896853173834e-10, 1.6235328856121289e-10, 1.582823129155264e-10,
      1.5431341615505774e-10, 1.504440386725495e-10, 1.46671685042375e-10,
      1.429939224111969e-10, 1.3940837892897984e-10, 1.3591274221934505e-10,
      1.325047578882805e-10, 1.2918222807024488e-10, 1.2594301001072773e-10,
      1.2278501468435152e-10, 1.1970620544762462e-10, 1.1670459672547618e-10,
      1.1377825273072584e-10, 1.1092528621566257e-10, 1.0814385725492733e-10,
      1.0543217205891473e-10, 1.0278848181692842e-10, 1.0021108156934408e-10,
      9.769830910805275e-11, 9.524854390447529e-11, 9.286020606445661e-11,
      9.053175530936582e-11, 8.8261689982745e-11, 8.604854608186607e-11,
      8.389089631357123e-11, 8.178734917378789e-11, 7.973654805012473e-11,
      7.77371703469698e-11, 7.578792663252681e-11, 7.388755980723912e-11,
      7.203484429306545e-11, 7.022858524308433e-11, 6.846761777091749e-11,
      6.675080619947536e-11, 6.507704332854006e-11, 6.344524972071375e-11,
      6.185437300527142e-11, 6.030338719946974e-11, 5.879129204687367e-11,
      5.731711237227457e-11, 5.587989745278356e-11, 5.447872040469458e-11,
      5.311267758572172e-11, 5.178088801222535e-11, 5.048249279105119e-11,
      4.9216654565615886e-11, 4.798255697588186e-11, 4.677940413187322e-11,
      4.560642010039314e-11, 4.446284840461166e-11, 4.3347951536201276e-11,
      4.22610104797056e-11, 4.1201324248834364e-11, 4.016820943438577e-11,
      3.9160999763504584e-11, 3.81790456699917e-11, 3.722171387538819e-11,
      3.628838698056349e-11, 3.53784630675445e-11, 3.4491355311328716e-11,
      3.3626491601431044e-11, 3.27833141729203e-11, 3.196127924670735e-11,
      3.115985667885297e-11, 3.0378529618669254e-11, 2.961679417539402e-11,
      2.8874159093223332e-11, 2.8150145434492486e-11, 2.744428627080118e-11,
      2.6756126381883655e-11, 2.6085221962029607e-11, 2.5431140333866528e-11,
      2.479345966931891e-11, 2.417176871756433e-11, 2.3565666539810974e-11,
      2.2974762250725583e-11, 2.2398674766345022e-11, 2.1837032558308916e-11,
      2.1289473414254866e-11, 2.0755644204221688e-11, 2.0235200652910057e-11,
      1.972780711765366e-11, 1.923313637195769e-11, 1.875086939446505e-11,
      1.8280695163214207e-11, 1.7822310455055958e-11, 1.7375419650099824e-11,
      1.6939734541063866e-11, 1.6514974147405047e-11, 1.610086453411022e-11,
      1.5697138635030903e-11, 1.5303536080647894e-11, 1.4919803030154664e-11,
      1.4545692007751208e-11, 1.4180961743042801e-11, 1.3825377015440734e-11,
      1.347870850246465e-11, 1.3140732631848687e-11, 1.2811231437356013e-11,
      1.2489992418208795e-11, 1.2176808402042929e-11, 1.1871477411299142e-11,
      1.1573802532964328e-11, 1.1283591791579084e-11, 1.100065802542955e-11,
      1.0724818765843723e-11, 1.045589611951439e-11, 1.019371665377279e-11,
      9.938111284739003e-12, 9.688915168276968e-12, 9.445967593683761e-12,
      9.209111880044603e-12, 8.978195275186744e-12, 8.753068857167058e-12,
      8.533587438229808e-12, 8.319609471172668e-12, 8.110996958060581e-12,
      7.907615361228608e-12, 7.709333516516357e-12, 7.516023548678043e-12,
      7.32756078891363e-12, 7.143823694467851e-12, 6.9646937702452726e-12,
      6.790055492390848e-12, 6.619796233786666e-12, 6.453806191416864e-12,
      6.291978315553835e-12, 6.13420824072009e-12, 5.980394218381237e-12,
      5.8304370513266574e-12, 5.6842400296955885e-12, 5.54170886860733e-12,
      5.402751647355361e-12, 5.26727875012616e-12, 5.135202808204474e-12,
      5.006438643627795e-12, 4.880903214253674e-12, 4.758515560204475e-12,
      4.639196751655003e-12, 4.5228698379293564e-12, 4.409459797874158e-12,
      4.2988934914761745e-12, 4.191099612693108e-12, 4.086008643467149e-12,
      3.98355280889163e-12, 3.8836660335018636e-12, 3.786283898661985e-12,
      3.6913436010203006e-12, 3.5987839120063735e-12, 3.508545138343699e-12,
      3.420569083552523e-12, 3.33479901041797e-12, 3.251179604399272e-12,
      3.1696569379565054e-12, 3.090178435771827e-12, 3.0126928408427812e-12,
      2.93715018142581e-12, 2.8635017388086477e-12, 2.791700015890817e-12,
      2.7216987065519608e-12, 2.6534526657882603e-12, 2.586917880597672e-12,
      2.5220514415952167e-12, 2.458811515340003e-12, 2.3971573173561503e-12,
      2.337049085830205e-12, 2.278448055968088e-12, 2.221316434995036e-12,
      2.1656173777824166e-12, 2.1113149630856942e-12, 2.058374170378224e-12,
      2.006760857265934e-12, 1.9564417374683307e-12, 1.907384359351625e-12,
      1.859557085000135e-12, 1.8129290698124722e-12, 1.7674702426093453e-12,
      1.7231512862401596e-12, 1.6799436186759012e-12, 1.6378193745761124e-12,
      1.5967513873180724e-12, 1.5567131714765922e-12, 1.5176789057431257e-12,
      1.4796234162731796e-12, 1.4425221604512845e-12, 1.4063512110630553e-12,
      1.3710872408641347e-12, 1.3367075075360668e-12, 1.3031898390193994e-12,
      1.2705126192145553e-12, 1.238654774041252e-12, 1.2075957578474778e-12,
      1.1773155401592612e-12, 1.147794592762686e-12, 1.1190138771098228e-12,
      1.0909548320404542e-12, 1.063599361811675e-12, 1.036929824427648e-12,
      1.0109290202619885e-12, 9.855801809654406e-13, 9.608669586516912e-13,
      9.367734153543467e-13, 9.13284012748275e-13, 8.90383602128682e-13,
      8.680574146414615e-13, 8.462910517585158e-13, 8.250704759919071e-13,
      8.043820018408486e-13, 7.842122869656986e-13, 7.645483235832645e-13,
      7.453774300778682e-13, 7.26687242822762e-13, 7.084657082066207e-13,
      6.907010748599685e-13, 6.733818860765257e-13, 6.564969724245896e-13,
      6.400354445436822e-13, 6.239866861218221e-13, 6.083403470488887e-13,
      5.930863367416646e-13, 5.782148176362515e-13, 5.637161988436625e-13,
      5.495811299644986e-13, 5.358004950587217e-13, 5.223654067666333e-13,
      5.092672005772693e-13, 4.964974292405137e-13, 4.840478573193265e-13,
      4.719104558785745e-13, 4.600773973070376e-13, 4.485410502692528e-13,
      4.372939747839399e-13, 4.263289174258338e-13, 4.156388066478308e-13,
      4.0521674822043073e-13, 3.950560207855339e-13, 3.8515007152172615e-13,
      3.7549251191825573e-13, 3.6607711365497687e-13, 3.5689780458560307e-13,
      3.479486648216792e-13, 3.392239229147476e-13, 3.3071795213424514e-13,
      3.2242526683873176e-13, 3.1434051893810917e-13, 3.064584944445492e-13,
      2.9877411010990655e-13, 2.9128241014744793e-13, 2.83978563035783e-13,
      2.768578584029364e-13, 2.6991570398855063e-13, 2.631476226822615e-13,
      2.5654924963633535e-13, 2.5011632945070647e-13, 2.4384471342859914e-13,
      2.377303569009644e-13, 2.317693166180059e-13, 2.2595774820611285e-13,
      2.202919036885599e-13, 2.1476812906837468e-13, 2.0938286197181473e-13,
      2.041326293509337e-13, 1.990140452437552e-13, 1.940238085906097e-13,
      1.891587011052267e-13, 1.8441558519920842e-13, 1.797914019585472e-13,
      1.7528316917088115e-13, 1.708879794022159e-13, 1.6660299812187247e-13,
      1.6242546187445133e-13, 1.5835267649763428e-13, 1.5438201538467457e-13,
      1.5051091779045464e-13, 1.467368871800193e-13, 1.4305748961851887e-13,
      1.3947035220152435e-13, 1.3597316152470201e-13, 1.3256366219186067e-13
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_2_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<2>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.09563747117762104), "design.b()[0] == 0.09563747117762104");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.09563747117762104));
    static_assert(almost_equal(design.b()[1], -0.17944230627756996), "design.b()[1] == -0.17944230627756996");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.17944230627756996));
    static_assert(almost_equal(design.b()[2], 0.09563747117762107), "design.b()[2] == 0.09563747117762107");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.09563747117762107));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.8476699251252242), "design.a()[1] == -1.8476699251252242");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.8476699251252242));
    static_assert(almost_equal(design.a()[2], 0.8595025612028964), "design.a()[2] == 0.8595025612028964");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.8595025612028964));
    std::cout << "max_deviation(cheby2,lowpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.09563747117762104, -0.0027358270676491048, 0.008381914360248825, 0.017838461450059604,
      0.025755311871363627, 0.03225511185269387, 0.03746004358375622, 0.04149044467431021,
      0.04446364340178441, 0.046492993211952965, 0.04768708990253073, 0.048149155085986335,
      0.04797656986502923, 0.04726054313412292, 0.04608589951728001, 0.04453097264280275,
      0.04266759021823927, 0.04056113818446284, 0.03827069207934803, 0.03584920461388908,
      0.03334373934353625, 0.030795741193542264, 0.028241335459396825, 0.025711647743708953,
      0.023233138102323112, 0.02082794344947882, 0.01851422301008362, 0.016306502303376776,
      0.014216011794085992, 0.0122510169531449, 0.010417137029417597, 0.008717650346595067,
      0.007153784405975238, 0.005724989497180487, 0.004429194896369107,
      0.0032630470668530247, 0.0022221295721963656, 0.0013011646689928317,
      0.0004941967679060997, -0.00020524186039186647, -0.0008039826005762877,
      -0.001309088566735916, -0.0017277384697253523, -0.0020671254330424625,
      -0.0023343698542763, -0.0025364453698376293, -0.0026801169580268026,
      -0.002771890207437556, -0.0028179707822841384, -0.0028242331316421965,
      -0.0027961975141093686, -0.002739014441449251, -0.0026574556829432714,
      -0.002555911015130044, -0.0024383899481791303, -0.0023085277092672655,
      -0.0021695948140599934, -0.002024509608923233, -0.0018758532180774006,
      -0.0017258863809415886, -0.0015765677148707681, -0.0014295729869256248,
      -0.0012863150248726897, -0.0011479639420049245, -0.0010154673923788516,
      -0.0008895706125219337, -0.0007708360424643516, -0.0006596623530305014,
      -0.0005563027376661809, -0.00046088235569178464, -0.0003734148398043112,
      -0.00029381780397156606, -0.00022192730866162655, -0.00015751125873749848,
      -0.00010028172544235988, -4.990619783634134e-05, -6.017780960003446e-06,
      3.1775631964444256e-05, 6.388317768043238e-05, 9.072378906428542e-05,
      0.00011271986171337355, 0.0001302917693892899, 0.00014385317395086136,
      0.00015380707364906205, 0.0001605425328049612, 0.00016443203583466518,
      0.00016582940921095984, 0.0001650682561566732, 0.00016246085055396855,
      0.00015829743863887493, 0.00015284589945106788, 0.00014635171765248079,
      0.00013903822514935393, 0.00013110707089250046, 0.00012273888123835914,
      0.00011409407628371896, 0.00010531381060082282, 9.652100976353927e-05,
      8.782147694136567e-05, 7.930504662298794e-05, 7.104676519622366e-05,
      6.31080806417227e-05, 5.5538025982753366e-05, 4.837438336499708e-05,
      4.164481771365351e-05, 3.5367970828014024e-05, 2.955450852591484e-05,
      2.4208115043962498e-05, 1.9326430337584358e-05, 1.4901927212602218e-05,
      1.0922726363067169e-05, 7.373348395320884e-06, 4.2354027931301005e-06,
      1.4882145312382931e-06, -8.906103169178946e-07, -2.9246780987941193e-06,
      -4.63835791538966e-06, -6.056386105624441e-06, -7.203521954255419e-06,
      -8.104251500439177e-06, -8.782536193648613e-06, -9.261603070068415e-06,
      -9.563773098714735e-06, -9.710324365648477e-06, -9.721386820510684e-06,
      -9.61586539638056e-06, -9.41138842627169e-06, -9.12427841252242e-06,
      -8.769542354431184e-06, -8.360879000703031e-06, -7.91070056299915e-06,
      -7.430166601912939e-06, -6.9292279742174585e-06, -6.4166789077895894e-06,
      -5.900215446109534e-06, -5.386498675874138e-06, -4.8812213175594535e-06,
      -4.389176418504891e-06, -3.9143270402998045e-06, -3.4598759761900706e-06,
      -3.0283346693462346e-06, -2.6215906287853413e-06, -2.2409727563141858e-06,
      -1.8873141050001867e-06, -1.5610116874355173e-06, -1.2620830406015698e-06,
      -9.902193337116356e-07, -7.448348763287389e-07, -5.251129466992003e-07,
      -3.3004791503220364e-07, -1.584836838465254e-07, -9.14850797642436e-09,
      1.1931370912715117e-07, 2.2831551804629804e-07, 3.1930127755212644e-07,
      3.937255950639667e-07, 4.5303467490031417e-07, 4.9865038648358e-07,
      5.319568588672389e-07, 5.542894052656296e-07, 5.669255812790113e-07,
      5.710781828399264e-07, 5.678899942077448e-07, 5.584301022791752e-07,
      5.436916007627804e-07, 5.245905161108332e-07, 5.019657962637936e-07,
      4.7658021301813675e-07, 4.491220389784022e-07, 4.20207370423602e-07,
      3.9038297785304024e-07, 3.6012957634446875e-07, 3.2986541804506165e-07,
      2.999501190277349e-07, 2.7068864230328247e-07, 2.423353679193027e-07,
      2.1509818975044574e-07, 1.8914258675409048e-07, 1.6459562410530685e-07,
      1.4154984671891007e-07, 1.200670342073151e-07, 1.0018179231105702e-07,
      8.190496128105838e-08, 6.522682660030739e-08, 5.0120121824452204e-08,
      3.6542817216551315e-08, 2.4440691274452278e-08, 1.3749685225880813e-08,
      4.398043123837591e-09, -3.6917576580596746e-09, -1.060127892486679e-08,
      -1.641458907489754e-08, -2.1216916179027968e-08, -2.5093476576925246e-08,
      -2.812846819131733e-08, -3.04042173295864e-08, -3.200046750369651e-08,
      -3.2993798730378093e-08, -3.34571658506372e-08, -3.3459544609576204e-08,
      -3.306567454428701e-08, -3.233588812084449e-08, -3.132601602438227e-08,
      -3.008735902360582e-08, -2.8666717389121967e-08, -2.7106469431324673e-08,
      -2.5444691327354902e-08, -2.3715311018256697e-08, -2.1948289568545096e-08,
      -2.016982398382556e-08, -1.8402566071796597e-08, -1.6665852502878734e-08,
      -1.4975941774727282e-08, -1.3346254306736103e-08, -1.1787612383825749e-08,
      -1.030847713152362e-08, -8.915180135392124e-09, -7.612147716591813e-09,
      -6.402116241602628e-09, -5.286337178099467e-09, -4.264770911269611e-09,
      -3.336268606343172e-09, -2.498741644899884e-09, -1.7493183759266737e-09,
      -1.0844881090928276e-09, -5.002324388584735e-10, 7.855874508527372e-12,
      4.444661254605932e-10, 8.14474548489905e-10, 1.1228603548234356e-09,
      1.374632347261054e-09, 1.5747654952946068e-09, 1.7281468215975477e-09,
      1.8395299319668728e-09, 1.9134975123651033e-09, 1.9544311174640163e-09,
      1.9664875837339705e-09, 1.953581415442467e-09, 1.91937251280357e-09,
      1.8672586369280052e-09, 1.8003720352250886e-09, 1.7215796826540375e-09,
      1.6334866279524577e-09, 1.5384419690059576e-09, 1.4385470172669203e-09,
      1.335665247060038e-09, 1.2314336612760793e-09, 1.127275239968852e-09,
      1.0244121724105178e-09, 9.238796059612715e-10, 8.265396764569211e-10,
      7.330956145453509e-10, 6.441057503861017e-10, 5.599972652802745e-10,
      4.810795630683672e-10, 4.0755715649879195e-10, 3.3954198423274025e-10,
      2.770650927368959e-10, 2.2008763406804003e-10, 1.685111455322032e-10,
      1.221870904776854e-10, 8.092565113801134e-11, 4.450377456737879e-11,
      1.2672481402565809e-11, -1.483654545962883e-11, -3.830506906081077e-11,
      -5.8023075261550595e-11, -7.428418615922375e-11, -8.738167488263e-11,
      -9.76050444269801e-11, -1.0523713176442323e-10, -1.1055169769625334e-10,
      -1.138114627197344e-10, -1.1526654948650581e-10, -1.1515329315731546e-10,
      -1.1369338204122792e-10, -1.110932922836885e-10, -1.0754398197946259e-10,
      -1.0322081188136988e-10, -9.828366180690932e-11, -9.287721387032524e-11,
      -8.713137575018541e-11, -8.116181930946916e-11, -7.507061198813754e-11,
      -6.894692046285143e-11, -6.286776809433841e-11, -5.6898829642783037e-11,
      -5.109524861160022e-11, -4.5502464369030796e-11, -4.01570378867712e-11,
      -3.508746651927583e-11, -3.031497972250259e-11, -2.5854308974610595e-11,
      -2.1714426412978326e-11, -1.7899247842796017e-11, -1.4408296804490057e-11,
      -1.1237327313445556e-11, -8.378903709810874e-12, -5.822936783156003e-12,
      -3.5571759714878688e-12, -1.5676579820510978e-12, 1.6088735182491211e-13,
      1.6446727719630137e-12, 2.900529326469733e-12, 3.945620343618971e-12,
      4.797191659922178e-12, 5.4723559642250036e-12, 5.9879090163939e-12,
      6.360175436911835e-12, 6.604881737461708e-12, 6.737054267591362e-12,
      6.770939784374531e-12, 6.719946406465012e-12, 6.596602787258232e-12,
      6.4125334305113856e-12, 6.178448172529354e-12, 5.904143965003659e-12,
      5.59851720919852e-12, 5.269585013100839e-12, 4.924513866352411e-12,
      4.569654351484919e-12, 4.210580632647222e-12, 3.8521335833437625e-12,
      3.498466531597532e-12, 3.1530927135102604e-12, 2.8189336336937002e-12,
      2.4983676329275562e-12, 2.193278059245819e-12, 1.9051005281778675e-12,
      1.6348688409025263e-12, 1.3832592055420651e-12, 1.1506324767461526e-12,
      9.370741921853264e-13, 7.424322417452918e-13, 5.663520562956524e-13,
      4.083092481506187e-13, 2.6763967502975e-13, 1.4356693377447178e-13,
      3.522731960995533e-14, -5.83076882971166e-14, -1.3801133349922798e-13,
      -2.0488378280375904e-13, -2.599365090147806e-13, -3.0417873407988307e-13,
      -3.3860580357371934e-13, -3.641893587309061e-13, -3.8186916976796014e-13,
      -3.9254649372074427e-13, -3.970788212011915e-13, -3.962758790934214e-13,
      -3.9089676003162326e-13, -3.816480543155971e-13, -3.6918286552839267e-13,
      -3.541005973460032e-13, -3.369474057112089e-13, -3.1821721753920266e-13,
      -2.9835322430476033e-13, -2.777497661182418e-13, -2.5675452913415664e-13,
      -2.356709862687351e-13, -2.147610181620902e-13, -1.9424765804817568e-13,
      -1.7431791064476464e-13, -1.551256013089264e-13, -1.3679421749275658e-13,
      -1.1941970995924356e-13, -1.0307322626610121e-13, -8.780375368942563e-14,
      -7.364065303789505e-14, -6.059606870541058e-14, -4.866720383308426e-14,
      -3.7838452611201743e-14, -2.808338456187414e-14, -1.9366578119418548e-14,
      -1.1645302985661175e-14, -4.8710526002009186e-15, 1.0090703490652554e-15,
      6.051111121930202e-15, 1.03131574841257e-14, 1.3854365409076837e-14,
      1.673410902635164e-14, 1.901124741881412e-14, 2.0743500527259653e-14,
      2.1986926217904206e-14, 2.279549048727559e-14, 2.3220722804549475e-14,
      2.3311448707945885e-14, 2.31135919652781e-14, 2.2670038866030935e-14,
      2.2020557521430086e-14, 2.120176539891363e-14, 2.024713869834845e-14,
      1.91870575803883e-14, 1.804888167466865e-14, 1.685705072013786e-14,
      1.5633205615683504e-14, 1.4396325581111558e-14, 1.3162877542039269e-14,
      1.194697425365603e-14, 1.0760538064542782e-14, 9.613467590378467e-15,
      8.513804916512575e-15, 7.467901276652225e-15, 6.480579461350214e-15,
      5.555291494028048e-15, 4.6942703737102025e-15, 3.8986749225649156e-15,
      3.168726993080311e-15, 2.503840484804927e-15, 1.9027417947797444e-15,
      1.3635814799599887e-15, 8.840370450588287e-16, 4.614068864173244e-16,
      9.269552285265704e-17, -2.2530967086373186e-16, -4.959699419986807e-16,
      -7.227345064259051e-16, -9.0908737594585e-16, -1.0585012445033785e-15,
      -1.1743979871938355e-15, -1.2601153103785411e-15, -1.31887908331164e-15,
      -1.3537808804303034e-15, -1.367760267957336e-15, -1.3635913778486297e-15,
      -1.3438733255900887e-15, -1.3110240451757419e-15, -1.2672771341102965e-15,
      -1.2146813228673487e-15, -1.1551022063516561e-15, -1.0902258990719374e-15,
      -1.0215643004974618e-15, -9.504616820686865e-16, -8.781023322312309e-16,
      -8.055190203827141e-16, -7.336020645264937e-16, -6.631088105187856e-16,
      -5.946733529168673e-16, -5.288163484607719e-16, -4.659547930543476e-16,
      -4.06411651686469e-16, -3.504252480065796e-16, -2.9815833621908553e-16,
      -2.497067925855639e-16, -2.0510787713553042e-16, -1.6434802821254656e-16,
      -1.2737016326107674e-16, -9.408046883845158e-17, -6.435467127076131e-17,
      -3.8043786722487555e-17, -1.4979355782428778e-17, 5.021826948890524e-18,
      2.2153473282815338e-17, 3.661603319723394e-17, 4.861337628979624e-17,
      5.834989901533933e-17, 6.602803211493638e-17, 7.184612150435588e-17,
      7.599665522651608e-17, 7.86648088266561e-17, 8.00272816246937e-17,
      8.02513967844259e-17, 7.949443876534516e-17, 7.790320264511306e-17,
      7.561373087811023e-17, 7.275121427061387e-17, 6.9430035272312e-17,
      6.575393307682107e-17, 6.181627146377939e-17, 5.770039177831024e-17,
      5.348003490959469e-17, 4.9219817581237004e-17, 4.497574968698443e-17,
      4.0795780783588794e-17, 3.6720365177855086e-17, 3.278303630897193e-17,
      2.9010982323703575e-17, 2.542561586627767e-17, 2.2043132153672797e-17,
      1.8875050378675383e-17, 1.5928734376886296e-17, 1.3207889310175901e-17,
      1.0713031859140565e-17, 8.441932082861846e-18, 6.390025698274033e-18,
      4.550796056757583e-18, 2.9161255556305913e-18, 1.476616620732543e-18,
      2.218827372138469e-19, -8.591897069798983e-19, -1.778207762485923e-18,
      -2.5470652496610688e-18, -3.177761732922805e-18, -3.682245677500699e-18,
      -4.072280246900692e-18, -4.359330148089786e-18, -4.554467906170078e-18,
      -4.668297947766333e-18, -4.7108968893420836e-18, -4.691768460239951e-18,
      -4.619811537684162e-18, -4.503299829778335e-18, -4.349871810388743e-18,
      -4.166529584646246e-18, -3.959645443761957e-18, -3.734974951267001e-18,
      -3.497675488183307e-18, -3.2523292707213333e-18, -3.0029699397661174e-18,
      -2.753111905700827e-18, -2.5057817142233247e-18, -2.2635507780711186e-18,
      -2.0285688954454748e-18, -1.802598047994164e-18, -1.587046039156336e-18,
      -1.3829995972679455e-18, -1.1912566269304972e-18, -1.0123573466912258e-18,
      -8.466141010642621e-19, -6.94139680389687e-19, -5.54874023076839e-19,
      -4.286092115448192e-19, -3.1501270582349926e-19, -2.1364878750447308e-19,
      -1.2399821174473251e-19, -4.547608655206365e-20, 2.2551983144537005e-20,
      8.07554338730753e-20, 1.2982589918478594e-19, 1.70465907181109e-19,
      2.0337903709793053e-19, 2.292614464268351e-19, 2.487946762729208e-19,
      2.626396404917966e-19, 2.7143170341217273e-19, 2.757767514440741e-19,
      2.7624816541752255e-19, 2.733846029265782e-19, 2.676885031157779e-19,
      2.5962523009998194e-19, 2.496227754268721e-19, 2.3807194455869366e-19,
      2.2532695716320606e-19, 2.117063959716844e-19, 1.9749444400370225e-19,
      1.8294235500427102e-19, 1.6827010692844952e-19, 1.5366819319064136e-19,
      1.392995111277932e-19, 1.253013116726923e-19, 1.1178717856772612e-19,
      9.884900954942918e-20, 8.655897578429028e-20, 7.497143942617177e-20,
      6.41248124893881e-20, 5.4043343287074307e-20, 4.473881947346082e-20,
      3.621217925551255e-20, 2.845502461102048e-20, 2.1451032375629188e-20,
      1.517726085107399e-20, 9.605351153010339e-21, 4.702623872141552e-21,
      4.330727804662934e-22, -3.2417417106216172e-21, -6.361895827737598e-21,
      -8.968398284652866e-21, -1.1102574029051266e-20, -1.280553082940761e-20,
      -1.4117703374845985e-20, -1.5078469392103318e-20, -1.5725832203727624e-20,
      -1.6096164148860976e-20, -1.62240053515784e-20, -1.6141912441693852e-20,
      -1.5880351999871272e-20, -1.546763370421559e-20, -1.492987839143952e-20,
      -1.4291016505118217e-20, -1.3572812680085074e-20, -1.279491250000951e-20,
      -1.1974907759616097e-20, -1.1128416859466213e-20, -1.0269177255933747e-20,
      -9.409147178724059e-21, -8.558614110283711e-21, -7.726307793475257e-21,
      -6.919515794128769e-21, -6.144199892106827e-21, -5.405111807265861e-21,
      -4.705906984416001e-21, -4.049255363609159e-21, -3.436948248604495e-21,
      -2.8700005571717003e-21, -2.3487478921814143e-21, -1.8729380125420464e-21,
      -1.441816408447919e-21, -1.0542057966871348e-21, -7.085794495861483e-22,
      -4.031283562745789e-22, -1.3582228811867273e-22, 9.553509779294953e-23,
      2.93256931492367e-22, 4.597293514151455e-22, 5.97373012598898e-22,
      7.086095944589715e-22, 7.958330020147804e-22, 8.613849419144e-22,
      9.075345476094812e-22, 9.364617258731295e-22, 9.502438988761822e-22,
      9.508458216308174e-22, 9.401121632067398e-22, 9.197625512007496e-22,
      8.913887920158861e-22, 8.56453994145902e-22, 8.162933374715481e-22,
      7.7211624820542145e-22, 7.250097562600243e-22, 6.759428291850852e-22,
      6.257714941867601e-22, 5.752445768982382e-22, 5.250099023449754e-22,
      4.756208197936296e-22, 4.275429287737046e-22, 3.8116089842108394e-22,
      3.367852863411608e-22, 2.9465927637393116e-22, 2.549652669295956e-22,
      2.1783125293175277e-22, 1.8333695485057788e-22, 1.515196578365764e-22,
      1.2237973259269525e-22, 9.588581737326629e-23, 7.197964740388672e-23,
      5.0580524113923864e-23, 3.158942190424626e-23, 1.4892734781665376e-23,
      3.6566912533095893e-25, -1.2124707842735989e-23, -2.2716751581728007e-23,
      -3.155184124943128e-23, -3.877228199219448e-23, -4.4519491000898667e-23,
      -4.893244892827144e-23, -5.214639770877145e-23, -5.429176557033668e-23,
      -5.549330003806629e-23, -5.586938996635394e-23, -5.553155806360638e-23,
      -5.458410596054603e-23, -5.312389458989235e-23, -5.124024346520712e-23,
      -4.901493334567233e-23, -4.6522297729810755e-23, -4.3829389615298206e-23,
      -4.099621097696628e-23, -3.807599343592074e-23, -3.5115519606499396e-23,
      -3.2155475603555536e-23, -2.923082616103067e-23, -2.637120474634676e-23,
      -2.3601311947661987e-23, -2.0941316257702664e-23, -1.8407252175129123e-23,
      -1.6011411289726655e-23, -1.3762722709607348e-23, -1.16671198263864e-23,
      -9.727890998013597e-24, -7.946012259285923e-24, -6.320460648263647e-24,
      -4.848507164528356e-24, -3.5259887544884976e-24, -2.3475590520754294e-24,
      -1.3069178927197767e-24, -3.970198671524908e-25, 3.8973760785967103e-25,
      1.061346049398562e-24, 1.6260367034717162e-24, 2.0921494663738124e-24,
      2.4680189366418254e-24, 2.7618765391050723e-24, 2.981767621072485e-24,
      3.1354823980808156e-24, 3.2304996204697704e-24, 3.2739418401133855e-24,
      3.2725411768278854e-24, 3.232614514352014e-24, 3.160047094565991e-24,
      3.0602835241417137e-24, 2.9383252586116367e-24, 2.79873368356569e-24,
      2.6456379701353966e-24, 2.4827469410389913e-24, 2.3133642433073876e-24,
      2.1404061835774624e-24, 1.966421640830237e-24, 1.7936135290780795e-24,
      1.6238613382768937e-24, 1.4587443352570397e-24, 1.2995650574138664e-24,
      1.1473727800335943e-24, 1.0029866832783843e-24, 8.670184869012077e-25,
      7.3989435964477e-25, 6.218759459835801e-25, 5.130803854184027e-25,
      4.134992289858801e-25, 3.230161840895927e-25, 2.414236423022665e-25,
      1.684379655610965e-25, 1.037135243227863e-25, 4.6855496916388e-26,
      -2.5685473076059333e-27, -4.501824721759475e-26, -8.097118847634402e-26,
      -1.1091473096499913e-25, -1.3533886877832419e-25, -1.5473006220263182e-25,
      -1.6956597809928568e-25, -1.8031107330024708e-25, -1.8741295483470605e-25,
      -1.9129945091213278e-25, -1.9237632746028427e-25, -1.910255865387232e-25,
      -1.8760428501008333e-25, -1.8244381435243376e-25, -1.7584958534531685e-25,
      -1.6810106447674076e-25, -1.5945211222444295e-25, -1.5013157679610345e-25,
      -1.4034410041166793e-25, -1.3027109872571317e-25, -1.200718774749741e-25,
      -1.0988485385836463e-25, -9.982885348270018e-26, -9.000445691104727e-26,
      -8.049537291144168e-26, -7.13698184054896e-26, -6.268188784710544e-26,
      -5.44728973130651e-26, -4.677269095416518e-26, -3.960089963646581e-26,
      -3.2968143596743793e-26, -2.6877172747432034e-26, -2.1323939898319307e-26,
      -1.6298603620991896e-26, -1.1786458774501734e-26, -7.768793845101824e-27,
      -4.2236752378960005e-27, -1.126659503234252e-27, 1.5485648046784123e-27,
      3.8296033453451424e-27, 5.7448475105434085e-27, 7.323028085946241e-27,
      8.592827606218062e-27, 9.58254774416335e-27, 1.0319827937447806e-26,
      1.0831411383531948e-26, 1.1142954516601384e-26, 1.127887611177474e-26,
      1.1262242234553242e-26, 1.1114683360698572e-26, 1.0856340127366562e-26,
      1.0505834334785703e-26, 1.0080261993970173e-26, 9.595205405319874e-27,
      9.064761451394941e-27, 8.501583491036603e-27, 7.916934448162206e-27,
      7.320748894230951e-27, 6.721702126193414e-27, 6.1272844397030726e-27,
      5.543878988820934e-27, 4.976841807034633e-27, 4.4305827390732505e-27,
      3.908646197916665e-27, 3.413790815990873e-27, 2.9480672034296984e-27,
      2.512893159269999e-27, 2.1091258034900016e-27, 1.7371302089922478e-27,
      1.3968442131826982e-27, 1.087839179011119e-27, 8.093765555997857e-28,
      5.604601593462552e-28, 3.398841581393722e-28, 1.46276794610334e-28,
      -2.1860070287847093e-29, -1.6611547404411068e-28, -2.881377790887432e-28,
      -3.8960683331830016e-28, -4.722096694394102e-28, -5.37619533477293e-28,
      -5.874780228579017e-28, -6.233801085301345e-28, -6.4686181315564745e-28,
      -6.593903179950718e-28, -6.623562743266238e-28, -6.570681006421389e-28,
      -6.4474805410309275e-28, -6.265298734626545e-28, -6.0345780055726725e-28,
      -5.764867982606004e-28, -5.46483794221006e-28, -5.14229791545831e-28,
      -4.80422699653814e-28, -4.456807506173474e-28, -4.1054637831044495e-28,
      -3.7549044943885234e-28, -3.4091674694952047e-28, -3.0716661731023524e-28,
      -2.745237036464982e-28, -2.4321869666744737e-28, -2.1343404466552705e-28,
      -1.8530857260822675e-28, -1.5894196843819063e-28, -1.3439910215382363e-28,
      -1.117141500581979e-28, -9.089450274887748e-29, -7.192444099068715e-29,
      -5.476856858801263e-29, -3.9374995777646803e-29, -2.567827052547733e-29,
      -1.360205846091329e-29, -3.0615750541159683e-30, 6.034223933782793e-30,
      1.378068568424886e-29, 2.0275727560432212e-29, 2.561831738269925e-29,
      2.990715479188251e-29, 3.3239541050887356e-29, 3.571042418277537e-29,
      3.7411606109532065e-29, 3.843109841247622e-29, 3.885261345640332e-29,
      3.875517788054813e-29, 3.821285583756234e-29, 3.7294569836004837e-29,
      3.606400759320662e-29, 3.4579603916449156e-29, 3.289458728556373e-29,
      3.1057081495372935e-29, 2.911025341950943e-29, 2.7092498667241183e-29,
      2.5037657612623025e-29, 2.2975254972546332e-29, 2.093075679028693e-29,
      1.8925839338330578e-29, 1.697866508401875e-29, 1.5104161460305523e-29,
      1.33142987489217e-29, 1.1618363912560347e-29, 1.0023227705079263e-29,
      8.533602843523951e-30, 7.152291442906844e-30, 5.880420294492314e-30,
      4.717662911581471e-30, 3.6624475745421496e-30, 2.7121508804331654e-30,
      1.863276543587944e-30, 1.1116194036777267e-30, 4.524147789178536e-31,
      -1.1952654385514698e-31, -6.096972615412535e-31, -1.0237859230057529e-30,
      -1.3675821018511984e-30, -1.6468936967830848e-30, -1.8674756342280606e-30,
      -2.034969214853374e-30, -2.1548513262372485e-30, -2.232392736469245e-30,
      -2.2726246863298512e-30, -2.2803130094227537e-30, -2.2599390288287775e-30,
      -2.215686504240498e-30, -2.1514339339502904e-30, -2.0707515504363996e-30,
      -1.9769023856586672e-30, -1.8728468216748728e-30, -1.7612500830532855e-30,
      -1.644492169111602e-30, -1.5246797656683382e-30, -1.4036597172428344e-30,
      -1.2830336810531929e-30, -1.1641736233771444e-30, -1.04823785656321e-30,
      -9.361873509720603e-31, -8.288020902078152e-31, -7.266972700316624e-31,
      -6.303391712441754e-31, -5.400605645248548e-31, -4.560755307078449e-31,
      -3.784936032606158e-31, -3.0733316085155543e-31, -2.425340168976797e-31,
      -1.8396916994716208e-31, -1.3145569375924037e-31, -8.476475909346333e-32,
      -4.363079061670636e-32, -7.759772091345951e-33, 2.3163278763360438e-32,
      4.946763752521548e-32, 7.149096869937165e-32, 8.957415163431856e-32,
      1.0405679534335084e-31, 1.152733985135464e-31, 1.2355010949227875e-31,
      1.2920204029385666e-31, 1.3253108857026448e-31, 1.338242219501754e-31,
      1.3335218008547174e-31, 1.3136855107664835e-31, 1.2810918060614722e-31,
      1.2379187402652109e-31, 1.1861635376910544e-31, 1.1276443670528897e-31,
      1.0640039845895442e-31, 9.967149409315257e-32, 9.270860703973441e-32,
      8.562700057558592e-32, 7.852714854598577e-32, 7.149562437142091e-32,
      6.460602962988936e-32, 5.79199456668592e-32, 5.148789373750268e-32,
      4.5350291121428994e-32, 3.953839246241171e-32, 3.407520727043078e-32,
      2.897638607869518e-32, 2.4251069173967494e-32, 1.9902693115828695e-32,
      1.5929751432179854e-32, 1.2326506928069168e-32, 9.083653977557027e-33,
      6.188929989215542e-33, 3.627675950987993e-33, 1.3833465759043892e-33,
      -5.620289067648348e-34, -2.2274338331014734e-33, -3.632497218793551e-33,
      -4.797170779805166e-33, -5.741447512420069e-33, -6.485119323613358e-33,
      -7.047571093151791e-33, -7.447608485646388e-33, -7.703316808212786e-33,
      -7.831948221996905e-33, -7.849834658505444e-33, -7.772323859711334e-33,
      -7.613736049917142e-33, -7.387338853353353e-33, -7.105338190823442e-33,
      -6.778883018097272e-33, -6.41808190525494e-33, -6.0320295971805256e-33,
      -5.628841838599093e-33, -5.2156968904377776e-33, -4.7988823061490925e-33,
      -4.383845675498004e-33, -3.975248177961528e-33, -3.5770199173195854e-33,
      -3.1924161324302336e-33, -2.8240734959659716e-33, -2.4740658225903464e-33,
      -2.143958610372412e-33, -1.8348619339974207e-33, -1.5474812954760477e-33,
      -1.282166117620431e-33, -1.0389556376666022e-33, -8.176220232735461e-34,
      -6.177105909719342e-34, -4.385770582706646e-34, -2.7942180539406788e-34,
      -1.3932116138234428e-34, -1.7255762427536725e-35, 8.786394176542152e-35,
      1.7717493470489997e-34, 2.5184151535550707e-34, 3.130376836605153e-34,
      3.6193188606512107e-34, 3.996739699671385e-34, 4.273841911097174e-34,
      4.461441155545111e-34, 4.569892577052327e-34, 4.609032975825558e-34,
      4.58813723894472e-34, 4.5158875413545686e-34, 4.400353887385157e-34,
      4.248984629730919e-34, 4.068605676266492e-34, 3.8654271734659055e-34,
      3.6450565368990642e-34, 3.4125167828722847e-34, 3.1722691995041e-34,
      2.9282394792981988e-34, 2.683846517664793e-34, 2.442033162069064e-34,
      2.2052982739050977e-34, 1.97572953928425e-34, 1.7550365352792658e-34,
      1.5445836244724424e-34, 1.3454223127014584e-34, 1.1583227625447926e-34,
      9.83804208275552e-35, 8.221640667355061e-35, 6.735055828908178e-35,
      5.377638888231413e-35, 4.1473039071779543e-35, 3.0407543019878447e-35,
      2.0536919431718536e-35, 1.181008728323337e-35, 4.169608235554552e-36,
      -2.44674053158024e-36, -8.10455785245754e-36, -1.2871568046931118e-35,
      -1.6816520937913145e-35, -2.0008234279186085e-35, -2.251476991585322e-35,
      -2.440273463652814e-35, -2.57366964711549e-35, -2.657870712137883e-35,
      -2.6987921263024094e-35, -2.7020303615050415e-35
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.09563747117762104, -0.0027358270676491048, 0.008381914360248825, 0.017838461450059604,
      0.025755311871363627, 0.03225511185269387, 0.03746004358375622, 0.04149044467431021,
      0.04446364340178441, 0.046492993211952965, 0.04768708990253073, 0.048149155085986335,
      0.04797656986502923, 0.04726054313412292, 0.04608589951728001, 0.04453097264280275,
      0.04266759021823927, 0.04056113818446284, 0.03827069207934803, 0.03584920461388908,
      0.03334373934353625, 0.030795741193542264, 0.028241335459396825, 0.025711647743708953,
      0.023233138102323112, 0.02082794344947882, 0.01851422301008362, 0.016306502303376776,
      0.014216011794085992, 0.0122510169531449, 0.010417137029417597, 0.008717650346595067,
      0.007153784405975238, 0.005724989497180487, 0.004429194896369107,
      0.0032630470668530247, 0.0022221295721963656, 0.0013011646689928317,
      0.0004941967679060997, -0.00020524186039186647, -0.0008039826005762877,
      -0.001309088566735916, -0.0017277384697253523, -0.0020671254330424625,
      -0.0023343698542763, -0.0025364453698376293, -0.0026801169580268026,
      -0.002771890207437556, -0.0028179707822841384, -0.0028242331316421965,
      -0.0027961975141093686, -0.002739014441449251, -0.0026574556829432714,
      -0.002555911015130044, -0.0024383899481791303, -0.0023085277092672655,
      -0.0021695948140599934, -0.002024509608923233, -0.0018758532180774006,
      -0.0017258863809415886, -0.0015765677148707681, -0.0014295729869256248,
      -0.0012863150248726897, -0.0011479639420049245, -0.0010154673923788516,
      -0.0008895706125219337, -0.0007708360424643516, -0.0006596623530305014,
      -0.0005563027376661809, -0.00046088235569178464, -0.0003734148398043112,
      -0.00029381780397156606, -0.00022192730866162655, -0.00015751125873749848,
      -0.00010028172544235988, -4.990619783634134e-05, -6.017780960003446e-06,
      3.1775631964444256e-05, 6.388317768043238e-05, 9.072378906428542e-05,
      0.00011271986171337355, 0.0001302917693892899, 0.00014385317395086136,
      0.00015380707364906205, 0.0001605425328049612, 0.00016443203583466518,
      0.00016582940921095984, 0.0001650682561566732, 0.00016246085055396855,
      0.00015829743863887493, 0.00015284589945106788, 0.00014635171765248079,
      0.00013903822514935393, 0.00013110707089250046, 0.00012273888123835914,
      0.00011409407628371896, 0.00010531381060082282, 9.652100976353927e-05,
      8.782147694136567e-05, 7.930504662298794e-05, 7.104676519622366e-05,
      6.31080806417227e-05, 5.5538025982753366e-05, 4.837438336499708e-05,
      4.164481771365351e-05, 3.5367970828014024e-05, 2.955450852591484e-05,
      2.4208115043962498e-05, 1.9326430337584358e-05, 1.4901927212602218e-05,
      1.0922726363067169e-05, 7.373348395320884e-06, 4.2354027931301005e-06,
      1.4882145312382931e-06, -8.906103169178946e-07, -2.9246780987941193e-06,
      -4.63835791538966e-06, -6.056386105624441e-06, -7.203521954255419e-06,
      -8.104251500439177e-06, -8.782536193648613e-06, -9.261603070068415e-06,
      -9.563773098714735e-06, -9.710324365648477e-06, -9.721386820510684e-06,
      -9.61586539638056e-06, -9.41138842627169e-06, -9.12427841252242e-06,
      -8.769542354431184e-06, -8.360879000703031e-06, -7.91070056299915e-06,
      -7.430166601912939e-06, -6.9292279742174585e-06, -6.4166789077895894e-06,
      -5.900215446109534e-06, -5.386498675874138e-06, -4.8812213175594535e-06,
      -4.389176418504891e-06, -3.9143270402998045e-06, -3.4598759761900706e-06,
      -3.0283346693462346e-06, -2.6215906287853413e-06, -2.2409727563141858e-06,
      -1.8873141050001867e-06, -1.5610116874355173e-06, -1.2620830406015698e-06,
      -9.902193337116356e-07, -7.448348763287389e-07, -5.251129466992003e-07,
      -3.3004791503220364e-07, -1.584836838465254e-07, -9.14850797642436e-09,
      1.1931370912715117e-07, 2.2831551804629804e-07, 3.1930127755212644e-07,
      3.937255950639667e-07, 4.5303467490031417e-07, 4.9865038648358e-07,
      5.319568588672389e-07, 5.542894052656296e-07, 5.669255812790113e-07,
      5.710781828399264e-07, 5.678899942077448e-07, 5.584301022791752e-07,
      5.436916007627804e-07, 5.245905161108332e-07, 5.019657962637936e-07,
      4.7658021301813675e-07, 4.491220389784022e-07, 4.20207370423602e-07,
      3.9038297785304024e-07, 3.6012957634446875e-07, 3.2986541804506165e-07,
      2.999501190277349e-07, 2.7068864230328247e-07, 2.423353679193027e-07,
      2.1509818975044574e-07, 1.8914258675409048e-07, 1.6459562410530685e-07,
      1.4154984671891007e-07, 1.200670342073151e-07, 1.0018179231105702e-07,
      8.190496128105838e-08, 6.522682660030739e-08, 5.0120121824452204e-08,
      3.6542817216551315e-08, 2.4440691274452278e-08, 1.3749685225880813e-08,
      4.398043123837591e-09, -3.6917576580596746e-09, -1.060127892486679e-08,
      -1.641458907489754e-08, -2.1216916179027968e-08, -2.5093476576925246e-08,
      -2.812846819131733e-08, -3.04042173295864e-08, -3.200046750369651e-08,
      -3.2993798730378093e-08, -3.34571658506372e-08, -3.3459544609576204e-08,
      -3.306567454428701e-08, -3.233588812084449e-08, -3.132601602438227e-08,
      -3.008735902360582e-08, -2.8666717389121967e-08, -2.7106469431324673e-08,
      -2.5444691327354902e-08, -2.3715311018256697e-08, -2.1948289568545096e-08,
      -2.016982398382556e-08, -1.8402566071796597e-08, -1.6665852502878734e-08,
      -1.4975941774727282e-08, -1.3346254306736103e-08, -1.1787612383825749e-08,
      -1.030847713152362e-08, -8.915180135392124e-09, -7.612147716591813e-09,
      -6.402116241602628e-09, -5.286337178099467e-09, -4.264770911269611e-09,
      -3.336268606343172e-09, -2.498741644899884e-09, -1.7493183759266737e-09,
      -1.0844881090928276e-09, -5.002324388584735e-10, 7.855874508527372e-12,
      4.444661254605932e-10, 8.14474548489905e-10, 1.1228603548234356e-09,
      1.374632347261054e-09, 1.5747654952946068e-09, 1.7281468215975477e-09,
      1.8395299319668728e-09, 1.9134975123651033e-09, 1.9544311174640163e-09,
      1.9664875837339705e-09, 1.953581415442467e-09, 1.91937251280357e-09,
      1.8672586369280052e-09, 1.8003720352250886e-09, 1.7215796826540375e-09,
      1.6334866279524577e-09, 1.5384419690059576e-09, 1.4385470172669203e-09,
      1.335665247060038e-09, 1.2314336612760793e-09, 1.127275239968852e-09,
      1.0244121724105178e-09, 9.238796059612715e-10, 8.265396764569211e-10,
      7.330956145453509e-10, 6.441057503861017e-10, 5.599972652802745e-10,
      4.810795630683672e-10, 4.0755715649879195e-10, 3.3954198423274025e-10,
      2.770650927368959e-10, 2.2008763406804003e-10, 1.685111455322032e-10,
      1.221870904776854e-10, 8.092565113801134e-11, 4.450377456737879e-11,
      1.2672481402565809e-11, -1.483654545962883e-11, -3.830506906081077e-11,
      -5.8023075261550595e-11, -7.428418615922375e-11, -8.738167488263e-11,
      -9.76050444269801e-11, -1.0523713176442323e-10, -1.1055169769625334e-10,
      -1.138114627197344e-10, -1.1526654948650581e-10, -1.1515329315731546e-10,
      -1.1369338204122792e-10, -1.110932922836885e-10, -1.0754398197946259e-10,
      -1.0322081188136988e-10, -9.828366180690932e-11, -9.287721387032524e-11,
      -8.713137575018541e-11, -8.116181930946916e-11, -7.507061198813754e-11,
      -6.894692046285143e-11, -6.286776809433841e-11, -5.6898829642783037e-11,
      -5.109524861160022e-11, -4.5502464369030796e-11, -4.01570378867712e-11,
      -3.508746651927583e-11, -3.031497972250259e-11, -2.5854308974610595e-11,
      -2.1714426412978326e-11, -1.7899247842796017e-11, -1.4408296804490057e-11,
      -1.1237327313445556e-11, -8.378903709810874e-12, -5.822936783156003e-12,
      -3.5571759714878688e-12, -1.5676579820510978e-12, 1.6088735182491211e-13,
      1.6446727719630137e-12, 2.900529326469733e-12, 3.945620343618971e-12,
      4.797191659922178e-12, 5.4723559642250036e-12, 5.9879090163939e-12,
      6.360175436911835e-12, 6.604881737461708e-12, 6.737054267591362e-12,
      6.770939784374531e-12, 6.719946406465012e-12, 6.596602787258232e-12,
      6.4125334305113856e-12, 6.178448172529354e-12, 5.904143965003659e-12,
      5.59851720919852e-12, 5.269585013100839e-12, 4.924513866352411e-12,
      4.569654351484919e-12, 4.210580632647222e-12, 3.8521335833437625e-12,
      3.498466531597532e-12, 3.1530927135102604e-12, 2.8189336336937002e-12,
      2.4983676329275562e-12, 2.193278059245819e-12, 1.9051005281778675e-12,
      1.6348688409025263e-12, 1.3832592055420651e-12, 1.1506324767461526e-12,
      9.370741921853264e-13, 7.424322417452918e-13, 5.663520562956524e-13,
      4.083092481506187e-13, 2.6763967502975e-13, 1.4356693377447178e-13,
      3.522731960995533e-14, -5.83076882971166e-14, -1.3801133349922798e-13,
      -2.0488378280375904e-13, -2.599365090147806e-13, -3.0417873407988307e-13,
      -3.3860580357371934e-13, -3.641893587309061e-13, -3.8186916976796014e-13,
      -3.9254649372074427e-13, -3.970788212011915e-13, -3.962758790934214e-13,
      -3.9089676003162326e-13, -3.816480543155971e-13, -3.6918286552839267e-13,
      -3.541005973460032e-13, -3.369474057112089e-13, -3.1821721753920266e-13,
      -2.9835322430476033e-13, -2.777497661182418e-13, -2.5675452913415664e-13,
      -2.356709862687351e-13, -2.147610181620902e-13, -1.9424765804817568e-13,
      -1.7431791064476464e-13, -1.551256013089264e-13, -1.3679421749275658e-13,
      -1.1941970995924356e-13, -1.0307322626610121e-13, -8.780375368942563e-14,
      -7.364065303789505e-14, -6.059606870541058e-14, -4.866720383308426e-14,
      -3.7838452611201743e-14, -2.808338456187414e-14, -1.9366578119418548e-14,
      -1.1645302985661175e-14, -4.8710526002009186e-15, 1.0090703490652554e-15,
      6.051111121930202e-15, 1.03131574841257e-14, 1.3854365409076837e-14,
      1.673410902635164e-14, 1.901124741881412e-14, 2.0743500527259653e-14,
      2.1986926217904206e-14, 2.279549048727559e-14, 2.3220722804549475e-14,
      2.3311448707945885e-14, 2.31135919652781e-14, 2.2670038866030935e-14,
      2.2020557521430086e-14, 2.120176539891363e-14, 2.024713869834845e-14,
      1.91870575803883e-14, 1.804888167466865e-14, 1.685705072013786e-14,
      1.5633205615683504e-14, 1.4396325581111558e-14, 1.3162877542039269e-14,
      1.194697425365603e-14, 1.0760538064542782e-14, 9.613467590378467e-15,
      8.513804916512575e-15, 7.467901276652225e-15, 6.480579461350214e-15,
      5.555291494028048e-15, 4.6942703737102025e-15, 3.8986749225649156e-15,
      3.168726993080311e-15, 2.503840484804927e-15, 1.9027417947797444e-15,
      1.3635814799599887e-15, 8.840370450588287e-16, 4.614068864173244e-16,
      9.269552285265704e-17, -2.2530967086373186e-16, -4.959699419986807e-16,
      -7.227345064259051e-16, -9.0908737594585e-16, -1.0585012445033785e-15,
      -1.1743979871938355e-15, -1.2601153103785411e-15, -1.31887908331164e-15,
      -1.3537808804303034e-15, -1.367760267957336e-15, -1.3635913778486297e-15,
      -1.3438733255900887e-15, -1.3110240451757419e-15, -1.2672771341102965e-15,
      -1.2146813228673487e-15, -1.1551022063516561e-15, -1.0902258990719374e-15,
      -1.0215643004974618e-15, -9.504616820686865e-16, -8.781023322312309e-16,
      -8.055190203827141e-16, -7.336020645264937e-16, -6.631088105187856e-16,
      -5.946733529168673e-16, -5.288163484607719e-16, -4.659547930543476e-16,
      -4.06411651686469e-16, -3.504252480065796e-16, -2.9815833621908553e-16,
      -2.497067925855639e-16, -2.0510787713553042e-16, -1.6434802821254656e-16,
      -1.2737016326107674e-16, -9.408046883845158e-17, -6.435467127076131e-17,
      -3.8043786722487555e-17, -1.4979355782428778e-17, 5.021826948890524e-18,
      2.2153473282815338e-17, 3.661603319723394e-17, 4.861337628979624e-17,
      5.834989901533933e-17, 6.602803211493638e-17, 7.184612150435588e-17,
      7.599665522651608e-17, 7.86648088266561e-17, 8.00272816246937e-17,
      8.02513967844259e-17, 7.949443876534516e-17, 7.790320264511306e-17,
      7.561373087811023e-17, 7.275121427061387e-17, 6.9430035272312e-17,
      6.575393307682107e-17, 6.181627146377939e-17, 5.770039177831024e-17,
      5.348003490959469e-17, 4.9219817581237004e-17, 4.497574968698443e-17,
      4.0795780783588794e-17, 3.6720365177855086e-17, 3.278303630897193e-17,
      2.9010982323703575e-17, 2.542561586627767e-17, 2.2043132153672797e-17,
      1.8875050378675383e-17, 1.5928734376886296e-17, 1.3207889310175901e-17,
      1.0713031859140565e-17, 8.441932082861846e-18, 6.390025698274033e-18,
      4.550796056757583e-18, 2.9161255556305913e-18, 1.476616620732543e-18,
      2.218827372138469e-19, -8.591897069798983e-19, -1.778207762485923e-18,
      -2.5470652496610688e-18, -3.177761732922805e-18, -3.682245677500699e-18,
      -4.072280246900692e-18, -4.359330148089786e-18, -4.554467906170078e-18,
      -4.668297947766333e-18, -4.7108968893420836e-18, -4.691768460239951e-18,
      -4.619811537684162e-18, -4.503299829778335e-18, -4.349871810388743e-18,
      -4.166529584646246e-18, -3.959645443761957e-18, -3.734974951267001e-18,
      -3.497675488183307e-18, -3.2523292707213333e-18, -3.0029699397661174e-18,
      -2.753111905700827e-18, -2.5057817142233247e-18, -2.2635507780711186e-18,
      -2.0285688954454748e-18, -1.802598047994164e-18, -1.587046039156336e-18,
      -1.3829995972679455e-18, -1.1912566269304972e-18, -1.0123573466912258e-18,
      -8.466141010642621e-19, -6.94139680389687e-19, -5.54874023076839e-19,
      -4.286092115448192e-19, -3.1501270582349926e-19, -2.1364878750447308e-19,
      -1.2399821174473251e-19, -4.547608655206365e-20, 2.2551983144537005e-20,
      8.07554338730753e-20, 1.2982589918478594e-19, 1.70465907181109e-19,
      2.0337903709793053e-19, 2.292614464268351e-19, 2.487946762729208e-19,
      2.626396404917966e-19, 2.7143170341217273e-19, 2.757767514440741e-19,
      2.7624816541752255e-19, 2.733846029265782e-19, 2.676885031157779e-19,
      2.5962523009998194e-19, 2.496227754268721e-19, 2.3807194455869366e-19,
      2.2532695716320606e-19, 2.117063959716844e-19, 1.9749444400370225e-19,
      1.8294235500427102e-19, 1.6827010692844952e-19, 1.5366819319064136e-19,
      1.392995111277932e-19, 1.253013116726923e-19, 1.1178717856772612e-19,
      9.884900954942918e-20, 8.655897578429028e-20, 7.497143942617177e-20,
      6.41248124893881e-20, 5.4043343287074307e-20, 4.473881947346082e-20,
      3.621217925551255e-20, 2.845502461102048e-20, 2.1451032375629188e-20,
      1.517726085107399e-20, 9.605351153010339e-21, 4.702623872141552e-21,
      4.330727804662934e-22, -3.2417417106216172e-21, -6.361895827737598e-21,
      -8.968398284652866e-21, -1.1102574029051266e-20, -1.280553082940761e-20,
      -1.4117703374845985e-20, -1.5078469392103318e-20, -1.5725832203727624e-20,
      -1.6096164148860976e-20, -1.62240053515784e-20, -1.6141912441693852e-20,
      -1.5880351999871272e-20, -1.546763370421559e-20, -1.492987839143952e-20,
      -1.4291016505118217e-20, -1.3572812680085074e-20, -1.279491250000951e-20,
      -1.1974907759616097e-20, -1.1128416859466213e-20, -1.0269177255933747e-20,
      -9.409147178724059e-21, -8.558614110283711e-21, -7.726307793475257e-21,
      -6.919515794128769e-21, -6.144199892106827e-21, -5.405111807265861e-21,
      -4.705906984416001e-21, -4.049255363609159e-21, -3.436948248604495e-21,
      -2.8700005571717003e-21, -2.3487478921814143e-21, -1.8729380125420464e-21,
      -1.441816408447919e-21, -1.0542057966871348e-21, -7.085794495861483e-22,
      -4.031283562745789e-22, -1.3582228811867273e-22, 9.553509779294953e-23,
      2.93256931492367e-22, 4.597293514151455e-22, 5.97373012598898e-22,
      7.086095944589715e-22, 7.958330020147804e-22, 8.613849419144e-22,
      9.075345476094812e-22, 9.364617258731295e-22, 9.502438988761822e-22,
      9.508458216308174e-22, 9.401121632067398e-22, 9.197625512007496e-22,
      8.913887920158861e-22, 8.56453994145902e-22, 8.162933374715481e-22,
      7.7211624820542145e-22, 7.250097562600243e-22, 6.759428291850852e-22,
      6.257714941867601e-22, 5.752445768982382e-22, 5.250099023449754e-22,
      4.756208197936296e-22, 4.275429287737046e-22, 3.8116089842108394e-22,
      3.367852863411608e-22, 2.9465927637393116e-22, 2.549652669295956e-22,
      2.1783125293175277e-22, 1.8333695485057788e-22, 1.515196578365764e-22,
      1.2237973259269525e-22, 9.588581737326629e-23, 7.197964740388672e-23,
      5.0580524113923864e-23, 3.158942190424626e-23, 1.4892734781665376e-23,
      3.6566912533095893e-25, -1.2124707842735989e-23, -2.2716751581728007e-23,
      -3.155184124943128e-23, -3.877228199219448e-23, -4.4519491000898667e-23,
      -4.893244892827144e-23, -5.214639770877145e-23, -5.429176557033668e-23,
      -5.549330003806629e-23, -5.586938996635394e-23, -5.553155806360638e-23,
      -5.458410596054603e-23, -5.312389458989235e-23, -5.124024346520712e-23,
      -4.901493334567233e-23, -4.6522297729810755e-23, -4.3829389615298206e-23,
      -4.099621097696628e-23, -3.807599343592074e-23, -3.5115519606499396e-23,
      -3.2155475603555536e-23, -2.923082616103067e-23, -2.637120474634676e-23,
      -2.3601311947661987e-23, -2.0941316257702664e-23, -1.8407252175129123e-23,
      -1.6011411289726655e-23, -1.3762722709607348e-23, -1.16671198263864e-23,
      -9.727890998013597e-24, -7.946012259285923e-24, -6.320460648263647e-24,
      -4.848507164528356e-24, -3.5259887544884976e-24, -2.3475590520754294e-24,
      -1.3069178927197767e-24, -3.970198671524908e-25, 3.8973760785967103e-25,
      1.061346049398562e-24, 1.6260367034717162e-24, 2.0921494663738124e-24,
      2.4680189366418254e-24, 2.7618765391050723e-24, 2.981767621072485e-24,
      3.1354823980808156e-24, 3.2304996204697704e-24, 3.2739418401133855e-24,
      3.2725411768278854e-24, 3.232614514352014e-24, 3.160047094565991e-24,
      3.0602835241417137e-24, 2.9383252586116367e-24, 2.79873368356569e-24,
      2.6456379701353966e-24, 2.4827469410389913e-24, 2.3133642433073876e-24,
      2.1404061835774624e-24, 1.966421640830237e-24, 1.7936135290780795e-24,
      1.6238613382768937e-24, 1.4587443352570397e-24, 1.2995650574138664e-24,
      1.1473727800335943e-24, 1.0029866832783843e-24, 8.670184869012077e-25,
      7.3989435964477e-25, 6.218759459835801e-25, 5.130803854184027e-25,
      4.134992289858801e-25, 3.230161840895927e-25, 2.414236423022665e-25,
      1.684379655610965e-25, 1.037135243227863e-25, 4.6855496916388e-26,
      -2.5685473076059333e-27, -4.501824721759475e-26, -8.097118847634402e-26,
      -1.1091473096499913e-25, -1.3533886877832419e-25, -1.5473006220263182e-25,
      -1.6956597809928568e-25, -1.8031107330024708e-25, -1.8741295483470605e-25,
      -1.9129945091213278e-25, -1.9237632746028427e-25, -1.910255865387232e-25,
      -1.8760428501008333e-25, -1.8244381435243376e-25, -1.7584958534531685e-25,
      -1.6810106447674076e-25, -1.5945211222444295e-25, -1.5013157679610345e-25,
      -1.4034410041166793e-25, -1.3027109872571317e-25, -1.200718774749741e-25,
      -1.0988485385836463e-25, -9.982885348270018e-26, -9.000445691104727e-26,
      -8.049537291144168e-26, -7.13698184054896e-26, -6.268188784710544e-26,
      -5.44728973130651e-26, -4.677269095416518e-26, -3.960089963646581e-26,
      -3.2968143596743793e-26, -2.6877172747432034e-26, -2.1323939898319307e-26,
      -1.6298603620991896e-26, -1.1786458774501734e-26, -7.768793845101824e-27,
      -4.2236752378960005e-27, -1.126659503234252e-27, 1.5485648046784123e-27,
      3.8296033453451424e-27, 5.7448475105434085e-27, 7.323028085946241e-27,
      8.592827606218062e-27, 9.58254774416335e-27, 1.0319827937447806e-26,
      1.0831411383531948e-26, 1.1142954516601384e-26, 1.127887611177474e-26,
      1.1262242234553242e-26, 1.1114683360698572e-26, 1.0856340127366562e-26,
      1.0505834334785703e-26, 1.0080261993970173e-26, 9.595205405319874e-27,
      9.064761451394941e-27, 8.501583491036603e-27, 7.916934448162206e-27,
      7.320748894230951e-27, 6.721702126193414e-27, 6.1272844397030726e-27,
      5.543878988820934e-27, 4.976841807034633e-27, 4.4305827390732505e-27,
      3.908646197916665e-27, 3.413790815990873e-27, 2.9480672034296984e-27,
      2.512893159269999e-27, 2.1091258034900016e-27, 1.7371302089922478e-27,
      1.3968442131826982e-27, 1.087839179011119e-27, 8.093765555997857e-28,
      5.604601593462552e-28, 3.398841581393722e-28, 1.46276794610334e-28,
      -2.1860070287847093e-29, -1.6611547404411068e-28, -2.881377790887432e-28,
      -3.8960683331830016e-28, -4.722096694394102e-28, -5.37619533477293e-28,
      -5.874780228579017e-28, -6.233801085301345e-28, -6.4686181315564745e-28,
      -6.593903179950718e-28, -6.623562743266238e-28, -6.570681006421389e-28,
      -6.4474805410309275e-28, -6.265298734626545e-28, -6.0345780055726725e-28,
      -5.764867982606004e-28, -5.46483794221006e-28, -5.14229791545831e-28,
      -4.80422699653814e-28, -4.456807506173474e-28, -4.1054637831044495e-28,
      -3.7549044943885234e-28, -3.4091674694952047e-28, -3.0716661731023524e-28,
      -2.745237036464982e-28, -2.4321869666744737e-28, -2.1343404466552705e-28,
      -1.8530857260822675e-28, -1.5894196843819063e-28, -1.3439910215382363e-28,
      -1.117141500581979e-28, -9.089450274887748e-29, -7.192444099068715e-29,
      -5.476856858801263e-29, -3.9374995777646803e-29, -2.567827052547733e-29,
      -1.360205846091329e-29, -3.0615750541159683e-30, 6.034223933782793e-30,
      1.378068568424886e-29, 2.0275727560432212e-29, 2.561831738269925e-29,
      2.990715479188251e-29, 3.3239541050887356e-29, 3.571042418277537e-29,
      3.7411606109532065e-29, 3.843109841247622e-29, 3.885261345640332e-29,
      3.875517788054813e-29, 3.821285583756234e-29, 3.7294569836004837e-29,
      3.606400759320662e-29, 3.4579603916449156e-29, 3.289458728556373e-29,
      3.1057081495372935e-29, 2.911025341950943e-29, 2.7092498667241183e-29,
      2.5037657612623025e-29, 2.2975254972546332e-29, 2.093075679028693e-29,
      1.8925839338330578e-29, 1.697866508401875e-29, 1.5104161460305523e-29,
      1.33142987489217e-29, 1.1618363912560347e-29, 1.0023227705079263e-29,
      8.533602843523951e-30, 7.152291442906844e-30, 5.880420294492314e-30,
      4.717662911581471e-30, 3.6624475745421496e-30, 2.7121508804331654e-30,
      1.863276543587944e-30, 1.1116194036777267e-30, 4.524147789178536e-31,
      -1.1952654385514698e-31, -6.096972615412535e-31, -1.0237859230057529e-30,
      -1.3675821018511984e-30, -1.6468936967830848e-30, -1.8674756342280606e-30,
      -2.034969214853374e-30, -2.1548513262372485e-30, -2.232392736469245e-30,
      -2.2726246863298512e-30, -2.2803130094227537e-30, -2.2599390288287775e-30,
      -2.215686504240498e-30, -2.1514339339502904e-30, -2.0707515504363996e-30,
      -1.9769023856586672e-30, -1.8728468216748728e-30, -1.7612500830532855e-30,
      -1.644492169111602e-30, -1.5246797656683382e-30, -1.4036597172428344e-30,
      -1.2830336810531929e-30, -1.1641736233771444e-30, -1.04823785656321e-30,
      -9.361873509720603e-31, -8.288020902078152e-31, -7.266972700316624e-31,
      -6.303391712441754e-31, -5.400605645248548e-31, -4.560755307078449e-31,
      -3.784936032606158e-31, -3.0733316085155543e-31, -2.425340168976797e-31,
      -1.8396916994716208e-31, -1.3145569375924037e-31, -8.476475909346333e-32,
      -4.363079061670636e-32, -7.759772091345951e-33, 2.3163278763360438e-32,
      4.946763752521548e-32, 7.149096869937165e-32, 8.957415163431856e-32,
      1.0405679534335084e-31, 1.152733985135464e-31, 1.2355010949227875e-31,
      1.2920204029385666e-31, 1.3253108857026448e-31, 1.338242219501754e-31,
      1.3335218008547174e-31, 1.3136855107664835e-31, 1.2810918060614722e-31,
      1.2379187402652109e-31, 1.1861635376910544e-31, 1.1276443670528897e-31,
      1.0640039845895442e-31, 9.967149409315257e-32, 9.270860703973441e-32,
      8.562700057558592e-32, 7.852714854598577e-32, 7.149562437142091e-32,
      6.460602962988936e-32, 5.79199456668592e-32, 5.148789373750268e-32,
      4.5350291121428994e-32, 3.953839246241171e-32, 3.407520727043078e-32,
      2.897638607869518e-32, 2.4251069173967494e-32, 1.9902693115828695e-32,
      1.5929751432179854e-32, 1.2326506928069168e-32, 9.083653977557027e-33,
      6.188929989215542e-33, 3.627675950987993e-33, 1.3833465759043892e-33,
      -5.620289067648348e-34, -2.2274338331014734e-33, -3.632497218793551e-33,
      -4.797170779805166e-33, -5.741447512420069e-33, -6.485119323613358e-33,
      -7.047571093151791e-33, -7.447608485646388e-33, -7.703316808212786e-33,
      -7.831948221996905e-33, -7.849834658505444e-33, -7.772323859711334e-33,
      -7.613736049917142e-33, -7.387338853353353e-33, -7.105338190823442e-33,
      -6.778883018097272e-33, -6.41808190525494e-33, -6.0320295971805256e-33,
      -5.628841838599093e-33, -5.2156968904377776e-33, -4.7988823061490925e-33,
      -4.383845675498004e-33, -3.975248177961528e-33, -3.5770199173195854e-33,
      -3.1924161324302336e-33, -2.8240734959659716e-33, -2.4740658225903464e-33,
      -2.143958610372412e-33, -1.8348619339974207e-33, -1.5474812954760477e-33,
      -1.282166117620431e-33, -1.0389556376666022e-33, -8.176220232735461e-34,
      -6.177105909719342e-34, -4.385770582706646e-34, -2.7942180539406788e-34,
      -1.3932116138234428e-34, -1.7255762427536725e-35, 8.786394176542152e-35,
      1.7717493470489997e-34, 2.5184151535550707e-34, 3.130376836605153e-34,
      3.6193188606512107e-34, 3.996739699671385e-34, 4.273841911097174e-34,
      4.461441155545111e-34, 4.569892577052327e-34, 4.609032975825558e-34,
      4.58813723894472e-34, 4.5158875413545686e-34, 4.400353887385157e-34,
      4.248984629730919e-34, 4.068605676266492e-34, 3.8654271734659055e-34,
      3.6450565368990642e-34, 3.4125167828722847e-34, 3.1722691995041e-34,
      2.9282394792981988e-34, 2.683846517664793e-34, 2.442033162069064e-34,
      2.2052982739050977e-34, 1.97572953928425e-34, 1.7550365352792658e-34,
      1.5445836244724424e-34, 1.3454223127014584e-34, 1.1583227625447926e-34,
      9.83804208275552e-35, 8.221640667355061e-35, 6.735055828908178e-35,
      5.377638888231413e-35, 4.1473039071779543e-35, 3.0407543019878447e-35,
      2.0536919431718536e-35, 1.181008728323337e-35, 4.169608235554552e-36,
      -2.44674053158024e-36, -8.10455785245754e-36, -1.2871568046931118e-35,
      -1.6816520937913145e-35, -2.0008234279186085e-35, -2.251476991585322e-35,
      -2.440273463652814e-35, -2.57366964711549e-35, -2.657870712137883e-35,
      -2.6987921263024094e-35, -2.7020303615050415e-35
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_3_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<3>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.03259651132850662), "design.b()[0] == 0.03259651132850662");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.03259651132850662));
    static_assert(almost_equal(design.b()[1], -0.029879857854778355), "design.b()[1] == -0.029879857854778355");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.029879857854778355));
    static_assert(almost_equal(design.b()[2], -0.029879857854778348), "design.b()[2] == -0.029879857854778348");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - -0.029879857854778348));
    static_assert(almost_equal(design.b()[3], 0.032596511328506626), "design.b()[3] == 0.032596511328506626");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.032596511328506626));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.6479887087536835), "design.a()[1] == -2.6479887087536835");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.6479887087536835));
    static_assert(almost_equal(design.a()[2], 2.3545218721447396), "design.a()[2] == 2.3545218721447396");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.3545218721447396));
    static_assert(almost_equal(design.a()[3], -0.7010998564435997), "design.a()[3] == -0.7010998564435997");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.7010998564435997));
    std::cout << "max_deviation(cheby2,lowpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.03259651132850662, 0.0564353360878687, 0.042811076002034654, 0.03593493342374214,
      0.03392248916859422, 0.03523162081021325, 0.038615668056183786, 0.04308328349130908,
      0.0478634974675706, 0.05237490688215203, 0.056198194252100556, 0.05905141122973975,
      0.060767632327035484, 0.061274710860786785, 0.060576958995017846, 0.05873863479927685,
      0.05586915780242743, 0.05210999590878296, 0.04762317518100265, 0.04258136354459799,
      0.03715947293570425, 0.03152771422826969, 0.025846027373075217, 0.020259797061593976,
      0.01489675302221937, 0.009864944574092847, 0.00525167184138501, 0.0011232513762237523,
      -0.0024745080298145504, -0.005515242881820832, -0.007990506219478994,
      -0.00990788747544024, -0.0112888884919921, -0.012166654256889921, -0.0125836467156465,
      -0.012589338960450554, -0.012237995547518338, -0.011586592995258396,
      -0.010692922974418591, -0.009613909590380873, -0.008404161707525826,
      -0.007114771663021971, -0.0057923631053097835, -0.004478383170636049,
      -0.0032086278380343645, -0.0020129841002021467, -0.0009153685420439451,
      6.616101189803368e-05, 0.0009191460021064479, 0.0016363459322568177,
      0.0022152616625209214, 0.0026575887115241003, 0.002968624761895163,
      0.00315665373515496, 0.003232326580198522, 0.0032080564195599674,
      0.0030974430256066297, 0.0029147388522419316, 0.0026743661134057788,
      0.0023904917527733304, 0.0020766646524533567, 0.001745517132664378,
      0.0014085307376190872, 0.0010758645118027375, 0.0007562424612209784,
      0.000456895671830518, 0.00018355361927393913, -5.9521460326374066e-05,
      -0.00026946367623450855, -0.000444702775765132, -0.0005848402968249459,
      -0.0006905090349989074, -0.0007632219096325563, -0.0008052158213083501,
      -0.0008192955087151475, -0.0008086817644208104, -0.0007768676828669458,
      -0.0007274859140389881, -0.0006641892040239533, -0.0005905458373832071,
      -0.000509950971172894, -0.0004255542786535892, -0.0003402038113012242,
      -0.00025640554680854747, -0.00017629772178810472, -0.00010163875183879649,
      -3.3807317340385344e-05, 2.6186962234370792e-05, 7.768393410636152e-05,
      0.00012034609968526878, 0.00015412626660466937, 0.00017923128480519204,
      0.00019608338583974785, 0.0002052805148221381, 0.00020755689269940454,
      0.00020374487988138862, 0.00019473903728961506, 0.00018146310355366313,
      0.0001648404326426517, 0.00014576826916716214, 0.0001250960826295712,
      0.00010360803995552136, 8.200956985449941e-05, 6.091786435238883e-05,
      4.0856072958132174e-05, 2.225087350709577e-05, 5.433050369143122e-06,
      -9.359325429406194e-06, -2.1975539763660812e-05, -3.2345133897026993e-05,
      -4.0469482031693296e-05, -4.6412454024606874e-05, -5.02905423365727e-05,
      -5.226279816626158e-05, -5.2520882392499e-05, -5.127949417981051e-05,
      -4.8767395532964836e-05, -4.521920519340521e-05, -4.086809134901909e-05,
      -3.5939450778932976e-05, -3.06456231769387e-05, -2.5181654191308067e-05,
      -1.9722089692487438e-05, -1.4418757258490414e-05, -9.399469007919293e-06,
      -4.767562719159816e-06, -6.021855269403533e-07, 3.0407838510724126e-06,
      6.127282759681552e-06, 8.643191290673057e-06, 1.059214479227772e-05,
      1.1993133935616983e-05, 1.2877986830847956e-05, 1.3288818745888245e-05,
      1.3275524809932854e-05, 1.2893380125710758e-05, 1.220080037641146e-05,
      1.1257304661090339e-05, 1.012171124484345e-05, 8.850586436075609e-06,
      7.496957120891756e-06, 6.109288761807628e-06, 4.730723023885758e-06,
      3.39856269978749e-06, 2.1439862981068144e-06, 9.91970531525268e-07,
      -3.860404464024488e-08, -9.346909014991453e-07, -1.6886864886371832e-06,
      -2.2979378734171626e-06, -2.7641759263947405e-06, -3.0928995130733224e-06,
      -3.2927342239446433e-06, -3.3747868392354926e-06, -3.352014099919106e-06,
      -3.23862155307727e-06, -3.0495053589935853e-06, -2.7997470798292714e-06,
      -2.5041686937186383e-06, -2.1769524592644226e-06, -1.8313278464717882e-06,
      -1.4793255912028252e-06, -1.1315970491647277e-06, -7.972954387992232e-07,
      -4.840142763940031e-07, -1.9777731827428782e-07, 5.692637687681982e-08,
      2.770690851945295e-07, 4.6097976023149635e-07, 6.082150535275212e-07,
      7.194127620086416e-07, 7.961340679556589e-07, 8.407004260662989e-07,
      8.560303436747575e-07, 8.454806240603623e-07, 8.126959266072177e-07,
      7.614697665430555e-07, 6.956193534182496e-07, 6.188759706161085e-07,
      5.34791944009459e-07, 4.4666464912997136e-07, 3.5747747243386085e-07,
      2.6985717992052147e-07, 1.8604675914456226e-07, 1.0789248964205169e-07,
      3.684376078651264e-08, -2.6036008023603683e-08, -8.004908689205054e-08,
      -1.2483557248301517e-07, -1.6033970194099137e-07, -1.8677203780016487e-07,
      -2.045691139594167e-07, -2.1435199783178726e-07, -2.1688506566402451e-07,
      -2.1303611417251466e-07, -2.0373874894635053e-07, -1.8995780477143623e-07,
      -1.7265837064046366e-07, -1.527788174470943e-07, -1.3120806311039638e-07,
      -1.0876716120399334e-07, -8.619516733597118e-08, -6.413912403983259e-08,
      -4.314791058700625e-08, -2.3669629074097228e-08, -6.052141970890441e-09,
      9.45366183943146e-09, 2.268831690505398e-08, 3.3576397545439236e-08,
      4.2117744144338886e-08, 4.8377724248902553e-08, 5.247692527205197e-08,
      5.4580640095200675e-08, 5.488846587866219e-08, 5.36242917625363e-08,
      5.102690459767392e-08, 4.7341394932068716e-08, 4.2811499550304517e-08,
      3.7672973076812273e-08, 3.214804045278689e-08, 2.6440945218315672e-08,
      2.0734576010150668e-08, 1.5188125865360775e-08, 9.935715969851946e-09,
      5.08589741880795e-09, 7.219312363005277e-10, -3.097261909719828e-09,
      -6.3355955008319325e-09, -8.977868553105024e-09, -1.1027486257799083e-08,
      -1.2503956319180143e-08, -1.3440259912926244e-08, -1.3880186882568086e-08,
      -1.3875714188490529e-08, -1.3484495188070394e-08, -1.2767515483602556e-08,
      -1.1786959209878282e-08, -1.0604318079779657e-08, -9.278764546247968e-09,
      -7.86580030157974e-09, -6.4161821966882546e-09, -4.975119649493133e-09,
      -3.5817308010398012e-09, -2.268739104694144e-09, -1.0623876932046916e-09,
      1.7454277838916427e-11, 9.570211303756967e-10, 1.7482448091460554e-09,
      2.3882425228689234e-09, 2.8787259704443197e-09, 3.2253587939721034e-09,
      3.437086896731188e-09, 3.5254638322467014e-09, 3.5039907335260288e-09,
      3.3874873253568038e-09, 3.1915075533967716e-09, 2.931810366385869e-09,
      2.623893284321105e-09, 2.282593644745834e-09, 1.9217598968451383e-09,
      1.5539930509697763e-09, 1.1904564189675353e-09, 8.407501158172981e-10,
      5.128454422226549e-10, 2.1307322808182905e-10, -5.384052314015321e-11,
      -2.8469880731561056e-10, -4.777249282060269e-10, -6.324282300260072e-10,
      -7.494513128147171e-10, -8.304053925207516e-10, -8.776999362353936e-10,
      -8.943720692139683e-10, -8.839205451432683e-10, -8.501483234703291e-10,
      -7.970170338704575e-10, -7.285158515027467e-10, -6.485465777482463e-10,
      -5.608260364405144e-10, -4.688062685621617e-10, -3.756124490344004e-10,
      -2.83997964420518e-10, -1.963156839820061e-10, -1.1450412975936242e-10,
      -4.0087003013269963e-11, 2.5815648764992867e-11, 8.246644288584e-11,
      1.2948170789414508e-10, 1.667964046442885e-10, 1.9462469414804235e-10,
      2.1341781643523085e-10, 2.2382080428773083e-10, 2.2662939096352918e-10,
      2.2274828967190679e-10, 2.131518318061522e-10, 1.9884775732794925e-10,
      1.8084476000213126e-10, 1.6012420734731098e-10, 1.3761628428278584e-10,
      1.1418065373844233e-10, 9.05915893347466e-11, 6.752741621847495e-11,
      4.556399710147528e-11, 2.517192167215981e-11, 6.716998424528247e-12,
      -9.536392329306474e-12, -2.341954824520152e-11, -3.485176836553171e-11,
      -4.383121382601746e-11, -5.042475031538079e-11, -5.47571876387209e-11,
      -5.700029479660785e-11, -5.7361926271864834e-11, -5.6075548655710664e-11,
      -5.339040814117454e-11, -4.95625303857264e-11, -4.484669622004965e-11,
      -3.948949086680957e-11, -3.3723481724620066e-11, -2.77625411427386e-11,
      -2.179829652454108e-11, -1.5997660916062678e-11, -1.0501373139359015e-11,
      -5.423457533478033e-12, -8.514993385657937e-13, 3.1523775507234593e-12,
      6.5499486786648435e-12, 9.324862187553868e-12, 1.1480263806253145e-11,
      1.3036185035465759e-11, 1.4026798090372786e-11, 1.4497631474443526e-11,
      1.4502829004994923e-11, 1.4102523176864422e-11, 1.3360381382543003e-11,
      1.2341371106689415e-11, 1.1109778130451832e-11, 9.72750031257234e-12,
      8.252628900482488e-12, 6.738319751145611e-12, 5.2319484408252354e-12,
      3.774536097919998e-12, 2.4004269404180177e-12, 1.137193935445456e-12,
      5.745683415928189e-15, -9.793945057368066e-13, -1.8096674249903394e-12,
      -2.481944824939997e-12, -2.997913686116871e-12, -3.363405786749326e-12,
      -3.5876983619711485e-12, -3.682809118081055e-12, -3.662806011506345e-12,
      -3.5431491479089038e-12, -3.3400790135738936e-12, -3.0700621181141543e-12,
      -2.7493020907445336e-12, -2.393321404228572e-12, -2.0166162593072713e-12,
      -1.6323847923474907e-12, -1.2523267011437504e-12, -8.865106368629409e-13,
      -5.433042912648168e-13, -2.2936101469627067e-13, 5.03439796287629e-14,
      2.9243525471941527e-13, 4.950242768944738e-13, 6.575696492429674e-13,
      7.807178343266548e-13, 8.661313378853117e-13, 9.163107728083575e-13,
      9.344165624743162e-13, 9.240953070979881e-13, 8.893150562413246e-13,
      8.342129327524163e-13, 7.629577626234698e-13, 6.796296027552726e-13,
      5.881173420072524e-13, 4.920348942609475e-13, 3.946559160986398e-13,
      2.988664733294903e-13, 2.0713465410754951e-13, 1.2149578308471727e-13,
      4.3551629741268136e-14, -2.5518178584322893e-14, -8.493443747341424e-14,
      -1.34288280440375e-13, -1.7350465093676846e-13, -2.0280118504697114e-13,
      -2.226442467155911e-13, -2.337037113459536e-13, -2.368079219618898e-13,
      -2.329000529433534e-13, -2.229969171807053e-13, -2.0815105019478253e-13,
      -1.8941670539247758e-13, -1.6782020335784832e-13, -1.4433489920629097e-13,
      -1.1986086894221322e-13, -9.520927096789032e-14, -7.109121406626033e-14,
      -4.81108592227863e-14, -2.6762399761730093e-14, -7.430502036743081e-15,
      9.60625360193403e-15, 2.4169416006838137e-14, 3.6172682556890615e-14,
      4.561237937218886e-14, 5.255686739531795e-14, 5.713530910570022e-14,
      5.95261921992515e-14, 5.994596204358061e-14, 5.863806614001621e-14,
      5.5862663069075067e-14, 5.188719716401197e-14, 4.6977989939686094e-14,
      4.139295137156595e-14, 3.537546951446004e-14, 2.9149496486897506e-14,
      2.291581311835594e-14, 1.6849423947122504e-14, 1.1098008958200959e-14,
      5.781338481991792e-15, 9.915429029399558e-16, -3.205881007487414e-15,
      -6.770450581800266e-15, -9.68458915525051e-15, -1.195115146702261e-14,
      -1.3590699083466472e-14, -1.46386342571302e-14, -1.5142290552561632e-14,
      -1.5158067047496958e-14, -1.474868046413056e-14, -1.398059666789397e-14,
      -1.2921690011115951e-14, -1.1639166363394535e-14, -1.0197773670184015e-14,
      -8.65831276873119e-15, -7.076451161327121e-15, -5.5018336396037755e-15,
      -3.977476157804456e-15, -2.5394232071909854e-15, -1.2166441448067567e-15,
      -3.114043730099945e-17, 1.0017664771944964e-15, 1.8729981258853727e-15,
      2.5791642514041293e-15, 3.1219210952071366e-15, 3.507271885120962e-15,
      3.744836534958189e-15, 3.847114927299905e-15, 3.828765174769103e-15,
      3.7059150673396946e-15, 3.4955216298677216e-15, 3.2147904391188158e-15,
      2.880663173421375e-15, 2.5093788665710677e-15, 2.1161115719252593e-15,
      1.71468465942983e-15, 1.3173598003623142e-15, 9.346968615622662e-16,
      5.754794406593857e-16, 2.466996235311271e-16, -4.640527697834735e-17,
      -3.0027175568662446e-16, -5.128929083450094e-16, -6.836729467737087e-16,
      -8.132611575768468e-16, -9.033726003707235e-16, -9.56602267136114e-16,
      -9.762387367037501e-16, -9.660825913592606e-16, -9.302740478016431e-16,
      -8.731334211293682e-16, -7.990172138630907e-16, -7.121918244265682e-16,
      -6.167261194973492e-16, -5.164034269828126e-16, -4.1465289219850803e-16,
      -3.144996067567864e-16, -2.185324720946148e-16, -1.2888839890709376e-16,
      -4.7251168823445825e-17, 2.5136907958770382e-17, 8.745252095600253e-17,
      1.392601007776154e-16, 1.8047378363525134e-16, 2.1131453798210904e-16,
      2.322642763177169e-16, 2.4401862335363183e-16, 2.474398329018034e-16,
      2.4351114850642626e-16, 2.3329369489631855e-16, 2.1788677596529464e-16,
      1.9839224653627165e-16, 1.758834250719432e-16, 1.513788272640739e-16,
      1.2582082962612454e-16, 1.0005922047186428e-16, 7.483946475352765e-17,
      5.0795400114243893e-17, 2.844599440603976e-17, 8.195729418147149e-18,
      -9.661869316581878e-18, -2.493806243450011e-17, -3.7540600394540954e-17,
      -4.746380770446929e-17, -5.4777534146308225e-17, -5.961542808476778e-17,
      -6.216294695421431e-17, -6.264547362106722e-17, -6.131685663449635e-17,
      -5.84486393784564e-17, -5.432018960165506e-17, -4.920988829288413e-17,
      -4.3387486720000675e-17, -3.710769375607659e-17, -3.060501323209602e-17,
      -2.4089813607157267e-17, -1.7745580140822395e-17, -1.172727319271654e-17,
      -6.160695285050539e-18, -1.1427540092570954e-18, 3.2575025309862327e-18,
      6.997206650123319e-18, 1.0057478572728305e-17, 1.2440848154323796e-17,
      1.4168412739760325e-17, 1.527684465198469e-17, 1.5815351309532728e-17,
      1.5842678960039735e-17, 1.5424238021064655e-17, 1.4629414528846123e-17,
      1.3529118650864293e-17, 1.2193608004357633e-17, 1.0690610966234168e-17,
      9.08376352557655e-18, 7.431362723511161e-18, 5.785430493871125e-18,
      4.191073854451181e-18, 2.6861209451807927e-18, 1.3010073638237156e-18,
      5.888357045656411e-20, -1.0240882551878235e-18, -1.9382807150457e-18,
      -2.680023989195772e-18, -3.2509370533457217e-18, -3.657197840760339e-18,
      -3.908780625034017e-18, -4.018686154662375e-18, -4.0021869676554645e-18,
      -3.876106987315889e-18, -3.658151070701981e-18, -3.3662967582094212e-18,
      -3.0182571508423667e-18, -2.631020700729796e-18, -2.2204708045412666e-18,
      -1.8010854877740493e-18, -1.3857151949563634e-18, -9.854347775274705e-19,
      -6.094642059389074e-19, -2.6515132271086295e-19, 4.1990913463973904e-20,
      3.0820078618241057e-19, 5.313461233693513e-19, 7.107728664449216e-19,
      8.471319826304803e-19, 9.42192355474169e-19, 9.98646691701373e-19,
      1.0199167663389662e-18, 1.009963528143481e-18, 9.731067368544477e-19,
      9.138579329850939e-19, 8.367696766889823e-19, 7.463031579664632e-19,
      6.46715495516414e-19, 5.419673214237825e-19, 4.356506053090268e-19,
      3.3093611260642577e-19, 2.3053942193479034e-19, 1.3670404763326812e-19,
      5.1199924277119137e-20, -2.4664693165319043e-20, -9.001998239832712e-20,
      -1.4440207786488157e-19, -1.877134670572615e-19, -2.2017828726914617e-19,
      -2.422944307802067e-19, -2.547842085596923e-19, -2.585451362603486e-19,
      -2.5460220042678966e-19, -2.440627457376449e-19, -2.280749032559712e-19,
      -2.077902617263621e-19, -1.8433127463679337e-19, -1.5876369978615296e-19,
      -1.3207418920777417e-19, -1.0515298827678691e-19, -7.878156554167984e-20,
      -5.362488028670761e-20, -3.022790330325103e-20, -9.015937401784343e-21,
      9.701763167009888e-21, 2.57256024651333e-20, 3.8957018860370416e-20,
      4.9388157154348603e-20, 5.709034570580034e-20, 6.220185489344446e-20,
      6.491537165969234e-20, 6.546557652347798e-20, 6.411715657138904e-20,
      6.115353259292937e-20, 5.686652258202093e-20, 5.1547108922082033e-20,
      4.547742410431022e-20, 3.8924020947248267e-20, 3.2132448890558766e-20,
      2.5323118685644988e-20, 1.868840412994719e-20, 1.2390901608809658e-20,
      6.562746147175024e-21, 1.3058662952663744e-21, -3.3069508007066303e-21,
      -7.230318753316212e-21, -1.0443971756955226e-20, -1.2950078371339964e-20,
      -1.477027681096197e-20, -1.5942550548787513e-20, -1.6518052119961773e-20,
      -1.6557970491167967e-20, -1.613052379991244e-20, -1.530814517870164e-20,
      -1.4164915223474195e-20, -1.277428084747145e-20, -1.120708712301235e-20,
      -9.529936533177851e-21, -7.803879049162391e-21, -6.083426772237858e-21,
      -4.415878629918378e-21, -2.8409338394966064e-21, -1.3905675471250088e-21,
      -8.913817464357123e-23, 1.0463065173885682e-21, 2.0055589181171918e-21,
      2.78465102830935e-21, 3.385157491337752e-21, 3.8134341315517516e-21,
      4.079821604108801e-21, 4.1978409019034406e-21, 4.183404230249938e-21,
      4.0540612874949575e-21, 3.828297407433334e-21, 3.524896441486107e-21,
      3.162377784380734e-21, 2.7585136601043908e-21, 2.3299297526946287e-21,
      1.8917895406485728e-21, 1.4575603107923481e-21, 1.0388568094918087e-21,
      6.453568451857352e-22, 2.8478188384816514e-22, -3.7065234440432685e-23,
      -3.1621390508204807e-22, -5.503994071383145e-22, -7.389052901602313e-22,
      -8.823829461184914e-22, -9.8265635632417e-22, -1.042519382744692e-21,
      -1.0655322272494455e-21, -1.0558228481147517e-21, -1.0178982353000732e-21,
      -9.56469536299173e-22, -8.762941209986516e-22, -7.820368013381989e-22,
      -6.781516000422505e-22, -5.687847085967486e-22, -4.576986002983372e-22,
      -3.4821667810646487e-22, -2.4318734411766237e-22, -1.449659794517113e-22,
      -5.541301901943429e-23, 2.4093908604730628e-23, 9.263593583509978e-23,
      1.497192176412485e-22, 1.952336965910641e-22, 2.2940649284016905e-22,
      2.527519159473474e-22, 2.660199311931908e-22, 2.70144718975955e-22,
      2.661947511434894e-22, 2.553255814548589e-22, 2.3873631662400217e-22,
      2.1763050654900365e-22, 1.931819733600015e-22, 1.6650589378943246e-22,
      1.3863526201440557e-22, 1.1050269347121512e-22, 8.292738616799669e-23,
      5.660693580675049e-23, 3.2113604850378553e-23, 9.894573106718116e-24,
      -9.724352581277446e-24, -2.653212087997845e-23, -4.04234718797151e-23,
      -5.1388180378550795e-23, -5.949903885708018e-23, -6.489907873604814e-23,
      -6.77884852272865e-23, -6.841161070053266e-23, -6.704443632062177e-23,
      -6.398277392008617e-23, -5.953144161382756e-23, -5.39945892536396e-23,
      -4.7667294927601845e-23, -4.082850253929072e-23, -3.3735324000808207e-23,
      -2.661868843540662e-23, -1.968028546410054e-23, -1.3090720379061318e-23,
      -6.988775818709688e-24, -1.4816573149732325e-24, 3.353911505873603e-24,
      7.469884629626226e-24, 1.0844522426299295e-23, 1.3479593069106394e-23,
      1.539728004138351e-23, 1.6636920102558172e-23, 1.725168471670471e-23,
      1.730530489685072e-23, 1.6868925267141348e-23, 1.601815843072343e-23,
      1.483039593741868e-23, 1.3382417695163795e-23, 1.1748327921671483e-23,
      9.997832980607743e-24, 8.194864916897859e-24, 6.396544362152467e-24,
      4.652467827365349e-24, 3.0042972846828994e-24, 1.4856243626384496e-24,
      1.2207739637937697e-25, -1.0683630934116028e-24, -2.074876280697876e-24,
      -2.8931762474423923e-24, -3.524785662184846e-24, -3.976241342205104e-24,
      -4.258262692950202e-24, -4.38491104244337e-24, -4.372764515595282e-24,
      -4.240129469219697e-24, -4.0063057668150204e-24, -3.6909194324832184e-24,
      -3.313332589841753e-24, -2.89213715212395e-24, -2.4447355547777474e-24,
      -1.9870089661098623e-24, -1.5330709132864382e-24, -1.0951021437450525e-24,
      -6.832608155787919e-25, -3.0566077232913548e-25, 3.159030505250314e-26,
      3.243016852748879e-25, 5.700684130434541e-25, 7.681072681403938e-25,
      9.190686910083877e-25, 1.0248330359171336e-24, 1.0882988679101592e-24,
      1.1131702429399194e-24, 1.1037490406608337e-24, 1.0647374926044284e-24,
      1.001055098130993e-24, 9.176731762185771e-25, 8.194693883965827e-25,
      7.11103708348037e-25, 5.969165240346345e-25, 4.808488516082905e-25,
      3.6638402583109073e-25, 2.565097144705409e-25, 1.5369868601351952e-25,
      5.990643988899275e-26, -2.341641753936946e-26, -9.52993055450211e-26,
      -1.5521662136534413e-25, -2.0304480845564567e-25, -2.3901375967328195e-25,
      -2.636546452742636e-25, -2.7774608486229045e-25, -2.8226038022005413e-25,
      -2.7831130199286753e-25, -2.6710468655236564e-25, -2.498928582905654e-25,
      -2.2793365438552234e-25, -2.0245460001720175e-25, -1.7462256730599765e-25,
      -1.4551905503140037e-25, -1.1612105154802224e-25, -8.72872923325489e-26,
      -5.974959742032941e-26, -3.410887293473048e-26, -1.0835284545172482e-26,
      9.727942053322798e-27, 2.7357669251136844e-26, 4.194153050017708e-26,
      5.34667273466901e-26, 6.200749737875807e-26, 6.771177495994288e-26,
      7.078752159562917e-26, 7.148915027162974e-26, 7.010441054980118e-26,
      6.694204086280569e-26, 6.232043336503038e-26, 5.655749667028262e-26,
      4.996184437773427e-26, 4.2825383722541085e-26, 3.5417329981610055e-26,
      2.7979629148679407e-26, 2.072373434616561e-26, 1.382865071251568e-26,
      7.440139132960301e-27, 1.6709510258392e-27, -3.3980458416990134e-27,
      -7.715997280228606e-27, -1.1259596893648525e-26, -1.4030170529595712e-26,
      -1.6050450572117196e-26, -1.7361170269271564e-26, -1.801759645813204e-26,
      -1.8086105446951586e-26, -1.7640892048185994e-26, -1.6760886389430617e-26,
      -1.552693766879899e-26, -1.4019308910574746e-26, -1.2315512392613848e-26,
      -1.0488502066459343e-26, -8.60522721328755e-27, -6.725540946022476e-27,
      -4.901448089970466e-27, -3.176669503269618e-27, -1.5864940348445105e-27,
      -1.578850169939064e-28, 1.0901946300762202e-27, 2.146276056503713e-27,
      3.0057344993319877e-27, 3.67003239568598e-27, 4.14589055910261e-27,
      4.4444198670990435e-27, 4.580242809872136e-27, 4.570630733630063e-27,
      4.434678829755567e-27, 4.192537012790985e-27, 3.864710921510446e-27,
      3.47144347727906e-27, 3.0321838345008143e-27, 2.565147233722853e-27,
      2.086966276065407e-27, 1.6124315185780137e-27, 1.154317068728467e-27,
      7.232850430392309e-28, 3.2786134766730826e-28, -2.552577579529526e-29,
      -3.3245364035904023e-28, -5.903689446583558e-28, -7.984170495003461e-28,
      -9.572459386501165e-28, -1.0687936132527283e-27, -1.1360669990946702e-27,
      -1.1629196369470286e-27, -1.15383451905275e-27, -1.1137174674591046e-27,
      -1.0477054571471559e-27, -9.609932997707286e-28, -8.58681149116759e-28,
      -7.456443895871358e-28, -6.264266420909996e-28, -5.0515588137111205e-28,
      -3.8548301443129335e-28, -2.705417269420073e-28, -1.629279652813178e-28,
      -6.469708507160157e-29, 2.2623541158979185e-29, 9.800881033671622e-29,
      1.6089948358980338e-28, 2.1115748964822036e-28, 2.4901525788555444e-28,
      2.75021268191084e-28, 2.8998382732716643e-28, 2.9491487077845117e-28,
      2.909753555025393e-28, 2.794235619377522e-28, 2.615673717509384e-28,
      2.3872133877128983e-28, 2.1216913093945714e-28, 1.8313169637400097e-28,
      1.527413011649446e-28, 1.22021403492981e-28, 9.187217034106712e-29,
      6.306131063756976e-29, 3.6219792490019057e-29, 1.184193180198429e-29,
      -9.710716085662676e-30, -2.8202262669796585e-29, -4.3512803006660264e-29,
      -5.562674840147522e-29, -6.461975758346051e-29, -7.064481259726594e-29,
      -7.391793880533003e-29, -7.470401368221515e-29, -7.33030490385086e-29,
      -7.003726830443655e-29, -6.523923667439506e-29, -5.924123915121846e-29,
      -5.236604144705507e-29, -4.49191126263365e-29, -3.718233736150515e-29,
      -2.9409200483343543e-29, -2.1821387652137073e-29, -1.4606713718262749e-29,
      -7.918264727444609e-30, -1.8746204117030705e-30, 3.438988915824853e-30,
      7.968744316263305e-30, 1.1689674250506117e-29, 1.460261727337378e-29,
      1.6730857453249412e-29, 1.8116568802156988e-29, 1.8817192690122556e-29,
      1.8901858039644722e-29, 1.844793868863145e-29, 1.75378262624744e-29,
      1.625598073886035e-29, 1.4686305087628998e-29, 1.290987531749666e-29,
      1.1003043284700902e-29, 9.035916966732228e-30, 7.07121175896088e-30,
      5.1634568292264204e-30, 3.358532721100444e-30, 1.6935102322547947e-30,
      1.9675606474810899e-31, -1.1117322360883771e-30, -2.2198010855264522e-30,
      -3.1224646955654448e-30, -3.821116360781922e-30, -4.3226637798718324e-30,
      -4.638622383179127e-30, -4.784197411192843e-30, -4.777381822993931e-30,
      -4.63809316632418e-30, -4.387368458933274e-30, -4.046632045519335e-30,
      -3.6370474203815916e-30, -3.17896023939838e-30, -2.6914362643814336e-30,
      -2.191894848378365e-30, -1.695835824793776e-30, -1.2166553325905922e-30,
      -7.6554420563882334e-31, -3.5146107445216004e-31, 1.882874053391807e-32,
      3.4065814666436085e-31, 6.113169356562127e-31, 8.298741131273689e-31,
      9.969735631559246e-31, 1.1146122035078197e-30, 1.1859090907069277e-30,
      1.2148730916883703e-30, 1.2061757927843588e-30, 1.1649353070544222e-30,
      1.0965156039262297e-30, 1.006344953242456e-30, 8.997560772469074e-31,
      7.818496623513268e-31, 6.573820166272251e-31, 5.306768832235028e-31,
      4.055607443040063e-31, 2.8532038052536286e-31, 1.7268098970731706e-31,
      6.980281405645804e-32, -2.1706025881979744e-32, -1.007629467862416e-31,
      -1.667730897399129e-31, -2.1958278807510886e-31, -2.594267435084269e-31,
      -2.86871199564994e-31, -3.027552167017984e-31, -3.081319341098486e-31,
      -3.0421145953182905e-31, -2.923067705130429e-31, -2.737837473561295e-31,
      -2.500161976966127e-31, -2.2234648196258937e-31, -1.920521137688765e-31,
      -1.6031849409058018e-31, -1.282177462805117e-31, -9.669345296011056e-32,
      -6.655095682636844e-32, -3.845277585598734e-32, -1.291859881641547e-32,
      9.670731721663372e-33, 2.9065876242573405e-32, 4.5138934966424615e-32,
      5.787129739183073e-32, 6.734001405180419e-32, 7.370326220301088e-32,
      7.718542844999526e-32, 7.806227429512488e-32, 7.664658796670283e-32,
      7.327466008892086e-32, 6.829385406233197e-32, 6.205147640133863e-32,
      5.488508941871483e-32, 4.711434995294926e-32, 3.903440440178734e-32,
      3.0910822965112526e-32, 2.297601524819709e-32, 1.542703551448153e-32,
      8.424658958671987e-33, 2.093590248620483e-33, -3.4763480598961466e-33,
      -8.228207255477424e-33, -1.2135246540816402e-32, -1.519776899220357e-32,
      -1.7439612210984298e-32, -1.890443632745693e-32
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.03259651132850662, 0.0564353360878687, 0.042811076002034626, 0.03593493342374206,
      0.033922489168594055, 0.035231620810212964, 0.03861566805618338, 0.04308328349130854,
      0.04786349746756992, 0.052374906882151184, 0.05619819425209953, 0.05905141122973856,
      0.06076763232703413, 0.061274710860785266, 0.06057695899501615, 0.05873863479927499,
      0.05586915780242543, 0.05210999590878084, 0.047623175181000406, 0.042581363544595636,
      0.037159472935701814, 0.03152771422826718, 0.025846027373072653, 0.020259797061591388,
      0.014896753022216802, 0.009864944574090331, 0.005251671841382589,
      0.0011232513762214594, -0.002474508029816686, -0.005515242881822785,
      -0.007990506219480744, -0.009907887475441772, -0.011288888491993401,
      -0.012166654256890988, -0.012583646715647328, -0.01258933896045114,
      -0.012237995547518685, -0.011586592995258516, -0.010692922974418501,
      -0.009613909590380595, -0.008404161707525384, -0.007114771663021385,
      -0.005792363105309076, -0.004478383170635249, -0.003208627838033499,
      -0.0020129841002012425, -0.0009153685420430267, 6.616101189894337e-05,
      0.0009191460021073284, 0.0016363459322576515, 0.002215261662521693,
      0.0026575887115247976, 0.0029686247618957774, 0.0031566537351554852,
      0.0032323265801989555, 0.0032080564195603074, 0.0030974430256068782,
      0.002914738852242094, 0.0026743661134058607, 0.0023904917527733396,
      0.0020766646524533012, 0.001745517132664267, 0.0014085307376189295,
      0.001075864511802542, 0.0007562424612207533, 0.0004568956718302717,
      0.00018355361927367995, -5.9521460326638374e-05, -0.00026946367623477093,
      -0.000444702775765386, -0.0005848402968251861, -0.000690509034999129,
      -0.0007632219096327557, -0.0008052158213085246, -0.0008192955087152955,
      -0.000808681764420931, -0.0007768676828670389, -0.0007274859140390543,
      -0.0006641892040239939, -0.0005905458373832239, -0.0005099509711728891,
      -0.0004255542786535649, -0.0003402038113011831, -0.0002564055468084926,
      -0.0001762977217880391, -0.00010163875183872305, -3.380731734030688e-05,
      2.6186962234451674e-05, 7.768393410644245e-05, 0.00012034609968534767,
      0.00015412626660474437, 0.00017923128480526161, 0.00019608338583981078,
      0.00020528051482219346, 0.0002075568926994517, 0.00020374487988142733,
      0.00019473903728964526, 0.00018146310355368503, 0.00016484043264266567,
      0.00014576826916716867, 0.00012509608262957096, 0.00010360803995551515,
      8.200956985448807e-05, 6.091786435237323e-05, 4.085607295811321e-05,
      2.2250873507074292e-05, 5.433050369119974e-06, -9.359325429430224e-06,
      -2.1975539763685e-05, -3.234513389705068e-05, -4.046948203171593e-05,
      -4.6412454024627975e-05, -5.0290542336591876e-05, -5.226279816627853e-05,
      -5.252088239251351e-05, -5.1279494179822465e-05, -4.876739553297421e-05,
      -4.521920519341206e-05, -4.086809134902355e-05, -3.5939450778935205e-05,
      -3.064562317693891e-05, -2.5181654191306505e-05, -1.9722089692484355e-05,
      -1.4418757258486069e-05, -9.399469007913956e-06, -4.767562719153748e-06,
      -6.021855269338011e-07, 3.040783851079218e-06, 6.127282759688401e-06,
      8.643191290679762e-06, 1.059214479228412e-05, 1.1993133935622941e-05,
      1.2877986830853364e-05, 1.3288818745893019e-05, 1.3275524809936942e-05,
      1.2893380125714127e-05, 1.2200800376414102e-05, 1.1257304661092262e-05,
      1.0121711244844682e-05, 8.850586436076191e-06, 7.496957120891746e-06,
      6.10928876180709e-06, 4.730723023884762e-06, 3.3985626997861095e-06,
      2.143986298105127e-06, 9.919705315233521e-07, -3.86040446423135e-08,
      -9.346909015012953e-07, -1.6886864886393487e-06, -2.297937873419285e-06,
      -2.764175926396768e-06, -3.092899513075212e-06, -3.29273422394636e-06,
      -3.37478683923701e-06, -3.3520140999204053e-06, -3.238621553078341e-06,
      -3.049505358994426e-06, -2.7997470798298863e-06, -2.5041686937190365e-06,
      -2.176952459264618e-06, -1.8313278464717996e-06, -1.4793255912026737e-06,
      -1.1315970491644365e-06, -7.972954387988165e-07, -4.840142763935054e-07,
      -1.9777731827372325e-07, 5.692637687742808e-08, 2.770690851951598e-07,
      4.6097976023212903e-07, 6.08215053528139e-07, 7.194127620092297e-07,
      7.961340679562047e-07, 8.407004260667929e-07, 8.560303436751922e-07,
      8.454806240607328e-07, 8.126959266075216e-07, 7.614697665432926e-07,
      6.956193534184213e-07, 6.18875970616218e-07, 5.347919440095107e-07,
      4.466646491299708e-07, 3.5747747243381437e-07, 2.69857179920436e-07,
      1.8604675914444503e-07, 1.078924896419098e-07, 3.6843760786353054e-08,
      -2.603600802377439e-08, -8.004908689222631e-08, -1.2483557248319058e-07,
      -1.6033970194116167e-07, -1.86772037800326e-07, -2.045691139595654e-07,
      -2.1435199783192106e-07, -2.1688506566414156e-07, -2.1303611417261382e-07,
      -2.0373874894643124e-07, -1.8995780477149843e-07, -1.726583706405079e-07,
      -1.5277881744712147e-07, -1.3120806311040782e-07, -1.0876716120399067e-07,
      -8.619516733595617e-08, -6.413912403980714e-08, -4.314791058697232e-08,
      -2.366962907405679e-08, -6.0521419708453865e-09, 9.453661839479332e-09,
      2.268831690510301e-08, 3.357639754548794e-08, 4.2117744144385975e-08,
      4.837772424894693e-08, 5.247692527209276e-08, 5.4580640095237223e-08,
      5.488846587869403e-08, 5.362429176256317e-08, 5.10269045976957e-08,
      4.7341394932085445e-08, 4.281149955031636e-08, 3.767297307681952e-08,
      3.2148040452789896e-08, 2.6440945218314865e-08, 2.0734576010146532e-08,
      1.5188125865353837e-08, 9.935715969842741e-09, 5.085897418797009e-09,
      7.219312362883633e-10, -3.0972619097327315e-09, -6.33559550084513e-09,
      -8.977868553118118e-09, -1.102748625781173e-08, -1.2503956319192051e-08,
      -1.3440259912937176e-08, -1.388018688257786e-08, -1.3875714188499021e-08,
      -1.3484495188077524e-08, -1.2767515483608291e-08, -1.1786959209882636e-08,
      -1.0604318079782679e-08, -9.278764546249737e-09, -7.865800301580357e-09,
      -6.416182196687841e-09, -4.975119649491821e-09, -3.5817308010377345e-09,
      -2.2687391046914676e-09, -1.0623876932015504e-09, 1.7454277842382165e-11,
      9.570211303793543e-10, 1.7482448091497827e-09, 2.3882425228726114e-09,
      2.878725970447873e-09, 3.225358793975441e-09, 3.437086896734246e-09,
      3.525463832249431e-09, 3.503990733528397e-09, 3.3874873253587902e-09,
      3.1915075533983697e-09, 2.9318103663870838e-09, 2.623893284321951e-09,
      2.282593644746335e-09, 1.9217598968453227e-09, 1.5539930509696783e-09,
      1.1904564189671926e-09, 8.407501158167503e-10, 5.128454422219425e-10,
      2.1307322808099204e-10, -5.384052314107618e-11, -2.846988073165833e-10,
      -4.777249282070165e-10, -6.324282300269841e-10, -7.49451312815656e-10,
      -8.304053925216313e-10, -8.776999362361973e-10, -8.943720692146834e-10,
      -8.839205451438864e-10, -8.501483234708451e-10, -7.970170338708692e-10,
      -7.285158515030552e-10, -6.485465777484553e-10, -5.608260364406298e-10,
      -4.688062685621914e-10, -3.7561244903435407e-10, -2.839979644204059e-10,
      -1.9631568398183921e-10, -1.145041297591519e-10, -4.0087003013026824e-11,
      2.5815648765258043e-11, 8.246644288611728e-11, 1.2948170789442542e-10,
      1.6679640464456387e-10, 1.9462469414830586e-10, 2.1341781643547668e-10,
      2.238208042879544e-10, 2.26629390963727e-10, 2.2274828967207662e-10,
      2.1315183180629284e-10, 1.9884775732806048e-10, 1.8084476000221367e-10,
      1.6012420734736588e-10, 1.3761628428281516e-10, 1.141806537384484e-10,
      9.059158933473215e-11, 6.752741621844288e-11, 4.5563997101428676e-11,
      2.517192167210174e-11, 6.716998424461724e-12, -9.536392329378572e-12,
      -2.3419548245276515e-11, -3.485176836560718e-11, -4.383121382609129e-11,
      -5.042475031545115e-11, -5.4757187638786304e-11, -5.7000294796667133e-11,
      -5.736192627191714e-11, -5.607554865575542e-11, -5.3390408141211465e-11,
      -4.9562530385755454e-11, -4.4846696220071025e-11, -3.948949086682366e-11,
      -3.37234817246274e-11, -2.7762541142739827e-11, -2.179829652453693e-11,
      -1.5997660916053944e-11, -1.050137313934651e-11, -5.4234575334625785e-12,
      -8.514993385481887e-13, 3.1523775507424565e-12, 6.549948678684532e-12,
      9.324862187573617e-12, 1.1480263806272403e-11, 1.3036185035484054e-11,
      1.402679809038973e-11, 1.4497631474458817e-11, 1.4502829005008349e-11,
      1.4102523176875845e-11, 1.3360381382552363e-11, 1.2341371106696713e-11,
      1.1109778130457123e-11, 9.727500312575733e-12, 8.252628900484128e-12,
      6.738319751145674e-12, 5.23194844082392e-12, 3.774536097917514e-12,
      2.4004269404145805e-12, 1.137193935441281e-12, 5.745683411223599e-15,
      -9.793945057418438e-13, -1.8096674249955279e-12, -2.481944824945174e-12,
      -2.9979136861218947e-12, -3.363405786754075e-12, -3.5876983619755255e-12,
      -3.682809118084984e-12, -3.6628060115097735e-12, -3.5431491479117985e-12,
      -3.3400790135762406e-12, -3.0700621181159553e-12, -2.7493020907458062e-12,
      -2.3933214042293476e-12, -2.0166162593075895e-12, -1.6323847923473999e-12,
      -1.2523267011433036e-12, -8.865106368621949e-13, -5.433042912638291e-13,
      -2.2936101469509836e-13, 5.0343979630064707e-14, 2.924352547207947e-13,
      4.950242768958831e-13, 6.575696492443639e-13, 7.80717834328002e-13,
      8.661313378865787e-13, 9.163107728095197e-13, 9.344165624753546e-13,
      9.240953070988896e-13, 8.893150562420815e-13, 8.34212932753026e-13,
      7.629577626239341e-13, 6.796296027555973e-13, 5.881173420074463e-13,
      4.920348942610217e-13, 3.9465591609860737e-13, 2.9886647332936557e-13,
      2.0713465410734772e-13, 1.2149578308445373e-13, 4.355162974095792e-14,
      -2.551817858466536e-14, -8.493443747377545e-14, -1.342882804407426e-13,
      -1.7350465093713144e-13, -2.0280118504732003e-13, -2.22644246715918e-13,
      -2.337037113462522e-13, -2.3680792196215536e-13, -2.329000529435827e-13,
      -2.229969171808965e-13, -2.0815105019493518e-13, -1.8941670539259224e-13,
      -1.678202033579266e-13, -1.4433489920633528e-13, -1.198608689422266e-13,
      -9.520927096787629e-14, -7.109121406622274e-14, -4.8110859222729146e-14,
      -2.6762399761657417e-14, -7.43050203665885e-15, 9.606253602026037e-15,
      2.4169416006934397e-14, 3.6172682556987935e-14, 4.561237937228443e-14,
      5.255686739540933e-14, 5.713530910578542e-14, 5.952619219932892e-14,
      5.99459620436491e-14, 5.8638066140075e-14, 5.586266306912374e-14,
      5.188719716405046e-14, 4.697798993971461e-14, 4.139295137158493e-14,
      3.5375469514470134e-14, 2.914949648689953e-14, 2.2915813118350828e-14,
      1.6849423947111283e-14, 1.1098008958184695e-14, 5.781338481971563e-15,
      9.91542902916809e-16, -3.2058810075124776e-15, -6.770450581826317e-15,
      -9.684589155276706e-15, -1.195115146704821e-14, -1.3590699083490843e-14,
      -1.4638634257152822e-14, -1.5142290552582098e-14, -1.5158067047514976e-14,
      -1.474868046414594e-14, -1.398059666790662e-14, -1.2921690011125864e-14,
      -1.1639166363401784e-14, -1.0197773670188741e-14, -8.658312768733587e-15,
      -7.076451161327418e-15, -5.501833639602229e-15, -3.977476157801342e-15,
      -2.539423207186586e-15, -1.2166441448013546e-15, -3.1140437294870003e-17,
      1.0017664772010923e-15, 1.8729981258921936e-15, 2.579164251410958e-15,
      3.1219210952137835e-15, 3.507271885127265e-15, 3.744836534964016e-15,
      3.847114927305155e-15, 3.828765174773701e-15, 3.7059150673435955e-15,
      3.4955216298709042e-15, 3.214790439121281e-15, 2.8806631734231428e-15,
      2.5093788665721765e-15, 2.1161115719257606e-15, 1.7146846594297865e-15,
      1.3173598003617959e-15, 9.346968615613466e-16, 5.754794406581405e-16,
      2.4669962352963123e-16, -4.640527698002121e-17, -3.002717556884079e-16,
      -5.128929083468393e-16, -6.836729467755289e-16, -8.132611575786081e-16,
      -9.033726003723848e-16, -9.56602267137642e-16, -9.762387367051194e-16,
      -9.660825913604534e-16, -9.30274047802649e-16, -8.731334211301829e-16,
      -7.990172138637156e-16, -7.121918244270101e-16, -6.167261194976192e-16,
      -5.16403426982925e-16, -4.146528921984799e-16, -3.144996067566364e-16,
      -2.1853247209436257e-16, -1.2888839890675924e-16, -4.7251168823048757e-17,
      2.5136907959211022e-17, 8.745252095646898e-17, 1.3926010077809143e-16,
      1.8047378363572251e-16, 2.113145379825629e-16, 2.3226427631814296e-16,
      2.440186233540217e-16, 2.4743983290215075e-16, 2.435111485067267e-16,
      2.3329369489656955e-16, 2.178867759654953e-16, 1.9839224653642257e-16,
      1.7588342507204643e-16, 1.5137882726413256e-16, 1.2582082962614254e-16,
      1.0005922047184624e-16, 7.48394647534786e-17, 5.079540011416909e-17,
      2.8445994405944504e-17, 8.195729418036647e-18, -9.661869316702654e-18,
      -2.4938062434626526e-17, -3.7540600394668805e-17, -4.7463807704594863e-17,
      -5.477753414642832e-17, -5.961542808487976e-17, -6.216294695431609e-17,
      -6.264547362115727e-17, -6.131685663457364e-17, -5.844863937852038e-17,
      -5.432018960170563e-17, -4.920988829292155e-17, -4.3387486720025555e-17,
      -3.710769375608983e-17, -3.060501323209871e-17, -2.4089813607150673e-17,
      -1.7745580140807875e-17, -1.17272731926955e-17, -6.160695285024387e-18,
      -1.1427540092271973e-18, 3.257502531018578e-18, 6.997206650156908e-18,
      1.0057478572762052e-17, 1.2440848154356747e-17, 1.4168412739791664e-17,
      1.5276844652013745e-17, 1.581535130955898e-17, 1.5842678960062806e-17,
      1.54242380210843e-17, 1.4629414528862226e-17, 1.3529118650876854e-17,
      1.2193608004366746e-17, 1.0690610966240015e-17, 9.08376352557938e-18,
      7.431362723511278e-18, 5.785430493868871e-18, 4.19107385444692e-18,
      2.6861209451748986e-18, 1.3010073638165604e-18, 5.888357044850756e-20,
      -1.0240882551964425e-18, -1.93828071505457e-18, -2.6800239892046144e-18,
      -3.2509370533542944e-18, -3.6571978407684366e-18, -3.908780625041473e-18,
      -4.018686154669062e-18, -4.002186967661294e-18, -3.8761069873208045e-18,
      -3.658151070705961e-18, -3.3662967582124727e-18, -3.018257150844523e-18,
      -2.6310207007311105e-18, -2.2204708045418097e-18, -1.8010854877739033e-18,
      -1.3857151949556192e-18, -9.854347775262233e-19, -6.0946420593725435e-19,
      -2.6515132270890014e-19, 4.199091346615367e-20, 3.0820078618472e-19,
      5.313461233717104e-19, 7.107728664472593e-19, 8.471319826327347e-19,
      9.421923554762884e-19, 9.986466917033164e-19, 1.019916766340702e-18,
      1.0099635281449876e-18, 9.731067368557123e-19, 9.138579329861117e-19,
      8.367696766897563e-19, 7.463031579670026e-19, 6.467154955167336e-19,
      5.419673214239011e-19, 4.356506053089665e-19, 3.3093611260621065e-19,
      2.3053942193444574e-19, 1.3670404763281986e-19, 5.1199924276592684e-20,
      -2.46646931658993e-20, -9.001998239893838e-20, -1.4440207786550306e-19,
      -1.8771346705787484e-19, -2.201782872697354e-19, -2.4229443078075853e-19,
      -2.547842085601963e-19, -2.585451362607968e-19, -2.546022004271769e-19,
      -2.4406274573796836e-19, -2.2807490325623014e-19, -2.0779026172655755e-19,
      -1.8433127463692806e-19, -1.5876369978623086e-19, -1.3207418920780039e-19,
      -1.0515298827676737e-19, -7.878156554162089e-20, -5.3624880286615887e-20,
      -3.022790330313326e-20, -9.015937401647108e-21, 9.701763167160307e-21,
      2.572560246529105e-20, 3.8957018860530184e-20, 4.93881571545057e-20,
      5.709034570595075e-20, 6.220185489358486e-20, 6.491537165982009e-20,
      6.546557652359113e-20, 6.411715657148631e-20, 6.115353259301008e-20,
      5.686652258208493e-20, 5.1547108922129676e-20, 4.547742410434226e-20,
      3.89240209472658e-20, 3.213244889056315e-20, 2.5323118685637765e-20,
      1.868840412993003e-20, 1.2390901608784287e-20, 6.562746147143174e-21,
      1.305866295229738e-21, -3.30695080074644e-21, -7.230318753357696e-21,
      -1.0443971756997031e-20, -1.2950078371380898e-20, -1.477027681100102e-20,
      -1.594255054882384e-20, -1.6518052119994724e-20, -1.655797049119706e-20,
      -1.613052379993736e-20, -1.5308145178722236e-20, -1.416491522349044e-20,
      -1.2774280847483442e-20, -1.1207087123020298e-20, -9.529936533182056e-21,
      -7.803879049163217e-21, -6.0834267722357095e-21, -4.415878629913691e-21,
      -2.8409338394898348e-21, -1.3905675471166062e-21, -8.913817463397807e-23,
      1.0463065173989346e-21, 2.0055589181279457e-21, 2.7846510283201447e-21,
      3.3851574913482834e-21, 3.8134341315617604e-21, 4.0798216041180755e-21,
      4.197840901911817e-21, 4.1834042302572965e-21, 4.054061287501221e-21,
      3.828297407438468e-21, 3.524896441490111e-21, 3.162377784383639e-21,
      2.758513660106255e-21, 2.3299297526955315e-21, 1.89178954064861e-21,
      1.4575603107916278e-21, 1.0388568094904464e-21, 6.453568451838504e-22,
      2.847818838458766e-22, -3.706523444301012e-23, -3.1621390508480615e-22,
      -5.503994071411539e-22, -7.389052901630629e-22, -8.82382946121238e-22,
      -9.826563563267663e-22, -1.042519382747085e-21, -1.0655322272515953e-21,
      -1.0558228481166293e-21, -1.0178982353016611e-21, -9.56469536300464e-22,
      -8.762941209996473e-22, -7.820368013389088e-22, -6.78151600042691e-22,
      -5.687847085969414e-22, -4.576986002983083e-22, -3.4821667810624304e-22,
      -2.431873441172781e-22, -1.4496597945119586e-22, -5.541301901881861e-23,
      2.40939086054168e-23, 9.26359358358285e-23, 1.4971921764199415e-22,
      1.9523369659180384e-22, 2.2940649284088314e-22, 2.5275191594801933e-22,
      2.660199311938072e-22, 2.7014471897650575e-22, 2.661947511439675e-22,
      2.553255814552602e-22, 2.3873631662432524e-22, 2.1763050654924937e-22,
      1.9318197336017282e-22, 1.6650589378953404e-22, 1.386352620144435e-22,
      1.105026934711964e-22, 8.292738616792901e-23, 5.660693580664191e-23,
      3.211360485023727e-23, 9.894573106552189e-24, -9.724352581460297e-24,
      -2.6532120880171015e-23, -4.042347187991081e-23, -5.138818037874382e-23,
      -5.949903885726552e-23, -6.489907873622164e-23, -6.778848522744486e-23,
      -6.841161070067341e-23, -6.704443632074323e-23, -6.398277392018742e-23,
      -5.953144161390838e-23, -5.399458925370036e-23, -4.7667294927643417e-23,
      -4.0828502539314375e-23, -3.3735324000815583e-23, -2.6618688435399594e-23,
      -1.968028546408115e-23, -1.3090720379031678e-23, -6.988775818671928e-24,
      -1.481657314929438e-24, 3.353911505921445e-24, 7.469884629676268e-24,
      1.0844522426349866e-23, 1.3479593069156023e-23, 1.539728004143094e-23,
      1.663692010260237e-23, 1.7251684716744864e-23, 1.7305304896886238e-23,
      1.6868925267171834e-23, 1.6018158430748676e-23, 1.483039593743865e-23,
      1.3382417695178612e-23, 1.1748327921681395e-23, 9.99783298061311e-24,
      8.194864916899115e-24, 6.396544362150107e-24, 4.652467827359903e-24,
      3.0042972846749156e-24, 1.4856243626284755e-24, 1.2207739636794492e-25,
      -1.0683630934239881e-24, -2.0748762807107477e-24, -2.8931762474553294e-24,
      -3.524785662197479e-24, -3.97624134221712e-24, -4.258262692961344e-24,
      -4.384911042453437e-24, -4.37276451560413e-24, -4.240129469227231e-24,
      -4.006305766821196e-24, -3.690919432488035e-24, -3.313332589845249e-24,
      -2.8921371521261956e-24, -2.44473555477884e-24, -1.987008966109919e-24,
      -1.5330709132855896e-24, -1.0951021437434373e-24, -6.832608155765526e-25,
      -3.0566077232641347e-25, 3.1590305055570814e-26, 3.2430168527817216e-25,
      5.700684130468362e-25, 7.681072681437673e-25, 9.190686910116602e-25,
      1.024833035920227e-24, 1.0882988679130107e-24, 1.1131702429424805e-24,
      1.1037490406630698e-24, 1.0647374926063192e-24, 1.00105509813253e-24,
      9.176731762197627e-25, 8.194693883974291e-25, 7.111037083485639e-25,
      5.969165240348679e-25, 4.808488516082613e-25, 3.6638402583083313e-25,
      2.56509714470091e-25, 1.5369868601291414e-25, 5.990643988826835e-26,
      -2.3416417540177726e-26, -9.529930554588021e-26, -1.5521662136622382e-25,
      -2.0304480845651898e-25, -2.390137596741255e-25, -2.636546452750577e-25,
      -2.7774608486301935e-25, -2.8226038022070585e-25, -2.7831130199343375e-25,
      -2.671046865528414e-25, -2.4989285829094894e-25, -2.279336543858148e-25,
      -2.0245460001740664e-25, -1.7462256730612048e-25, -1.4551905503144827e-25,
      -1.1612105154800346e-25, -8.728729233247252e-26, -5.974959742020495e-26,
      -3.41088729345676e-26, -1.083528454498066e-26, 9.7279420535345e-27,
      2.7357669251359976e-26, 4.1941530500403964e-26, 5.346672734691395e-26,
      6.200749737897305e-26, 6.771177496014414e-26, 7.078752159581287e-26,
      7.148915027179302e-26, 7.010441054994209e-26, 6.694204086292316e-26,
      6.232043336512412e-26, 5.655749667035307e-26, 4.996184437778245e-26,
      4.282538372256848e-26, 3.541732998161855e-26, 2.797962914867117e-26,
      2.0723734346143006e-26, 1.3828650712481167e-26, 7.440139132916355e-27,
      1.67095102578824e-27, -3.398045841754683e-27, -7.71599728028684e-27,
      -1.1259596893707378e-26, -1.4030170529653474e-26, -1.60504505721724e-26,
      -1.736117026932301e-26, -1.8017596458178776e-26, -1.8086105446992915e-26,
      -1.764089204822146e-26, -1.6760886389459987e-26, -1.552693766882223e-26,
      -1.4019308910591997e-26, -1.2315512392625393e-26, -1.0488502066465588e-26,
      -8.605227213288997e-27, -6.725540946019697e-27, -4.9014480899640765e-27,
      -3.1766695032602572e-27, -1.586494034832818e-27, -1.5788501698050452e-28,
      1.0901946300907415e-27, 2.1462760565188076e-27, 3.005734499347164e-27,
      3.6700323957008054e-27, 4.145890559116718e-27, 4.444419867112132e-27,
      4.580242809883971e-27, 4.570630733640473e-27, 4.434678829764445e-27,
      4.192537012798279e-27, 3.864710921516156e-27, 3.471443477283228e-27,
      3.0321838345035227e-27, 2.5651472337242126e-27, 2.086966276065553e-27,
      1.6124315185770971e-27, 1.1543170687266493e-27, 7.232850430366776e-28,
      3.2786134766418424e-28, -2.552577579883048e-29, -3.3245364036283607e-28,
      -5.903689446622738e-28, -7.984170495042619e-28, -9.572459386539217e-28,
      -1.0687936132563314e-27, -1.1360669990979967e-27, -1.1629196369500215e-27,
      -1.1538345190553685e-27, -1.1137174674613233e-27, -1.0477054571489637e-27,
      -9.609932997721275e-28, -8.586811491177621e-28, -7.456443895877661e-28,
      -6.264266420912871e-28, -5.0515588137109285e-28, -3.8548301443100726e-28,
      -2.7054172694149646e-28, -1.6292796528062518e-28, -6.469708507076967e-29,
      2.26235411599094e-29, 9.800881033770629e-29, 1.608994835908181e-28,
      2.111574896492283e-28, 2.4901525788652835e-28, 2.7502126819200104e-28,
      2.899838273280083e-28, 2.949148707792039e-28, 2.909753555031933e-28,
      2.7942356193830184e-28, 2.6156737175138148e-28, 2.387213387716275e-28,
      2.1216913093969346e-28, 1.8313169637414226e-28, 1.5274130116499912e-28,
      1.2202140349295838e-28, 9.187217034097786e-29, 6.306131063742488e-29,
      3.621979248982969e-29, 1.1841931801761383e-29, -9.710716085908643e-30,
      -2.8202262670055825e-29, -4.351280300692387e-29, -5.56267484017353e-29,
      -6.461975758371024e-29, -7.06448125974997e-29, -7.391793880554334e-29,
      -7.470401368240468e-29, -7.330304903867214e-29, -7.003726830457285e-29,
      -6.523923667450379e-29, -5.924123915130012e-29, -5.236604144711085e-29,
      -4.491911262636815e-29, -3.718233736151487e-29, -2.9409200483333863e-29,
      -2.1821387652110745e-29, -1.4606713718222638e-29, -7.918264727393596e-30,
      -1.874620411643972e-30, 3.438988915889356e-30, 7.968744316330726e-30,
      1.1689674250574204e-29, 1.4602617273440553e-29, 1.6730857453313172e-29,
      1.8116568802216344e-29, 1.8817192690176422e-29, 1.8901858039692296e-29,
      1.844793868867221e-29, 1.7537826262508085e-29, 1.6255980738886927e-29,
      1.4686305087648636e-29, 1.29098753175097e-29, 1.1003043284707824e-29,
      9.035916966733621e-30, 7.07121175895741e-30, 5.163456829218803e-30,
      3.358532721089415e-30, 1.6935102322410928e-30, 1.9675606473245228e-31,
      -1.1117322361053068e-30, -2.219801085544024e-30, -3.122464695583091e-30,
      -3.821116360799144e-30, -4.3226637798882065e-30, -4.638622383194308e-30,
      -4.784197411206562e-30, -4.777381823005993e-30, -4.6380931663344636e-30,
      -4.3873684589417216e-30, -4.0466320455259465e-30, -3.637047420386417e-30,
      -3.178960239401513e-30, -2.6914362643830017e-30, -2.1918948483785232e-30,
      -1.6958358247926986e-30, -1.2166553325884658e-30, -7.655442056358398e-31,
      -3.514610744485109e-31, 1.8828740538047172e-32, 3.406581466687944e-31,
      6.11316935660789e-31, 8.29874113131943e-31, 9.969735631603699e-31,
      1.1146122035120296e-30, 1.1859090907108156e-30, 1.2148730916918695e-30,
      1.2061757927874216e-30, 1.1649353070570192e-30, 1.0965156039283481e-30,
      1.0063449532440986e-30, 8.99756077248089e-31, 7.818496623520732e-31,
      6.573820166275705e-31, 5.306768832234887e-31, 4.0556074430367874e-31,
      2.853203805247708e-31, 1.7268098970651052e-31, 6.980281405548667e-32,
      -2.1706025883068006e-32, -1.0076294678740166e-31, -1.667730897411034e-31,
      -2.195827880762928e-31, -2.5942674350957227e-31, -2.8687119956607386e-31,
      -3.0275521670279115e-31, -3.081319341107378e-31, -3.042114595326031e-31,
      -2.9230677051369495e-31, -2.7378374735665694e-31, -2.5001619769701686e-31,
      -2.2234648196287484e-31, -1.9205211376905053e-31, -1.603184940906521e-31,
      -1.282177462804925e-31, -9.669345296001234e-32, -6.655095682620395e-32,
      -3.845277585576955e-32, -1.291859881615717e-32, 9.670731721949886e-33,
      2.906587624287661e-32, 4.513893496673399e-32, 5.78712973921369e-32,
      6.734001405209907e-32, 7.370326220328772e-32, 7.71854284502487e-32,
      7.806227429535086e-32, 7.664658796689859e-32, 7.327466008908481e-32,
      6.829385406246358e-32, 6.205147640143837e-32, 5.4885089418784e-32,
      4.7114349952989845e-32, 3.903440440180186e-32, 3.0910822965103927e-32,
      2.297601524816856e-32, 1.5427035514436404e-32, 8.424658958613627e-33,
      2.093590248552197e-33, -3.476348059971196e-33, -8.22820725555629e-33,
      -1.2135246540896409e-32, -1.5197768992282352e-32, -1.743961221105982e-32,
      -1.8904436327527515e-32
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_4_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<4>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.0848489536797884), "design.b()[0] == 0.0848489536797884");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.0848489536797884));
    static_assert(almost_equal(design.b()[1], -0.2998151277306967), "design.b()[1] == -0.2998151277306967");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.2998151277306967));
    static_assert(almost_equal(design.b()[2], 0.432380885579187), "design.b()[2] == 0.432380885579187");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.432380885579187));
    static_assert(almost_equal(design.b()[3], -0.2998151277306968), "design.b()[3] == -0.2998151277306968");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.2998151277306968));
    static_assert(almost_equal(design.b()[4], 0.08484895367978841), "design.b()[4] == 0.08484895367978841");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.08484895367978841));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.4276143767442164), "design.a()[1] == -3.4276143767442164");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.4276143767442164));
    static_assert(almost_equal(design.a()[2], 4.444107825706439), "design.a()[2] == 4.444107825706439");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 4.444107825706439));
    static_assert(almost_equal(design.a()[3], -2.5797065965178847), "design.a()[3] == -2.5797065965178847");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -2.5797065965178847));
    static_assert(almost_equal(design.a()[4], 0.5656616850330327), "design.a()[4] == 0.5656616850330327");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.5656616850330327));
    std::cout << "max_deviation(cheby2,lowpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.0848489536797884, -0.008985634246149898, 0.0245036974015677, 0.04299263075394767,
      0.052137937514536686, 0.055940036251961436, 0.05708182676417603, 0.057232234568875384,
      0.05730868393319538, 0.057697077309247696, 0.058430731671448743, 0.05933149086611106,
      0.06011720341730384, 0.060480165813865505, 0.06014116391861629, 0.0588835350091369,
      0.05657131805704124, 0.05315512912208936, 0.04866893905605363, 0.043220472632994625,
      0.03697751057702291, 0.0301519694320716, 0.02298326406277032, 0.015722125593381514,
      0.00861575353581269, 0.0018949233757810276, -0.0042365518799842095,
      -0.009609797760224015, -0.014096242927197918, -0.01761045386671309,
      -0.020110624946808216, -0.021596987821224947, -0.02210845972524276,
      -0.021717884640857, -0.020526236701058423, -0.01865615379624709,
      -0.016245153500058757, -0.013438855603841164, -0.010384498249425292,
      -0.007224990390362569, -0.004093694545956681, -0.0011100828750428404,
      0.001623641354059303, 0.004024913854236927, 0.006032173383670756,
      0.007605262716544159, 0.00872494400171896, 0.00939163385772742, 0.009623484352476449,
      0.009453949669749585, 0.008928984972674806, 0.008104024183299054,
      0.007040877758969579, 0.005804680872639398, 0.004461007621711019, 0.00307324899213348,
      0.0017003323071480905, 0.000394838790286893, -0.0007984453889082427,
      -0.0018435297862673553, -0.00271377640423309, -0.0033920338805008606,
      -0.0038703851263528783, -0.004149556115394961, -0.004238042213230873,
      -0.004151014054668233, -0.0039090675975605345, -0.00353688280151445,
      -0.003061852677284843, -0.0025127395822192103, -0.0019184090027804012,
      -0.0013066831009915566, -0.000703347451471951, -0.0001313350948413108,
      0.000389897307936973, 0.00084479544541764, 0.0012219380307438433,
      0.001514082199867906, 0.001718039965937395, 0.0018344071171551707,
      0.0018671696632572132, 0.0018232153014744578, 0.0017117784255691638,
      0.001543847028247212, 0.0013315585746919772, 0.0010876097107719142,
      0.0008247016929265249, 0.000555039879595758, 0.00028990170179544984,
      3.928342417452405e-05, -0.00018836810271317657, -0.00038633645086344845,
      -0.0005497307905135172, -0.0006754998813203609, -0.0007623722689303069,
      -0.0008107322593886538, -0.0008224428360288859, -0.0008006276803756477,
      -0.000749424879171959, -0.0006737247837111653, -0.0005789038922584969,
      -0.00047056562182438543, -0.00035429750146813346, -0.00023545274042511134,
      -0.00011896238676995029, -9.18247998457362e-06, 9.022120764034643e-05,
      0.00017634997956067396, 0.00024711131032880914, 0.00030122237730683353,
      0.0003381813682300516, 0.00035821084616073336, 0.00036217813471287985,
      0.00035149810573389863, 0.000328023918019909, 0.0002939311873049683,
      0.00025160079035031237, 0.00020350505083998834, 0.00015210145726413994,
      9.973736049465905e-05, 4.856832925252111e-05, 4.920419841736464e-07,
      -4.290120175835965e-05, -8.036102760257462e-05, -0.00011099296608587032,
      -0.00013425885709545906, -0.0001499631865377988, -0.00015822726916514887,
      -0.00015945348279009517, -0.00015428193510744458, -0.00014354200936703756,
      -0.00012820119749430963, -0.00010931350046242984, -8.796946976640663e-05,
      -6.524969639142903e-05, -4.2183241250831e-05, -1.971216039104161e-05,
      1.3370745012279044e-06, 2.0274809529990855e-05, 3.656197850999923e-05,
      4.9816597259438086e-05, 5.981343821961011e-05, 6.647756525483462e-05,
      6.987258371838454e-05, 7.018458529763519e-05, 6.770284084422524e-05,
      6.279831941403193e-05, 5.5901091862960915e-05, 4.747761774211544e-05,
      3.8008821141869635e-05, 2.7969741489786403e-05, 1.7811406419652838e-05,
      7.945423048480774e-06, -1.268371575256714e-06, -9.531013861716819e-06,
      -1.661023001172492e-05, -2.2343057808873783e-05, -2.6635483112298794e-05,
      -2.9459397358449967e-05, -3.0847257893918485e-05, -3.088488605632831e-05,
      -2.9702868698893128e-05, -2.7467038287482966e-05, -2.4368496503369595e-05,
      -2.0613618781572653e-05, -1.6414435179616514e-05, -1.1979729480874437e-05,
      -7.507136716977252e-06, -3.176452579854376e-06, 8.557003990674429e-07,
      4.45977261278907e-06, 7.535739815972303e-06, 1.0014153246128541e-05,
      1.1855883247261673e-05, 1.305069428026341e-05, 1.3614821727012283e-05,
      1.3587743527618676e-05, 1.3028352508898405e-05, 1.2010738722173427e-05,
      1.0619785989047557e-05, 8.946774195616007e-06, 7.08515991437953e-06,
      5.126684031971644e-06, 3.157927643867158e-06, 1.2574079678343959e-06,
      -5.067242074990947e-07, -2.0783537225734188e-06, -3.4144331265366428e-06,
      -4.4853993204339396e-06, -5.275018557124495e-06, -5.7797218137238466e-06,
      -6.007506550989307e-06, -5.976490510705282e-06, -5.713208524032691e-06,
      -5.250744523464756e-06, -4.626788421705707e-06, -3.881701708737075e-06,
      -3.0566670734722837e-06, -2.191986682443521e-06, -1.3255815734082966e-06,
      -4.91731572705601e-07, 2.7991817907771977e-07, 9.650710565437802e-07,
      1.5452123824305243e-06, 2.007772825445714e-06, 2.3460417424220944e-06,
      2.5588583349199735e-06, 2.6501145120235716e-06, 2.6281074493659086e-06,
      2.504782036144518e-06, 2.2949038058785095e-06, 2.0152017128407175e-06,
      1.6835174532495644e-06, 1.3179941830383762e-06, 9.36332719655205e-07,
      5.551379111637374e-07, 1.8937208726452046e-07, -1.4807336349832012e-07,
      -4.4668297706780507e-07, -6.984988240849109e-07, -8.981836641409655e-07,
      -1.04297474399297e-06, -1.132540755028957e-06, -1.1687570538362656e-06,
      -1.1554159904478248e-06, -1.0978900961153597e-06, -1.0027660020845221e-06,
      -8.774663651565981e-07, -7.298758582336827e-07, -5.679855533252889e-07,
      -3.9956789897434514e-07, -2.3189209603911998e-07, -7.148712631078398e-08,
      7.60428972594416e-08, 2.0614890655722516e-07, 3.154127835468636e-07,
      4.015713146079921e-07, 4.634923322620141e-07, 5.011086602344213e-07,
      5.15316589814507e-07, 5.078463538356358e-07, 4.811124367849047e-07,
      4.3805158672368845e-07, 3.819561095366365e-07, 3.1630947030346214e-07,
      2.446304486484703e-07, 1.7033114713066362e-07, 9.659308802141688e-08,
      2.6264507395217065e-08, -3.821918318662801e-08, -9.489090196397458e-08,
      -1.4228353465314825e-07, -1.7943879343448374e-07, -2.0589517648450563e-07,
      -2.216575463044303e-07, -2.271513224667043e-07, -2.2316459713878004e-07,
      -2.107816336384744e-07, -1.9131120908005677e-07, -1.6621312663135884e-07,
      -1.3702596969195974e-07, -1.0529882089960122e-07, -7.252924644148304e-08,
      -4.010937446337807e-08, -9.281398820723684e-09, 1.889666187917399e-08,
      4.357460493309478e-08, 6.412318997450057e-08, 8.013730005233322e-08,
      9.142996958439605e-08, 9.801840763508878e-08, 1.0010334974295698e-07,
      9.804320377952751e-08, 9.232451694345674e-08, 8.353028646575201e-08,
      7.230757257133396e-08, 5.933575705042894e-08, 4.5296633979583284e-08,
      3.0847330941469674e-08, 1.6596850003366928e-08, 3.0867980023969063e-09,
      -9.223344959453974e-09, -1.996628270754264e-08, -2.8872347115256657e-08,
      -3.5770566025001564e-08, -4.0585740967331796e-08, -4.3332040018772096e-08,
      -4.4103698912785665e-08, -4.3063479355516997e-08, -4.0429558323794726e-08,
      -3.646151799327126e-08, -3.144607585426654e-08, -2.5683142245811057e-08,
      -1.9472722209722925e-08, -1.3103094765969239e-08, -6.8406100550657935e-09,
      -9.213477969015804e-10, 4.45521657844479e-09, 9.13048513140011e-09,
      1.2988983262600965e-08, 1.5958688088856238e-08, 1.8009613967976573e-08,
      1.9150881332551073e-08, 1.9426532585142915e-08, 1.8910382338631065e-08,
      1.770019920444013e-08, 1.5911513579088696e-08, 1.3671331803610763e-08,
      1.1112013332720208e-08, 8.36553603070433e-09, 5.558337411103885e-09,
      2.8068785911494595e-09, 2.140349221157596e-10, -2.133625458801799e-09,
      -4.167654858259717e-09, -5.838648483976852e-09, -7.116326939268827e-09,
      -7.988857665066633e-09, -8.461516484560415e-09, -8.554806492207782e-09,
      -8.302161426079267e-09, -7.74736458611038e-09, -6.9418127406051565e-09,
      -5.941747905329566e-09, -4.805569124911173e-09, -3.5913222689202674e-09,
      -2.3544492596722982e-09, -1.145859971210997e-09, -1.0371149535355063e-11,
      1.0144620837626148e-09, 1.8991145389104836e-09, 2.6224679705789257e-09,
      3.1718202255441934e-09, 3.5425621466761874e-09, 3.737567451090731e-09,
      3.766347677937146e-09, 3.6440284551685134e-09, 3.3902048676350713e-09,
      3.0277328169485303e-09, 2.5815102190828803e-09, 2.0772970190177224e-09,
      1.5406166827278333e-09, 9.95774446318107e-10, 4.650195545003377e-10,
      -3.212961200141487e-11, -4.793868822077983e-10, -8.640233483084426e-10,
      -1.1770205725395876e-09, -1.4130627242011906e-09, -1.5703837108770583e-09,
      -1.6504895056761618e-09, -1.65777880998447e-09, -1.5990869305276741e-09,
      -1.483178339231339e-09, -1.3202129136564132e-09, -1.1212094469357255e-09,
      -8.975278163701004e-10, -6.603883731284049e-10, -4.204438344470741e-10,
      -1.8741539795839184e-10, 3.019887701971068e-11, 2.2533900849071287e-10,
      3.925203889060053e-10, 5.278956291744084e-10, 6.292458948873397e-10,
      6.959089723349709e-10, 7.286530849739496e-10, 7.295067345348657e-10,
      7.015555673719797e-10, 6.487174889169956e-10, 5.755070077644978e-10,
      4.867991408353934e-10, 3.8760221781077795e-10, 2.828476592735818e-10,
      1.7720334495244733e-10, 7.491561253954433e-11, -2.031669267307047e-11,
      -1.0543429350217148e-10, -1.7807537015789774e-10, -2.366003277789754e-10,
      -2.8008570678833306e-10, -3.0829049401198964e-10, -3.2159886044584166e-10,
      -3.2094388588055027e-10, -3.077171331176221e-10, -2.8366901599237196e-10,
      -2.508047842740056e-10, -2.112806493285285e-10, -1.6730412640000526e-10,
      -1.210421046880281e-10, -7.453950871542777e-11, -2.9650717409114086e-11,
      1.2014806866578412e-11, 4.9131928588726696e-11, 8.068420037750124e-11,
      1.059736881585026e-10, 1.246172951626609e-10, 1.3653105006052782e-10,
      1.4190415506743724e-10, 1.4116481736140823e-10, 1.3494001274766414e-10,
      1.240113592058841e-10, 1.092692181156906e-10, 9.166700358890096e-11,
      7.217747843496182e-11, 5.1752563110087285e-11, 3.1287896396678886e-11,
      1.159307831610644e-11, -6.63178895052044e-12, -2.2812954546923212e-11,
      -3.651324939848106e-11, -4.743593866779471e-11, -5.5422668376555094e-11,
      -6.044616469569986e-11, -6.259848658879987e-11, -6.20757292457744e-11,
      -5.916012769982699e-11, -5.420051951598022e-11, -4.759209625403007e-11,
      -3.975631047465082e-11, -3.112171415352768e-11, -2.210639180950519e-11,
      -1.3102523988470222e-11, -4.463480478773737e-12, 3.5062960273162182e-12,
      1.0558490474831172e-11, 1.650520189699117e-11, 2.1220432046096045e-11,
      2.4638991254796157e-11, 2.6753117229616602e-11, 2.760716359941619e-11,
      2.7290756135528103e-11, 2.5930835968589198e-11, 2.3683011932157098e-11,
      2.0722630074303657e-11, 1.7235939602581345e-11, 1.3411693634560424e-11,
      9.433472910752564e-12, 5.472963978011523e-12, 1.6843631289990484e-12,
      -1.7999836924065287e-12, -4.8726542507424866e-12, -7.452941500297678e-12,
      -9.487418038450357e-12, -1.0949371325482307e-11, -1.1837242358829824e-11,
      -1.2172226746191266e-11, -1.1995214552404145e-11, -1.1363254076559583e-11,
      -1.0345725348666906e-11, -9.020402391438314e-12, -7.469570159455625e-12,
      -5.776343687150742e-12, -4.021314585616785e-12, -2.279624900118533e-12,
      -6.185417322904606e-13, 9.044208642913816e-13, 2.2428123021963216e-12,
      3.361992125850403e-12, 4.239338669475902e-12, 4.8639641155813174e-12,
      5.235995452120994e-12, 5.365492097791032e-12, 5.271078347551764e-12,
      4.978372374068627e-12, 4.518293535841353e-12, 3.925326537795129e-12,
      3.2358150061807866e-12, 2.486348784177941e-12, 1.712299274821374e-12,
      9.465460153476217e-13, 2.1842591420699137e-13, -4.4707525877666815e-13,
      -1.0298809925102419e-12, -1.5151342823271985e-12, -1.8932720353329742e-12,
      -2.1598837720995433e-12, -2.315381286053524e-12, -2.364510756876446e-12,
      -2.3157419362561032e-12, -2.1805704780242496e-12, -1.972769376036274e-12,
      -1.7076239591901582e-12, -1.4011821708032817e-12, -1.0695481545189678e-12,
      -7.282427230068523e-13, -3.916493464562099e-13, -7.255910795854674e-14,
      2.1817713881865065e-13, 4.718862004306787e-13, 6.822010145895813e-13,
      8.450857607520797e-13, 9.5876673157016e-13, 1.0235809045310297e-12,
      1.0417562255249617e-12, 1.0171389341311143e-12, 9.54883845995062e-13,
      8.611234093763514e-13, 7.426306415311641e-13, 6.064898140430667e-13,
      4.597870945726567e-13, 3.09331372763691e-13, 1.6141330927580518e-13,
      2.160835573187889e-14, -1.0537280000537316e-13, -2.1578511387141622e-13,
      -3.069021801628527e-13, -3.770239379349306e-13, -4.2544321553115336e-13,
      -4.523764565218671e-13, -4.588648579039061e-13, -4.466527068593765e-13,
      -4.1804993630611926e-13, -3.757858541326561e-13, -3.2286066824143e-13,
      -2.624008685849923e-13, -1.9752378267278924e-13, -1.3121573984575495e-13,
      -6.622731000354692e-14, -4.988071249115041e-15, 5.045764803027783e-14,
      9.849357429687415e-14, 1.3795325426535975e-13, 1.6812198158038517e-13,
      1.8872074936995904e-13, 1.998746185535116e-13, 2.020682715911083e-13,
      1.960917549734161e-13, 1.8297950627254896e-13, 1.6394572315971487e-13,
      1.403189767659821e-13, 1.1347871762746093e-13, 8.479598891493036e-14,
      5.5580269599088585e-14, 2.7033940804192004e-14, 2.1542241388338575e-16,
      -2.3988416777345273e-14, -4.488039619029512e-14, -6.196191837557389e-14,
      -7.493317551084179e-14, -8.368550917828013e-14, -8.828699172428524e-14,
      -8.896245988337959e-14, -8.606932939265527e-14, -8.007055546440165e-14,
      -7.150608285482914e-14, -6.096405729965402e-14, -4.905295508864866e-14,
      -3.637563825766513e-14, -2.3506168520367364e-14, -1.0970022958937195e-14,
      7.718423319193119e-16, 1.1334829593588683e-14, 2.041837262821476e-14,
      2.780955109720057e-14, 3.338290060526176e-14, 3.709679814326043e-14,
      3.898690016753478e-14, 3.9157179950457866e-14, 3.776915188857149e-14,
      3.502988435320526e-14, 3.117939152268961e-14, 2.6477961333552692e-14,
      2.119392470867713e-14, 1.559230443665203e-14, 9.924704565858153e-15,
      4.42071704005272e-15, -7.189644999790062e-16, -5.327619613578031e-15,
      -9.275742019178044e-15, -1.2472498396004335e-14, -1.4865521909748704e-14,
      -1.643921147450706e-14, -1.7211749866765303e-14, -1.7231083401954457e-14,
      -1.657012302839875e-14, -1.5321431930160073e-14, -1.3591659017869403e-14,
      -1.149596232098033e-14, -9.152642825140064e-15, -6.678179441246081e-15,
      -4.182821348503464e-15, -1.7668567271934675e-15, 4.823613743022328e-16,
      2.4925890004649814e-15, 4.208057752896824e-15, 5.5900589414720114e-15,
      6.616798943088379e-15, 7.282602746977983e-15, 7.596560798572693e-15,
      7.580726868693856e-15, 7.267981814440772e-15, 6.699680017032665e-15,
      5.923192415112181e-15, 4.989452980601226e-15, 3.950604897785188e-15,
      2.8578293654931598e-15, 1.7594246416903866e-15, 6.991864835865278e-16,
      -2.8487573320627425e-16, -1.1614695022353677e-15, -1.906594212318947e-15,
      -2.5037728411561494e-15, -2.9439647763357353e-15, -3.225194385476722e-15,
      -3.351937762035273e-15, -3.3343154443436316e-15, -3.187141869297406e-15,
      -2.9288829975378e-15, -2.580572131227013e-15, -2.1647306988686794e-15,
      -1.7043360109871667e-15, -1.2218720327379444e-15, -7.384924253500423e-16,
      -2.733178270057572e-16, 1.571180903403154e-16, 5.392665309777131e-16,
      8.628050480696931e-16, 1.1207283732883946e-15, 1.3092997620363642e-15,
      1.4278784130209682e-15, 1.4786418781827224e-15, 1.466224663097256e-15,
      1.3972954440088382e-15, 1.2800955508334142e-15, 1.123960675095244e-15,
      9.388462743702245e-16, 7.348749969181949e-16, 5.219217909647963e-16,
      3.0924934725074733e-16, 1.05203304620736e-16, -8.302662683969572e-17,
      -2.495766678245116e-16, -3.9001014061054173e-16, -5.013525579478786e-16,
      -5.820657121305539e-16, -6.319677508697784e-16, -6.521076697667022e-16,
      -6.446036213086905e-16, -6.124549454672776e-16, -5.593378927486081e-16,
      -4.893946773253527e-16, -4.0702481780830654e-16, -3.166867569969322e-16,
      -2.227165656105048e-16, -1.2916919678252552e-16, -3.968633554331373e-17,
      4.260655512418327e-17, 1.15172794030058e-16, 1.7610676348710974e-16,
      2.241472098578299e-16, 2.5866387397664135e-16, 2.796205864653516e-16,
      2.8751858291664265e-16, 2.8332420540169494e-16, 2.683853639546719e-16,
      2.443411464226532e-16, 2.130288055894242e-16, 1.7639204210451575e-16,
      1.3639406745431094e-16, 9.493840221902112e-17, 5.379977125739833e-17,
      1.4566828940324735e-17, -2.1402187724227193e-17, -5.3010396596455433e-17,
      -7.943989209459527e-17, -1.0015665972840938e-16, -1.1490383289333424e-16,
      -1.2368469767264237e-16, -1.2673711752658312e-16, -1.2450122402498363e-16,
      -1.1758230432615986e-16, -1.0671081636827975e-16, -9.270138695302929e-17,
      -7.641250648785787e-17, -5.87084390989016e-17, -4.04246310580292e-17,
      -2.233763724908604e-17, -5.140307778367051e-18, 1.0577302848578078e-17,
      2.4341112094377042e-17, 3.58003310383854e-17, 4.4729215705697125e-17,
      5.1023723966785346e-17, 5.4693707922545485e-17, 5.585138584843478e-17,
      5.469691146943006e-17, 5.150189263064619e-17, 4.6591708820774724e-17,
      4.0327441209008e-17, 3.3088164526395704e-17, 2.5254262583234526e-17,
      1.7192324181788122e-17, 9.242059504600383e-18, 1.7055544658408463e-18,
      -5.160942588469096e-18, -1.1152626159476053e-17, -1.611916526353424e-17,
      -1.9965293858687016e-17, -2.2649175565576848e-17, -2.417882476484387e-17,
      -2.4606915084355012e-17, -2.4024337402557807e-17, -2.2552883306769554e-17,
      -2.0337427605664956e-17, -1.7537966675581923e-17, -1.4321840199050313e-17,
      -1.085642459464393e-17, -7.302539667376246e-18, -3.808758304397064e-18,
      -5.067549200101512e-19, 2.4922258158590413e-18, 5.099750513137119e-18,
      7.251447555331424e-18, 8.907187947413051e-18, 1.0050294021421218e-17,
      1.068590224047615e-17, 1.083862729797922e-17, 1.0549687819856853e-17,
      9.873659494906843e-18, 8.875019907183808e-18, 7.62464147734731e-18,
      6.196375664489844e-18, 4.663853985086507e-18, 3.097610588539489e-18,
      1.562608224096266e-18, 1.1622554766252068e-19, -1.1932601143595218e-18,
      -2.327683270703346e-18, -3.2595038199411378e-18, -3.9718520426938486e-18,
      -4.458149090784307e-18, -4.72135943630575e-18, -4.7729407109088175e-18,
      -4.63156187978389e-18, -4.3216628764933716e-18, -3.871927914052153e-18,
      -3.3137410227970443e-18, -2.6796863602989438e-18, -2.0021479582093686e-18,
      -1.3120543091564518e-18, -6.37803053377156e-19, -4.390485283642819e-21,
      5.672398816993254e-19, 1.0606254708789748e-18, 1.463994501057519e-18,
      1.7702706379538314e-18, 1.9768923267991946e-18, 2.08547204546093e-18,
      2.101324551216873e-18, 2.0328955084516154e-18, 1.8911227365986268e-18,
      1.6887618170744604e-18, 1.4397060967533674e-18, 1.1583284081249143e-18,
      8.588682990471423e-19, 5.548844460337153e-19, 2.5878743434239085e-19,
      -1.8536561078048465e-20, -2.6800526892414004e-19, -4.825214559319894e-19,
      -6.570581915489987e-19, -7.886542631033114e-19, -8.76328710297907e-19,
      -9.209257549446348e-19, -9.24903039339292e-19, -8.920770555877344e-19,
      -8.273399757726991e-19, -7.363618289338193e-19, -6.252911836650887e-19,
      -5.004662668862884e-19, -3.6814687151746166e-19, -2.3427557469181127e-19,
      -1.042748006465162e-19, 1.7115787919687017e-20, 1.259591125667086e-19,
      2.191971833424275e-19, 2.9468550953080407e-19, 3.511881793656465e-19,
      3.8833764945503127e-19, 4.0656427883953187e-19, 4.0700134131412743e-19,
      3.9137165427076427e-19, 3.6186208569988433e-19, 3.209920657762653e-19,
      2.714818662641959e-19, 2.1612585640727756e-19, 1.5767523857200894e-19,
      9.873395321639983e-20, 4.167056338434188e-20, -1.1451975071539774e-20,
      -5.892764196126921e-20, -9.943960784201508e-20, -1.3207401140206638e-19,
      -1.5631652404893047e-19, -1.7203352056679551e-19, -1.7944010287514025e-19,
      -1.7905752173957396e-19, -1.7166270978210758e-19, -1.5823268432644925e-19,
      -1.398865107764001e-19, -1.178273500880558e-19, -9.328686375231603e-20,
      -6.747393452058646e-20, -4.1529299654191783e-20, -1.648730451321236e-20,
      6.754414171864228e-21, 2.7456897363975857e-20, 4.505343667540858e-20,
      5.915503807287045e-20, 6.95483543991648e-20, 7.618690474653992e-20,
      7.917658300605916e-20, 7.875658471859705e-20, 7.527695129703684e-20,
      6.917394658346612e-20, 6.094444721056032e-20, 5.1120451502417617e-20,
      4.0244698927249976e-20, 2.884825136067394e-20, 1.7430726917212828e-20,
      6.443705109619616e-21, -3.7223535030037384e-21, -1.274750195092443e-20,
      -2.038800640385836e-20, -2.6478487661140293e-20, -3.0930768288955537e-20,
      -3.372979301958366e-20, -3.4927069298862046e-20, -3.463212879138874e-20,
      -3.300253958466341e-20, -3.023300407881702e-20, -2.6544061218073248e-20,
      -2.2170876566941905e-20, -1.7352552983447745e-20, -1.2322331817167139e-20,
      -7.298983315897562e-21, -2.4796088898732408e-21, 1.9659994812625518e-21,
      5.89937293016411e-21, 9.21575358070067e-21, 1.1844921633470897e-20,
      1.3750581758437802e-20, 1.4928473869332615e-20, 1.5403407430479113e-20,
      1.5225441348930865e-20, 1.446544342453416e-20, 1.3210264872656599e-20,
      1.1557757553188823e-20, 9.611845467025198e-21, 7.477839251543866e-21,
      5.258154379402323e-21, 3.0485621520744748e-21, 9.350689763277906e-22,
      -1.0085146640588824e-21, -2.7222872897744886e-21, -4.161254338613655e-21,
      -5.295641572342842e-21, -6.110578591254827e-21, -6.6052265274577586e-21,
      -6.79143862611264e-21, -6.692052137659492e-21, -6.338914832773083e-21,
      -5.7707497948446225e-21, -5.030958373306187e-21, -4.165453846035579e-21,
      -3.2206080777502716e-21, -2.2413809639387083e-21, -1.269688427227124e-21,
      -3.4304988641533517e-22, 5.064588871402027e-22, 1.2529361692400343e-21,
      1.8770701633835024e-21, 2.3662547521614003e-21, 2.714429918359734e-21,
      2.921680049015097e-21, 2.993629619384523e-21, 2.9406798678644138e-21,
      2.7771320675564984e-21, 2.5202430042047296e-21, 2.1892564781643527e-21,
      1.804451306146352e-21, 1.3862416898751112e-21, 9.54360248845854e-22,
      5.271477963958631e-22, 1.209673805006114e-22, -2.502464955014711e-22,
      -5.752989468370901e-22, -8.459074934207356e-22, -1.0567432815738284e-21,
      -1.2053519869219675e-21, -1.2919692811617719e-21, -1.3192484408027785e-21,
      -1.2919194156957926e-21, -1.2163994841425385e-21, -1.10037555882743e-21,
      -9.523773614299862e-22, -7.813591635561511e-22, -5.963057233300425e-22,
      -4.058755656533286e-22, -2.180919978596596e-22, -4.0089356676358955e-23,
      1.2208092528614433e-22, 2.635826492248372e-22, 3.808663916430968e-22,
      4.716833867931505e-22, 5.350468432191661e-22, 5.7114735895413365e-22,
      5.812302552297579e-22, 5.674433829876504e-22, 5.326642822837156e-22,
      4.803155189968689e-22, 4.14176625593885e-22, 3.3820038216989904e-22,
      2.563402464120805e-22, 1.7239463622682425e-22, 8.987254737503374e-23,
      1.1883710057070316e-23, -5.894479111348676e-23, -1.205247394273059e-22,
      -1.7133629350334876e-22, -2.1043223111118225e-22, -2.3741923338032747e-22,
      -2.52419191968826e-22, -2.56014016546844e-22, -2.491777294326768e-22,
      -2.3319976433808393e-22, -2.096033493582288e-22, -1.80062668357092e-22,
      -1.4632218166428741e-22, -1.1012107129263374e-22, -7.31252840972665e-23,
      -3.686910523035933e-23, -2.7076300228995098e-24, 2.821906047471062e-23,
      5.500975460572701e-23, 7.701422741727807e-23, 9.383429119115614e-23,
      1.0531482029359924e-22, 1.1152608433089217e-22, 1.1273893531793302e-22,
      1.0939452472269331e-22, 1.0207027769435012e-22, 9.144383019019752e-23,
      7.825654808028579e-23, 6.327810540203593e-23, 4.727341275292212e-23,
      3.0972968008785135e-23, 1.5047461943061926e-23, 8.722236756569856e-26,
      -1.341316716621903e-23, -2.5064974661836126e-23, -3.459027089394607e-23,
      -4.182203393606913e-23, -4.6699876946682765e-23, -4.9261995510319326e-23,
      -4.963402134505274e-23, -4.801552380875201e-23, -4.466492072406264e-23,
      -3.9883548183154276e-23, -3.3999598779476847e-23, -2.735257350178463e-23,
      -2.0278809190899644e-23, -1.3098546153487369e-23, -6.104894447104385e-24,
      4.450524684073228e-25, 6.336816887049133e-24, 1.1402812719570218e-23,
      1.5524356963561734e-23, 1.8631559071145646e-23, 2.070130013605233e-23,
      2.175356829897018e-23, 2.184645543029393e-23, 2.1070143017778402e-23,
      1.9540212907399634e-23, 1.7390612296569585e-23, 1.476658377220107e-23,
      1.1817842163241937e-23, 8.692242699675261e-24, 5.5301417126772e-24,
      2.459604161596481e-24, -4.07436157813505e-25, -2.978005731160344e-24,
      -5.179897239908268e-24, -6.962481253253283e-24, -8.296588986801758e-24,
      -9.173561604332104e-24, -9.603585014167044e-24, -9.61344560755583e-24,
      -9.243851936167998e-24, -8.546470232768438e-24, -7.580818478663713e-24,
      -6.411155136966382e-24, -5.1034855667219525e-24, -3.722792467453436e-24,
      -2.3305774811908166e-24, -9.82780306477015e-25, 2.7187967437058596e-25,
      1.3931152898258376e-24, 2.3498329529122013e-24, 3.1204576043348822e-24,
      3.692851119642013e-24, 4.063867156705665e-24, 4.238595529899749e-24,
      4.2293562284978754e-24, 4.0545071733533715e-24, 3.737130870071967e-24,
      3.303663511614083e-24, 2.7825261328694892e-24, 2.2028115091426767e-24,
      1.5930730441095073e-24, 9.802533540412934e-25, 3.8878106696811116e-25,
      -1.6014505677172365e-25, -6.490748199873412e-25, -1.0646269654712383e-24,
      -1.3976180185479125e-24, -1.64301325695456e-24, -1.7997191364121038e-24,
      -1.8702408517368683e-24, -1.8602317069126462e-24, -1.7779626181507745e-24,
      -1.6337404479834053e-24, -1.4393030760022779e-24
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.0848489536797884, -0.00898563424614993, 0.02450369740156759, 0.04299263075394747,
      0.05213793751453643, 0.05594003625196117, 0.05708182676417581, 0.057232234568875266,
      0.05730868393319544, 0.057697077309248015, 0.05843073167144939, 0.059331490866112065,
      0.06011720341730524, 0.060480165813867344, 0.06014116391861856, 0.05888353500913954,
      0.05657131805704417, 0.053155129122092484, 0.04866893905605689, 0.04322047263299798,
      0.036977510577026335, 0.0301519694320751, 0.022983264062773893, 0.01572212559338518,
      0.00861575353581647, 0.001894923375784935, -0.00423655187998018,
      -0.009609797760219892, -0.014096242927193749, -0.017610453866708942,
      -0.020110624946804174, -0.021596987821221096, -0.022108459725239178,
      -0.02171788464085377, -0.020526236701055613, -0.018656153796244763,
      -0.016245153500056973, -0.013438855603839969, -0.010384498249424714,
      -0.0072249903903626195, -0.004093694545957345, -0.001110082875044078,
      0.0016236413540575531, 0.004024913854234745, 0.006032173383668239,
      0.007605262716541412, 0.008724944001716098, 0.009391633857724551, 0.00962348435247368,
      0.00945394966974702, 0.008928984972672529, 0.008104024183297137, 0.007040877758968078,
      0.005804680872638347, 0.004461007621710437, 0.0030732489921333622,
      0.001700332307148414, 0.0003948387902876191, -0.0007984453889071658,
      -0.0018435297862659896, -0.002713776404231506, -0.0033920338804991337,
      -0.0038703851263510846, -0.004149556115393175, -0.004238042213229164,
      -0.004151014054666668, -0.003909067597559168, -0.0035368828015133282,
      -0.0030618526772839987, -0.0025127395822186656, -0.0019184090027801665,
      -0.0013066831009916292, -0.0007033474514723163, -0.00013133509484194325,
      0.0003898973079361083, 0.0008447954454165855, 0.001221938030742647,
      0.0015140821998666188, 0.001718039965936069, 0.0018344071171538555,
      0.0018671696632559555, 0.0018232153014732994, 0.0017117784255681406,
      0.0015438470282463522, 0.0013315585746913013, 0.0010876097107714346,
      0.0008247016929262455, 0.0005550398795956759, 0.0002899017017955549,
      3.928342417479897e-05, -0.00018836810271275468, -0.0003863364508629067,
      -0.0005497307905128857, -0.000675499881319671, -0.00076237226892959,
      -0.0008107322593879398, -0.0008224428360282027, -0.0008006276803750192,
      -0.0007494248791714051, -0.0006737247837107008, -0.0005789038922581324,
      -0.00047056562182412685, -0.0003542975014679821, -0.00023545274042506418,
      -0.00011896238677000038, -9.182479984710602e-06, 9.022120764013553e-05,
      0.00017634997956040397, 0.00024711131032849597, 0.0003012223773064934,
      0.0003381813682297005, 0.0003582108461603863, 0.0003621781347125508,
      0.0003514981057335997, 0.00032802391801965014, 0.00029393118730475703,
      0.00025160079035015386, 0.00020350505083988516, 0.00015210145726409226,
      9.973736049466478e-05, 4.856832925257619e-05, 4.9204198427235e-07,
      -4.290120175822436e-05, -8.036102760241071e-05, -0.00011099296608568635,
      -0.00013425885709526377, -0.0001499631865376007, -0.0001582272691649559,
      -0.00015945348278991446, -0.00015428193510728206, -0.00014354200936689797,
      -0.0001282011974941964, -0.0001093135004623451, -8.796946976635114e-05,
      -6.52496963914023e-05, -4.218324125083146e-05, -1.9712160391066734e-05,
      1.3370745011813906e-06, 2.027480952992676e-05, 3.65619785099217e-05,
      4.981659725935142e-05, 5.9813438219518566e-05, 6.647756525474224e-05,
      6.987258371829504e-05, 7.018458529755182e-05, 6.77028408441507e-05,
      6.279831941396838e-05, 5.5901091862909944e-05, 4.7477617742078065e-05,
      3.8008821141846304e-05, 2.7969741489776998e-05, 1.7811406419656683e-05,
      7.945423048496714e-06, -1.2683715752302288e-06, -9.53101386168163e-06,
      -1.661023001168307e-05, -2.234305780882742e-05, -2.6635483112250073e-05,
      -2.9459397358400978e-05, -3.084725789387118e-05, -3.088488605628445e-05,
      -2.9702868698854226e-05, -2.7467038287450226e-05, -2.4368496503343896e-05,
      -2.061361878155454e-05, -1.6414435179606183e-05, -1.1979729480871764e-05,
      -7.507136716981815e-06, -3.1764525798654886e-06, 8.557003990506781e-07,
      4.459772612767709e-06, 7.535739815947506e-06, 1.0014153246101518e-05,
      1.1855883247233628e-05, 1.3050694280235501e-05, 1.3614821726985574e-05,
      1.3587743527594097e-05, 1.3028352508876731e-05, 1.201073872215526e-05,
      1.0619785989033306e-05, 8.946774195605894e-06, 7.0851599143735835e-06,
      5.126684031969729e-06, 3.157927643868987e-06, 1.2574079678395566e-06,
      -5.067242074911099e-07, -2.0783537225631837e-06, -3.414433126524768e-06,
      -4.4853993204210435e-06, -5.275018557111181e-06, -5.779721813710679e-06,
      -6.0075065509767864e-06, -5.976490510693839e-06, -5.713208524022677e-06,
      -5.250744523456436e-06, -4.626788421699252e-06, -3.881701708732568e-06,
      -3.0566670734697236e-06, -2.1919866824428306e-06, -1.3255815734093348e-06,
      -4.917315727081732e-07, 2.7991817907384904e-07, 9.650710565388755e-07,
      1.5452123824248663e-06, 2.007772825439588e-06, 2.346041742415779e-06,
      2.5588583349137296e-06, 2.650114512017634e-06, 2.6281074493604795e-06,
      2.504782036139762e-06, 2.2949038058745496e-06, 2.015201712837634e-06,
      1.683517453247396e-06, 1.3179941830371215e-06, 9.363327196548271e-07,
      5.551379111641677e-07, 1.8937208726566588e-07, -1.4807336349657182e-07,
      -4.4668297706557906e-07, -6.984988240823393e-07, -8.981836641381818e-07,
      -1.0429747439901036e-06, -1.1325407550261287e-06, -1.168757053833584e-06,
      -1.1554159904453843e-06, -1.0978900961132366e-06, -1.0027660020827736e-06,
      -8.774663651552619e-07, -7.298758582327769e-07, -5.67985553324813e-07,
      -3.995678989742815e-07, -2.3189209603943592e-07, -7.148712631143429e-08,
      7.604289725851182e-08, 2.0614890655607721e-07, 3.154127835455622e-07,
      4.015713146066024e-07, 4.634923322605988e-07, 5.011086602330385e-07,
      5.153165898132085e-07, 5.078463538344656e-07, 4.811124367838978e-07,
      4.3805158672287053e-07, 3.8195610953602334e-07, 3.1630947030306007e-07,
      2.4463044864827664e-07, 1.703311471306677e-07, 9.659308802160109e-08,
      2.626450739555826e-08, -3.8219183186157124e-08, -9.489090196340401e-08,
      -1.4228353465250927e-07, -1.7943879343380746e-07, -2.0589517648382187e-07,
      -2.2165754630376646e-07, -2.2715132246608456e-07, -2.2316459713822465e-07,
      -2.1078163363799936e-07, -1.9131120907967348e-07, -1.6621312663107426e-07,
      -1.3702596969177643e-07, -1.0529882089951763e-07, -7.252924644149384e-08,
      -4.010937446347467e-08, -9.28139882089489e-09, 1.8896661878941335e-08,
      4.357460493281509e-08, 6.412318997418884e-08, 8.013730005200437e-08,
      9.142996958406434e-08, 9.801840763476732e-08, 1.0010334974265726e-07,
      9.804320377925915e-08, 9.232451694322724e-08, 8.35302864655667e-08,
      7.23075725711959e-08, 5.9335757050339024e-08, 4.5296633979540416e-08,
      3.0847330941471e-08, 1.6596850003408128e-08, 3.086798002472527e-09,
      -9.22334495935021e-09, -1.996628270741751e-08, -2.8872347115117128e-08,
      -3.577056602485449e-08, -4.058574096718367e-08, -4.333204001862886e-08,
      -4.410369891265252e-08, -4.3063479355398286e-08, -4.0429558323693836e-08,
      -3.646151799319056e-08, -3.144607585420737e-08, -2.56831422457738e-08,
      -1.9472722209707046e-08, -1.3103094765973411e-08, -6.840610055088025e-09,
      -9.213477969393561e-10, 4.455216578394366e-09, 9.13048513134017e-09,
      1.2988983262534726e-08, 1.595868808878687e-08, 1.8009613967907073e-08,
      1.9150881332484174e-08, 1.9426532585081016e-08, 1.8910382338576143e-08,
      1.7700199204393716e-08, 1.5911513579051857e-08, 1.3671331803584114e-08,
      1.111201333270392e-08, 8.365536030698168e-09, 5.558337411107243e-09,
      2.806878591161414e-09, 2.140349221351272e-10, -2.1336254587763888e-09,
      -4.1676548582297536e-09, -5.838648483943874e-09, -7.116326939234358e-09,
      -7.988857665032123e-09, -8.461516484527186e-09, -8.554806492176988e-09,
      -8.302161426051864e-09, -7.747364586087107e-09, -6.941812740586528e-09,
      -5.9417479053158764e-09, -4.805569124902498e-09, -3.591322268916484e-09,
      -2.3544492596731047e-09, -1.1458599712159428e-09, -1.037114954387006e-11,
      1.0144620837511871e-09, 1.899114538896853e-09, 2.6224679705638226e-09,
      3.1718202255283397e-09, 3.542562146660267e-09, 3.737567451075368e-09,
      3.7663476779228865e-09, 3.6440284551558054e-09, 3.390204867624261e-09,
      3.0277328169398586e-09, 2.5815102190764837e-09, 2.077297019013636e-09,
      1.5406166827260007e-09, 9.95774446318389e-10, 4.6501955450252644e-10,
      -3.212961199758265e-11, -4.793868822026256e-10, -8.640233483022569e-10,
      -1.1770205725327257e-09, -1.4130627241939846e-09, -1.5703837108698227e-09,
      -1.6504895056691837e-09, -1.6577788099779996e-09, -1.5990869305219192e-09,
      -1.4831783392264595e-09, -1.3202129136525203e-09, -1.121209446932882e-09,
      -8.975278163683234e-10, -6.603883731276681e-10, -4.204438344473123e-10,
      -1.8741539795950708e-10, 3.019887701784244e-11, 2.253390084882341e-10,
      3.925203889030695e-10, 5.27895629171173e-10, 6.292458948839591e-10,
      6.959089723315906e-10, 7.286530849707021e-10, 7.295067345318662e-10,
      7.015555673693226e-10, 6.487174889147531e-10, 5.755070077627188e-10,
      4.867991408341045e-10, 3.8760221780998406e-10, 2.828476592732681e-10,
      1.772033449525817e-10, 7.491561254008014e-11, -2.0316692672191255e-11,
      -1.0543429350101496e-10, -1.7807537015653478e-10, -2.366003277774784e-10,
      -2.80085706786773e-10, -3.082904940104333e-10, -3.2159886044434937e-10,
      -3.209438858791743e-10, -3.077171331164053e-10, -2.8366901599134683e-10,
      -2.508047842731939e-10, -2.1128064932794162e-10, -1.6730412639964463e-10,
      -1.2104210468788614e-10, -7.453950871548898e-11, -2.965071740935654e-11,
      1.2014806866181617e-11, 4.913192858820593e-11, 8.06842003768888e-11,
      1.059736881578313e-10, 1.2461729516196271e-10, 1.3653105005983268e-10,
      1.4190415506677208e-10, 1.4116481736079614e-10, 1.3494001274712388e-10,
      1.2401135920542982e-10, 1.092692181153318e-10, 9.166700358864266e-11,
      7.217747843480461e-11, 5.175256311002778e-11, 3.1287896396710177e-11,
      1.1593078316218736e-11, -6.631788950339184e-12, -2.2812954546686616e-11,
      -3.6513249398203635e-11, -4.7435938667491225e-11, -5.542266837623995e-11,
      -6.044616469538656e-11, -6.25984865885006e-11, -6.207572924549966e-11,
      -5.916012769958535e-11, -5.420051951577813e-11, -4.7592096253871794e-11,
      -3.975631047453849e-11, -3.112171415346142e-11, -2.2106391809483315e-11,
      -1.310252398848948e-11, -4.463480478829578e-12, 3.50629602722934e-12,
      1.0558490474719497e-11, 1.6505201896861333e-11, 2.1220432045954778e-11,
      2.4638991254650037e-11, 2.6753117229471794e-11, 2.7607163599278243e-11,
      2.7290756135401786e-11, 2.5930835968478385e-11, 2.36830119320647e-11,
      2.0722630074231582e-11, 1.7235939602530515e-11, 1.3411693634530833e-11,
      9.433472910743368e-12, 5.472963978021155e-12, 1.6843631290253485e-12,
      -1.799983692366171e-12, -4.8726542506909865e-12, -7.452941500238111e-12,
      -9.487418038385824e-12, -1.0949371325415807e-11, -1.1837242358764146e-11,
      -1.217222674612891e-11, -1.199521455234726e-11, -1.1363254076509909e-11,
      -1.0345725348625737e-11, -9.020402391406491e-12, -7.469570159433536e-12,
      -5.776343687138349e-12, -4.021314585613663e-12, -2.279624900123931e-12,
      -6.185417323033631e-13, 9.044208642721886e-13, 2.2428123021721847e-12,
      3.361992125822736e-12, 4.239338669446124e-12, 4.863964115550793e-12,
      5.235995452090993e-12, 5.365492097762684e-12, 5.271078347526025e-12,
      4.978372374046265e-12, 4.518293535822932e-12, 3.925326537781009e-12,
      3.235815006171127e-12, 2.4863487841727123e-12, 1.7122992748203769e-12,
      9.465460153505096e-13, 2.184259142132972e-13, -4.470752587675024e-13,
      -1.0298809924988354e-12, -1.5151342823142017e-12, -1.8932720353190406e-12,
      -2.159883772085302e-12, -2.3153812860395574e-12, -2.3645107568632727e-12,
      -2.3157419362441632e-12, -2.180570478013893e-12, -1.9727693760277545e-12,
      -1.707623959183634e-12, -1.4011821707988162e-12, -1.0695481545165376e-12,
      -7.282427230063577e-13, -3.916493464574858e-13, -7.255910796137533e-14,
      2.181771388145268e-13, 4.71886200425543e-13, 6.822010145837294e-13,
      8.450857607458076e-13, 9.58766731563752e-13, 1.0235809045247487e-12,
      1.0417562255190413e-12, 1.0171389341257524e-12, 9.54883845990416e-13,
      8.61123409372537e-13, 7.426306415282544e-13, 6.064898140410922e-13,
      4.597870945716087e-13, 3.09331372763525e-13, 1.6141330927644626e-13,
      2.160835573322735e-14, -1.0537280000343556e-13, -2.157851138690198e-13,
      -3.069021801601337e-13, -3.7702393793202506e-13, -4.254432155281919e-13,
      -4.5237645651897023e-13, -4.588648579011804e-13, -4.4665270685691193e-13,
      -4.180499363039873e-13, -3.7578585413090826e-13, -3.228606682400978e-13,
      -2.62400868584088e-13, -1.9752378267230709e-13, -1.3121573984567321e-13,
      -6.622731000383036e-14, -4.988071249717529e-15, 5.045764802941046e-14,
      9.849357429580124e-14, 1.3795325426414306e-13, 1.6812198157908614e-13,
      1.8872074936863648e-13, 1.998746185522197e-13, 2.0206827158989492e-13,
      1.9609175497232143e-13, 1.8297950627160463e-13, 1.6394572315894355e-13,
      1.4031897676539744e-13, 1.1347871762706779e-13, 8.479598891472556e-14,
      5.558026959906183e-14, 2.7033940804326968e-14, 2.1542241415896957e-16,
      -2.398841677695365e-14, -4.4880396189814214e-14, -6.196191837503136e-14,
      -7.4933175510265e-14, -8.368550917769512e-14, -8.828699172371584e-14,
      -8.89624598828467e-14, -8.606932939217644e-14, -8.007055546399064e-14,
      -7.15060828544958e-14, -6.096405729940423e-14, -4.90529550884845e-14,
      -3.6375638257585156e-14, -2.3506168520366998e-14, -1.097002295900919e-14,
      7.718423317843504e-16, 1.1334829593401744e-14, 2.0418372627987856e-14,
      2.7809551096946173e-14, 3.338290060499227e-14, 3.709679814298772e-14,
      3.898690016726976e-14, 3.915717995021016e-14, 3.776915188834918e-14,
      3.502988435301469e-14, 3.11793915225353e-14, 2.6477961333437342e-14,
      2.1193924708601676e-14, 1.5592304436615756e-14, 9.924704565858863e-15,
      4.420717040086969e-15, -7.189644999156638e-16, -5.327619613490773e-15,
      -9.275742019072507e-15, -1.2472498395886352e-14, -1.4865521909624052e-14,
      -1.643921147438124e-14, -1.7211749866643355e-14, -1.7231083401840788e-14,
      -1.6570123028297027e-14, -1.5321431930073153e-14, -1.3591659017799302e-14,
      -1.1495962320928214e-14, -9.152642825106298e-15, -6.678179441230277e-15,
      -4.182821348504567e-15, -1.7668567272098568e-15, 4.82361374272626e-16,
      2.4925890004245522e-15, 4.2080577528481685e-15, 5.590058941417804e-15,
      6.616798943031258e-15, 7.282602746920453e-15, 7.596560798517044e-15,
      7.580726868642087e-15, 7.267981814394544e-15, 6.699680016993261e-15,
      5.92319241508049e-15, 4.989452980577749e-15, 3.950604897770059e-15,
      2.8578293654861752e-15, 1.7594246416910421e-15, 6.991864835940685e-16,
      -2.848757331928007e-16, -1.1614695022170553e-15, -1.906594212296975e-15,
      -2.503772841131727e-15, -2.9439647763100524e-15, -3.225194385450904e-15,
      -3.351937762010345e-15, -3.3343154443204852e-15, -3.1871418692767775e-15,
      -2.9288829975202562e-15, -2.5805721312129443e-15, -2.164730698858301e-15,
      -1.7043360109805284e-15, -1.221872032734944e-15, -7.384924253504442e-16,
      -2.733178270092148e-16, 1.5711809033423497e-16, 5.392665309695034e-16,
      8.628050480598831e-16, 1.1207283732775248e-15, 1.3092997620249646e-15,
      1.4278784130095386e-15, 1.4786418781717162e-15, 1.4662246630870673e-15,
      1.3972954439997911e-15, 1.2800955508257576e-15, 1.1239606750891479e-15,
      9.388462743657812e-16, 7.348749969154234e-16, 5.219217909636479e-16,
      3.0924934725111425e-16, 1.0520330462246104e-16, -8.302662683680817e-17,
      -2.4957666782068425e-16, -3.900101406060132e-16, -5.013525579428924e-16,
      -5.8206571212534865e-16, -6.319677508645784e-16, -6.521076697617106e-16,
      -6.44603621304083e-16, -6.124549454631986e-16, -5.593378927451676e-16,
      -4.893946773226257e-16, -4.070248178063327e-16, -3.166867569957179e-16,
      -2.2271656561002606e-16, -1.291691967827315e-16, -3.968633554413153e-17,
      4.260655512284371e-17, 1.1517279402829868e-16, 1.7610676348503955e-16,
      2.2414720985555953e-16, 2.586638739742788e-16, 2.7962058646299835e-16,
      2.8751858291439016e-16, 2.8332420539962216e-16, 2.683853639528432e-16,
      2.443411464211172e-16, 2.1302880558821344e-16, 1.7639204210364696e-16,
      1.3639406745378583e-16, 9.493840221882777e-17, 5.379977125751296e-17,
      1.456682894071368e-17, -2.1402187723605167e-17, -5.301039659564681e-17,
      -7.943989209364946e-17, -1.0015665972737657e-16, -1.1490383289226326e-16,
      -1.2368469767157898e-16, -1.2673711752556845e-16, -1.24501224024053e-16,
      -1.1758230432534195e-16, -1.0671081636759615e-16, -9.270138695249427e-17,
      -7.641250648747845e-17, -5.870843909867794e-17, -4.042463105795528e-17,
      -2.233763724915047e-17, -5.1403077785540415e-18, 1.057730284828764e-17,
      2.4341112094004534e-17, 3.580033103795339e-17, 4.4729215705228357e-17,
      5.102372396630184e-17, 5.469370792206771e-17, 5.585138584798102e-17,
      5.4696911469015935e-17, 5.1501892630284277e-17, 4.659170882047432e-17,
      4.032744120877512e-17, 3.308816452623313e-17, 2.525426258314202e-17,
      1.7192324181762712e-17, 9.242059504636747e-18, 1.705554465931744e-18,
      -5.160942588332367e-18, -1.1152626159303178e-17, -1.6119165263335412e-17,
      -1.996529385847249e-17, -2.2649175565356528e-17, -2.417882476462695e-17,
      -2.4606915084149686e-17, -2.402433740237103e-17, -2.2552883306606883e-17,
      -2.0337427605530486e-17, -1.7537966675478274e-17, -1.432184019897866e-17,
      -1.0856424594604087e-17, -7.302539667366798e-18, -3.8087583044155375e-18,
      -5.067549200532112e-19, 2.4922258157953828e-18, 5.0997505130572834e-18,
      7.251447555240053e-18, 8.907187947314801e-18, 1.0050294021320575e-17,
      1.0685902240377269e-17, 1.083862729788579e-17, 1.0549687819772003e-17,
      9.873659494833062e-18, 8.87501990712291e-18, 7.62464147730043e-18,
      6.196375664457459e-18, 4.663853985068484e-18, 3.097610588535149e-18,
      1.562608224104462e-18, 1.1622554768172952e-19, -1.193260114331107e-18,
      -2.3276832706677193e-18, -3.2595038199003855e-18, -3.9718520426500575e-18,
      -4.458149090739485e-18, -4.721359436261756e-18, -4.772940710867301e-18,
      -4.631561879746246e-18, -4.3216628764607124e-18, -3.871927914025287e-18,
      -3.3137410227764746e-18, -2.6796863602848783e-18, -2.0021479582017373e-18,
      -1.312054309154936e-18, -6.37803053381227e-19, -4.390485292603015e-21,
      5.672398816862984e-19, 1.0606254708627839e-18, 1.4639945010391044e-18,
      1.7702706379341307e-18, 1.9768923267791064e-18, 2.0854720454412813e-18,
      2.1013245511983937e-18, 2.032895508434919e-18, 1.8911227365841977e-18,
      1.6887618170626468e-18, 1.439706096744381e-18, 1.1583284081188349e-18,
      8.588682990439274e-19, 5.548844460332134e-19, 2.5878743434435877e-19,
      -1.8536561073927456e-20, -2.680052689182368e-19, -4.825214559247091e-19,
      -6.570581915407616e-19, -7.886542630945348e-19, -8.763287102889896e-19,
      -9.209257549359425e-19, -9.249030393311467e-19, -8.920770555804054e-19,
      -8.273399757663975e-19, -7.363618289286947e-19, -6.252911836612306e-19,
      -5.004662668837282e-19, -3.681468715161768e-19, -2.3427557469173115e-19,
      -1.0427480064752982e-19, 1.7115787917723218e-20, 1.2595911256396185e-19,
      2.1919718333907995e-19, 2.946855095270442e-19, 3.51188179361661e-19,
      3.8833764945099804e-19, 4.065642788356138e-19, 4.070013413104675e-19,
      3.9137165426748158e-19, 3.6186208569707175e-19, 3.209920657739883e-19,
      2.7148186626249245e-19, 2.1612585640615936e-19, 1.5767523857146352e-19,
      9.873395321639333e-20, 4.167056338482242e-20, -1.1451975070638282e-20,
      -5.892764196002305e-20, -9.943960784050673e-20, -1.3207401140038066e-19,
      -1.56316524047151e-19, -1.720335205650016e-19, -1.7944010287340412e-19,
      -1.7905752173795861e-19, -1.7166270978066515e-19, -1.5823268432521995e-19,
      -1.3988651077541182e-19, -1.1782735008732426e-19, -9.328686375184531e-20,
      -6.747393452037006e-20, -4.152929965421387e-20, -1.6487304513449262e-20,
      6.754414171442377e-21, 2.745689736340333e-20, 4.5053436674722303e-20,
      5.915503807210829e-20, 6.9548354398364e-20, 7.618690474573569e-20,
      7.917658300528346e-20, 7.875658471787767e-20, 7.527695129639668e-20,
      6.917394658292275e-20, 6.094444721012576e-20, 5.112045150209844e-20,
      4.024469892704756e-20, 2.884825136058496e-20, 1.7430726917229824e-20,
      6.443705109731702e-21, -3.722353502810124e-21, -1.2747501950664739e-20,
      -2.0388006403549144e-20, -2.6478487660798464e-20, -3.0930768288597663e-20,
      -3.372979301922534e-20, -3.4927069298517395e-20, -3.463212879106999e-20,
      -3.300253958438061e-20, -3.0233004078577845e-20, -2.6544061217882906e-20,
      -2.2170876566803183e-20, -1.7352552983361123e-20, -1.2322331817130991e-20,
      -7.298983315908438e-21, -2.4796088899261737e-21, 1.965999481173701e-21,
      5.8993729300463015e-21, 9.215753580561331e-21, 1.184492163331758e-20,
      1.3750581758277884e-20, 1.4928473869173016e-20, 1.5403407430326074e-20,
      1.5225441348789767e-20, 1.44654434244094e-20, 1.321026487255151e-20,
      1.1557757553105642e-20, 9.611845466965075e-21, 7.477839251506935e-21,
      5.25815437938779e-21, 3.0485621520807378e-21, 9.350689763525862e-22,
      -1.0085146640183277e-21, -2.7222872897213e-21, -4.1612543385511516e-21,
      -5.2956415722743884e-21, -6.110578591183697e-21, -6.605226527387015e-21,
      -6.791438626045038e-21, -6.692052137597395e-21, -6.338914832718418e-21,
      -5.770749794798843e-21, -5.030958373270258e-21, -4.165453846009984e-21,
      -3.2206080777350424e-21, -2.2413809639334616e-21, -1.2696884272311214e-21,
      -3.430498864275445e-22, 5.064588871210388e-22, 1.2529361692153277e-21,
      1.8770701633547485e-21, 2.366254752130113e-21, 2.714429918327384e-21,
      2.9216800489830584e-21, 2.9936296193540293e-21, 2.94067986783652e-21,
      2.7771320675320564e-21, 2.520243004184375e-21, 2.189256478148499e-21,
      1.804451306135197e-21, 1.3862416898686473e-21, 9.543602488438893e-22,
      5.271477963980463e-22, 1.209673805064614e-22, -2.5024649549253375e-22,
      -5.752989468257111e-22, -8.45907493407595e-22, -1.0567432815596108e-21,
      -1.205351986907333e-21, -1.2919692811473336e-21, -1.3192484407890826e-21,
      -1.2919194156833036e-21, -1.2163994841316293e-21, -1.1003755588183758e-21,
      -9.523773614229626e-22, -7.813591635512373e-22, -5.963057233272279e-22,
      -4.0587556565252107e-22, -2.1809199786069724e-22, -4.0089356679023e-23,
      1.2208092528211528e-22, 2.6358264921973293e-22, 3.8086639163722143e-22,
      4.716833867868093e-22, 5.35046843212653e-22, 5.711473589477214e-22,
      5.812302552236892e-22, 5.674433829821312e-22, 5.326642822789106e-22,
      4.803155189928986e-22, 4.1417662559082523e-22, 3.382003821677825e-22,
      2.5634024641089966e-22, 1.7239463622653545e-22, 8.987254737556271e-23,
      1.1883710058317822e-23, -5.894479111163859e-23, -1.2052473942498722e-22,
      -1.713362935006957e-22, -2.104322311083311e-22, -2.3741923337740932e-22,
      -2.5241919196596197e-22, -2.5601401654414136e-22, -2.4917772943022606e-22,
      -2.3319976433595704e-22, -2.0960334935647811e-22, -1.8006266835575012e-22,
      -1.4632218166336768e-22, -1.1012107129213154e-22, -7.312528409716124e-23,
      -3.686910523061682e-23, -2.707630023474632e-24, 2.821906047387111e-23,
      5.500975460468159e-23, 7.701422741608767e-23, 9.383429118988155e-23,
      1.0531482029229875e-22, 1.1152608432961949e-22, 1.1273893531673561e-22,
      1.093945247216111e-22, 1.0207027769341463e-22, 9.144383018943137e-23,
      7.825654807970275e-23, 6.327810540164116e-23, 4.727341275271288e-23,
      3.097296800875161e-23, 1.5047461943188315e-23, 8.722236783146608e-26,
      -1.3413167165837898e-23, -2.506497466136585e-23, -3.4590270893413816e-23,
      -4.182203393550189e-23, -4.6699876946106297e-23, -4.926199550975725e-23,
      -4.9634021344525836e-23, -4.801552380827764e-23, -4.4664920723654386e-23,
      -3.9883548182821793e-23, -3.399959877922586e-23, -2.73525735016171e-23,
      -2.0278809190814033e-23, -1.3098546153479061e-23, -6.104894447166169e-24,
      4.450524682847114e-25, 6.336816886876448e-24, 1.1402812719359134e-23,
      1.5524356963324307e-23, 1.863155907089379e-23, 2.0701300135797364e-23,
      2.1753568298722453e-23, 2.18464554300625e-23, 2.1070143017570793e-23,
      1.9540212907221708e-23, 1.7390612296425473e-23, 1.476658377209317e-23,
      1.1817842163171002e-23, 8.692242699640511e-24, 5.530141712676508e-24,
      2.4596041616265884e-24, -4.0743615775675434e-25, -2.9780057310817507e-24,
      -5.179897239813028e-24, -6.962481253146745e-24, -8.296588986689196e-24,
      -9.173561604218522e-24, -9.603585014057004e-24, -9.613445607453315e-24,
      -9.243851936076303e-24, -8.546470232690108e-24, -7.58081847860052e-24,
      -6.4111551369193346e-24, -5.1034855666913264e-24, -3.722792467438839e-24,
      -2.3305774811912632e-24, -9.827803064910277e-25, 2.7187967434487275e-25,
      1.3931152897905674e-24, 2.3498329528696855e-24, 3.120457604287493e-24,
      3.692851119592086e-24, 4.063867156655408e-24, 4.238595529851175e-24,
      4.2293562284527364e-24, 4.054507173313119e-24, 3.737130870037722e-24,
      3.3036635115866236e-24, 2.78252613284925e-24, 2.202811509129765e-24,
      1.5930730441037309e-24, 9.802533540421963e-25, 3.887810669750183e-25,
      -1.601450567596595e-25, -6.490748199710893e-25, -1.0646269654518399e-24,
      -1.3976180185264326e-24, -1.6430132569320427e-24, -1.799719136389534e-24,
      -1.8702408517151386e-24, -1.8602317068925306e-24, -1.7779626181329088e-24,
      -1.6337404479682763e-24, -1.4393030759902177e-24
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_5_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<5>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 0.04493500288611121), "design.b()[0] == 0.04493500288611121");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.04493500288611121));
    static_assert(almost_equal(design.b()[1], -0.12375261544691259), "design.b()[1] == -0.12375261544691259");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.12375261544691259));
    static_assert(almost_equal(design.b()[2], 0.07936799518678392), "design.b()[2] == 0.07936799518678392");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.07936799518678392));
    static_assert(almost_equal(design.b()[3], 0.0793679951867839), "design.b()[3] == 0.0793679951867839");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.0793679951867839));
    static_assert(almost_equal(design.b()[4], -0.12375261544691259), "design.b()[4] == -0.12375261544691259");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - -0.12375261544691259));
    static_assert(almost_equal(design.b()[5], 0.04493500288611123), "design.b()[5] == 0.04493500288611123");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 0.04493500288611123));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -4.187884190178362), "design.a()[1] == -4.187884190178362");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -4.187884190178362));
    static_assert(almost_equal(design.a()[2], 7.071672985303492), "design.a()[2] == 7.071672985303492");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 7.071672985303492));
    static_assert(almost_equal(design.a()[3], -6.009088945312005), "design.a()[3] == -6.009088945312005");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -6.009088945312005));
    static_assert(almost_equal(design.a()[4], 2.566400928434811), "design.a()[4] == 2.566400928434811");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 2.566400928434811));
    static_assert(almost_equal(design.a()[5], -0.4400000129959702), "design.a()[5] == -0.4400000129959702");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.4400000129959702));
    std::cout << "max_deviation(cheby2,lowpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.04493500288611121, 0.06442997272545163, 0.031427613333078835, 0.025373931733500277,
      0.032108871627509486, 0.043236675058274374, 0.05417429331449272, 0.06277357336130521,
      0.06835888737219425, 0.0710683287516955, 0.07141739993735452, 0.07002498678614044,
      0.06745600700114157, 0.06414573280883556, 0.06037883595204874, 0.0563025384426567,
      0.05195837753495813, 0.04732129908871782, 0.04233824951132503, 0.03696124710592902,
      0.03117215162252926, 0.024998076268676894, 0.018517656616676495, 0.011859263913347726,
      0.005192785904343036, -0.0012831436074633752, -0.007356546194779794,
      -0.012818335910888212, -0.0174778356717723, -0.02117632551459977,
      -0.02379771730603454, -0.025275795360530345, -0.025597787023994845,
      -0.024804314796786034, -0.022986021002256787, -0.020277341357138295,
      -0.016848033271397153, -0.012893139884766674, -0.008622095925564531,
      -0.004247662530000314, 2.4677496345600763e-05, 0.004006316861492325,
      0.007533671179962299, 0.010474551720443329, 0.012732561031626503,
      0.014249429601108365, 0.015005324775219812, 0.015017263925956613, 0.01433584865984723,
      0.013040603226030227, 0.011234246812821494, 0.009036255787931012, 0.00657607875401265,
      0.003986356005332689, 0.0013964677176813954, -0.0010733053515817725,
      -0.0033167756990102396, -0.00524582234361533, -0.0067932300244772995,
      -0.007914342988987626, -0.008587541821565858, -0.008813606576040175,
      -0.008614077150528116, -0.008028760716338013, -0.007112564950549259,
      -0.005931854237615539, -0.0045605338395136134, -0.0030760647191176715,
      -0.0015556001050529601, -7.241523862391679e-05, 0.0013072244454079948,
      0.0025266424824545467, 0.003540697737790227, 0.004317053124738228,
      0.004836756661564899, 0.00509415759139663, 0.005096209590945259,
      0.0048612378431824865, 0.004417266128702975, 0.003800013591172484,
      0.003050678254407177, 0.0022136258091225106, 0.001334098013530684,
      0.00045604586491916534, -0.00037982071065109126, -0.001137691607329893,
      -0.001787967667190428, -0.002308188342235595, -0.0026835604655711803,
      -0.0029070923661613096, -0.0029793556027745537, -0.002907912294238377,
      -0.0027064588244415985, -0.002393746216400868, -0.0019923434953626647,
      -0.0015273128685337183, -0.0010248646762824505, -0.0005110561013261855,
      -1.059096658408143e-05, 0.0004542308874804474, 0.0008643766104650945,
      0.0012047291670626557, 0.0014645072866614692, 0.0016374535446302537,
      0.0017217985765152887, 0.0017200192545910485, 0.0016384169459033168,
      0.0014865484479232045, 0.001276546692041732, 0.0010223707506771245,
      0.0007390251150012905, 0.0004417867526301956, 0.0001454753122181083,
      -0.00013620271753228747, -0.00039121074913010606, -0.0006096210146615759,
      -0.0007839237668048784, -0.0009092017565398309, -0.0009831716053800153,
      -0.0010060997602451523, -0.0009806059936949057, -0.0009113717034403956,
      -0.0008047734443806772, -0.00066846412637978, -0.0005109251238004102,
      -0.00034101221638390246, -0.0001675169128456909, 1.2375626354662814e-06,
      0.00015774934424648312, 0.00029562732501327874, 0.0004098080294175592,
      0.0004966951143079608, 0.0005542206004675154, 0.0005818306401921627,
      0.0005804019314462972, 0.000552097671678302, 0.000500174112604636,
      0.0004287502747760772, 0.00034255418634646334, 0.0002466591366854581,
      0.00014622292550148328, 4.624201161161905e-05, -4.866908663904657e-05,
      -0.00013446470855613772, -0.0002078150295283647, -0.0002662091525830597,
      -0.0003080126900002831, -0.0003324804445464148, -0.0003397268429693812,
      -0.0003306585466528462, -0.0003068751029318389, -0.0002705445627487256,
      -0.0002242616538838259, -0.0001708963618684531, -0.00011344064959248009,
      -5.486057490763609e-05, 2.0397095552232374e-06, 5.473661065818729e-05,
      0.00010108414022220186, 0.00013938640103815507, 0.0001684439174229475,
      0.00018757354534093302, 0.0001966029443403153, 0.0001958417050674766,
      0.00018603216005310644, 0.00016828363122327631, 0.00014399436647229244,
      0.00011476568283463645, 8.231286985676574e-05, 4.837722856484674e-05,
      1.4643252706648876e-05, -1.7335569389831897e-05, -4.6199505867951284e-05,
      -7.083179501379664e-05, -9.0393011445008e-05, -0.00010434005946528423,
      -0.00011243002073913188, -0.00011470977105307848, -0.00011149287637028481,
      -0.00010332576063283924, -9.094549257709336e-05, -7.523175891131501e-05,
      -5.715567605975736e-05, -3.772804812310061e-05, -1.7949516157292973e-05,
      1.23522059329718e-06, 1.8977277604518316e-05, 3.4556125159661456e-05,
      4.740381253825309e-05, 5.7120350760272846e-05, 6.348017726267631e-05,
      6.643004595461153e-05, 6.607905987111341e-05, 6.268187709118769e-05,
      5.661636349122372e-05, 4.8357132071221104e-05, 3.844649583651302e-05,
      2.7464371184752985e-05, 1.5998606553587364e-05, 4.617084830157899e-06,
      -6.157231796434788e-06, -1.5867367017990017e-05, -2.4138807337401215e-05,
      -3.069095615401189e-05, -3.534339526827841e-05, -3.801703769164706e-05,
      -3.873048705691615e-05, -3.759211896864174e-05, -3.47885612785003e-05,
      -3.057036877586832e-05, -2.5235760755745317e-05, -1.9113317260410697e-05,
      -1.2544513512626526e-05, -5.866916072582131e-06, 6.012259724004018e-07,
      6.574379271117039e-06, 1.1810636310424972e-05, 1.6119809885203436e-05,
      1.9368538989655454e-05, 2.1482384588677564e-05, 2.244503520226876e-05,
      2.229486792000903e-05, 2.1119215654518493e-05, 1.9046772732565632e-05,
      1.6238626257440386e-05, 1.2878429358328182e-05, 9.162235062996762e-06,
      5.288487849141036e-06, 1.4486267097442067e-06, -2.181307626949796e-06,
      -5.4477437093962424e-06, -8.225095366440263e-06, -1.0419578585150734e-05,
      -1.1971274531579576e-05, -1.2854469459379644e-05, -1.3076380126318506e-05,
      -1.2674440541774461e-05, -1.1712380046100932e-05, -1.0275362297467423e-05,
      -8.464478928323234e-06, -6.390900418852988e-06, -4.169980822414512e-06,
      -1.915593704056513e-06, 2.650541215011819e-07, 2.2759244806485977e-06,
      4.035805515978329e-06, 5.481016084568026e-06, 6.567100004237459e-06,
      7.2695043340283505e-06, 7.58328351988706e-06, 7.521913496580101e-06,
      7.115335136683815e-06, 6.407373638802632e-06, 5.452698870356329e-06,
      4.3135011028121016e-06, 3.056057211042096e-06, 1.7473548587038386e-06,
      4.5192740001344087e-07, -7.709685945375973e-07, -1.8697267316799504e-06,
      -2.8022372126506906e-06, -3.537158498728389e-06, -4.054596615263419e-06,
      -4.34620329061258e-06, -4.414730332118255e-06, -4.273100216222149e-06,
      -3.943071026791236e-06, -3.4535870897768575e-06, -2.838914666114029e-06,
      -2.1366648812860085e-06, -1.385803933586312e-06, -6.247439907444512e-07,
      1.1040231082758502e-07, 7.873344415706751e-07, 1.3787901390602886e-06,
      1.8634488387137796e-06, 2.2264936841099476e-06, 2.459830645884247e-06,
      2.56197932293736e-06, 2.537664208503478e-06, 2.397147048571039e-06,
      2.1553500213326786e-06, 1.8308255988318222e-06, 1.4446320450742727e-06,
      1.0191736342721476e-06, 5.770620465683478e-07, 1.4005033761194816e-07,
      -2.7191620623482476e-07, -6.414966480494138e-07, -9.545724047429633e-07,
      -1.2006708434520382e-06, -1.3731888175054718e-06, -1.4694201970556892e-06,
      -1.4904002675381086e-06, -1.4405874520931703e-06, -1.3274088986579448e-06,
      -1.1607008839742654e-06, -9.520776410110354e-07, -7.142631167704829e-07,
      -4.6041939891948913e-07, -2.0350326839380154e-07, 4.432124366262649e-08,
      2.7219103249934973e-07, 4.709549319830673e-07, 6.334754733436648e-07,
      7.548152526633458e-07, 8.323075762267842e-07, 8.655164558319186e-07,
      8.560958032467266e-07, 8.075616473284819e-07, 7.249942421246641e-07,
      6.146889751359053e-07, 4.837759994672901e-07, 3.3982852877269633e-07,
      1.904788211629999e-07, 4.305914703061695e-08, -9.571737438815697e-08,
      -2.2002411288366338e-07, -3.2512775510586224e-07, -4.0752937764122836e-07,
      -4.650379557835594e-07, -4.96777769688609e-07, -5.031341366940512e-07,
      -4.856444455723006e-07, -4.468435073074578e-07, -3.900737095715087e-07,
      -3.192713408552609e-07, -2.387407372146623e-07, -1.529276292123446e-07,
      -6.62022822758742e-08, 1.7338196431040445e-08, 9.404057924018866e-08,
      1.608332792583237e-07, 2.153271280871865e-07, 2.5587715600717987e-07,
      2.8160531878501786e-07, 2.92385934608202e-07, 2.8879720065073507e-07,
      2.7204349218822185e-07, 2.4385416570823556e-07, 2.0636526649634208e-07,
      1.6199087366966872e-07, 1.1329081114591038e-07, 6.284113611644352e-08,
      1.3113224528921503e-08, -3.3633546734680184e-08, -7.544151432113227e-08,
      -1.1072394040748201e-07, -1.3831198548449038e-07, -1.5747886431186203e-07,
      -1.6794170973259447e-07, -1.6984266734920419e-07, -1.6371159950168444e-07,
      -1.504134600994445e-07, -1.31083893337158e-07, -1.070569001594272e-07,
      -7.978850750033367e-08, -5.0780276991620125e-08, -2.1506220260866836e-08,
      6.653727976286711e-09, 3.247106018799911e-08, 5.4914866473561645e-08,
      7.318548631052566e-08, 8.673498130582678e-08, 9.527442892950341e-08,
      9.876864980887374e-08, 9.741952105229877e-08, 9.163947540924793e-08,
      8.201712674677314e-08, 6.927718819808142e-08, 5.4236958206495903e-08,
      3.776164493597834e-08, 2.072068957253011e-08, 3.947046605578844e-09,
      -1.1798899657086649e-08, -2.585943984548782e-08, -3.770269790441655e-08,
      -4.69382681987393e-08, -5.332514757540596e-08, -5.67721500320757e-08,
      -5.733132752226921e-08, -5.518520771908524e-08, -5.0628888417997406e-08,
      -4.40481922653799e-08, -3.589518171249665e-08, -2.6662362937572584e-08,
      -1.6856872475119232e-08, -6.975847679089154e-09, 2.515959610664371e-09,
      1.1205447592923206e-08, 1.874663716644831e-08, 2.487190731267502e-08,
      2.93987769068116e-08, 3.223223929666438e-08, 3.3362862250611434e-08,
      3.28610473624647e-08, 3.0867993064477296e-08, 2.758401933402626e-08,
      2.325498729731367e-08, 1.81575825458961e-08, 1.2584228286149536e-08,
      6.828356329308789e-09, 1.1706947293824658e-09, -4.132863950589633e-09,
      -8.861363958582967e-09, -1.2836534331351121e-08, -1.5927993308824543e-08,
      -1.8055850931233036e-08, -1.9190776711122776e-08, -1.9351712272821452e-08,
      -1.86015053310121e-08, -1.704081804623106e-08, -1.4800717515275282e-08,
      -1.203438796978454e-08, -8.908413341674481e-09, -5.594066428566211e-09,
      -2.2590090866911753e-09, 9.402404292644781e-10, 3.864778233204794e-09,
      6.398499577756826e-09, 8.451849482193483e-09, 9.964068432861475e-09,
      1.090393743524324e-08, 1.1269096142149027e-08, 1.1084068786572103e-08,
      1.0397182984327031e-08, 9.27660457120139e-09, 7.805736614598159e-09,
      6.078242377274345e-09, 4.192950732904767e-09, 2.2488893318012584e-09,
      3.4066716479115583e-10, -1.4456040721808875e-09, -3.035699131235154e-09,
      -4.3698711312866035e-09, -5.404583328195494e-09, -6.113362347143221e-09,
      -6.486796652759441e-09, -6.531742047526928e-09, -6.269828386862804e-09,
      -5.735387379667863e-09, -4.972939597398988e-09, -4.034389330558608e-09,
      -2.9760787788688953e-09, -1.855848661666255e-09, -7.302414160138244e-10,
      3.4803331002978693e-10, 1.3322719974208285e-09, 2.183514485070413e-09,
      2.8717958265026967e-09, 3.3768896314668246e-09, 3.6885450580035933e-09,
      3.806243000652641e-09, 3.738517525033699e-09, 3.5019054824768224e-09,
      3.1195999773894173e-09, 2.6198916617419453e-09, 2.034485629946745e-09,
      1.3967811320439965e-09, 7.40196753715602e-10, 9.661563045929803e-11,
      -5.049857005175064e-10, -1.0396743357134929e-09, -1.4874279799254708e-09,
      -1.8337110607583605e-09, -2.069754205630051e-09, -2.1925455095596015e-09,
      -2.2045548102231824e-09, -2.113223065365121e-09, -1.930257528878494e-09,
      -1.6707795103531147e-09, -1.3523749770552091e-09, -9.940991444342688e-10,
      -6.154846469130511e-10, -2.355991334465923e-10, 1.2780747533701243e-10,
      4.590329046838279e-10, 7.450045581221204e-10, 9.756972885035132e-10,
      1.1443793492494874e-09, 1.2476874998096214e-09, 1.2855401104001374e-09,
      1.2609040026678135e-09, 1.179436425400572e-09, 1.0490278233233332e-09,
      8.792738157557231e-10, 6.809060405557951e-10, 4.6521128951569697e-10,
      2.434667808601379e-10, 2.6416653762926048e-11, -1.7618895761288032e-10,
      -3.55975364068888e-10, -5.062332843280749e-10, -6.221104579384531e-10,
      -7.007031029338765e-10, -7.41050198905483e-10, -7.440378778623055e-10,
      -7.122248578665957e-10, -6.496027350055373e-10, -5.61306979654663e-10,
      -4.5329563020977533e-10, -3.320129519582228e-10, -2.040547807843574e-10,
      -7.58509858170783e-11, 4.662142505244809e-11, 1.5808343373730485e-10,
      2.5414899611348443e-10, 3.314644391132465e-10, 3.8778980493394655e-10,
      4.22022553052375e-10, 4.3416668045114375e-10, 4.252526365970397e-10,
      3.9721530868803157e-10, 3.527387763574309e-10, 2.950774515344225e-10,
      2.2786362252814858e-10, 1.5491132993033254e-10, 8.002595560164295e-11,
      6.827963058244693e-12, -6.140203952334445e-11, -1.2185125140888104e-10,
      -1.722716474290028e-10, -2.1104369201689363e-10, -2.372062387156886e-10,
      -2.5045366697239293e-10, -2.511027549899371e-10, -2.400330137343373e-10,
      -2.1860517181761579e-10, -1.8856317795731875e-10, -1.5192546635194107e-10,
      -1.1087131455037648e-10, -6.762793057457153e-11, -2.436346514602068e-11,
      1.6909505723050104e-11, 5.441629740240542e-11, 8.668543165626152e-11,
      1.1259514160121861e-10, 1.314002631374001e-10, 1.427396790882553e-10,
      1.4662537424588644e-10, 1.434149378867681e-10, 1.3376998711879386e-10,
      1.186034602670601e-10, 9.901903390561242e-11, 7.624604832574446e-11,
      5.157329060794227e-11, 2.628479573462998e-11, 1.6005041724805927e-12,
      -2.1375816342366175e-11, -4.1699488597441366e-11, -5.861734977818316e-11,
      -7.158893200002793e-11, -8.029622681046407e-11, -8.464240409147015e-11,
      -8.474034247573826e-11, -8.089224009033988e-11, -7.356189743627998e-11,
      -6.334148989311873e-11, -5.091477224095158e-11, -3.7018683188484826e-11,
      -2.2405250166518968e-11, -7.80554347784725e-12, 6.102792661049632e-12,
      1.8723181213127514e-11, 2.9561989316505485e-11, 3.824404048408301e-11,
      4.452150053629184e-11, 4.827620268360579e-11, 4.9515777418659385e-11,
      4.836421444463723e-11, 4.5047697391319913e-11, 3.9876711096533105e-11,
      3.322552230188994e-11, 2.5510177214317705e-11, 1.7166145760439734e-11,
      8.626677202702006e-12, 3.028218440000781e-13, -7.434072834411803e-12,
      -1.4266756643321599e-11, -1.994291718725791e-11, -2.428221912027674e-11,
      -2.7179489426235713e-11, -2.860417894497597e-11, -2.859639405353802e-11,
      -2.7259930618201744e-11, -2.4752850474426735e-11, -2.1276215911882934e-11,
      -1.7061638821384745e-11, -1.2358308843475556e-11, -7.420141106209211e-12,
      -2.4936323262312372e-12, 2.1930613927852798e-12, 6.439405584285958e-12,
      1.0079814361232089e-11, 1.2988823797356704e-11, 1.5084026775169032e-11,
      1.63267945174466e-11, 1.6720911079305228e-11, 1.6309334971357492e-11,
      1.5169373676165458e-11, 1.3406609959471527e-11, 1.114795242687437e-11,
      8.534196590777493e-12, 5.7124775744526505e-12, 2.8289730972256718e-12,
      2.2177854584796152e-14, -2.5829793395406057e-12, -4.879963049520951e-12,
      -6.7842551621394996e-12, -8.235693731338727e-12, -9.199510800093775e-12,
      -9.666114900882835e-12, -9.649718987142375e-12, -9.18596094072364e-12,
      -8.328700003431401e-12, -7.146197547159578e-12, -5.716904165920111e-12,
      -4.12507734368192e-12, -2.4564456346521214e-12, -7.941175385684755e-13,
      7.850924306140122e-13, 2.2137798320886383e-12, 3.4364039771015623e-12,
      4.411012975727224e-12, 5.110212578494158e-12, 5.52138838133078e-12,
      5.646224977163404e-12, 5.4995951703906945e-12, 5.107916372235849e-12,
      4.507089049352544e-12, 3.740143230863256e-12, 2.8547235508756965e-12,
      1.9005413875529483e-12, 9.269149063085993e-13, -1.9494994427497884e-14,
      -8.966617407212973e-13, -1.6688119677784967e-12, -2.3076368438369824e-12,
      -2.7930689561197004e-12, -3.1136200162631562e-12, -3.2662953994258584e-12,
      -3.2561200449092814e-12, -3.0953258179968384e-12, -2.8022625514234293e-12,
      -2.400103336459001e-12, -1.915419101831606e-12, -1.3766981763338632e-12,
      -8.12883622535546e-13, -2.5199504724708e-13, 2.8010714892072385e-13,
      7.607679267840644e-13, 1.1713592303811325e-12, 1.4978550968268397e-12,
      1.731151321278104e-12, 1.8671332628732214e-12, 1.9065068257005754e-12,
      1.85441757158441e-12, 1.7198909676602528e-12, 1.5151327028395735e-12,
      1.2547317003579463e-12, 9.548098985984757e-13, 6.321621644423154e-13,
      3.034270308839065e-13, -1.5675420358846067e-14, -3.110079541908777e-13,
      -5.705590286515459e-13, -7.848476361811535e-13, -9.471812863634833e-13,
      -1.0537657425263592e-12, -1.103672115674121e-12, -1.098673145050108e-12,
      -1.0429657210473383e-12, -9.428007624263498e-13, -8.060443418097836e-13,
      -6.416954238958001e-13, -4.593857661167512e-13, -2.688865157521253e-13,
      -7.964395471919576e-14, 9.963613272594674e-14, 2.613396605125788e-13,
      3.9921933711329095e-13, 5.08586365702362e-13, 5.864158591030746e-13,
      6.313672998967806e-13, 6.437252289442655e-13, 6.252686793127564e-13,
      5.790805697329468e-13, 5.093102528270183e-13, 4.2090363806384116e-13,
      3.193157754002721e-13, 2.1022052598061049e-13, 9.923102554845241e-14,
      -8.356845088081642e-15, -1.0778771958433543e-13, -1.9502876016244032e-13,
      -2.669049439524332e-13, -3.2118470713173297e-13, -3.56615550373966e-13,
      -3.7291156368602126e-13, -3.706969222479342e-13, -3.5141115890855493e-13,
      -3.171833765122437e-13, -2.706834897676692e-13, -2.1495906997119787e-13,
      -1.5326641606797124e-13, -8.890412123803146e-14, -2.5056691106541905e-14,
      3.5345243150224423e-14, 8.974281737571723e-14, 1.3604103361619814e-13,
      1.7267264733849763e-13, 1.9863291011327747e-13, 2.13485657251987e-13,
      2.1734252650844473e-13, 2.108182139306448e-13, 1.9496557697055707e-13,
      1.7119505660105637e-13, 1.4118329619620339e-13, 1.0677598489002492e-13,
      6.988985855754173e-14, 3.241847451269485e-14, -3.8541327072971224e-15,
      -3.7328470015527144e-14, -6.665060960647612e-14, -9.075739190459673e-14,
      -1.0890484884145701e-13, -1.2067973786954445e-13, -1.2599487009444909e-13,
      -1.2506961985738963e-13, -1.1839759173340637e-13, -1.0670387519231844e-13,
      -9.089462568450077e-14, -7.2001869846353e-14, -5.11264452841702e-14,
      -2.9381861951041174e-14, -7.841628052521733e-15, 1.2507761240751855e-14,
      3.08063959485379e-14, 4.635178203357167e-14, 5.862012883768211e-14,
      6.727779279140112e-14, 7.218305624262813e-14, 7.3378856586891e-14,
      7.107745711693277e-14, 6.563835399402732e-14, 5.754093468317225e-14,
      4.7353537743404476e-14, 3.570061200668144e-14, 2.3229638915427208e-14,
      1.0579372662831683e-14, -1.6492207306308973e-15, -1.2918169451980511e-14,
      -2.277295374268524e-14, -3.085760746979421e-14, -3.692414821591077e-14,
      -4.083630706891367e-14, -4.256779633921686e-14, -4.2195590123216575e-14,
      -3.9888890156255857e-14, -3.5894601403493376e-14, -3.052024454368754e-14,
      -2.4115284694674996e-14, -1.7051858631479678e-14, -9.705839782810647e-15,
      -2.4390967682562675e-15, 4.416316032263773e-15, 1.0571440515420724e-14,
      1.579073460573232e-14, 1.9899163926507334e-14, 2.2785968838177072e-14,
      2.440517180167396e-14, 2.4773036852991953e-14, 2.3962819357149527e-14,
      2.2097245747242635e-14, 1.9339236721318983e-14, 1.5881431942733228e-14,
      1.1935089704585738e-14, 7.718922664672732e-15, 3.448393213451056e-15,
      -6.740671321420035e-16, -4.467526399683256e-15, -7.779409979757487e-15,
      -1.0490545135362786e-14, -1.2518288652022832e-14, -1.3817730656402756e-14,
      -1.4381057559751834e-14, -1.423523666155352e-14, -1.3438251226592479e-14,
      -1.2074165704905273e-14, -1.0247334948362927e-14, -8.076088404783538e-15,
      -5.686220776009993e-15, -3.204605687001657e-15, -7.532203383285291e-16,
      1.556170782691946e-15, 3.626473604522463e-15, 5.378718376609579e-15,
      6.754421710773734e-15, 7.716825804165995e-15, 8.251038316049958e-15,
      8.36314577651303e-15, 8.078415856053594e-15, 7.438737849791838e-15,
      6.499475355659142e-15, 5.325919886349674e-15, 3.989539076292396e-15,
      2.56420870909473e-15, 1.1226048796663312e-15, -2.6708756931474396e-16,
      -1.5440201725531552e-15, -2.6569795152668718e-15, -3.566072062920661e-15,
      -4.243761155447287e-15, -4.675254741506888e-15, -4.8582727106149875e-15,
      -4.802249435278388e-15, -4.527049372742885e-15, -4.061290589063259e-15,
      -3.440382443370083e-15, -2.7043892857763005e-15, -1.8958320331922135e-15,
      -1.0575342975963294e-15, -2.306099677877177e-16, 5.473244263959398e-16,
      1.2436457038269265e-15, 1.831879896747324e-15, 2.2924888217577917e-15,
      2.6132774605214428e-15, 2.7894305939978823e-15, 2.823203757660491e-15,
      2.723307843247304e-15, 2.504038073203445e-15, 2.1842062934881677e-15,
      1.7859404164717185e-15, 1.333416411816724e-15, 8.515866564429614e-16,
      3.649640163365398e-16, -1.0348584470894581e-16, -5.333002555112767e-16,
      -9.072899674891352e-16, -1.2121017967067418e-15, -1.438562328437993e-15,
      -1.581802516612375e-15, -1.6411732072303788e-15, -1.6199706091112986e-15,
      -1.524998195906789e-15, -1.3659972141345811e-15, -1.15498175632048e-15,
      -9.055161979375268e-16, -6.31972746611643e-16, -3.488050508148625e-16,
      -6.987047315319379e-17, 1.9217098301235268e-16, 4.263586889047425e-16,
      6.238181651848915e-16, 7.780229590550044e-16, 8.84928469261288e-16,
      9.429807446317819e-16, 9.530088748954241e-16, 9.180143811562667e-16,
      8.428748330419795e-16, 7.339816626275003e-16, 5.988337619816454e-16,
      4.456089477745011e-16, 2.827348106161955e-16, 1.1847894168079506e-16,
      -3.9423815134415155e-17, -1.8409243263368333e-16, -3.097578986424472e-16,
      -4.119510811434203e-16, -4.876166062452e-16, -5.351527979722006e-16,
      -5.543811621814867e-16, -5.464519204536385e-16, -5.136946026168585e-16,
      -4.594246099084794e-16, -3.877179194684666e-16, -3.031667029362302e-16,
      -2.1062859681064866e-16, -1.1498173757488867e-16, -2.0896531987370808e-17,
      6.736643709184657e-17, 1.4612486259106394e-16, 2.1240412190910892e-16,
      2.6402444628534086e-16, 2.9964484893454394e-16, 3.187648923431216e-16,
      3.216872568654557e-16, 3.094456809391325e-16, 2.8370412285524724e-16,
      2.4663390931932103e-16, 2.0077617077996017e-16, 1.4889702030872422e-16,
      9.384273168633846e-17, 3.840164848161699e-17, -1.4821243044888794e-17,
      -6.351216141981868e-17, -1.0573505412809319e-16, -1.3999431627183497e-16,
      -1.652725072911734e-16, -1.8104311787100928e-16, -1.8725959513150724e-16,
      -1.8432285054915269e-16, -1.7303031461870942e-16, -1.5451023878414878e-16,
      -1.3014536371268737e-16, -1.014902698442514e-16, -7.018670817577228e-17,
      -3.7880992783350017e-17, -6.1471460387959106e-18, 2.358104643546753e-17,
      5.0066556138002265e-17, 7.231240509692487e-17, 8.959067498936647e-17,
      1.0145691496543541e-16, 1.0775033276942584e-16, 1.0858078681315808e-16,
      1.0430413690380504e-16, 9.548793997469766e-17, 8.28697825316377e-17,
      6.731071831677487e-17, 4.9746328973370344e-17, 3.113785418396978e-17,
      1.242565787390437e-17, -5.512975177566183e-18, -2.1900063270190528e-17,
      -3.608592022540848e-17, -4.757009084946279e-17, -5.601383804436564e-17,
      -6.124421115692178e-17, -6.325011434709066e-17, -6.217113537978439e-17,
      -5.828017685389856e-17, -5.1961144722289507e-17, -4.3683088098772286e-17,
      -3.3972248646739194e-17, -2.3383469714123108e-17, -1.2472340428858382e-17,
      -1.7693165065269126e-18, 8.24312202383129e-18, 1.714943368803639e-17,
      2.461549770029503e-17, 3.0398265730017197e-17, 3.435048344471605e-17,
      3.642061835277165e-17, 3.664834343656953e-17, 3.515610741036674e-17,
      3.2137466012200225e-17, 2.7842950598627035e-17, 2.2564308732488993e-17,
      1.6617966858148596e-17, 1.0328539935832628e-17, 4.013151162812556e-18,
      -2.032767848762651e-18, -7.547643288422656e-18, -1.2313473078024683e-17,
      -1.61628140567817e-17, -1.898291452552941e-17, -2.0717006181670893e-17,
      -2.1362900502571054e-17, -2.0969149457857294e-17, -1.9629124882846718e-17,
      -1.7473442006694128e-17, -1.4661198873776547e-17, -1.1370524374836143e-17,
      -7.78892416481348e-18, -4.1038878101088494e-18, -4.941749089622806e-19,
      2.8778637957548056e-18, 5.8726481083125886e-18, 8.378212277278221e-18,
      1.0313415534795863e-17, 1.1629487982213948e-17, 1.2309960163816043e-17,
      1.2369096310535122e-17, 1.1849012125675452e-17, 1.081570607070543e-17,
      9.354267080484506e-18, 7.56354093394266e-18, 5.550542290884295e-18,
      3.4248905036968982e-18, 1.2935261263512562e-18, -7.440665559913325e-19,
      -2.5999454445217326e-18, -4.200965001189027e-18, -5.491107850354965e-18,
      -6.432851858523184e-18, -7.007578791218842e-18, -7.215074755885529e-18,
      -7.072211230593602e-18, -6.6109271551008946e-18, -5.875656350197786e-18,
      -4.9203598970249616e-18, -3.805329944171614e-18, -2.5939300149779084e-18,
      -1.3494279198077793e-18, -1.320618017361244e-19, 1.003541139672008e-18,
      2.010498727186295e-18, 2.8512937799370803e-18, 3.498841803424715e-18,
      3.93699664479467e-18, 4.160511191678296e-18, 4.174494290839123e-18,
      3.993425506788784e-18, 3.6398054439979424e-18, 3.142530684201562e-18,
      2.5350887608617413e-18, 1.853670067933574e-18, 1.135290464599868e-18,
      4.1601107025761773e-19, -2.7066901908839333e-19, -8.951848680255977e-19,
      -1.4329958908441279e-18, -1.8653637760002666e-18, -2.1798045333659912e-18,
      -2.3702171823015483e-18, -2.4367064474114777e-18, -2.3851297982256004e-18,
      -2.22640979183995e-18, -1.9756606294201575e-18, -1.6511829416445198e-18,
      -1.273383043011612e-18, -8.636723449468051e-19
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.04493500288611121, 0.06442997272545163, 0.03142761333307888, 0.025373931733500398,
      0.03210887162750974, 0.04323667505827482, 0.05417429331449341, 0.06277357336130619,
      0.06835888737219556, 0.07106832875169712, 0.07141739993735637, 0.07002498678614234,
      0.06745600700114335, 0.06414573280883704, 0.06037883595204965, 0.0563025384426568,
      0.051958377534957176, 0.047321299088715636, 0.04233824951132156, 0.03696124710592442,
      0.0311721516225239, 0.02499807626867138, 0.018517656616671596, 0.011859263913344287,
      0.005192785904341857, -0.0012831436074616249, -0.007356546194774643,
      -0.012818335910879436, -0.01747783567175994, -0.021176325514584125,
      -0.023797717306016163, -0.025275795360509983, -0.02559778702397339,
      -0.02480431479676447, -0.02298602100223612, -0.02027734135711947,
      -0.016848033271381027, -0.012893139884753987, -0.00862209592555587,
      -0.004247662529996082, 2.467749634521587e-05, 0.004006316861487364,
      0.007533671179953033, 0.010474551720430244, 0.012732561031610263,
      0.014249429601089773, 0.015005324775199762, 0.015017263925936053,
      0.014335848659827089, 0.013040603226011357, 0.011234246812804638,
      0.009036255787916775, 0.006576078754001482, 0.003986356005324875,
      0.0013964677176770517, -0.0010733053515826938, -0.003316775699007938,
      -0.005245822343610139, -0.006793230024469664, -0.007914342988978071,
      -0.008587541821554969, -0.008813606576028567, -0.008614077150516406,
      -0.008028760716326798, -0.007112564950539086, -0.005931854237606882,
      -0.0045605338395068645, -0.0030760647191131183, -0.001555600105050779,
      -7.241523862416611e-05, 0.0013072244454053715, 0.0025266424824497173,
      0.003540697737783459, 0.004317053124729873, 0.00483675666155537, 0.005094157591386374,
      0.005096209590934739, 0.004861237843172157, 0.004417266128693258,
      0.0038000135911637465, 0.0030506782543997194, 0.0022136258091165558,
      0.0013340980135263761, 0.0004560458649165681, -0.0003798207106519914,
      -0.001137691607329181, -0.001787967667188253, -0.0023081883422321594,
      -0.0026835604655667316, -0.0029070923661561232, -0.0029793556027689237,
      -0.002907912294232605, -0.002706458824435982, -0.0023937462163956856,
      -0.001992343495358161, -0.001527312868530092, -0.0010248646762798463,
      -0.0005110561013246892, -1.0590966583719999e-05, 0.00045423088747970487,
      0.0008643766104633323, 0.0012047291670600042, 0.0014645072866580962,
      0.0016374535446263552, 0.0017217985765110775, 0.0017200192545867433,
      0.0016384169458991313, 0.0014865484479193347, 0.001276546692038348,
      0.0010223707506743654, 0.0007390251149992594, 0.00044178675262895585,
      0.000145475312217683, -0.00013620271753191478, -0.0003912107491289887,
      -0.0006096210146598, -0.0007839237668025578, -0.0009092017565370995,
      -0.00098317160537702, -0.0010060997602420452, -0.0009806059936918366,
      -0.0009113717034375037, -0.0008047734443780857, -0.0006684641263775918,
      -0.0005109251237987035, -0.00034101221638272805, -0.00016751691284507114,
      1.2375626355369582e-06, 0.00015774934424603632, 0.000295627325012369,
      0.0004098080294162598, 0.0004966951143063592, 0.0005542206004657082,
      0.0005818306401902497, 0.0005804019314443767, 0.0005520976716764667,
      0.0005001741126029684, 0.0004287502747746465, 0.00034255418634532254,
      0.0002466591366846422, 0.0001462229255010084, 4.624201161148298e-05,
      -4.866908663886281e-05, -0.0001344647085556674, -0.00020781502952765254,
      -0.0002662091525821587, -0.0003080126899992512, -0.00033248044454531166,
      -0.00033972684296826506, -0.00033065854665177116, -0.0003068751029308529,
      -0.00027054456274786876, -0.0002242616538831291, -0.00017089636186793695,
      -0.00011344064959215478, -5.486057490750165e-05, 2.039709555175913e-06,
      5.473661065797521e-05, 0.00010108414022184834, 0.00013938640103768808,
      0.000168443917422398, 0.0001875735453403333, 0.00019660294433969738,
      0.00019584170506687095, 0.00018603216005254084, 0.00016828363122277495,
      0.000143994366471875, 0.00011476568283431724, 8.231286985655334e-05,
      4.8377228564743996e-05, 1.4643252706653152e-05, -1.7335569389728125e-05,
      -4.619950586775972e-05, -7.083179501353229e-05, -9.039301144468821e-05,
      -0.00010434005946492767, -0.00011243002073875757, -0.00011470977105270503,
      -0.00011149287636992961, -0.00010332576063251782, -9.09454925768188e-05,
      -7.523175891109759e-05, -5.715567605960417e-05, -3.772804812301542e-05,
      -1.7949516157276205e-05, 1.235220593248284e-06, 1.8977277604409395e-05,
      3.455612515950062e-05, 4.740381253805042e-05, 5.7120350760039824e-05,
      6.348017726242522e-05, 6.643004595435489e-05, 6.607905987086336e-05,
      6.268187709095544e-05, 5.661636349101904e-05, 4.8357132071051826e-05,
      3.8446495836384786e-05, 2.7464371184669132e-05, 1.5998606553548902e-05,
      4.617084830163665e-06, -6.157231796387922e-06, -1.586736701790685e-05,
      -2.413880733728788e-05, -3.069095615387549e-05, -3.534339526812664e-05,
      -3.801703769148778e-05, -3.873048705675706e-05, -3.759211896848996e-05,
      -3.478856127836213e-05, -3.057036877574901e-05, -2.5235760755648914e-05,
      -1.911331726033997e-05, -1.254451351258296e-05, -5.866916072565943e-06,
      6.012259723902079e-07, 6.5743792710825535e-06, 1.1810636310369233e-05,
      1.611980988513025e-05, 1.9368538989569175e-05, 2.148238458858288e-05,
      2.2445035202170446e-05, 2.2294867919911705e-05, 2.1119215654426424e-05,
      1.9046772732482595e-05, 1.6238626257369564e-05, 1.2878429358272088e-05,
      9.162235062957166e-06, 5.288487849118914e-06, 1.4486267097397202e-06,
      -2.1813076269372793e-06, -5.447743709368092e-06, -8.225095366398489e-06,
      -1.0419578585097865e-05, -1.1971274531518527e-05, -1.2854469459313559e-05,
      -1.3076380126250594e-05, -1.2674440541707847e-05, -1.1712380046038521e-05,
      -1.0275362297411785e-05, -8.464478928276517e-06, -6.3909004188168385e-06,
      -4.16998082239003e-06, -1.915593704044225e-06, 2.650541215013283e-07,
      2.2759244806372046e-06, 4.0358055159564994e-06, 5.481016084537284e-06,
      6.5671000041996615e-06, 7.2695043339855855e-06, 7.583283519841535e-06,
      7.521913496534026e-06, 7.1153351366392954e-06, 6.407373638761577e-06,
      5.452698870320367e-06, 4.313501102782525e-06, 3.05605721101982e-06,
      1.7473548586893886e-06, 4.5192740000695233e-07, -7.709685945363637e-07,
      -1.8697267316715757e-06, -2.8022372126360514e-06, -3.5371584987085945e-06,
      -4.054596615239747e-06, -4.346203290586403e-06, -4.414730332090971e-06,
      -4.273100216195108e-06, -3.943071026765681e-06, -3.4535870897538813e-06,
      -2.8389146660945315e-06, -2.1366648812706704e-06, -1.3858039335755791e-06,
      -6.247439907385263e-07, 1.104023108287369e-07, 7.873344415673101e-07,
      1.3787901390528576e-06, 1.863448838702895e-06, 2.2264936840963442e-06,
      2.459830645868742e-06, 2.561979322920805e-06, 2.5376642084867158e-06,
      2.3971470485548653e-06, 2.155350021317807e-06, 1.830825598818856e-06,
      1.4446320450636842e-06, 1.019173634264265e-06, 5.770620465633505e-07,
      1.4005033760986898e-07, -2.71916206234091e-07, -6.414966480460958e-07,
      -9.545724047373936e-07, -1.200670843444631e-06, -1.3731888174966982e-06,
      -1.4694201970460517e-06, -1.4904002675281165e-06, -1.440587452083316e-06,
      -1.3274088986486814e-06, -1.1607008839659882e-06, -9.520776410040679e-07,
      -7.142631167650687e-07, -4.604193989157855e-07, -2.0350326839187814e-07,
      4.432124366278521e-08, 2.7219103249783863e-07, 4.7095493198005175e-07,
      6.334754733393689e-07, 7.548152526580389e-07, 8.323075762207667e-07,
      8.655164558255061e-07, 8.56095803240235e-07, 8.075616473222127e-07,
      7.249942421188916e-07, 6.146889751308659e-07, 4.837759994631743e-07,
      3.398285287696429e-07, 1.9047882116109122e-07, 4.305914702987818e-08,
      -9.571737438775644e-08, -2.2002411288220556e-07, -3.251277551034738e-07,
      -4.075293776380723e-07, -4.6503795577982483e-07, -4.967777696845004e-07,
      -5.03134136689778e-07, -4.85644445568067e-07, -4.4684350730345364e-07,
      -3.9007370956790177e-07, -3.1927134085219065e-07, -2.3874073721223486e-07,
      -1.5292762921062957e-07, -6.620228227490361e-08, 1.733819643127142e-08,
      9.404057923971908e-08, 1.608332792572228e-07, 2.153271280855485e-07,
      2.558771560051177e-07, 2.8160531878265675e-07, 2.9238593460567266e-07,
      2.8879720064816703e-07, 2.720434921857373e-07, 2.438541657059441e-07,
      2.0636526649433668e-07, 1.619908736680222e-07, 1.1329081114467363e-07,
      6.284113611564471e-08, 1.3113224528566517e-08, -3.363354673460641e-08,
      -7.544151432066353e-08, -1.107239404066679e-07, -1.38311985483393e-07,
      -1.5747886431055228e-07, -1.6794170973114824e-07, -1.698426673476984e-07,
      -1.6371159950019337e-07, -1.504134600980363e-07, -1.3108389333589207e-07,
      -1.0705690015835232e-07, -7.978850749948632e-08, -5.0780276991023735e-08,
      -2.1506220260531543e-08, 6.653727976363526e-09, 3.24710601878318e-08,
      5.4914866473174775e-08, 7.318548630995218e-08, 8.673498130510593e-08,
      9.527442892867843e-08, 9.876864980798964e-08, 9.741952105140016e-08,
      9.1639475408377e-08, 8.201712674596787e-08, 6.927718819737416e-08,
      5.423695820591227e-08, 3.7761644935536465e-08, 2.0720689572240273e-08,
      3.947046605443557e-09, -1.179889965707222e-08, -2.5859439845335107e-08,
      -3.7702697904142585e-08, -4.6938268198365533e-08, -5.332514757495693e-08,
      -5.67721500315777e-08, -5.7331327521748937e-08, -5.5185207718568566e-08,
      -5.062888841750826e-08, -4.4048192264939306e-08, -3.5895181712121926e-08,
      -2.6662362937276725e-08, -1.6856872474910584e-08, -6.975847678971327e-09,
      2.5159596106923198e-09, 1.1205447592866385e-08, 1.8746637166315444e-08,
      2.4871907312477773e-08, 2.93987769065638e-08, 3.223223929638121e-08,
      3.336286225030861e-08, 3.286104736215771e-08, 3.086799306418071e-08,
      2.7584019333753103e-08, 2.3254987297075006e-08, 1.8157582545700664e-08,
      1.2584228286003506e-08, 6.828356329215658e-09, 1.1706947293430606e-09,
      -4.132863950577019e-09, -8.861363958522331e-09, -1.2836534331248422e-08,
      -1.592799330868729e-08, -1.8055850931069854e-08, -1.919077671094291e-08,
      -1.935171227263431e-08, -1.8601505330826764e-08, -1.7040818046055896e-08,
      -1.4800717515117582e-08, -1.2034387969650252e-08, -8.90841334156803e-09,
      -5.5940664284904065e-09, -2.2590090866472073e-09, 9.402404292769727e-10,
      3.864778233187602e-09, 6.3984995777129725e-09, 8.451849482127001e-09,
      9.964068432777147e-09, 1.0903937435146338e-08, 1.1269096142045025e-08,
      1.108406878646641e-08, 1.0397182984224742e-08, 9.276604571107067e-09,
      7.805736614515656e-09, 6.078242377206687e-09, 4.19295073285407e-09,
      2.248889331768699e-09, 3.4066716477698126e-10, -1.4456040721773033e-09,
      -3.0356991312152183e-09, -4.369871131252383e-09, -5.404583328149576e-09,
      -6.113362347088561e-09, -6.486796652699191e-09, -6.531742047464282e-09,
      -6.2698283868008386e-09, -5.735387379609408e-09, -4.9729395973465145e-09,
      -4.03438933051414e-09, -2.976078778833952e-09, -1.8558486616418102e-09,
      -7.302414160003037e-10, 3.4803331003249057e-10, 1.332271997413314e-09,
      2.183514485053711e-09, 2.871795826478193e-09, 3.376889631436172e-09,
      3.688545057968617e-09, 3.806243000615245e-09, 3.7385175249957715e-09,
      3.5019054824401453e-09, 3.119599977355591e-09, 2.6198916617123264e-09,
      2.0344856299224024e-09, 1.396781132025684e-09, 7.401967537037452e-10,
      9.661563045399766e-11, -5.049857005164579e-10, -1.0396743357065814e-09,
      -1.4874279799134192e-09, -1.8337110607420799e-09, -2.0697542056105865e-09,
      -2.1925455095380733e-09, -2.204554810200727e-09, -2.1132230653428364e-09,
      -1.9302575288573934e-09, -1.6707795103340887e-09, -1.3523749770389935e-09,
      -9.940991444214224e-10, -6.154846469039424e-10, -2.3559913344139544e-10,
      1.2780747533831311e-10, 4.590329046814256e-10, 7.450045581163661e-10,
      9.756972884948898e-10, 1.1443793492385793e-09, 1.247687499797081e-09,
      1.2855401103866502e-09, 1.260904002654065e-09, 1.179436425387215e-09,
      1.0490278233109584e-09, 8.792738157448351e-10, 6.809060405467949e-10,
      4.6521128950887056e-10, 2.4346678085565053e-10, 2.6416653760822786e-11,
      -1.7618895761266864e-10, -3.5597536406653363e-10, -5.062332843238382e-10,
      -6.221104579326645e-10, -7.007031029269157e-10, -7.410501988977584e-10,
      -7.440378778542331e-10, -7.122248578585799e-10, -6.496027349979531e-10,
      -5.613069796478408e-10, -4.5329563020398827e-10, -3.3201295195367734e-10,
      -2.0405478078118749e-10, -7.585098581534407e-11, 4.662142505275818e-11,
      1.580834337362686e-10, 2.541489961112378e-10, 3.314644391099734e-10,
      3.877898049298668e-10, 4.220225530477318e-10, 4.341666804461908e-10,
      4.252526365920279e-10, 3.972153086831975e-10, 3.5273877635298674e-10,
      2.9507745153054815e-10, 2.2786362252498534e-10, 1.5491132992797947e-10,
      8.002595560015529e-11, 6.827963057634182e-12, -6.140203952310726e-11,
      -1.2185125140786268e-10, -1.7227164742730133e-10, -2.1104369201463196e-10,
      -2.372062387130072e-10, -2.50453666969442e-10, -2.511027549868692e-10,
      -2.400330137313002e-10, -2.1860517181474635e-10, -1.8856317795473702e-10,
      -1.5192546634974597e-10, -1.1087131454864279e-10, -6.762793057334836e-11,
      -2.4363465145330926e-11, 1.690950572320924e-11, 5.4416297402060784e-11,
      8.668543165546134e-11, 1.1259514160002894e-10, 1.3140026313590064e-10,
      1.4273967908653492e-10, 1.466253742440385e-10, 1.4341493788488587e-10,
      1.3376998711696607e-10, 1.186034602653671e-10, 9.90190339041229e-11,
      7.62460483245131e-11, 5.157329060700815e-11, 2.6284795734015797e-11,
      1.600504172192721e-12, -2.1375816342336842e-11, -4.1699488597117945e-11,
      -5.861734977760075e-11, -7.15889319992312e-11, -8.029622680950459e-11,
      -8.464240409040347e-11, -8.474034247462106e-11, -8.089224008922722e-11,
      -7.356189743522287e-11, -6.334148989216212e-11, -5.091477224013278e-11,
      -3.701868318783226e-11, -2.2405250166051494e-11, -7.805543477573886e-12,
      6.102792661129458e-12, 1.8723181213023273e-11, 2.95619893162345e-11,
      3.824404048366912e-11, 4.4521500535763867e-11, 4.827620268299585e-11,
      4.951577741800116e-11, 4.836421444396427e-11, 4.50476973906641e-11,
      3.987671109592332e-11, 3.3225522301350955e-11, 2.5510177213869327e-11,
      1.7166145760096202e-11, 8.626677202471704e-12, 3.028218438855524e-13,
      -7.43407283441354e-12, -1.426675664321853e-11, -1.9942917187062302e-11,
      -2.4282219120004268e-11, -2.7179489425904488e-11, -2.8604178944605558e-11,
      -2.859639405314843e-11, -2.725993061781248e-11, -2.4752850474055925e-11,
      -2.1276215911546585e-11, -1.706163882109613e-11, -1.2358308843244792e-11,
      -7.420141106043016e-12, -2.493632326132861e-12, 2.193061392815951e-12,
      6.43940558425216e-12, 1.0079814361139819e-11, 1.298882379721426e-11,
      1.5084026774986474e-11, 1.6326794517235172e-11, 1.672091107907675e-11,
      1.6309334971123784e-11, 1.5169373675937786e-11, 1.3406609959260133e-11,
      1.1147952426688069e-11, 8.534196590623343e-12, 5.71247757433574e-12,
      2.828973097149009e-12, 2.217785454930978e-14, -2.5829793395359734e-12,
      -4.879963049479065e-12, -6.784255162064779e-12, -8.235693731236827e-12,
      -9.199510799971236e-12, -9.666114900746723e-12, -9.649718986999922e-12,
      -9.185960940581882e-12, -8.328700003296863e-12, -7.146197547038013e-12,
      -5.71690416581629e-12, -4.125077343599479e-12, -2.456445634593474e-12,
      -7.941175385347872e-13, 7.850924306227974e-13, 2.213779832073722e-12,
      3.4364039770651655e-12, 4.411012975672419e-12, 5.1102125784246745e-12,
      5.521388381250786e-12, 5.6462249770772805e-12, 5.499595170302821e-12,
      5.1079163721503966e-12, 4.5070890492732966e-12, 3.740143230793457e-12,
      2.854723550817931e-12, 1.9005413875090694e-12, 9.269149062796892e-13,
      -1.949499444112314e-14, -8.966617407200501e-13, -1.6688119677634498e-12,
      -2.3076368438097748e-12, -2.793068956082422e-12, -3.1136200162182215e-12,
      -3.266295399375871e-12, -3.2561200448569024e-12, -3.0953258179446622e-12,
      -2.802262551373866e-12, -2.400103336414178e-12, -1.915419101793288e-12,
      -1.3766981763033944e-12, -8.128836225138169e-13, -2.51995047234515e-13,
      2.8010714892415637e-13, 7.607679267788194e-13, 1.171359230368039e-12,
      1.497855096807037e-12, 1.731151321252967e-12, 1.86713326284428e-12,
      1.906506825669433e-12, 1.8544175715526653e-12, 1.719890967629425e-12,
      1.5151327028110364e-12, 1.2547317003328732e-12, 9.548098985777984e-13,
      6.32162164426697e-13, 3.034270308737284e-13, -1.567542036348159e-14,
      -3.1100795419013336e-13, -5.705590286458234e-13, -7.848476361710585e-13,
      -9.471812863497837e-13, -1.053765742509938e-12, -1.103672115655926e-12,
      -1.098673145031103e-12, -1.0429657210284568e-12, -9.428007624084532e-13,
      -8.060443417936267e-13, -6.416954238820044e-13, -4.593857661057862e-13,
      -2.6888651574429777e-13, -7.964395471464698e-14, 9.963613272723618e-14,
      2.6133966051077707e-13, 3.9921933710869703e-13, 5.08586365695383e-13,
      5.864158590941997e-13, 6.31367299886552e-13, 6.437252289332507e-13,
      6.252686793015191e-13, 5.790805697220219e-13, 5.093102528168891e-13,
      4.209036380549211e-13, 3.193157753928905e-13, 2.1022052597500268e-13,
      9.923102554475519e-14, -8.356845089829707e-15, -1.0778771958418894e-13,
      -1.9502876016053817e-13, -2.6690494394898624e-13, -3.211847071270094e-13,
      -3.566155503682746e-13, -3.72911563679694e-13, -3.7069692224130936e-13,
      -3.514111589019606e-13, -3.171833765059838e-13, -2.70683489762011e-13,
      -2.1495906996636227e-13, -1.5326641606412594e-13, -8.890412123528695e-14,
      -2.5056691104950426e-14, 3.534524315066733e-14, 8.974281737506865e-14,
      1.360410336145616e-13, 1.7267264733601528e-13, 1.9863291011012102e-13,
      2.134856572483479e-13, 2.1734252650452403e-13, 2.10818213926643e-13,
      1.9496557696666472e-13, 1.711950565974458e-13, 1.4118329619302182e-13,
      1.0677598488738942e-13, 6.98898585555361e-14, 3.2418474511368163e-14,
      -3.85413270793042e-15, -3.732847001548562e-14, -6.665060960580827e-14,
      -9.07573919033767e-14, -1.0890484883977947e-13, -1.2067973786751876e-13,
      -1.259948700921932e-13, -1.2506961985502404e-13, -1.183975917310483e-13,
      -1.0670387519007661e-13, -9.089462568247101e-14, -7.200186984461463e-14,
      -5.1126445282783494e-14, -2.938186195004587e-14, -7.841628051936625e-15,
      1.2507761240928342e-14, 3.0806395948326236e-14, 4.635178203300895e-14,
      5.862012883681918e-14, 6.727779279029918e-14, 7.218305624135522e-14,
      7.337885658551832e-14, 7.107745711553112e-14, 6.56383539926639e-14,
      5.754093468190773e-14, 4.735353774229067e-14, 3.5700612005759454e-14,
      2.322963891472636e-14, 1.0579372662368975e-14, -1.6492207308506992e-15,
      -1.2918169451964237e-14, -2.277295374245019e-14, -3.085760746936664e-14,
      -3.692414821532405e-14, -4.0836307068206266e-14, -4.2567796338430165e-14,
      -4.219559012239277e-14, -3.9888890155435877e-14, -3.5894601402715074e-14,
      -3.052024454298415e-14, -2.411528469407389e-14, -1.7051858631001515e-14,
      -9.705839782468874e-15, -2.43909676805702e-15, 4.416316032321423e-15,
      1.057144051534422e-14, 1.57907346055348e-14, 1.989916392620662e-14,
      2.27859688377945e-14, 2.4405171801233146e-14, 2.4773036852517522e-14,
      2.3962819356665898e-14, 2.2097245746772906e-14, 1.933923672088397e-14,
      1.5881431942350662e-14, 1.1935089704269654e-14, 7.71892266443307e-15,
      3.448393213293478e-15, -6.740671322160728e-16, -4.467526399676393e-15,
      -7.77940997967586e-15, -1.0490545135215608e-14, -1.2518288651821695e-14,
      -1.3817730656160913e-14, -1.4381057559483463e-14, -1.4235236661272998e-14,
      -1.3438251226313707e-14, -1.207416570464108e-14, -1.024733494812456e-14,
      -8.076088404580254e-15, -5.686220775848778e-15, -3.2046056868870687e-15,
      -7.532203382626451e-16, 1.556170782709458e-15, 3.626473604494162e-15,
      5.378718376539977e-15, 6.754421710668951e-15, 7.716825804033359e-15,
      8.251038315897581e-15, 8.363145776349376e-15, 8.07841585588705e-15,
      7.43873784963032e-15, 6.499475355509757e-15, 5.325919886218447e-15,
      3.989539076184073e-15, 2.5642087090126508e-15, 1.1226048796123779e-15,
      -2.6708756934012674e-16, -1.5440201725508772e-15, -2.6569795152390565e-15,
      -3.566072062870458e-15, -4.243761155378655e-15, -4.67525474142435e-15,
      -4.858272710523381e-15, -4.802249435182612e-15, -4.527049372647668e-15,
      -4.061290588972951e-15, -3.4403824432884847e-15, -2.7043892857065297e-15,
      -1.895832033136609e-15, -1.057534297556404e-15, -2.306099677641483e-16,
      5.473244264032801e-16, 1.2436457038189034e-15, 1.831879896725448e-15,
      2.292488821724102e-15, 2.6132774604783765e-15, 2.7894305939481312e-15,
      2.8232037576068602e-15, 2.7233078431925773e-15, 2.5040380731502556e-15,
      2.1842062934388856e-15, 1.7859404164283572e-15, 1.3334164117808714e-15,
      8.515866564157374e-16, 3.649640163185784e-16, -1.0348584471748869e-16,
      -5.333002555106945e-16, -9.072899674801235e-16, -1.2121017966903358e-15,
      -1.4385623284154946e-15, -1.581802516585274e-15, -1.641173207200272e-15,
      -1.6199706090798086e-15, -1.5249981958754881e-15, -1.365997214104922e-15,
      -1.1549817562937358e-15, -9.055161979147464e-16, -6.319727465936187e-16,
      -3.4880505080211095e-16, -6.987047314595106e-17, 1.921709830141233e-16,
      4.2635868890133037e-16, 6.238181651768083e-16, 7.780229590429449e-16,
      8.849284692460852e-16, 9.429807446143575e-16, 9.530088748767398e-16,
      9.180143811372746e-16, 8.428748330235784e-16, 7.339816626104965e-16,
      5.988337619667225e-16, 4.456089477621971e-16, 2.827348106068888e-16,
      1.1847894167469825e-16, -3.942381513725333e-17, -1.8409243263336843e-16,
      -3.097578986392232e-16, -4.1195108113764823e-16, -4.876166062373329e-16,
      -5.351527979627557e-16, -5.543811621710169e-16, -5.46451920442704e-16,
      -5.136946026060001e-16, -4.594246098981958e-16, -3.877179194591952e-16,
      -3.03166702928331e-16, -2.1062859680439324e-16, -1.149817375704533e-16,
      -2.0896531984835236e-17, 6.736643709249612e-17, 1.4612486258992764e-16,
      2.124041219063627e-16, 2.6402444628122305e-16, 2.9964484892933997e-16,
      3.1876489233714744e-16, 3.216872568590413e-16, 3.094456809326057e-16,
      2.8370412284891885e-16, 2.466339093134716e-16, 2.0077617077482882e-16,
      1.4889702030449997e-16, 9.384273168315486e-17, 3.840164847954963e-17,
      -1.4821243045821942e-17, -6.351216141965403e-17, -1.0573505412691599e-16,
      -1.3999431626977183e-16, -1.652725072883834e-16, -1.8104311786767422e-16,
      -1.8725959512782156e-16, -1.8432285054531347e-16, -1.7303031461490716e-16,
      -1.5451023878055907e-16, -1.3014536370946377e-16, -1.0149026984151959e-16,
      -7.018670817362629e-17, -3.7880992781849874e-17, -6.147146037967212e-18,
      2.3581046435632445e-17, 5.0066556137541656e-17, 7.231240509590369e-17,
      8.959067498787144e-17, 1.0145691496356949e-16, 1.0775033276730223e-16,
      1.0858078681089403e-16, 1.0430413690151595e-16, 9.548793997249167e-17,
      8.28697825296112e-17, 6.731071831500886e-17, 4.974632897192785e-17,
      3.113785418289429e-17, 1.2425657873219337e-17, -5.5129751778569954e-18,
      -2.1900063270101802e-17, -3.608592022497137e-17, -4.757009084872233e-17,
      -5.601383804337767e-17, -6.124421115574963e-17, -6.325011434580174e-17,
      -6.217113537844679e-17, -5.828017685257796e-17, -5.196114472104625e-17,
      -4.368308809765895e-17, -3.397224864579865e-17, -2.338346971338715e-17,
      -1.2472340428347077e-17, -1.7693165062485217e-18, 8.243122023879868e-18,
      1.7149433687868698e-17, 2.461549769993372e-17, 3.039826572949237e-17,
      3.43504834440633e-17, 3.6420618352030016e-17, 3.6648343435779424e-17,
      3.515610740956799e-17, 3.213746601143032e-17, 2.7842950597919507e-17,
      2.2564308731872184e-17, 1.661796685764473e-17, 1.0328539935457229e-17,
      4.013151162574163e-18, -2.032767848862428e-18, -7.547643288388753e-18,
      -1.2313473077867912e-17, -1.6162814056517848e-17, -1.8982914525178164e-17,
      -2.0717006181254668e-17, -2.136290050211377e-17, -2.096914945738317e-17,
      -1.962912488237911e-17, -1.7473442006254477e-17, -1.4661198873383488e-17,
      -1.1370524374504819e-17, -7.78892416455508e-18, -4.103887809930376e-18,
      -4.941749088665126e-19, 2.8778637957691445e-18, 5.872648108250487e-18,
      8.378212277147887e-18, 1.0313415534608117e-17, 1.1629487981981546e-17,
      1.230996016355295e-17, 1.2369096310255773e-17, 1.1849012125394036e-17,
      1.0815706070435249e-17, 9.354267080237408e-18, 7.563540933728589e-18,
      5.550542290710957e-18, 3.4248905035695573e-18, 1.2935261262726567e-18,
      -7.4406655602091745e-19, -2.5999454445043407e-18, -4.2009650011287486e-18,
      -5.49110785025761e-18, -6.432851858395885e-18, -7.007578791069621e-18,
      -7.21507475572286e-18, -7.072211230425985e-18, -6.6109271549364594e-18,
      -5.875656350043943e-18, -4.920359896888099e-18, -3.8053299440568736e-18,
      -2.5939300148890383e-18, -1.3494279197470671e-18, -1.3206180170439201e-19,
      1.003541139675338e-18, 2.0104987271630746e-18, 2.851293779890263e-18,
      3.49884180335814e-18, 3.936996644712821e-18, 4.160511191586052e-18,
      4.174494290741505e-18, 3.9934255066907104e-18, 3.639805443904014e-18,
      3.1425306841158734e-18, 2.535088760787726e-18, 1.8536700678738877e-18,
      1.1352904645563186e-18, 4.160110702311356e-19, -2.7066901909773746e-19,
      -8.951848680185384e-19, -1.4329958908221149e-18, -1.8653637759653468e-18,
      -2.1798045333206718e-18, -2.370217182248648e-18, -2.4367064473539718e-18,
      -2.38512979816647e-18, -2.226409791782045e-18, -1.9756606293660693e-18,
      -1.6511829415964783e-18, -1.2733830429714066e-18, -8.636723449157329e-19
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_9_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<9>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 0.056805078221060595), "design.b()[0] == 0.056805078221060595");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.056805078221060595));
    static_assert(almost_equal(design.b()[1], -0.35349489391708855), "design.b()[1] == -0.35349489391708855");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.35349489391708855));
    static_assert(almost_equal(design.b()[2], 0.9250538346408617), "design.b()[2] == 0.9250538346408617");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.9250538346408617));
    static_assert(almost_equal(design.b()[3], -1.2214491617615661), "design.b()[3] == -1.2214491617615661");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -1.2214491617615661));
    static_assert(almost_equal(design.b()[4], 0.5931070418900443), "design.b()[4] == 0.5931070418900443");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.5931070418900443));
    static_assert(almost_equal(design.b()[5], 0.5931070418900443), "design.b()[5] == 0.5931070418900443");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 0.5931070418900443));
    static_assert(almost_equal(design.b()[6], -1.2214491617615661), "design.b()[6] == -1.2214491617615661");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - -1.2214491617615661));
    static_assert(almost_equal(design.b()[7], 0.9250538346408617), "design.b()[7] == 0.9250538346408617");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - 0.9250538346408617));
    static_assert(almost_equal(design.b()[8], -0.35349489391708855), "design.b()[8] == -0.35349489391708855");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - -0.35349489391708855));
    static_assert(almost_equal(design.b()[9], 0.056805078221060595), "design.b()[9] == 0.056805078221060595");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - 0.056805078221060595));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -7.2063614647801195), "design.a()[1] == -7.2063614647801195");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -7.2063614647801195));
    static_assert(almost_equal(design.a()[2], 23.235305129926367), "design.a()[2] == 23.235305129926367");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 23.235305129926367));
    static_assert(almost_equal(design.a()[3], -43.96032704231607), "design.a()[3] == -43.96032704231607");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -43.96032704231607));
    static_assert(almost_equal(design.a()[4], 53.74822879666334), "design.a()[4] == 53.74822879666334");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 53.74822879666334));
    static_assert(almost_equal(design.a()[5], -44.01235758797825), "design.a()[5] == -44.01235758797825");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -44.01235758797825));
    static_assert(almost_equal(design.a()[6], 24.120468975167398), "design.a()[6] == 24.120468975167398");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 24.120468975167398));
    static_assert(almost_equal(design.a()[7], -8.523334430412461), "design.a()[7] == -8.523334430412461");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -8.523334430412461));
    static_assert(almost_equal(design.a()[8], 1.7598016200511268), "design.a()[8] == 1.7598016200511268");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 1.7598016200511268));
    static_assert(almost_equal(design.a()[9], -0.16138019817470564), "design.a()[9] == -0.16138019817470564");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.16138019817470564));
    std::cout << "max_deviation(cheby2,lowpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.056805078221060595, 0.05586303277898297, 0.007739715969395322, 0.0335012333080493,
      0.057279225957705876, 0.06529726405007963, 0.06343402846423501, 0.059731348482389146,
      0.058830250645791005, 0.06160523394279738, 0.06657547803266156, 0.07147744826928487,
      0.07437097531979364, 0.07416421962585318, 0.07067483506105332, 0.06441447419446189,
      0.0562689375589861, 0.04719625625312912, 0.038009273792791676, 0.029263035298186968,
      0.021236099796804464, 0.01397860269988005, 0.007395460340113666,
      0.0013365479018400128, -0.004326741218663572, -0.009650361422579523,
      -0.01459568159732793, -0.01903432651747687, -0.022773379089857687,
      -0.025592663477124356, -0.02728571579183159, -0.02769719695729589,
      -0.026751406468669747, -0.024468765811191534, -0.020969296687925132,
      -0.016463966459536322, -0.011236157615497677, -0.005616376194986353,
      4.634426346208226e-05, 0.005412997270992596, 0.010180234087656087,
      0.014100888390710414, 0.0169980311769157, 0.018772021135781955, 0.019400766773903566,
      0.01893402572196945, 0.01748299626148847, 0.01520669371870459, 0.012296659358766768,
      0.008961448032432415, 0.005412120508790391, 0.0018496699654475257,
      -0.001545017636544823, -0.004618394024835597, -0.0072486827211898225,
      -0.009347759390510711, -0.010860880691913183, -0.011764750783989489,
      -0.012064434196312937, -0.011789587484218045, -0.010990405247942606,
      -0.00973357563094078, -0.008098432791796575, -0.006173393452634783,
      -0.004052682568765821, -0.001833296593913139, 0.0003878752362848365,
      0.0025168515393430477, 0.004465338013450011, 0.006153501503744038,
      0.007512705426631294, 0.008488122318743366, 0.009041095259311058,
      0.009151089108787952, 0.008817059538719405, 0.00805807513676994, 0.006913055605771469,
      0.005439535214182334, 0.003711421308589688, 0.0018157875611808406,
      -0.00015118548238930718, -0.002088940533527252, -0.003897702508486584,
      -0.005483779578125972, -0.006764693867102725, -0.007673825311295485,
      -0.008164270699361417, -0.008211660095739315, -0.007815732109501934,
      -0.007000543843397072, -0.005813275725241075, -0.004321679966093207,
      -0.002610307998383035, -0.0007757309719396595, 0.0010789671474259995,
      0.0028500965538818075, 0.004439314433547992, 0.00575926517886851,
      0.006738568121790731, 0.007325853097752896, 0.0074926031816366714,
      0.00723463789875254, 0.006572154258336245, 0.005548331638782329,
      0.0042265941989614725, 0.00268670556851738, 0.0010199400511100298,
      -0.0006763717590989966, -0.002304590344564648, -0.0037724611724067846,
      -0.0049984162794069024, -0.005916172868700033, -0.006478364998671722,
      -0.006659006546703157, -0.006454657004599754, -0.005884241605693792,
      -0.004987558780815124, -0.0038225859837044754, -0.0024617648255805917,
      -0.000987504123244387, 0.0005128183565036833, 0.0019520502145650449,
      0.0032483439210115924, 0.0043298237389525415, 0.005138572974609429,
      0.005633720430084178, 0.005793463102426934, 0.005615928760369773,
      0.005118852849923118, 0.00433811489297288, 0.0033252459257742464,
      0.0021440767207126996, 0.0008667432781564489, -0.0004307011314732979,
      -0.0016728008509516593, -0.002789072054500394, -0.0037179834727951513,
      -0.004410320104128677, -0.004831748132712151, -0.004964450658746726,
      -0.004807761583644363, -0.004377785514664501, -0.0037060512171882484,
      -0.002837301461914195, -0.001826569953357976, -0.0007357337778418453,
      0.0003702444674865196, 0.0014271581881782967, 0.0023752563372945457,
      0.0031625895903666518, 0.0037478179116749756, 0.004102330529138557,
      0.004211573289346793, 0.0040755272394340895, 0.00370833309339539,
      0.0031371059741989137, 0.0024000306156722606, 0.0015438665069944964,
      0.0006210231659350991, -0.0003136137071867509, -0.0012059149233837859,
      -0.0020056108438445, -0.0026690888974306246, -0.0031617321771787617,
      -0.0034596764353411608, -0.003550899758169263, -0.003435600092260349,
      -0.003125858139497225, -0.0026446244499496105, -0.002024107465066576,
      -0.0013036717037430284, -0.0005273805243538945, 0.00025866531605635984,
      0.0010090344781662915, 0.001681560160710912, 0.002239677205774948,
      0.0026543737475128656, 0.002905655650005841, 0.0029834528076709, 0.002887930432305348,
      0.0026292036761474055, 0.0022264882825220947, 0.001706751466014022,
      0.001102954171745562, 0.0004519968282214147, -0.00020750534618631852,
      -0.0008374851011763221, -0.0014025930469038364, -0.001872152676580096,
      -0.002221794194375234, -0.002434682169421689, -0.0025022776672628984,
      -0.002424603837028791, -0.002210013257380374, -0.0018744839585257689,
      -0.001440497321359398, -0.0009355735665747301, -0.0003905581010798225,
      0.00016223628241609622, 0.0006909209651837158, 0.0011658475136311235,
      0.001561246144416946, 0.0018565975978408946, 0.0020376670702973564,
      0.002097150154544789, 0.00203490431822524, 0.0018577639042761402,
      0.0015789605383694106, 0.0012171928256709801, 0.0007954081054243663,
      0.0003393738114860715, -0.0001238740735611788, -0.0005676133204113145,
      -0.0009669570979964734, -0.0013002294961012573, -0.0015501201369516812,
      -0.0017045577533117626, -0.0017572603192143928, -0.0017079389750223276,
      -0.001562153414082985, -0.0013308364047451907, -0.0010295235760856437,
      -0.00067734048490846, -0.00029581146609940386, 9.243677373433007e-05,
      0.0004649998031715268, 0.0008009717958062392, 0.0010821018106852327,
      0.001293767089448305, 0.0014257125975623702, 0.001472520775193404,
      0.001433791866082357, 0.0013140322774718213, 0.0011222651953142482,
      0.0008713931860115688, 0.0005773559059492651, 0.00025813660420466976,
      -6.73216862529713e-05, -0.0003802258401159048, -0.0006630040318123002,
      -0.0009002785569008544, -0.0010796870652326502, -0.0011925092801888266,
      -0.0012340685551896907, -0.0012038913199377884, -0.0011056217727654812,
      -0.0009467032477930501, -0.0007378507277093806, -0.0004923502664796325,
      -0.00022523003198375883, 4.764617240042308e-05, 0.0003105089728943424,
      0.0005485832347813301, 0.0007489069435197195, 0.000901024468431131,
      0.0009975179001566392, 0.001034350386621797, 0.001011006844230466,
      0.0009304294038145885, 0.0007987567648802575, 0.0006248876056033628,
      0.00041989772449164357, 0.0001963481661190077, -3.247317350963969e-05,
      -0.00025333129430928406, -0.00045380000779639187, -0.0006229514055081831,
      -0.0007519412029934544, -0.0008344592445747165, -0.0008670229881156408,
      -0.0008491013645959009, -0.0007830664488002476, -0.0006739802979497242,
      -0.000529233550275638, -0.0003580604152392322, -0.0001709611031931622,
      2.0932789078473768e-05, 0.00020651210311306608, 0.0003753252291290956,
      0.0005181586588694446, 0.000627531214819729, 0.0006980759757263715,
      0.0007267910368005418, 0.0007131482510804423, 0.0006590575142194034,
      0.0005686924860571234, 0.00044819141425992727, 0.0003052535082549699,
      0.0001486567438398704, -1.2273214643011843e-05, -0.00016821128134471207,
      -0.0003103665726454138, -0.0004309712410728826, -0.0005236977390920875,
      -0.000583982541488586, -0.0006092402933149986, -0.000598959047942535,
      -0.000554674313167006, -0.0004798266194501709, -0.0003795138643985685,
      -0.0002601554093796545, -0.00012908950210107207, 5.871160161156322e-06,
      0.00013689917753034002, 0.00025660078660066465, 0.0003584274380917284,
      0.0004370280387137053, 0.0004885232798790607, 0.0005106884295896629,
      0.0005030365652356288, 0.00046680013635395706, 0.0004048146210608042,
      0.00032131354266675544, 0.0002216489388941808, 0.00011195526698481854,
      -1.222513953946726e-06, -0.00011131444443487474, -0.00021210222601190953,
      -0.00029806572200959027, -0.0003646802709889206, -0.0004086491082118016,
      -0.0004280593224944792, -0.0004224544601973486, -0.00039282184188719517,
      -0.00034149758974430814, -0.00027199699334539904, -0.00018878191115205816,
      -9.69801968754003e-05, -2.07448619671171e-06, 9.042102899243194e-05,
      0.00017527702043928606, 0.0002478407099341009, 0.0003042867878664819,
      0.0003418142898905631, 0.00035877960416185514, 0.0003547596987349879,
      0.0003305438097386255, 0.0002880559720718108, 0.0002302146688565425,
      0.00016073930741838157, 8.391601409262796e-05, 4.337235543396293e-06,
      -7.33692526380162e-05, -0.00014480613871705806, -0.00020605209590753698,
      -0.000253873520474716, -0.0002858912689900272, -0.0003006940512212475,
      -0.00029789341041261365, -0.0002781187007759823, -0.00024295394841835922,
      -0.00019482175775719095, -0.0001368223185863487, -7.25379239726225e-05,
      -5.815105640791848e-06, 5.946254810056398e-05, 0.00011959764171459486,
      0.00017128561702891437, 0.00021179340898996022, 0.00023910063368038238,
      0.00025199622660409724, 0.0002501261875921749, 0.00023399100265843816,
      0.00020489423128537318, 0.00016484650282700677, 0.00011643160463293677,
      6.264333597160918e-05, 6.703243808873474e-06, -4.812981890460444e-05,
      -9.874719530816606e-05, -0.0001423643344157699, -0.0001766715177240934,
      -0.00019995339413122798, -0.00021117131319940848, -0.00021000473604487172,
      -0.00019685044432728063, -0.00017278071717850645, -0.00013946396305710698,
      -9.905334935023558e-05, -5.405065637381829e-05, -7.153807789749998e-06,
      3.8902761547049795e-05, 8.150557349515918e-05, 0.00011830845587119032,
      0.00014735969356745717, 0.00016720321611170394, 0.000176948722450112,
      0.00017630755738108172, 0.00016559319903331404, 0.0001456872725318773,
      0.00011797395358949226, 8.424735853209699e-05, 4.659794080027406e-05,
      7.2849550313577416e-06, -3.139734096829268e-05, -6.725192206255768e-05,
      -9.830214304735237e-05, -0.00012289899166125623, -0.0001398067326780606,
      -0.00014826261740517204, -0.00014800793245222082, -0.00013928937456965428,
      -0.0001228314636322887, -9.978234438925862e-05, -7.163678795467148e-05,
      -4.014140734333847e-05, -7.1879856444209776e-06, 2.529866143421345e-05,
      5.547172524255226e-05, 8.166602040913075e-05, 0.00010248844535150836,
      0.0001168904604945376, 0.00012421891538298886, 0.00012424289276136732,
      0.00011715567241293379, 0.00010355236538423754, 8.438514696013045e-05,
      6.089924741561339e-05, 3.45538766421895e-05, 6.9330097113667844e-06,
      -2.0348590590665886e-05, -4.5738608892812284e-05, -6.783435386332646e-05,
      -8.54590485617104e-05, -9.772315843787618e-05, -0.00010406764583200713,
      -0.00010428715710270487, -9.853235012298532e-05, -8.729178481639327e-05,
      -7.135495777200128e-05, -5.1759098990144387e-05, -2.9723208354898005e-05,
      -6.573447041159956e-06, 1.633561583330226e-05, 3.769928371815374e-05,
      5.633607282347895e-05, 7.12520463073096e-05, 8.169270053772631e-05,
      8.717976564009446e-05, 8.753121620520225e-05, 8.286379434735891e-05,
      7.357836673450391e-05, 6.0329411072190526e-05, 4.3980801289340214e-05,
      2.555078700669321e-05, 6.14960412895213e-06, -1.3086516456246458e-05,
      -3.106106933359596e-05, -4.677897013416769e-05, -5.9400802580521065e-05,
      -6.82867108776066e-05, -7.302770137613277e-05, -7.346289760401395e-05,
      -6.968213546310336e-05, -6.201414072752153e-05, -5.100134966776811e-05,
      -3.736316978376631e-05, -2.1950091328141682e-05, -5.691519679172847e-06,
      1.0459518497332515e-05, 2.558154746258831e-05, 3.883653867164637e-05,
      4.951564831224891e-05, 5.707634262779e-05, 6.116901580451869e-05,
      6.165185705964723e-05, 5.859342921159201e-05, 5.226313862801064e-05,
      4.311046464278655e-05, 3.173443670746013e-05, 1.8845366015233123e-05,
      5.2212281440332025e-06, -8.338664471224544e-06, -2.1059976641270246e-05,
      -3.2237000852039234e-05, -4.127121684304865e-05, -4.770268919186623e-05,
      -5.123269684325206e-05, -5.173653312577452e-05, -4.9266005638394874e-05,
      -4.404176741819267e-05, -3.643618926515226e-05, -2.6948005522538752e-05,
      -1.61704035864923e-05, -4.754558130677148e-06, 6.629181587489972e-06,
      1.7330167505363372e-05, 2.6754165034849835e-05, 3.439585841425087e-05,
      3.986540092412472e-05, 4.290764916491552e-05, 4.341317555629526e-05,
      4.142064789852977e-05, 3.711066986520077e-05, 3.0791662495168e-05,
      2.287880679587782e-05, 1.3867437505759548e-05, 4.3025585869685504e-06,
      -5.253671540831364e-06, -1.4254570067625527e-05, -2.2199804634928872e-05,
      -2.866279272615134e-05, -3.331315012431723e-05, -3.593303562240589e-05,
      -3.6426619216249775e-05, -3.482231515346311e-05, -3.126784484372262e-05,
      -2.6018603258130536e-05, -1.9420173072439627e-05, -1.1886143241745411e-05,
      -3.8726266027712766e-06, 4.148977145717166e-06, 1.1719367522728285e-05,
      1.841730709823734e-05, 2.388271504242314e-05, 2.783564521092384e-05,
      3.009017230055485e-05, 3.056252704775503e-05, 2.9273168137499897e-05,
      2.634283382212094e-05, 2.1982959651243813e-05, 1.6481160850568373e-05,
      1.0182741727722663e-05, 3.469396215068516e-06, -3.2636066080974857e-06,
      -9.630405944090111e-06, -1.5276381787652038e-05, -1.9897617691205045e-05,
      -2.3256943059589983e-05, -2.519572800667867e-05, -2.564086892903599e-05,
      -2.46066931644866e-05, -2.2191809128211336e-05, -1.8571216891407092e-05,
      -1.3984257024173544e-05, -8.719198306858574e-06, -3.0954359404263866e-06,
      2.5556172522910838e-06, 7.909818187746312e-06, 1.2668650850502367e-05,
      1.657562776402663e-05, 1.9429849050209527e-05, 2.10960188238324e-05,
      2.1510440079365855e-05, 2.068275214305948e-05, 1.8693424707909187e-05,
      1.5687264950847463e-05, 1.186341557177795e-05, 7.462509688714334e-06,
      2.751793493370275e-06, -1.99087773051156e-06, -6.493224277999174e-06,
      -1.0503976301856875e-05, -1.3806694375912099e-05, -1.6231228380198204e-05,
      -1.766222183855185e-05, -1.8044253730283168e-05, -1.7383413110468623e-05,
      -1.5745311481606627e-05, -1.3249741598965039e-05, -1.0062377759091558e-05,
      -6.384071412609182e-06, -2.4384188056058765e-06, 1.5416417855053289e-06,
      5.327410311266646e-06, 8.70740075604209e-06, 1.1498985982779381e-05,
      1.3558080636738045e-05, 1.4786360227821195e-05, 1.5135668892595592e-05,
      1.4609438492248163e-05, 1.3261117473100956e-05, 1.1189779092726982e-05,
      8.533235522988219e-06, 5.459118381648508e-06, 2.154490354720519e-06,
      -1.185378408386592e-06, -4.368404530518427e-06, -7.2165996218729164e-06,
      -9.57588113737704e-06, -1.1324253633291577e-05, -1.2377935627217175e-05,
      -1.2695136161123134e-05, -1.2277327562306562e-05, -1.116800828313023e-05,
      -9.449093508934005e-06, -7.235203319681967e-06, -4.666231326806071e-06,
      -1.8986649127097246e-06, 9.038129072813548e-07, 3.579882991396165e-06,
      5.979759545312996e-06, 7.973455178399272e-06, 9.457692625555869e-06,
      1.0361103633616396e-05, 1.064746311878835e-05, 1.03168258577262e-05,
      9.40455655231417e-06, 7.97836491681371e-06, 6.133568635480388e-06,
      3.986902521081204e-06, 1.6692669242265814e-06, -6.821413229079553e-07,
      -2.9318486194754768e-06, -4.953811973945771e-06, -6.638381268912268e-06,
      -7.898137810917271e-06, -8.672304964040418e-06, -8.92951649364902e-06,
      -8.66882794943009e-06, -7.91896002536426e-06, -6.735864314949807e-06,
      -5.198795481599293e-06, -3.4051544397546102e-06, -1.4644304275913775e-06,
      5.083873139175841e-07, 2.399537064769704e-06, 4.102962619603722e-06,
      5.5261776583329515e-06, 6.595197221598245e-06, 7.2582789175813095e-06,
      7.488291465660106e-06, 7.2836116018939985e-06, 6.6675372322817414e-06,
      5.68628995928564e-06, 4.4057588901172946e-06, 2.907205624955381e-06,
      1.282203916116891e-06, -3.728759982938152e-07, -1.962510585064593e-06,
      -3.3974673667141297e-06, -4.599744145220695e-06, -5.506733882404165e-06,
      -6.074397511406458e-06, -6.279289532919963e-06, -6.119351040574125e-06,
      -5.613457635830512e-06, -4.799781285906094e-06, -3.7330914838740783e-06,
      -2.481178434343746e-06, -1.1206263662510953e-06, 2.6780381132731615e-07,
      1.6039078443972967e-06, 2.812613475483688e-06, 3.828140149869152e-06,
      4.5975160982031416e-06, 5.0832686339671e-06, 5.2651557296917945e-06,
      5.140865320353418e-06, 4.725669820486789e-06, 4.051083469256286e-06,
      3.162625918106307e-06, 2.116843870473575e-06, 9.777810000391421e-07,
      -1.8688711962333433e-07, -1.3098229449739409e-06, -2.327871754323408e-06,
      -3.1855645947153275e-06, -3.838088016091004e-06, -4.2535648409350835e-06,
      -4.4145337983144515e-06, -4.318564690252425e-06, -3.977996920489241e-06,
      -3.4188397108995588e-06, -2.678919287044261e-06, -1.8053991384821402e-06,
      -8.518319785569934e-07, 1.2507539737867909e-07, 1.0687915538747894e-06,
      1.926191096953218e-06, 2.650504331772811e-06, 3.203824573158732e-06,
      3.5590414007720057e-06, 3.7011045143121936e-06, 3.627563695405018e-06,
      3.348373264177541e-06, 2.884991821721894e-06, 2.2688475806560537e-06,
      1.5392740206216638e-06, 7.410481283609295e-07, -7.831729798311569e-08,
      -8.713657622211069e-07, -1.593411555891744e-06, -2.2050233321773547e-06,
      -2.674140783796081e-06, -2.977713062319388e-06, -3.1027779152483227e-06,
      -3.0469346846551686e-06, -2.818200249791981e-06, -2.4342726017821313e-06,
      -1.921259982462764e-06, -1.3119625619853555e-06, -6.438169207336543e-07,
      4.337003921240593e-08, 7.097624510254609e-07, 1.3177761043420057e-06,
      1.834169426850682e-06, 2.231830210733427e-06, 2.491163935604021e-06,
      2.601014849551189e-06, 2.559079545080948e-06, 2.3718028847637304e-06,
      2.053776027426149e-06, 1.6266842747183334e-06, 1.1178769504928761e-06,
      5.58651232552653e-07, -1.764422237208988e-08, -5.775725266201804e-07,
      -1.0895245417249555e-06, -1.525479196686159e-06, -1.8625115476268798e-06,
      -2.083968993254288e-06, -2.1802571731704337e-06, -2.1492009725589132e-06,
      -1.9959712952983993e-06, -1.7325933679336873e-06, -1.377075866328782e-06,
      -9.522208104864644e-07, -4.84190845547363e-07, -9.223702828817988e-10,
      4.695205606431998e-07, 9.005557744224854e-07, 1.2685648165543003e-06,
      1.5541656819499345e-06, 1.7432091732471725e-06, 1.8274492285742357e-06,
      1.8048575433800274e-06, 1.6795739591808797e-06, 1.4615051647585942e-06,
      1.1656040484813982e-06, 8.108794553239705e-07, 4.192002055373788e-07,
      1.3967304860339173e-08, -3.812661504109107e-07, -7.44146995333884e-07,
      -1.0547693156505105e-06, -1.296748469271702e-06, -1.4580649606259764e-06,
      -1.5316360050922494e-06, -1.5155893288959048e-06, -1.4132314695557502e-06,
      -1.2327205321533676e-06, -9.864700057142785e-07, -6.903249267465528e-07,
      -3.6256360556487583e-07, -2.2786696145364022e-08, 3.0923980865127254e-07,
      6.147202120496779e-07, 8.768789543878332e-07, 1.0818668629474894e-06,
      1.2194757714140765e-06, 1.283625717171762e-06, 1.2726028940476507e-06,
      1.1890413841835658e-06, 1.0396565424167695e-06, 8.347519099310001e-07,
      5.875339121210199e-07, 3.132786834898162e-07, 2.8402643660709384e-08,
      -2.505074186858398e-07, -5.076481655659619e-07, -7.288832739509682e-07,
      -9.025080493981471e-07, -1.0198544992404798e-06, -1.0757064878460496e-06,
      -1.0685062751761219e-06, -1.0003461775206014e-06, -8.76751553826493e-07,
      -7.062730983838101e-07, -4.999168550762397e-07, -2.7044889855275604e-07,
      -3.1617816088088124e-08, 2.0265832119137483e-07, 4.190930209066048e-07,
      6.057749390583758e-07, 7.528129335019323e-07, 8.528483094604491e-07,
      9.014084798375397e-07, 8.970860260122991e-07, 8.415375640737942e-07,
      7.393072832786723e-07, 5.974899280201082e-07, 4.252567897849893e-07,
      2.3327548765247167e-07, 3.3059574283384874e-08, -1.637129398147907e-07,
      -3.4587231388248497e-07, -5.033827885649493e-07, -6.278867243824655e-07,
      -7.131381991811475e-07, -7.553041950590783e-07, -7.531196660461112e-07,
      -7.078915056922398e-07, -6.233552140711561e-07, -5.053963926251644e-07,
      -3.6165660812195115e-07, -2.0104926392973168e-07, -3.3215583977680415e-08,
      1.320465600761816e-07, 2.8534756595124776e-07, 4.1823259801846845e-07,
      5.236405565663102e-07, 5.962710512691162e-07, 6.328408281140161e-07,
      6.322179200872404e-07, 5.954291024987052e-07, 5.255436024975775e-07,
      4.274430158359163e-07, 3.0749363118555517e-07, 1.731425159214624e-07,
      3.2462511450124284e-08, -1.0632646003311763e-07, -2.3533174996795502e-07,
      -3.4743096684480413e-07, -4.3665907218394185e-07, -4.98518924471251e-07,
      -5.301995382779668e-07, -5.306920266039789e-07, -5.007993175187182e-07,
      -4.4304191975106533e-07, -3.6146790049393993e-07, -2.6138050318885685e-07,
      -1.4900118877945967e-07, -3.10891058055497e-08, 8.54600714263112e-08,
      1.9401242786644572e-07, 2.8856849832351846e-07, 3.6408971621175273e-07,
      4.1676116970379294e-07, 4.441773247788648e-07, 4.454421388462975e-07,
      4.211801166888078e-07, 3.734600492269249e-07, 3.056381264800717e-07,
      2.2213155208648467e-07, 1.2813746768799802e-07, 2.9314730843065704e-08,
      -6.855225144681144e-08, -1.5988791624049907e-07, -2.3963907473876337e-07,
      -3.035501912582309e-07, -3.483856759179933e-07, -3.720878809900768e-07,
      -3.738634720079384e-07, -3.541951392201322e-07, -3.147799686905941e-07,
      -2.583999545367347e-07, -1.88733871358949e-07, -1.10122836261196e-07,
      -2.7304211697831867e-08, 5.487007816168512e-08, 1.3171428113907283e-07,
      1.989725594477284e-07, 2.530510993183903e-07, 2.9120614693024813e-07,
      3.116783836431851e-07, 3.1376738006448134e-07, 2.9784346466725533e-07,
      2.6529799550907046e-07, 2.1843652251248503e-07, 1.6032247661998257e-07,
      9.458165004019536e-08, 2.5179702245220534e-08, -4.3813855890133346e-08,
      -1.0846133203062471e-07, -1.651786979792095e-07, -2.1093128286734685e-07,
      -2.4339281112588195e-07, -2.6105966012602973e-07, -2.6331499172746e-07,
      -2.5044042319653934e-07, -2.2357596754752784e-07, -1.846319145011473e-07,
      -1.361589759134433e-07, -8.118523957637637e-08, -2.3030147202708026e-08,
      3.4893244896777265e-08, 8.92760933628483e-08, 1.3710035933044233e-07,
      1.7580378455201184e-07, 2.034143863576562e-07, 2.1864758643563576e-07,
      2.2096141039805198e-07, 2.105677163479708e-07, 1.883999815819091e-07,
      1.560406486854946e-07, 1.1561326676064708e-07, 6.964653881091428e-08,
      2.091880465477405e-08, -2.7707618861659184e-08, -7.345248917861322e-08,
      -1.137745671351198e-07, -1.4651068575077793e-07, -1.699894755706805e-07,
      -1.8311391331223557e-07, -1.8540880027554565e-07, -1.7703138784279883e-07,
      -1.5874552402914072e-07, -1.318617728113091e-07, -9.814784004011788e-08,
      -5.971522363989643e-08, -1.8889208810197514e-08, 2.1929907627228737e-08,
      6.040618772759371e-08, 9.440002559364488e-08, 1.22085367378666e-07,
      1.4204586264385749e-07, 1.533450056706148e-07, 1.555669455913769e-07,
      1.4882641136063756e-07, 1.3374800658954823e-07, 1.1141687546710354e-07,
      8.330432612490065e-08, 5.11733354441237e-08, 1.6969879493328357e-08,
      -1.729331340318802e-08, -4.9653732105176144e-08, -7.831006106431296e-08,
      -1.0172097593838892e-07, -1.1868642688492086e-07, -1.284072242795546e-07,
      -1.3052009491044967e-07, -1.2510685601769226e-07, -1.1267787185569987e-07,
      -9.413142490694373e-08, -7.069196881201734e-08, -4.383135963554041e-08,
      -1.5178027087104842e-08, 1.358039469345643e-08, 4.07952299498207e-08,
      6.495007861077897e-08, 8.474407655567613e-08, 9.916060177341483e-08,
      1.0751788213159397e-07, 1.0949909071208858e-07, 1.051607529483384e-07,
      9.491956237069302e-08, 7.951893488492561e-08, 5.997775565410705e-08,
      3.752472639337727e-08, 1.3522454178274216e-08, -1.061410038226095e-08,
      -3.349999799583156e-08, -5.385878222630074e-08, -7.059264156873905e-08,
      -8.284047777634164e-08, -9.002087940579805e-08, -9.185794341086935e-08,
      -8.838892405880931e-08, -7.995375568675328e-08, -6.716753195515408e-08,
      -5.0877970822201155e-08, -3.211069967086151e-08, -1.200581655282315e-08,
      8.250409305127287e-09, 2.7494659348196315e-08, 4.465253206236052e-08,
      5.8797662627309067e-08, 6.920079482649688e-08, 7.536626453260041e-08,
      7.705414224080443e-08, 7.428714957246726e-08, 6.734235965960351e-08,
      5.672856189133338e-08, 4.31509684839594e-08, 2.746562007565811e-08,
      1.062637426699594e-08, -6.3722913374540575e-09, -2.255327660631521e-08,
      -3.7012316287110945e-08, -4.8967791142558585e-08, -5.780219253680201e-08,
      -6.309308983110068e-08, -6.46321080250881e-08, -6.243114904064905e-08,
      -5.671584053421091e-08, -4.7906927534897845e-08, -3.659099318946019e-08,
      -2.3482468659374758e-08, -9.379338514590332e-09, 4.884755343359157e-09,
      1.8489174111629688e-08, 3.0672901612363896e-08, 4.0776509216390753e-08,
      4.82771885044956e-08, 5.2815031443230206e-08, 5.420928727238972e-08,
      5.246393280968155e-08, 4.776252215843549e-08, 4.045289626187939e-08,
      3.1022897611459634e-08, 2.006871968074379e-08, 8.257898753513225e-09,
      -3.7107910649843765e-09, -1.5148161876919177e-08, -2.5413799496708422e-08,
      -3.395141529964628e-08, -4.0318441404261975e-08, -4.4208328830362194e-08,
      -4.5464466939315214e-08, -4.4085150811531734e-08, -4.021955083097387e-08,
      -3.415515491849355e-08, -2.629762934872457e-08, -1.7144452770191743e-08,
      -7.253998316103815e-09, 2.7880454291292475e-09, 1.2402921928341972e-08,
      2.1051744820462496e-08, 2.8265276487961007e-08, 3.3668927000833145e-08,
      3.70016700900918e-08, 3.8127955670776116e-08, 3.7042123778783576e-08,
      3.3865267132528636e-08, 2.8834923110467276e-08, 2.2288376168268397e-08,
      1.464069658776372e-08, 6.358912691954538e-09, -2.0661022851611454e-09,
      -1.0148358828577238e-08, -1.7434434699716383e-08, -2.3528556911169438e-08,
      -2.811371597846584e-08
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.056805078221060595, 0.055863032778982885, 0.007739715969394953, 0.033501233308048724,
      0.057279225957707756, 0.06529726405009517, 0.06343402846429452, 0.05973134848255664,
      0.05883025064618045, 0.06160523394358596, 0.06657547803409511, 0.07147744827167105,
      0.07437097532348091, 0.0741642196311963, 0.07067483506836866, 0.06441447420397833,
      0.05626893757079739, 0.0471962562671541, 0.038009273808748134, 0.029263035315583625,
      0.02123609981495364, 0.013978602717931311, 0.007395460357106757, 0.001336547916773432,
      -0.004326741206753739, -0.009650361414537257, -0.014595681593799075,
      -0.019034326518842782, -0.022773379096187627, -0.02559266348815209,
      -0.027285715806959345, -0.02769719697562637, -0.026751406489064017,
      -0.024468765832348256, -0.02096929670847503, -0.0164639664781442,
      -0.011236157630963653, -0.005616376206337729, 4.634425689614783e-05,
      0.005412997269530113, 0.010180234091239247, 0.014100888398912409,
      0.016998031188976588, 0.01877202115067045, 0.019400766790399575, 0.018934025738760574,
      0.017482996277272754, 0.015206693732291436, 0.012296659369168192, 0.00896144803893775,
      0.005412120511018898, 0.0018496699633749657, -0.0015450176425877721,
      -0.004618394034193134, -0.007248682732936831, -0.00934775940353026,
      -0.01086088070498949, -0.01176475079590877, -0.012064434205963821,
      -0.011789587490683288, -0.010990405250574662, -0.009733575629415132,
      -0.008098432786138712, -0.006173393443218761, -0.004052682556284705,
      -0.001833296579323831, 0.0003878752518378485, 0.0025168515546188557,
      0.004465338027210038, 0.006153501514850509, 0.007512705434137651,
      0.008488122321969577, 0.009041095257898021, 0.009151089102726936,
      0.008817059528354527, 0.008058075122773817, 0.006913055589096169,
      0.005439535195989704, 0.0037114212901665313, 0.0018157875438454623,
      -0.0001511854973822624, -0.0020889405450767655, -0.0038977025157236143,
      -0.005483779580474734, -0.00676469386432077, -0.007673825303490066,
      -0.008164270686981407, -0.008211660079543675, -0.007815732090507375,
      -0.007000543822808883, -0.005813275704372135, -0.0043216799462767845,
      -0.0026103079808852364, -0.0007757309578772481, 0.0010789671571571659,
      0.0028500965586632536, 0.00443931443307657, 0.0057592651731735965,
      0.00673856811122986, 0.007325853082986447, 0.007492603163583675, 0.007234637878530918,
      0.006572154237191586, 0.005548331618009908, 0.004226594179826385,
      0.002686705552177619, 0.001019940038547018, -0.0006763717671383901,
      -0.002304590347611271, -0.0037724611702951217, -0.004998416272282383,
      -0.005916172857007511, -0.006478364983126061, -0.006659006528243955,
      -0.006454656984333175, -0.005884241584825145, -0.0049875587605763055,
      -0.0038225859652806877, -0.002461764810040768, -0.0009875041114794662,
      0.0005128183638310789, 0.0019520502170567934, 0.0032483439185543327,
      0.004329823731721219, 0.005138572963054284, 0.005633720414902213,
      0.005793463084519682, 0.005615928740789841, 0.0051188528298125435,
      0.004338114873496781, 0.0033252459080535222, 0.0021440767057596573,
      0.0008667432668170836, -0.0004307011385669927, -0.0016728008534166038,
      -0.0027890720522225918, -0.003717983465934058, -0.004410320093105676,
      -0.004831748118184005, -0.00496445064156574, -0.004807761564807714,
      -0.004377785495255809, -0.0037060511983148794, -0.002837301444644028,
      -0.0018265699386592997, -0.0007357337665297419, 0.00037024447479443417,
      0.0014271581910945271, 0.002375256335681181, 0.003162589584340767,
      0.00374781790159986, 0.004102330515601412, 0.004211573273124276, 0.004075527221447734,
      0.0037083330746594274, 0.0031371059557634136, 0.0024000305985647156,
      0.0015438664921630485, 0.0006210231541964424, -0.0003136137151920393,
      -0.0012059149272261142, -0.0020056108433284606, -0.002669088892605257,
      -0.003161732168334285, -0.003459676422992302, -0.0035508997430260536,
      -0.003435600075187958, -0.0031258581214670582, -0.002644624431984418,
      -0.002024107448182647, -0.0013036716888927585, -0.0005273805123719933,
      0.0002586653244999533, 0.0010090344826041127, 0.0016815601609041669,
      0.002239677201726718, 0.00265437373946757, 0.002905655638434977,
      0.0029834527932458507, 0.0028879304158587783, 0.0026292036586254243,
      0.0022264882649298944, 0.00170675144935808, 0.0011029541569757314,
      0.00045199681617628284, -0.0002075053548275909, -0.0008374851059328364,
      -0.0014025930475201622, -0.0018721526730402414, -0.0022217941869025815,
      -0.002434682158464956, -0.0025022776534690283, -0.0024246038212044426,
      -0.0022100132404443236, -0.0018744839414550451, -0.0014404973051323218,
      -0.0009355735521142017, -0.0003905580892001947, 0.0001622362910554628,
      0.0006909209701155471, 0.001165847514605886, 0.0015612461414156549,
      0.0018565975910744242, 0.0020376670601923684, 0.0020971501417171713,
      0.0020349043034426804, 0.0018577638884121077, 0.0015789605223513197,
      0.0012171928104256623, 0.000795408091824119, 0.00033937380029847936,
      -0.0001238740817167223, -0.0005676133250979164, -0.0009669570989829937,
      -0.0013002294933732988, -0.0015501201307098432, -0.001704557743957433,
      -0.0017572603073240755, -0.0017079389613121494, -0.0015621533993655748,
      -0.001330836389881526, -0.0010295235619347113, -0.0006773404722776457,
      -0.000295811455698448, 9.243678133320115e-05, 0.0004649998075650522,
      0.0008009717967814257, 0.0010821018082293767, 0.0012937670837472708,
      0.0014257125889873452, 0.001472520764277027, 0.0014337918534857378,
      0.0013140322639444938, 0.0011222651816494825, 0.0008713931729997063,
      0.0005773558943318477, 0.0002581365946320556, -6.732169325805649e-05,
      -0.0003802258441868303, -0.0006630040327574659, -0.000900278554712147,
      -0.0010796870600830986, -0.0011925092724197732, -0.0012340685452884009,
      -0.0012038913085069662, -0.0011056217604866053, -0.0009467032353857699,
      -0.000737850715889392, -0.0004923502559174859, -0.0002252300232669472,
      4.7646178799972337e-05, 0.000310508976645592, 0.0005485832357109301,
      0.0007489069416194443, 0.0009010244638556756, 0.0009975178932120589,
      0.0010343503777454149, 0.0010110068339635504, 0.0009304293927694926,
      0.0007987567537040031, 0.0006248875949398238, 0.00041989771494452494,
      0.0001963481582177359, -3.247317933919224e-05, -0.0002533312977676191,
      -0.0004538000087255194, -0.0006229514038983022, -0.000751941198980925,
      -0.0008344592384315887, -0.0008670229802315069, -0.0008491013554532747,
      -0.0007830664389450392, -0.0006739802879586388, -0.0005292335407224687,
      -0.0003580604066620339, -0.00017096109606419657, 2.0932794378360162e-05,
      0.00020651210631427542, 0.00037532523008634746, 0.0005181586575675151,
      0.0006275312113717218, 0.0006980759703648003, 0.0007267910298618992,
      0.0007131482429842697, 0.0006590575054431493, 0.0005686924771082703,
      0.0004481914056469796, 0.0003052535004589148, 0.00014865673728766543,
      -1.2273219601510598e-05, -0.00016821128445517703, -0.0003103665737618844,
      -0.0004309712401643793, -0.0005236977362427035, -0.000583982536891116,
      -0.0006092402872585186, -0.0005989590407946814, -0.0005546743053520037,
      -0.0004798266114238972, -0.0003795138566221157, -0.00026015540229293126,
      -0.0001290894960979719, 5.871164754604336e-06, 0.00013689918047361926,
      0.0002566007877512614, 0.00035842743741182115, 0.0004370280362707535,
      0.0004885232758403491, 0.0005106884242112016, 0.000503036558846124,
      0.0004668001293348436, 0.00040481461382354725, 0.0003213135356287714,
      0.00022164893245478804, 0.00011195526150260136, -1.2225181810806915e-06,
      -0.00011131444718583479, -0.00021210222715388547, -0.0002980657215042484,
      -0.0003646802688930559, -0.00040864910467249736, -0.0004280593177391444,
      -0.00042245445451929574, -0.0003928218356276673, -0.00034149758327205025,
      -0.0002719969870349882, -0.00018878190536225842, -9.698019192879258e-05,
      -2.0744823617561184e-06, 9.042103151590013e-05, 0.00017527702153034274,
      0.0002478407095562781, 0.00030428678606833376, 0.00034181428680131443,
      0.00035877959998247726, 0.0003547596937253094, 0.0003305438042012993,
      0.00028805596633412335, 0.00023021466325115223, 0.0001607393022641147,
      8.391600967643676e-05, 4.337232104497985e-06, -7.33692549209509e-05,
      -0.0001448061397349913, -0.00020605209562597898, -0.00025387351893427104,
      -0.0002858912663026264, -0.0003006940475623689, -0.00029789340601001324,
      -0.00027811869589564666, -0.00024295394334853459, -0.00019482175279143905,
      -0.0001368223140066184, -7.253792003331185e-05, -5.815102554699397e-06,
      5.9462550173625835e-05, 0.00011959764267592151, 0.00017128561684536387,
      0.00021179340769455942, 0.0002391006313691276, 0.0002519962234292102,
      0.00025012618375227293, 0.00023399099838624483, 0.00020489422683372173,
      0.00016484649845397077, 0.00011643160058695546, 6.264333247745747e-05,
      6.703241055261493e-06, -4.81298207751249e-05, -9.874719620645434e-05,
      -0.00014236433431014675, -0.00017667151664101755, -0.00019995339215262448,
      -0.00021117131045686723, -0.0002100047327111103, -0.00019685044060541453,
      -0.00017278071328978583, -0.0001394639592278558, -9.905334579876258e-05,
      -5.405065329805607e-05, -7.153805356321216e-06, 3.890276321173703e-05,
      8.150557431131567e-05, 0.00011830845580923528, 0.00014735969264864974,
      0.00016720321440584862, 0.00017694872007053763, 0.00017630755447724472,
      0.00016559319578150249, 0.00014568726912458845, 0.00011797395022411814,
      8.424735539957791e-05, 4.659793807436676e-05, 7.2849528591149245e-06,
      -3.139734247431931e-05, -6.725192282998925e-05, -9.830214304725768e-05,
      -0.0001228989909088988, -0.00013980673123113128, -0.00014826261535966082,
      -0.00014800792993620968, -0.0001392893717354229, -0.00012283146064721078,
      -9.978234142602386e-05, -7.163678518139366e-05, -4.014140491410543e-05,
      -7.1879836908081825e-06, 2.5298662810205406e-05, 5.547172597376112e-05,
      8.166602046642685e-05, 0.00010248844474476895, 0.00011689045927137847,
      0.00012421891362535942, 0.000124242890580237, 0.00011715566994140452,
      0.00010355236276950319, 8.438514435476536e-05, 6.08992449687061e-05,
      3.455387449083858e-05, 6.933007973026517e-06, -2.034859182456184e-05,
      -4.5738609561604115e-05, -6.783435394001437e-05, -8.545904805384303e-05,
      -9.77231573864292e-05, -0.00010406764430835647, -0.00010428715520390795,
      -9.853234796567729e-05, -8.729178252967912e-05, -7.135495548977639e-05,
      -5.1759096843300317e-05, -2.972320646386643e-05, -6.573445509217391e-06,
      1.633561692560025e-05, 3.769928431711432e-05, 5.6336072904784386e-05,
      7.125204587679329e-05, 8.169269963040693e-05, 8.717976431756223e-05,
      8.753121455154266e-05, 8.28637924638774e-05, 7.35783647335768e-05,
      6.032940907061009e-05, 4.398079940154355e-05, 2.5550785338262704e-05,
      6.149602770752029e-06, -1.3086517432975672e-05, -3.106106988092357e-05,
      -4.677897022975101e-05, -5.940080222837157e-05, -6.828671010732811e-05,
      -7.302770024070401e-05, -7.346289617627031e-05, -6.968213383114558e-05,
      -6.201413898933649e-05, -5.1001347925387375e-05, -3.7363168137309015e-05,
      -2.1950089870088793e-05, -5.691518489200236e-06, 1.0459519356673605e-05,
      2.5581547949109878e-05, 3.883653876551583e-05, 4.9515648016645785e-05,
      5.7076341968218134e-05, 6.116901482684369e-05, 6.165185582700153e-05,
      5.859342780035229e-05, 5.226313712310123e-05, 4.3110463132596136e-05,
      3.173443527867525e-05, 1.8845364747889637e-05, 5.221227107067107e-06,
      -8.338665223681663e-06, -2.1059977072655215e-05, -3.223700094504453e-05,
      -4.127121660016258e-05, -4.7702688634763645e-05, -5.1232696011099266e-05,
      -5.173653207257283e-05, -4.9266004429539125e-05, -4.4041766126460734e-05,
      -3.64361879663684e-05, -2.6948004291166194e-05, -1.6170402491408847e-05,
      -4.754557231370418e-06, 6.629182244100846e-06, 1.7330167887313245e-05,
      2.675416512660289e-05, 3.439585821720299e-05, 3.9865400456127215e-05,
      4.290764845887068e-05, 4.341317465792635e-05, 4.142064686347293e-05,
      3.711066875560143e-05, 3.0791661375987814e-05, 2.287880573112936e-05,
      1.3867436554884555e-05, 4.302557801561845e-06, -5.2536721197749415e-06,
      -1.42545704117977e-05, -2.2199804730025904e-05, -2.866279257236706e-05,
      -3.3313149736002546e-05, -3.593303502693323e-05, -3.642661845216453e-05,
      -3.482231426804236e-05, -3.126784389009228e-05, -2.6018602292113465e-05,
      -1.9420172149319367e-05, -1.1886142413131117e-05, -3.872625913739896e-06,
      4.148977659044989e-06, 1.171936783505015e-05, 1.8417307196274932e-05,
      2.388271492541707e-05, 2.783564489040395e-05, 3.009017179941404e-05,
      3.0562526398693836e-05, 2.9273167380943665e-05, 2.634283300373991e-05,
      2.1982958819226785e-05, 1.6481160052811472e-05, 1.018274100909631e-05,
      3.469395614917612e-06, -3.2636070580817856e-06, -9.630406221513175e-06,
      -1.5276381880489813e-05, -1.9897617598260767e-05, -2.325694279032132e-05,
      -2.5195727580419373e-05, -2.5640868373669994e-05, -2.4606692514662664e-05,
      -2.219180842321065e-05, -1.857121617279371e-05, -1.3984256333367003e-05,
      -8.719197682769045e-06, -3.0954354172858703e-06, 2.5556176467823e-06,
      7.909818433859123e-06, 1.2668650937431084e-05, 1.65756276903101e-05,
      1.94298488236085e-05, 2.109601846068205e-05, 2.1510439603451903e-05,
      2.0682751584092887e-05, 1.8693424099695546e-05, 1.5687264329262608e-05,
      1.1863414972669921e-05, 7.462509145853298e-06, 2.7517930365622747e-06,
      -1.9908780770429995e-06, -6.4932244968771245e-06, -1.0503976383396115e-05,
      -1.3806694318505718e-05, -1.6231228190233146e-05, -1.7662221529868087e-05,
      -1.804425332321721e-05, -1.7383412630545105e-05, -1.574531095796073e-05,
      -1.324974106259235e-05, -1.0062377241029694e-05, -6.384070942157171e-06,
      -2.438418408682665e-06, 1.5416420877720776e-06, 5.327410503645664e-06,
      8.707400829940982e-06, 1.1498985936590005e-05, 1.3558080475773863e-05,
      1.4786359963859191e-05, 1.5135668543057733e-05, 1.460943807907726e-05,
      1.3261117021402106e-05, 1.118977862925757e-05, 8.533235074586336e-06,
      5.459117973691175e-06, 2.154490009699376e-06, -1.1853786720930066e-06,
      -4.368404699609503e-06, -7.21659968877801e-06, -9.575881100563838e-06,
      -1.1324253497220314e-05, -1.2377935401950897e-05, -1.2695135861623887e-05,
      -1.2277327207464966e-05, -1.1168007894590349e-05, -9.449093109785936e-06,
      -7.235202933100725e-06, -4.666230974716724e-06, -1.8986646145554657e-06,
      9.038131355992819e-07, 3.5798831383495276e-06, 5.9797596043063095e-06,
      7.973455148032778e-06, 9.457692509584119e-06, 1.0361103440612463e-05,
      1.0647462861540174e-05, 1.0316825552406122e-05, 9.404556217474502e-06,
      7.978364572269882e-06, 6.1335683011481165e-06, 3.986902215835233e-06,
      1.6692666648457267e-06, -6.821415226511798e-07, -2.9318487495320817e-06,
      -4.953812028478011e-06, -6.6383812465294945e-06, -7.898137714652471e-06,
      -8.672304801074975e-06, -8.929516274807343e-06, -8.668827688478328e-06,
      -7.918959738157654e-06, -6.735864018480702e-06, -5.198795193002117e-06,
      -3.405154175325254e-06, -1.4644302018763143e-06, 5.08387488912252e-07,
      2.399537180206864e-06, 4.102962670249144e-06, 5.526177642773804e-06,
      6.595197142238331e-06, 7.258278780418091e-06, 7.488291279860995e-06,
      7.2836113792005155e-06, 6.667536986279415e-06, 5.686289704584385e-06,
      4.405758641491242e-06, 2.907205396492487e-06, 1.2822037204270182e-06,
      -3.7287615076805633e-07, -1.9625106865969345e-06, -3.397467412675272e-06,
      -4.599744134272432e-06, -5.506733816500102e-06, -6.0743973956037174e-06,
      -6.279289375017042e-06, -6.119350850599725e-06, -5.613457425416221e-06,
      -4.799781067581694e-06, -3.7330912703278502e-06, -2.4811782376911003e-06,
      -1.1206261973533758e-06, 2.678039434559054e-07, 1.6039079330626752e-06,
      2.812613516640536e-06, 3.8281401422898275e-06, 4.597516043481045e-06,
      5.083268536358286e-06, 5.2651555958077865e-06, 5.140865158726375e-06,
      4.725669641034965e-06, 4.051083282682766e-06, 3.162625735267058e-06,
      2.1168437017517615e-06, 9.777808547614182e-07, -1.8688723369609514e-07,
      -1.3098230220540439e-06, -2.3278717908809457e-06, -3.1855645896266322e-06,
      -3.838087970645697e-06, -4.253564758704691e-06, -4.4145336848934136e-06,
      -4.31856455288939e-06, -3.9779967676323724e-06, -3.4188395516839755e-06,
      -2.678919130752357e-06, -1.8053989940083594e-06, -8.518318539075945e-07,
      1.2507549552305968e-07, 1.068791620510255e-06, 1.926191128999401e-06,
      2.650504328203728e-06, 3.203824535013004e-06, 3.55904133104474e-06,
      3.701104417737527e-06, 3.627563578144344e-06, 3.348373133433466e-06,
      2.8849916853017205e-06, 2.2688474465108737e-06, 1.5392738963879127e-06,
      7.410480209304776e-07, -7.831738284045936e-08, -8.713658201623067e-07,
      -1.593411584216671e-06, -2.2050233299459375e-06, -2.6741407518419546e-06,
      -2.977713003161545e-06, -3.1027778329081085e-06, -3.0469345843912573e-06,
      -2.818200137770417e-06, -2.4342724847017967e-06, -1.9212598671587466e-06,
      -1.3119624550334745e-06, -6.438168280788491e-07, 4.337011258297856e-08,
      7.097625013468001e-07, 1.317776129259317e-06, 1.8341694255220365e-06,
      2.231830183843093e-06, 2.4911638852877796e-06, 2.601014779239965e-06,
      2.5590794592736436e-06, 2.371802788743974e-06, 2.053775926940562e-06,
      1.6266841756357257e-06, 1.117876858464415e-06, 5.586511526924976e-07,
      -1.7644285767840903e-08, -5.775725703009995e-07, -1.0895245636480532e-06,
      -1.525479196105524e-06, -1.8625115251057806e-06, -2.083968950602293e-06,
      -2.1802571133103125e-06, -2.1492008993326727e-06, -1.9959712132250004e-06,
      -1.7325932819334943e-06, -1.3770757814313857e-06, -9.522207315391001e-07,
      -4.841907769406985e-07, -9.223157095513073e-10, 4.6952059838419846e-07,
      9.005557935653639e-07, 1.2685648164433202e-06, 1.5541656630505775e-06,
      1.7432091370925637e-06, 1.8274491776514489e-06, 1.8048574809642602e-06,
      1.6795738891282808e-06, 1.4615050912706595e-06, 1.1656039758551855e-06,
      8.108793877028628e-07, 4.1920014667674856e-07, 1.3967257921251539e-08,
      -3.8126618302876333e-07, -7.441470121113752e-07, -1.0547693160147353e-06,
      -1.2967484536056513e-06, -1.4580649302230629e-06, -1.5316359620596687e-06,
      -1.5155892760136544e-06, -1.413231410100506e-06, -1.2327204696982142e-06,
      -9.864699439164108e-07, -6.903248691354682e-07, -3.625635553431976e-07,
      -2.2786656013378906e-08, 3.0923983663793844e-07, 6.147202265819505e-07,
      8.768789549598389e-07, 1.0818668498658484e-06, 1.2194757457604746e-06,
      1.2836256807220872e-06, 1.2726028491533811e-06, 1.1890413336231163e-06,
      1.0396564892260411e-06, 8.347518572233339e-07, 5.875338629071074e-07,
      3.1327864050785846e-07, 2.8402609226266985e-08, -2.50507442802224e-07,
      -5.076481782270694e-07, -7.288832747029259e-07, -9.025080384802146e-07,
      -1.0198544775549829e-06, -1.0757064568910944e-06, -1.068506236945784e-06,
      -1.0003461343790356e-06, -8.7675150836376e-07, -7.062730532620812e-07,
      -4.999168128754065e-07, -2.704488616243e-07, -3.161778642540349e-08,
      2.0265834205913183e-07, 4.1909303199156987e-07, 6.057749399581469e-07,
      7.52812924409042e-07, 8.528482911373665e-07, 9.014084535594119e-07,
      8.970859934814672e-07, 8.415375273116602e-07, 7.393072445016885e-07,
      5.974898895074227e-07, 4.2525675374559896e-07, 2.3327545609957546e-07,
      3.3059548923033185e-08, -1.6371295767464804e-07, -3.458723233977792e-07,
      -5.033827893929014e-07, -6.2788671668914e-07, -7.131381836194365e-07,
      -7.553041727191068e-07, -7.531196383816082e-07, -7.078914744277269e-07,
      -6.233551810958107e-07, -5.053963598798414e-07, -3.61656577486076e-07,
      -2.0104923711459983e-07, -3.321556243214016e-08, 1.320465752425621e-07,
      2.8534757402356937e-07, 4.182325987078126e-07, 5.236405500157807e-07,
      5.962710380348892e-07, 6.328408091231006e-07, 6.322178965749473e-07,
      5.954290759299187e-07, 5.255435744767548e-07, 4.2744298801127423e-07,
      3.0749360515310603e-07, 1.731424931344318e-07, 3.246249313883833e-08,
      -1.0632647292651897e-07, -2.3533175683658397e-07, -3.474309674436108e-07,
      -4.36659066634798e-07, -4.985189132467743e-07, -5.301995221655483e-07,
      -5.306920066525803e-07, -5.007992949719347e-07, -4.430418959706628e-07,
      -3.614678768785206e-07, -2.613804810924679e-07, -1.4900116943483114e-07,
      -3.108909025625442e-08, 8.546008238110537e-08, 1.940124337117766e-07,
      2.8856849885108547e-07, 3.6408971152417383e-07, 4.16761160200875e-07,
      4.441773111271309e-07, 4.4544212193394797e-07, 4.211800975690763e-07,
      3.7346002905338416e-07, 3.0563810643781697e-07, 2.2213153332325664e-07,
      1.2813745124920284e-07, 2.9314717614323755e-08, -6.855226078648525e-08,
      -1.5988792125247092e-07, -2.3963907524390724e-07, -3.035501873406797e-07,
      -3.4838566791368546e-07, -3.720878694611357e-07, -3.7386345770470847e-07,
      -3.54195123033358e-07, -3.147799515967344e-07, -2.5839993753972285e-07,
      -1.8873385543183662e-07, -1.1012282229103487e-07, -2.730420043687889e-08,
      5.487008613579515e-08, 1.317142854521217e-07, 1.9897255994529457e-07,
      2.530510960691808e-07, 2.912061402165141e-07, 3.116783739390945e-07,
      3.137673680039965e-07, 2.9784345100363255e-07, 2.6529798106852916e-07,
      2.1843650814486852e-07, 1.6032246314933168e-07, 9.45816382180833e-08,
      2.5179692709459142e-08, -4.3813862649187544e-08, -1.0846133569443319e-07,
      -1.6517869841493337e-07, -2.10931280130728e-07, -2.4339280545324624e-07,
      -2.6105965191615273e-07, -2.6331498151459524e-07, -2.5044041161638055e-07,
      -2.2357595529823295e-07, -1.8463190230177944e-07, -1.3615896446226828e-07,
      -8.118522951140168e-08, -2.3030139066661162e-08, 3.4893250685141354e-08,
      8.927609652962928e-08, 1.3710035975866815e-07, 1.7580378228443513e-07,
      2.0341438159034652e-07, 2.1864757950296363e-07, 2.2096140175013718e-07,
      2.1056770652207032e-07, 1.883999711695265e-07, 1.5604063829719135e-07,
      1.1561325699062072e-07, 6.964653020337389e-08, 2.0918797673996178e-08,
      -2.7707623855966403e-08, -7.345249194935243e-08, -1.1377456757837747e-07,
      -1.4651068389850306e-07, -1.699894715855086e-07, -1.8311390747494812e-07,
      -1.8540879296606675e-07, -1.770313795159791e-07, -1.5874551518684594e-07,
      -1.3186176397250582e-07, -9.81478317107217e-08, -5.97152162841192e-08,
      -1.8889202824999e-08, 2.1929911933198608e-08, 6.040619014946991e-08,
      9.440002603949471e-08, 1.2208536587194442e-07, 1.420458593191978e-07,
      1.5334500076336293e-07, 1.5556693942162534e-07, 1.4882640431280998e-07,
      1.3374799908881438e-07, 1.1141686795405347e-07, 8.330431902997067e-08,
      5.117332916324065e-08, 1.6969874366130496e-08, -1.7293317111376567e-08,
      -4.9653734216684174e-08, -7.831006149713133e-08, -1.0172097470852567e-07,
      -1.1868642410310627e-07, -1.2840722014262025e-07, -1.3052008968799932e-07,
      -1.2510685003493558e-07, -1.1267786547351794e-07, -9.413141850038808e-08,
      -7.069196274850599e-08, -4.383135425400418e-08, -1.5178022679255777e-08,
      1.3580397898709995e-08, 4.0795231797990395e-08, 6.495007902886857e-08,
      8.474407555440914e-08, 9.916059944460352e-08, 1.0751787864091623e-07,
      1.0949908628779713e-07, 1.0516074786664874e-07, 9.491955693877046e-08,
      7.951892942250818e-08, 5.99777504748558e-08, 3.7524721787035023e-08,
      1.3522450394639608e-08, -1.061410314666753e-08, -3.349999960771228e-08,
      -5.385878262165089e-08, -7.05926407547951e-08, -8.284047582940052e-08,
      -9.002087646513774e-08, -9.185793966921772e-08, -8.838891974999284e-08,
      -7.995375107130179e-08, -6.716752730473442e-08, -5.087796640379691e-08,
      -3.211069573160663e-08, -1.2005813306338376e-08, 8.250411690151172e-09,
      2.7494660756568634e-08, 4.465253243769015e-08, 5.879766197380568e-08,
      6.920079320725192e-08, 7.536626206452919e-08, 7.705413908661912e-08,
      7.428714593021388e-08, 6.734235575042447e-08, 5.672855794620378e-08,
      4.315096473018633e-08, 2.7465616723926137e-08, 1.062637149969011e-08,
      -6.37229337600941e-09, -2.255327781719016e-08, -3.7012316621316986e-08,
      -4.8967790602618015e-08, -5.780219117532393e-08, -6.309308774651922e-08,
      -6.463210535487706e-08, -6.243114595246418e-08, -5.671583721551948e-08,
      -4.790692418172878e-08, -3.65909899949429e-08, -2.348246580273034e-08,
      -9.379336151195999e-09, 4.8847570902886695e-09, 1.84891751573069e-08,
      3.067290191433177e-08, 4.077650877589976e-08, 4.8277187365339133e-08,
      5.2815029688169006e-08, 5.420928501743096e-08, 5.24639301965948e-08,
      4.776251934597872e-08, 4.0452893416270134e-08, 3.102289489665602e-08,
      2.006871724909755e-08, 8.25789673732183e-09, -3.710792560563914e-09,
      -1.514816277922231e-08, -2.541379976891742e-08, -3.395141494200457e-08,
      -4.031844045313235e-08, -4.420832735523646e-08, -4.546446503799761e-08,
      -4.4085148603817635e-08, -4.021954845122377e-08, -3.4155152507555866e-08,
      -2.6297627045687516e-08, -1.7144450704442444e-08, -7.253996600143595e-09,
      2.7880467057191035e-09, 1.2402922703465755e-08, 2.105174506238125e-08,
      2.8265276196346853e-08, 3.366892620599187e-08, 3.700166885044473e-08,
      3.812795406879019e-08, 3.704212191562318e-08, 3.386526512176936e-08,
      2.883492107125705e-08, 2.2288374218343502e-08, 1.4640694836724876e-08,
      6.358911235183216e-09, -2.0661033716126408e-09, -1.0148359491853009e-08,
      -1.7434434912591443e-08, -2.3528556672949044e-08, -2.811371531433849e-08
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_48_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<48>(20.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.06367552592831562, 0.030142520525953204, 0.036434016240231105, 0.04203448523077289,
      0.05136670787634458, 0.04698850415671991, 0.07598895227605838, 0.04344551315531849,
      0.08267948935502366, 0.07548306958941581, 0.05896579016268194, 0.07447156592076674,
      0.0831448339913232, 0.06826654623011952, 0.05569934443138751, 0.05891988962348709,
      0.06229617001087313, 0.05217764438081854, 0.03484380009476753, 0.02344053961376912,
      0.02082369705604384, 0.019003243483104382, 0.010556438416677088,
      -0.0033650772378457437, -0.015640903384215584, -0.021101705064030904,
      -0.020871069657317567, -0.020038560841401466, -0.022394764696721078,
      -0.02742473021236557, -0.03145726452755425, -0.031093888264932097,
      -0.025818815064269626, -0.018055095181872382, -0.011133572323292158,
      -0.006973159312880312, -0.00509693972137173, -0.003406485767290383,
      9.198671170333657e-05, 0.005881960364594589, 0.0126912259040767, 0.01837507859263832,
      0.02121787681029422, 0.020825323345946806, 0.018166825247878812, 0.014881853524947093,
      0.012341102308687773, 0.010993109777950283, 0.010287075608180716,
      0.009124718915634922, 0.006541797915405239, 0.0022544003883005243,
      -0.0031786397379601375, -0.0086123273564315, -0.012827460478059724,
      -0.015037350664642827, -0.015162278856092708, -0.01377553807883309,
      -0.011781489553400894, -0.00999558747850104, -0.008817428852727623,
      -0.008124112220561839, -0.007402327676396013, -0.006036301712057991,
      -0.0036156822117973638, -0.00013650495920974784, 0.003974030094421021,
      0.008002232746205568, 0.011192484587318346, 0.01299346297260572, 0.013218237503522171,
      0.012070440945805509, 0.010040280467604632, 0.007718302751921612,
      0.005597781878090634, 0.0039333113669348186, 0.0026976893394278995,
      0.0016422236833449864, 0.0004304506286531217, -0.0012066858777174678,
      -0.003348954186190738, -0.00583755750742204, -0.00831079924863701,
      -0.01030841305448079, -0.011407405045186692, -0.011345049555652475,
      -0.010092052538524476, -0.007857035458205134, -0.005025649564395264,
      -0.00205661966384318, 0.0006325018958129317, 0.0027572355345764996,
      0.004212585964493434, 0.005065851654835031, 0.00550341287779906, 0.005751024264060018,
      0.005992519481479459, 0.006309950554702742, 0.006660319017168748,
      0.006892883437410736, 0.006799759264642544, 0.006184059674046896,
      0.004926077106732511, 0.003029549665835474, 0.0006361126229553029,
      -0.0019952351851389486, -0.004537786495824331, -0.006662984453888665,
      -0.008106133448451494, -0.008716428381060095, -0.008480367775303458,
      -0.007514612327150689, -0.006031857211793483, -0.0042894239753805494,
      -0.002533644622051833, -0.0009530962060694548, 0.0003493838537504284,
      0.001361210684829113, 0.0021423267082587233, 0.0027916197817527653,
      0.003407093663266356, 0.004050120494733201, 0.004722370540916684,
      0.0053604339804072445, 0.005848691382854649, 0.0060467245834332235,
      0.0058244141009515206, 0.005096439149666916, 0.0038483562266898464,
      0.002148543258028268, 0.0001434976914399136, -0.001962468083541494,
      -0.003938931253222599, -0.005566109609417862, -0.006669532632423196,
      -0.007146183726542152, -0.006977577319168894, -0.006227938909360816,
      -0.005028580367837468, -0.0035521236268978534, -0.0019819420483260606,
      -0.0004827690894056657, 0.0008221849806552551, 0.0018638821479808783,
      0.002628392857615347, 0.003147042257045034, 0.0034787607365785425,
      0.0036889817946553836, 0.003829829707849068, 0.003925764865303088,
      0.003967476502519039, 0.003914950998523738, 0.0037086953252962233,
      0.003286448922501919, 0.002601679067917968, 0.0016398931111355403,
      0.0004293237805073429, -0.0009562909875572144, -0.002403558761528949,
      -0.003773007142222072, -0.004918069259886208, -0.00570622983377721,
      -0.006038755137421414, -0.005865740411872539, -0.005194067297777199,
      -0.004087095339704819, -0.002656287397682715, -0.0010462513012643752,
      0.0005843375263446222, 0.0020829298323568235, 0.00332137951259452,
      0.004209724398049109, 0.004703729835095504, 0.00480552149720077, 0.004557746971176254,
      0.004032683781913317, 0.0033184052191818996, 0.00250442843943556,
      0.0016691716093655527, 0.0008710758148023023, 0.00014449926142963312,
      -0.000499397148486464, -0.0010674286675549224, -0.0015762021511430129,
      -0.002042785370467814, -0.0024761581301651478, -0.0028711443757322964,
      -0.00320600816055791, -0.0034441904698362417, -0.0035398945964599067,
      -0.0034465272305214847, -0.0031264867107092705, -0.0025605402624461412,
      -0.0017550829417183034, -0.0007459062463582444, 0.00040233803589467175,
      0.0016011089197968795, 0.002746814011211072, 0.003732343604319035,
      0.004459715827105605, 0.004852078192932685, 0.004863405119193345,
      0.0044845660903590715, 0.0037449574209164854, 0.00270950984043914,
      0.0014715113985658058, 0.00014223097281333924, -0.0011612812806202264,
      -0.0023286513150709083, -0.003267361010560655, -0.0039113486486896994,
      -0.004226123528732014, -0.004209983014021731, -0.003891442460680382,
      -0.003323466129971857, -0.0025754585061599014, -0.0017241964536339315,
      -0.0008449321376869413, -3.777778040760238e-06, 0.0007477780424294627,
      0.0013757327305348838, 0.0018637243141446458, 0.002210780465222593,
      0.0024272841111102786, 0.0025299879610316397, 0.0025369861069048007,
      0.0024634879467687887, 0.0023190533774598105, 0.002106670837349941,
      0.001823735566827837, 0.0014646639066194034, 0.0010246082240555248,
      0.0005035552243662834, -8.997686388044826e-05, -0.0007363714322681533,
      -0.0014040381738328997, -0.0020505358109056226, -0.002625695998125289,
      -0.0030764438864446324, -0.0033527433156658845, -0.003413905308665658,
      -0.003234414068085184, -0.002808456659200708, -0.0021524863894155644,
      -0.0013053857202095845, -0.0003260903747232043, 0.0007111473662052896,
      0.0017233828446264604, 0.002626780887972578, 0.003344737386986785,
      0.0038154200829093126, 0.0039978945968627165, 0.003876166960959032,
      0.003460715442490262, 0.0027873712146647693, 0.0019137038935523782,
      0.0009133387422957355, -0.00013115347738485242, -0.001136018343863891,
      -0.00202391294777457, -0.0027305664383396626, -0.0032098716254972816,
      -0.0034369711243003435, -0.003409137901299489, -0.00314449624319404,
      -0.00267885666717208, -0.0020611222995590077, -0.0013478462418210306,
      -0.0005975690240465856, 0.0001344590665348837, 0.0008006570467074772,
      0.0013642232138887374, 0.0018007811769132124, 0.002098552435092617,
      0.002257218517075062, 0.002285775480746675, 0.0021997756798750492,
      0.0020183876729497627, 0.0017616837924982883, 0.001448492133489771,
      0.0010950376100625349, 0.0007144617554298428, 0.000317171832796788,
      -8.815483275688419e-05, -0.0004931794866140869, -0.0008884435704061785,
      -0.0012621670650073205, -0.0015995833274436437, -0.0018830053300474677,
      -0.002092704387131926, -0.0022085552847830284, -0.002212278428361627,
      -0.0020900068087091905, -0.0018348371868978698, -0.001449000407943451,
      -0.000945309091335207, -0.00034760999043993853, 0.0003099247915410023,
      0.0009847013839072148, 0.0016286945214194096, 0.0021922825254917996,
      0.0026285741990807986, 0.0028978015215960916, 0.0029713248200211465,
      0.0028348198584425954, 0.002490287059909045, 0.0019566344305540365,
      0.0012687257346064747, 0.00047493898040937494, -0.00036656916032255126,
      -0.0011925657880264015, -0.0019399850464481539, -0.0025512303216419104,
      -0.00297904593588834, -0.0031905100205460806, -0.003169785220490199,
      -0.002919383481455806, -0.002459842834568382, -0.0018278633119521302,
      -0.001073091008921376, -0.00025386010780398044, 0.0005677088371925276,
      0.0013308075575432057, 0.00198078382940967, 0.002473315966814128,
      0.002777578597600016, 0.0028781640750724633, 0.0027756455236415513,
      0.002485794655026185, 0.0020375877455954643, 0.0014702353521634539,
      0.0008295465275317033, 0.00016398057758317962, -0.00047925363364982544,
      -0.0010577180118739775, -0.0015366092454299725, -0.0018907699291454381,
      -0.0021057430480952645, -0.002177862411389056, -0.002113461722255642,
      -0.0019273602132295277, -0.0016408365401989653, -0.0012793308702684371,
      -0.0008701166500179516, -0.0004401601070988185, -1.4341381158584367e-05,
      0.00038584745293191954, 0.000743077847020823, 0.0010444489300278092,
      0.0012813122611093392, 0.0014487717069596503, 0.001544997405015755,
      0.0015704972964060105, 0.001527474987283293, 0.0014193716555803647,
      0.0012506471386588378, 0.0010268072249486667, 0.0007546370331026926,
      0.00044256041563772654, 0.00010101777841505313, -0.0002572568403768101,
      -0.0006171725548589991, -0.0009615223851925568, -0.0012715807726876695,
      -0.00152806349534372, -0.0017124043271381974, -0.0018082536239459467,
      -0.0018030631284978293, -0.0016895939540639627, -0.0014671747660590598,
      -0.001142546570390905, -0.0007301590450375572, -0.0002518286950079673,
      0.0002642729504387954, 0.0007852680304088941, 0.0012757596651865074,
      0.0017004008129263678, 0.0020266414181139866, 0.0022274221305707696,
      0.002283575499218848, 0.002185710609782879, 0.0019353937942069377,
      0.0015454933264737241, 0.001039625130890637, 0.00045071328230137926,
      -0.00018124349669415877, -0.0008120371324687597, -0.0013965270476145406,
      -0.001892068639688365, -0.0022618158881624246, -0.0024776268307757877,
      -0.0025223303163495526, -0.0023911630255127776, -0.002092252895677949,
      -0.0016461029845562863, -0.00108411173167389, -0.00044624449141621647,
      0.00022195961190588895, 0.0008728078428596334, 0.0014600297412274957,
      0.0019422264814379104, 0.002285923828133186, 0.0024679932242221373,
      0.0024772588309505245, 0.0023151757743119865, 0.001995540600693467,
      0.0015432725710026653, 0.0009923774551779388, 0.0003832679751537779,
      -0.00024033795238730354, -0.00083469202289382, -0.0013592070926231898,
      -0.0017793228848879987, -0.002068836156169343, -0.00221153439263442,
      -0.002202032237134808, -0.002045776001155473, -0.0017582481254822383,
      -0.0013634648119522207, -0.0008919113840175468, -0.0003780974053520775,
      0.00014206531999818, 0.0006338550428967284, 0.0010661090232324884,
      0.0014132036495894237, 0.0016565202106728393, 0.0017853186342721302,
      0.0017969927287474177, 0.001696730553571638, 0.0014966483400650986,
      0.0012145024151803776, 0.0008721083622314039, 0.0004936088451727113,
      0.00010373099735927851, -0.00027383794852239775, -0.000617850028061116,
      -0.0009105930073882843, -0.0011386386537191443, -0.001293230609854624,
      -0.0013703301374551585, -0.0013703632684384836, -0.0012977311175908952,
      -0.0011601552473084853, -0.0009679319167115437, -0.0007331635173231425,
      -0.00046902393514228853, -0.0001890989397365842, 9.317478350065575e-05,
      0.00036496542043920133, 0.0006144047451855869, 0.0008308685065349271,
      0.0010052028358055233, 0.001129921300505454, 0.0011993925206783963,
      0.0012100295526194065, 0.0011604809875262437, 0.0010518116725338916,
      0.0008876499919289676, 0.0006742704746980742, 0.0004205765215922621,
      0.0001379491806355523, -0.00016006554600214127, -0.0004582467447763058,
      -0.0007403661041477376, -0.0009900146256049728, -0.0011915511067624792,
      -0.001331117131138852, -0.0013976488277395102, -0.0013838063858896332,
      -0.0012867396269057349, -0.0011086126616339051, -0.0008568229331782004,
      -0.0005438691637510934, -0.00018684760427071546, 0.0001934153637685903,
      0.0005735561365206287, 0.0009291252228410351, 0.0012362047183568676,
      0.0014730805510434063, 0.0016218471249693053, 0.0016698203849554781,
      0.0016106436944133401, 0.001444989004269719, 0.0011807825046223153,
      0.0008329174435476544, 0.00042245459544606876, -2.4649942195874124e-05,
      -0.0004792124569446414, -0.0009107749431567615, -0.0012897089328924348,
      -0.0015893192398542793, -0.0017877927297069943, -0.0018698447561897923,
      -0.001827934930137237, -0.001662953182087939, -0.0013843145662669767,
      -0.0010094441787856696, -0.0005626786973770686, -7.365494323046621e-05,
      0.0004247048839179475, 0.0008984701204813917, 0.0013150782414604574,
      0.0016456393901162524, 0.001867000594517796, 0.0019634176152000067,
      0.001927710082606832, 0.0017618127956233228, 0.0014766799893668552,
      0.0010915467391139724, 0.0006325988729501486, 0.00013114624893215577,
      -0.00037856927356843444, -0.000861773123328509, -0.0012855915651309828,
      -0.0016213444009974451, -0.0018465325848477975, -0.0019463794683523795,
      -0.001914817656497113, -0.0017548544553241735, -0.001478294514609222,
      -0.0011048450567155664, -0.0006606735381485882, -0.00017652642707660735,
      0.00031445182194707837, 0.0007790407011940093, 0.0011862396835025392,
      0.0015093759382413473, 0.001727877471164992, 0.001828591956016416,
      0.0018065662631898123, 0.0016652419134334877, 0.001416064314525587,
      0.0010775454877307695, 0.0006738580039927614, 0.0002330693340900675,
      -0.00021485136516607864, -0.0006401092909208872, -0.0010150961547783451,
      -0.0013162003682929545, -0.00152529539886391, -0.0016308126843433155,
      -0.0016283375739181332, -0.0015207021567262115, -0.0013175848718395974,
      -0.001034660838422795, -0.000692376523029395, -0.0003144457053368293,
      7.382070954724143e-05, 0.00044723145192504803, 0.0007823603020252752,
      0.001059012090722743, 0.0012614181867462067, 0.0013790929117880146,
      0.0014073085669544713, 0.001347174649491029, 0.00120533432586933,
      0.0009933163833261553, 0.0007266020577900906, 0.00042348206342124903,
      0.0001037890120373779, -0.00021240611971323742, -0.0005060475892485975,
      -0.0007602210874000064, -0.0009610881815928367, -0.0010985812107109,
      -0.0011668294640362618, -0.0011643067186724665, -0.0010937086904817947,
      -0.0009615854559321942, -0.0007777674501876613, -0.0005546335590258535,
      -0.0003062757394913854, -4.7616489141353614e-05, 0.00020646640495700715,
      0.00044195856077189376, 0.0006464295888690842, 0.0008096235127421198,
      0.000923897370159946, 0.0009844968578860156, 0.0009896677844029758,
      0.0009406108112047513, 0.0008412940916565511, 0.0006981437415709373,
      0.000519635560868343, 0.0003158131912826286, 9.77581833776659e-05,
      -0.0001229634216412193, -0.00033485506022202095, -0.0005270233619919003,
      -0.000689673114556642, -0.0008145472487715073, -0.0008952977379767622,
      -0.0009277752694458045, -0.0009102274329131906, -0.0008433971269189496,
      -0.0007305150931160498, -0.0005771831365203521, -0.00039114782409959044,
      -0.00018196835261614073, 3.941318037508425e-05, 0.00026118581355008503,
      0.0004712494593443628, 0.0006578365045472185, 0.0008101467274812492,
      0.000918963272314672, 0.0009772151773276543, 0.000980451601070369,
      0.0009271947490182215, 0.0008191427492569493, 0.0006612003554054235,
      0.0004613241653328874, 0.00023017962903807836, -1.9381116346042077e-05,
      -0.00027299935241036966, -0.0005156148274996518, -0.0007323523100109325,
      -0.0009094379750982553, -0.001035088696348425, -0.0011003156413249683,
      -0.0010995858565981368, -0.001031291874160027, -0.0008979895762922895,
      -0.0007063781158252085, -0.000467011817162958, -0.00019375165753463073,
      9.701804581072244e-05, 0.00038736501949235757, 0.0006589188730640182,
      0.0008940462609450475, 0.0010770150707303887, 0.0011950692266778776,
      0.0012393389868961243, 0.0012055202797695938, 0.0010942702480386743,
      0.0009112839494704194, 0.0006670379727762454, 0.00037620918074584176,
      5.679934127142324e-05, -0.00027098255026237583, -0.0005860104547959118,
      -0.0008676205819630311, -0.0010969882793717468, -0.0012584090838660862,
      -0.0013403950482564924, -0.0013365082998052385, -0.0012458702915586792,
      -0.0010733063238910268, -0.0008291092409343351, -0.0005284320896859783,
      -0.0001903451737408382, 0.00016338346831646402, 0.0005097052673444761,
      0.0008258124404024526, 0.0010906614569113778, 0.0012863952544911294,
      0.0013995665096412408, 0.0014220767986133642, 0.00135176503787002,
      0.0011926019375449806, 0.0009544737529524369, 0.0006525665571809537,
      0.0003063896493968804, -6.149834949391569e-05, -0.0004269764282405577,
      -0.000765961791849496, -0.001056016469006296, -0.0012778512772560393,
      -0.0014166249877580258, -0.0014629500505482641, -0.0014135358844472418,
      -0.001271425164857607, -0.0010458060845260366, -0.0007514123253441955,
      -0.0004075504854553621, -3.682002881734149e-05, 0.00033638827693472837,
      0.0006875144283319966, 0.0009934626006120552, 0.0012341360362523647,
      0.0013937702990084741, 0.0014619755507821232, 0.0014344183194025327,
      0.0013130977119115538, 0.0011061985046137105, 0.0008275321236447459,
      0.0004956042658322609, 0.000132372913702628, -0.0002382189186411814,
      -0.0005918365884529487, -0.000905366245545992, -0.0011584384102164822,
      -0.0013347614006105099, -0.0014231766511978267, -0.0014183671575932755,
      -0.0013211739802735344, -0.001138502303790491, -0.0008828261601335258,
      -0.000571327710160799, -0.0002247311330966814, 0.0001340889068478758,
      0.0004816298712050442, 0.0007953127733460231, 0.0010549591723398861,
      0.0012440964291123796, 0.0013510063177258995, 0.001369450036157942,
      0.001299024897916442, 0.0011451329656837713, 0.0009185679017154333,
      0.0006347515989584902, 0.0003126750347788857, -2.6383246968017212e-05,
      -0.00036027378931040234, -0.0006674329348987725, -0.0009282831151577514,
      -0.0011264852626353117, -0.001249962930826444, -0.0012916339251901612,
      -0.0012498054896193473, -0.0011282119420010597, -0.000935697546351996,
      -0.0006855707387966729, -0.0003946770467544859, -8.225577917468836e-05,
      0.0002313412981899303, 0.0005259833455818259, 0.000783057999721214,
      0.0009866490980517569, 0.0011245199406095202, 0.001188841547094823,
      0.0011766231702110372, 0.0010898225876452927, 0.0009351350251470211,
      0.0007234805317754237, 0.00046922886067632863, 0.00018921717583634547,
      -9.837179708853259e-05, -0.00037519594749681217, -0.000623926523568331,
      -0.0008293322739769444, -0.0009792072400172083, -0.001065086097049841,
      -0.0010827059481170716, -0.0010321907684171495, -0.0009179530995620392,
      -0.0007483258698284667, -0.0005349541860818234, -0.0002919915393444542,
      -3.515620995462514e-05, 0.00021928889076673136, 0.00045556651498034604,
      0.0006593602305675983, 0.000818674435782649, 0.0009245281910166143,
      0.0009714437505208033, 0.0009577047248198506, 0.0008853740063734928,
      0.0007600769402953042, 0.0005905697382077923, 0.0003881259248726571,
      0.0001657839252721798, -6.249381884302946e-05, -0.0002826959179934662,
      -0.0004816166147257221, -0.0006476382095404454, -0.0007713957632851568,
      -0.000846287189085979, -0.0008688024797506785, -0.0008386576670375661,
      -0.0007587314006960059, -0.0006348139979453457, -0.0004751897328638704,
      -0.0002900823912946212, -9.100122170388773e-05, 0.00010997096903254391,
      0.0003009038623818583, 0.00047071679718733967, 0.0006098072308145181,
      0.0007105760515047244, 0.0007678224759737149, 0.0007789897297668016,
      0.0007442519133524202, 0.0006664418435064444, 0.0005508286854955007,
      0.00040476236449971624, 0.0002372086466459084, 5.820408641185083e-05,
      -0.00012173647084305611, -0.000292225572706328, -0.0004435881219948155,
      -0.0005673938762571156, -0.0006569095315226756, -0.0007074475786387007,
      -0.0007165952909818691, -0.0006843140425734387, -0.0006129062909953176,
      -0.0005068546191436634, -0.00037254386407326257, -0.0002178832563858162,
      -5.1850384403217414e-05, 0.00011601752438223761, 0.00027615719121049396,
      0.000419509044887912, 0.0005380150155970813, 0.0006250581846774748,
      0.0006758213492339832, 0.000687545911102855, 0.000659677748160916,
      0.0005938926191973775, 0.0004939999106805416, 0.0003657298569928108,
      0.00021641545225078995, 5.45858260569615e-05, -0.00011050739846438077,
      -0.0002694055520691457, -0.00041297251816002753, -0.0005329097847591962,
      -0.0006222286872711927, -0.000675653507095176, -0.0006899324481137413,
      -0.0006640381625496925, -0.0005992452309781997, -0.0004990785450877464,
      -0.0003691335690521716, -0.00021677659995079522, -5.074002208161477e-05,
      0.00011936623431985804, 0.0002836006305538953, 0.00043226311723441565,
      0.0005564629348181856, 0.0006486482333237267, 0.0007030660819670358,
      0.0007161247527689157, 0.0006866352035572353, 0.0006159152170967556,
      0.0005077473384824443, 0.00036819017471721857, 0.000205251300757314,
      2.8438443952347582e-05, -0.0001517867210712111, -0.0003246214291351344,
      -0.00047956587053024516, -0.0006070602601954243, -0.0006990763067643649,
      -0.0007496263425424653, -0.0007551575540631083, -0.0007148050341549437,
      -0.0006304854316145918, -0.0005068223535890347, -0.00035090483181441067,
      -0.00017189048487935787, 1.9525145761772146e-05, 0.0002117428671017164,
      0.00039296043427859294, 0.0005518973071714455, 0.0006784990292527868,
      0.000764577071065345, 0.0008043431396559273, 0.0007948027617073189,
      0.0007359810950317571, 0.0006309639464197787, 0.00048574827817740064,
      0.0003089083794815301, 0.00011109561656733258, -9.559949452750448e-05,
      -0.0002983849379880083, -0.0004845596460507359, -0.0006423115808760259,
      -0.000761471104419852, -0.0008341712989485449, -0.0008553720316043342,
      -0.0008232125372631938, -0.0007391676632582339, -0.0006079950525049931,
      -0.00043747368751124077, -0.00023794754677490375, -2.1700780638675378e-05,
      0.00019779803197662806, 0.00040673607582567483, 0.0005918284183986367,
      0.0007411667736321837, 0.0008449903885856141, 0.0008963288153099762,
      0.0008914739112943308, 0.0008302488460562652, 0.0007160545421345651,
      0.000555688055890033, 0.00035894201301641814, 0.00013800841440537743,
      -9.327700710010797e-05, -0.00032030302163498045, -0.0005286091029256247,
      -0.0007048106479025267, -0.0008374637169132663, -0.00091781309222873,
      -0.0009403744248805961, -0.0009033114748066512, -0.0008085823153787358,
      -0.0006618430604151662, -0.0004721132419167657, -0.0002512224147986613,
      -1.3071883496554694e-05, 0.0002272423088078589, 0.0004543896312044807,
      0.0006537872275563642, 0.0008125407653240031, 0.0009202829409618452,
      0.0009698547895739866, 0.0009577847347406363, 0.0008845331029542334,
      0.0007544848043723811, 0.0005756890866979856, 0.0003593616536669799,
      0.00011917993643940954, -0.00012958410145565992, -0.0003710384557567487,
      -0.0005896904347090996, -0.000771445192679247, -0.0009045187702365924,
      -0.000980206185371384, -0.0009934542322480194, -0.0009432010742490445,
      -0.000832459672480977, -0.0006681386058286521, -0.00046061084393634065,
      -0.00022305742320711147, 2.9372323270260688e-05, 0.00028053028328686545,
      0.0005143065329238335, 0.0007156668785519648, 0.0008716238539300373,
      0.0009720781716937852, 0.0010104758548849435, 0.0009842380834738304,
      0.00089493542290892, 0.000748194610073723, 0.0005533433853597179,
      0.00032281585170299524, 7.135640495767746e-05, -0.0001849266012519894,
      -0.0004295964772495175, -0.0006469462576645764, -0.0008230108174962726,
      -0.0009464675647123488, -0.0010093673880971533, -0.0010076484887915824,
      -0.0009413997557203067, -0.0008148565477671738, -0.0006361290662208934,
      -0.000416680813702826, -0.00017059081502474597, 8.63527303078733e-05,
      0.00033766879386798964, 0.0005672441929272673, 0.0007603700854457297,
      0.0009046873798852361, 0.0009909800917220204, 0.0010137655610747698,
      0.0009716436280049346, 0.0008673824845129993, 0.0007077359683141784,
      0.0005030044253998461, 0.00026636781973046785, 1.3034437352966869e-05,
      -0.00024073962874552706, -0.00047869677952967174, -0.0006856224347433234,
      -0.0008483204690832448, -0.0009564568478238771, -0.0010032173939175607,
      -0.000985737736082775, -0.0009052782851250918, -0.0007671335988940174,
      -0.0005802826517115867, -0.00035680321031933513, -0.00011108865778037549,
      0.0001410817745764326, 0.0003835591166204248, 0.0006008614866965687,
      0.0007791648911295309, 0.0009071844368239881, 0.0009768896712580239,
      0.000984008639675959, 0.0009282890110579273, 0.0008135003730291298,
      0.0006471785071945459, 0.0004401290485373453, 0.0002057233359987251,
      -4.096751183680318e-05, -0.0002841440549046451, -0.0005082927394210489,
      -0.0006991775965007213, -0.0008447459075151525, -0.0009358901240865121,
      -0.0009670178260504411, -0.0009363940501972549, -0.0008462351031568365,
      -0.0007025490210375318, -0.0005147341173772125, -0.00029496252145535677,
      -5.738926133861056e-05, 0.00018276157761715352, 0.00041017447839965455,
      0.0006104209888042956, 0.0007708764599189467, 0.0008815166980739558,
      0.0009355442181566576, 0.0009298049822259386, 0.000864970145325229,
      0.0007454725203222379, 0.0005792032314553858, 0.0003769893377956628,
      0.00015188709399385146, -8.166290468088064e-05, -0.00030876390020795065,
      -0.0005150146956261238, -0.0006874240210721146, -0.0008152294153449711,
      -0.000890568972823091, -0.0009089640416340531, -0.0008695833088399468,
      -0.0007752728634398076, -0.0006323518697979405, -0.0004501884441861531
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby2_highpass_1_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<1>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.4430735856182326), "design.b()[0] == 0.4430735856182326");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.4430735856182326));
    static_assert(almost_equal(design.b()[1], -0.4430735856182326), "design.b()[1] == -0.4430735856182326");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.4430735856182326));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], 0.1138528287635348), "design.a()[1] == 0.1138528287635348");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - 0.1138528287635348));
    std::cout << "max_deviation(cheby2,highpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.4430735856182326, -0.49351876669127065, 0.056188507635692116, -0.006397220538325022,
      0.0007283416545124866, -8.292375767255976e-05, 9.4411043827228e-06,
      -1.0748964406247968e-06, 1.2238000039298804e-07, -1.3933309228824188e-08,
      1.5863466697386993e-09, -1.8061005574936383e-10, 2.056296575020479e-11,
      -2.341151818428497e-12, 2.665467570929778e-13, -3.03471022927823e-14,
      3.4551034408096173e-15, -3.9337330040679725e-16, 4.4786663011361616e-17,
      -5.099088274722691e-18, 5.805456241921507e-19, -6.609676154056836e-20,
      7.52530327350252e-21, -8.567770649917504e-22, 9.754649246902969e-23,
      -1.1105944103559874e-23, 1.2644431522799913e-24, -1.43960429697758e-25,
      1.639030215110373e-26, -1.866082264192209e-27, 2.1245874448374487e-28,
      -2.4189029055023397e-29, 2.7539893829577466e-30, -3.1354948163448118e-31,
      3.569849544142568e-32, -4.0643746886084655e-33, 4.627405554529847e-34,
      -5.268432122193164e-35, 5.9982590026036455e-36, -6.829187551027638e-37,
      7.775223208412133e-38, -8.852311565456082e-39, 1.0078607128233299e-39,
      -1.147477931545687e-40, 1.306436084502062e-41, -1.4874144381931614e-42,
      1.6934634133201531e-43, -1.9280560001405054e-44, 2.195146296305028e-45,
      -2.4992361538412396e-46, 2.8454510586292197e-47, -3.2396265213313137e-48,
      3.6884064359093995e-49, -4.1993550635791253e-50, 4.781084529709569e-51,
      -5.443399982650088e-52, 6.197464861160888e-53, -7.055989056057744e-54,
      8.033443137567179e-55, -9.146302259230298e-56, 1.0413323849396785e-56,
      -1.1855863770846051e-57, 1.3498236277459314e-58, -1.5368123835073086e-59,
      1.7497043714113738e-60, -1.9920879218510742e-61, 2.2680484504841624e-62,
      -2.5822373186037375e-63, 2.9399502326180057e-64, -3.347216504075721e-65,
      3.8109006747301063e-66, -4.33881821954886e-67, 4.939867277864013e-68,
      -5.624178633012402e-69, 6.403286468398922e-70, -7.290322778104819e-71,
      8.300238708864652e-72, -9.450056564168304e-73, 1.0759156718059719e-73,
      -1.2249604274612883e-74, 1.3946520978985644e-75, -1.5878508648674983e-76,
      1.807813126197899e-77, -2.0582463829347992e-78, 2.3433717298944056e-79,
      -2.6679950029297606e-80, 3.0375877821052855e-81, -3.458379616102385e-82,
      3.937463022314041e-83, -4.482913032422707e-84, 5.1039232984224096e-85,
      -5.810961053175023e-86, 6.615943537387057e-87, -7.532438866713433e-88,
      8.575894724637186e-89, -9.76389873578219e-90, 1.1116474908295035e-90,
      -1.265642114188246e-91, 1.440969349025925e-92, -1.6405843654815086e-93,
      1.867851708352986e-94, -2.1266020070678843e-95, 2.4211965415888924e-96,
      -2.756600752523828e-97, 3.1384679344652656e-98, -3.573234523225186e-99,
      4.06822858304708e-100, -4.63179332236577e-101, 5.27342771999394e-102,
      -6.003946632013477e-103, 6.835663078000318e-104, -7.782595779047875e-105,
      8.860705445677463e-106, -1.0088163798308364e-106, 1.1485659854672929e-107,
      -1.307674864670283e-108, 1.4888248244568425e-109, -1.6950691779778464e-110,
      1.9298842086265743e-111, -2.1972277633821123e-112, 2.5016059629882817e-113,
      -2.848149153379424e-114, 3.2426983785271413e-115, -3.6919038322224257e-116,
      4.2033369482145775e-117, -4.785618018005132e-118, 5.448561487316251e-119,
      -6.203341380230076e-120, 7.062679639250845e-121, -8.041060555793302e-122,
      9.154974905359487e-123, -1.0423197902343518e-123, 1.1867105659439516e-124,
      -1.3511035485629418e-125, 1.5382696095634083e-126, -1.7513634644977224e-127,
      1.9939768462617023e-128, -2.2701990443588673e-129, 2.5846858305653047e-130,
      -2.9427379327488633e-131, 3.350390379532147e-132, -3.814514221718679e-133,
      4.3429323450140496e-134, -4.944551326085012e-135, 5.629511554412658e-136,
      -6.4093581502688495e-137, 7.297235559667254e-138, -8.308109106219729e-139,
      9.45901723419199e-140, -1.076935869435785e-140, 1.2261219513218089e-141,
      -1.3959745256705306e-142, 1.5893564862942364e-143, -1.8095273187827102e-144,
      2.0601980396830613e-145, -2.3455937463100565e-146, 2.6705248314745694e-147,
      -3.0404680634664176e-148, 3.461658897908383e-149, -3.9411965774132973e-150,
      4.487163790516655e-151, -5.108762906756264e-152, 5.816471084164193e-153,
      -6.622216863533974e-154, 7.53958122598926e-155, -8.584026502713171e-156,
      9.77315699515047e-157, -1.1127015698480088e-157, 1.266842212968217e-158,
      -1.4423356954348788e-159, 1.6421399895188113e-160, -1.8696228303243805e-161,
      2.1286184795331696e-162, -2.4234923525318576e-163, 2.7592145982254567e-164,
      -3.1414438717360836e-165, 3.576622711990241e-166, -4.072086131799943e-167,
      4.636185250741837e-168, -5.27842805468736e-169, 6.009639654509581e-170,
      -6.842144745154277e-171, 7.789975340453693e-172, -8.86910728508833e-173,
      1.0097729530145806e-173, -1.149655071096179e-174, 1.308914819466427e-175,
      -1.4902365480676417e-176, 1.696676465243064e-177, -1.9317141506443807e-178,
      2.1993112041341174e-179, -2.503978019220052e-180, 2.850849806499156e-181,
      -3.2457731484990465e-182, 3.6954045448134115e-183, -4.2073226085262955e-184,
      4.790155805014928e-185, -5.453727886190168e-186, 6.209223471493238e-187,
      -7.069376566544407e-188, 8.048685196957258e-189, -9.163655775007721e-190,
      1.0433081317999309e-190, -1.1878358207742092e-191, 1.3523846830179884e-192,
      -1.539728217380743e-193, 1.753024130758324e-194, -1.995867561775719e-195,
      2.272351677455446e-196, -2.5871366642386596e-197, 2.945528276214267e-198,
      -3.3535672644997277e-199, 3.818131195120833e-200, -4.347050371548027e-201,
      4.949239815783178e-202, -5.634849532560307e-203, 6.415435589388726e-204,
      -7.304154896021616e-205, 8.315986966390834e-206, -9.467986400842828e-207,
      1.0779570344306346e-207, -1.227284576554788e-208, 1.397298207386196e-209,
      -1.5908635353713472e-210, 1.8112431367878558e-211, -2.0621515470183537e-212,
      2.34781786967139e-213, -2.673057058836638e-214, 3.043351075948857e-215,
      -3.464941289173246e-216, 3.944933672719431e-217, -4.4914185792362777e-218,
      5.1136071040714664e-219, -5.8219863398384375e-220, 6.628496138132643e-221,
      -7.546730357745675e-222, 8.59216599144988e-223, -9.782424033324103e-224,
      1.1137566483583364e-224, -1.2680434496979011e-225, 1.4437033374317709e-226,
      -1.643697088619631e-227, 1.8713956316973152e-228, -2.1306368640446145e-229,
      2.4257903403934626e-230, -2.7618309224105366e-231, 3.1444226308304216e-232,
      -3.5800141134811955e-233, 4.0759473383321235e-234, -4.6405813436031265e-235,
      5.28343313076501e-236, -6.015338075205753e-237, 6.848632558311716e-238,
      -7.79736189925833e-239, 8.877517091235691e-240, -1.0107304332338107e-240,
      1.1507451894106239e-241, -1.3101559500042917e-242, 1.4916496102936488e-243,
      -1.698285276559562e-244, 1.9335458278376815e-245, -2.2013966204325068e-246,
      2.506352324667264e-247, -2.853553020414294e-248, 3.2488508340089613e-249,
      -3.698908576826895e-250, 4.211312048094427e-251, -4.794697894815057e-252,
      5.458899183912595e-253, -6.215111140234005e-254, 7.076079843953997e-255,
      -8.056317067907943e-256, 9.172344875972658e-257, -1.0442974105242008e-257,
      1.1889621425861463e-258, -1.3536670322618595e-259, 1.5411882082695182e-260,
      -1.7546863716848846e-261, 1.9977600700914734e-262, -2.2745063517075177e-263,
      2.5895898218252825e-264, -2.9483212655206646e-265, 3.3567471618321244e-266,
      -3.821751598185543e-267, 4.3511723028498403e-268, -4.9539327511699826e-269,
      5.640192572250229e-270, -6.421518791217661e-271, 7.311080793383253e-272,
      -8.323872296454316e-273, 9.476964072177442e-274, -1.0789791677077897e-274,
      1.2284483042045627e-275, -1.3986231442345678e-276, 1.5923720134525488e-277,
      -1.8129605817545817e-278, 2.064106906695428e-279, -2.3500441019762407e-280,
      2.6755916872905585e-281, -3.0462368221422907e-282, 3.468226792845406e-283,
      -3.9486743115893147e-284, 4.4956774024034685e-285, -5.1184558947193505e-286,
      5.827506825151875e-287, -6.634781366823467e-288, 7.553886268404435e-289,
      -8.60031319815867e-290, 9.791699858627273e-291, -1.1148127273082188e-291,
      1.2692458254563184e-292, -1.445072276245096e-293, 1.6452556641826435e-294,
      -1.873170114064222e-295, 2.1326571624152483e-296, -2.4280905072378926e-297,
      2.7644497274292015e-298, -3.1474042144239733e-299, 3.583408730744404e-300,
      -4.079812206111982e-301, 4.644981604898466e-302, -5.2884429527227413e-303,
      6.021041899220646e-304, -6.855126523300365e-305, 7.80475546209682e-306,
      -8.885934871673722e-307, 1.0116888213485908e-307, -1.1518363413898345e-308,
      1.311398257398733e-309, -1.4930640124042e-310, 1.6998956133725e-311,
      -1.93537924185e-312, 2.20348401415e-313, -2.508728881e-314, 2.8562588e-315,
      -3.25193143e-316, 3.702416e-317, -4.215304e-318, 4.79925e-319, -5.464e-320, 6.22e-321,
      -7.07e-322, 8e-323, -1e-323, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.4430735856182326, -0.49351876669127065, 0.056188507635692116, -0.006397220538325022,
      0.0007283416545124866, -8.292375767255976e-05, 9.4411043827228e-06,
      -1.0748964406247968e-06, 1.2238000039298804e-07, -1.3933309228824188e-08,
      1.5863466697386993e-09, -1.8061005574936383e-10, 2.056296575020479e-11,
      -2.341151818428497e-12, 2.665467570929778e-13, -3.03471022927823e-14,
      3.4551034408096173e-15, -3.9337330040679725e-16, 4.4786663011361616e-17,
      -5.099088274722691e-18, 5.805456241921507e-19, -6.609676154056836e-20,
      7.52530327350252e-21, -8.567770649917504e-22, 9.754649246902969e-23,
      -1.1105944103559874e-23, 1.2644431522799913e-24, -1.43960429697758e-25,
      1.639030215110373e-26, -1.866082264192209e-27, 2.1245874448374487e-28,
      -2.4189029055023397e-29, 2.7539893829577466e-30, -3.1354948163448118e-31,
      3.569849544142568e-32, -4.0643746886084655e-33, 4.627405554529847e-34,
      -5.268432122193164e-35, 5.9982590026036455e-36, -6.829187551027638e-37,
      7.775223208412133e-38, -8.852311565456082e-39, 1.0078607128233299e-39,
      -1.147477931545687e-40, 1.306436084502062e-41, -1.4874144381931614e-42,
      1.6934634133201531e-43, -1.9280560001405054e-44, 2.195146296305028e-45,
      -2.4992361538412396e-46, 2.8454510586292197e-47, -3.2396265213313137e-48,
      3.6884064359093995e-49, -4.1993550635791253e-50, 4.781084529709569e-51,
      -5.443399982650088e-52, 6.197464861160888e-53, -7.055989056057744e-54,
      8.033443137567179e-55, -9.146302259230298e-56, 1.0413323849396785e-56,
      -1.1855863770846051e-57, 1.3498236277459314e-58, -1.5368123835073086e-59,
      1.7497043714113738e-60, -1.9920879218510742e-61, 2.2680484504841624e-62,
      -2.5822373186037375e-63, 2.9399502326180057e-64, -3.347216504075721e-65,
      3.8109006747301063e-66, -4.33881821954886e-67, 4.939867277864013e-68,
      -5.624178633012402e-69, 6.403286468398922e-70, -7.290322778104819e-71,
      8.300238708864652e-72, -9.450056564168304e-73, 1.0759156718059719e-73,
      -1.2249604274612883e-74, 1.3946520978985644e-75, -1.5878508648674983e-76,
      1.807813126197899e-77, -2.0582463829347992e-78, 2.3433717298944056e-79,
      -2.6679950029297606e-80, 3.0375877821052855e-81, -3.458379616102385e-82,
      3.937463022314041e-83, -4.482913032422707e-84, 5.1039232984224096e-85,
      -5.810961053175023e-86, 6.615943537387057e-87, -7.532438866713433e-88,
      8.575894724637186e-89, -9.76389873578219e-90, 1.1116474908295035e-90,
      -1.265642114188246e-91, 1.440969349025925e-92, -1.6405843654815086e-93,
      1.867851708352986e-94, -2.1266020070678843e-95, 2.4211965415888924e-96,
      -2.756600752523828e-97, 3.1384679344652656e-98, -3.573234523225186e-99,
      4.06822858304708e-100, -4.63179332236577e-101, 5.27342771999394e-102,
      -6.003946632013477e-103, 6.835663078000318e-104, -7.782595779047875e-105,
      8.860705445677463e-106, -1.0088163798308364e-106, 1.1485659854672929e-107,
      -1.307674864670283e-108, 1.4888248244568425e-109, -1.6950691779778464e-110,
      1.9298842086265743e-111, -2.1972277633821123e-112, 2.5016059629882817e-113,
      -2.848149153379424e-114, 3.2426983785271413e-115, -3.6919038322224257e-116,
      4.2033369482145775e-117, -4.785618018005132e-118, 5.448561487316251e-119,
      -6.203341380230076e-120, 7.062679639250845e-121, -8.041060555793302e-122,
      9.154974905359487e-123, -1.0423197902343518e-123, 1.1867105659439516e-124,
      -1.3511035485629418e-125, 1.5382696095634083e-126, -1.7513634644977224e-127,
      1.9939768462617023e-128, -2.2701990443588673e-129, 2.5846858305653047e-130,
      -2.9427379327488633e-131, 3.350390379532147e-132, -3.814514221718679e-133,
      4.3429323450140496e-134, -4.944551326085012e-135, 5.629511554412658e-136,
      -6.4093581502688495e-137, 7.297235559667254e-138, -8.308109106219729e-139,
      9.45901723419199e-140, -1.076935869435785e-140, 1.2261219513218089e-141,
      -1.3959745256705306e-142, 1.5893564862942364e-143, -1.8095273187827102e-144,
      2.0601980396830613e-145, -2.3455937463100565e-146, 2.6705248314745694e-147,
      -3.0404680634664176e-148, 3.461658897908383e-149, -3.9411965774132973e-150,
      4.487163790516655e-151, -5.108762906756264e-152, 5.816471084164193e-153,
      -6.622216863533974e-154, 7.53958122598926e-155, -8.584026502713171e-156,
      9.77315699515047e-157, -1.1127015698480088e-157, 1.266842212968217e-158,
      -1.4423356954348788e-159, 1.6421399895188113e-160, -1.8696228303243805e-161,
      2.1286184795331696e-162, -2.4234923525318576e-163, 2.7592145982254567e-164,
      -3.1414438717360836e-165, 3.576622711990241e-166, -4.072086131799943e-167,
      4.636185250741837e-168, -5.27842805468736e-169, 6.009639654509581e-170,
      -6.842144745154277e-171, 7.789975340453693e-172, -8.86910728508833e-173,
      1.0097729530145806e-173, -1.149655071096179e-174, 1.308914819466427e-175,
      -1.4902365480676417e-176, 1.696676465243064e-177, -1.9317141506443807e-178,
      2.1993112041341174e-179, -2.503978019220052e-180, 2.850849806499156e-181,
      -3.2457731484990465e-182, 3.6954045448134115e-183, -4.2073226085262955e-184,
      4.790155805014928e-185, -5.453727886190168e-186, 6.209223471493238e-187,
      -7.069376566544407e-188, 8.048685196957258e-189, -9.163655775007721e-190,
      1.0433081317999309e-190, -1.1878358207742092e-191, 1.3523846830179884e-192,
      -1.539728217380743e-193, 1.753024130758324e-194, -1.995867561775719e-195,
      2.272351677455446e-196, -2.5871366642386596e-197, 2.945528276214267e-198,
      -3.3535672644997277e-199, 3.818131195120833e-200, -4.347050371548027e-201,
      4.949239815783178e-202, -5.634849532560307e-203, 6.415435589388726e-204,
      -7.304154896021616e-205, 8.315986966390834e-206, -9.467986400842828e-207,
      1.0779570344306346e-207, -1.227284576554788e-208, 1.397298207386196e-209,
      -1.5908635353713472e-210, 1.8112431367878558e-211, -2.0621515470183537e-212,
      2.34781786967139e-213, -2.673057058836638e-214, 3.043351075948857e-215,
      -3.464941289173246e-216, 3.944933672719431e-217, -4.4914185792362777e-218,
      5.1136071040714664e-219, -5.8219863398384375e-220, 6.628496138132643e-221,
      -7.546730357745675e-222, 8.59216599144988e-223, -9.782424033324103e-224,
      1.1137566483583364e-224, -1.2680434496979011e-225, 1.4437033374317709e-226,
      -1.643697088619631e-227, 1.8713956316973152e-228, -2.1306368640446145e-229,
      2.4257903403934626e-230, -2.7618309224105366e-231, 3.1444226308304216e-232,
      -3.5800141134811955e-233, 4.0759473383321235e-234, -4.6405813436031265e-235,
      5.28343313076501e-236, -6.015338075205753e-237, 6.848632558311716e-238,
      -7.79736189925833e-239, 8.877517091235691e-240, -1.0107304332338107e-240,
      1.1507451894106239e-241, -1.3101559500042917e-242, 1.4916496102936488e-243,
      -1.698285276559562e-244, 1.9335458278376815e-245, -2.2013966204325068e-246,
      2.506352324667264e-247, -2.853553020414294e-248, 3.2488508340089613e-249,
      -3.698908576826895e-250, 4.211312048094427e-251, -4.794697894815057e-252,
      5.458899183912595e-253, -6.215111140234005e-254, 7.076079843953997e-255,
      -8.056317067907943e-256, 9.172344875972658e-257, -1.0442974105242008e-257,
      1.1889621425861463e-258, -1.3536670322618595e-259, 1.5411882082695182e-260,
      -1.7546863716848846e-261, 1.9977600700914734e-262, -2.2745063517075177e-263,
      2.5895898218252825e-264, -2.9483212655206646e-265, 3.3567471618321244e-266,
      -3.821751598185543e-267, 4.3511723028498403e-268, -4.9539327511699826e-269,
      5.640192572250229e-270, -6.421518791217661e-271, 7.311080793383253e-272,
      -8.323872296454316e-273, 9.476964072177442e-274, -1.0789791677077897e-274,
      1.2284483042045627e-275, -1.3986231442345678e-276, 1.5923720134525488e-277,
      -1.8129605817545817e-278, 2.064106906695428e-279, -2.3500441019762407e-280,
      2.6755916872905585e-281, -3.0462368221422907e-282, 3.468226792845406e-283,
      -3.9486743115893147e-284, 4.4956774024034685e-285, -5.1184558947193505e-286,
      5.827506825151875e-287, -6.634781366823467e-288, 7.553886268404435e-289,
      -8.60031319815867e-290, 9.791699858627273e-291, -1.1148127273082188e-291,
      1.2692458254563184e-292, -1.445072276245096e-293, 1.6452556641826435e-294,
      -1.873170114064222e-295, 2.1326571624152483e-296, -2.4280905072378926e-297,
      2.7644497274292015e-298, -3.1474042144239733e-299, 3.583408730744404e-300,
      -4.079812206111982e-301, 4.644981604898466e-302, -5.2884429527227413e-303,
      6.021041899220646e-304, -6.855126523300365e-305, 7.80475546209682e-306,
      -8.885934871673722e-307, 1.0116888213485908e-307, -1.1518363413898345e-308,
      1.311398257398733e-309, -1.4930640124042e-310, 1.6998956133725e-311,
      -1.93537924185e-312, 2.20348401415e-313, -2.508728881e-314, 2.8562588e-315,
      -3.25193143e-316, 3.702416e-317, -4.215304e-318, 4.79925e-319, -5.464e-320, 6.22e-321,
      -7.07e-322, 8e-323, -1e-323, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_2_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<2>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.690972595621247), "design.b()[0] == 0.690972595621247");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.690972595621247));
    static_assert(almost_equal(design.b()[1], -1.3600651662362993), "design.b()[1] == -1.3600651662362993");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -1.3600651662362993));
    static_assert(almost_equal(design.b()[2], 0.6909725956212469), "design.b()[2] == 0.6909725956212469");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.6909725956212469));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.2616050537084245), "design.a()[1] == -1.2616050537084245");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.2616050537084245));
    static_assert(almost_equal(design.a()[2], 0.4804053037703697), "design.a()[2] == 0.4804053037703697");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.4804053037703697));
    std::cout << "max_deviation(cheby2,highpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.690972595621247, -0.48833064762650646, -0.2570547170014875, -0.08970489693527231,
      0.010318298090773129, 0.05611232527886857, 0.06583462801846048, 0.05610064074624732,
      0.03914954740992858, 0.02244022150335013, 0.009503046639023752, 0.001208690237427923,
      -0.003040424295457093, -0.004416475857242386, -0.004111212303828363,
      -0.003065027793585085, -0.0018918063584585786, -0.0009142568542272053,
      -0.00024459725937059807, 0.00013062870323398638, 0.0002823076528487073,
      0.00029340603967623996, 0.0002345404487206355, 0.00015494359778627013,
      8.280315049284812e-05, 3.002914696296932e-05, -1.894149098625257e-06,
      -1.681582954401323e-05, -2.0304976261915083e-05, -1.7538446967219232e-05,
      -1.2371975038885512e-05, -7.1829832904649676e-06, -3.118525593158546e-06,
      -4.836043788145712e-07, 8.880385065890173e-07, 1.3526799763094813e-06,
      1.2799294856445511e-06, 9.649308725565371e-07, 6.024767519408832e-07,
      2.96529806042524e-07, 8.467047484768151e-08, -3.563379258110055e-08,
      -8.563191799269609e-08, -9.09149975489168e-08, -7.35607927898819e-08,
      -4.9128620923743454e-08, -2.664192143330775e-08, -1.0009932662073532e-08,
      1.7033872544154246e-10, 5.023724938103682e-09, 6.256125143213045e-09,
      5.479334992361437e-09, 3.9072810174738894e-09, 2.2971438864390408e-09,
      1.021009812111162e-09, 1.845510322763359e-10, -2.57668013952859e-10,
      -4.137345633037882e-10, -3.981845354429762e-10, -3.035913436591425e-10,
      -1.9172241071635867e-10, -9.603107059629523e-11, -2.9048821017536685e-11,
      9.485696241211257e-12, 2.592241000095594e-11, 2.8146864677275275e-11,
      2.3056963471928318e-11, 1.556687856388539e-11, 8.562565125909106e-12,
      3.3241644103146235e-12, 8.028091904467548e-14, -1.4956634001367292e-12,
      -1.9255038835598448e-12, -1.7107008003533883e-12, -1.2332064970162874e-12,
      -7.339898112478271e-13, -3.3356631343004803e-13, -6.821634853336818e-14,
      7.4184936075692e-14, 1.263635859014076e-13, 1.2378210182730617e-13,
      9.545838835350135e-14, 6.096520693595684e-14, 3.105529711638931e-14,
      9.891511028961623e-15, -2.4399491419274947e-15, -7.830186528863532e-15,
      -8.706438387581927e-15, -7.222423531597045e-15, -4.929226849141175e-15,
      -2.749046933096615e-15, -1.1001847818616056e-15, -6.734195383641958e-17,
      4.435756550471362e-16, 5.919687198987672e-16, 5.337346313535313e-16,
      3.889773955492939e-16, 2.343269002951704e-16, 1.0876119776355133e-16,
      2.464179102800726e-17, -2.116124815666726e-17, -3.8535184721485297e-17,
      -3.84502079413496e-17, -2.9996469532973995e-17, -1.9372013730112834e-17,
      -1.0029367364392326e-17, -3.3466824117570725e-18, 5.959698314857072e-19,
      2.359642531903236e-18, 2.690629875261598e-18, 2.260927460960441e-18,
      1.559804648257169e-18, 8.816958833536645e-19, 3.6301355640447683e-19,
      3.4408358648954526e-20, -1.3098387867592194e-19, -1.817798812808651e-19,
      -1.664090668621293e-19, -1.2261450065008968e-19, -7.474727536204306e-20,
      -3.5396883916230193e-20, -8.747900107936696e-21, 5.9684557847916725e-21,
      1.1732371589634634e-20, 1.1934341475135332e-20, 9.420131980247508e-21,
      6.151165171218894e-21, 3.2348597006772238e-21, 1.1260629737909758e-21,
      -1.333970186297367e-22, -7.092609778415322e-22, -8.307225987861755e-22,
      -7.07311093346004e-22, -4.932637074905662e-22, -2.825079855220129e-22,
      -1.1944700101165369e-22, -1.4976605524359766e-23, 3.848841158853336e-23,
      5.575201529568262e-23, 5.184698719063419e-23, 3.8626857215327336e-23,
      2.3824270640835602e-23, 1.1500273167171416e-23, 3.063496772412719e-24,
      -1.6598692142218834e-24, -3.565819486707839e-24, -3.70124591096524e-24,
      -2.956471952589205e-24, -1.9518017903476595e-24, -1.0420981960675629e-24,
      -3.7706041862775092e-25, 2.4928170746207122e-26, 2.1259133114376886e-25,
      2.562306723058087e-25, 2.2113190807904597e-25, 1.558865588043531e-25,
      9.043432891875181e-26, 3.920367675650436e-26, 6.014425464474901e-27,
      -1.1245824679989687e-26, -1.7077151141659227e-26, -1.6142066361721105e-26,
      -1.2160958517502789e-26, -7.587592429635933e-27, -3.7303559839686844e-27,
      -1.0611163154613468e-27, 4.5337309349159435e-28, 1.0817436918293212e-27,
      1.1469304697289384e-27, 9.272978699872597e-28, 6.18892198355361e-28,
      3.3531871022899376e-28, 1.257206848758702e-28, -2.47903545236619e-30,
      -6.352444746303889e-29, -7.895182217385367e-29, -6.908853637369654e-29,
      -4.923357252771948e-29, -2.892282460943522e-29, -1.2837112328906258e-29,
      -2.300687446778004e-30, 3.264457938043907e-30, 5.223719084004839e-30,
      5.0220074881620696e-30, 3.826287673464396e-30, 2.4146648328973612e-30,
      1.208184464111835e-30, 3.642338331838096e-31, -1.208989798160019e-31,
      -3.27506629198175e-31, -3.5510350739539446e-31, -2.906644578328574e-31,
      -1.9611014059514395e-31, -1.0777679729785957e-31, -4.175940047842805e-32,
      -9.07325638143046e-34, 1.8916750861667262e-32, 2.4301352535633365e-32,
      2.1571001726857422e-32, 1.5539586145244684e-32, 9.241996776156e-33,
      4.194450236583275e-33, 8.51835347307956e-34, -9.403563609642993e-34,
      -1.5955845560652403e-33, -1.5612453563095666e-33, -1.2031477482511268e-33,
      -7.678667298935562e-34, -3.907459875290534e-34, -1.2407986295326844e-34,
      3.117666267065582e-35, 9.894125943691294e-35, 1.0984735882504296e-34,
      9.105207723498379e-35, 6.210050700558777e-35, 3.4604412653109394e-35,
      1.3823688951461195e-35, 8.158924696445106e-37, -5.611639426967657e-36,
      -7.471631730375373e-36, -6.73038700692761e-36, -4.901678750262077e-36,
      -2.950669068430622e-36, -1.3677865395487824e-36, -3.08089340543855e-37,
      2.684048390011324e-37, 4.866286545560082e-37, 4.849900616534149e-37,
      3.7808692616496314e-37, 2.440045788965823e-37, 1.2620244524803974e-37,
      4.19965488691139e-38, -7.645265754361069e-39, -2.9820670729419716e-38,
      -3.394908268008177e-38, -2.850432589755325e-38, -1.9651882227255026e-38,
      -1.1099284591204026e-38, -4.5620450817670634e-39, -4.23343944731836e-40,
      1.657537793189883e-39, 2.29453473296931e-39, 2.0985066679753378e-39,
      1.5451799621547276e-39, 9.41273115850558e-40, 4.452022707781088e-40,
      1.094768375850588e-40, -7.576100057108919e-41, -1.4817371461036257e-40,
      -1.5054072068588196e-40, -1.187394956280417e-40, -7.74817871082153e-41,
      -4.070833071935481e-41, -1.4135174291178643e-41, 1.7234906644159463e-42,
      8.964977231447245e-42, 1.0482286525390666e-41, 8.917683044684722e-42,
      6.214847954105819e-42, 3.5565813549197247e-42, 1.5013550920130134e-42,
      1.8551662530025097e-43, -4.872102370199742e-43, -7.037900679746996e-43,
      -6.53846724591062e-43, -4.8679185069882955e-43, -3.0002762459928982e-43,
      -1.4465898053868636e-43, -3.8367638776791045e-44, 2.1090134509140722e-44,
      4.50394374416385e-44, 4.669016941713386e-44, 3.7267369069361687e-44,
      2.458649613439551e-44, 1.3115006017646837e-44, 4.734474727186354e-45,
      -3.274812073847382e-46, -2.687618715738221e-45, -3.233389645303933e-45,
      -2.788114431570781e-45, -1.9641617224268845e-45, -1.1385713948690883e-45,
      -4.928337168580716e-46, -7.4785771009711895e-47, 1.4240982480414874e-46,
      2.1559243571026736e-46, 2.035780712884597e-46, 1.532633739937498e-46,
      9.55578620006006e-47, 4.692774388119078e-47, 1.3297775117599285e-47,
      -5.767796763060171e-48, -1.3665003239880152e-47, -1.4468956990331118e-47,
      -1.1689369228413862e-47, -7.796403615050238e-48, -4.2203472264378354e-48,
      -1.5789777422736878e-48, 3.5430891987702884e-50, 8.032490743127268e-49,
      9.963619031113423e-49, 8.711300967393394e-49, 6.203645897544312e-49,
      3.6415958282837e-49, 1.6139913086326483e-49, 2.8677764151688075e-50,
      -4.1356986307812434e-50, -6.595313293083301e-50, -6.333869024321079e-50,
      -4.822417684586281e-50, -3.041162249296227e-50, -1.5200306301881245e-50,
      -4.566878506488042e-51, 1.5407107629002297e-51, 4.137721140969652e-51,
      4.480004280210139e-51, 3.664212858903877e-51, 2.4705716435296173e-51,
      1.3565783794646812e-51, 5.245904183879193e-52, 1.0118474490169649e-53,
      -2.392505007480559e-52, -3.067006096571612e-52, -2.719978296298465e-52,
      -1.9581323690983126e-52, -1.1636976930024044e-52, -5.2742971488139955e-53,
      -1.0636145006666864e-53, 1.1919388947125283e-53, 2.014722180568309e-53,
      1.9691699180333444e-53, 1.516431499032651e-53, 9.671379701339516e-54,
      4.9164441581456273e-54, 1.556428692891186e-54, -3.98287544575692e-55,
      -1.2501981780711221e-54, -1.3859168907517524e-54, -1.1478779178828571e-54,
      -7.823667573392346e-55, -4.355912150808374e-55, -1.7369093857758363e-55,
      -9.869035892224914e-57, 7.099122255266391e-56, 9.430402232710526e-56,
      8.486987131746568e-56, 6.176810606887763e-56, 3.715501846327474e-56,
      1.7201233304557654e-56, 3.8516949356044033e-57, -3.404245914799361e-57,
      -6.14518852574696e-57, -6.117383107265161e-57, -4.765540283158613e-57,
      -3.0734064149585346e-57, -1.5880342378508313e-57, -5.269912775466571e-58,
      9.804521141935457e-59, 3.768637389927057e-58, 4.28351758097505e-58,
      3.593634037698727e-58, 2.4759222984452867e-58, 1.3972352327877543e-58,
      5.733128270080579e-59, 5.205514346316518e-60, -2.097494907496092e-59,
      -2.8962858455070744e-59, -2.6463211814834387e-59, -1.9472210948785065e-59,
      -1.1853172429218603e-59, -5.599468823247744e-60, -1.3699912639907835e-60,
      9.616266187978824e-61, 1.871344071396198e-60, 1.8989266097834718e-60,
      1.4966917904462626e-60, 9.759795118602479e-61, 5.1228201023881456e-61,
      1.7743183917231968e-61, -2.2254089756294457e-62, -1.133150686983356e-61,
      -1.3226788058163177e-61, -1.1243266658530482e-61, -7.830342901605308e-62,
      -4.477475242472538e-62, -1.8870671334858512e-62, -2.2973057830849017e-63,
      6.16727800912001e-63, 8.884306986506965e-63, 8.245693527466631e-63,
      6.134740428940652e-63, 3.778344624480935e-63, 1.8196168335796052e-63,
      4.8050099598404414e-64, -2.6795109283608696e-64, -5.688836798063825e-64,
      -5.8898139926645434e-64, -4.697671728474272e-64, -3.097108513009347e-64,
      -1.6505413381648155e-64, -5.9446393758134335e-65, 4.2950105046588664e-66,
      3.3976969809837936e-65, 4.080217099560253e-65, 3.5153508627635576e-65,
      2.4748264788574744e-65, 1.4334603936926569e-65, 6.195411106190442e-66,
      9.297422026240159e-67, -1.8033408929752813e-66, -2.721757069416401e-66,
      -2.5674479442510426e-66, -1.931558769878283e-66, -1.2034486960407365e-66,
      -5.903458792101085e-67, -1.6664020825391062e-67, 7.3371162547360185e-68,
      1.7262026933278947e-67, 1.825307085312068e-67, 1.4735397141420817e-67,
      9.821379454081653e-68, 5.311739013756194e-68, 1.983074003652853e-68,
      -4.9931409566230615e-70, -1.015672987771514e-68, -1.2573908603073292e-68,
      -1.0983959736287767e-68, -7.816846730990211e-69, -4.585020826168592e-69,
      -2.0292308173248978e-69, -3.5741953148897363e-70, 5.2393095999657674e-70,
      8.327001855244112e-70, 7.98839550289683e-70, 6.077864281711311e-70,
      3.8301967253539066e-70, 1.9123573088733437e-70, 5.72592824026934e-71,
      -1.963205933772269e-71, -5.227556823151392e-71, -5.6519775636580936e-71,
      -4.619217434154766e-71, -3.112388060735234e-71, -1.707507951888826e-71,
      -6.589929295814823e-72, -1.1092934000644731e-73, 3.0258879692245046e-72,
      3.870766597212001e-72, 3.4297260717380166e-72, 2.4674229419823927e-72,
      1.4652546578986364e-72, 6.632096134016978e-73, 1.3279249090684876e-73,
      -1.510777381670617e-73, -2.5439465490693188e-73, -2.4836703556990826e-73,
      -1.911285657814533e-73, -1.2181192332841655e-73, -6.185936136963928e-74,
      -1.9522988893671675e-74, 5.087263838073005e-75, 1.5797065177630914e-74,
      1.748570873237105e-74, 1.447106460909274e-74, 9.856541028157604e-75,
      5.483085783796219e-75, 2.1823541479969625e-75, 1.191655305308922e-76,
      -8.98074671857388e-76, -1.1902632975164661e-75, -1.0702023558483041e-75,
      -7.783638996187621e-76, -4.678569415261572e-76, -2.1632053620172583e-76,
      -4.8150125578063835e-77, 4.317509113977875e-77, 7.76014888811779e-77,
      7.716088777347335e-77, 6.006639912464731e-77, 3.871157296371546e-77,
      1.9982499370157367e-77, 6.612777222053385e-78, -1.2569855176211645e-78,
      -4.7626325315954995e-78, -5.404698761389278e-78, -4.530601343052595e-78,
      -3.119383600480772e-78, -1.758905200350096e-78, -7.204752635904353e-79,
      -6.3967846540131385e-80, 2.6541797939432555e-79, 3.655831568976078e-79,
      3.337133532756531e-79, 2.4538636543982277e-79, 1.4926301389740383e-79,
      7.042606123449044e-80, 1.7143131233148885e-80, -1.2205192340578672e-80,
      -2.363378350599361e-80, -2.3953061575460857e-80, -1.8865508590950478e-80,
      -1.2293643156733177e-80, -6.44663194960448e-81, -2.2271720718642765e-81,
      2.871846387032779e-82, 1.432258867268325e-81, 1.66898000156999e-81,
      1.4175288483111485e-81, 9.865747141659244e-82, 5.636792682764949e-82,
      2.3718488827724617e-82, 2.8439143608412565e-83, -7.806591100305871e-83,
      -1.1215066326797958e-82, -1.0398656586609971e-82, -7.731220355915317e-83,
      -4.7581768960620895e-83, -2.288820754911433e-83, -6.017344142831316e-84,
      3.4041045198927618e-84, 7.185399506476131e-84, 7.429786464339135e-84,
      5.921552118764568e-84, 3.9013512554813846e-84, 2.0772194157998525e-84,
      7.464006776299071e-85, -5.624435745575469e-86, -4.2953300987996857e-85,
      -5.148809283702578e-85, -4.4322644519921503e-85, -3.1182519440126605e-85,
      -1.8047190608525913e-85, -7.788179152996028e-86, -1.1556400921157302e-86,
      2.283521191331843e-86, 3.4360775047366106e-86, 3.2379570533216896e-86,
      2.4343131247199565e-86, 1.5156099986590257e-86, 7.4264429760595635e-87,
      2.0881671716421893e-87, -9.332603371154102e-88, -2.180572542146509e-87,
      -2.302678123401096e-87, -1.857511743043433e-87, -1.2372274189884509e-87,
      -6.685338712086506e-88, -2.490550964399134e-88, 6.958049158339236e-90,
      1.2842569924288776e-88, 1.5867982747130426e-88, 1.3849488520267671e-88,
      9.849521636588325e-89, 5.7728385336868624e-89, 2.5512798345240335e-89,
      4.454052832667807e-90, -6.63722807589934e-90, -1.0513311087257103e-89,
      -1.0075086828896723e-89, -7.660130053381146e-90, -4.8239336388604554e-90,
      -2.4059319523253125e-90, -7.178926047873284e-91, 2.5012553218808226e-91,
      6.604390503473522e-91, 7.130516113130711e-91, 5.823110937835714e-91,
      3.9209284281102647e-91, 2.1492097411534108e-91, 8.278190583503279e-92,
      1.1888949005880898e-93, -3.826895080445896e-92, -4.885145315089257e-92,
      -4.324663323997695e-92, -3.109167386085113e-92, -1.8449500892407015e-92,
      -8.339378538407326e-93, -1.6577640282137576e-93, 1.9148382041491614e-93,
      3.212168186942168e-93, 3.1325891888722793e-93, 2.4089477182641716e-93,
      1.5342281546134935e-93, 7.783187330424949e-94, 2.448795043322006e-94,
      -6.496722716233076e-95, -1.9960439477926812e-94, -2.20611312695898e-94,
      -1.8243333709455934e-94, -1.2417597535253573e-94, -6.901909532917778e-95,
      -2.742004230945733e-95, -1.4361244929404296e-96, 1.1360911837023144e-95,
      1.5022905611607376e-95, 1.349513133881502e-95, 9.808442363650133e-96,
      5.891247784744345e-96, 2.720400244658521e-96, 6.018840151541994e-97,
      -5.47554790647309e-97, -9.799461641975863e-97, -9.732568075820186e-97,
      -7.570943723116523e-97, -4.875963539495681e-97, -2.5144187239936003e-97,
      -8.297646239647447e-98, 1.6110484792365854e-98, 6.018740165511045e-98,
      6.81931677571017e-98, 5.71184980954733e-98, 3.930062638606992e-98,
      2.2141839434109325e-98, 9.054027171107081e-99, 7.855493361040418e-100,
      -3.3585496611147214e-99, -4.614545293030723e-99, -4.2082685920782925e-99,
      -3.0923208898678558e-99, -1.8796131110207413e-99, -8.85762043427954e-100,
      -2.1450576280111892e-100, 1.5490322914179748e-100, 2.984764028600122e-100,
      3.0214300541002663e-100, 2.3779549558369007e-100, 1.5485289668138642e-100,
      8.112497974351738e-101, 2.7955531556471984e-101, -3.704030646299165e-102,
      -1.8103009411910986e-101, -2.1059412193587963e-101, -1.787187911587243e-101,
      -1.2430199699764655e-101, -7.096257244220009e-102, -2.981140139031182e-102,
      -3.519418481725743e-103, 9.881439198073145e-103, 1.415722093501011e-102,
      1.3113725678436692e-102, 9.743138565033897e-103, 5.992089484517535e-103,
      2.8789949339285176e-103, 7.535229892162848e-104, -4.324360245065415e-104,
      -9.075599144554391e-104, -9.372376149058512e-104, -7.46427115097076e-104,
      -4.9144229953760873e-104, -2.6141854373208497e-104, -9.371546871052124e-105,
      7.354945976972656e-106, 5.430044522816168e-105, 6.497236106218407e-105,
      5.5883237182718545e-105, 3.928950759454757e-105, 2.2721237804561217e-105,
      9.790340609798462e-106, 1.4361400413095177e-106, -2.891490020716504e-106,
      -4.337847715685509e-106, -4.0835634585750785e-106, -3.06791924691387e-106,
      -1.9087368824935397e-106, -9.342274193968914e-107, -2.6165871177208065e-107,
      1.1869785408747924e-107, 2.75452045494139e-107, 2.904886139999421e-107,
      2.3415327987730116e-107, 1.558566903851304e-107, 8.414111069586644e-108,
      3.127846978943204e-108, -9.607602848102878e-110, -1.6238442811383435e-108,
      -2.0024947178721785e-108, -1.7462540509359223e-108, -1.2410738524816232e-108,
      -7.268353365160891e-109, -3.207606726596642e-109, -5.549773502829533e-110,
      8.407890540558566e-110, 1.3273577822479513e-109, 1.2706817652427163e-109,
      9.654288180925612e-110, 6.075476164744296e-110, 3.0268801868822213e-110,
      9.000363682668862e-111, -3.186388649287868e-111, -8.343786472037073e-111,
      -8.99580517319436e-111, -7.340753993984323e-111, -4.939499819953423e-111,
      -2.7051607832614974e-111, -1.0398826037781345e-111, -1.2347560359538659e-113,
      4.83987373602994e-112, 6.165327499539516e-112, 5.45310731881888e-112,
      3.9178117215762014e-112, 2.323029389429028e-112, 1.0486080873979267e-112,
      2.0693362292460092e-113, -2.4268838229859737e-113, -4.0558889956562863e-113,
      -3.9510421940033843e-113, -3.036184214352732e-113, -1.9323637233974055e-113,
      -9.792808392420693e-114, -3.071478742540485e-114, 8.295239865788158e-115,
      2.5220863319745884e-114, 2.78336913955088e-114, 2.2998889223461095e-114,
      1.5644061904088609e-114, 8.687839194947718e-115, 3.4451315229160143e-115,
      1.7271131244406133e-116, -1.4371659911833018e-115, -1.8961073080139992e-115,
      -1.701716397601079e-115, -1.2359939999043327e-115, -7.418226937120304e-116,
      -3.4210918636029906e-116, -7.523112191574859e-117, 6.943910399099046e-117,
      1.237461544969393e-116, 1.2275986004398804e-116, 9.542615088251698e-117,
      6.1415626354085905e-117, 3.163903558263038e-117, 1.041157455062499e-117,
      -2.064265429944579e-118, -7.606063333334523e-118, -8.60416387922598e-118,
      -7.201063466819736e-118, -4.951412099725286e-118, -2.787297445759215e-118,
      -1.1377839098975983e-118, -9.640145462660939e-120, 4.2497686251762083e-119,
      5.824647275551826e-119, 5.306793051573626e-119, 3.896885489083306e-119,
      2.3669188987628095e-119, 1.1140323872557279e-119, 2.683884971967106e-120,
      -1.965867829890387e-120, -3.769501364355113e-120, -3.811208639240323e-120,
      -2.9973516319969576e-120, -1.9505491226020506e-120, -1.0208790093051684e-120,
      -3.5089197360158406e-121, 4.774860337656211e-122, 2.2881024449604344e-121,
      2.657294784867404e-121, 2.2532399796528145e-121, 1.5661204372162138e-121,
      8.933570214153705e-122, 3.746911686016972e-122, 4.353882063937273e-123,
      -1.2507482852103585e-122, -1.787113161089149e-122, -1.653764885682157e-122,
      -1.2278594963970854e-122, -7.545963236275368e-123, -3.621323210443232e-123,
      -9.43558902643888e-124, 5.49304196916567e-124, 1.1462956521030624e-123,
      1.1822837381551751e-123, 9.408886280146308e-124, 6.190544697088389e-124,
      3.2899436035000483e-124, 1.1766389708825666e-124, -9.605268417109975e-126,
      -6.864441540074132e-125, -8.1987719486718e-125, -7.045898001373953e-125,
      -4.950406997901805e-125, -2.860571716781372e-125, -1.2307099567727825e-125,
      -1.7843607655653604e-126, 3.66123734689018e-126, 5.4762519152800313e-126,
      5.1499892518895264e-126, 3.866432001844722e-126, 2.4038280023791546e-126,
      1.1752271156936754e-126, 3.2786074671963723e-127, -1.5095456453988348e-127,
      -3.479510831260991e-127, -3.6645747148190014e-127, -2.951670522043532e-127,
      -1.9633613184304644e-127, -1.0589883878151406e-127, -3.928159112945374e-128,
      1.3165099271358115e-129, 2.0532000296460536e-128, 2.5270816985295094e-128,
      2.2018108580554538e-128, 1.563792254798232e-128, 9.151265974945131e-129,
      4.0327424698197697e-129, 6.914115696522506e-130, -1.0650625407756839e-129,
      -1.6758460691072754e-129, -1.602594176587352e-129, -1.2167555723244338e-129,
      -7.651702369483194e-130, -3.808068075444628e-130, -1.1283595276746247e-130,
      4.058720180478664e-131, 1.0541200907827442e-130, 1.134900163624915e-130,
      9.253908994607767e-131, 6.22265777560231e-131, 3.4049095355799957e-131,
      1.306253278560446e-131, 1.2239137904120682e-133, -6.120900448549995e-132,
      -7.780956406764001e-132, -6.875980886124555e-132, -4.936759508921804e-132,
      -2.924983059080945e-132, -1.3185279578232067e-132, -2.582841600246393e-133,
      3.075752225278625e-133, 5.1211953549235625e-133, 4.9833182586923066e-133,
      3.826730089254219e-133, 2.4338094979297055e-133, 1.2321249313762925e-133,
      3.852400490523452e-134, -1.0589855916555377e-134, -3.1867352021320725e-134,
      -3.511658940992637e-134, -2.8994021740406954e-134, -1.9708808552174317e-134,
      -1.0935850650270028e-134, -4.328508287521863e-135, -2.0722727692601305e-136,
      1.8179993589034102e-135, 2.393150261752366e-135, 2.1458339302420933e-135,
      1.5575128523471502e-135, 9.340960846382686e-136, 4.302229060708042e-136,
      9.402667922869096e-137, -8.805683218157845e-137, -1.5626385989121238e-136,
      -1.5484030613749106e-136, -1.202773256614499e-136, -7.735637759514072e-137,
      -3.981133173953014e-137, -1.306376324028483e-137, 2.6442651934382533e-138,
      9.611919479220209e-138, 1.0856127167319545e-137, 9.078527800760542e-138,
      6.238175484086021e-138, 3.508740810730806e-138, 1.4297925505657617e-138,
      1.1821581251779685e-139, -5.377382580824563e-139, -7.352048072922652e-139,
      -6.692057891675981e-139, -4.910771168040995e-139, -2.9805536189066416e-139,
      -1.4011209937320446e-139, -3.357875598545972e-140, 2.494746741279054e-140,
      4.760526343462868e-140, 4.807414527150537e-140, 3.7780763585862874e-140,
      2.4569327910229397e-140, 1.2846709050621873e-140, 4.404237623638735e-141,
      -6.1521872019814994e-142, -2.891982159999073e-141, -3.352984972127426e-141,
      -2.8408192177715166e-141, -1.9732001177401976e-141, -1.1246546212488619e-141,
      -4.709341518813894e-142, -5.3842861019642e-143, 1.583108387219196e-142,
      2.2559215019240002e-142, 2.08554830193336e-142, 1.5473816230582418e-142,
      9.502760101477477e-143, 4.555026781462942e-143, 1.1814684540636302e-143,
      -6.977124521871189e-144, -1.4478212672841138e-143, -1.491393865134851e-143,
      -1.1860090216090422e-143, -7.798014525843776e-144, -4.140364291691301e-144,
      -1.477296977497912e-144, 1.2528763263040502e-145, 8.677648137276169e-145,
      1.0345876312166309e-144, 8.883621651070751e-145, 6.237408117707508e-145,
      3.6014066454780666e-145, 1.5470688828671873e-145, 2.2165506753877138e-146,
      -4.635789432405015e-146, -6.913378076382327e-146, -6.49489488887097e-146,
      -4.872768720240766e-146, -3.0273276909634025e-146, -1.4783879769008632e-146,
      -4.107974640101773e-147, 1.9196126848767717e-147, 4.3952858692624e-147,
      4.6229227501549883e-147, 3.720784061318565e-147, 2.473283367422098e-147,
      1.3328223983510137e-147, 4.9331702601880586e-148, -1.7923696046035565e-149,
      -2.59604741252472e-148, -3.1890801488710306e-148, -2.7762046866806864e-148,
      -1.9704228451789243e-148, -1.152191963586704e-148, -5.070096186089616e-149,
      -8.612676684719751e-150, 1.3491214552834593e-149, 2.1158160019519537e-149,
      2.0211990582311647e-149, 1.5335057172752082e-149, 9.636838152552371e-150,
      4.7908409156182765e-150, 1.414560950594303e-150, -5.1692814133474855e-151,
      -1.3317217386839807e-150, -1.4317718548917074e-150, -1.1665644214787803e-150,
      -7.839127767349574e-151, -4.2856458552720694e-151, -1.6408339130474934e-151,
      -1.1237358042682803e-153, 7.740882067373258e-152, 9.819920800399734e-152,
      8.670100907773723e-152, 6.220701086292322e-152, 3.6829054677570855e-152,
      1.657914355427796e-152, 3.2234580942805433e-153, -3.8979774732838104e-153,
      -6.466274444510352e-153, -6.285275465716928e-153, -4.823102752720473e-153,
      -3.0653711379989693e-153, -1.5502435761550587e-153, -4.831745774369239e-154,
      1.3516974740297943e-154, 4.026504660797955e-154, 4.4304959932263e-154,
      3.655181940785775e-154, 2.4829622352398142e-154, 1.376548913546556e-154,
      5.438328391364369e-155, 2.4800859260023797e-156, -2.2997129090688517e-155,
      -3.0204740714255447e-155, -2.7058510744398653e-155, -1.96266362628199e-155,
      -1.1762011422733967e-155, -5.41027289686684e-156, -1.175094958139853e-156,
      1.1166180567233843e-156, 1.9732528337485077e-156, 1.9530365105659094e-156,
      1.515999604794323e-156, 9.743436646954536e-157, 5.009426407715937e-157,
      1.6391190300073188e-157, -3.386341632272028e-158, -1.2146640472122224e-157,
      -1.3697446524686787e-157, -1.1445457252646403e-157, -7.85932075337189e-158,
      -4.416900412921102e-158, -1.7967245087156952e-158, -1.4485433572467364e-159,
      6.804070213994068e-159, 9.279937279324547e-159, 8.43890435166431e-159,
      6.188433290177821e-159, 3.753264304875404e-159, 1.7621810403037015e-159,
      4.200884274821649e-160, -3.165754348495616e-160, -6.012058771011353e-160,
      -6.063998549248577e-160, -4.762146295239534e-160, -3.0947707674582035e-160,
      -1.6166181027308797e-160, -5.527892776813842e-161, 7.923016436444318e-162,
      3.6552007663385925e-161, 4.230793847338907e-161, 3.581613064506695e-161,
      2.486085339189104e-161, 1.4158319156291324e-161, 5.918921173871889e-162,
      6.656092503025971e-163, -2.0037451305499658e-162, -2.847697197129471e-162,
      -2.6300593872096007e-162, -1.9500473774239004e-162, -1.1966951474823112e-162,
      -5.729435430940904e-163, -1.4792977361034787e-163, 8.86161668826304e-164,
      1.8286485180735682e-163, 1.8813154461558762e-163, 1.4949846276756036e-163,
      9.822862430935464e-164
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.690972595621247, -0.48833064762650646, -0.2570547170014875, -0.08970489693527231,
      0.010318298090773129, 0.05611232527886857, 0.06583462801846048, 0.05610064074624732,
      0.03914954740992858, 0.02244022150335013, 0.009503046639023752, 0.001208690237427923,
      -0.003040424295457093, -0.004416475857242386, -0.004111212303828363,
      -0.003065027793585085, -0.0018918063584585786, -0.0009142568542272053,
      -0.00024459725937059807, 0.00013062870323398638, 0.0002823076528487073,
      0.00029340603967623996, 0.0002345404487206355, 0.00015494359778627013,
      8.280315049284812e-05, 3.002914696296932e-05, -1.894149098625257e-06,
      -1.681582954401323e-05, -2.0304976261915083e-05, -1.7538446967219232e-05,
      -1.2371975038885512e-05, -7.1829832904649676e-06, -3.118525593158546e-06,
      -4.836043788145712e-07, 8.880385065890173e-07, 1.3526799763094813e-06,
      1.2799294856445511e-06, 9.649308725565371e-07, 6.024767519408832e-07,
      2.96529806042524e-07, 8.467047484768151e-08, -3.563379258110055e-08,
      -8.563191799269609e-08, -9.09149975489168e-08, -7.35607927898819e-08,
      -4.9128620923743454e-08, -2.664192143330775e-08, -1.0009932662073532e-08,
      1.7033872544154246e-10, 5.023724938103682e-09, 6.256125143213045e-09,
      5.479334992361437e-09, 3.9072810174738894e-09, 2.2971438864390408e-09,
      1.021009812111162e-09, 1.845510322763359e-10, -2.57668013952859e-10,
      -4.137345633037882e-10, -3.981845354429762e-10, -3.035913436591425e-10,
      -1.9172241071635867e-10, -9.603107059629523e-11, -2.9048821017536685e-11,
      9.485696241211257e-12, 2.592241000095594e-11, 2.8146864677275275e-11,
      2.3056963471928318e-11, 1.556687856388539e-11, 8.562565125909106e-12,
      3.3241644103146235e-12, 8.028091904467548e-14, -1.4956634001367292e-12,
      -1.9255038835598448e-12, -1.7107008003533883e-12, -1.2332064970162874e-12,
      -7.339898112478271e-13, -3.3356631343004803e-13, -6.821634853336818e-14,
      7.4184936075692e-14, 1.263635859014076e-13, 1.2378210182730617e-13,
      9.545838835350135e-14, 6.096520693595684e-14, 3.105529711638931e-14,
      9.891511028961623e-15, -2.4399491419274947e-15, -7.830186528863532e-15,
      -8.706438387581927e-15, -7.222423531597045e-15, -4.929226849141175e-15,
      -2.749046933096615e-15, -1.1001847818616056e-15, -6.734195383641958e-17,
      4.435756550471362e-16, 5.919687198987672e-16, 5.337346313535313e-16,
      3.889773955492939e-16, 2.343269002951704e-16, 1.0876119776355133e-16,
      2.464179102800726e-17, -2.116124815666726e-17, -3.8535184721485297e-17,
      -3.84502079413496e-17, -2.9996469532973995e-17, -1.9372013730112834e-17,
      -1.0029367364392326e-17, -3.3466824117570725e-18, 5.959698314857072e-19,
      2.359642531903236e-18, 2.690629875261598e-18, 2.260927460960441e-18,
      1.559804648257169e-18, 8.816958833536645e-19, 3.6301355640447683e-19,
      3.4408358648954526e-20, -1.3098387867592194e-19, -1.817798812808651e-19,
      -1.664090668621293e-19, -1.2261450065008968e-19, -7.474727536204306e-20,
      -3.5396883916230193e-20, -8.747900107936696e-21, 5.9684557847916725e-21,
      1.1732371589634634e-20, 1.1934341475135332e-20, 9.420131980247508e-21,
      6.151165171218894e-21, 3.2348597006772238e-21, 1.1260629737909758e-21,
      -1.333970186297367e-22, -7.092609778415322e-22, -8.307225987861755e-22,
      -7.07311093346004e-22, -4.932637074905662e-22, -2.825079855220129e-22,
      -1.1944700101165369e-22, -1.4976605524359766e-23, 3.848841158853336e-23,
      5.575201529568262e-23, 5.184698719063419e-23, 3.8626857215327336e-23,
      2.3824270640835602e-23, 1.1500273167171416e-23, 3.063496772412719e-24,
      -1.6598692142218834e-24, -3.565819486707839e-24, -3.70124591096524e-24,
      -2.956471952589205e-24, -1.9518017903476595e-24, -1.0420981960675629e-24,
      -3.7706041862775092e-25, 2.4928170746207122e-26, 2.1259133114376886e-25,
      2.562306723058087e-25, 2.2113190807904597e-25, 1.558865588043531e-25,
      9.043432891875181e-26, 3.920367675650436e-26, 6.014425464474901e-27,
      -1.1245824679989687e-26, -1.7077151141659227e-26, -1.6142066361721105e-26,
      -1.2160958517502789e-26, -7.587592429635933e-27, -3.7303559839686844e-27,
      -1.0611163154613468e-27, 4.5337309349159435e-28, 1.0817436918293212e-27,
      1.1469304697289384e-27, 9.272978699872597e-28, 6.18892198355361e-28,
      3.3531871022899376e-28, 1.257206848758702e-28, -2.47903545236619e-30,
      -6.352444746303889e-29, -7.895182217385367e-29, -6.908853637369654e-29,
      -4.923357252771948e-29, -2.892282460943522e-29, -1.2837112328906258e-29,
      -2.300687446778004e-30, 3.264457938043907e-30, 5.223719084004839e-30,
      5.0220074881620696e-30, 3.826287673464396e-30, 2.4146648328973612e-30,
      1.208184464111835e-30, 3.642338331838096e-31, -1.208989798160019e-31,
      -3.27506629198175e-31, -3.5510350739539446e-31, -2.906644578328574e-31,
      -1.9611014059514395e-31, -1.0777679729785957e-31, -4.175940047842805e-32,
      -9.07325638143046e-34, 1.8916750861667262e-32, 2.4301352535633365e-32,
      2.1571001726857422e-32, 1.5539586145244684e-32, 9.241996776156e-33,
      4.194450236583275e-33, 8.51835347307956e-34, -9.403563609642993e-34,
      -1.5955845560652403e-33, -1.5612453563095666e-33, -1.2031477482511268e-33,
      -7.678667298935562e-34, -3.907459875290534e-34, -1.2407986295326844e-34,
      3.117666267065582e-35, 9.894125943691294e-35, 1.0984735882504296e-34,
      9.105207723498379e-35, 6.210050700558777e-35, 3.4604412653109394e-35,
      1.3823688951461195e-35, 8.158924696445106e-37, -5.611639426967657e-36,
      -7.471631730375373e-36, -6.73038700692761e-36, -4.901678750262077e-36,
      -2.950669068430622e-36, -1.3677865395487824e-36, -3.08089340543855e-37,
      2.684048390011324e-37, 4.866286545560082e-37, 4.849900616534149e-37,
      3.7808692616496314e-37, 2.440045788965823e-37, 1.2620244524803974e-37,
      4.19965488691139e-38, -7.645265754361069e-39, -2.9820670729419716e-38,
      -3.394908268008177e-38, -2.850432589755325e-38, -1.9651882227255026e-38,
      -1.1099284591204026e-38, -4.5620450817670634e-39, -4.23343944731836e-40,
      1.657537793189883e-39, 2.29453473296931e-39, 2.0985066679753378e-39,
      1.5451799621547276e-39, 9.41273115850558e-40, 4.452022707781088e-40,
      1.094768375850588e-40, -7.576100057108919e-41, -1.4817371461036257e-40,
      -1.5054072068588196e-40, -1.187394956280417e-40, -7.74817871082153e-41,
      -4.070833071935481e-41, -1.4135174291178643e-41, 1.7234906644159463e-42,
      8.964977231447245e-42, 1.0482286525390666e-41, 8.917683044684722e-42,
      6.214847954105819e-42, 3.5565813549197247e-42, 1.5013550920130134e-42,
      1.8551662530025097e-43, -4.872102370199742e-43, -7.037900679746996e-43,
      -6.53846724591062e-43, -4.8679185069882955e-43, -3.0002762459928982e-43,
      -1.4465898053868636e-43, -3.8367638776791045e-44, 2.1090134509140722e-44,
      4.50394374416385e-44, 4.669016941713386e-44, 3.7267369069361687e-44,
      2.458649613439551e-44, 1.3115006017646837e-44, 4.734474727186354e-45,
      -3.274812073847382e-46, -2.687618715738221e-45, -3.233389645303933e-45,
      -2.788114431570781e-45, -1.9641617224268845e-45, -1.1385713948690883e-45,
      -4.928337168580716e-46, -7.4785771009711895e-47, 1.4240982480414874e-46,
      2.1559243571026736e-46, 2.035780712884597e-46, 1.532633739937498e-46,
      9.55578620006006e-47, 4.692774388119078e-47, 1.3297775117599285e-47,
      -5.767796763060171e-48, -1.3665003239880152e-47, -1.4468956990331118e-47,
      -1.1689369228413862e-47, -7.796403615050238e-48, -4.2203472264378354e-48,
      -1.5789777422736878e-48, 3.5430891987702884e-50, 8.032490743127268e-49,
      9.963619031113423e-49, 8.711300967393394e-49, 6.203645897544312e-49,
      3.6415958282837e-49, 1.6139913086326483e-49, 2.8677764151688075e-50,
      -4.1356986307812434e-50, -6.595313293083301e-50, -6.333869024321079e-50,
      -4.822417684586281e-50, -3.041162249296227e-50, -1.5200306301881245e-50,
      -4.566878506488042e-51, 1.5407107629002297e-51, 4.137721140969652e-51,
      4.480004280210139e-51, 3.664212858903877e-51, 2.4705716435296173e-51,
      1.3565783794646812e-51, 5.245904183879193e-52, 1.0118474490169649e-53,
      -2.392505007480559e-52, -3.067006096571612e-52, -2.719978296298465e-52,
      -1.9581323690983126e-52, -1.1636976930024044e-52, -5.2742971488139955e-53,
      -1.0636145006666864e-53, 1.1919388947125283e-53, 2.014722180568309e-53,
      1.9691699180333444e-53, 1.516431499032651e-53, 9.671379701339516e-54,
      4.9164441581456273e-54, 1.556428692891186e-54, -3.98287544575692e-55,
      -1.2501981780711221e-54, -1.3859168907517524e-54, -1.1478779178828571e-54,
      -7.823667573392346e-55, -4.355912150808374e-55, -1.7369093857758363e-55,
      -9.869035892224914e-57, 7.099122255266391e-56, 9.430402232710526e-56,
      8.486987131746568e-56, 6.176810606887763e-56, 3.715501846327474e-56,
      1.7201233304557654e-56, 3.8516949356044033e-57, -3.404245914799361e-57,
      -6.14518852574696e-57, -6.117383107265161e-57, -4.765540283158613e-57,
      -3.0734064149585346e-57, -1.5880342378508313e-57, -5.269912775466571e-58,
      9.804521141935457e-59, 3.768637389927057e-58, 4.28351758097505e-58,
      3.593634037698727e-58, 2.4759222984452867e-58, 1.3972352327877543e-58,
      5.733128270080579e-59, 5.205514346316518e-60, -2.097494907496092e-59,
      -2.8962858455070744e-59, -2.6463211814834387e-59, -1.9472210948785065e-59,
      -1.1853172429218603e-59, -5.599468823247744e-60, -1.3699912639907835e-60,
      9.616266187978824e-61, 1.871344071396198e-60, 1.8989266097834718e-60,
      1.4966917904462626e-60, 9.759795118602479e-61, 5.1228201023881456e-61,
      1.7743183917231968e-61, -2.2254089756294457e-62, -1.133150686983356e-61,
      -1.3226788058163177e-61, -1.1243266658530482e-61, -7.830342901605308e-62,
      -4.477475242472538e-62, -1.8870671334858512e-62, -2.2973057830849017e-63,
      6.16727800912001e-63, 8.884306986506965e-63, 8.245693527466631e-63,
      6.134740428940652e-63, 3.778344624480935e-63, 1.8196168335796052e-63,
      4.8050099598404414e-64, -2.6795109283608696e-64, -5.688836798063825e-64,
      -5.8898139926645434e-64, -4.697671728474272e-64, -3.097108513009347e-64,
      -1.6505413381648155e-64, -5.9446393758134335e-65, 4.2950105046588664e-66,
      3.3976969809837936e-65, 4.080217099560253e-65, 3.5153508627635576e-65,
      2.4748264788574744e-65, 1.4334603936926569e-65, 6.195411106190442e-66,
      9.297422026240159e-67, -1.8033408929752813e-66, -2.721757069416401e-66,
      -2.5674479442510426e-66, -1.931558769878283e-66, -1.2034486960407365e-66,
      -5.903458792101085e-67, -1.6664020825391062e-67, 7.3371162547360185e-68,
      1.7262026933278947e-67, 1.825307085312068e-67, 1.4735397141420817e-67,
      9.821379454081653e-68, 5.311739013756194e-68, 1.983074003652853e-68,
      -4.9931409566230615e-70, -1.015672987771514e-68, -1.2573908603073292e-68,
      -1.0983959736287767e-68, -7.816846730990211e-69, -4.585020826168592e-69,
      -2.0292308173248978e-69, -3.5741953148897363e-70, 5.2393095999657674e-70,
      8.327001855244112e-70, 7.98839550289683e-70, 6.077864281711311e-70,
      3.8301967253539066e-70, 1.9123573088733437e-70, 5.72592824026934e-71,
      -1.963205933772269e-71, -5.227556823151392e-71, -5.6519775636580936e-71,
      -4.619217434154766e-71, -3.112388060735234e-71, -1.707507951888826e-71,
      -6.589929295814823e-72, -1.1092934000644731e-73, 3.0258879692245046e-72,
      3.870766597212001e-72, 3.4297260717380166e-72, 2.4674229419823927e-72,
      1.4652546578986364e-72, 6.632096134016978e-73, 1.3279249090684876e-73,
      -1.510777381670617e-73, -2.5439465490693188e-73, -2.4836703556990826e-73,
      -1.911285657814533e-73, -1.2181192332841655e-73, -6.185936136963928e-74,
      -1.9522988893671675e-74, 5.087263838073005e-75, 1.5797065177630914e-74,
      1.748570873237105e-74, 1.447106460909274e-74, 9.856541028157604e-75,
      5.483085783796219e-75, 2.1823541479969625e-75, 1.191655305308922e-76,
      -8.98074671857388e-76, -1.1902632975164661e-75, -1.0702023558483041e-75,
      -7.783638996187621e-76, -4.678569415261572e-76, -2.1632053620172583e-76,
      -4.8150125578063835e-77, 4.317509113977875e-77, 7.76014888811779e-77,
      7.716088777347335e-77, 6.006639912464731e-77, 3.871157296371546e-77,
      1.9982499370157367e-77, 6.612777222053385e-78, -1.2569855176211645e-78,
      -4.7626325315954995e-78, -5.404698761389278e-78, -4.530601343052595e-78,
      -3.119383600480772e-78, -1.758905200350096e-78, -7.204752635904353e-79,
      -6.3967846540131385e-80, 2.6541797939432555e-79, 3.655831568976078e-79,
      3.337133532756531e-79, 2.4538636543982277e-79, 1.4926301389740383e-79,
      7.042606123449044e-80, 1.7143131233148885e-80, -1.2205192340578672e-80,
      -2.363378350599361e-80, -2.3953061575460857e-80, -1.8865508590950478e-80,
      -1.2293643156733177e-80, -6.44663194960448e-81, -2.2271720718642765e-81,
      2.871846387032779e-82, 1.432258867268325e-81, 1.66898000156999e-81,
      1.4175288483111485e-81, 9.865747141659244e-82, 5.636792682764949e-82,
      2.3718488827724617e-82, 2.8439143608412565e-83, -7.806591100305871e-83,
      -1.1215066326797958e-82, -1.0398656586609971e-82, -7.731220355915317e-83,
      -4.7581768960620895e-83, -2.288820754911433e-83, -6.017344142831316e-84,
      3.4041045198927618e-84, 7.185399506476131e-84, 7.429786464339135e-84,
      5.921552118764568e-84, 3.9013512554813846e-84, 2.0772194157998525e-84,
      7.464006776299071e-85, -5.624435745575469e-86, -4.2953300987996857e-85,
      -5.148809283702578e-85, -4.4322644519921503e-85, -3.1182519440126605e-85,
      -1.8047190608525913e-85, -7.788179152996028e-86, -1.1556400921157302e-86,
      2.283521191331843e-86, 3.4360775047366106e-86, 3.2379570533216896e-86,
      2.4343131247199565e-86, 1.5156099986590257e-86, 7.4264429760595635e-87,
      2.0881671716421893e-87, -9.332603371154102e-88, -2.180572542146509e-87,
      -2.302678123401096e-87, -1.857511743043433e-87, -1.2372274189884509e-87,
      -6.685338712086506e-88, -2.490550964399134e-88, 6.958049158339236e-90,
      1.2842569924288776e-88, 1.5867982747130426e-88, 1.3849488520267671e-88,
      9.849521636588325e-89, 5.7728385336868624e-89, 2.5512798345240335e-89,
      4.454052832667807e-90, -6.63722807589934e-90, -1.0513311087257103e-89,
      -1.0075086828896723e-89, -7.660130053381146e-90, -4.8239336388604554e-90,
      -2.4059319523253125e-90, -7.178926047873284e-91, 2.5012553218808226e-91,
      6.604390503473522e-91, 7.130516113130711e-91, 5.823110937835714e-91,
      3.9209284281102647e-91, 2.1492097411534108e-91, 8.278190583503279e-92,
      1.1888949005880898e-93, -3.826895080445896e-92, -4.885145315089257e-92,
      -4.324663323997695e-92, -3.109167386085113e-92, -1.8449500892407015e-92,
      -8.339378538407326e-93, -1.6577640282137576e-93, 1.9148382041491614e-93,
      3.212168186942168e-93, 3.1325891888722793e-93, 2.4089477182641716e-93,
      1.5342281546134935e-93, 7.783187330424949e-94, 2.448795043322006e-94,
      -6.496722716233076e-95, -1.9960439477926812e-94, -2.20611312695898e-94,
      -1.8243333709455934e-94, -1.2417597535253573e-94, -6.901909532917778e-95,
      -2.742004230945733e-95, -1.4361244929404296e-96, 1.1360911837023144e-95,
      1.5022905611607376e-95, 1.349513133881502e-95, 9.808442363650133e-96,
      5.891247784744345e-96, 2.720400244658521e-96, 6.018840151541994e-97,
      -5.47554790647309e-97, -9.799461641975863e-97, -9.732568075820186e-97,
      -7.570943723116523e-97, -4.875963539495681e-97, -2.5144187239936003e-97,
      -8.297646239647447e-98, 1.6110484792365854e-98, 6.018740165511045e-98,
      6.81931677571017e-98, 5.71184980954733e-98, 3.930062638606992e-98,
      2.2141839434109325e-98, 9.054027171107081e-99, 7.855493361040418e-100,
      -3.3585496611147214e-99, -4.614545293030723e-99, -4.2082685920782925e-99,
      -3.0923208898678558e-99, -1.8796131110207413e-99, -8.85762043427954e-100,
      -2.1450576280111892e-100, 1.5490322914179748e-100, 2.984764028600122e-100,
      3.0214300541002663e-100, 2.3779549558369007e-100, 1.5485289668138642e-100,
      8.112497974351738e-101, 2.7955531556471984e-101, -3.704030646299165e-102,
      -1.8103009411910986e-101, -2.1059412193587963e-101, -1.787187911587243e-101,
      -1.2430199699764655e-101, -7.096257244220009e-102, -2.981140139031182e-102,
      -3.519418481725743e-103, 9.881439198073145e-103, 1.415722093501011e-102,
      1.3113725678436692e-102, 9.743138565033897e-103, 5.992089484517535e-103,
      2.8789949339285176e-103, 7.535229892162848e-104, -4.324360245065415e-104,
      -9.075599144554391e-104, -9.372376149058512e-104, -7.46427115097076e-104,
      -4.9144229953760873e-104, -2.6141854373208497e-104, -9.371546871052124e-105,
      7.354945976972656e-106, 5.430044522816168e-105, 6.497236106218407e-105,
      5.5883237182718545e-105, 3.928950759454757e-105, 2.2721237804561217e-105,
      9.790340609798462e-106, 1.4361400413095177e-106, -2.891490020716504e-106,
      -4.337847715685509e-106, -4.0835634585750785e-106, -3.06791924691387e-106,
      -1.9087368824935397e-106, -9.342274193968914e-107, -2.6165871177208065e-107,
      1.1869785408747924e-107, 2.75452045494139e-107, 2.904886139999421e-107,
      2.3415327987730116e-107, 1.558566903851304e-107, 8.414111069586644e-108,
      3.127846978943204e-108, -9.607602848102878e-110, -1.6238442811383435e-108,
      -2.0024947178721785e-108, -1.7462540509359223e-108, -1.2410738524816232e-108,
      -7.268353365160891e-109, -3.207606726596642e-109, -5.549773502829533e-110,
      8.407890540558566e-110, 1.3273577822479513e-109, 1.2706817652427163e-109,
      9.654288180925612e-110, 6.075476164744296e-110, 3.0268801868822213e-110,
      9.000363682668862e-111, -3.186388649287868e-111, -8.343786472037073e-111,
      -8.99580517319436e-111, -7.340753993984323e-111, -4.939499819953423e-111,
      -2.7051607832614974e-111, -1.0398826037781345e-111, -1.2347560359538659e-113,
      4.83987373602994e-112, 6.165327499539516e-112, 5.45310731881888e-112,
      3.9178117215762014e-112, 2.323029389429028e-112, 1.0486080873979267e-112,
      2.0693362292460092e-113, -2.4268838229859737e-113, -4.0558889956562863e-113,
      -3.9510421940033843e-113, -3.036184214352732e-113, -1.9323637233974055e-113,
      -9.792808392420693e-114, -3.071478742540485e-114, 8.295239865788158e-115,
      2.5220863319745884e-114, 2.78336913955088e-114, 2.2998889223461095e-114,
      1.5644061904088609e-114, 8.687839194947718e-115, 3.4451315229160143e-115,
      1.7271131244406133e-116, -1.4371659911833018e-115, -1.8961073080139992e-115,
      -1.701716397601079e-115, -1.2359939999043327e-115, -7.418226937120304e-116,
      -3.4210918636029906e-116, -7.523112191574859e-117, 6.943910399099046e-117,
      1.237461544969393e-116, 1.2275986004398804e-116, 9.542615088251698e-117,
      6.1415626354085905e-117, 3.163903558263038e-117, 1.041157455062499e-117,
      -2.064265429944579e-118, -7.606063333334523e-118, -8.60416387922598e-118,
      -7.201063466819736e-118, -4.951412099725286e-118, -2.787297445759215e-118,
      -1.1377839098975983e-118, -9.640145462660939e-120, 4.2497686251762083e-119,
      5.824647275551826e-119, 5.306793051573626e-119, 3.896885489083306e-119,
      2.3669188987628095e-119, 1.1140323872557279e-119, 2.683884971967106e-120,
      -1.965867829890387e-120, -3.769501364355113e-120, -3.811208639240323e-120,
      -2.9973516319969576e-120, -1.9505491226020506e-120, -1.0208790093051684e-120,
      -3.5089197360158406e-121, 4.774860337656211e-122, 2.2881024449604344e-121,
      2.657294784867404e-121, 2.2532399796528145e-121, 1.5661204372162138e-121,
      8.933570214153705e-122, 3.746911686016972e-122, 4.353882063937273e-123,
      -1.2507482852103585e-122, -1.787113161089149e-122, -1.653764885682157e-122,
      -1.2278594963970854e-122, -7.545963236275368e-123, -3.621323210443232e-123,
      -9.43558902643888e-124, 5.49304196916567e-124, 1.1462956521030624e-123,
      1.1822837381551751e-123, 9.408886280146308e-124, 6.190544697088389e-124,
      3.2899436035000483e-124, 1.1766389708825666e-124, -9.605268417109975e-126,
      -6.864441540074132e-125, -8.1987719486718e-125, -7.045898001373953e-125,
      -4.950406997901805e-125, -2.860571716781372e-125, -1.2307099567727825e-125,
      -1.7843607655653604e-126, 3.66123734689018e-126, 5.4762519152800313e-126,
      5.1499892518895264e-126, 3.866432001844722e-126, 2.4038280023791546e-126,
      1.1752271156936754e-126, 3.2786074671963723e-127, -1.5095456453988348e-127,
      -3.479510831260991e-127, -3.6645747148190014e-127, -2.951670522043532e-127,
      -1.9633613184304644e-127, -1.0589883878151406e-127, -3.928159112945374e-128,
      1.3165099271358115e-129, 2.0532000296460536e-128, 2.5270816985295094e-128,
      2.2018108580554538e-128, 1.563792254798232e-128, 9.151265974945131e-129,
      4.0327424698197697e-129, 6.914115696522506e-130, -1.0650625407756839e-129,
      -1.6758460691072754e-129, -1.602594176587352e-129, -1.2167555723244338e-129,
      -7.651702369483194e-130, -3.808068075444628e-130, -1.1283595276746247e-130,
      4.058720180478664e-131, 1.0541200907827442e-130, 1.134900163624915e-130,
      9.253908994607767e-131, 6.22265777560231e-131, 3.4049095355799957e-131,
      1.306253278560446e-131, 1.2239137904120682e-133, -6.120900448549995e-132,
      -7.780956406764001e-132, -6.875980886124555e-132, -4.936759508921804e-132,
      -2.924983059080945e-132, -1.3185279578232067e-132, -2.582841600246393e-133,
      3.075752225278625e-133, 5.1211953549235625e-133, 4.9833182586923066e-133,
      3.826730089254219e-133, 2.4338094979297055e-133, 1.2321249313762925e-133,
      3.852400490523452e-134, -1.0589855916555377e-134, -3.1867352021320725e-134,
      -3.511658940992637e-134, -2.8994021740406954e-134, -1.9708808552174317e-134,
      -1.0935850650270028e-134, -4.328508287521863e-135, -2.0722727692601305e-136,
      1.8179993589034102e-135, 2.393150261752366e-135, 2.1458339302420933e-135,
      1.5575128523471502e-135, 9.340960846382686e-136, 4.302229060708042e-136,
      9.402667922869096e-137, -8.805683218157845e-137, -1.5626385989121238e-136,
      -1.5484030613749106e-136, -1.202773256614499e-136, -7.735637759514072e-137,
      -3.981133173953014e-137, -1.306376324028483e-137, 2.6442651934382533e-138,
      9.611919479220209e-138, 1.0856127167319545e-137, 9.078527800760542e-138,
      6.238175484086021e-138, 3.508740810730806e-138, 1.4297925505657617e-138,
      1.1821581251779685e-139, -5.377382580824563e-139, -7.352048072922652e-139,
      -6.692057891675981e-139, -4.910771168040995e-139, -2.9805536189066416e-139,
      -1.4011209937320446e-139, -3.357875598545972e-140, 2.494746741279054e-140,
      4.760526343462868e-140, 4.807414527150537e-140, 3.7780763585862874e-140,
      2.4569327910229397e-140, 1.2846709050621873e-140, 4.404237623638735e-141,
      -6.1521872019814994e-142, -2.891982159999073e-141, -3.352984972127426e-141,
      -2.8408192177715166e-141, -1.9732001177401976e-141, -1.1246546212488619e-141,
      -4.709341518813894e-142, -5.3842861019642e-143, 1.583108387219196e-142,
      2.2559215019240002e-142, 2.08554830193336e-142, 1.5473816230582418e-142,
      9.502760101477477e-143, 4.555026781462942e-143, 1.1814684540636302e-143,
      -6.977124521871189e-144, -1.4478212672841138e-143, -1.491393865134851e-143,
      -1.1860090216090422e-143, -7.798014525843776e-144, -4.140364291691301e-144,
      -1.477296977497912e-144, 1.2528763263040502e-145, 8.677648137276169e-145,
      1.0345876312166309e-144, 8.883621651070751e-145, 6.237408117707508e-145,
      3.6014066454780666e-145, 1.5470688828671873e-145, 2.2165506753877138e-146,
      -4.635789432405015e-146, -6.913378076382327e-146, -6.49489488887097e-146,
      -4.872768720240766e-146, -3.0273276909634025e-146, -1.4783879769008632e-146,
      -4.107974640101773e-147, 1.9196126848767717e-147, 4.3952858692624e-147,
      4.6229227501549883e-147, 3.720784061318565e-147, 2.473283367422098e-147,
      1.3328223983510137e-147, 4.9331702601880586e-148, -1.7923696046035565e-149,
      -2.59604741252472e-148, -3.1890801488710306e-148, -2.7762046866806864e-148,
      -1.9704228451789243e-148, -1.152191963586704e-148, -5.070096186089616e-149,
      -8.612676684719751e-150, 1.3491214552834593e-149, 2.1158160019519537e-149,
      2.0211990582311647e-149, 1.5335057172752082e-149, 9.636838152552371e-150,
      4.7908409156182765e-150, 1.414560950594303e-150, -5.1692814133474855e-151,
      -1.3317217386839807e-150, -1.4317718548917074e-150, -1.1665644214787803e-150,
      -7.839127767349574e-151, -4.2856458552720694e-151, -1.6408339130474934e-151,
      -1.1237358042682803e-153, 7.740882067373258e-152, 9.819920800399734e-152,
      8.670100907773723e-152, 6.220701086292322e-152, 3.6829054677570855e-152,
      1.657914355427796e-152, 3.2234580942805433e-153, -3.8979774732838104e-153,
      -6.466274444510352e-153, -6.285275465716928e-153, -4.823102752720473e-153,
      -3.0653711379989693e-153, -1.5502435761550587e-153, -4.831745774369239e-154,
      1.3516974740297943e-154, 4.026504660797955e-154, 4.4304959932263e-154,
      3.655181940785775e-154, 2.4829622352398142e-154, 1.376548913546556e-154,
      5.438328391364369e-155, 2.4800859260023797e-156, -2.2997129090688517e-155,
      -3.0204740714255447e-155, -2.7058510744398653e-155, -1.96266362628199e-155,
      -1.1762011422733967e-155, -5.41027289686684e-156, -1.175094958139853e-156,
      1.1166180567233843e-156, 1.9732528337485077e-156, 1.9530365105659094e-156,
      1.515999604794323e-156, 9.743436646954536e-157, 5.009426407715937e-157,
      1.6391190300073188e-157, -3.386341632272028e-158, -1.2146640472122224e-157,
      -1.3697446524686787e-157, -1.1445457252646403e-157, -7.85932075337189e-158,
      -4.416900412921102e-158, -1.7967245087156952e-158, -1.4485433572467364e-159,
      6.804070213994068e-159, 9.279937279324547e-159, 8.43890435166431e-159,
      6.188433290177821e-159, 3.753264304875404e-159, 1.7621810403037015e-159,
      4.200884274821649e-160, -3.165754348495616e-160, -6.012058771011353e-160,
      -6.063998549248577e-160, -4.762146295239534e-160, -3.0947707674582035e-160,
      -1.6166181027308797e-160, -5.527892776813842e-161, 7.923016436444318e-162,
      3.6552007663385925e-161, 4.230793847338907e-161, 3.581613064506695e-161,
      2.486085339189104e-161, 1.4158319156291324e-161, 5.918921173871889e-162,
      6.656092503025971e-163, -2.0037451305499658e-162, -2.847697197129471e-162,
      -2.6300593872096007e-162, -1.9500473774239004e-162, -1.1966951474823112e-162,
      -5.729435430940904e-163, -1.4792977361034787e-163, 8.86161668826304e-164,
      1.8286485180735682e-163, 1.8813154461558762e-163, 1.4949846276756036e-163,
      9.822862430935464e-164
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_3_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<3>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.7458222773335648), "design.b()[0] == 0.7458222773335648");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.7458222773335648));
    static_assert(almost_equal(design.b()[1], -2.2021811941302643), "design.b()[1] == -2.2021811941302643");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -2.2021811941302643));
    static_assert(almost_equal(design.b()[2], 2.2021811941302643), "design.b()[2] == 2.2021811941302643");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 2.2021811941302643));
    static_assert(almost_equal(design.b()[3], -0.7458222773335647), "design.b()[3] == -0.7458222773335647");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.7458222773335647));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.376982034148168), "design.a()[1] == -2.376982034148168");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.376982034148168));
    static_assert(almost_equal(design.a()[2], 1.962787700251268), "design.a()[2] == 1.962787700251268");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 1.962787700251268));
    static_assert(almost_equal(design.a()[3], -0.5562372085282224), "design.a()[3] == -0.5562372085282224");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.5562372085282224));
    std::cout << "max_deviation(cheby2,highpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.7458222773335648, -0.4293750402409082, -0.2823263549577324, -0.1592808014527014,
      -0.06329528026527798, 0.005142230364950651, 0.04786027840939462, 0.06846272540850705,
      0.07165540237608871, 0.06256747640194843, 0.04615894015854065, 0.026769699348307835,
      0.007833252829132976, -0.008248415354085686, -0.020091044574191703,
      -0.027209017109187893, -0.029828965191284258, -0.02867277678943793,
      -0.02474141703256992, -0.019123310502712848, -0.01284248178217972,
      -0.006753446572534988, -0.001482852740579287, 0.0025874013261372175,
      0.005304213318400867, 0.006704682395494101, 0.006965073828885586,
      0.006346388027475117, 0.005143682900100708, 0.00364406270531676,
      0.0020960112121765585, 0.000690767355683076, -0.00044512016570699307,
      -0.001247992880687468, -0.0017085497640878615, -0.0018592394159029058,
      -0.001760038302779173, -0.0014846461191699383, -0.0011085737623561407,
      -0.0007000135671566918, -0.000313840140196869, 1.135566976106085e-05,
      0.0002536201975041877, 0.0004059923205222263, 0.00047355029373580054,
      0.00046981679804419525, 0.0004130954313482445, 0.0003231760796162063,
      0.000218694687697605, 0.00011528635912364671, 2.454492168492379e-05,
      -4.6293687215139475e-05, -9.408917061134092e-05, -0.0001191307895643382,
      -0.00012424495105456277, -0.00011383546562579699, -9.298337273022476e-05,
      -6.669461941987226e-05, -3.93448134438253e-05, -1.43353477096189e-05,
      6.052623007227888e-06, 2.0639171110860646e-05, 2.9205071144101043e-05,
      3.227631234158283e-05, 3.087713506293388e-05, 2.6287793685096243e-05,
      1.9833638264810705e-05, 1.2721855130154074e-05, 5.932648825772362e-06,
      1.6370648330306556e-07, -4.179033590553807e-06, -6.954848814700903e-06,
      -8.237935314994353e-06, -8.25506651036959e-06, -7.321372364535307e-06,
      -5.782073708148251e-06, -3.965360850262223e-06, -2.1490280703329742e-06,
      -5.412441490337966e-07, 7.258769954461729e-07, 1.5923745608426987e-06,
      2.059243149609788e-06, 2.173050562031924e-06, 2.0091830000191852e-06,
      1.6559826404009698e-06, 1.201372883718074e-06, 7.228817458550273e-07,
      2.8135616440166025e-07, -8.18365522799835e-08, -3.446727089731921e-07,
      -5.021522911553492e-07, -5.626081560935309e-07, -5.434109240619473e-07,
      -4.66713423501978e-07, -3.5571273506969723e-07, -2.317287888704934e-07,
      -1.1222995859392754e-07, -9.794837474938792e-09, 6.810525496559025e-08,
      1.1868367512453415e-07, 1.4298455369371082e-07, 1.4480353444375456e-07,
      1.2956335268716875e-07, 1.0328449427153405e-07, 7.174514601583831e-08,
      3.987934576041344e-08, 1.1422677031314254e-08, -1.1215871521996506e-08,
      -2.6897839122401878e-08, -3.5567587694566105e-08, -3.798745422179185e-08,
      -3.544545150260854e-08, -2.9475909196887746e-08, -2.1621845857435214e-08,
      -1.3255866121703467e-08, -5.46545996316803e-09, 1.0002756560832534e-09,
      5.7317688874674515e-09, 8.620890721543242e-09, 9.797847429157404e-09,
      9.556552164870422e-09, 8.279918571386184e-09, 6.373661945957372e-09,
      4.214067505617538e-09, 2.1122162714446206e-09, 2.9464819032653535e-10,
      -1.1014375171874614e-09, -2.021535751329332e-09, -2.4793718640820738e-09,
      -2.538237398496734e-09, -2.291317498719799e-09, -1.8435182674795424e-09,
      -1.2965020826868691e-09, -7.378432265247679e-10, -2.345152071929569e-10,
      1.6962847617955996e-10, 4.5309154790536425e-10, 6.135996983314015e-10,
      6.635466118530345e-10, 6.248988122463991e-10, 5.242791049352998e-10,
      3.887476258371232e-10, 2.425895147033847e-10, 1.0522540544656706e-10,
      -9.796923169665622e-12, -9.488492745187281e-11, -1.4778020177497878e-10,
      -1.704813292762062e-10, -1.67948421639894e-10, -1.467925715867972e-10,
      -1.141042678396057e-10, -7.652030190524966e-11, -3.957641966673721e-11,
      -7.3483705488638e-12, 1.7649725839428522e-11, 3.436249535919347e-11,
      4.294893220553439e-11, 4.445999122964885e-11, 4.0494663015973753e-11,
      3.287935668829419e-11, 2.340151506162064e-11, 1.3614422289658209e-11,
      4.717752840130654e-12, -2.491413460418761e-12, -7.609144032360353e-12,
      -1.0572493293495545e-11, -1.158130916714664e-11, -1.100949306061028e-11,
      -9.3185301808242e-12, -6.982636341355019e-12, -4.431194398393711e-12,
      -2.0107499640283528e-12, 3.3975176246987965e-14, 1.5626384786132243e-12,
      2.5292235844414493e-12, 2.9636896919946455e-12, 2.9495058752168983e-12,
      2.600677066549934e-12, 2.041023291334744e-12, 1.3875236507991294e-12,
      7.386167295281136e-13, 1.6755743872645892e-13, -2.7967452808952766e-13,
      -5.828149006906106e-13, -7.431971423823836e-13, -7.781897154754559e-13,
      -7.151880963627992e-13, -5.85961957958673e-13, -4.219167228964686e-13,
      -2.5058377662859977e-13, -9.343402466233213e-14, 3.506597647329914e-14,
      1.2735833006474153e-13, 1.8192991408417854e-13, 2.0197177434442045e-13,
      1.9383492334754765e-13, 1.6551060346441786e-13, 1.2530314343306152e-13,
      8.079934069967586e-14, 3.817826853378217e-14, 1.855377008966695e-15,
      -2.558203835640376e-14, -4.321358322691802e-14, -5.1473771000010227e-14,
      -5.176282085913004e-14, -4.604421351925458e-14, -3.647846689260678e-14,
      -2.5126051453887972e-14, -1.3736191550970109e-14, -3.624256380434784e-15,
      4.370390799052039e-15, 9.861405413507158e-15, 1.2846287941643706e-14,
      1.3610524368200359e-14, 1.2622716552177981e-14, 1.0434983987407607e-14,
      7.598736753491781e-15, 4.601627141495227e-15, 1.8276043701741323e-15,
      -4.611342809315663e-16, -2.1237110439344108e-15, -3.1263327492178148e-15,
      -3.519342906919598e-15, -3.410374497495848e-15, -2.9376585409516683e-15,
      -2.246509931767145e-15, -1.4708908861508403e-15, -7.208941344360057e-16,
      -7.609827970570667e-17, 4.1591365600208214e-16, 7.369959145074195e-16,
      8.931471449800095e-16, 9.077748523409793e-16, 8.14650834567027e-16,
      6.514427578259819e-16, 4.544192433789699e-16, 2.546416511491625e-16,
      7.570682939470602e-17, -6.708883607508854e-17, -1.664242303931195e-16,
      -2.2179530796998958e-16, -2.3786533676544177e-16, -2.226358789264478e-16,
      -1.856931300155027e-16, -1.367118200481626e-16, -8.432370830686624e-17,
      -3.5389089111364964e-17, 5.3461073253070004e-18, 3.526488577440651e-17,
      5.3645998080053645e-17, 6.12717934065847e-17, 5.996188855048006e-17,
      5.2104709568064106e-17, 4.0241152533073564e-17, 2.673504704457054e-17,
      1.3546465472512048e-17, 2.1081099026027954e-18, -6.706868508885817e-18,
      -1.2544829998768316e-17, -1.548206734457715e-17, -1.5908367723554833e-17,
      -1.4403794133090582e-17, -1.1624513301050956e-17, -8.208495365723587e-18,
      -4.706920523808874e-18, -1.5427186089209646e-18, 1.005800744594187e-18,
      2.800635077444402e-18, 3.82476844032673e-18, 4.153817583042096e-18,
      3.924158754621194e-18, 3.3020713183115373e-18, 2.4571815588254502e-18,
      1.54217456252599e-18, 6.795304201564745e-19, -4.4953851469202426e-20,
      -5.828135742150744e-19, -9.191224244063917e-19, -1.0658031798416946e-18,
      -1.0535354163854549e-18, -9.235394764525712e-19, -7.202097718895451e-19,
      -4.85229362617661e-19, -2.5346961586537055e-19, -5.069797143830433e-20,
      1.0709625097298019e-19, 2.1308598767851644e-19, 2.680942621768771e-19,
      2.785836086264088e-19, 2.545024673672024e-19, 2.0727131609039192e-19,
      1.4810445071323571e-19, 8.677577069750784e-20, 3.085887200501845e-20,
      -1.4590224819550104e-20, -4.69822042246648e-20, -6.58734887245935e-20,
      -7.24796325675812e-20, -6.912036114195869e-20, -5.86770107900726e-20,
      -4.4121474273701196e-20, -2.815275333651864e-20, -1.2955838557986625e-20,
      -7.992319868501943e-23, 9.579975632382594e-21, 1.5721782763457566e-20,
      1.8522480576638354e-20, 1.8497820627915757e-20, 1.6358330806915133e-20,
      1.2879056517730083e-20, 8.794531564896486e-21, 4.724702068886088e-21,
      1.1325439952939452e-21, -1.6897046904938765e-21, -3.6112860263515066e-21,
      -4.6374673107719e-21, -4.874865307319571e-21, -4.493835114985138e-21,
      -3.692971538740014e-21, -2.669264180049972e-21, -1.5959121867025628e-21,
      -6.084238744296583e-22, 2.0148013573940548e-22, 7.854158203724513e-22,
      1.133028564572122e-21, 1.2636547786323892e-21, 1.2166676790570355e-21,
      1.0419438037242661e-21, 7.915131529080085e-22, 5.13053895456494e-22,
      2.455155237617426e-22, 1.683918020505629e-23, -1.564887548098433e-22,
      -2.6845782493043824e-22, -3.215986450265848e-22, -3.2455335276639857e-22,
      -2.89553854919493e-22, -2.3012011475282844e-22, -1.5918728442852405e-22,
      -8.776901231317884e-23, -2.4175891766955786e-23, 2.6260386718234596e-23,
      6.105222003745174e-23, 8.012893556935905e-23, 8.523949790426073e-23,
      7.929618239655691e-23, 6.574925831451339e-23, 4.8056614657935625e-23,
      2.92853612867298e-23, 1.1858029383450122e-23, -2.5637469374993027e-24,
      -1.30791670207212e-23, -1.946097691150109e-23, -2.20128157676942e-23,
      -2.1401420837534727e-23, -1.8489228271822497e-23, -1.4186465034040367e-23,
      -9.334809260121975e-24, -4.6280515464104106e-24, -5.695862883879915e-25,
      2.5376180320341716e-24, 4.575554959655328e-24, 5.5783813870768726e-24,
      5.69038691052267e-24, 5.1218629980253366e-24, 4.108458180883225e-24,
      2.8778065196669412e-24, 1.6254339870540994e-24, 5.00381454305664e-25,
      -4.0024104507081077e-25, -1.0293814738011325e-24, -1.3829022857672796e-24,
      -1.4893055542564803e-24, -1.3982892261691623e-24, -1.1697394524390167e-24,
      -8.643119327083648e-25, -5.362842220811318e-25, -2.2892973811360695e-25,
      2.768774361404237e-26, 2.1685250465967294e-25, 3.3377010654531176e-25,
      3.8313107109755923e-25, 3.7619724473839953e-25, 3.2786449045976546e-25,
      2.540444361047937e-25, 1.6958557654211602e-25, 8.683700313637858e-26,
      1.485848055861155e-26, -4.0794452637769337e-26, -7.78297516762157e-26,
      -9.666423183178851e-26, -9.969725556387768e-26, -9.053902384836716e-26,
      -7.329332858593387e-26, -5.1963366002128e-26, -3.001791745026424e-26,
      -1.0127471325570771e-26, 5.94202411555007e-27, 1.7305078113249792e-26,
      2.383765154654224e-26, 2.600064989688204e-26, 2.4640556765713209e-26,
      2.079579368148604e-26, 1.5529575138220542e-26, 9.801787558461972e-27,
      4.384808084092624e-27, -1.7809049663616882e-28, -3.5776463362704804e-27,
      -5.715453820894171e-27, -6.662431385302543e-27, -6.608277256792159e-27,
      -5.8099660180311925e-27, -4.54543176016118e-27, -3.0764494867787596e-27,
      -1.622666887375131e-27, -3.4697109943171977e-28, 6.489708637231812e-28,
      1.3210349902581377e-27, 1.6732861733995235e-27, 1.7454416833325096e-27,
      1.5993868181349103e-27, 1.3065262949697887e-27, 9.372123652918213e-28,
      5.529416717348064e-28, 2.0152205571001994e-28, -8.498041646207304e-29,
      -2.899752034970573e-28, -4.103732671419665e-28, -4.535593901216879e-28,
      -4.339219182158791e-28, -3.694486921275938e-28, -2.7876290884631478e-28,
      -1.788285938402274e-28, -8.342105518384368e-29, -2.3460872567328058e-30,
      5.869009595431744e-29, 9.770828000913603e-29, 1.1574964667688528e-28,
      1.1599983553719855e-28, 1.0288652315261844e-28, 8.126062702183903e-29,
      5.573407305789397e-29, 3.021084354893078e-29, 7.616663607210489e-30,
      -1.019143435993624e-29, -2.2370354738012866e-29, -2.8933637597003666e-29,
      -3.053533461987191e-29, -2.8234577472470045e-29, -2.3272669988409124e-29,
      -1.688512635478475e-29, -1.0161454141649424e-29, -3.9568005985123776e-30,
      1.1473977212943633e-30, 4.841524430307579e-30, 7.055198734458326e-30,
      7.905421342443009e-30, 7.63622323867089e-30, 6.558865720481389e-30,
      4.9993104324983525e-30, 3.2571616153941895e-30, 1.5779147749354185e-30,
      1.383607945510784e-31, -9.564761047374682e-31, -1.6674044730893174e-30,
      -2.0090695200978153e-30, -2.0347887620266478e-30, -1.8207517972248984e-30,
      -1.4515551775295078e-30, -1.008396566693274e-30, -5.606157707467659e-31,
      -1.607142370177269e-31, 1.57447194018759e-31, 3.7786172780621347e-31,
      4.99739883958976e-31, 5.337883618756439e-31, 4.981028013406917e-31,
      4.142420967624702e-31, 3.038889182146091e-31, 1.8633251829900978e-31,
      7.685648501806705e-32, -1.4010367408061965e-32, -8.051027526211105e-32,
      -1.2112166435407566e-31, -1.376725297449621e-31, -1.342918275409975e-31,
      -1.1635968982459023e-31, -8.957712850672641e-32, -5.923196841787e-32,
      -2.969602777291876e-32, -4.153277338081485e-33, 1.5467707675162733e-32,
      2.8400429335451315e-32, 3.483727652379286e-32, 3.5667281573791316e-32,
      3.219968517120758e-32, 2.590856102907163e-32, 1.8222507229121046e-32,
      1.0372230376804822e-32, 3.298997866446235e-33, -2.380790995017596e-33,
      -6.364909386628866e-33, -8.621262614935721e-33, -9.323905027244203e-33,
      -8.781445946384862e-33, -7.36796019353476e-33, -5.4636978193019995e-33,
      -3.409936892742988e-33, -1.4796134646123093e-33, 1.3685554559149639e-34,
      1.3327365041349776e-33, 2.0762562817273894e-33, 2.3954692086126957e-33,
      2.360054612647259e-33, 2.0629009132126405e-33, 1.6036413490230216e-33,
      1.075540326267042e-33, 5.5639476249760085e-34, 1.0348801829074705e-34,
      -2.4784008734550048e-34, -4.8274897485503515e-34, -6.034642787527534e-34,
      -6.247478770375574e-34, -5.690651579068017e-34, -4.620794936566775e-34,
      -3.2890857734649304e-34, -1.913810474469381e-34, -6.635740900471543e-35,
      3.495880802902175e-35, 1.0688870523812546e-34, 1.4854535363962583e-34,
      1.6273519071193795e-34, 1.5471110661747078e-34, 1.3095734303381674e-34,
      9.813756268104328e-35, 6.228583527678222e-35, 2.827245739723699e-35,
      -4.629841692258764e-37, -2.1947637542313642e-35, -3.553420771643558e-35,
      -4.1643149343913363e-35, -4.1447004632163444e-35, -3.6547572555400764e-35,
      -2.868472159702879e-35, -1.9502308163348856e-35, -1.0383737129620177e-35,
      -2.358575483433906e-36, 3.9268705177178304e-36, 8.187662664968874e-36,
      1.0442386460632463e-35, 1.0934992932975161e-35, 1.0050376664152406e-35,
      8.23493903116919e-36, 5.929996374417918e-36, 3.522451262182509e-36,
      1.3140589192259148e-36, -4.918449394455224e-37, -1.7890068114576876e-36,
      -2.556121387157286e-36, -2.8379965053257852e-36, -2.7238552419163468e-36,
      -2.3259801646975923e-36, -1.7610627511080924e-36, -1.1357188982931446e-36,
      -5.367878237431356e-37, -2.632855739361893e-38, 3.5928892051867397e-37,
      6.071193171081108e-37, 7.232589120504736e-37, 7.273769779812023e-37,
      6.470606662362988e-37, 5.126685111022998e-37, 3.5315526313861743e-37,
      1.931034865833286e-37, 5.100001308832895e-38, -6.135693574383939e-38,
      -1.3853518800173778e-37, -1.8049690925919936e-37, -1.9125175812857984e-37,
      -1.7738330590057858e-37, -1.4664942973158605e-37, -1.067986328060465e-37,
      -6.468392943918559e-38, -2.570136472584546e-38, 6.463765514064304e-39,
      2.983096871554952e-38, 4.392462187931354e-38, 4.945156546854299e-38,
      4.792386988235427e-38, 4.128376231719114e-38, 3.1573179710052345e-38,
      2.0674659640676818e-38, 1.0135410444160408e-38, 1.0738982311646659e-39,
      -5.841007189013206e-39, -1.0354110976318707e-38, -1.2549536548265134e-38,
      -1.275608677456702e-38, -1.1448254894651246e-38, -9.155325160406727e-39,
      -6.386959625737583e-39, -3.5796740116810194e-39, -1.0651075288665514e-39,
      9.417340672821406e-40, 2.337917036280746e-39, 3.116310309760155e-39,
      3.3424063448718034e-39, 3.1286207324510505e-39, 2.6096489573521643e-39,
      1.92144116969207e-39, 1.1852995273284139e-39, 4.976384381921049e-40,
      -7.483663368894587e-41, -4.953362390794877e-40, -7.537119013052705e-40,
      -8.609466909911339e-40, -8.426028143386999e-40, -7.3223877997289056e-40,
      -5.655585686095502e-40, -3.757803232114534e-40, -1.9045012976971052e-40,
      -2.970425993049581e-41, 9.418368202781778e-41, 1.7624062757974881e-40,
      2.175356181703483e-40, 2.2354378846020144e-40, 2.024149280182231e-40,
      1.6336905389199203e-40, 1.1537114785256082e-40, 6.616709064899805e-41,
      2.1700862252423156e-41, -1.4115666761524807e-41, -3.9342274007037594e-41,
      -5.373899435495295e-41, -5.836775166992959e-41, -5.514449662009746e-41,
      -4.640560088817076e-41, -3.453465514950741e-41, -2.167733306546775e-41,
      -9.554956783101526e-42, 6.265819268089006e-43, 8.185986400578482e-42,
      1.2913272818175837e-41, 1.4975792251260674e-41, 1.4804526295385175e-41,
      1.2978635021257503e-41, 1.0121933030006643e-41, 6.820176157529853e-42,
      3.563430256840962e-42, 7.138475984249175e-43, -1.5038184147196672e-42,
      -2.993568141601939e-42, -3.766912807300554e-42, -3.91462509609273e-42,
      -3.576477384373144e-42, -2.9129415631885185e-42, -2.0816040778333002e-42,
      -1.2198194200902304e-42, -4.340284494092485e-43, 2.047030862108083e-43,
      6.599723111778728e-43, 9.255308537657654e-43, 1.0184481498157206e-42,
      9.713135349244101e-43, 8.246120187437272e-43, 6.20104450143509e-43,
      3.957195386889279e-43, 1.8216473383706046e-43, 1.214024642095921e-45,
      -1.3455105267124788e-43, -2.2088150446877477e-43, -2.6026093088090623e-43,
      -2.599343586526745e-43, -2.2988485804747092e-43, -1.81003029147521e-43,
      -1.2361093861800752e-43, -6.642097272345181e-44, -1.5940048586520426e-44,
      2.3724055746274273e-44, 5.073276913763142e-44, 6.515914783430361e-44,
      6.85006710427897e-44, 6.315074435380245e-44, 5.189985269175731e-44,
      3.7516135187039287e-44, 2.24335805778709e-44, 8.55663847341893e-45,
      -2.82550979561677e-45, -1.103265853468633e-44, -1.5919034553225056e-44,
      -1.7756146342428382e-44, -1.7097130816691888e-44, -1.4642786484327873e-44,
      -1.112423160225619e-44, -7.211477772740546e-45, -3.451910820925542e-45,
      -2.3824166531153315e-46, 2.197779677773331e-45, 3.7716193803240265e-45,
      4.518777708411566e-45, 4.560652132398909e-45, 4.069101912214287e-45,
      3.23410252834043e-45, 2.2374248332891064e-45, 1.23384785637397e-45,
      3.401724069147022e-46, -3.6865875316257835e-46, -8.576693618779714e-46,
      -1.1258492480852242e-45, -1.1977622772400136e-45, -1.1143239693922779e-45,
      -9.240142328529934e-46, -6.754237951428262e-46, -4.116549095205533e-46,
      -1.6675390415836957e-46, 3.592431246269696e-47, 1.8371617961523182e-46,
      2.7342353352574476e-46, 3.093094085006211e-46, 3.007403333460471e-46,
      2.5983400976455437e-46, 1.99380747765839e-46, 1.3120842043384405e-46,
      6.506732299064808e-47, 8.032574533480262e-48, -3.563705038276312e-47,
      -6.428200089880534e-47, -7.838118025523655e-47, -7.996138999539811e-47,
      -7.197721164698073e-47, -5.773983508131146e-47, -4.0448065284956177e-47,
      -2.284968967041985e-47, -7.03938147868531e-48, 5.617887608836866e-48,
      1.4460581701798456e-47, 1.9430256305018476e-47, 2.0927196374519236e-47,
      1.9649615318605663e-47, 1.6438970473690384e-47, 1.2147599507510671e-47,
      7.538263910301365e-48, 3.2191260298969693e-48, -3.872601052871868e-49,
      -3.045908415235364e-48, -4.689362532449048e-48, -5.38346739766243e-48,
      -5.286429779279e-48, -4.607542942122826e-48, -3.5703923234597474e-48,
      -2.3836387360527503e-48, -1.220831138239011e-48, -2.0930194870781537e-49,
      5.7285681374688556e-49, 1.0934139405596322e-48, 1.3582074528811278e-48,
      1.4009395552958084e-48, 1.2723327890237134e-48, 1.0300507752297306e-48,
      7.303477456138366e-49, 4.219713166349858e-49, 1.4245323442624575e-49,
      -8.338473993737902e-50, -2.4309333790208964e-49, -3.349241654135674e-49,
      -3.653498053194916e-49, -3.462624507197575e-49, -2.9225280312897297e-49,
      -2.1826113898265306e-49, -1.377766577754784e-49, -6.165424461631674e-50,
      2.4703308035745475e-51, 5.024962141830862e-50, 8.029932749796243e-50,
      9.36148098650194e-50, 9.28608979752187e-50, 8.16481625716999e-50,
      6.388202769031111e-50, 4.324110955213653e-50, 2.2812228354748543e-50,
      4.884699741552787e-51, -9.112403631201009e-51, -1.8558638071057994e-50,
      -2.3510783757376886e-50, -2.4526702019541566e-50, -2.247585790984015e-50,
      -1.8361574129586908e-50, -1.3172458632431775e-50, -7.772734119091667e-51,
      -2.834300309511101e-51, 1.1921343920306817e-51, 4.07332788943821e-51,
      5.765777198371824e-51, 6.373180439364845e-51, 6.0976753720426e-51,
      5.192004445363736e-51, 3.917859164515708e-51, 2.5136323088230087e-51,
      1.1729191184537775e-51, 3.3540138438469394e-53, -8.242910938734891e-52,
      -1.3727360359592647e-51, -1.6264042016427343e-51, -1.630045537566212e-51,
      -1.445869655705016e-51, -1.1420393964067206e-51, -7.833639307535674e-52,
      -4.247076103164464e-52, -1.071900772711368e-52, 1.4308581971572331e-52,
      3.1426561245929616e-52, 4.065335183847039e-52, 4.290758476710936e-52,
      3.967728185864872e-52, 3.270661345741658e-52, 2.373174695009442e-52,
      1.4283778031277405e-52, 5.56453811095081e-53, -1.6087360378290232e-53,
      -6.800774802005478e-53, -9.912509069068637e-53, -1.1108217679892596e-52,
      -1.0730726968811282e-52, -9.217378558496211e-53, -7.026208320337987e-53,
      -4.578243297059746e-53, -2.218495713833593e-53, -1.9544332503305684e-54,
      1.3432815563554173e-53, 2.342560017735888e-53, 2.8229337097413653e-53,
      2.8592979049086555e-53, 2.5586992312155696e-53, 2.040008110845967e-53,
      1.4173271343020989e-53, 7.881020242001655e-54, 2.2612050311095506e-54,
      -2.2102249744042222e-54, -5.308213778627125e-54, -7.021560016251308e-54,
      -7.500634665310818e-54, -6.99966822217321e-54, -5.821585086906219e-54,
      -4.271072557942256e-54, -2.6192030447515993e-54, -1.080772135501196e-54,
      1.962340945535225e-55, 1.1308729813958496e-54, 1.7017332168156406e-54,
      1.9344784098262077e-54, 1.8871130289012648e-54, 1.6352306710780115e-54,
      1.2589405553690123e-54, 8.325509172803902e-55, 4.175016792434325e-55,
      5.854287073889909e-56, -2.1721601069378244e-55, -3.989958129539561e-55,
      -4.8949324200545864e-55, -5.011961954020823e-55, -4.524993545016901e-55,
      -3.641154628927682e-55, -2.5611971891951823e-55, -1.4580759623439388e-55,
      -4.6407971265876885e-56, 3.3415125050991835e-56, 8.941253679767e-56,
      1.2113135675283944e-55, 1.3101596717974638e-55, 1.2340204289934452e-55,
      1.0354567777742911e-55, 7.679015965861881e-56, 4.793145502119876e-56,
      2.0805385339782327e-56, -1.9116991536168743e-57, -1.871937024506872e-56,
      -2.917061771404166e-56, -3.3659242758564505e-56, -3.316409591281022e-56,
      -2.8990295445537075e-56, -2.2537855124269544e-56, -1.5117385525376202e-56,
      -7.822209982183505e-57, -1.4574278463568803e-57, 3.480205410074698e-57,
      6.782002940714446e-57, 8.479119175486896e-57, 8.778901732836105e-57,
      7.996983255866495e-57, 6.493966764604087e-57, 4.6228137499054566e-57,
      2.690286782223086e-57, 9.333473246021191e-58, -4.905309683032435e-58,
      -1.501508337757438e-57, -2.0870876813711912e-57, -2.2866794016418948e-57,
      -2.1740806315942044e-57, -1.8404002239678382e-57, -1.3792757121344773e-57,
      -8.755032063700568e-58, -3.975290725024665e-58, 6.302989695289836e-60,
      3.082598076984721e-58, 4.992361325029268e-58, 5.851327161181793e-58,
      5.824209883431203e-58, 5.136066401308912e-58, 4.031375925543811e-58,
      2.741142435194415e-58, 1.4597824776314826e-58, 3.3199735801029676e-59,
      -5.5136592043146745e-59, -1.1502418875095454e-58, -1.4672207709158718e-58,
      -1.5365670239369075e-58, -1.4123566640962342e-58, -1.1573143470800012e-58,
      -8.334548743262644e-59, -4.951502250569183e-59, -1.848095149321012e-59,
      6.898726205564236e-60, 2.5130234630168345e-59, 3.591358841662703e-59,
      3.987796721857486e-59, 3.8276833581204197e-59, 3.2687836348055795e-59,
      2.475071074419185e-59, 1.5963710702060164e-59, 7.547253759029106e-60,
      3.735778294349459e-61, -5.046059181308485e-60, -8.529582622943677e-60,
      -1.0162523868694325e-59, -1.0221182669976792e-59, -9.093161949395314e-60,
      -7.205044868984494e-60, -4.9637178943465546e-60, -2.714649828266962e-60,
      -7.176634854979667e-61, 8.614034963458752e-61, 1.9461724546145924e-60,
      2.536073638555782e-60, 2.6874227958624096e-60, 2.492715092705759e-60,
      2.0609571038502443e-60, 1.501032038914126e-60, 9.092458198197577e-61,
      3.614347810142273e-61, -9.060265942298557e-62, -4.190242796297207e-61,
      -6.171359253698705e-61, -6.94861875430398e-61, -6.734442860201775e-61,
      -5.80172590811607e-61, -4.437396935615751e-61, -2.9060042392148905e-61,
      -1.4249875651892952e-61, -1.515457483290602e-62, 8.202988588427629e-62,
      1.4546566754988232e-61, 1.7633248888328014e-61, 1.7924900977659798e-61,
      1.60881852397668e-61, 1.28668212487278e-61, 8.977007719801904e-62,
      5.032194830096787e-62, 1.4984811000094693e-62, -1.3219217495499862e-62,
      -3.284290516324418e-62, -4.378536857413435e-62, -4.69664048029629e-62,
      -4.396536342485383e-62, -3.667484850345072e-62, -2.7005243332634723e-62,
      -1.6661207701690152e-62, -6.997747273295482e-63, 1.0475728331063079e-63,
      6.95757041854956e-63, 1.058944940499076e-62, 1.2097396334439958e-62,
      1.1840512250137258e-62, 1.029030994026695e-62, 7.94849201211541e-63,
      5.281862410399794e-63, 2.6775429755015793e-63, 4.185439837026009e-64,
      -1.3226084864558657e-63, -2.475980563335777e-63, -3.0565519093446675e-63,
      -3.1412288316588344e-63, -2.844514522080076e-63, -2.2959625021787686e-63,
      -1.621551858302201e-63, -9.301374924891085e-64, -3.052578392364819e-64,
      1.9810255100640292e-64, 5.526654545502042e-64, 7.550468374781417e-64,
      8.20159821055139e-64, 7.749216037515144e-64, 6.521602661702316e-64,
      4.853700529801858e-64, 3.047039765148782e-64, 1.3435331381710815e-64,
      -8.732920776623181e-66, -1.149773383158063e-64, -1.8142588578907816e-64,
      -2.104275410712498e-64, -2.0803666119113173e-64, -1.8239064495279893e-64,
      -1.422551145051366e-64, -9.586146858263717e-65, -5.009686274967679e-65,
      -1.0051219052344581e-65, 2.1116223227708664e-65, 4.205555327789718e-65,
      5.2927769322634175e-65, 5.5007863149161e-65, 5.0259591372641495e-65,
      4.0937783191766636e-65, 2.9256887643998474e-65, 1.7147173787410498e-65,
      6.104583059739508e-66
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.7458222773335648, -0.4293750402409082, -0.28232635495773234, -0.15928080145270143,
      -0.06329528026527817, 0.005142230364950248, 0.047860278409394046, 0.06846272540850637,
      0.071655402376088, 0.06256747640194776, 0.046158940158540114, 0.026769699348307467,
      0.00783325282913279, -0.008248415354085707, -0.020091044574191596,
      -0.0272090171091877, -0.029828965191284022, -0.028672776789437696,
      -0.024741417032569726, -0.01912331050271271, -0.012842481782179642,
      -0.006753446572534962, -0.0014828527405793012, 0.0025874013261371768,
      0.005304213318400813, 0.006704682395494045, 0.006965073828885534,
      0.006346388027475079, 0.005143682900100688, 0.003644062705316757,
      0.0020960112121765715, 0.0006907673556831018, -0.00044512016570695913,
      -0.0012479928806874306, -0.0017085497640878247, -0.0018592394159028724,
      -0.0017600383027791457, -0.0014846461191699186, -0.001108573762356129,
      -0.000700013567156688, -0.00031384014019687176, 1.1355669761053363e-05,
      0.0002536201975041773, 0.0004059923205222149, 0.00047355029373578964,
      0.00046981679804418603, 0.0004130954313482377, 0.00032317607961620214,
      0.00021869468769760328, 0.00011528635912364706, 2.4544921684925698e-05,
      -4.629368721513659e-05, -9.40891706113376e-05, -0.00011913078956433493,
      -0.00012424495105455997, -0.00011383546562579496, -9.29833727302236e-05,
      -6.669461941987196e-05, -3.934481344382572e-05, -1.4335347709619866e-05,
      6.052623007226594e-06, 2.0639171110859233e-05, 2.9205071144099688e-05,
      3.227631234158166e-05, 3.0877135062932995e-05, 2.6287793685095657e-05,
      1.983363826481041e-05, 1.2721855130154032e-05, 5.932648825772512e-06,
      1.6370648330334188e-07, -4.1790335905534685e-06, -6.954848814700557e-06,
      -8.237935314994043e-06, -8.255066510369347e-06, -7.321372364535142e-06,
      -5.7820737081481655e-06, -3.965360850262211e-06, -2.149028070333021e-06,
      -5.412441490338823e-07, 7.258769954460671e-07, 1.5923745608425897e-06,
      2.059243149609689e-06, 2.173050562031844e-06, 2.0091830000191293e-06,
      1.6559826404009397e-06, 1.201372883718068e-06, 7.228817458550413e-07,
      2.813561644016885e-07, -8.183655227994702e-08, -3.446727089731531e-07,
      -5.021522911553124e-07, -5.626081560934997e-07, -5.434109240619235e-07,
      -4.6671342350196226e-07, -3.5571273506968923e-07, -2.3172878887049197e-07,
      -1.1222995859393119e-07, -9.794837474945795e-09, 6.810525496558158e-08,
      1.1868367512452526e-07, 1.429845536937028e-07, 1.448035344437481e-07,
      1.2956335268716423e-07, 1.0328449427153156e-07, 7.174514601583766e-08,
      3.9879345760414276e-08, 1.1422677031316129e-08, -1.1215871521994047e-08,
      -2.689783912239925e-08, -3.556758769456364e-08, -3.798745422178978e-08,
      -3.544545150260701e-08, -2.9475909196886813e-08, -2.1621845857434843e-08,
      -1.3255866121703567e-08, -5.46545996316847e-09, 1.0002756560826034e-09,
      5.731768887466716e-09, 8.620890721542526e-09, 9.79784742915678e-09,
      9.556552164869939e-09, 8.279918571385863e-09, 6.37366194595721e-09,
      4.214067505617514e-09, 2.1122162714447033e-09, 2.9464819032669003e-10,
      -1.1014375171872693e-09, -2.021535751329133e-09, -2.4793718640818918e-09,
      -2.5382373984965853e-09, -2.2913174987196927e-09, -1.8435182674794808e-09,
      -1.2965020826868485e-09, -7.378432265247803e-10, -2.345152071929929e-10,
      1.6962847617951017e-10, 4.5309154790530956e-10, 6.135996983313491e-10,
      6.635466118529897e-10, 6.248988122463648e-10, 5.242791049352773e-10,
      3.88747625837112e-10, 2.425895147033832e-10, 1.0522540544657303e-10,
      -9.796923169654728e-12, -9.488492745185948e-11, -1.4778020177496516e-10,
      -1.7048132927619395e-10, -1.6794842163988419e-10, -1.4679257158679038e-10,
      -1.141042678396019e-10, -7.652030190524853e-11, -3.957641966673822e-11,
      -7.348370548866306e-12, 1.764972583942517e-11, 3.4362495359189866e-11,
      4.2948932205531016e-11, 4.445999122964603e-11, 4.0494663015971685e-11,
      3.2879356688292946e-11, 2.3401515061620167e-11, 1.3614422289658396e-11,
      4.717752840131325e-12, -2.491413460417794e-12, -7.609144032359267e-12,
      -1.057249329349449e-11, -1.158130916714573e-11, -1.1009493060609582e-11,
      -9.31853018082374e-12, -6.982636341354789e-12, -4.431194398393683e-12,
      -2.010749964028481e-12, 3.3975176246756033e-14, 1.5626384786129395e-12,
      2.529223584441157e-12, 2.9636896919943797e-12, 2.9495058752166822e-12,
      2.6006770665497803e-12, 2.0410232913346534e-12, 1.3875236507990963e-12,
      7.386167295281266e-13, 1.67557438726505e-13, -2.7967452808946203e-13,
      -5.828149006905377e-13, -7.431971423823135e-13, -7.781897154753959e-13,
      -7.151880963627537e-13, -5.859619579586434e-13, -4.2191672289645417e-13,
      -2.505837766285983e-13, -9.343402466234057e-14, 3.506597647328428e-14,
      1.2735833006472364e-13, 1.8192991408416044e-13, 2.0197177434440435e-13,
      1.938349233475349e-13, 1.6551060346440907e-13, 1.2530314343305667e-13,
      8.079934069967446e-14, 3.817826853378352e-14, 1.8553770089699282e-15,
      -2.5582038356399496e-14, -4.321358322691348e-14, -5.147377100000599e-14,
      -5.176282085912654e-14, -4.604421351925204e-14, -3.647846689260526e-14,
      -2.512605145388742e-14, -1.3736191550970352e-14, -3.6242563804356075e-15,
      4.370390799050864e-15, 9.861405413505849e-15, 1.2846287941642441e-14,
      1.3610524368199267e-14, 1.262271655217714e-14, 1.0434983987407049e-14,
      7.598736753491499e-15, 4.601627141495184e-15, 1.827604370174276e-15,
      -4.611342809312974e-16, -2.123711043934077e-15, -3.1263327492174697e-15,
      -3.5193429069192844e-15, -3.4103744974955956e-15, -2.9376585409514924e-15,
      -2.246509931767048e-15, -1.4708908861508137e-15, -7.208941344360355e-16,
      -7.609827970577587e-17, 4.15913656001991e-16, 7.36995914507322e-16,
      8.931471449799182e-16, 9.077748523409034e-16, 8.146508345669714e-16,
      6.514427578259477e-16, 4.544192433789555e-16, 2.5464165114916443e-16,
      7.570682939471993e-17, -6.708883607506728e-17, -1.664242303930952e-16,
      -2.2179530796996586e-16, -2.3786533676542126e-16, -2.2263587892643215e-16,
      -1.856931300154927e-16, -1.3671182004815813e-16, -8.432370830686656e-17,
      -3.538908911136894e-17, 5.346107325300687e-18, 3.5264885774399126e-17,
      5.364599808004627e-17, 6.127179340657812e-17, 5.996188855047485e-17,
      5.210470956806051e-17, 4.0241152533071604e-17, 2.6735047044570036e-17,
      1.3546465472512701e-17, 2.10810990260425e-18, -6.706868508883923e-18,
      -1.2544829998766305e-17, -1.548206734457528e-17, -1.590836772355328e-17,
      -1.4403794133089448e-17, -1.162451330105027e-17, -8.208495365723316e-18,
      -4.706920523808949e-18, -1.5427186089212944e-18, 1.0058007445937021e-18,
      2.8006350774438542e-18, 3.824768440326197e-18, 4.153817583041634e-18,
      3.924158754620838e-18, 3.3020713183113004e-18, 2.457181558825331e-18,
      1.542174562525973e-18, 6.795304201565373e-19, -4.49538514690861e-20,
      -5.828135742149306e-19, -9.191224244062432e-19, -1.0658031798415594e-18,
      -1.0535354163853451e-18, -9.235394764524928e-19, -7.202097718894994e-19,
      -4.852293626176449e-19, -2.5346961586537873e-19, -5.0697971438329995e-20,
      1.0709625097294424e-19, 2.1308598767847683e-19, 2.6809426217683927e-19,
      2.7858360862637658e-19, 2.5450246736717823e-19, 2.072713160903766e-19,
      1.4810445071322878e-19, 8.677577069750801e-20, 3.085887200502396e-20,
      -1.459022481954122e-20, -4.698220422465441e-20, -6.58734887245832e-20,
      -7.247963256757216e-20, -6.912036114195164e-20, -5.867701079006785e-20,
      -4.412147427369872e-20, -2.815275333651815e-20, -1.2955838557987672e-20,
      -7.992319868710184e-23, 9.579975632379975e-21, 1.5721782763454845e-20,
      1.852248057663587e-20, 1.849782062791374e-20, 1.6358330806913695e-20,
      1.2879056517729243e-20, 8.794531564896194e-21, 4.724702068886241e-21,
      1.1325439952944162e-21, -1.689704690493219e-21, -3.611286026350783e-21,
      -4.637467310771208e-21, -4.874865307318979e-21, -4.4938351149846874e-21,
      -3.69297153873972e-21, -2.6692641800498294e-21, -1.59591218670255e-21,
      -6.08423874429744e-22, 2.0148013573925577e-22, 7.85415820372271e-22,
      1.1330285645719393e-21, 1.2636547786322258e-21, 1.2166676790569053e-21,
      1.0419438037241764e-21, 7.915131529079598e-22, 5.13053895456482e-22,
      2.455155237617598e-22, 1.6839180205093623e-23, -1.5648875480979501e-22,
      -2.6845782493038713e-22, -3.2159864502653737e-22, -3.2455335276635926e-22,
      -2.8955385491946433e-22, -2.3012011475281095e-22, -1.59187284428517e-22,
      -8.776901231318046e-23, -2.4175891766963732e-23, 2.6260386718222818e-23,
      6.105222003743843e-23, 8.012893556934612e-23, 8.523949790424954e-23,
      7.92961823965483e-23, 6.574925831450771e-23, 4.8056614657932804e-23,
      2.928536128672946e-23, 1.1858029383451697e-23, -2.563746937496461e-24,
      -1.3079167020717724e-23, -1.9460976911497532e-23, -2.2012815767690984e-23,
      -2.1401420837532138e-23, -1.8489228271820678e-23, -1.4186465034039342e-23,
      -9.334809260121672e-24, -4.628051546410691e-24, -5.695862883886821e-25,
      2.5376180320332503e-24, 4.575554959654337e-24, 5.578381387075944e-24,
      5.690386910521894e-24, 5.121862998024764e-24, 4.108458180882871e-24,
      2.8778065196667935e-24, 1.625433987054124e-24, 5.003814543058157e-25,
      -4.0024104507058072e-25, -1.0293814738008697e-24, -1.3829022857670223e-24,
      -1.4893055542562564e-24, -1.3982892261689897e-24, -1.1697394524389024e-24,
      -8.643119327083076e-25, -5.362842220811243e-25, -2.289297381136377e-25,
      2.7687743613986353e-26, 2.1685250465960433e-25, 3.3377010654524155e-25,
      3.8313107109749587e-25, 3.7619724473834856e-25, 3.278644904597297e-25,
      2.5404443610477344e-25, 1.6958557654210964e-25, 8.683700313638331e-26,
      1.4858480558624062e-26, -4.079445263775242e-26, -7.782975167619741e-26,
      -9.666423183177127e-26, -9.969725556386319e-26, -9.053902384835637e-26,
      -7.329332858592708e-26, -5.1963366002125e-26, -3.0017917450264424e-26,
      -1.0127471325573337e-26, 5.942024115546009e-27, 1.7305078113245074e-26,
      2.3837651546537563e-26, 2.6000649896877926e-26, 2.4640556765709994e-26,
      2.079579368148388e-26, 1.552957513821943e-26, 9.801787558461786e-27,
      4.384808084093159e-27, -1.7809049663514715e-28, -3.5776463362692055e-27,
      -5.715453820892849e-27, -6.662431385301336e-27, -6.608277256791177e-27,
      -5.8099660180304915e-27, -4.5454317601607735e-27, -3.0764494867786226e-27,
      -1.6226668873752142e-27, -3.4697109943196048e-28, 6.4897086372284845e-28,
      1.321034990257773e-27, 1.6732861733991763e-27, 1.745441683332215e-27,
      1.5993868181346891e-27, 1.3065262949696486e-27, 9.372123652917587e-28,
      5.529416717348098e-28, 2.0152205571007286e-28, -8.498041646198878e-29,
      -2.8997520349695905e-28, -4.103732671418689e-28, -4.53559390121602e-28,
      -4.339219182158119e-28, -3.694486921275484e-28, -2.787629088462912e-28,
      -1.7882859384022304e-28, -8.342105518385444e-29, -2.3460872567538365e-30,
      5.8690095954291e-29, 9.770828000910848e-29, 1.1574964667686e-28,
      1.159998355371778e-28, 1.0288652315260349e-28, 8.126062702183015e-29,
      5.573407305789069e-29, 3.0210843548932094e-29, 7.616663607215108e-30,
      -1.019143435992966e-29, -2.2370354738005562e-29, -2.8933637596996654e-29,
      -3.0535334619865917e-29, -2.82345774724655e-29, -2.3272669988406187e-29,
      -1.6885126354783362e-29, -1.0161454141649365e-29, -3.956800598513322e-30,
      1.1473977212927742e-30, 4.841524430305688e-30, 7.055198734456426e-30,
      7.905421342441323e-30, 7.636223238669561e-30, 6.558865720480484e-30,
      4.9993104324978684e-30, 3.257161615394077e-30, 1.577914774935597e-30,
      1.38360794551455e-31, -9.564761047369865e-31, -1.6674044730888122e-30,
      -2.0090695200973508e-30, -2.034788762026267e-30, -1.8207517972246245e-30,
      -1.451555177529346e-30, -1.008396566693215e-30, -5.606157707467908e-31,
      -1.607142370178117e-31, 1.5744719401863913e-31, 3.7786172780608114e-31,
      4.997398839588497e-31, 5.337883618755367e-31, 4.981028013406113e-31,
      4.142420967624194e-31, 3.0388891821458647e-31, 1.8633251829901118e-31,
      7.68564850180865e-32, -1.4010367408031092e-32, -8.051027526207506e-32,
      -1.2112166435403988e-31, -1.3767252974493054e-31, -1.3429182754097273e-31,
      -1.163596898245733e-31, -8.957712850671728e-32, -5.923196841786775e-32,
      -2.9696027772921903e-32, -4.153277338088316e-33, 1.5467707675153917e-32,
      2.840042933544202e-32, 3.483727652378427e-32, 3.5667281573784255e-32,
      3.2199685171202467e-32, 2.5908561029068574e-32, 1.822250722911989e-32,
      1.037223037680523e-32, 3.298997866447779e-33, -2.3807909950153695e-33,
      -6.364909386626376e-33, -8.621262614933315e-33, -9.323905027242134e-33,
      -8.781445946383283e-33, -7.367960193533728e-33, -5.4636978193014945e-33,
      -3.409936892742937e-33, -1.4796134646126049e-33, 1.3685554559097569e-34,
      1.3327365041343483e-33, 2.076256281726751e-33, 2.3954692086121244e-33,
      2.3600546126468037e-33, 2.062900913212325e-33, 1.603641349022848e-33,
      1.0755403262669955e-33, 5.5639476249765525e-34, 1.034880182908709e-34,
      -2.478400873453387e-34, -4.827489748548634e-34, -6.034642787525938e-34,
      -6.247478770374252e-34, -5.690651579067053e-34, -4.620794936566191e-34,
      -3.2890857734646986e-34, -1.9138104744694421e-34, -6.635740900474301e-35,
      3.4958808028981037e-35, 1.0688870523807945e-34, 1.48545353639581e-34,
      1.6273519071189906e-34, 1.5471110661744072e-34, 1.3095734303379672e-34,
      9.813756268103302e-35, 6.228583527678042e-35, 2.827245739724174e-35,
      -4.6298416921676766e-37, -2.194763754230231e-35, -3.5534207716423886e-35,
      -4.1643149343902736e-35, -4.1447004632154843e-35, -3.654757255539467e-35,
      -2.8684721597025277e-35, -1.950230816334769e-35, -1.0383737129620904e-35,
      -2.3585754834359722e-36, 3.926870517714993e-36, 8.187662664965782e-36,
      1.044238646062953e-35, 1.093499293297268e-35, 1.0050376664150548e-35,
      8.234939031168013e-36, 5.929996374417389e-36, 3.5224512621825294e-36,
      1.3140589192263478e-36, -4.918449394448268e-37, -1.789006811456873e-36,
      -2.5561213871564744e-36, -2.8379965053250676e-36, -2.7238552419157815e-36,
      -2.325980164697206e-36, -1.7610627511078846e-36, -1.1357188982930948e-36,
      -5.367878237432104e-37, -2.632855739377896e-38, 3.592889205184681e-37,
      6.071193171078939e-37, 7.232589120502732e-37, 7.2737697798103735e-37,
      6.470606662361792e-37, 5.126685111022281e-37, 3.5315526313858995e-37,
      1.9310348658333747e-37, 5.100001308836407e-38, -6.135693574378856e-38,
      -1.3853518800168096e-37, -1.8049690925914453e-37, -1.9125175812853277e-37,
      -1.7738330590054273e-37, -1.466494297315627e-37, -1.067986328060352e-37,
      -6.468392943918463e-38, -2.570136472585238e-38, 6.463765514052256e-39,
      2.9830968715535003e-38, 4.392462187929883e-38, 4.945156546852981e-38,
      4.792386988234376e-38, 4.128376231718383e-38, 3.157317971004827e-38,
      2.067465964067565e-38, 1.0135410444161562e-38, 1.0738982311674378e-39,
      -5.8410071890095314e-39, -1.0354110976314773e-38, -1.2549536548261453e-38,
      -1.275608677456395e-38, -1.1448254894648988e-38, -9.155325160405342e-39,
      -6.386959625737014e-39, -3.5796740116811317e-39, -1.065107528867166e-39,
      9.417340672812163e-40, 2.3379170362796933e-39, 3.116310309759125e-39,
      3.3424063448709075e-39, 3.1286207324503556e-39, 2.6096489573516997e-39,
      1.9214411696918315e-39, 1.1852995273283721e-39, 4.976384381922158e-40,
      -7.483663368873266e-41, -4.953362390792219e-40, -7.537119013049956e-40,
      -8.609466909908836e-40, -8.426028143384966e-40, -7.3223877997274545e-40,
      -5.65558568609465e-40, -3.757803232114227e-40, -1.9045012976972406e-40,
      -2.9704259930540874e-41, 9.418368202775432e-41, 1.7624062757967893e-40,
      2.175356181702816e-40, 2.2354378846014483e-40, 2.0241492801818055e-40,
      1.63369053891965e-40, 1.1537114785254854e-40, 6.616709064899836e-41,
      2.1700862252432923e-41, -1.411566676150901e-41, -3.934227400701905e-41,
      -5.373899435493445e-41, -5.836775166991325e-41, -5.514449662008459e-41,
      -4.6405600888162e-41, -3.453465514950273e-41, -2.167733306546668e-41,
      -9.554956783103295e-42, 6.265819268051995e-43, 8.18598640057375e-42,
      1.2913272818170867e-41, 1.497579225125609e-41, 1.4804526295381408e-41,
      1.2978635021254776e-41, 1.0121933030005012e-41, 6.82017615752924e-42,
      3.5634302568411876e-42, 7.13847598425751e-43, -1.5038184147184704e-42,
      -2.993568141600605e-42, -3.766912807299269e-42, -3.914625096091629e-42,
      -3.5764773843723075e-42, -2.912941563187976e-42, -2.0816040778330415e-42,
      -1.2198194200902148e-42, -4.340284494094177e-43, 2.047030862105193e-43,
      6.599723111775266e-43, 9.255308537654155e-43, 1.018448149815408e-42,
      9.713135349241614e-43, 8.246120187435546e-43, 6.201044501434131e-43,
      3.957195386889002e-43, 1.821647338370869e-43, 1.2140246421598837e-45,
      -1.3455105267116317e-43, -2.208815044686843e-43, -2.602609308808218e-43,
      -2.5993435865260433e-43, -2.2988485804741955e-43, -1.810030291474897e-43,
      -1.2361093861799488e-43, -6.642097272345466e-44, -1.5940048586534605e-44,
      2.3724055746253184e-44, 5.073276913760754e-44, 6.515914783428037e-44,
      6.850067104276957e-44, 6.315074435378696e-44, 5.189985269174706e-44,
      3.751613518703416e-44, 2.2433580577870195e-44, 8.556638473421624e-45,
      -2.8255097956118366e-45, -1.1032658534680281e-44, -1.5919034553218863e-44,
      -1.7756146342422791e-44, -1.7097130816687395e-44, -1.4642786484324724e-44,
      -1.1124231602254415e-44, -7.211477772740008e-45, -3.451910820925994e-45,
      -2.3824166531267694e-46, 2.1977796777717984e-45, 3.771619380322377e-45,
      4.518777708410018e-45, 4.5606521323976144e-45, 4.069101912213331e-45,
      3.234102528339838e-45, 2.237424833288855e-45, 1.2338478563740027e-45,
      3.40172406914944e-46, -3.6865875316220746e-46, -8.576693618775463e-46,
      -1.1258492480848075e-45, -1.1977622772396511e-45, -1.1143239693919982e-45,
      -9.240142328528078e-46, -6.754237951427325e-46, -4.116549095205393e-46,
      -1.6675390415841694e-46, 3.5924312462608944e-47, 1.837161796151234e-46,
      2.7342353352563345e-46, 3.0930940850052045e-46, 3.0074033334596602e-46,
      2.5983400976449723e-46, 1.993807477658064e-46, 1.3120842043383362e-46,
      6.506732299065545e-47, 8.032574533500098e-48, -3.5637050382736225e-47,
      -6.428200089877626e-47, -7.838118025520918e-47, -7.996138999537519e-47,
      -7.197721164696379e-47, -5.773983508130099e-47, -4.04480652849518e-47,
      -2.2849689670420586e-47, -7.039381478689812e-48, 5.617887608830033e-48,
      1.446058170179064e-47, 1.9430256305010814e-47, 2.0927196374512566e-47,
      1.9649615318600495e-47, 1.643897047368693e-47, 1.2147599507508895e-47,
      7.538263910301052e-48, 3.219126029897791e-48, -3.872601052856074e-49,
      -3.045908415233396e-48, -4.6893625324470143e-48, -5.3834673976605795e-48,
      -5.2864297792775e-48, -4.6075429421217606e-48, -3.570392323459131e-48,
      -2.383638736052543e-48, -1.2208311382391344e-48, -2.09301948708173e-49,
      5.728568137463927e-49, 1.0934139405590942e-48, 1.3582074528806176e-48,
      1.4009395552953773e-48, 1.2723327890233906e-48, 1.0300507752295258e-48,
      7.303477456137435e-49, 4.219713166349867e-49, 1.4245323442631685e-49,
      -8.338473993726363e-50, -2.4309333790195443e-49, -3.3492416541343295e-49,
      -3.653498053193732e-49, -3.462624507196647e-49, -2.9225280312891007e-49,
      -2.182611389826199e-49, -1.3777665777547144e-49, -6.165424461633035e-50,
      2.4703308035469914e-51, 5.024962141827373e-50, 8.0299327497926e-50,
      9.3614809864986e-50, 9.286089797519142e-50, 8.164816257168034e-50,
      6.388202769029958e-50, 4.324110955213235e-50, 2.2812228354750376e-50,
      4.884699741558935e-51, -9.112403631192311e-51, -1.8558638071048365e-50,
      -2.351078375736765e-50, -2.4526702019533675e-50, -2.2475857909834163e-50,
      -1.8361574129583034e-50, -1.3172458632429923e-50, -7.772734119091541e-51,
      -2.8343003095122834e-51, 1.1921343920286526e-51, 4.073327889435777e-51,
      5.765777198369365e-51, 6.373180439362649e-51, 6.097675372040855e-51,
      5.192004445362531e-51, 3.917859164515048e-51, 2.5136323088228348e-51,
      1.1729191184539899e-51, 3.3540138438948623e-53, -8.242910938728636e-52,
      -1.3727360359586003e-51, -1.626404201642116e-51, -1.630045537565698e-51,
      -1.4458696557046388e-51, -1.1420393964064887e-51, -7.83363930753471e-52,
      -4.247076103164624e-52, -1.0719007727123509e-52, 1.430858197155748e-52,
      3.142656124591271e-52, 4.06533518384539e-52, 4.290758476709509e-52,
      3.967728185863776e-52, 3.270661345740937e-52, 2.3731746950090866e-52,
      1.4283778031277023e-52, 5.564538110952861e-53, -1.6087360378253715e-53,
      -6.800774802001037e-53, -9.912509069064105e-53, -1.1108217679888512e-52,
      -1.0730726968808003e-52, -9.217378558493915e-53, -7.026208320336691e-53,
      -4.578243297059352e-53, -2.218495713833923e-53, -1.9544332503389512e-54,
      1.3432815563542913e-53, 2.3425600177346733e-53, 2.822933709740222e-53,
      2.859297904907695e-53, 2.558699231214857e-53, 2.0400081108455223e-53,
      1.4173271343019064e-53, 7.881020242001838e-54, 2.2612050311112916e-54,
      -2.2102249744015145e-54, -5.308213778624005e-54, -7.021560016248239e-54,
      -7.50063466530814e-54, -6.999668222171136e-54, -5.821585086904837e-54,
      -4.2710725579415544e-54, -2.619203044751492e-54, -1.0807721355015496e-54,
      1.962340945528621e-55, 1.1308729813950334e-54, 1.7017332168148002e-54,
      1.9344784098254444e-54, 1.8871130289006467e-54, 1.6352306710775734e-54,
      1.2589405553687596e-54, 8.325509172803056e-55, 4.175016792434841e-55,
      5.8542870739047025e-56, -2.172160106935791e-55, -3.989958129537344e-55,
      -4.894932420052486e-55, -5.011961954019051e-55, -4.524993545015579e-55,
      -3.6411546289268496e-55, -2.5611971891948136e-55, -1.4580759623439601e-55,
      -4.640797126590815e-56, 3.3415125050942255e-56, 8.94125367976123e-56,
      1.2113135675278223e-55, 1.3101596717969607e-55, 1.2340204289930511e-55,
      1.0354567777740238e-55, 7.679015965860468e-56, 4.793145502119576e-56,
      2.080538533978805e-56, -1.9116991536052423e-57, -1.8719370245053972e-56,
      -2.9170617714026246e-56, -3.365924275855035e-56, -3.3164095912798625e-56,
      -2.8990295445528725e-56, -2.253785512426459e-56, -1.5117385525374373e-56,
      -7.822209982184241e-57, -1.4574278463594634e-57, 3.4802054100710194e-57,
      6.782002940710362e-57, 8.479119175482972e-57, 8.778901732832749e-57,
      7.996983255863944e-57, 6.493966764602429e-57, 4.622813749904656e-57,
      2.690286782223019e-57, 9.333473246026098e-58, -4.9053096830239144e-58,
      -1.501508337756413e-57, -2.0870876813701543e-57, -2.2866794016409677e-57,
      -2.174080631593466e-57, -1.840400223967326e-57, -1.3792757121341935e-57,
      -8.755032063699768e-58, -3.975290725025483e-58, 6.302989695095988e-60,
      3.0825980769821638e-58, 4.9923613250265384e-58, 5.851327161179246e-58,
      5.824209883429086e-58, 5.136066401307361e-58, 4.031375925542865e-58,
      2.7411424351940324e-58, 1.4597824776315675e-58, 3.3199735801072337e-59,
      -5.513659204308329e-59, -1.1502418875088273e-58, -1.4672207709151731e-58,
      -1.5365670239363035e-58, -1.4123566640957706e-58, -1.1573143470796965e-58,
      -8.33454874326114e-59, -4.951502250569008e-59, -1.8480951493218557e-59,
      6.898726205549127e-60, 2.5130234630149964e-59, 3.59135884166083e-59,
      3.9877967218558015e-59, 3.82768335811907e-59, 3.2687836348046363e-59,
      2.4750710744186547e-59, 1.5963710702058576e-59, 7.547253759030494e-60,
      3.735778294384147e-61, -5.046059181303847e-60, -8.529582622938689e-60,
      -1.0162523868689643e-59, -1.0221182669972872e-59, -9.093161949392411e-60,
      -7.205044868982688e-60, -4.9637178943457785e-60, -2.714649828267048e-60,
      -7.176634854986896e-61, 8.614034963447568e-61, 1.946172454613305e-60,
      2.5360736385545155e-60, 2.687422795861303e-60, 2.4927150927048983e-60,
      2.0609571038496653e-60, 1.501032038913824e-60, 9.092458198196978e-61,
      3.614347810143553e-61, -9.06026594227316e-62, -4.190242796294015e-61,
      -6.17135925369539e-61, -6.948618754300954e-61, -6.734442860199313e-61,
      -5.801725908114309e-61, -4.437396935614717e-61, -2.9060042392145174e-61,
      -1.424987565189461e-61, -1.5154574832961084e-62, 8.202988588419873e-62,
      1.4546566754979682e-61, 1.7633248888319855e-61, 1.792490097765287e-61,
      1.60881852397616e-61, 1.2866821248724497e-61, 8.977007719800404e-62,
      5.032194830096817e-62, 1.4984811000106455e-62, -1.321921749548082e-62,
      -3.2842905163221843e-62, -4.37853685741121e-62, -4.696640480294325e-62,
      -4.396536342483839e-62, -3.6674848503440213e-62, -2.7005243332629126e-62,
      -1.6661207701688883e-62, -6.997747273297602e-63, 1.047572833101884e-63,
      6.957570418543913e-63, 1.0589449404984842e-62, 1.2097396334434515e-62,
      1.1840512250132793e-62, 1.0290309940263728e-62, 7.948492012113486e-63,
      5.281862410399063e-63, 2.6775429755018265e-63, 4.185439837035541e-64,
      -1.322608486454492e-63, -2.4759805633342444e-63, -3.0565519093431907e-63,
      -3.141228831657569e-63, -2.8445145220791153e-63, -2.2959625021781476e-63,
      -1.621551858301906e-63, -9.30137492489092e-64, -3.052578392366762e-64,
      1.9810255100607286e-64, 5.5266545454981025e-64, 7.550468374777451e-64,
      8.20159821054786e-64, 7.749216037512345e-64, 6.521602661700387e-64,
      4.853700529800801e-64, 3.047039765148502e-64, 1.3435331381714162e-64,
      -8.73292077654748e-66, -1.149773383157076e-64, -1.8142588578897355e-64,
      -2.1042754107115275e-64, -2.0803666119105154e-64, -1.8239064495274064e-64,
      -1.4225511450510141e-64, -9.58614685826233e-65, -5.009686274968048e-65,
      -1.0051219052360993e-65, 2.111622322768462e-65, 4.205555327787019e-65,
      5.292776932260808e-65, 5.500786314913857e-65, 5.025959137262441e-65,
      4.093778319175554e-65, 2.925688764399315e-65, 1.7147173787410114e-65,
      6.104583059742885e-66
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_4_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<4>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.764270504846321), "design.b()[0] == 0.764270504846321");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.764270504846321));
    static_assert(almost_equal(design.b()[1], -3.0088700067491656), "design.b()[1] == -3.0088700067491656");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -3.0088700067491656));
    static_assert(almost_equal(design.b()[2], 4.489582185447312), "design.b()[2] == 4.489582185447312");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 4.489582185447312));
    static_assert(almost_equal(design.b()[3], -3.0088700067491647), "design.b()[3] == -3.0088700067491647");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -3.0088700067491647));
    static_assert(almost_equal(design.b()[4], 0.7642705048463206), "design.b()[4] == 0.7642705048463206");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.7642705048463206));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.406749662642123), "design.a()[1] == -3.406749662642123");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.406749662642123));
    static_assert(almost_equal(design.a()[2], 4.435738051168001), "design.a()[2] == 4.435738051168001");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 4.435738051168001));
    static_assert(almost_equal(design.a()[3], -2.6092660334689013), "design.a()[3] == -2.6092660334689013");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -2.6092660334689013));
    static_assert(almost_equal(design.a()[4], 0.5841094613592563), "design.a()[4] == 0.5841094613592563");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.5841094613592563));
    std::cout << "max_deviation(cheby2,highpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.764270504846321, -0.4051917221966366, -0.2809083371836645, -0.17434498083942396,
      -0.0873140303648251, -0.020396642081761063, 0.026984694272600585,
      0.056415278680400346, 0.07027638229294778, 0.07149476116726447, 0.06327758564493777,
      0.04885594020951939, 0.031256915472855085, 0.013119621697264425,
      -0.003435113679229676, -0.016877386612991242, -0.026284643487009325,
      -0.03130795493566353, -0.03209768086049221, -0.029200262679527356,
      -0.023438755127193844, -0.015789370579315468, -0.007264949404468535,
      0.0011858500349824531, 0.008757437009647678, 0.014840810483412074,
      0.019050953433812627, 0.021229698116538756, 0.02142754872804354, 0.019869262532613757,
      0.016908698241369174, 0.012978565709853063, 0.008540326059300461,
      0.004038702908445369, -0.0001357994519512653, -0.0036741832301919386,
      -0.006365086619645594, -0.008099923810821993, -0.008868155550751194,
      -0.008744524800760677, -0.007870540651170928, -0.006432675233974793,
      -0.004639675513018363, -0.0027011253975177483, -0.0008089765505651537,
      0.0008767428596023735, 0.002237375121926405, 0.003200093144143973,
      0.003737692497019999, 0.0038644008368196, 0.0036286437821768953,
      0.0031038405372338686, 0.002378322696441495, 0.0015453903451115103,
      0.0006943620763332475, -9.673498431473889e-05, -0.0007664264116660227,
      -0.0012728336099468054, -0.0015945494408546104, -0.0017295808767819835,
      -0.0016927300254238886, -0.0015118692757454437, -0.0012235983798937608,
      -0.0008687556979537531, -0.00048820081275092325, -0.00011920179052142717,
      0.00020734091863171234, 0.00046870914714540175, 0.0006511982572109177,
      0.0007500329541315679, 0.0007685066900164101, 0.0007165322388016156,
      0.0006088160432669301, 0.00046287159138375415, 0.00029707035234657377,
      0.0001288969542064416, -2.646670036338442e-05, -0.00015715064298049526,
      -0.0002551687091335659, -0.0003165654196920527, -0.00034118596894247544,
      -0.00033214377490371934, -0.00029507604786472143, -0.00023728354879438843,
      -0.0001668471138460833, -9.180227003532796e-05, -1.9436453649881286e-05,
      4.424674939941097e-05, 9.487304842345657e-05, 0.00012984943194114282,
      0.00014833707430898883, 0.00015107328945997795, 0.00014007994000781853,
      0.00011830035754147326, 8.920709722494956e-05, 5.6419342663411145e-05,
      2.336234736510307e-05, -7.007065458124648e-06, -3.239420612477612e-05,
      -5.1273936319015257e-05, -6.291471854178604e-05, -6.73291542961471e-05,
      -6.516594081880356e-05, -5.7561202007104024e-05, -4.5968155196959224e-05,
      -3.198326306349435e-05, -1.718472215474348e-05, -2.9957727091047917e-06,
      9.418670715148411e-06, 1.9217731027352275e-05, 2.5912233439129333e-05,
      2.935734851285435e-05, 2.9715895417406097e-05, 2.739976085359188e-05,
      2.2997749607486418e-05, 1.7198185445624033e-05, 1.0713849094153966e-05,
      4.215543538382488e-06, -1.7210885893107793e-06, -6.652705158482858e-06,
      -1.0288388965442006e-05, -1.2493425084687045e-05, -1.327874674513292e-05,
      -1.2779040796669348e-05, -1.1223075092037281e-05, -8.89998481675304e-06,
      -6.125074517364975e-06, -3.208224231495307e-06, -4.2731444934988763e-07,
      1.9917053909509433e-06, 3.887300093630611e-06, 5.167351942686547e-06,
      5.80731718400026e-06, 5.842682354613232e-06, 5.357205475431139e-06,
      4.468585818779601e-06, 3.3131967552709778e-06, 2.0313640153257064e-06,
      7.544105454898599e-07, -4.056422871294395e-07, -1.363189732961577e-06,
      -2.062804363880225e-06, -2.4797924802017524e-06, -2.617957555921347e-06,
      -2.5051694967287004e-06, -2.187446133465172e-06, -1.7222831938008543e-06,
      -1.1719295384094447e-06, -5.972091527328251e-07, -5.235668761699132e-08,
      4.188232058550152e-07, 7.853239410779112e-07, 1.0298350303063277e-06,
      1.1483020558091748e-06, 1.1483796984314304e-06, 1.0470734474683097e-06,
      8.678947539473273e-07, 6.378506722620526e-07, 3.845575119911063e-07,
      1.337154710226361e-07, -9.288469669106645e-08, -2.7872347061078957e-07,
      -4.1325335049210846e-07, -4.919717638923243e-07, -5.159498835616779e-07,
      -4.90937132936193e-07, -4.2618140198780265e-07, -3.331099702885113e-07,
      -2.240075943691233e-07, -1.108088581364045e-07, -4.0949717074471175e-09,
      8.764580305143911e-08, 1.5846669734320478e-07, 2.0512217594916085e-07,
      2.2696627306358862e-07, 2.256360611972952e-07, 2.045790707906933e-07,
      1.684888013726659e-07, 1.227113613583569e-07, 7.267976386912613e-08,
      2.342184175082074e-08, -2.082535856288798e-08, -5.6875965942510585e-08,
      -8.272546398408611e-08, -9.755788029363691e-08, -1.0164702446543438e-07,
      -9.617571794207966e-08, -8.300075758318465e-08, -6.439215865264442e-08,
      -4.277339144066926e-08, -2.0485399239179902e-08, 4.0818845395349726e-10,
      1.8263372460346977e-08, 3.194060712882169e-08, 4.083290417916478e-08,
      4.4842886797748345e-08, 4.431815528210232e-08, 3.99566603603131e-08,
      3.269474715863889e-08, 2.3590242885388656e-08, 1.37116208253057e-08,
      4.04215149098633e-09, -4.594651679713671e-09, -1.158477081881955e-08,
      -1.6547781658296285e-08, -1.9336868340408076e-08, -2.0018214416412206e-08,
      -1.88345528891371e-08, -1.6158369220932523e-08, -1.2440375141928332e-08,
      -8.15848128884792e-09, -3.7717014120109865e-09, 3.1765142036804673e-10,
      3.791331051654226e-09, 6.4311710172451025e-09, 8.123961824823285e-09,
      8.856362345937404e-09, 8.701726593964691e-09, 7.801170493504288e-09,
      6.34137766699644e-09, 4.531572020717602e-09, 2.581809594799431e-09,
      6.84316379143385e-10, -1.0009182082037082e-09, -2.3556319816719345e-09,
      -3.3077334041389686e-09, -3.831030797577278e-09, -3.940948675030363e-09,
      -3.687185976354822e-09, -3.1444037417932934e-09, -2.4020474312922202e-09,
      -1.5543266698666393e-09, -6.912143309043096e-10, 1.0888696751393469e-10,
      7.844031956027288e-10, 1.2936060953537263e-09, 1.6154449230751564e-09,
      1.7484333732068897e-09, 1.7079694066969862e-09, 1.522549763753873e-09,
      1.2293721551269119e-09, 8.698013361123754e-10, 4.851188534888647e-10,
      1.1289089138026588e-10, -2.1581397679182285e-10, -4.782336584770064e-10,
      -6.607282296913192e-10, -7.586731542905312e-10, -7.755720179001955e-10,
      -7.215792538807274e-10, -6.116480501518185e-10, -4.6352079045380666e-10,
      -2.9576205051080104e-10, -1.260016704629314e-10, 3.0487191978141336e-11,
      1.6179764202343767e-10, 2.5995639796403636e-10, 3.210623761019003e-10,
      3.450458897209873e-10, 3.351242357883901e-10, 2.9704535577663637e-10,
      2.3821678949573064e-10, 1.6681329635482554e-10, 9.094498386060583e-11,
      1.7950681675509808e-11, -4.613905922056443e-11, -9.694631356626878e-11,
      -1.3189476196915655e-10, -1.5017822688126653e-10, -1.5257747137715682e-10,
      -1.4116323710736927e-10, -1.1892808285231288e-10, -8.938975419806673e-11,
      -5.620518763456814e-11, -2.2827694553483932e-11, 7.768617790916186e-12,
      3.3282523565772646e-11, 5.219212624344171e-11, 6.377721515137564e-11,
      6.806764094674547e-11, 6.573289809653805e-11, 5.7931109870621645e-11,
      4.6136580419498055e-11, 3.1964216575446096e-11, 1.7006768283297e-11,
      2.6974131788036007e-12, -9.793826305757907e-12, -1.962555124602882e-11,
      -2.6312037751328574e-11, -2.9715004171850456e-11, -3.0005891026787644e-11,
      -2.7606220645788872e-11, -2.3114451156945956e-11, -1.7227722492676765e-11,
      -1.0666136259532628e-11, -4.105889522647043e-12, 1.8741071999568315e-12,
      6.829353116000269e-12, 1.0469680841902676e-11, 1.266269337201834e-11,
      1.3422780048300012e-11, 1.2888753412748557e-11, 1.129371619872777e-11,
      8.930934954807729e-12, 6.119306632265667e-12, 3.1715250489928045e-12,
      3.6736935432848217e-13, -2.0662635780617506e-12, -3.9677892875515485e-12,
      -5.2458142499180835e-12, -5.877117290489643e-12, -5.898903179324936e-12,
      -5.396835296181115e-12, -4.490510316789643e-12, -3.318024713298177e-12,
      -2.0211259591860624e-12, -7.321751887657482e-13, 4.361881257912549e-13,
      1.3981554087120544e-12, 2.0984681446753594e-12, 2.512905812027769e-12,
      2.6459638351325836e-12, 2.5263303228269783e-12, 2.2008771924661216e-12,
      1.727909590656008e-12, 1.1703760966332609e-12, 5.89644710175012e-13,
      4.031274384841796e-14, -4.3363979603394204e-13, -8.012068380001769e-13,
      -1.0452289621092284e-12, -1.1619184015229702e-12, -1.1592719234868702e-12,
      -1.0546715017095675e-12, -8.720012926875512e-13, -6.386049199226436e-13,
      -3.8237460794779765e-13, -1.2921017504117699e-13, 9.89809570590523e-14,
      2.8564393131535765e-13, 4.2026867444883076e-13, 4.984490446367215e-13,
      5.213946578289235e-13, 4.950171351078272e-13, 4.28732587150331e-13,
      3.3412682218747333e-13, 2.2362083205032782e-13, 1.09254319995554e-13,
      1.6776914846971598e-15, -9.05884662478851e-14, -1.6159948436952606e-13,
      -2.081412207244464e-13, -2.296214150919961e-13, -2.277452109821595e-13,
      -2.0603450202525556e-13, -1.6925597457492199e-13, -1.2282145601142393e-13,
      -7.221748236586713e-14, -2.2510241177676616e-14, 2.20412407407787e-14,
      5.824507354494659e-14, 8.410492141632962e-14, 9.882442929500935e-14,
      1.0270508570560687e-13, 9.696185083440282e-14, 8.348464219668857e-14,
      6.457451281303932e-14, 4.268144729523118e-14, 2.016668929051671e-14,
      -8.929443837143483e-16, -1.884752224002518e-14, -3.2558302468811875e-14,
      -4.1424797850596064e-14, -4.536043729314262e-14, -4.472635903358117e-14,
      -4.0235196287096796e-14, -3.283766065481422e-14, -2.3604407023596575e-14,
      -1.3614286324813127e-14, -3.857932668590688e-15, 4.837007863788661e-15,
      1.1855516240073723e-14, 1.6818936896526724e-14, 1.958443839152288e-14,
      2.022373428779419e-14, 1.8985922936311957e-14, 1.625000854944985e-14,
      1.2472777525773428e-14, 8.13729866379959e-15, 3.7065037348124025e-15,
      -4.1478396846802747e-16, -3.907235152540706e-15, -6.552917847093145e-15,
      -8.239964644138506e-15, -8.957206458970746e-15, -8.780688308208064e-15,
      -7.854423958467355e-15, -6.367916184845946e-15, -4.532891804929753e-15,
      -2.561418028690244e-15, -6.471334015992271e-16, 1.0491973899449397e-15,
      2.4091510386963745e-15, 3.3610150037059688e-15, 3.8794056512772664e-15,
      3.980851603722143e-15, 3.716311966325316e-15, 3.1617303353581848e-15,
      2.4077406828174568e-15, 1.549555700343017e-15, 6.779039854152433e-16,
      -1.2833463087115193e-16, -8.073895210305542e-16, -1.3175934753301907e-15,
      -1.6381720320551112e-15, -1.7680750839525594e-15, -1.7232352216983087e-15,
      -1.5327209080178529e-15, -1.234282870236814e-15, -8.697740449930541e-16,
      -4.80865547877768e-16, -1.053943007198503e-16, 2.2542603990116586e-16,
      4.888087036456101e-16, 6.711943704950928e-16, 7.681221459458385e-16,
      7.833159171775289e-16, 7.2717949006420875e-16, 6.149183053010515e-16,
      4.645071982703943e-16, 2.9470572102196555e-16, 1.232893883882473e-16,
      -3.4378043675618636e-17, -1.663542417208295e-16, -2.6468084696188774e-16,
      -3.25513506023633e-16, -3.4887005441893164e-16, -3.3807395252055403e-16,
      -2.989858961502004e-16, -2.3912186996140063e-16, -1.6675181504678987e-16,
      -9.006126120598432e-17, -1.644088252177864e-17, 4.805169192445162e-17,
      9.903505652115865e-17, 1.3394992554894188e-16, 1.520232176875685e-16,
      1.5407962507827147e-16, 1.422392167979669e-16, 1.1954414732088165e-16,
      8.955760960594747e-17, 5.597442345367741e-17, 2.227596231300866e-17,
      -8.546491627581433e-18, -3.4185376374100696e-17, -5.312229982056546e-17,
      -6.464867287347221e-17, -6.881189261551833e-17, -6.630252449262298e-17,
      -5.830092080326135e-17, -4.630264410847649e-17, -3.1941151931911726e-17,
      -1.682378873054742e-17, -2.3936506445406234e-18, 1.0174201015033424e-17,
      2.0037951682078778e-17, 2.671545740097637e-17, 3.0075121859319975e-17,
      3.0297139929977604e-17, 2.781278721176343e-17, 2.323026950936034e-17,
      1.725560917082464e-17, 1.061626520236101e-17, 3.993836723491773e-18,
      -2.0295149230957933e-18, -7.008167187506128e-18, -1.0652753075157083e-17,
      -1.283325125300096e-17, -1.3567565942272379e-17, -1.2998689794504344e-17,
      -1.1364106293053108e-17, -8.961247836418237e-18, -6.112625467859001e-18,
      -3.1337555934886766e-18, -3.063130219978388e-19, 2.141870782979875e-18,
      4.049182236822595e-18, 5.324976614359075e-18, 5.947381576952739e-18,
      5.955345475514743e-18, 5.436459377489776e-18, 4.512235131496537e-18,
      3.322504605048751e-18, 2.0104435318868525e-18, 7.094522271728804e-19,
      -4.672155587202287e-19, -1.433555041866979e-18, -2.1344868131187794e-18,
      -2.546275028804329e-18, -2.674118668214778e-18, -2.5475347138237827e-18,
      -2.214258098789218e-18, -1.733410039163713e-18, -1.1686429451968483e-18,
      -5.818704073218788e-19, -2.8051665476277973e-20, 4.48660566843871e-19,
      8.172647862224765e-19, 1.0607575386369347e-18, 1.1756228976039402e-18,
      1.1702046976196349e-18, 1.0622657593548695e-18, 8.7606639279178e-19,
      6.392891510958464e-19, 3.8010339476558684e-19, 1.2460869993011536e-19,
      -1.0517164637964447e-19, -2.926489871413029e-19, -4.273527054410014e-19,
      -5.049753623711434e-19, -5.268672967660349e-19, -4.991044121146332e-19,
      -4.3127277360170696e-19, -3.3511799833452466e-19, -2.231980922369521e-19,
      -1.0765815858344678e-19, 7.823724777665756e-22, 9.357113041199903e-20,
      1.6476635860964756e-19, 2.111862799017441e-19, 2.32293362503453e-19,
      2.2986179709264074e-19, 2.0748869051400697e-19, 1.7001458291763005e-19,
      1.2291747199560134e-19, 7.173764355293497e-20, 2.1579654435516166e-20,
      -2.327565659400025e-20, -5.96306912752793e-20, -8.549769876754637e-20,
      -1.0010039061186778e-19, -1.0376838229777252e-19, -9.774918018464441e-20,
      -8.396615913715234e-20, -6.475165633378835e-20, -4.2582318040708565e-20,
      -1.983973775521952e-20, 1.3861190390086038e-21, 1.943949926780396e-20,
      3.318262762430603e-20, 4.2021710727373114e-20, 4.5881184755119836e-20,
      4.5135917152479876e-20, 4.0513389202371626e-20, 3.2978807948532076e-20,
      2.3615742187856918e-20, 1.3513462522622428e-20, 3.669967120384298e-21,
      -5.083000466505962e-21, -1.2129482621017521e-20, -1.70926730078108e-20,
      -1.9833813383237615e-20, -2.0430235337325708e-20, -1.913748215948373e-20,
      -1.6341142161808635e-20, -1.2504123798034888e-20, -8.114681850440215e-21,
      -3.6396747239220895e-21, 5.135726608978821e-22, 4.0246704477110695e-21,
      6.67595371075823e-21, 8.356935345928799e-21, 9.058658012611141e-21,
      8.859895194497266e-21, 7.907590741818367e-21, 6.39409150600221e-21,
      4.5336436731404195e-21, 2.5403333776291644e-21, 6.092113385012692e-22,
      -1.0981898051611254e-21, -2.463298231620496e-21, -3.41479642152651e-21,
      -3.928126323347768e-21, -4.020937953431664e-21, -3.745466124751097e-21,
      -3.178949667767921e-21, -2.413220172998879e-21, -1.5444986428625245e-21,
      -6.642708728521477e-22, 1.4810797757078025e-22, 8.306752774483816e-22,
      1.3418313742168624e-21, 1.6610856619931113e-21, 1.787832049036453e-21,
      1.7385450912754116e-21, 1.5428712494740444e-21, 1.2391190814037879e-21,
      8.69632842356159e-22, 4.764746414629207e-22, 9.775197072985656e-23,
      -2.3517794629696788e-22, -4.995061987016513e-22, -6.817572579756853e-22,
      -7.776373343007596e-22, -7.910940096686146e-22, -7.32783496427646e-22,
      -6.181659465207902e-22, -4.654503956322802e-22, -2.9359235862152843e-22,
      -1.2051327176343775e-22, 3.833291921060823e-23, 1.7096937566570771e-22,
      2.6945396237551007e-22, 3.3000055651186693e-22, 3.527160545169539e-22,
      3.4103151598878957e-22, 3.009216120744136e-22, 2.400117014951016e-22,
      1.6666750439660177e-22, 8.915023334085978e-23, 1.4902355819324823e-23,
      -4.9991734215640775e-23, -1.0114766092091125e-22, -1.360238059339089e-22,
      -1.5388086771680337e-22, -1.5558813339621608e-22, -1.433155915087542e-22,
      -1.201554687260909e-22, -8.971674089220358e-23, -5.573229628195775e-23,
      -2.1711610476464945e-23, 9.336947104143452e-24, 3.509966768145696e-23,
      5.406192329448343e-23, 6.552704346306263e-23, 6.956027445858919e-23,
      6.687353364843793e-23, 5.866963981707244e-23, 4.646559319560363e-23,
      3.191351559957951e-23, 1.6635393346722158e-23, 2.0842275188468e-24,
      -1.055994621816134e-23, -2.0455000122834263e-23, -2.712249608592944e-23,
      -3.0437658004940856e-23, -3.058956574657689e-23, -2.8019363662622066e-23,
      -2.3345097545452466e-23, -1.728173647831453e-23, -1.0564131539621847e-23,
      -3.8792901283599354e-24, 2.1873942721904666e-24, 7.189215719004845e-24,
      1.0837659436755067e-23, 1.3005138550714255e-23, 1.371313171381599e-23,
      1.3108866639099813e-23, 1.1434253721659229e-23, 8.990925769670229e-24,
      6.105029492562437e-24, 3.094912434849995e-24, 2.441417075073735e-25,
      -2.218529892783596e-24, -4.131480221337959e-24, -5.404838357704038e-24,
      -6.018107401049758e-24, -6.0120049033926355e-24, -5.4760721380283266e-24,
      -4.533754000519197e-24, -3.326630073219552e-24, -1.999310825710558e-24,
      -6.862366538167593e-25, 4.987283680442336e-25, 1.4693910093625063e-24,
      2.1708613038744578e-24, 2.579899715234804e-24, 2.7024204873138373e-24,
      2.568780220975832e-24, 2.227585835203716e-24, 1.7387812739881574e-24,
      1.1667268699394949e-24, 5.738833360832354e-25, 1.5571044803471467e-26,
      -4.638873004666013e-25, -8.334988878376848e-25, -1.0764211928316213e-24,
      -1.189415374210171e-24, -1.1811773564670141e-24, -1.0698551963794506e-24,
      -8.800888165545856e-25, -6.399020572419435e-25, -3.777426208218046e-25,
      -1.199099547035821e-25, 1.1145762087107305e-25, 2.9973921716834654e-25,
      4.345057338762099e-25, 5.115507346415699e-25, 5.323675828236559e-25,
      5.031985644957597e-25, 4.338014416230771e-25, 3.360829221884157e-25,
      2.2273880090698766e-25, 1.060198529808696e-25, -3.285649386833677e-27,
      -9.659410809596171e-26, -1.6796750492639692e-25, -2.1425741250394573e-25,
      -2.3498206119908135e-25, -2.3198567320892813e-25, -2.089414237767332e-25,
      -1.7076437593604887e-25, -1.2299914835914254e-25, -7.124000047841784e-26,
      -2.0629868317150684e-26, 2.4528771645782414e-26, 6.103292923732743e-26,
      8.690384898352227e-26, 1.0138576358335764e-25, 1.0483686774339764e-25,
      9.853762435227687e-26, 8.444520388057129e-26, 6.492347432273535e-26,
      4.2475890047769866e-26, 1.9504442114179742e-26, -1.887796377565706e-27,
      -2.0039364198298524e-26, -3.381361794355911e-26, -4.2623653369837265e-26,
      -4.6405117588042906e-26, -4.554680009652407e-26, -4.0791196805702874e-26,
      -3.311813955009386e-26, -2.3624197102271778e-26, -1.340910114075943e-26,
      -3.478213398140974e-27, 5.332661428206595e-27, 1.2406690940263952e-26,
      1.7368999731872503e-26, 2.0084992571267559e-26, 2.0637707908677665e-26,
      1.9289214123133202e-26, 1.6431749268153926e-26, 1.2534391275351559e-26,
      8.090608546298672e-27, 3.5711943717321736e-27, -6.140337740219949e-28,
      -4.143648581671141e-27, -6.800285258555054e-27, -8.474875716905632e-27,
      -9.160714471118418e-27, -8.939341239590489e-27, -7.960662383320783e-27,
      -6.419893821666989e-27, -4.5338175276248415e-27, -2.5185461878389745e-27,
      -5.705421219992238e-28, 1.1479016227575457e-27, 2.518077558732986e-27,
      3.469079444248346e-27, 3.977192548896473e-27, 4.061205725918637e-27,
      3.774645145521669e-27, 3.1960576048298076e-27, 2.4184814235026426e-27,
      1.5391511197279342e-27, 6.503110881341547e-28, -1.682101632709011e-28,
      -8.542627002170274e-28, -1.3663210419963179e-27, -1.6841861087486113e-27,
      -1.8077037211836995e-27, -1.753897794486451e-27, -1.5529990980965779e-27,
      -1.243878846110924e-27, -8.693757409512676e-28, -4.719442841123749e-28,
      -8.996233201291984e-29, 2.45070886445014e-28, 5.10326904543108e-28,
      6.924172180233065e-28, 7.872186439796306e-28, 7.989058830467512e-28,
      7.383906085104366e-28, 6.213901521026245e-28, 4.663494987153751e-28,
      2.9242110431478033e-28, 1.176725586825901e-28, -4.235243009482229e-29,
      -1.756434726060486e-28, -2.742759786044379e-28, -3.3452357485371176e-28,
      -3.5658377290321966e-28, -3.439966786441571e-28, -3.0285216615909283e-28,
      -2.4088589955841207e-28, -1.6655997343768752e-28, -8.82115383066304e-29,
      -1.3334796400868113e-29, 5.195941569238893e-29, 1.0328427138620482e-28,
      1.3811646221195416e-28, 1.5575115759903517e-28, 1.571029114873461e-28,
      1.443922278203708e-28, 1.2076188383064682e-28, 8.986697369609597e-29,
      5.547863762526577e-29, 2.113449044703623e-29, -1.0140102661980098e-29,
      -3.602547965169973e-29, -5.501104051156842e-29, -6.641233408466777e-29,
      -7.031276159729785e-29, -6.744587544284201e-29, -5.903719960015457e-29,
      -4.6625351590430046e-29, -3.188123068776453e-29, -1.6441511343385636e-29,
      -1.7690844874726855e-30, 1.095110616808468e-29, 2.087672401780474e-29,
      2.753316444379306e-29, 3.0802607911224527e-29, 3.088315106229737e-29,
      2.822592323189729e-29, 2.3458902853265458e-29, 1.7306070030098563e-29,
      1.0509702232031352e-29, 3.762220766876632e-30, -2.3477681760542863e-30,
      -7.37251444187872e-30, -1.1024408106224703e-29, -1.3178356255975643e-29,
      -1.3859472110578458e-29, -1.3219273811794262e-29, -1.1504145063647511e-29,
      -9.01995370444633e-30, -6.096503589698437e-30, -3.0549817338219983e-30,
      -1.8084388711617652e-31, 2.2962494311817223e-30, 4.214688443446707e-30,
      5.485401378980489e-30, 6.089293665532123e-30, 6.06887789685255e-30,
      5.515668212400071e-30, 4.5550604913532346e-30, 3.3303943393665514e-30,
      1.98772136434868e-30, 6.625228228014591e-31, -5.307309901863605e-31,
      -1.5056663203246108e-30, -2.207593138241975e-30, -2.613779984298291e-30,
      -2.7308681894883195e-30, -2.5900647975084273e-30, -2.240857727406964e-30,
      -1.7440203195463003e-30, -1.1646248999595415e-30, -5.656807918211691e-31,
      -2.868643944964146e-33, 4.793216375574961e-31, 8.499101272641764e-31,
      1.0922202602756441e-30, 1.203295581701187e-30, 1.1921891712980845e-30,
      1.0774387381347978e-30, 8.840672879817549e-31, 6.404423025918979e-31,
      3.752910170765833e-31, 1.1511283948598545e-31, -1.1783973846219307e-31,
      -3.0691519641260142e-31, -4.417280417525666e-31, -5.181751676409979e-31,
      -5.37895285475678e-31, -5.072991793716916e-31, -4.363180586321358e-31,
      -3.370210056785996e-31, -2.2224237438688344e-31, -1.0433887480296102e-31,
      5.832573640611026e-33, 9.96577148705431e-32, 1.712031092816041e-31,
      2.1735467709280893e-31, 2.3768745547821076e-31, 2.3411669070417947e-31,
      2.1039248673371386e-31, 1.7150510063280971e-31, 1.2306622196896452e-31,
      7.072430455796533e-32, 1.9660668640015907e-32, -2.580075171350068e-32,
      -6.245189719580741e-32, -8.832342414154489e-32, -1.0268054629181446e-31,
      -1.059104940581219e-31, -9.932710014174207e-32, -8.492167042402609e-32,
      -6.508985060433797e-32, -4.236204868538318e-32, -1.9160699177937852e-32,
      2.39806068240045e-33, 2.0647177684853503e-32, 3.4451308491638093e-32,
      4.323063583641303e-32, 4.693222354919977e-32, 4.595897760721812e-32,
      4.106857608270248e-32, 3.3255605319294393e-32, 2.362971995089108e-32,
      1.33011535023615e-32, 3.282629809933505e-33, -5.5860227792680404e-33,
      -1.2687162127520327e-32, -1.7647926645334505e-32, -2.0337974965196523e-32,
      -2.0846142050288316e-32, -1.9441102080723712e-32, -1.6521808781693508e-32,
      -1.2563557015790533e-32, -8.06505624607146e-33, -3.501042533472161e-33,
      7.161836530108031e-34, 4.264181203123694e-33, 6.925919089308094e-33,
      8.593787449164913e-33, 9.263373175578695e-33, 9.01902029351064e-33,
      8.013630286480268e-33, 6.445313199240602e-33, 4.5334031684698685e-33,
      2.496046930898472e-33, 5.3111763978896975e-34, -1.198339026304515e-33,
      -2.5734930061738683e-33, -3.523865824473141e-33, -4.026604013231927e-33,
      -4.101652864044013e-33, -3.803845661030019e-33, -3.2130499540548105e-33,
      -2.4235199055819177e-33, -1.5335087140274366e-33, -6.360207000149743e-34,
      1.886443563124699e-34, 8.78154024716302e-34, 1.3910637178248733e-33,
      1.7074736490239744e-33, 1.827689528519837e-33, 1.7692920833010836e-33,
      1.5631027370309656e-33, 1.248560197603383e-33, 8.690007336478756e-34,
      4.6727261130047104e-34, 8.202380674638278e-35, -2.5510605338203337e-34,
      -5.212715793990097e-34, -7.031745696080197e-34, -7.96865989657321e-34,
      -8.067511133201428e-34, -7.440001497476025e-34, -6.2459008892618936e-34,
      -4.672036138839983e-34, -2.9119109153197446e-34, -1.1476648224863975e-34,
      4.643719017791685e-35, 1.8037696114942013e-34, 2.7914712779795583e-34,
      3.3908260447799216e-34, 3.604730875712241e-34, 3.469691875876545e-34,
      3.0477721574630715e-34, 2.417440748806523e-34, 1.6642882734749109e-34,
      8.724481137945225e-35, 1.1737897511988098e-35, -5.395496639117891e-35,
      -1.054450319534415e-34, -1.402279520627039e-34, -1.5763406597478296e-34,
      -1.5862387219634942e-34, -1.4546898993001308e-34, -1.2136322716274487e-34,
      -9.000813174715323e-35, -5.521327752641226e-35, -2.0544452676506264e-35,
      1.0956077171762363e-35, 3.6962894393004907e-35, 5.596969485214122e-35,
      6.730455112649682e-35, 7.106932817952517e-35, 6.801949869834977e-35,
      5.94035318065364e-35, 4.678184227879078e-35, 3.1844219558104893e-35,
      1.6242071401168537e-35, 1.4481619377007916e-36, -1.1347725190806529e-35,
      -2.1303150690093086e-35, -2.79474728261207e-35, -3.1169966483177093e-35,
      -3.117787800499714e-35, -2.843243868400793e-35, -2.357165258349743e-35,
      -1.732857506959372e-35, -1.0452943957920674e-35, -3.642599487548582e-36,
      2.510659641916192e-36, 7.558079071058916e-36, 1.1213007166860767e-35,
      1.335290520354671e-35, 1.4006581686701318e-35, 1.332990096935397e-35,
      1.1573766695197684e-35, 9.048316410391138e-36, 6.087032497685869e-36,
      3.0139495492945025e-36, 1.164079810812508e-37, -2.3750379336774504e-36,
      -4.29881207839618e-36, -5.566667519199966e-36, -6.160939193784837e-36,
      -6.125960799145724e-36
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.764270504846321, -0.4051917221966366, -0.2809083371836643, -0.1743449808394239,
      -0.08731403036482543, -0.02039664208176204, 0.026984694272598808, 0.05641527868039775,
      0.07027638229294443, 0.07149476116726056, 0.06327758564493349, 0.04885594020951498,
      0.03125691547285073, 0.013119621697260261, -0.0034351136792335167,
      -0.016877386612994674, -0.026284643487012288, -0.031307954935665995,
      -0.032097680860494165, -0.029200262679528844, -0.023438755127194916,
      -0.01578937057931616, -0.007264949404468869, 0.001185850034982467,
      0.008757437009648018, 0.01484081048341271, 0.019050953433813522, 0.02122969811653985,
      0.02142754872804476, 0.01986926253261503, 0.016908698241370427, 0.012978565709854223,
      0.00854032605930146, 0.00403870290844615, -0.00013579945195073961,
      -0.0036741832301916797, -0.006365086619645591, -0.008099923810822215,
      -0.008868155550751596, -0.008744524800761202, -0.007870540651171517,
      -0.006432675233975388, -0.004639675513018921, -0.002701125397518235,
      -0.0008089765505655442, 0.0008767428596020949, 0.002237375121926246,
      0.003200093144143931, 0.003737692497020063, 0.0038644008368197516,
      0.0036286437821771125, 0.003103840537234129, 0.0023783226964417775,
      0.0015453903451117942, 0.0006943620763335147, -9.67349843145039e-05,
      -0.0007664264116658315, -0.001272833609946665, -0.0015945494408545224,
      -0.0017295808767819453, -0.0016927300254238947, -0.0015118692757454858,
      -0.0012235983798938295, -0.0008687556979538395, -0.0004882008127510181,
      -0.00011920179052152217, 0.0002073409186316246, 0.0004687091471453272,
      0.0006511982572108604, 0.0007500329541315302, 0.0007685066900163921,
      0.0007165322388016156, 0.0006088160432669448, 0.0004628715913837788,
      0.0002970703523466032, 0.00012889695420647098, -2.6466700363359247e-05,
      -0.00015715064298047756, -0.0002551687091335578, -0.0003165654196920551,
      -0.00034118596894248786, -0.0003321437749037403, -0.00029507604786474853,
      -0.0002372835487944185, -0.00016684711384611295, -9.18022700353542e-05,
      -1.9436453649901662e-05, 4.4246749399398144e-05, 9.487304842345211e-05,
      0.00012984943194114666, 0.00014833707430900018, 0.00015107328945999536,
      0.00014007994000784016, 0.00011830035754149705, 8.920709722497337e-05,
      5.641934266343301e-05, 2.3362347365121362e-05, -7.007065458111131e-06,
      -3.239420612476809e-05, -5.1273936319012905e-05, -6.291471854178904e-05,
      -6.732915429615472e-05, -6.51659408188147e-05, -5.7561202007117366e-05,
      -4.596815519697336e-05, -3.198326306350794e-05, -1.7184722154755378e-05,
      -2.9957727091141218e-06, 9.418670715142206e-06, 1.9217731027349415e-05,
      2.5912233439129723e-05, 2.9357348512857615e-05, 2.9715895417411637e-05,
      2.739976085359896e-05, 2.299774960749422e-05, 1.7198185445631758e-05,
      1.0713849094160905e-05, 4.215543538388082e-06, -1.7210885893069052e-06,
      -6.652705158480879e-06, -1.0288388965441906e-05, -1.249342508468864e-05,
      -1.3278746745135901e-05, -1.2779040796673307e-05, -1.1223075092041767e-05,
      -8.899984816757598e-06, -6.125074517369197e-06, -3.2082242314988672e-06,
      -4.273144493525637e-07, 1.9917053909492645e-06, 3.887300093629939e-06,
      5.1673519426868e-06, 5.807317184001288e-06, 5.8426823546148385e-06,
      5.357205475433106e-06, 4.46858581878171e-06, 3.3131967552730284e-06,
      2.0313640153275334e-06, 7.544105454913385e-07, -4.056422871283891e-07,
      -1.3631897329609885e-06, -2.0628043638800886e-06, -2.479792480202021e-06,
      -2.6179575559219454e-06, -2.5051694967295343e-06, -2.1874461334661383e-06,
      -1.7222831938018532e-06, -1.1719295384103868e-06, -5.972091527336385e-07,
      -5.23566876176246e-08, 4.1882320585459057e-07, 7.853239410777019e-07,
      1.0298350303063209e-06, 1.148302055809342e-06, 1.1483796984317311e-06,
      1.0470734474686977e-06, 8.678947539477544e-07, 6.378506722624741e-07,
      3.8455751199148374e-07, 1.3371547102293963e-07, -9.28846966908564e-08,
      -2.787234706106817e-07, -4.13253350492101e-07, -4.919717638924068e-07,
      -5.159498835618332e-07, -4.909371329363992e-07, -4.2618140198803627e-07,
      -3.331099702887491e-07, -2.240075943693446e-07, -1.1080885813659257e-07,
      -4.0949717075901494e-09, 8.764580305134763e-08, 1.584666973431661e-07,
      2.0512217594917157e-07, 2.2696627306364156e-07, 2.256360611973805e-07,
      2.0457907079079942e-07, 1.684888013727809e-07, 1.2271136135846946e-07,
      7.267976386922655e-08, 2.342184175090155e-08, -2.082535856283159e-08,
      -5.687596594248069e-08, -8.272546398408218e-08, -9.755788029365623e-08,
      -1.0164702446547256e-07, -9.61757179421312e-08, -8.300075758324348e-08,
      -6.439215865270461e-08, -4.277339144072549e-08, -2.0485399239227852e-08,
      4.081884539168548e-10, 1.8263372460323287e-08, 3.194060712881126e-08,
      4.0832904179166713e-08, 4.48428867977608e-08, 4.431815528212275e-08,
      3.9956660360338625e-08, 3.269474715866655e-08, 2.3590242885415692e-08,
      1.3711620825329781e-08, 4.042151491005693e-09, -4.5946516797001355e-09,
      -1.1584770818812293e-08, -1.654778165829514e-08, -1.933686834041235e-08,
      -2.0018214416420822e-08, -1.8834552889148735e-08, -1.6158369220945745e-08,
      -1.2440375141941748e-08, -8.15848128886029e-09, -3.771701412021323e-09,
      3.1765142036042767e-10, 3.791331051649677e-09, 6.431171017243657e-09,
      8.123961824824698e-09, 8.85636234594121e-09, 8.701726593970278e-09,
      7.801170493510963e-09, 6.34137766700351e-09, 4.531572020724423e-09,
      2.5818095948054626e-09, 6.843163791482231e-10, -1.00091820820031e-09,
      -2.355631981670066e-09, -3.307733404138576e-09, -3.831030797578188e-09,
      -3.940948675032314e-09, -3.6871859763575017e-09, -3.1444037417963692e-09,
      -2.4020474312953718e-09, -1.554326669869584e-09, -6.91214330906824e-10,
      1.0888696751200413e-10, 7.844031956014626e-10, 1.2936060953531353e-09,
      1.6154449230751915e-09, 1.748433373207454e-09, 1.7079694066979511e-09,
      1.5225497637550934e-09, 1.2293721551282403e-09, 8.698013361136765e-10,
      4.851188534900244e-10, 1.1289089138119934e-10, -2.1581397679116827e-10,
      -4.78233658476651e-10, -6.607282296912538e-10, -7.586731542907223e-10,
      -7.75572017900592e-10, -7.215792538812671e-10, -6.11648050152435e-10,
      -4.6352079045443537e-10, -2.957620505113852e-10, -1.260016704634257e-10,
      3.048719197776793e-11, 1.6179764202320135e-10, 2.599563979639391e-10,
      3.2106237610193156e-10, 3.450458897211266e-10, 3.351242357886102e-10,
      2.970453557769064e-10, 2.3821678949601933e-10, 1.6681329635510433e-10,
      9.0944983860851e-11, 1.7950681675703844e-11, -4.6139059220432145e-11,
      -9.694631356620195e-11, -1.3189476196915254e-10, -1.5017822688131748e-10,
      -1.5257747137725112e-10, -1.4116323710749306e-10, -1.1892808285245154e-10,
      -8.938975419820633e-11, -5.6205187634696614e-11, -2.2827694553591853e-11,
      7.76861779083512e-12, 3.3282523565721516e-11, 5.2192126243420554e-11,
      6.37772151513819e-11, 6.806764094677459e-11, 6.573289809658414e-11,
      5.79311098706782e-11, 4.613658041955856e-11, 3.196421657550467e-11,
      1.700676828334879e-11, 2.6974131788450454e-12, -9.793826305728952e-12,
      -1.9625551246013096e-11, -2.6312037751325563e-11, -2.97150041718586e-11,
      -3.000589102680462e-11, -2.7606220645811904e-11, -2.3114451156972115e-11,
      -1.7227722492703254e-11, -1.0666136259557016e-11, -4.105889522667414e-12,
      1.87410719994178e-12, 6.8293531159911884e-12, 1.04696808418996e-11,
      1.2662693372020768e-11, 1.3422780048307014e-11, 1.2888753412758921e-11,
      1.1293716198740154e-11, 8.93093495482079e-12, 6.119306632278182e-12,
      3.1715250490037626e-12, 3.6736935433714414e-13, -2.0662635780558222e-12,
      -3.967789287548493e-12, -5.245814249917768e-12, -5.8771172904917155e-12,
      -5.898903179328888e-12, -5.396835296186346e-12, -4.490510316795524e-12,
      -3.318024713304108e-12, -2.0211259591915263e-12, -7.321751887703444e-13,
      4.361881257877937e-13, 1.398155408709858e-12, 2.098468144674429e-12,
      2.5129058120279958e-12, 2.6459638351337723e-12, 2.5263303228288763e-12,
      2.2008771924684476e-12, 1.7279095906584836e-12, 1.1703760966356338e-12,
      5.896447101770763e-13, 4.0312743850026244e-14, -4.3363979603287525e-13,
      -8.012068379996759e-13, -1.0452289621092636e-12, -1.1619184015234672e-12,
      -1.1592719234877239e-12, -1.0546715017106556e-12, -8.720012926887477e-13,
      -6.3860491992383e-13, -3.823746079488724e-13, -1.2921017504206215e-13,
      9.898095705840751e-14, 2.856439313149761e-13, 4.2026867444870924e-13,
      4.984490446368347e-13, 5.213946578292293e-13, 4.950171351082723e-13,
      4.287325871508571e-13, 3.341268221880229e-13, 2.2362083205084935e-13,
      1.0925431999600581e-13, 1.6776914850496055e-15, -9.058846624764868e-14,
      -1.6159948436940978e-13, -2.081412207244433e-13, -2.2962141509209025e-13,
      -2.2774521098232873e-13, -2.0603450202547422e-13, -1.6925597457516374e-13,
      -1.2282145601166408e-13, -7.221748236608455e-14, -2.251024117785514e-14,
      2.2041240740649574e-14, 5.824507354487156e-14, 8.410492141630793e-14,
      9.882442929503565e-14, 1.0270508570567234e-13, 9.696185083449641e-14,
      8.348464219679831e-14, 6.457451281315348e-14, 4.268144729533922e-14,
      2.0166689290610022e-14, -8.929443836419182e-16, -1.8847522239977134e-14,
      -3.255830246878909e-14, -4.14247978505971e-14, -4.536043729316414e-14,
      -4.4726359033618514e-14, -4.023519628714455e-14, -3.283766065486683e-14,
      -2.3604407023648835e-14, -1.3614286324860598e-14, -3.85793266862996e-15,
      4.837007863759814e-15, 1.185551624005632e-14, 1.6818936896520653e-14,
      1.9584438391527053e-14, 2.022373428780678e-14, 1.8985922936330675e-14,
      1.62500085494722e-14, 1.2472777525796952e-14, 8.137298663822078e-15,
      3.706503734832042e-15, -4.1478396845254134e-16, -3.90723515253013e-15,
      -6.552917847087699e-15, -8.239964644137926e-15, -8.957206458974378e-15,
      -8.780688308214979e-15, -7.854423958476468e-15, -6.36791618485613e-15,
      -4.532891804939949e-15, -2.5614180286995392e-15, -6.471334016069208e-16,
      1.049197389939308e-15, 2.4091510386930175e-15, 3.3610150037048664e-15,
      3.879405651278199e-15, 3.980851603724741e-15, 3.716311966329117e-15,
      3.1617303353626853e-15, 2.4077406828221596e-15, 1.5495557003474761e-15,
      6.779039854190984e-16, -1.2833463086815623e-16, -8.073895210285607e-16,
      -1.3175934753292332e-15, -1.638172032055126e-15, -1.7680750839534058e-15,
      -1.7232352216997918e-15, -1.5327209080197483e-15, -1.234282870238893e-15,
      -8.697740449951047e-16, -4.80865547879611e-16, -1.0539430072135032e-16,
      2.2542603990009434e-16, 4.888087036450025e-16, 6.711943704949381e-16,
      7.68122145946087e-16, 7.833159171781022e-16, 7.271794900650103e-16,
      6.149183053019781e-16, 4.64507198271346e-16, 2.94705721022854e-16,
      1.2328938838900225e-16, -3.437804367504575e-17, -1.6635424172046428e-16,
      -2.646808469617338e-16, -3.255135060236747e-16, -3.4887005441913817e-16,
      -3.3807395252088417e-16, -2.989858961506077e-16, -2.3912186996183825e-16,
      -1.6675181504721482e-16, -9.006126120636073e-17, -1.6440882522079912e-17,
      4.8051691924241736e-17, 9.903505652104606e-17, 1.3394992554892304e-16,
      1.5202321768763216e-16, 1.5407962507840064e-16, 1.4223921679814125e-16,
      1.1954414732107965e-16, 8.955760960614858e-17, 5.597442345386369e-17,
      2.2275962313166012e-17, -8.546491627462592e-18, -3.418537637402522e-17,
      -5.31222998205337e-17, -6.464867287348062e-17, -6.881189261556036e-17,
      -6.630252449269006e-17, -5.830092080334395e-17, -4.6302644108565077e-17,
      -3.194115193199761e-17, -1.682378873062338e-17, -2.393650644601335e-18,
      1.01742010149912e-17, 2.00379516820562e-17, 2.6715457400972695e-17,
      3.007512185933288e-17, 3.029713993000362e-17, 2.7812787211798413e-17,
      2.3230269509399944e-17, 1.7255609170864732e-17, 1.0616265202397997e-17,
      3.99383672352284e-18, -2.029514923072545e-18, -7.008167187491644e-18,
      -1.0652753075151403e-17, -1.2833251253003351e-17, -1.3567565942281502e-17,
      -1.2998689794518452e-17, -1.1364106293070258e-17, -8.96124783643649e-18,
      -6.1126254678765855e-18, -3.133755593504121e-18, -3.0631302201006307e-19,
      2.1418707829715168e-18, 4.0491822368183174e-18, 5.324976614358702e-18,
      5.947381576955774e-18, 5.955345475520455e-18, 5.4364593774972955e-18,
      4.512235131504956e-18, 3.322504605057209e-18, 2.0104435318946056e-18,
      7.094522271793512e-19, -4.672155587154247e-19, -1.4335550418640265e-18,
      -2.1344868131176755e-18, -2.54627502880491e-18, -2.674118668216757e-18,
      -2.5475347138267918e-18, -2.2142580987928506e-18, -1.7334100391675646e-18,
      -1.1686429452005507e-18, -5.818704073251286e-19, -2.805166547885371e-20,
      4.486605668421007e-19, 8.172647862215538e-19, 1.0607575386368216e-18,
      1.1756228976045328e-18, 1.1702046976207816e-18, 1.0622657593563908e-18,
      8.760663927934882e-19, 6.392891510975636e-19, 3.8010339476715994e-19,
      1.2460869993142567e-19, -1.0517164637867577e-19, -2.9264898714071352e-19,
      -4.2735270544079025e-19, -5.049753623712763e-19, -5.268672967664519e-19,
      -4.991044121152576e-19, -4.312727736024547e-19, -3.351179983353125e-19,
      -2.231980922377048e-19, -1.0765815858410256e-19, 7.823724772523764e-22,
      9.357113041165238e-20, 1.6476635860947603e-19, 2.111862799017388e-19,
      2.322933625035917e-19, 2.2986179709289155e-19, 2.0748869051433255e-19,
      1.7001458291799153e-19, 1.2291747199596197e-19, 7.173764355326313e-20,
      2.1579654435787422e-20, -2.3275656593801914e-20, -5.963069127516124e-20,
      -8.549769876750784e-20, -1.0010039061190118e-19, -1.0376838229786498e-19,
      -9.774918018477978e-20, -8.396615913731292e-20, -6.475165633395671e-20,
      -4.258231804086895e-20, -1.9839737755359017e-20, 1.3861190388993072e-21,
      1.9439499267730238e-20, 3.318262762426939e-20, 4.2021710727371604e-20,
      4.5881184755148713e-20, 4.5135917152532393e-20, 4.0513389202439894e-20,
      3.297880794860793e-20, 2.3615742187932644e-20, 1.3513462522691407e-20,
      3.669967120441432e-21, -5.083000466464009e-21, -1.2129482620992281e-20,
      -1.7092673007802116e-20, -1.9833813383243886e-20, -2.043023533734424e-20,
      -1.9137482159511128e-20, -1.6341142161841202e-20, -1.2504123798068992e-20,
      -8.114681850472604e-21, -3.639674723950121e-21, 5.135726608760912e-22,
      4.024670447696584e-21, 6.6759537107513184e-21, 8.356935345929025e-21,
      9.058658012617496e-21, 8.859895194508338e-21, 7.907590741832523e-21,
      6.3940915060177634e-21, 4.533643673155794e-21, 2.5403333776430145e-21,
      6.092113385125697e-22, -1.0981898051530316e-21, -2.4632982316158915e-21,
      -3.41479642152533e-21, -3.928126323349653e-21, -4.020937953436034e-21,
      -3.74546612475723e-21, -3.1789496677750403e-21, -2.413220173006225e-21,
      -1.544498642869424e-21, -6.6427087285806055e-22, 1.4810797756623212e-22,
      8.306752774454036e-22, 1.3418313742154936e-21, 1.6610856619932439e-21,
      1.787832049037863e-21, 1.738545091277795e-21, 1.5428712494770552e-21,
      1.2391190814070727e-21, 8.696328423593897e-22, 4.7647464146582e-22,
      9.775197073221564e-23, -2.3517794629528085e-22, -4.995061987006904e-22,
      -6.817572579754327e-22, -7.776373343011374e-22, -7.910940096695004e-22,
      -7.327834964288896e-22, -6.181659465222307e-22, -4.654503956337621e-22,
      -2.935923586229142e-22, -1.205132717646178e-22, 3.833291920970996e-23,
      1.709693756651317e-22, 2.694539623752625e-22, 3.30000556511924e-22,
      3.527160545172682e-22, 3.4103151598929795e-22, 3.009216120750446e-22,
      2.4001170149578304e-22, 1.666675043972671e-22, 8.915023334145314e-23,
      1.4902355819804566e-23, -4.9991734215300516e-23, -1.0114766092072048e-22,
      -1.3602380593386312e-22, -1.5388086771688603e-22, -1.5558813339640174e-22,
      -1.4331559150901209e-22, -1.2015546872638827e-22, -8.971674089250891e-23,
      -5.573229628224326e-23, -2.1711610476708554e-23, 9.336947103957048e-24,
      3.5099667681335864e-23, 5.406192329442886e-23, 6.55270434630698e-23,
      6.956027445864853e-23, 6.687353364853662e-23, 5.866963981719602e-23,
      4.6465593195737495e-23, 3.1913515599710236e-23, 1.6635393346838526e-23,
      2.084227518940481e-24, -1.0559946218095472e-23, -2.0455000122798143e-23,
      -2.712249608592209e-23, -3.043765800495888e-23, -3.058956574661514e-23,
      -2.8019363662674316e-23, -2.3345097545512128e-23, -1.7281736478375277e-23,
      -1.0564131539678142e-23, -3.879290128407411e-24, 2.1873942721547815e-24,
      7.189215718982462e-24, 1.0837659436746111e-23, 1.3005138550717645e-23,
      1.37131317138297e-23, 1.310886663912119e-23, 1.1434253721685316e-23,
      8.990925769698074e-24, 6.105029492589341e-24, 3.0949124348737207e-24,
      2.441417075262813e-25, -2.218529892770491e-24, -4.131480221330992e-24,
      -5.404838357702959e-24, -6.018107401053834e-24, -6.012004903400784e-24,
      -5.4760721380392565e-24, -4.5337540005315565e-24, -3.326630073232054e-24,
      -1.9993108257220814e-24, -6.86236653826424e-25, 4.987283680370216e-25,
      1.4693910093580424e-24, 2.1708613038727537e-24, 2.579899715235626e-24,
      2.7024204873167635e-24, 2.568780220980314e-24, 2.227585835209146e-24,
      1.73878127399393e-24, 1.1667268699450583e-24, 5.738833360881326e-25,
      1.5571044807368415e-26, -4.638873004639038e-25, -8.334988878362525e-25,
      -1.0764211928313997e-24, -1.1894153742110071e-24, -1.1811773564686833e-24,
      -1.069855196381687e-24, -8.800888165571118e-25, -6.399020572444965e-25,
      -3.777426208241571e-25, -1.1990995470555694e-25, 1.1145762086959431e-25,
      2.9973921716742185e-25, 4.3450573387584025e-25, 5.115507346417074e-25,
      5.323675828242146e-25, 5.031985644966287e-25, 4.338014416241341e-25,
      3.360829221895395e-25, 2.227388009080688e-25, 1.0601985298181803e-25,
      -3.285649386083266e-27, -9.659410809544771e-26, -1.6796750492613126e-25,
      -2.1425741250391662e-25, -2.349820611992577e-25, -2.31985673209265e-25,
      -2.0894142377717806e-25, -1.707643759365472e-25, -1.2299914835964295e-25,
      -7.124000047887622e-26, -2.062986831753295e-26, 2.452877164549874e-26,
      6.103292923715293e-26, 8.690384898345641e-26, 1.0138576358339037e-25,
      1.0483686774351163e-25, 9.853762435245016e-26, 8.444520388077988e-26,
      6.492347432295568e-26, 4.2475890047980767e-26, 1.9504442114363964e-26,
      -1.8877963774205485e-27, -2.0039364198199575e-26, -3.381361794350839e-26,
      -4.262365336983226e-26, -4.640511758807742e-26, -4.554680009658932e-26,
      -4.079119680578862e-26, -3.3118139550189536e-26, -2.362419710236746e-26,
      -1.3409101140846605e-26, -3.478213398213088e-27, 5.3326614281538406e-27,
      1.2406690940232533e-26, 1.7368999731862223e-26, 2.0084992571276378e-26,
      2.0637707908702142e-26, 1.9289214123169e-26, 1.643174926819633e-26,
      1.253439127539595e-26, 8.090608546340916e-27, 3.571194371768919e-27,
      -6.140337739931356e-28, -4.143648581651521e-27, -6.800285258545022e-27,
      -8.474875716904646e-27, -9.16071447112522e-27, -8.939341239603321e-27,
      -7.960662383337616e-27, -6.419893821685729e-27, -4.5338175276435285e-27,
      -2.5185461878559354e-27, -5.705421220131814e-28, 1.1479016227474181e-27,
      2.518077558727056e-27, 3.469079444246554e-27, 3.9771925488984005e-27,
      4.061205725923596e-27, 3.774645145528799e-27, 3.1960576048381783e-27,
      2.418481423511342e-27, 1.5391511197361495e-27, 6.503110881412311e-28,
      -1.6821016326542577e-28, -8.542627002134093e-28, -1.3663210419946137e-27,
      -1.6841861087487017e-27, -1.807703721185324e-27, -1.7538977944892504e-27,
      -1.552999098100142e-27, -1.2438788461148331e-27, -8.693757409551313e-28,
      -4.719442841158621e-28, -8.996233201577975e-29, 2.4507088644294126e-28,
      5.103269045418903e-28, 6.92417218022927e-28, 7.87218643980001e-28,
      7.989058830477301e-28, 7.383906085118491e-28, 6.213901521042824e-28,
      4.663494987170954e-28, 2.9242110431640055e-28, 1.176725586839801e-28,
      -4.235243009375358e-29, -1.7564347260535074e-28, -2.7427597860412054e-28,
      -3.345235748537495e-28, -3.5658377290355925e-28, -3.439966786447261e-28,
      -3.0285216615980873e-28, -2.4088589955919106e-28, -1.665599734384521e-28,
      -8.821153830731526e-29, -1.333479640142408e-29, 5.195941569199274e-29,
      1.032842713859808e-28, 1.3811646221189777e-28, 1.5575115759912768e-28,
      1.571029114875581e-28, 1.443922278206665e-28, 1.2076188383098804e-28,
      8.9866973696446e-29, 5.547863762559242e-29, 2.1134490447314e-29,
      -1.0140102661768681e-29, -3.602547965156375e-29, -5.501104051150898e-29,
      -6.641233408467905e-29, -7.031276159736861e-29, -6.744587544295738e-29,
      -5.903719960029785e-29, -4.662535159058448e-29, -3.188123068791477e-29,
      -1.6441511343518905e-29, -1.7690844875795373e-30, 1.0951106168009994e-29,
      2.0876724017764288e-29, 2.7533164443785576e-29, 3.0802607911245995e-29,
      3.0883151062341764e-29, 2.8225923231957396e-29, 2.3458902853333685e-29,
      1.7306070030167664e-29, 1.0509702232095019e-29, 3.7622207669299206e-30,
      -2.347768176014704e-30, -7.372514441854492e-30, -1.1024408106215889e-29,
      -1.3178356255980926e-29, -1.3859472110595453e-29, -1.3219273811819872e-29,
      -1.150414506367831e-29, -9.019953704478905e-30, -6.0965035897296845e-30,
      -3.0549817338493573e-30, -1.8084388713778104e-31, 2.2962494311669747e-30,
      4.214688443439165e-30, 5.485401378979821e-30, 6.08929366553744e-30,
      6.068877896862559e-30, 5.515668212413248e-30, 4.555060491367983e-30,
      3.3303943393813596e-30, 1.9877213643622403e-30, 6.625228228127546e-31,
      -5.307309901780053e-31, -1.5056663203195175e-30, -2.2075931382401327e-30,
      -2.6137799842994037e-30, -2.7308681894918735e-30, -2.5900647975137673e-30,
      -2.2408577274133717e-30, -1.7440203195530675e-30, -1.1646248999660295e-30,
      -5.656807918268552e-31, -2.8686439494700213e-33, 4.793216375543917e-31,
      8.499101272625404e-31, 1.0922202602754048e-30, 1.2032955817021606e-30,
      1.1921891713000068e-30, 1.0774387381373593e-30, 8.840672879846342e-31,
      6.404423025947914e-31, 3.7529101707922965e-31, 1.1511283948818251e-31,
      -1.1783973846057842e-31, -3.0691519641163146e-31, -4.417280417522373e-31,
      -5.1817516764124876e-31, -5.3789528547640525e-31, -5.07299179372764e-31,
      -4.363180586334096e-31, -3.370210056799341e-31, -2.222423743881523e-31,
      -1.0433887480406182e-31, 5.832573639751373e-33, 9.965771486996607e-32,
      1.7120310928132033e-31, 2.1735467709280166e-31, 2.3768745547844123e-31,
      2.341166907045934e-31, 2.1039248673424828e-31, 1.715051006333998e-31,
      1.2306622196954956e-31, 7.072430455849362e-32, 1.9660668640448054e-32,
      -2.580075171318999e-32, -6.245189719562916e-32, -8.832342414149674e-32,
      -1.0268054629188286e-31, -1.0591049405828484e-31, -9.932710014197228e-32,
      -8.492167042429409e-32, -6.508985060461509e-32, -4.2362048685643966e-32,
      -1.9160699178161863e-32, 2.3980606822275484e-33, 2.0647177684739538e-32,
      3.445130849158461e-32, 4.323063583641605e-32, 4.693222354925092e-32,
      4.5958977607305963e-32, 4.1068576082814024e-32, 3.325560531941642e-32,
      2.362971995101135e-32, 1.3301153502469675e-32, 3.28262981002177e-33,
      -5.586022779204629e-33, -1.2687162127483817e-32, -1.7647926645324283e-32,
      -2.0337974965209737e-32, -2.0846142050320456e-32, -1.9441102080769243e-32,
      -1.6521808781746505e-32, -1.2563557015845257e-32, -8.06505624612284e-33,
      -3.501042533516142e-33, 7.161836529770433e-34, 4.26418120310167e-33,
      6.925919089298066e-33, 8.593787449166042e-33, 9.263373175589278e-33,
      9.019020293528385e-33, 8.013630286502583e-33, 6.445313199264863e-33,
      4.533403168493652e-33, 2.4960469309197447e-33, 5.311176398062082e-34,
      -1.1983390262922621e-33, -2.573493006166979e-33, -3.523865824471467e-33,
      -4.02660401323488e-33, -4.101652864050684e-33, -3.803845661039301e-33,
      -3.2130499540655235e-33, -2.423519905592927e-33, -1.5335087140377438e-33,
      -6.360207000237844e-34, 1.8864435630570853e-34, 8.781540247118836e-34,
      1.3910637178228448e-33, 1.7074736490241666e-33, 1.8276895285219117e-33,
      1.769292083304587e-33, 1.5631027370353833e-33, 1.2485601976081957e-33,
      8.690007336526044e-34, 4.672726113047136e-34, 8.202380674983728e-35,
      -2.5510605337955587e-34, -5.21271579397585e-34, -7.031745696076199e-34,
      -7.968659896578321e-34, -8.06751113321387e-34, -7.440001497493636e-34,
      -6.245900889282372e-34, -4.672036138861109e-34, -2.9119109153395633e-34,
      -1.1476648225033527e-34, 4.643719017661558e-35, 1.8037696114857064e-34,
      2.791471277975675e-34, 3.3908260447803236e-34, 3.6047308757162696e-34,
      3.469691875883315e-34, 3.0477721574715808e-34, 2.4174407488157585e-34,
      1.6642882734839397e-34, 8.72448113802563e-35, 1.17378975126351e-35,
      -5.395496639072499e-35, -1.0544503195319443e-34, -1.4022795206265712e-34,
      -1.5763406597491297e-34, -1.5862387219662035e-34, -1.454689899303816e-34,
      -1.2136322716316505e-34, -9.000813174758104e-35, -5.521327752680918e-35,
      -2.0544452676841846e-35, 1.0956077171508862e-35, 3.696289439284409e-35,
      5.596969485207405e-35, 6.730455112651588e-35, 7.106932817961653e-35,
      6.801949869849511e-35, 5.940353180671521e-35, 4.678184227898252e-35,
      3.184421955829077e-35, 1.6242071401332945e-35, 1.4481619378322275e-36,
      -1.1347725190715022e-35, -2.1303150690043947e-35, -2.7947472826112276e-35,
      -3.116996648320437e-35, -3.117787800505267e-35, -2.843243868408284e-35,
      -2.3571652583582382e-35, -1.732857506967982e-35, -1.0452943958000189e-35,
      -3.6425994876154495e-36, 2.5106596418660615e-36, 7.558079071027562e-36,
      1.1213007166848288e-35, 1.3352905203551533e-35, 1.4006581686720572e-35,
      1.3329900969383926e-35, 1.1573766695234194e-35, 9.048316410430068e-36,
      6.087032497723456e-36, 3.013949549327633e-36, 1.1640798110764569e-37,
      -2.3750379336591543e-36, -4.298812078386441e-36, -5.566667519198425e-36,
      -6.160939193790464e-36, -6.125960799157006e-36
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_5_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<5>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 0.7726036764438765), "design.b()[0] == 0.7726036764438765");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.7726036764438765));
    static_assert(almost_equal(design.b()[1], -3.802096274691354), "design.b()[1] == -3.802096274691354");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -3.802096274691354));
    static_assert(almost_equal(design.b()[2], 7.544235007775666), "design.b()[2] == 7.544235007775666");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 7.544235007775666));
    static_assert(almost_equal(design.b()[3], -7.544235007775666), "design.b()[3] == -7.544235007775666");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -7.544235007775666));
    static_assert(almost_equal(design.b()[4], 3.8020962746913542), "design.b()[4] == 3.8020962746913542");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 3.8020962746913542));
    static_assert(almost_equal(design.b()[5], -0.7726036764438768), "design.b()[5] == -0.7726036764438768");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -0.7726036764438768));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -4.411592688164334), "design.a()[1] == -4.411592688164334");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -4.411592688164334));
    static_assert(almost_equal(design.a()[2], 7.877502525914551), "design.a()[2] == 7.877502525914551");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 7.877502525914551));
    static_assert(almost_equal(design.a()[3], -7.1101833456869015), "design.a()[3] == -7.1101833456869015");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -7.1101833456869015));
    static_assert(almost_equal(design.a()[4], 3.2416749174310997), "design.a()[4] == 3.2416749174310997");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 3.2416749174310997));
    static_assert(almost_equal(design.a()[5], -0.5969164406249123), "design.a()[5] == -0.5969164406249123");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.5969164406249123));
    std::cout << "max_deviation(cheby2,highpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.7726036764438765, -0.393683544842665, -0.27872385282035594, -0.17925420691813,
      -0.09674456230084139, -0.03172959942210224, 0.016133130668268353, 0.04796024149770592,
      0.06550364159520972, 0.07098660656755815, 0.06692671814382278, 0.055957768453773926,
      0.04066202339774108, 0.023422758101365626, 0.006304878685488485,
      -0.009031073889078048, -0.021378962113180106, -0.03000125929904439,
      -0.034610036967877775, -0.03531943903374685, -0.032575930810473414,
      -0.02707360062181413, -0.0196621646836235, -0.011255105850018918,
      -0.0027446309738786007, 0.005071038344085168, 0.011543995700079565,
      0.016214185186711985, 0.018827381569948447, 0.01933440691957275, 0.017873716651941304,
      0.01474053662510487, 0.010346436713141227, 0.005173564157244431,
      -0.0002722591076716567, -0.005505711522846036, -0.010100160902880361,
      -0.013717406719633032, -0.016127425513753957, -0.017217511224161056,
      -0.016991099672188356, -0.01555735401675716, -0.013113215025000513,
      -0.00992005303132943, -0.006277282259256084, -0.0024953152250519854,
      0.001129936448174983, 0.004339137038595268, 0.00692674495557913, 0.008752457525628757,
      0.009746505321350303, 0.00990893790916933, 0.009303502326865505, 0.008047085162710618,
      0.006295948240425321, 0.004230126614473306, 0.002037376190524097,
      -0.00010203349700957896, -0.0020285705717724848, -0.0036138800423350147,
      -0.004767853010763368, -0.005442082241791676, -0.0056297649122258354,
      -0.005362385026140441, -0.004703728674250628, -0.003741942503920268,
      -0.0025804330375866977, -0.0013284214728562643, -9.192047814683604e-05,
      0.0010342039696386329, 0.0019725682905500017, 0.0026676596757766614,
      0.00308811576096827, 0.0032269133722591416, 0.0030996453317627647,
      0.0027411966774954135, 0.0022012275202787333, 0.0015389250265842418,
      0.0008175011268500591, 9.888820987397507e-05, -0.0005609722700568249,
      -0.0011159361527762197, -0.0015323452433986542, -0.001790492467949008,
      -0.0018848628672151662, -0.0018232452685776196, -0.0016248887201956753,
      -0.0013179361011893612, -0.0009364021250315019, -0.0005169736970782922,
      -9.589866238311501e-05, 0.0002938025832584483, 0.0006246150669480923,
      0.000876166441699673, 0.0010361551239192264, 0.0011005627043189714,
      0.0010732004118195575, 0.0009646867371273567, 0.0007909886900896394,
      0.00057168092274104, 0.0003280846624788276, 8.144276705912687e-05,
      -0.00014873008899975263, -0.00034600962779543964, -0.0004980569658470323,
      -0.0005972027999105913, -0.0006406132663205858, -0.0006300632843563728,
      -0.0005713714185019104, -0.00047357168949655, -0.0003479112938287129,
      -0.0002067685292645035, -6.258271273484721e-05, 7.312156053639328e-05,
      0.00019054845368874761, 0.0002822347092602453, 0.00034341563202849846,
      0.000372146719279459, 0.0003691940850817771, 0.0003377236395281809,
      0.00028283190402308804, 0.00021096972263102737, 0.0001293137344390515,
      4.513946391174954e-05, -3.475522874189579e-05, -0.00010453603774510854,
      -0.00015969794652229472, -0.00019729341424632005, -0.00021601795980656494,
      -0.0002161596785341123, -0.00019942923342707703, -0.00016869465200222114,
      -0.00012765043013577226, -8.045283474332899e-05, -3.135297895391929e-05,
      1.5643507707664917e-05, 5.70661357643034e-05, 9.020064302526576e-05,
      0.0001132306222901578, 0.0001252960050582289, 0.00012647154247587104,
      0.0001176743731529467, 0.00010051445593559907, 7.710482530343181e-05,
      4.985018956445305e-05, 2.123236539294362e-05, -6.390424217236085e-06,
      -3.095602007518627e-05, -5.083172936411347e-05, -6.490187570894313e-05,
      -7.260691637749197e-05, -7.393556258110536e-05, -6.937487111503105e-05,
      -5.9826093157691975e-05, -4.649601539555547e-05, -3.0774538157236724e-05,
      -1.4109313257886722e-05, 2.1125090200825906e-06, 1.666685978188778e-05,
      2.8573109888097366e-05, 3.7147998193342506e-05, 4.2031372186239664e-05,
      4.318434472820449e-05, 4.086256594141953e-05, 3.5569000041226026e-05,
      2.7991788665755312e-05, 1.8933428305061288e-05, 9.237589940705261e-06,
      -2.804933266210808e-07, -8.894972099280395e-06, -1.6017709615373772e-05,
      -2.1231393395433166e-05, -2.4306256900241295e-05, -2.5200625392476632e-05,
      -2.4046741907483602e-05, -2.1124342375935813e-05, -1.6825175663183302e-05,
      -1.1612074452120992e-05, -5.976273835051299e-06, -3.964686748546808e-07,
      4.697358212879379e-06, 8.952957963021793e-06, 1.2116086571542534e-05,
      1.404125454701765e-05, 1.4692998956970476e-05, 1.4138456639748237e-05,
      1.2532623633760621e-05, 1.0098127972366256e-05, 7.101601634868971e-06,
      3.828809455088418e-06, 5.605898416190609e-07, -2.448591505283471e-06,
      -4.988044340090543e-06, -6.9032304190994854e-06, -8.102614211213626e-06,
      -8.558965381617655e-06, -8.305525439342538e-06, -7.4278132820791755e-06,
      -6.052112725961102e-06, -4.331847252151571e-06, -2.433100329294201e-06,
      -5.204897368272771e-07, 1.2555352395076456e-06, 2.7691148559822606e-06,
      3.926516838333339e-06, 4.670470387675711e-06, 4.981255056889053e-06,
      4.874760195328251e-06, 4.397946944190645e-06, 3.62230732296999e-06,
      2.636016078250266e-06, 1.535508472872495e-06, 4.171940450315455e-07,
      -6.300600125867852e-07, -1.5311609259181395e-06, -2.2293708208047074e-06,
      -2.689031378348937e-06, -2.8963920862200018e-06, -2.8586531678579134e-06,
      -2.6014632189165047e-06, -2.165209862415815e-06, -1.6005045266322219e-06,
      -9.632881431867763e-07, -3.099745900188083e-07, 3.0699285325225573e-07,
      8.428637447239756e-07, 1.2633579356588693e-06, 1.54636914963896e-06,
      1.6825613037062693e-06, 1.6749136374815205e-06, 1.5373475051844697e-06,
      1.2926269995144907e-06, 9.69764408397688e-07, 6.011787245388567e-07,
      2.1985169280174665e-07, -1.4329657592908623e-07, -4.616280878969633e-07,
      -7.144677870265518e-07, -8.881636180778336e-07, -9.765006630101274e-07,
      -9.804968887755886e-07, -9.076537219762495e-07, -7.707704015366115e-07,
      -5.864549886795614e-07, -3.73476261706495e-07, -1.5109977169124478e-07,
      6.246070219873838e-08, 2.513662166661386e-07, 4.031679493392799e-07,
      5.094640343489983e-07, 5.661799273967222e-07, 5.734853097280613e-07,
      5.353876816913107e-07, 4.5906429217458624e-07, 3.5400874672755777e-07,
      2.3107601824877298e-07, 1.015097517867654e-07, -2.397063558435871e-08,
      -1.3595740175483818e-07, -2.2696668187103008e-07, -2.918439342910561e-07,
      -3.27950162692194e-07, -3.351346990945375e-07, -3.1551644284800674e-07,
      -2.7310836090157744e-07, -2.1332905449922436e-07, -1.4244994718050402e-07,
      -6.702717188849388e-08, 6.636118119581159e-09, 7.295789842901383e-08,
      1.2744581360481323e-07, 1.669465932691123e-07, 1.8976792741091006e-07,
      1.9567511085595687e-07, 1.8577431962347755e-07, 1.6230212457427933e-07,
      1.2834634414270968e-07, 8.752636746816511e-08, 4.366163415045746e-08,
      4.5522311110451897e-10, -3.878417212139618e-08, -7.136375449530372e-08,
      -9.535958044615207e-08, -1.0969538433311177e-07, -1.141479901943836e-07,
      -1.0928568949901286e-07, -9.635060066845436e-08, -7.709937454693487e-08,
      -5.36185279527573e-08, -2.81311578745866e-08, -2.810909192591574e-09,
      2.0382967318221964e-08, 3.983855657921092e-08, 5.43848166727724e-08,
      6.334206745658384e-08, 6.652948063076412e-08, 6.42329703686215e-08,
      5.7139657107519895e-08, 4.6247112252113096e-08, 3.2756798042271777e-08,
      1.7961477351519806e-08, 3.135932961954606e-09, -1.0560787434178467e-08,
      -2.2165044280343472e-08, -3.0965658589100765e-08, -3.653598973877122e-08,
      -3.8740850457286117e-08, -3.772005070319076e-08, -3.385201889292709e-08,
      -2.7702183241688034e-08, -1.996155074941379e-08, -1.1381182134140888e-08,
      -2.7080532165153266e-09, 5.37282349501061e-09, 1.2286082993634145e-08,
      1.760072320062217e-08, 2.1050345553291193e-08, 2.2538683093887053e-08,
      2.213134784633555e-08, 2.0035717710875737e-08, 1.6571630223871184e-08,
      1.2136020409490392e-08, 7.164821627973734e-09, 2.0953543309005944e-09,
      -2.6679091646257306e-09, -6.781846613960261e-09, -9.985762737353051e-09,
      -1.2114085109869513e-08, -1.3100465285401112e-08, -1.2973761501712763e-08,
      -1.1846968343542471e-08, -9.900610115755548e-09, -7.362405947588368e-09,
      -4.485137927710947e-09, -1.5246148058038318e-09, 1.2805589760238474e-09,
      3.725998344368338e-09, 5.654307651912635e-09, 6.963003036186401e-09,
      7.60741828997873e-09, 7.598832327037744e-09, 6.998406940261097e-09,
      5.907795770669949e-09, 4.45746526553222e-09, 2.793850431788806e-09,
      1.06645505197557e-09, -5.840924351883759e-10, -2.0361843947850366e-09,
      -3.194956172016766e-09, -3.99720721652099e-09, -4.41339683645836e-09,
      -4.446829930981825e-09, -4.130356518405398e-09, -3.5210727795630494e-09,
      -2.6936220172267603e-09, -1.7327476911928644e-09, -7.257486052410745e-10,
      2.445662678366239e-10, 1.1059201532543902e-09, 1.8012296848782263e-09,
      2.291649376923546e-09, 2.557911687695922e-09, 2.600016054969355e-09,
      2.435444101771165e-09, 2.0961767404863463e-09, 1.624856800791111e-09,
      1.0704756152443639e-09, 4.839640659939496e-10, -8.5959201600052e-11,
      -5.963824227940766e-10, -1.0130094796828407e-09, -1.3120365349069586e-09,
      -1.4810365238211326e-09, -1.518874432525491e-09, -1.4347497544824485e-09,
      -1.24652166045127e-09, -9.785139495431e-10, -6.590191653980653e-10,
      -3.177244005635947e-10, 1.673319419426391e-11, 3.1890256471152676e-10,
      5.682085364948602e-10, 7.501047900476247e-10, 8.566498359632557e-10,
      8.865145210037117e-10, 8.444731411113788e-10, 7.404656867577134e-10,
      5.883440854225945e-10, 4.0442949566706403e-10, 2.0601067343156671e-10,
      9.905982242658385e-12, -1.6880469928428487e-10, -3.1779501260172444e-10,
      -4.281983767151271e-10, -4.949789910850007e-10, -5.169697063672174e-10,
      -4.966046698572357e-10, -4.3939587188729276e-10, -3.5321814173763446e-10,
      -2.474761010976654e-10, -1.3222897969769575e-10, -1.734545248392954e-11,
      8.824836831681787e-11, 1.7717776656223535e-10, 2.4405086120961206e-10,
      2.8569543625294266e-10, 3.012007191872829e-10, 2.917789187001402e-10,
      2.604740172909036e-10, 2.1175468002169217e-10, 1.5103376369760554e-10,
      8.415869960065793e-11, 1.6915193144343213e-11, -4.541828660667881e-11,
      -9.843518710813548e-11, -1.3886376859204163e-10, -1.6471714203510228e-10,
      -1.7532920221162867e-10, -1.712842237574782e-10, -1.542554618208923e-10,
      -1.2677377443090267e-10, -9.195079437035974e-11, -5.318245085167175e-11,
      -1.3857783750985605e-11, 2.290473023719347e-11, 5.4475324162757315e-11,
      7.887276431371887e-11, 9.485878885018551e-11, 1.0196585335332783e-10,
      1.0046219766445917e-10, 9.126276483707894e-11, 7.579793576065248e-11,
      5.585422471105482e-11, 3.3401957480734955e-11, 1.0424577410343597e-11,
      -1.1237259017732696e-11, -3.001600806377032e-11, -4.4714191466628264e-11,
      -5.456350625681276e-11, -5.924498731833486e-11, -5.887225817854481e-11,
      -5.394259570231982e-11, -4.526260679531056e-11, -3.385666547956846e-11,
      -2.086684838652213e-11, -7.452960285213207e-12, 5.299561661165233e-12,
      1.6457412203667903e-11, 2.5298113646683982e-11, 3.134683159755173e-11,
      3.439046644792825e-11, 3.447002670025656e-11, 3.1853890853444665e-11,
      2.6995813589274825e-11, 2.0482364611896736e-11, 1.2974878327145182e-11,
      5.15095022062957e-12, -2.3499153610025182e-12, -8.972651656872178e-12,
      -1.4282097227849385e-11, -1.7985826617014668e-11, -1.994373402843296e-11,
      -2.016484975340091e-11, -1.8792820353752856e-11, -1.6082235163537758e-11,
      -1.2368493382002755e-11, -8.034160211926918e-12, -3.4747611811868666e-12,
      9.332655980638174e-13, 4.860159726599015e-12, 8.044232522512453e-12,
      1.0305970216036662e-11, 1.1554421822972933e-11, 1.1786088230294969e-11,
      1.1077093800744532e-11, 9.569873323197382e-12, 7.455920679551811e-12,
      4.956309495210476e-12, 2.3017113695072342e-12, -2.864833880333596e-13,
      -2.6125722501772765e-12, -4.519423717298893e-12, -5.8971589316383596e-12,
      -6.687343806392277e-12, -6.8827806175682974e-12, -6.523322965633327e-12,
      -5.688408882814322e-12, -4.4871984524834115e-12, -3.047307021291149e-12,
      -1.5031428038909506e-12, 1.5204918725291198e-14, 1.3917114005572468e-12,
      2.5321623306511224e-12, 3.369481173854882e-12, 3.8664465200975186e-12,
      4.0158292976247855e-12, 3.838178165346546e-12, 3.3776436680754512e-12,
      2.696348513233229e-12, 1.867877715692922e-12, 9.704778488699958e-13,
      8.052274171112531e-14, -7.332694493081836e-13, -1.4144863864385216e-12,
      -1.9222811867858374e-12, -2.2331161413860504e-12, -2.3409949543805992e-12,
      -2.256305409092318e-12, -2.0034914478505457e-12, -1.6178446604066023e-12,
      -1.1417469890259216e-12, -6.207085203341727e-13, -9.952836008530545e-14,
      3.8113339687805357e-13, 7.875433312524708e-13, 1.0948839094661504e-12,
      1.2883630669867186e-12, 1.3634391141966339e-12, 1.3252253783674847e-12,
      1.1871970007619807e-12, 9.693653924358353e-13, 6.96112037961515e-13,
      3.9388214629204937e-13, 8.893100486302176e-14, -1.94706082946907e-13,
      -4.368826640450438e-13, -6.225521104521466e-13, -7.424686762579347e-13,
      -7.933711984384544e-13, -7.776830410614222e-13, -7.027964981385397e-13,
      -5.800359592889787e-13, -4.234104596766504e-13, -2.4827241399918276e-13,
      -6.99958310368953e-14, 9.722470948921601e-14, 2.413718367362208e-13,
      3.5334093602332864e-13, 4.273803905422172e-13, 4.612295392009715e-13,
      4.559715939512525e-13, 4.1563939295359217e-13, 3.466276335719531e-13,
      2.5697535244797875e-13, 1.5558663215121572e-13, 5.14560341993464e-14,
      -4.704127071967029e-14, -1.327453057692876e-13, -2.0015712422480195e-13,
      -2.457138005861995e-13, -2.6788695652639247e-13, -2.671134848417871e-13,
      -2.4557941896011995e-13, -2.0688740825283878e-13, -1.5564451526075782e-13,
      -9.700986377964117e-14, -3.6241136144730306e-14, 2.172460489048483e-14,
      7.262625760901151e-14, 1.1314838659796076e-13, 1.410921905411263e-13,
      1.554435454745891e-13, 1.5634235143085006e-13, 1.4496471610703972e-13,
      1.2333523861156882e-13, 9.409050865551306e-14, 6.021678520714433e-14,
      2.4784705056829238e-14, -9.298013422765055e-15, -3.949825165016912e-14,
      -6.382034751961216e-14, -8.091194914365695e-14, -9.01098906845989e-14,
      -9.14280685899982e-14, -8.549363668496977e-14, -7.344128387549183e-14,
      -5.6777722878108645e-14, -3.722971809895259e-14, -1.6589029891485726e-14,
      3.4333463136607464e-15, 2.1333139131077954e-14, 3.5910969389727e-14,
      4.6337645663874284e-14, 5.2184539978800494e-14, 5.341990955560132e-14,
      5.037460612498592e-14, 4.368268299748425e-14, 3.420385735957217e-14,
      2.293555586047322e-14, 1.092236805022687e-14, -8.297904530612279e-16,
      -1.14285469269673e-14, -2.015414962271436e-14, -2.649961026616843e-14,
      -3.019053439621608e-14, -3.118497462840498e-14, -2.96551689071173e-14,
      -2.595426610751342e-14, -2.057202479486619e-14, -1.4083961701216769e-14,
      -7.098522641688065e-15, -2.0657921924542658e-16, 6.063025372085596e-15,
      1.1278974823038763e-14, 1.513208356156434e-14, 1.744809636827322e-14,
      1.818877902058245e-14, 1.7442299591685143e-14, 1.5404642652418172e-14,
      1.2354336573314818e-14, 8.623084406113803e-15, 4.564968330226051e-15,
      5.267615578335336e-16, -3.178439512364544e-15, -6.292514036312076e-15,
      -8.627354854046893e-15, -1.0073053145250697e-14, -1.059922617388625e-14,
      -1.0250019775474236e-14, -9.13376129807043e-15, -7.40856553334431e-15,
      -5.265391138198361e-15, -2.910105160064832e-15, -5.460463444135586e-16,
      1.6415990893536108e-15, 3.498558568444674e-15, 4.91064117047827e-15,
      5.808930351764885e-15, 6.170964676105886e-15, 6.018186118977864e-15,
      5.410200715664961e-15, 4.436594462174813e-15, 3.2071692232535666e-15,
      1.8415065174755237e-15, 4.587353659283316e-16, -8.317166913773506e-16,
      -1.937759158723449e-15, -2.7902146907362746e-15, -3.346091641633265e-15,
      -3.5895112256804975e-15, -3.530434249521361e-15, -3.2014905602255777e-15,
      -2.6533342401934138e-15, -1.949023369016836e-15, -1.1579530373899236e-15,
      -3.498561642633566e-16, 4.1066628611000786e-16, 1.0687081396169606e-15,
      1.5824420605869048e-15, 1.9251700896768925e-15, 2.086004281988867e-15,
      2.0692512658948704e-15, 1.8926687860704056e-15, 1.5848346995416735e-15,
      1.1819158372154591e-15, 7.241443229271962e-16, 2.5230326305340997e-16,
      -1.9550497944197164e-16, -5.865820612416374e-16, -8.956831975385033e-16,
      -1.1062955325983373e-15, -1.2111170804200814e-15, -1.211772939701539e-15,
      -1.1178615723095135e-15, -9.454675872386827e-16, -7.153064398151636e-16,
      -4.506798398330183e-16, -1.7541886223116863e-16, 8.802368318324636e-17,
      3.2019667334304003e-16, 5.058896020909889e-16, 6.349260126338257e-16,
      7.024908219265486e-16, 7.090091878008481e-16, 6.596279098221052e-16,
      5.633766296922574e-16, 4.3210391184294804e-16, 2.7929203401282486e-16,
      1.1885415854486697e-16, -3.599067448988871e-17, -1.736842019713091e-16,
      -2.850765198717687e-16, -3.6391658300068137e-16, -4.0707118353671874e-16,
      -4.1448048310932533e-16, -3.8887797142175345e-16, -3.3531851476527795e-16,
      -2.605690800425955e-16, -1.7242237323317119e-16, -7.899406279189588e-17,
      1.1940081653887305e-17, 9.351913623233873e-17, 1.602473592648037e-16,
      2.0829633892428858e-16, 2.356491153306383e-16, 2.4208967600252883e-16,
      2.2905296809006707e-16, 1.9936004629877344e-16, 1.5686965308569026e-16,
      1.0608114594998016e-16, 5.1724246682821557e-17, -1.631171090320378e-18,
      -4.9916679599744777e-17, -8.983614209950286e-17, -1.1905123654401147e-16,
      -1.3627509267588055e-16, -1.4127525185712468e-16, -1.3479411888839905e-16,
      -1.184007531055165e-16, -9.429191813575281e-17, -6.506260702553536e-17,
      -3.346676725586453e-17, -2.1877946148605733e-18, 2.6364209792292503e-17,
      5.0215086681092076e-17, 6.794019934833407e-17, 7.872463523346193e-17,
      8.237027804294323e-17, 7.925412064056551e-17, 7.024558680806664e-17,
      5.659310727375122e-17, 3.9791644169513223e-17, 2.1443260599750548e-17,
      3.122253816811813e-18, -1.374505245969393e-17, -2.797783953443495e-17,
      -3.8710143191249614e-17, -4.542922323389332e-17, -4.7982830553662915e-17,
      -4.655768620796829e-17, -4.163351776906333e-17, -3.3918501964234334e-17,
      -2.427287091998645e-17, -1.3627736468031133e-17, -2.905906410550344e-18,
      7.04931622573641e-18, 1.5532537504336515e-17, 2.201851092061176e-17,
      2.6186413161287298e-17, 2.792592801179514e-17, 2.7326349167355647e-17,
      2.465112490260044e-17, 2.0301178491947527e-17, 1.477090481262807e-17,
      8.600953423687127e-18, 2.3317782719520165e-18, -3.538494323307772e-18,
      -8.588993553815689e-18, -1.2501771209841176e-17, -1.5077064083132104e-17,
      -1.6237925226994236e-17, -1.6024847719177584e-17, -1.4581727287641644e-17,
      -1.2135060920527128e-17, -8.968630365005245e-18, -5.396063222184137e-18,
      -1.7336082184843867e-18, 1.7247719239296422e-18, 4.728262200269776e-18,
      7.084759365505386e-18, 8.670415223628893e-18, 9.432972625735672e-18,
      9.389209027370678e-18, 8.617232841648267e-18, 7.244710219789989e-18,
      5.4343174489681154e-18, 3.3678105494319042e-18, 1.2300825856738174e-18,
      -8.055467960029568e-19, -2.5897764808726027e-18, -4.0067429081537655e-18,
      -4.979958738930777e-18, -5.474630421572729e-18, -5.496509355768033e-18,
      -5.087687370718437e-18, -4.319947499209662e-18, -3.2864150927471332e-18,
      -2.0923178609010715e-18, -8.456580083875225e-19, 3.514679047751721e-19,
      1.4102844170117827e-18, 2.2610267566907386e-18, 2.856620717698005e-18,
      3.1742519990381618e-18, 3.214898129318117e-18, 3.0010482217675815e-18,
      2.5729562708773798e-18, 1.9838560454975132e-18, 1.294606964804016e-18,
      5.682412387106124e-19, -1.3515331083336188e-19, -7.628467541532055e-19,
      -1.2728978598701575e-18, -1.6364256675965738e-18, -1.8386520548628158e-18,
      -1.878747839816152e-18, -1.768605259215973e-18, -1.5307320140010289e-18,
      -1.1955125018095163e-18, -7.981084555987283e-19, -3.7527411271212587e-19,
      3.765778220229306e-20, 4.093999036093763e-19, 7.147756952075673e-19,
      9.36116811504967e-19, 1.0639455371822419e-18, 1.0969551998082175e-18,
      1.0413551354202388e-18, 9.096901592763201e-19, 7.192752918887327e-19,
      4.904034580949525e-19, 2.4448697228719114e-19, 2.283889686315295e-21,
      -2.1766031078773737e-19, -4.002541262180299e-19, -5.3471705322416555e-19,
      -6.150210033637375e-19, -6.399201850587047e-19, -6.126052448360829e-19,
      -5.4004344903887925e-19, -4.3208544971398027e-19, -3.004299212017534e-19,
      -1.5753998212760012e-19, -1.5600377773908856e-20, 1.144070234896479e-19,
      2.2344827773373165e-19, 3.049614748111181e-19, 3.551395011799284e-19,
      3.729717611197438e-19, 3.6006393190015983e-19, 3.2027037254253435e-19,
      2.5918520994320383e-19, 1.8354488440307877e-19, 1.0059695233301113e-19,
      1.7487499206317953e-20, -5.928678542722394e-20, -1.243251281705057e-19,
      -1.736423568764486e-19, -2.0484856793929642e-19, -2.1718773433405635e-19,
      -2.1144531068063775e-19, -1.897441769787186e-19, -1.5525517939895497e-19,
      -1.1185275461073725e-19, -6.374758289456079e-20, -1.512704750108808e-20,
      3.0169182228485064e-20, 6.891639639362784e-20, 9.869937236326937e-20,
      1.1802574998964732e-19, 1.2635692979333253e-19, 1.2406172479925094e-19,
      1.1230353661002041e-19, 9.287601300759042e-20, 6.80047767116517e-20,
      4.01338315890674e-20, 1.1714723983874516e-20, -1.498535269890857e-20,
      -3.804329903398203e-20, -5.599821668760086e-20, -6.792252724633864e-20,
      -7.34449090484418e-20, -7.272772661156491e-20, -6.64049286175378e-20,
      -5.548891988581785e-20, -4.1256544574590916e-20, -2.5125007884055808e-20,
      -8.528345227264581e-21, 7.195977647552838e-21, 2.0902428001286615e-20,
      3.170896635722484e-20, 3.9041427712058396e-20, 4.2649780192056595e-20,
      4.259759833114226e-20, 3.922805327358307e-20, 3.3111247738931945e-20,
      2.4978731276313744e-20, 1.5651490560946087e-20, 5.967635240877457e-21,
      -3.284552664090514e-21, -1.1423481181631689e-20, -1.7917522450620866e-20,
      -2.2412582261002284e-20, -2.474326973693208e-20, -2.4928315272842283e-20,
      -2.3152053275673865e-20, -1.9734704795407055e-20, -1.509481525527167e-20,
      -9.707503501507251e-21, -4.062166366973796e-21, 1.37701218025055e-21,
      6.2049272108263625e-21, 1.0101674153511372e-20, 1.2849605513051871e-20,
      1.4340832447825715e-20, 1.4575471318309273e-20, 1.3651629318009032e-20,
      1.1748675477820888e-20, 9.105723766171161e-21, 5.997449931054173e-21,
      2.709375128957729e-21, -4.854066281186431e-22, -3.3463759266121132e-21,
      -5.6813285016879554e-21, -7.3568895174778e-21, -8.303465712723598e-21,
      -8.514764453065623e-21, -8.042420505488015e-21, -6.986602800780368e-21,
      -5.483706167374689e-21, -3.692358001207735e-21, -1.7789873143932547e-21,
      9.587782387116062e-23, 1.789583264387809e-21, 3.18681862115204e-21,
      4.206077308443233e-21, 4.802881771790058e-21, 4.969822039473073e-21,
      4.733699792826253e-21, 4.1502688264859815e-21, 3.2972047549713664e-21,
      2.2660162974824404e-21, 1.1536270309823424e-21, 5.431467959095802e-23,
      -9.47396524051193e-22, -1.782424368833553e-21, -2.401085898956851e-21,
      -2.7751751081606696e-21, -2.898173169700411e-21, -2.7837478027515514e-21,
      -2.4628172995496515e-21, -1.9795411562503337e-21, -1.3866494355670164e-21,
      -7.40536383346906e-22, -9.652278797900486e-23, 4.953590594653501e-22,
      9.937774846059598e-22, 1.3685188968770567e-21, 1.6018142072941268e-21,
      1.68857182091892e-21, 1.6356003246864533e-21, 1.4599750851037443e-21,
      1.186755451017128e-21, 8.462907554615843e-22, 4.713633146517776e-22,
      9.440634244669889e-23, -2.549931841325711e-22, -5.521383532526509e-22,
      -7.786954347973886e-22, -9.235342654729043e-22, -9.829289750827693e-22,
      -9.601626554525758e-22, -8.646220210258214e-22, -7.104999144919532e-22,
      -5.152431774704053e-22, -2.9789052585335595e-22, -7.744024897311516e-23,
      1.2862772665638344e-22, 3.055744443056954e-22, 4.42297496263368e-22,
      5.318600238090982e-22, 5.716458399463273e-22, 5.631632117561301e-22,
      5.115451526061924e-22, 4.248133110104759e-22, 3.129847653610198e-22,
      1.8710593858278416e-22, 5.82957293479298e-23, -6.312836751421615e-23,
      -1.6838068520980553e-22, -2.507506771123492e-22, -3.059340407275284e-22,
      -3.321455037057211e-22, -3.3002470189896683e-22, -3.0236165741914203e-22,
      -2.5367997847285037e-22, -1.897234675695476e-22, -1.1689512562807475e-22,
      -4.169671409766085e-23, 2.978746791138886e-23, 9.232642709119471e-23,
      1.418713945740882e-22, 1.7576207251028335e-22, 1.928054873541011e-22,
      1.9323310142297467e-22, 1.7855080541592444e-22, 1.513034142145011e-22,
      1.1477995316886016e-22, 7.268820466473351e-23, 2.8826744804585184e-23,
      -1.3219719348444156e-23, -5.0340109738219126e-23, -8.009573541745414e-23,
      -1.0084819862943468e-22, -1.1181303697203084e-22, -1.1304179767610212e-22,
      -1.0534057187467152e-22, -9.013722856061545e-23, -6.931245500381769e-23,
      -4.5011133693664595e-23, -1.9450588133796946e-23, 5.2590574926281536e-24,
      2.7269516787693457e-23, 4.511423354355368e-23, 5.778739642514792e-23,
      6.477970035191264e-23, 6.607207240206009e-23, 6.209174560451136e-23,
      5.363759441863151e-23, 4.178340251570601e-23, 2.7768651320352853e-23,
      1.2886502781629501e-23, -1.6220274563565264e-24, -1.4660026484835587e-23,
      -2.5346883371359456e-23, -3.3066930624525185e-23, -3.7492916647885054e-23,
      -3.858481014601149e-23, -3.656631490502584e-23, -3.188299141301614e-23,
      -2.5146955315400792e-23, -1.7073709170063842e-23, -8.416762757909704e-24,
      9.465421117246874e-26
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.7726036764438765, -0.3936835448426655, -0.2787238528203583, -0.17925420691813776,
      -0.09674456230085988, -0.03172959942213752, 0.01613313066821026, 0.04796024149761989,
      0.06550364159509234, 0.07098660656740827, 0.06692671814364178, 0.05595776845356568,
      0.04066202339751181, 0.023422758101123306, 0.006304878685242189, -0.00903107388931889,
      -0.021378962113406442, -0.03000125929924822, -0.03461003696805264,
      -0.03531943903388817, -0.03257593081057872, -0.027073600621883062,
      -0.01966216468365767, -0.01125510585002162, -0.0027446309738544308,
      0.005071038344130722, 0.011543995700140555, 0.016214185186782387,
      0.018827381570022526, 0.01933440691964537, 0.01787371665200813, 0.01474053662516252,
      0.01034643671318735, 0.005173564157277729, -0.0002722591076514923,
      -0.005505711522838429, -0.010100160902884002, -0.013717406719646054,
      -0.016127425513774118, -0.01721751122418594, -0.01699109967221557,
      -0.015557354016784502, -0.013113215025026085, -0.009920053031351744,
      -0.0062772822592740965, -0.0024953152250650995, 0.0011299364481669421,
      0.004339137038592089, 0.006926744955580276, 0.00875245752563344, 0.009746505321357561,
      0.009908937909178114, 0.00930350232687475, 0.008047085162719325, 0.006295948240432636,
      0.004230126614478577, 0.002037376190526905, -0.00010203349700941213,
      -0.0020285705717749047, -0.003613880042339759, -0.004767853010770005,
      -0.005442082241799652, -0.005629764912234523, -0.005362385026149191,
      -0.004703728674258818, -0.0037419425039273463, -0.00258043303759222,
      -0.0013284214728599161, -9.192047814844223e-05, 0.0010342039696391073,
      0.0019725682905524598, 0.002667659675780886, 0.003088115760973943,
      0.0032269133722658654, 0.0030996453317700895, 0.0027411966775028685,
      0.0022012275202858535, 0.0015389250265905995, 0.0008175011268552937,
      9.88882098778152e-05, -0.0005609722700545459, -0.0011159361527755573,
      -0.0015323452433995543, -0.001790492467951317, -0.0018848628672186486,
      -0.0018232452685819768, -0.0016248887202005684, -0.0013179361011944344,
      -0.0009364021250364076, -0.000516973697082712, -9.589866238677859e-05,
      0.0002938025832557476, 0.0006246150669464871, 0.000876166441699217,
      0.0010361551239198947, 0.0011005627043206665, 0.001073200411822121,
      0.0009646867371305823, 0.0007909886900932886, 0.0005716809227448594,
      0.0003280846624825676, 8.144276706255747e-05, -0.00014873008899682642,
      -0.0003460096277931665, -0.0004980569658455067, -0.0005972027999098502,
      -0.0006406132663206095, -0.0006300632843570902, -0.0005713714185032071,
      -0.00047357168949827943, -0.00034791129383070956, -0.00020676852926659696,
      -6.258271273687515e-05, 7.312156053457363e-05, 0.0001905484536872505,
      0.0002822347092591503, 0.0003434156320278474, 0.00037214671927925596,
      0.0003691940850819912, 0.00033772363952875114, 0.00028283190402393047,
      0.00021096972263204327, 0.00012931373444013614, 4.513946391280085e-05,
      -3.475522874096927e-05, -0.00010453603774438118, -0.0001596979465218192,
      -0.00019729341424612465, -0.0002160179598066534, -0.00021615967853446505,
      -0.00019942923342765458, -0.0001686946520029687, -0.00012765043013662514,
      -8.045283474421846e-05, -3.135297895477814e-05, 1.5643507706897187e-05,
      5.7066135763676416e-05, 9.020064302481525e-05, 0.00011323062228990388,
      0.00012529600505817559, 0.00012647154247600716, 0.00011767437315324786,
      0.00010051445593603045, 7.710482530395166e-05, 4.985018956501631e-05,
      2.1232365393505637e-05, -6.390424216716211e-06, -3.09560200747429e-05,
      -5.083172936377238e-05, -6.49018757087203e-05, -7.260691637739321e-05,
      -7.393556258112687e-05, -6.93748711151605e-05, -5.982609315791014e-05,
      -4.649601539583812e-05, -3.077453815755676e-05, -1.4109313258216413e-05,
      2.1125090197695073e-06, 1.6666859781614224e-05, 2.8573109887881447e-05,
      3.7147998193196525e-05, 4.203137218616963e-05, 4.318434472821015e-05,
      4.0862565941494856e-05, 3.5569000041360176e-05, 2.799178866593381e-05,
      1.8933428305267395e-05, 9.237589940921409e-06, -2.8049332641188453e-07,
      -8.894972099093292e-06, -1.6017709615221045e-05, -2.1231393395323533e-05,
      -2.4306256900179512e-05, -2.520062539246346e-05, -2.4046741907516057e-05,
      -2.1124342376007705e-05, -1.6825175663285962e-05, -1.1612074452244115e-05,
      -5.976273835183851e-06, -3.964686749858082e-07, 4.697358212759527e-06,
      8.952957962921377e-06, 1.2116086571467535e-05, 1.404125454697158e-05,
      1.4692998956954321e-05, 1.4138456639760604e-05, 1.2532623633798048e-05,
      1.0098127972423662e-05, 7.101601634940183e-06, 3.828809455166732e-06,
      5.605898416978022e-07, -2.448591505210426e-06, -4.9880443400283416e-06,
      -6.903230419051986e-06, -8.102614211183209e-06, -8.558965381605171e-06,
      -8.305525439347374e-06, -7.427813282099423e-06, -6.052112725993814e-06,
      -4.331847252193079e-06, -2.433100329340469e-06, -5.204897368742491e-07,
      1.2555352394637265e-06, 2.769114855944584e-06, 3.926516838304329e-06,
      4.6704703876569e-06, 4.981255056881037e-06, 4.874760195330722e-06,
      4.397946944202496e-06, 3.6223073229894638e-06, 2.6360160782751565e-06,
      1.5355084729003566e-06, 4.171940450599041e-07, -6.300600125602366e-07,
      -1.5311609258953732e-06, -2.2293708207872322e-06, -2.6890313783377185e-06,
      -2.896392086215431e-06, -2.858653167859823e-06, -2.601463218924227e-06,
      -2.1652098624282764e-06, -1.6005045266480616e-06, -9.632881432044746e-07,
      -3.099745900368163e-07, 3.0699285323539464e-07, 8.428637447095201e-07,
      1.2633579356477981e-06, 1.5463691496319168e-06, 1.6825613037035391e-06,
      1.674913637483036e-06, 1.5373475051898427e-06, 1.2926269995230665e-06,
      9.697644084086172e-07, 6.011787245511751e-07, 2.1985169281445704e-07,
      -1.4329657591693567e-07, -4.6162808788621053e-07, -7.144677870178654e-07,
      -8.881636180716757e-07, -9.765006630067342e-07, -9.804968887749709e-07,
      -9.076537219782094e-07, -7.70770401540775e-07, -5.864549886854225e-07,
      -3.7347626171346535e-07, -1.5109977169870621e-07, 6.246070219138495e-08,
      2.513662166594294e-07, 4.0316794933365316e-07, 5.094640343447699e-07,
      5.661799273940726e-07, 5.734853097270335e-07, 5.353876816918195e-07,
      4.590642921764358e-07, 3.5400874673046547e-07, 2.310760182523992e-07,
      1.015097517907449e-07, -2.3970635580386426e-08, -1.3595740175120126e-07,
      -2.2696668186800146e-07, -2.9184393428883694e-07, -3.2795016269090394e-07,
      -3.3513469909421257e-07, -3.155164428486036e-07, -2.7310836090298347e-07,
      -2.1332905450127188e-07, -1.4244994718298847e-07, -6.702717189119304e-08,
      6.636118116888096e-09, 7.295789842652925e-08, 1.2744581360270682e-07,
      1.6694659326751066e-07, 1.8976792740989045e-07, 1.9567511085554527e-07,
      1.8577431962365074e-07, 1.6230212457497083e-07, 1.283463441438182e-07,
      8.752636746956532e-08, 4.3661634152011616e-08, 4.5522311267419014e-10,
      -3.878417211993924e-08, -7.136375449406836e-08, -9.53595804452209e-08,
      -1.0969538433253687e-07, -1.1414799019418499e-07, -1.0928568949917972e-07,
      -9.635060066894839e-08, -7.709937454769569e-08, -5.361852795370905e-08,
      -2.8131157875645098e-08, -2.8109091936715273e-09, 2.038296731720032e-08,
      3.983855657831614e-08, 5.4384816672057554e-08, 6.334206745608378e-08,
      6.652948063049443e-08, 6.423297036857896e-08, 5.7139657107684384e-08,
      4.6247112252450606e-08, 3.2756798042738214e-08, 1.7961477352065235e-08,
      3.135932962527623e-09, -1.0560787433626673e-08, -2.216504427985558e-08,
      -3.096565858871057e-08, -3.653598973850176e-08, -3.874085045714881e-08,
      -3.7720050703185516e-08, -3.3852018893043304e-08, -2.770218324190627e-08,
      -1.9961550749708044e-08, -1.1381182134481172e-08, -2.7080532168703752e-09,
      5.372823494670747e-09, 1.2286082993335833e-08, 1.760072320038638e-08,
      2.1050345553132285e-08, 2.2538683093812167e-08, 2.213134784634464e-08,
      2.003571771096219e-08, 1.657163022402291e-08, 1.213602040969122e-08,
      7.164821628205026e-09, 2.0953543311429012e-09, -2.6679091643910797e-09,
      -6.781846613749773e-09, -9.98576273717998e-09, -1.2114085109743125e-08,
      -1.3100465285326305e-08, -1.2973761501690077e-08, -1.184696834356842e-08,
      -9.900610115823232e-09, -7.3624059476882986e-09, -4.485137927831999e-09,
      -1.5246148059342544e-09, 1.2805589758954706e-09, 3.725998344252238e-09,
      5.654307651817169e-09, 6.963003036117562e-09, 7.607418289939887e-09,
      7.59883232702961e-09, 6.998406940281908e-09, 5.907795770715825e-09,
      4.4574652655976634e-09, 2.793850431867269e-09, 1.0664550520600595e-09,
      -5.840924351047136e-10, -2.0361843947083954e-09, -3.1949561719522563e-09,
      -3.99720721647234e-09, -4.41339683642775e-09, -4.446829930969854e-09,
      -4.130356518411175e-09, -3.521072779584391e-09, -2.6936220172604795e-09,
      -1.7327476912351085e-09, -7.257486052876836e-10, 2.4456626778976864e-10,
      1.1059201532110515e-09, 1.8012296848415514e-09, 2.291649376895878e-09,
      2.5579116876786903e-09, 2.600016054963047e-09, 2.4354441017753716e-09,
      2.096176740499869e-09, 1.6248568008121221e-09, 1.070475615270601e-09,
      4.839640660229261e-10, -8.595920157083454e-11, -5.963824227669333e-10,
      -1.013009479659738e-09, -1.3120365348893893e-09, -1.4810365238100385e-09,
      -1.5188744325212362e-09, -1.4347497544848384e-09, -1.2465216604596125e-09,
      -9.785139495563011e-10, -6.590191654147476e-10, -3.177244005822259e-10,
      1.673319417523918e-11, 3.189025646935654e-10, 5.68208536479217e-10,
      7.501047900352728e-10, 8.566498359548358e-10, 8.86514520999511e-10,
      8.444731411113387e-10, 7.404656867614624e-10, 5.883440854295031e-10,
      4.0442949567631506e-10, 2.0601067344223427e-10, 9.905982253789389e-12,
      -1.6880469927359426e-10, -3.17795012592263e-10, -4.281983767075173e-10,
      -4.949789910796646e-10, -5.169697063643616e-10, -4.966046698568546e-10,
      -4.3939587188918856e-10, -3.5321814174145004e-10, -2.474761011029262e-10,
      -1.322289797038571e-10, -1.7345452490425823e-11, 8.824836831052755e-11,
      1.7717776655662715e-10, 2.4405086120506603e-10, 2.856954362497219e-10,
      3.012007191855232e-10, 2.917789186998507e-10, 2.6047401729197746e-10,
      2.1175468002392517e-10, 1.5103376370072145e-10, 8.415869960433652e-11,
      1.6915193148249273e-11, -4.541828660286788e-11, -9.843518710470572e-11,
      -1.3886376858922353e-10, -1.6471714203305793e-10, -1.753292022104455e-10,
      -1.7128422375716876e-10, -1.5425546182140012e-10, -1.2677377443211288e-10,
      -9.195079437211344e-11, -5.318245085378239e-11, -1.3857783753256141e-11,
      2.2904730234954278e-11, 5.447532416072058e-11, 7.887276431202413e-11,
      9.485878884893277e-11, 1.019658533525735e-10, 1.0046219766421563e-10,
      9.126276483731771e-11, 7.579793576131003e-11, 5.585422471204065e-11,
      3.3401957481941e-11, 1.042457741165408e-11, -1.1237259016431598e-11,
      -3.001600806258183e-11, -4.471419146563786e-11, -5.4563506256083063e-11,
      -5.924498731790271e-11, -5.887225817842062e-11, -5.394259570248908e-11,
      -4.526260679573719e-11, -3.385666548019952e-11, -2.0866848387293386e-11,
      -7.45296028605509e-12, 5.299561660321802e-12, 1.6457412202886223e-11,
      2.5298113646017178e-11, 3.1346831597039514e-11, 3.4390466447595004e-11,
      3.447002670011078e-11, 3.1853890853479684e-11, 2.6995813589470628e-11,
      2.0482364612222677e-11, 1.2974878327563291e-11, 5.1509502210981015e-12,
      -2.3499153605255077e-12, -8.972651656425555e-12, -1.4282097227466174e-11,
      -1.7985826616719988e-11, -1.9943734028242762e-11, -2.0164849753321535e-11,
      -1.879282035378138e-11, -1.6082235163663034e-11, -1.2368493382207018e-11,
      -8.034160212187732e-12, -3.474761181479299e-12, 9.332655977650351e-13,
      4.86015972631749e-12, 8.044232522268435e-12, 1.0305970215845756e-11,
      1.1554421822845297e-11, 1.1786088230234994e-11, 1.1077093800751004e-11,
      9.569873323264069e-12, 7.455920679668374e-12, 4.956309495363623e-12,
      2.3017113696820024e-12, -2.864833878523092e-13, -2.612572250004441e-12,
      -4.519423717146876e-12, -5.8971589315170564e-12, -6.6873438063083425e-12,
      -6.882780617524907e-12, -6.523322965630237e-12, -5.688408882848194e-12,
      -4.487198452548345e-12, -3.047307021379381e-12, -1.5031428039936252e-12,
      1.520491861733031e-14, 1.391711400452718e-12, 2.5321623305576687e-12,
      3.3694811737785783e-12, 3.866446520042545e-12, 4.015829297593279e-12,
      3.838178165338626e-12, 3.3776436680893945e-12, 2.696348513265774e-12,
      1.8678777157396595e-12, 9.704778489258136e-13, 8.052274177066756e-14,
      -7.332694492500769e-13, -1.4144863863864302e-12, -1.922281186743455e-12,
      -2.233116141355975e-12, -2.340994954364231e-12, -2.2563054090898553e-12,
      -2.0034914478610826e-12, -1.6178446604282985e-12, -1.1417469890562298e-12,
      -6.207085203700995e-13, -9.952836012368169e-14, 3.8113339684031173e-13,
      7.875433312181307e-13, 1.0948839094374762e-12, 1.2883630669653404e-12,
      1.3634391141834765e-12, 1.3252253783627571e-12, 1.1871970007652226e-12,
      9.693653924460125e-13, 6.961120379771506e-13, 3.9388214631137846e-13,
      8.893100488415414e-14, -1.9470608292582798e-13, -4.368826640256997e-13,
      -6.225521104359283e-13, -7.424686762458599e-13, -7.933711984311218e-13,
      -7.776830410590025e-13, -7.027964981408011e-13, -5.800359592953418e-13,
      -4.2341045968626475e-13, -2.4827241401101784e-13, -6.999583104983766e-14,
      9.722470947626773e-14, 2.4137183672427055e-13, 3.5334093601321315e-13,
      4.2738039053455576e-13, 4.612295391961372e-13, 4.559715939493651e-13,
      4.156393929545319e-13, 3.4662763357539095e-13, 2.569753524534212e-13,
      1.5558663215805778e-13, 5.14560342069288e-14, -4.7041270712004705e-14,
      -1.327453057621429e-13, -2.0015712421868682e-13, -2.457138005814963e-13,
      -2.6788695652333876e-13, -2.671134848404702e-13, -2.45579418960484e-13,
      -2.0688740825470226e-13, -1.5564451526383866e-13, -9.700986378358777e-14,
      -3.624113614915512e-14, 2.1724604885971853e-14, 7.262625760477233e-14,
      1.1314838659430352e-13, 1.4109219053828612e-13, 1.5544354547271623e-13,
      1.563423514300058e-13, 1.4496471610719946e-13, 1.2333523861263164e-13,
      9.409050865731636e-14, 6.0216785209482e-14, 2.4784705059471657e-14,
      -9.298013420050995e-15, -3.949825164760154e-14, -6.382034751737851e-14,
      -8.091194914190208e-14, -9.010989068341759e-14, -9.142806858943221e-14,
      -8.549363668500927e-14, -7.344128387608074e-14, -5.677772287915312e-14,
      -3.7229718100331757e-14, -1.6589029893063397e-14, 3.433346312024182e-15,
      2.1333139129514403e-14, 3.59109693883511e-14, 4.6337645662775975e-14,
      5.218453997804022e-14, 5.341990955520791e-14, 5.0374606124957134e-14,
      4.368268299778976e-14, 3.420385736015837e-14, 2.2935555861269425e-14,
      1.0922368051152286e-14, -8.2979045209038e-16, -1.1428546926031007e-14,
      -2.015414962188293e-14, -2.649961026549789e-14, -3.019053439574505e-14,
      -3.118497462815318e-14, -2.965516890708567e-14, -2.5954266107685677e-14,
      -2.0572024795211595e-14, -1.4083961701693787e-14, -7.09852264224856e-15,
      -2.065792198389671e-16, 6.0630253715076176e-15, 1.1278974822519513e-14,
      1.513208356113867e-14, 1.7448096367965696e-14, 1.8188779020406353e-14,
      1.7442299591642425e-14, 1.540464265250027e-14, 1.2354336573504236e-14,
      8.623084406386252e-15, 4.564968330552936e-15, 5.267615581845435e-16,
      -3.178439512018936e-15, -6.2925140359983905e-15, -8.627354853786845e-15,
      -1.0073053145059925e-14, -1.0599226173773629e-14, -1.0250019775441784e-14,
      -9.133761298113751e-15, -7.408565533453502e-15, -5.2653911383592584e-15,
      -2.9101051602604838e-15, -5.46046344625785e-16, 1.6415990891426928e-15,
      3.498558568251285e-15, 4.9106411703158515e-15, 5.808930351643294e-15,
      6.170964676030945e-15, 6.018186118951263e-15, 5.410200715684497e-15,
      4.43659446223491e-15, 3.2071692233460164e-15, 1.8415065175903558e-15,
      4.587353660547422e-16, -8.317166912500894e-16, -1.937759158605167e-15,
      -2.7902146906352215e-15, -3.346091641555615e-15, -3.589511225630058e-15,
      -3.530434249499485e-15, -3.201490560231282e-15, -2.6533342402236627e-15,
      -1.9490233690669634e-15, -1.1579530374541424e-15, -3.498561643353088e-16,
      4.10666286036706e-16, 1.0687081395482197e-15, 1.582442060527745e-15,
      1.9251700896311323e-15, 2.086004281958933e-15, 2.0692512658817335e-15,
      1.8926687860736384e-15, 1.584834699559609e-15, 1.181915837245432e-15,
      7.241443229658397e-16, 2.523032630969813e-16, -1.9550497939726551e-16,
      -5.865820611993401e-16, -8.956831975016558e-16, -1.1062955325692863e-15,
      -1.2111170804003583e-15, -1.2117729396918126e-15, -1.1178615723096138e-15,
      -9.454675872476882e-16, -7.153064398315394e-16, -4.506798398547905e-16,
      -1.7541886225611725e-16, 8.802368315739125e-17, 3.201966733184159e-16,
      5.05889602069445e-16, 6.349260126168038e-16, 7.024908219150067e-16,
      7.090091877952286e-16, 6.596279098223459e-16, 5.633766296978414e-16,
      4.321039118529848e-16, 2.792920340261519e-16, 1.1885415856016456e-16,
      -3.599067447398032e-17, -1.7368420195607974e-16, -2.8507651985834343e-16,
      -3.6391658298994675e-16, -4.0707118352927426e-16, -4.1448048310546213e-16,
      -3.888779714214588e-16, -3.353185147682633e-16, -2.605690800483434e-16,
      -1.7242237324099595e-16, -7.89940628010119e-17, 1.1940081644295817e-17,
      9.351913622305161e-17, 1.6024735925650735e-16, 2.0829633891753095e-16,
      2.356491153257985e-16, 2.420896759998027e-16, 2.290529680894683e-16,
      1.9936004630014854e-16, 1.568696530887457e-16, 1.0608114595431771e-16,
      5.172424668797886e-17, -1.6311710848279339e-18, -4.9916679594384146e-17,
      -8.983614209468838e-17, -1.1905123654007713e-16, -1.362750926730611e-16,
      -1.4127525185554631e-16, -1.3479411888807924e-16, -1.184007531063725e-16,
      -9.429191813761734e-17, -6.506260702817713e-17, -3.3466767259012036e-17,
      -2.187794618226766e-18, 2.636420978898645e-17, 5.021508667809578e-17,
      6.79401993458511e-17, 7.872463523163801e-17, 8.237027804186017e-17,
      7.925412064024055e-17, 7.02455868084569e-17, 5.659310727476242e-17,
      3.979164417101159e-17, 2.1443260601576663e-17, 3.1222538187952004e-18,
      -1.3745052457720612e-17, -2.797783953262322e-17, -3.8710143189724845e-17,
      -4.5429223232747365e-17, -4.7982830552949963e-17, -4.655768620770409e-17,
      -4.163351776922745e-17, -3.391850196477503e-17, -2.4272870920827553e-17,
      -1.3627736469080189e-17, -2.905906411707264e-18, 7.049316224570862e-18,
      1.55325375032531e-17, 2.2018510919686502e-17, 2.6186413160576926e-17,
      2.792592801133443e-17, 2.7326349167156752e-17, 2.4651124902654014e-17,
      2.0301178492225434e-17, 1.477090481308732e-17, 8.600953424274597e-18,
      2.3317782726095212e-18, -3.538494322638502e-18, -8.588993553188466e-18,
      -1.2501771209301573e-17, -1.5077064082714655e-17, -1.6237925226720754e-17,
      -1.6024847719056623e-17, -1.458172728766906e-17, -1.213506092068756e-17,
      -8.968630365274347e-18, -5.396063222531298e-18, -1.7336082188756956e-18,
      1.724771923528446e-18, 4.7282621998906e-18, 7.084759365175511e-18,
      8.670415223369272e-18, 9.432972625559873e-18, 9.389209027284501e-18,
      8.61723284165e-18, 7.244710219871243e-18, 5.4343174491150885e-18,
      3.3678105496269493e-18, 1.2300825858971698e-18, -8.05546795771448e-19,
      -2.5897764806518722e-18, -4.006742907960168e-18, -4.9799587387770494e-18,
      -5.474630421467329e-18, -5.496509355714871e-18, -5.0876873707169846e-18,
      -4.319947499255394e-18, -3.2864150928322455e-18, -2.0923178610153824e-18,
      -8.456580085194853e-19, 3.5146790463744287e-19, 1.4102844168795514e-18,
      2.2610267565738242e-18, 2.8566207176041433e-18, 3.174251998972589e-18,
      3.2148981292833873e-18, 3.0010482217636137e-18, 2.5729562709016996e-18,
      1.983856045545665e-18, 1.2946069648700888e-18, 5.682412387878341e-19,
      -1.3515331075201946e-19, -7.628467540744561e-19, -1.2728978597999063e-18,
      -1.6364256675395312e-18, -1.8386520548222388e-18, -1.878747839793722e-18,
      -1.7686052592118085e-18, -1.5307320140138194e-18, -1.1955125018367532e-18,
      -7.981084556370089e-19, -3.7527411275749963e-19, 3.765778215396734e-20,
      4.0939990356209134e-19, 7.147756951648705e-19, 9.361168114697249e-19,
      1.063945537156479e-18, 1.0969551997930352e-18, 1.0413551354158138e-18,
      9.09690159281977e-19, 7.192752919030757e-19, 4.904034581160421e-19,
      2.444869723127467e-19, 2.2838897139242713e-21, -2.176603107604198e-19,
      -4.0025412619310523e-19, -5.3471705320335135e-19, -6.150210033482692e-19,
      -6.399201850492845e-19, -6.126052448328752e-19, -5.40043449041548e-19,
      -4.320854497217614e-19, -3.0042992121355386e-19, -1.575399821421131e-19,
      -1.5600377789735282e-20, 1.144070234738818e-19, 2.2344827771926936e-19,
      3.049614747989873e-19, 3.551395011708802e-19, 3.7297176111421905e-19,
      3.600639318982826e-19, 3.2027037254413085e-19, 2.5918520994784325e-19,
      1.8354488441013033e-19, 1.0059695234171138e-19, 1.7487499215842808e-20,
      -5.928678541768914e-20, -1.243251281617033e-19, -1.7364235686899718e-19,
      -2.0484856793365352e-19, -2.1718773433049733e-19, -2.1144531067925062e-19,
      -1.8974417697941402e-19, -1.5525517940148906e-19, -1.1185275461474463e-19,
      -6.374758289959397e-20, -1.5127047506659975e-20, 3.0169182222859453e-20,
      6.891639638839369e-20, 9.869937235880084e-20, 1.1802574998622482e-19,
      1.2635692979112929e-19, 1.240617247983292e-19, 1.123035366103366e-19,
      9.287601300900824e-20, 6.800477671396117e-20, 4.0133831592007984e-20,
      1.171472398716002e-20, -1.4985352695565325e-20, -3.8043299030846755e-20,
      -5.599821668489904e-20, -6.792252724424164e-20, -7.344490904705838e-20,
      -7.272772661093841e-20, -6.640492861764877e-20, -5.548891988659112e-20,
      -4.125654457590647e-20, -2.5125007885762056e-20, -8.528345229192985e-21,
      7.195977645573108e-21, 2.0902427999415144e-20, 3.170896635559851e-20,
      3.904142771078272e-20, 4.264978019120025e-20, 4.2597598330734986e-20,
      3.922805327361684e-20, 3.3111247739364954e-20, 2.4978731277076695e-20,
      1.565149056195008e-20, 5.9676352420227264e-21, -3.2845526629058008e-21,
      -1.1423481180503282e-20, -1.7917522449631504e-20, -2.2412582260216384e-20,
      -2.4743269736392354e-20, -2.4928315272568328e-20, -2.3152053275662737e-20,
      -1.9734704795635524e-20, -1.5094815255699898e-20, -9.707503502083405e-21,
      -4.062166367639208e-21, 1.377012179556165e-21, 6.2049272101600374e-21,
      1.0101674152922722e-20, 1.284960551257989e-20, 1.43408324474967e-20,
      1.4575471318135912e-20, 1.3651629317990655e-20, 1.174867547794473e-20,
      9.105723766414473e-21, 5.997449931386907e-21, 2.7093751293455616e-21,
      -4.854066277112292e-22, -3.346375926218937e-21, -5.681328501338642e-21,
      -7.356889517195843e-21, -8.303465712525077e-21, -8.514764452958617e-21,
      -8.0424205054727e-21, -6.986602800849731e-21, -5.4837061675157255e-21,
      -3.692358001403013e-21, -1.7789873146226826e-21, 9.587782362852392e-23,
      1.789583264152041e-21, 3.1868186209408642e-21, 4.206077308270847e-21,
      4.802881771666342e-21, 4.96982203940321e-21, 4.733699792810748e-21,
      4.1502688265210395e-21, 3.297204755049578e-21, 2.266016297593681e-21,
      1.1536270311148095e-21, 5.431467973224642e-23, -9.473965239130642e-22,
      -1.782424368709242e-21, -2.4010858988549768e-21, -2.7751751080873225e-21,
      -2.898173169658901e-21, -2.783747802742398e-21, -2.46281729957079e-21,
      -1.9795411562975088e-21, -1.3866494356343077e-21, -7.405363834273376e-22,
      -9.65227880651844e-23, 4.953590593806167e-22, 9.937774845291234e-22,
      1.3685188968133863e-21, 1.6018142072474009e-21, 1.6885718208912636e-21,
      1.6356003246783198e-21, 1.4599750851140305e-21, 1.1867554510433995e-21,
      8.462907555003842e-22, 4.713633146989871e-22, 9.440634249791763e-23,
      -2.5499318408165734e-22, -5.521383532059424e-22, -7.786954347581057e-22,
      -9.235342654433988e-22, -9.829289750644203e-22, -9.6016265544577e-22,
      -8.646220210300126e-22, -7.104999145057907e-22, -5.152431774919125e-22,
      -2.9789052588014105e-22, -7.74402490025958e-23, 1.2862772662676122e-22,
      3.055744442782608e-22, 4.4229749624006465e-22, 5.318600237913682e-22,
      5.716458399350451e-22, 5.631632117515861e-22, 5.115451526081233e-22,
      4.24813311018136e-22, 3.129847653732836e-22, 1.8710593859826965e-22,
      5.82957293651302e-23, -6.312836749680304e-23, -1.683806851935601e-22,
      -2.507506770984333e-22, -3.0593404071681464e-22, -3.3214550369875093e-22,
      -3.3002470189593866e-22, -3.023616574199271e-22, -2.53679978477033e-22,
      -1.897234675764843e-22, -1.1689512563696572e-22, -4.169671410762718e-23,
      2.978746790122918e-23, 9.232642708165764e-23, 1.4187139456586597e-22,
      1.7576207250390174e-22, 1.9280548734989363e-22, 1.9323310142107427e-22,
      1.7855080541627126e-22, 1.5130341421686467e-22, 1.1477995317287302e-22,
      7.268820466993256e-23, 2.882674481045678e-23, -1.321971934241946e-23,
      -5.0340109732525454e-23, -8.00957354125057e-23, -1.0084819862554976e-22,
      -1.118130369694157e-22, -1.1304179767484505e-22, -1.0534057187474675e-22,
      -9.013722856189556e-23, -6.931245500609275e-23, -4.5011133696665985e-23,
      -1.945058813722363e-23, 5.259057489083168e-24, 2.7269516784318595e-23,
      4.5114233540597966e-23, 5.778739642280511e-23, 6.477970035031114e-23,
      6.607207240125879e-23, 6.209174560450134e-23, 5.363759441934273e-23,
      4.1783402517018286e-23, 2.776865132210967e-23, 1.2886502783653473e-23,
      -1.6220274542479687e-24, -1.4660026482815465e-23, -2.5346883369578576e-23,
      -3.306693062310233e-23, -3.7492916646900524e-23, -3.8584810145504255e-23,
      -3.6566314904994196e-23, -3.188299141342151e-23, -2.5146955316174026e-23,
      -1.707370917111336e-23, -8.416762759130635e-24, 9.465420988891707e-26
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_9_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<9>(20.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 0.7826460663079003), "design.b()[0] == 0.7826460663079003");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.7826460663079003));
    static_assert(almost_equal(design.b()[1], -6.93272943280914), "design.b()[1] == -6.93272943280914");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -6.93272943280914));
    static_assert(almost_equal(design.b()[2], 27.402924784581046), "design.b()[2] == 27.402924784581046");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 27.402924784581046));
    static_assert(almost_equal(design.b()[3], -63.43570132229376), "design.b()[3] == -63.43570132229376");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -63.43570132229376));
    static_assert(almost_equal(design.b()[4], 94.7777719177695), "design.b()[4] == 94.7777719177695");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 94.7777719177695));
    static_assert(almost_equal(design.b()[5], -94.7777719177695), "design.b()[5] == -94.7777719177695");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -94.7777719177695));
    static_assert(almost_equal(design.b()[6], 63.43570132229376), "design.b()[6] == 63.43570132229376");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 63.43570132229376));
    static_assert(almost_equal(design.b()[7], -27.402924784581046), "design.b()[7] == -27.402924784581046");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - -27.402924784581046));
    static_assert(almost_equal(design.b()[8], 6.93272943280914), "design.b()[8] == 6.93272943280914");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 6.93272943280914));
    static_assert(almost_equal(design.b()[9], -0.7826460663079002), "design.b()[9] == -0.7826460663079002");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - -0.7826460663079002));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -8.373313839536639), "design.a()[1] == -8.373313839536639");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -8.373313839536639));
    static_assert(almost_equal(design.a()[2], 31.30548364531556), "design.a()[2] == 31.30548364531556");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 31.30548364531556));
    static_assert(almost_equal(design.a()[3], -68.5842729271881), "design.a()[3] == -68.5842729271881");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -68.5842729271881));
    static_assert(almost_equal(design.a()[4], 97.02173448290063), "design.a()[4] == 97.02173448290063");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 97.02173448290063));
    static_assert(almost_equal(design.a()[5], -91.89983397830696), "design.a()[5] == -91.89983397830696");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -91.89983397830696));
    static_assert(almost_equal(design.a()[6], 58.28175528159325), "design.a()[6] == 58.28175528159325");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 58.28175528159325));
    static_assert(almost_equal(design.a()[7], -23.861817852045135), "design.a()[7] == -23.861817852045135");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -23.861817852045135));
    static_assert(almost_equal(design.a()[8], 5.722800175529066), "design.a()[8] == 5.722800175529066");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 5.722800175529066));
    static_assert(almost_equal(design.a()[9], -0.6125348651072299), "design.a()[9] == -0.6125348651072299");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.6125348651072299));
    std::cout << "max_deviation(cheby2,highpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.7826460663079003, -0.3793882943342881, -0.27492609979897953, -0.1835983780329733,
      -0.10660956441805536, -0.0444639852481169, 0.0029924123991535434, 0.03650248499580287,
      0.057305819642643835, 0.06703035081341868, 0.06757431846411699, 0.06098530322363205,
      0.049342791904763095, 0.034650111645894655, 0.01874067469047025,
      0.0032023626338942845, -0.01067737740837505, -0.02194447359414335,
      -0.02998926418535891, -0.034536905075694235, -0.03561949886179894,
      -0.0335331603684349, -0.02878385732437727, -0.0220262243766311, -0.013999638471021286,
      -0.005465674647317051, 0.002849340915956018, 0.010303561120734776,
      0.01637825672369561, 0.020704327194361827, 0.023076022232666582, 0.023452068620188005,
      0.02194518272464485, 0.018801619859597607, 0.014372933069532051, 0.009082462235272148,
      0.003389238258130284, -0.0022480327285244912, -0.007404431332550518,
      -0.011717599293066629, -0.014910150672920147, -0.016804583937450948,
      -0.017330140417452677, -0.016521637425397667, -0.014510850148159088,
      -0.011511491545752733, -0.007799216419351815, -0.0036883350133805615,
      0.0004929478255660362, 0.004426951583435486, 0.007828903848501531,
      0.010465827426773808, 0.012170788540521518, 0.01285174453962093, 0.012494642892516714,
      0.011160839600018707, 0.008979296203625337, 0.006134354905290254,
      0.002850160245180894, -0.0006270216537650926, -0.004047247499796031,
      -0.007174774791003875, -0.00980414331380753, -0.011773410768688361,
      -0.012973738233093321, -0.013354811172622022, -0.012925894726736498,
      -0.011752635518885002, -0.00995001467884099, -0.007672108861657437,
      -0.005099512098630049, -0.002425400092526335, 0.00015872609525797304,
      0.002476599010154598, 0.004379117538126143, 0.00575387477856798,
      0.0065317011118239815, 0.006689874032992392, 0.006251893405310391,
      0.005283965741022897, 0.0038885670534678507, 0.0021956457771229454,
      0.0003521731414335358, -0.0014891602644685627, -0.0031812705994801113,
      -0.0045932251604998905, -0.005619282665673658, -0.006185836728898088,
      -0.006255836595224558, -0.005830450260297167, -0.004947936380568743,
      -0.0036798886004143563, -0.0021251955298163226, -0.000402209706909535,
      0.0013602700062003664, 0.0030325325091157904, 0.0044933179373010425,
      0.005638354754693466, 0.006387490728909817, 0.0066899522089942445,
      0.0065274093873489356, 0.005914686845587359, 0.004898126965042868,
      0.0035517769190291995, 0.0019717168467061896, 0.00026896776741183043,
      -0.001438494781919754, -0.003034046607222028, -0.004410457565094211,
      -0.005477120947432655, -0.006165988881493549, -0.006435833856089375,
      -0.006274580773463975, -0.00569959259035821, -0.004755935777011132,
      -0.003512789577213772, -0.0020582861224490885, -0.0004931688176880757,
      0.0010762721811146646, 0.0025454902526027764, 0.0038186977182571476,
      0.004815136403393462, 0.005474195247265168, 0.005759054909484022,
      0.005658646898995652, 0.005187834053586873, 0.0043858418284572695,
      0.0033130874143497274, 0.002046658367244627, 0.0006747774414919624,
      -0.00070934956620028, -0.002013874353425941, -0.0031544043496957407,
      -0.004059455003004624, -0.00467490601027503, -0.004967187151156953,
      -0.004925011680073449, -0.004559577406781631, -0.0039032605107287566,
      -0.003006927653985761, -0.0019360814324253482, -0.0007661269069052339,
      0.0004229015607488144, 0.0015517865778148475, 0.0025473784616346726,
      0.0033473045535902003, 0.0039038365421978846, 0.0041866795157106396,
      0.004184524877974931, 0.003905296163649853, 0.0033751061226986803,
      0.0026360291526487598, 0.0017428695915280325, 0.0007591686715991957,
      -0.00024726271712909465, -0.001208974378578477, -0.0020633567460469227,
      -0.0027566754618721517, -0.003247403480853832, -0.00350864756344103,
      -0.003529532119276965, -0.003315476805622896, -0.002887379958630632,
      -0.0022797927108094834, -0.0015382337339605485, -0.0007158478000015636,
      0.00013035046311938702, 0.000943385263136529, 0.0016701155746594665,
      0.002264668064726482, 0.002691288045108875, 0.0029264345259096443,
      0.002960000851791527, 0.0027956041750792603, 0.002449950846646433,
      0.0019513463574118428, 0.0013374736861745014, 0.0006526092872221247,
      -5.552127414025845e-05, -0.0007390276944001633, -0.0013530558903102298,
      -0.0018586940711199096, -0.0022253982064866056, -0.0024327886130123266,
      -0.0024717156724766813, -0.0023445444842956943, -0.0020646619209854743,
      -0.0016552614534949654, -0.001147507820567984, -0.0005782221553851871,
      1.2743791884635078e-05, 0.0005852597598787624, 0.001101607705749164,
      0.0015289329760705215, 0.0018412989078300853, 0.0020212189179697176,
      0.0020605787431204683, 0.0019609048269102793, 0.0017329798830478145,
      0.0013958503245626933, 0.0009753096591171746, 0.0005019745909506986,
      9.094451271117986e-06, -0.0004697516457699627, -0.0009029124858611209,
      -0.0012627274322399773, -0.0015272616612032695, -0.0016816072904893373,
      -0.0017186759052885657, -0.001639444214017037, -0.0014526523069522956,
      -0.0011739906733016503, -0.0008248453293617716, -0.0004306979988607483,
      -1.9298580218445396e-05, 0.00038126101429371664, 0.0007444397052959596,
      0.0010469809036618653, 0.0012703754293019506, 0.0014019635281988588,
      0.0014356126327756732, 0.0013719377873955396, 0.0012180632762472405,
      0.0009869547872129823, 0.000696379382011808, 0.0003675738301515512,
      2.371907564142125e-05, -0.00031167123678126107, -0.0006163376216194111,
      -0.0008707313052411167, -0.0010592465838727746, -0.0011711528586777903,
      -0.0012011725682716853, -0.001149676545871968, -0.001022494810782525,
      -0.0008303666522512659, -0.0005880773629832739, -0.0003133486219394155,
      -2.5564105952580532e-05, 0.00025557940404553653, 0.0005114027756997275,
      0.0007254683923420616, 0.0008846181312797807, 0.0009797612080949883,
      0.0010063662817849425, 0.0009646333749550682, 0.0008593433499622452,
      0.0006994043780448878, 0.0004971346030017681, 0.00026733676404017397,
      2.6232885588490292e-05, -0.00020966544078061138, -0.0004246735207820943,
      -0.0006049622418991857, -0.0007394324957714533, -0.0008203811279725503,
      -0.0008439197583798557, -0.0008101255129415105, -0.0007229212999844822,
      -0.0005897014781893334, -0.0004207353880373993, -0.0002283951845475779,
      -2.6264856320948196e-05, 0.0001718063549568128, 0.00035264101504983497,
      0.0005045984367794474, 0.0006183115435241821, 0.0006872499094907796,
      0.0007080762123316047, 0.0006807781399727998, 0.0006085733774558828,
      0.0004976005932473332, 0.0003564233301815104, 0.0001953854834166541,
      2.5865890080654496e-05, -0.00014051504591479938, -0.00029268207800512173,
      -0.0004208325948165852, -0.0005170577475863639, -0.0005758186161126128,
      -0.0005942496409377879, -0.0005722739390995601, -0.000512528185385829,
      -0.0004201075846589847, -0.0003021532281734297, -0.00016731405945761679,
      -2.5123159768911585e-05, 0.00011466733221945715, 0.00024274685291878026,
      0.00035085840281979174, 0.00043232223264984704, 0.00048243863378076004,
      0.0004987462895013712, 0.0004811230121622564, 0.0004317266448810569,
      0.0003547846937531885, 0.0002562511584501062, 0.0001433574069118239,
      2.4090275404035997e-05, -9.33654977043874e-05, -0.00020118207157599106,
      -0.0002924033950562131, -0.0003613867968851408, -0.000404143758407533,
      -0.0004185599087769341, -0.0004044829597249313, -0.00036367648116309966,
      -0.00029964647947899577, -0.00021735607310854497, -0.0001228506267737929,
      -2.2821069040935638e-05, 7.586353316646406e-05, 0.00016662190144220304,
      0.00024359376100596014, 0.0003020122236869847, 0.0003384921086084843,
      0.0003512172781771402, 0.00034001732840025466, 0.000306331673039732,
      0.0002530666714578339, 0.00018435846228794222, 0.00010526012609097233,
      2.1376340318539984e-05, -6.15284544627783e-05, -0.0001379213300940692,
      -0.00020286535701066798, -0.00025233362205128395, -0.00028345316584943957,
      -0.00029466449329711326, -0.00028578838690984914, -0.000257998209123771,
      -0.0002137022715956215, -0.00015634675052183557, -9.015465514061391e-05,
      -1.9820199767417598e-05, 4.981963575058997e-05, 0.00011411366914905604,
      0.00016890315919564655, 0.0002107865911093016, 0.00023732604731876278,
      0.00024718300192332326, 0.00024017646148774031, 0.00021726178745396776,
      0.00018043390395365588, 0.00013256356031277452, 7.717955857260215e-05,
      1.821310928187608e-05, -4.027744611351074e-05, -9.438251602780562e-05,
      -0.0001405992197778932, -0.0001760546413226026, -0.00019868039951248962,
      -0.00020732822662688187, -0.00020182050079603562, -0.00018293421537739717,
      -0.00015232137694248414, -0.00011237300163699569, -6.603745655548192e-05,
      -1.6606645802199217e-05, 3.251469085701307e-05, 7.804060566664502e-05,
      0.00011702093320861738, 0.00014702950967042925, 0.000166311824184092,
      0.00017388336623554504, 0.00016957349187564493, 0.00015401343500835436,
      0.00012857087620563685, 9.523699683245258e-05, 5.647496275568923e-05,
      1.5041111581098887e-05, -2.6208376281050593e-05, -6.451193671457096e-05,
      -9.73851347929334e-05, -0.00012277933296329837, -0.00013920655807942838,
      -0.00014582316484748462, -0.00014246787024856295, -0.00012965292162634237,
      -0.00010851034044483533, -8.069814122126052e-05, -4.827396882658118e-05,
      -1.3545568511783717e-05, 2.109121407407664e-05, 5.3315677193480694e-05,
      8.103576577441797e-05, 0.00010252181652777785, 0.00011651214308056978,
      0.0001222841896526669, 0.00011968747199501387, 0.0001091371964281663,
      9.157011739184258e-05, 6.836668194248245e-05, 4.124565445249597e-05,
      1.2139082385133153e-05, -1.6943443676219113e-05, -4.405182227827084e-05,
      -6.742453656674764e-05, -8.560138207574868e-05, -9.751273664535649e-05,
      -0.0001025400599687906, -0.00010054439312264516, -9.186186794291876e-05,
      -7.726747754198881e-05, -5.7910452210693905e-05, -3.522639329991506e-05,
      -1.0832728322343957e-05, 1.3585019713191555e-05, 3.638825534470559e-05,
      5.6093873314539886e-05, 7.14692646981119e-05, 8.160778406795122e-05,
      8.598017818318255e-05, 8.445921873458562e-05, 7.731665851401243e-05,
      6.519351223704744e-05, 4.904642375262074e-05, 3.007440592580474e-05,
      9.631432610686657e-06, -1.0868846649952205e-05, -3.004965075187831e-05,
      -4.666235769915192e-05, -5.9666569470470286e-05, -6.829390374112347e-05,
      -7.20917020537664e-05, -7.094430093998558e-05, -6.507108531587967e-05,
      -5.5002123368013247e-05, -4.153366293060864e-05, -2.5667054556035305e-05,
      -8.535675521590975e-06, 8.674897835815452e-06, 2.4807920289897018e-05,
      3.881224037820613e-05, 4.9809769303684284e-05, 5.7149398009541765e-05,
      6.0444136016082884e-05, 5.9589463984700136e-05, 5.476220995987227e-05,
      4.6400585557429845e-05, 3.516726380913221e-05, 2.189846372629723e-05,
      7.542859906904556e-06, -6.9052919281673925e-06, -2.0474161046283474e-05,
      -3.227888511037755e-05, -4.157842111409608e-05, -4.782111188711397e-05,
      -5.067623659966216e-05, -5.0049832534613604e-05, -4.608417978189711e-05,
      -3.914145389919278e-05, -2.9773099030881885e-05, -1.8677387121632803e-05,
      -6.6483503169651825e-06, 5.480239463420686e-06, 1.6891943368071422e-05,
      2.6841922189941594e-05, 3.4704837357383476e-05, 4.0013356517633704e-05,
      4.248495137518341e-05, 4.20355273786735e-05, 3.8779350209528765e-05,
      3.30156686269354e-05, 2.520331410898433e-05, 1.592532735712198e-05,
      5.846271678857848e-06, -4.334692784106655e-06, -1.3931704181667478e-05,
      -2.231782277449808e-05, -2.896538846642116e-05, -3.3478556574490875e-05,
      -3.561605462728526e-05, -3.5302915306265916e-05, -3.263071596136633e-05,
      -2.7846639618973174e-05, -2.1332413171692624e-05, -1.3574827063680104e-05,
      -5.130056407588954e-06, 3.4156446677579855e-06, 1.1486134422676472e-05,
      1.8553739168359872e-05, 2.4173253200638977e-05, 2.8009427767742488e-05,
      2.9856292647189556e-05, 2.964724946630091e-05, 2.7455525470951542e-05,
      2.3485234900391764e-05, 1.805391803822977e-05, 1.1567974620339735e-05,
      4.4928441209026495e-06, -2.67991553769071e-06, -9.466353214946871e-06,
      -1.5422368325397975e-05, -2.0172352945937392e-05, -2.3432414700580125e-05,
      -2.502677872161322e-05, -2.4896464890501637e-05, -2.3099880753378246e-05,
      -1.9805523147856e-05, -1.5277505356398773e-05, -9.85508721338836e-06,
      -3.927753960125511e-06, 2.0923562888560974e-06, 7.798750584724859e-06,
      1.2817685599876536e-05, 1.6832294740477417e-05, 1.9602205240668583e-05,
      2.0977459226549324e-05, 2.0905968974605188e-05, 1.9434192474724314e-05,
      1.67011792203574e-05, 1.2926576547512956e-05, 8.393574962985953e-06,
      3.4280822115480026e-06, -1.6243683385197735e-06, -6.4223607901827744e-06,
      -1.0651379875908978e-05, -1.4044133558758647e-05, -1.6397122720778295e-05,
      -1.7582454540298204e-05, -1.7554244102254606e-05, -1.6349330675408688e-05,
      -1.40824243330534e-05, -1.0936168867846849e-05, -7.146933965542412e-06,
      -2.987412666701961e-06, 1.2527165444301925e-06, 5.286710128321848e-06,
      8.84990934850288e-06, 1.1716857241983434e-05, 1.3715293060102959e-05,
      1.4736175372343169e-05, 1.4739175861260283e-05, 1.3753405724975645e-05,
      1.1873463250278808e-05, 9.251202418695544e-06, 6.083897920273958e-06,
      2.599704224911973e-06, -9.58537978023908e-07, -4.350014137460363e-06,
      -7.3520310128439924e-06, -9.774432791436591e-06, -1.1471419489308022e-05,
      -1.2350049681229009e-05, -1.2374952690837434e-05, -1.1569043311892752e-05,
      -1.0010306235406791e-05, -7.824979061890071e-06, -5.177694885168525e-06,
      -2.2593332270897745e-06, 7.265397398001488e-07, 3.577691484681346e-06,
      6.10675020167616e-06, 8.153345508308197e-06, 9.594088301791e-06, 1.03497825646507e-05,
      1.0389465074482287e-05, 9.731093388140176e-06, 8.43893247286447e-06,
      6.617910356618371e-06, 4.405408698012339e-06, 1.961112821575992e-06,
      -5.443420527798079e-07, -2.9411321235810547e-06, -5.071613195331903e-06,
      -6.800544497957785e-06, -8.023515292969421e-06, -8.673060776209874e-06,
      -8.722123573238192e-06, -8.184705075366691e-06, -7.113743851406033e-06,
      -5.596443301970468e-06, -3.7474354267465285e-06, -1.7003015848614752e-06,
      4.0193366088445914e-07, 2.416668382917307e-06, 4.211276665552031e-06,
      5.671717689770251e-06, 6.7096502334826035e-06, 7.267618396492491e-06,
      7.3220162427126755e-06, 6.883696457218009e-06, 5.996250036938143e-06,
      4.732139479687567e-06, 3.187006666166339e-06, 1.472589819102832e-06,
      -2.91235284252323e-07, -1.9847307619867353e-06, -3.496324514441325e-06,
      -4.729859177407305e-06, -5.6105983228743e-06, -6.089622807649029e-06,
      -6.1463687284972306e-06, -5.789190258423235e-06, -5.053966488464036e-06,
      -4.0009020541522425e-06, -2.7097881710488978e-06, -1.2740862993199936e-06,
      2.0573479725491998e-07, 1.6291401561531634e-06, 2.9022742743030445e-06,
      3.94406445819841e-06, 4.691290958241109e-06, 5.1023135435663e-06,
      5.159243234951348e-06, 4.868458294568671e-06, 4.259477542111202e-06,
      3.3823138788158515e-06, 2.303529307855187e-06, 1.1012934688912391e-06,
      -1.401941498549525e-07, -1.3365258468375803e-06, -2.4087536599345868e-06,
      -3.2885278636436204e-06, -3.922376574198843e-06, -4.274864126406362e-06,
      -4.330448651156578e-06, -4.093951709681396e-06, -3.5896484515541467e-06,
      -2.8590790530394146e-06, -1.957765065670218e-06, -9.510824739999244e-07,
      9.0407422899289e-08, 1.0958404945332245e-06, 1.9988119717930487e-06,
      2.7417023719629043e-06, 3.2792895420782884e-06, 3.5814250876342737e-06,
      3.634622598812545e-06, 3.4424824757405005e-06, 3.0249583592271616e-06,
      2.4165477328166884e-06, 1.6635590494644574e-06, 8.206652942353389e-07,
      -5.3004285595227354e-08, -8.979588217984697e-07, -1.658346807648607e-06,
      -2.2855977381246805e-06, -2.741470479653269e-06, -3.0003209735553703e-06,
      -3.0504596399724485e-06, -2.894533643858608e-06, -2.5489364627774574e-06,
      -2.042312373289902e-06, -1.41328223717964e-06, -7.075655634615655e-07,
      2.5290719748724925e-08, 7.353460280415043e-07, 1.3756274053259893e-06,
      1.9051949469286557e-06, 2.2917142567580026e-06, 2.513377577753383e-06,
      2.5600634853796146e-06, 2.43367928102216e-06, 2.147686654270327e-06,
      1.7258659519316258e-06, 1.2004238712752004e-06, 6.095904187427461e-07,
      -5.118965116598572e-09, -6.017828190445709e-07, -1.1408973896036788e-06,
      -1.587956866459379e-06, -1.915624057670614e-06, -2.105357693310414e-06,
      -2.1484028478455264e-06, -2.046096385705451e-06, -1.8094866668454498e-06,
      -1.4583127696176362e-06, -1.0194301476928722e-06, -5.248042672532332e-07,
      -9.219249746577064e-09, 4.921365714314006e-07, 9.460426780839036e-07,
      1.3234180872328714e-06, 1.60115285627359e-06, 1.763486315695413e-06,
      1.8028526325011024e-06, 1.720152324647801e-06, 1.5244480449132019e-06,
      1.2321216202608672e-06, 8.655644059360681e-07, 4.515022430204021e-07,
      1.9077901617241953e-08, -4.021733793288017e-07, -7.843163789103505e-07,
      -1.1028436752069776e-06, -1.338220858316024e-06, -1.477053661898453e-06,
      -1.512809611440333e-06, -1.446058610869221e-06, -1.284230182714091e-06,
      -1.0409175650346595e-06, -7.347883948133077e-07, -3.8818637709007854e-07,
      -2.5526636891655984e-08, 3.2840166693833496e-07, 6.501089369571279e-07,
      9.189433639605308e-07, 1.118394501506012e-06, 1.2370815034919643e-06,
      1.2693688160720304e-06, 1.2155787525268933e-06, 1.0817983006554186e-06,
      8.793048069183981e-07, 6.236600371159633e-07, 3.3354293276773177e-07,
      2.9406885287649397e-08, -2.679433503107909e-07, -5.387573292469837e-07,
      -7.656333890418678e-07, -9.346182906950121e-07, -1.0360438771584847e-06,
      -1.0650522004357167e-06, -1.0217828638306542e-06, -9.112197400697395e-07,
      -7.427171563988438e-07, -5.292465601124676e-07, -2.864222466857451e-07,
      -3.13778658418473e-08, 2.1842663472358102e-07, 4.463855960982079e-07,
      6.378369322858073e-07, 7.80989673275898e-07, 8.676322064442257e-07,
      8.935800237507332e-07, 8.58840442053691e-07, 7.674913978141663e-07,
      6.272906804524359e-07, 4.4904957918458777e-07, 2.458197426057015e-07,
      3.1953174425786566e-08, -1.7789792702676642e-07, -3.697726637382293e-07,
      -5.313180087600748e-07, -6.525711280620432e-07, -7.265588424203007e-07,
      -7.496792841594519e-07, -7.218464199851158e-07, -6.463945743942035e-07,
      -5.29756269513197e-07, -3.809415193838698e-07, -2.1085922458108352e-07,
      -3.1530734243921065e-08, 1.4474856594328035e-07, 3.062419035247621e-07,
      4.4254231969727317e-07, 5.452324588752342e-07, 6.083918979525856e-07,
      6.289223747773807e-07, 6.066743440095102e-07, 5.443720924567797e-07,
      4.473482380568679e-07, 3.23110911255149e-07, 1.8077747002350034e-07,
      3.041657767715652e-08, -1.1765458503054979e-07, -2.535695394288723e-07,
      -3.685613601075992e-07, -4.5551908416227405e-07, -5.094170174174889e-07,
      -5.275918005975544e-07, -5.098530343610517e-07, -4.5842483572380163e-07,
      -3.777271149582455e-07, -2.7401586029069343e-07, -1.5491061985946112e-07,
      -2.8844125266337566e-08, 9.552678262031032e-08, 2.0990829689177155e-07,
      3.069155276720949e-07, 3.8054169611807475e-07, 4.2652137489543187e-07,
      4.4256646064846735e-07, 4.2846271475570105e-07, 3.860244118442567e-07,
      3.189142243366138e-07, 2.3234430581460003e-07, 1.326820453215676e-07,
      2.6989683330130953e-08, -7.746942404819034e-08, -1.7372381301804266e-07,
      -2.555531428593702e-07, -3.1788381760178304e-07, -3.570962926252823e-07,
      -3.71225995729798e-07, -3.6004744880231057e-07, -3.250393108540192e-07,
      -2.692361164730582e-07, -1.9697991778104683e-07, -1.1359137196088158e-07,
      -2.4984657142923477e-08, 6.274633480969229e-08, 1.4374194382041917e-07,
      2.1276305452334896e-07, 2.6552465898511194e-07, 2.98955813358265e-07,
      3.11370670596275e-07, 3.025416773780871e-07, 2.736728427254405e-07,
      2.2727774911404028e-07, 1.6697323211916667e-07, 9.720499683556138e-08,
      2.29255364161995e-08, -5.0752668887791e-08, -1.1890469737480512e-07,
      -1.7711814188112477e-07, -2.217743290206605e-07, -2.50268197375331e-07,
      -2.611538519732804e-07, -2.542081717978196e-07, -2.3041056349563396e-07,
      -1.918426341668463e-07, -1.4151681919147472e-07, -8.314750643506858e-08,
      -2.088166548485761e-08, 4.099178289166338e-08, 9.833374972342278e-08,
      1.4742830764479615e-07, 1.8521976434236972e-07, 2.0949862116286733e-07,
      2.1902541500979987e-07, 2.1358592519062184e-07, 1.939760185368768e-07,
      1.6191917561542733e-07, 1.1992416888624434e-07, 7.109416304767011e-08,
      1.890144178950033e-08, -3.3056138138187866e-08, -8.130010259257659e-08,
      -1.2270125354330123e-07, -1.5467951321762043e-07, -1.7536117895446366e-07,
      -1.8368426678940117e-07, -1.794463723823312e-07, -1.6329349420278974e-07,
      -1.3665226884405983e-07, -1.0161179362628993e-07, -6.076441543691621e-08,
      -1.7017347155935206e-08, 2.661141171779497e-08, 6.719870886383434e-08,
      1.0210958895461777e-07, 1.2916574358686508e-07, 1.4677847898853518e-07,
      1.5403830400656277e-07, 1.507563781636142e-07, 1.374564258175765e-07,
      1.1531908526859253e-07, 8.608379556116323e-08, 5.191602509712671e-08,
      1.5249746260940794e-08, -2.138356449382829e-08, -5.552754261475068e-08,
      -8.496354208832767e-08, -1.0785261355222006e-07, -1.2284792423023637e-07,
      -1.2917092991431666e-07, -1.2664723333190404e-07, -1.1570088450225712e-07,
      -9.730870217721869e-08, -7.291883172049055e-08, -4.4340032359715195e-08,
      -1.3609963199642382e-08, 1.7148092018586092e-08, 4.587011776231319e-08,
      7.068811135318175e-08, 9.00497414127546e-08, 1.0281338561945907e-07,
      1.083128817867402e-07, 1.0638852102951647e-07, 9.738317618520828e-08,
      8.210482921070683e-08, 6.17589787966953e-08, 3.785632958446064e-08,
      1.2102666900770086e-08, -1.3721182917958026e-08, -3.7880968998509474e-08,
      -5.880400592087907e-08, -7.518001467600965e-08, -8.604145777155759e-08,
      -9.08185702325139e-08, -8.936612378753828e-08, -8.196094295123537e-08,
      -6.927118189546977e-08, -5.230023619798148e-08, -3.2309782248550337e-08,
      -1.0727707800754969e-08, 1.0952455335308938e-08, 3.127360581965506e-08,
      4.891176410004621e-08, 6.276104961863894e-08, 7.200158108745258e-08,
      7.614623694675192e-08, 7.506374815271954e-08, 6.89772558329097e-08,
      5.8439137112953675e-08, 4.428447118441076e-08, 2.7566882158070794e-08,
      9.481569785394575e-09, -8.718939996019614e-09, -2.58104636995447e-08,
      -4.067846070146392e-08, -5.238963769820451e-08, -6.02493332969502e-08,
      -6.384124295533704e-08, -6.304732812945789e-08, -5.8047144798136207e-08,
      -4.929722907773328e-08, -3.749249702106238e-08, -2.351276579909173e-08,
      -8.358412022188968e-09, 6.920204020204354e-09, 2.1294634546366852e-08,
      3.382670016947284e-08, 4.372882221491544e-08, 5.0412515515403194e-08,
      5.3522129801194184e-08, 5.295200116276142e-08, 4.884634083859028e-08,
      4.158236591168034e-08, 3.17382860780945e-08, 2.0048730001497048e-08,
      7.350962904556482e-09, -5.474231759778274e-09, -1.7562887316248986e-08,
      -2.8125323324646026e-08, -3.649697703245503e-08, -4.2179378274882194e-08,
      -4.486880312529836e-08, -4.447103906960121e-08, -4.1101671230936853e-08,
      -3.507228740420777e-08, -2.6863932752866375e-08, -1.7089961970900683e-08,
      -6.451086065340787e-09, 4.31414606222866e-09, 1.4479978138393352e-08,
      2.3381760890535388e-08, 3.045877610480233e-08, 3.528885589621742e-08,
      3.7612711254344054e-08, 3.7346634286049875e-08, 3.458305691536839e-08,
      2.9579278268499497e-08, 2.2735457609501445e-08, 1.4563658157773493e-08,
      5.650276000174432e-09, -3.3854351900144808e-09, -1.1933849088972898e-08,
      -1.9435582404207546e-08, -2.541757068628605e-08, -2.9522315090132004e-08,
      -3.1528534912130706e-08, -3.136208805123685e-08, -2.9096707124443574e-08,
      -2.494479514366784e-08, -1.9239184428622716e-08, -1.240734258074851e-08,
      -4.939973253814069e-09, 2.6437206436953864e-09, 9.8316851020801e-09,
      1.6153157044037547e-08, 2.1209053408630262e-08, 2.4696676902049446e-08,
      2.6427244852489124e-08, 2.633527203413483e-08, 2.4479412658993515e-08,
      2.1034951012327887e-08, 1.627868494893583e-08, 1.0567435312663532e-08,
      4.311806396930826e-09, -2.052905681565026e-09, -8.096623134958866e-09,
      -1.3423185277179432e-08, -1.7695945726899893e-08, -2.0658640331780017e-08,
      -2.215026221315626e-08, -2.2113118713428388e-08, -2.0593726141616647e-08,
      -1.773668855295849e-08, -1.3772173208874637e-08, -8.998007247089276e-09,
      -3.757751389788783e-09, 1.5836626719251123e-09, 6.665026845037265e-09,
      1.1152978764320253e-08, 1.4763561408088518e-08, 1.727984780378983e-08,
      1.856456189749531e-08, 1.8566993094546702e-08, 1.7323904981703403e-08,
      1.4954550228063488e-08, 1.1650295786500915e-08, 7.65970953376715e-09,
      3.270239417352425e-09, -1.2121878247111984e-09, -5.484219968951586e-09,
      -9.265353631895407e-09, -1.23160920736962e-08, -1.4452829429285462e-08,
      -1.5558557223567036e-08, -1.5588795299988543e-08, -1.4572486849087633e-08,
      -1.260794252151422e-08, -9.854248263534836e-09, -6.518843859932577e-09,
      -2.8422156736228026e-09, 9.19186523061327e-10, 4.510611567191592e-09,
      7.696046359858698e-09, 1.0273507700891099e-08, 1.2087611074922513e-08,
      1.303865170855466e-08, 1.3087689191551751e-08, 1.225740968017585e-08,
      1.0628829442704282e-08, 8.334180628290915e-09, 5.54656641517405e-09,
      2.4671724913032235e-09, -6.890369239184905e-10, -3.7081353832884603e-09,
      -6.39155422909433e-09, -8.568960048108787e-09
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.7826460663079003, -0.3793882943342893, -0.27492609979899524, -0.18359837803307108,
      -0.10660956441846117, -0.044463985249411545, 0.0029924123957262364,
      0.03650248498791138, 0.05730581962633981, 0.06703035078253113, 0.0675743184096115,
      0.06098530313298666, 0.049342791761418855, 0.03465011142884119, 0.01874067437402479,
      0.003202362187727072, -0.010677378018924846, -0.02194447440742874,
      -0.029989265242444635, -0.03453690641903273, -0.03561950053357891,
      -0.03353316240863953, -0.028783859768611027, -0.022026227253796382,
      -0.013999641800947591, -0.005465678438464804, 0.0028493366685799163,
      0.010303556437304247, 0.01637825164079047, 0.020704321765555672, 0.023076016528363396,
      0.0234520627266245, 0.02194517674201637, 0.018801613899313764, 0.014372927250661709,
      0.009082456680292287, 0.003389233088146121, -0.002248037398874341,
      -0.007404435400253191, -0.011717602671684044, -0.014910153297045346,
      -0.01680458576639843, -0.017330141437936625, -0.016521637652996257,
      -0.014510849627422696, -0.011511490348885765, -0.007799214643478205,
      -0.003688332776486723, 0.0004929503898356532, 0.004426954331881, 0.007828906635057881,
      0.010465830109433923, 0.012170790988114114, 0.012851746638063814,
      0.012494644550189057, 0.011160840751940924, 0.008979296814200696,
      0.006134354969444285, 0.0028501597878281488, -0.0006270225798982575,
      -0.004047248817865498, -0.007174776405039933, -0.009804145114707865,
      -0.011773412640854087, -0.012973740061311922, -0.01335481284878735,
      -0.012925896156007808, -0.011752636624923787, -0.009950015407823698,
      -0.007672109184840332, -0.005099512013334452, -0.002425399621512187,
      0.0001587269059614817, 0.00247660009479724, 0.00437911881591577, 0.00575387615916552,
      0.006531702501293212, 0.006689875339820985, 0.006251894546121246,
      0.005283966645621745, 0.0038885676689223133, 0.0021956460706362476,
      0.0003521731018580219, -0.0014891606265426318, -0.0031812712530322777,
      -0.0045932260566664, -0.005619283741416337, -0.0061858379114924445,
      -0.006255837807257091, -0.0058304514248356636, -0.004947937426165625,
      -0.0036798894656217378, -0.0021251961669306787, -0.000402210084720838,
      0.0013602699008096995, 0.00303253267079769, 0.004493318343087575,
      0.005638355365974908, 0.006387491494385946, 0.00668995306837964, 0.006527410275568891,
      0.0059146876971752586, 0.004898127718443938, 0.0035517775205292645,
      0.001971717253736102, 0.00026896795102614407, -0.0014384948355312573,
      -0.003034046896263327, -0.004410458072734744, -0.005477121643354438,
      -0.006165989724283173, -0.006435834796291494, -0.006274581757073584,
      -0.005699593562505635, -0.004755936685587436, -0.0035127903761951436,
      -0.0020582867747057816, -0.0004931692971043283, 0.0010762718883316922,
      0.0025454901474883766, 0.0038186977895307214, 0.004815136628718617,
      0.005474195595216219, 0.005759055342061897, 0.005658647374503352,
      0.005187834529655826, 0.004385842265011936, 0.003313087776308625,
      0.0020466586267801753, 0.0006747775797074329, -0.0007093495582738715,
      -0.002013874474560202, -0.0031544045889180046, -0.004059455340719356,
      -0.004674906419954404, -0.004967187601464913, -0.004925012137261476,
      -0.004559577837180239, -0.003903260883157259, -0.003006927941913626,
      -0.0019360816157404912, -0.0007661269731761516, 0.00042290161559155966,
      0.0015517867494094565, 0.002547378737718959, 0.003347304915078211,
      0.0039038369647109595, 0.004186679971441909, 0.004184525337745883,
      0.0039052965990077383, 0.0033751065079045462, 0.0026360294664174717,
      0.001742869818402741, 0.0007591688028716233, -0.0002472626830067198,
      -0.0012089744361065942, -0.002063356883295965, -0.0027566756615477186,
      -0.003247403721722812, -0.0035086478220080286, -0.0035295323715849713,
      -0.0033154770290459695, -0.0028873801335297074, -0.0022797928219347595,
      -0.0015382337715042855, -0.0007158477602318473, 0.00013035057768221033,
      0.0009433854440057837, 0.0016701158081024287, 0.0022646683328604645,
      0.002691288327288671, 0.0029264348003023638, 0.002960001097022954,
      0.002795604371832306, 0.0024499509790971642, 0.00195134641440154,
      0.0013374736620361772, 0.0006526091822054885, -5.552145387219837e-05,
      -0.0007390279371989458, -0.0013530561798603174, -0.001858694387586479,
      -0.0022253985279090944, -0.0024327889168437103, -0.0024717159371593013,
      -0.0023445446907630696, -0.0020646620539858432, -0.0016552615026457888,
      -0.0011475077810702524, -0.0005782220283506677, 1.2743999512860314e-05,
      0.0005852600358038544, 0.001101608033160225, 0.0015289333347839216,
      0.0018412992756518117, 0.002021219272183831, 0.002060579062001155,
      0.0019609050911545208, 0.0017329800770323272, 0.0013958504373419824,
      0.0009753096850982348, 0.0005019745302027273, 9.094309453941677e-06,
      -0.00046975185784899526, -0.000902912753027033, -0.00126272773600984,
      -0.001527261981050599, -0.0016816076052254682, -0.0017186761944667137,
      -0.0016394444592647047, -0.001452652493143981, -0.0011739907894959924,
      -0.0008248453694443596, -0.0004306979618546002, -1.9298470247168323e-05,
      0.0003812611883814495, 0.0007444399306093352, 0.0010469811642068445,
      0.0012703757071084515, 0.0014019638045570648, 0.0014356128894964508,
      0.0013719380080099409, 0.0012180634470658049, 0.000986954898176528,
      0.000696379427280768, 0.0003675738083995502, 2.3718990039407327e-05,
      -0.00031167137888287203, -0.0006163378092829025, -0.0008707315247623361,
      -0.0010592468197705806, -0.0011711530947818188, -0.0012011727888329759,
      -0.0011496767366209943, -0.0010224949598642754, -0.0008303667509767675,
      -0.0005880774063505981, -0.0003133486088937603, -2.556403937328821e-05,
      0.00025557951762445347, 0.0005114029266111066, 0.0007254685685088517,
      0.0008846183190869408, 0.0009797613933479783, 0.0010063664506881986,
      0.0009646335150438986, 0.000859343450926127, 0.0006994044323887905,
      0.0004971346065042031, 0.00026733671598127125, 2.6232788737501668e-05,
      -0.00020966558041253189, -0.00042467369440227904, -0.0006049624385715462,
      -0.0007394327031855947, -0.0008203813332894022, -0.0008439199490953384,
      -0.0008101256777098175, -0.0007229214293465622, -0.0005897015651597285,
      -0.0004207354285131558, -0.00022839517751571767, -2.6264803855058796e-05,
      0.00017180644790591571, 0.00035264114105067353, 0.0005045985864727979,
      0.0006183117062916385, 0.0006872500741913997, 0.0007080763680555735,
      0.0006807782767610716, 0.0006085734869382346, 0.0004976006691578455,
      0.0003564233687197028, 0.00019538548343364212, 2.586585308199591e-05,
      -0.00014051511594532397, -0.0002926821749445419, -0.0004208327108777024,
      -0.000517057873893187, -0.0005758187433348434, -0.0005942497599399104,
      -0.0005722740415601548, -0.0005125282643458005, -0.00042010763496319966,
      -0.0003021532467783329, -0.00016731404558715003, -2.5123114911786097e-05,
      0.00011466740446714019, 0.00024274694715114997, 0.0003508585122354651,
      0.0004323223495518462, 0.000482438750126015, 0.0004987463974612063,
      0.0004811231046554161, 0.00043172671604359134, 0.0003547847393146437,
      0.00025625117599254355, 0.00014335739599670563, 2.409023756134162e-05,
      -9.336555912095786e-05, -0.00020118215165486876, -0.0002924034876940909,
      -0.00036138689522627993, -0.00040414385532479855, -0.00041855999736099803,
      -0.00040448303374828967, -0.0003636765354880122, -0.0002996465103829564,
      -0.0002173560785070757, -0.00012285060632776328, -2.282102414372439e-05,
      7.58635995184068e-05, 0.00016662198488401808, 0.00024359385612602802,
      0.0003020123244118532, 0.0003384922086236316, 0.0003512173713543412,
      0.0003400174092025525, 0.0003063317368772031, 0.0002530667149712828,
      0.00018435848354305653, 0.00010526012467191525, 2.137631731699936e-05,
      -6.152849655991009e-05, -0.0001379213876084326, -0.00020286542535168518,
      -0.0002523336960502717, -0.00028345324012469907, -0.0002946645626245611,
      -0.000285788446573958, -0.0002579982552254908, -0.0002137023012973914,
      -0.00015634676221450928, -9.015464852275285e-05, -1.9820175833557248e-05,
      4.9819674809853224e-05, 0.00011411372012640098, 0.00016890321811184248,
      0.00021078665350542856, 0.00023732610857494363, 0.00024718305758173094,
      0.00024017650755783212, 0.00021726182067957617, 0.00018043392202458182,
      0.00013256356200765744, 7.717954382477646e-05, 1.8213079165317503e-05,
      -4.0277489475572054e-05, -9.438256962384436e-05, -0.00014059927992631036,
      -0.00017605470393128097, -0.00019868046036129302, -0.00020732828165354484,
      -0.0002018205463660763, -0.00018293424852017622, -0.00015232139553819543,
      -0.00011237300454300488, -6.603744366476109e-05, -1.6606618031334277e-05,
      3.251473164797083e-05, 7.804065681567495e-05, 0.0001170209914437876,
      0.00014702957133856773, 0.00016631188549996628, 0.0001738834235344204,
      0.0001695735418522401, 0.00015401347492649892, 0.00012857090406524703,
      9.523701148360488e-05, 5.647496395335046e-05, 1.5041099978195275e-05,
      -2.6208399200355048e-05, -6.451196875554865e-05, -9.738517321559439e-05,
      -0.00012277937468021117, -0.0001392065998720463, -0.00014582320358604253,
      -0.0001424679031007103, -0.00012965294624077414, -0.00010851035509817648,
      -8.069814491919891e-05, -4.8273961353524914e-05, -1.3545550426909463e-05,
      2.1091241492865742e-05, 5.3315712052703286e-05, 8.103580570723365e-05,
      0.00010252185886480147, 0.00011651218503712465, 0.00012228422851949674,
      0.00011968750531954074, 0.0001091372221743163, 9.157013406818125e-05,
      6.836668869077206e-05, 4.124565109163358e-05, 1.2139069408547511e-05,
      -1.6943465148457983e-05, -4.4051850588357495e-05, -6.742456964213042e-05,
      -8.560141757713918e-05, -9.751277212922553e-05, -0.00010254009305309032,
      -0.00010054442164454491, -9.186189009814515e-05, -7.726749199684527e-05,
      -5.791045817988562e-05, -3.5226390585770986e-05, -1.0832717313729085e-05,
      1.3585038081229489e-05, 3.638827966689836e-05, 5.609390182101009e-05,
      7.146929538182703e-05, 8.160781482493769e-05, 8.598020695578127e-05,
      8.445924364806441e-05, 7.731667799753336e-05, 6.519352512125873e-05,
      4.904642933790227e-05, 3.0074404017313224e-05, 9.631423518670048e-06,
      -1.0868862143733268e-05, -3.0049671458531293e-05, -4.666238211275394e-05,
      -5.966659587720743e-05, -6.82939303396707e-05, -7.209172707854682e-05,
      -7.094432277895858e-05, -6.507110261507831e-05, -5.500213511613079e-05,
      -4.153366851843756e-05, -2.5667053807378576e-05, -8.535668694264388e-06,
      8.67491007822744e-06, 2.4807936932919044e-05, 3.881226013364263e-05,
      4.980979070334792e-05, 5.7149419508829324e-05, 6.0444156100187944e-05,
      5.958948127024852e-05, 5.476222328524882e-05, 4.640059405598892e-05,
      3.516726696077657e-05, 2.189846138447478e-05, 7.542852299798113e-06,
      -6.905304221715143e-06, -2.0474177143879193e-05, -3.227890389249216e-05,
      -4.157844130484572e-05, -4.7821132143618396e-05, -5.067625560375396e-05,
      -5.004984908066406e-05, -4.608419285493853e-05, -3.9141462738313443e-05,
      -2.977310317398584e-05, -1.867738642900929e-05, -6.648344972604618e-06,
      5.4802489722997885e-06, 1.689195629136131e-05, 2.684193757163414e-05,
      3.470485410494983e-05, 4.00133734788057e-05, 4.248496741677309e-05,
      4.2035541462064164e-05, 3.877936145783073e-05, 3.3015676379488776e-05,
      2.5203317959854425e-05, 1.5925327175398353e-05, 5.846267609851891e-06,
      -4.334700336357387e-06, -1.3931714588927169e-05, -2.231783523312273e-05,
      -2.8965402056746845e-05, -3.3478570326532414e-05, -3.561606758813895e-05,
      -3.5302926604610764e-05, -3.263072486476989e-05, -2.7846645580302237e-05,
      -2.133241586175758e-05, -1.357482638824413e-05, -5.130052507976758e-06,
      3.4156514300885462e-06, 1.14861434961601e-05, 1.855374985355436e-05,
      2.417326470150029e-05, 2.8009439248248782e-05, 2.9856303289346105e-05,
      2.9647258525560418e-05, 2.745553232535505e-05, 2.3485239090249412e-05,
      1.8053919293876806e-05, 1.1567972876368746e-05, 4.492839516225791e-06,
      -2.6799226736220194e-06, -9.46636238850901e-06, -1.542237891567222e-05,
      -2.0172364249359454e-05, -2.3432425980164156e-05, -2.5026789257318996e-05,
      -2.4896474027316962e-05, -2.309988794392301e-05, -1.9805527986758258e-05,
      -1.5277507604312397e-05, -9.855086809270418e-06, -3.927751021216141e-06,
      2.0923614790653696e-06, 7.79875759944415e-06, 1.2817693901089831e-05,
      1.6832303717758114e-05, 1.9602214253962838e-05, 2.0977467649948828e-05,
      2.0905976238134183e-05, 1.9434198101369632e-05, 1.670118285595668e-05,
      1.2926577981654375e-05, 8.393574139723419e-06, 3.4280792294514247e-06,
      -1.624373236728421e-06, -6.422367237460179e-06, -1.0651387408624495e-05,
      -1.4044141650272315e-05, -1.6397130818458743e-05, -1.7582462103402112e-05,
      -1.755425063809335e-05, -1.6349335771405382e-05, -1.4082427682628406e-05,
      -1.0936170288536125e-05, -7.14693340831563e-06, -2.9874102160659985e-06,
      1.252720679325276e-06, 5.286715630756296e-06, 8.849915818090991e-06,
      1.1716864223631285e-05, 1.3715300075946787e-05, 1.4736181954445081e-05,
      1.473918158284137e-05, 1.3753410228119558e-05, 1.1873466268327205e-05,
      9.251203791957876e-06, 6.083897604158076e-06, 2.5997022901141207e-06,
      -9.585413530880493e-07, -4.350018681284503e-06, -7.3520363813632685e-06,
      -9.774438592937569e-06, -1.1471425311934594e-05, -1.2350055121171544e-05,
      -1.2374957379293908e-05, -1.1569046939020313e-05, -1.0010308569728494e-05,
      -7.82497996396481e-06, -5.177694314747042e-06, -2.2593312434364613e-06,
      7.265429842728678e-07, 3.577695756873548e-06, 6.106755205368471e-06,
      8.15335090553115e-06, 9.594093736466404e-06, 1.0349787686860989e-05,
      1.0389469563722347e-05, 9.73109697401552e-06, 8.43893495190952e-06,
      6.6179116042026695e-06, 4.405408674658605e-06, 1.961111573406541e-06,
      -5.443443993498818e-07, -2.9411353724017923e-06, -5.07161709548503e-06,
      -6.800548762014376e-06, -8.02351961722818e-06, -8.67306486150567e-06,
      -8.722127144907931e-06, -8.184707901052169e-06, -7.1137457555523055e-06,
      -5.596444176129243e-06, -3.7474352350987153e-06, -1.700300364709225e-06,
      4.019358035612366e-07, 2.416671282415368e-06, 4.2112801091927055e-06,
      5.671721433486135e-06, 6.709654019121308e-06, 7.2676219696283935e-06,
      7.32201936975387e-06, 6.883698940673597e-06, 5.9962517278633786e-06,
      4.732140286539142e-06, 3.187006559561081e-06, 1.4725888322616498e-06,
      -2.9123705929745937e-07, -1.984733182061754e-06, -3.4963273961620367e-06,
      -4.729862310557193e-06, -5.610601485266683e-06, -6.089625780436201e-06,
      -6.146371310884812e-06, -5.789192280813637e-06, -5.053967823182509e-06,
      -4.0009026230922215e-06, -2.7097879497967095e-06, -1.2740853175664416e-06,
      2.057364589541563e-07, 1.6291423729623717e-06, 2.90227688651316e-06,
      3.944067282755213e-06, 4.691293801569165e-06, 5.102316214796065e-06,
      5.159245558651625e-06, 4.868460122141857e-06, 4.259478761119223e-06,
      3.3823144196616463e-06, 2.303529147436311e-06, 1.1012926310549229e-06,
      -1.4019559700710747e-07, -1.336527796536907e-06, -2.40875597477869e-06,
      -3.2885303854768473e-06, -3.922379135132105e-06, -4.274866560209939e-06,
      -4.330450804253856e-06, -4.093953451017804e-06, -3.5896496807094673e-06,
      -2.8590797060855026e-06, -1.9577651184400374e-06, -9.510819426158453e-07,
      9.040848420234214e-08, 1.0958419980737559e-06, 1.99881380322078e-06,
      2.7417043986391994e-06, 3.2792916224557423e-06, 3.5814270809806085e-06,
      3.6346243746178182e-06, 3.4424839221849776e-06, 3.02495939016634e-06,
      2.416548292853518e-06, 1.6635591168183045e-06, 8.206648812726552e-07,
      -5.3005134143049446e-08, -8.979600327498611e-07, -1.6583482851003177e-06,
      -2.2855993705613726e-06, -2.741472147923797e-06, -3.0003225591562374e-06,
      -3.0504610330726075e-06, -2.894534750531662e-06, -2.548937210974302e-06,
      -2.042312717181538e-06, -1.4132821596190469e-06, -7.075650764465379e-07,
      2.5291576592312038e-08, 7.353471908037397e-07, 1.3756287907128844e-06,
      1.9051964583487777e-06, 2.2917157911560385e-06, 2.513379032711778e-06,
      2.560064766003517e-06, 2.4336803061497677e-06, 2.147687361607706e-06,
      1.7258663017935774e-06, 1.200423848715565e-06, 6.095900339713096e-07,
      -5.119678015620006e-09, -6.017838049637191e-07, -1.1408985766021511e-06,
      -1.5879581709766065e-06, -1.9156253903877335e-06, -2.1053589652499195e-06,
      -2.14840397629385e-06, -2.0460972995657615e-06, -1.8094873110763372e-06,
      -1.458313108483668e-06, -1.019430166639891e-06, -5.248039733185121e-07,
      -9.218670514699703e-09, 4.921373902186934e-07, 9.460436760681148e-07,
      1.323419193861544e-06, 1.6011539957855029e-06, 1.7634874123189295e-06,
      1.8028536155114255e-06, 1.7201531329478177e-06, 1.5244486308435739e-06,
      1.2321219524047016e-06, 8.655644707573742e-07, 4.5150204525826643e-07,
      1.9077463443413024e-08, -4.0217402029829396e-07, -7.843171725843248e-07,
      -1.1028445627423267e-06, -1.33822177632387e-06, -1.4770545468370234e-06,
      -1.512810403893905e-06, -1.4460592594284152e-06, -1.284230647207443e-06,
      -1.040917818911944e-06, -7.347884265436824e-07, -3.881861905082213e-07,
      -2.5526250497776087e-08, 3.2840222164839113e-07, 6.501096179921504e-07,
      9.189441219728793e-07, 1.1183952833396436e-06, 1.2370822558886545e-06,
      1.2693694892810562e-06, 1.2155793035769017e-06, 1.0817986960766e-06,
      8.793050247459765e-07, 6.236600680591954e-07, 3.335427804881679e-07,
      2.9406565792185542e-08, -2.6794381009681344e-07, -5.387578936076614e-07,
      -7.656340161364241e-07, -9.346189355661425e-07, -1.0360444948702983e-06,
      -1.0650527491251919e-06, -1.0217833074682036e-06, -9.112200507496843e-07,
      -7.427173160172266e-07, -5.292465613349256e-07, -2.864220931588246e-07,
      -3.137757165361143e-08, 2.1842704627712015e-07, 4.4638609433878606e-07,
      6.378374814312862e-07, 7.809902350049022e-07, 8.676327425656228e-07,
      8.935804987942305e-07, 8.588408256080034e-07, 7.674916664608722e-07,
      6.27290819174997e-07, 4.49049582170712e-07, 2.4581961340445367e-07,
      3.1952925465549426e-08, -1.778982755102548e-07, -3.69773085275873e-07,
      -5.313184726058577e-07, -6.525716013895216e-07, -7.265592926041936e-07,
      -7.496796809856069e-07, -7.218467376410063e-07, -6.463947931107661e-07,
      -5.297563767557161e-07, -3.809415105227447e-07, -2.1085910301026831e-07,
      -3.153051095300383e-08, 1.4474887330060827e-07, 3.0624227199014795e-07,
      4.4254272269237264e-07, 5.452328680895684e-07, 6.083922853019275e-07,
      6.289227142986196e-07, 6.066746135656357e-07, 5.443722751416395e-07,
      4.473483232124124e-07, 3.23110895042219e-07, 1.8077735551880566e-07,
      3.0416374501711266e-08, -1.1765486151484027e-07, -2.535698692896257e-07,
      -3.6856172029146245e-07, -4.5551945011904985e-07, -5.094173647852993e-07,
      -5.275921068342121e-07, -5.098532802133126e-07, -4.584250064397888e-07,
      -3.777272011679882e-07, -2.74015858503914e-07, -1.5491053255674284e-07,
      -2.884396058771399e-08, 9.552701155837867e-08, 2.099085729959086e-07,
      3.0691583111304434e-07, 3.8054200572399624e-07, 4.265216696002534e-07,
      4.425667208968742e-07, 4.284629237717595e-07, 3.860245566821918e-07,
      3.1891429664894795e-07, 2.3234430229346226e-07, 1.3268196779201764e-07,
      2.698953849819963e-08, -7.746962516698293e-08, -1.7372405594319007e-07,
      -2.5555341069931915e-07, -3.178840922413489e-07, -3.570965559636198e-07,
      -3.7122623088478987e-07, -3.600476412016935e-07, -3.2503944914324705e-07,
      -2.6923619318402956e-07, -1.9697992972332338e-07, -1.1359132031664435e-07,
      -2.498454726726695e-08, 6.274649386182738e-08, 1.4374214000163188e-07,
      2.127632736817928e-07, 2.6552488586879216e-07, 2.989560326652144e-07,
      3.1137086799902426e-07, 3.0254184045449836e-07, 2.7367296173608273e-07,
      2.2727781757819094e-07, 1.6697324715632397e-07, 9.720495925598143e-08,
      2.2925450561259965e-08, -5.075279553783588e-08, -1.1890485479298501e-07,
      -1.7711831824061226e-07, -2.2177451154196176e-07, -2.502683732141868e-07,
      -2.6115400908854206e-07, -2.5420829974155534e-07, -2.3041065407450462e-07,
      -1.9184268193381252e-07, -1.415168217393972e-07, -8.314746447784327e-08,
      -2.0881582726389267e-08, 4.099190008610183e-08, 9.833389282601748e-08,
      1.4742846659608873e-07, 1.8521992826826462e-07, 2.0949877912724739e-07,
      2.1902555675121867e-07, 2.135860417939988e-07, 1.939761029968079e-07,
      1.6191922325616775e-07, 1.1992417761398336e-07, 7.109413342263963e-08,
      1.8901376917897847e-08, -3.305623288037399e-08, -8.13002199807819e-08,
      -1.2270138503845607e-07, -1.546796495741747e-07, -1.7536131085953938e-07,
      -1.836843854893067e-07, -1.7944647025469774e-07, -1.6329356523736705e-07,
      -1.366523090023394e-07, -1.016118010590655e-07, -6.076439054899474e-08,
      -1.701729251776623e-08, 2.6611491601519584e-08, 6.719880790922865e-08,
      1.0210969995014163e-07, 1.291658587084573e-07, 1.4677859034206096e-07,
      1.5403840416043945e-07, 1.5075646063613337e-07, 1.3745648548742955e-07,
      1.1531911868309948e-07, 8.608380112424946e-08, 5.1916003127637844e-08,
      1.5249698920832993e-08, -2.1383633393145095e-08, -5.552762791168599e-08,
      -8.496363765311411e-08, -1.0785271272381843e-07, -1.228480202773675e-07,
      -1.291710164890443e-07, -1.2664730488553067e-07, -1.1570093663662829e-07,
      -9.730873190958157e-08, -7.291883764643646e-08, -4.4340014705989504e-08,
      -1.3609923766215842e-08, 1.71481500203436e-08, 4.5870189961727115e-08,
      7.068819254331589e-08, 9.00498259208425e-08, 1.0281346769861868e-07,
      1.0831295600214218e-07, 1.063885826132718e-07, 9.738322133703186e-08,
      8.210485532566745e-08, 6.175898460675475e-08, 3.785631520664418e-08,
      1.2102633791266118e-08, -1.3721232098143021e-08, -3.7881030594934776e-08,
      -5.880407555782758e-08, -7.518008756951867e-08, -8.604152906121781e-08,
      -9.081863530927055e-08, -8.936617859561204e-08, -8.19609842446078e-08,
      -6.927120743295501e-08, -5.230024486545922e-08, -3.230977410213414e-08,
      -1.0727684030147312e-08, 1.0952492518643406e-08, 3.127365335994238e-08,
      4.8911818326576494e-08, 6.27611065102373e-08, 7.200163655332131e-08,
      7.614628710436324e-08, 7.506378958415878e-08, 6.897728580301872e-08,
      5.8439153735640184e-08, 4.428447352733855e-08, 2.756687028034874e-08,
      9.48154470752802e-09, -8.718976386081797e-09, -2.5810508796244482e-08,
      -4.0678511375788426e-08, -5.2389690521930924e-08, -6.024938478111049e-08,
      -6.384128978649979e-08, -6.304736738800855e-08, -5.804717414436819e-08,
      -4.929724689410302e-08, -3.749250250221611e-08, -2.351275898500188e-08,
      -8.358393773680639e-09, 6.9202321003725055e-09, 2.1294670240135476e-08,
      3.382674080807647e-08, 4.3728864869401165e-08, 5.041255719961799e-08,
      5.35221676733072e-08, 5.295203271185537e-08, 4.88463640442144e-08,
      4.158237936639093e-08, 3.1738289065753936e-08, 2.0048722527256914e-08,
      7.350945675793499e-09, -5.4742573990025005e-09, -1.7562919491591367e-08,
      -2.8125359770550306e-08, -3.649701525371925e-08, -4.217941571932462e-08,
      -4.4868837355681966e-08, -4.447106792334159e-08, -4.1101692957241033e-08,
      -3.5072300770076696e-08, -2.6863937111703884e-08, -1.7089957290139455e-08,
      -6.451072912332405e-09, 4.314166574000764e-09, 1.4480004438120373e-08,
      2.3381791067032993e-08, 3.045880804302891e-08, 3.528888742370622e-08,
      3.7612740287490676e-08, 3.734665896647726e-08, 3.458307572751962e-08,
      2.9579290131104927e-08, 2.273546193551544e-08, 1.4563654879633849e-08,
      5.6502655596445955e-09, -3.385451885768967e-09, -1.1933870741206682e-08,
      -1.9435607420552742e-08, -2.541759729562172e-08, -2.9522341466207636e-08,
      -3.152855929742227e-08, -3.136210887273178e-08, -2.9096723093819374e-08,
      -2.4944805335581672e-08, -1.923918833246932e-08, -1.240734012315073e-08,
      -4.9399647911492976e-09, 2.643734361399809e-09, 9.831702992664557e-09,
      1.6153177775305965e-08, 2.1209075494941063e-08, 2.4696698808513233e-08,
      2.642726509956408e-08, 2.6335289295583076e-08, 2.447942584680163e-08,
      2.1034959343247002e-08, 1.6278687988678994e-08, 1.0567432995408885e-08,
      4.31179901950346e-09, -2.052917489740176e-09, -8.096638463442118e-09,
      -1.3423203003574687e-08, -1.7695964598258875e-08, -2.0658659052536375e-08,
      -2.2150279533494778e-08, -2.211313351213311e-08, -2.0593737497976888e-08,
      -1.773669580319697e-08, -1.3772175983727968e-08, -8.998005488531752e-09,
      -3.7577453463490915e-09, 1.5836724703491356e-09, 6.665039630605963e-09,
      1.1152993589496193e-08, 1.4763577214369009e-08, 1.727986349601279e-08,
      1.8564576418563364e-08, 1.8567005495527947e-08, 1.7323914482716873e-08,
      1.495455626610399e-08, 1.16502980473425e-08, 7.659707966234173e-09,
      3.2702342294807037e-09, -1.2121961868687057e-09, -5.484230857972541e-09,
      -9.265366248198969e-09, -1.2316105523659758e-08, -1.4452842788110056e-08,
      -1.5558569598527657e-08, -1.5588805889798144e-08, -1.4572494995481199e-08,
      -1.2607947749788505e-08, -9.854250309611313e-09, -6.518842682484163e-09,
      -2.8422114508499197e-09, 9.19193411375121e-10, 4.510620570739948e-09,
      7.69605679954414e-09, 1.0273518818130145e-08, 1.2087622084999259e-08,
      1.3038661854319321e-08, 1.3087697793836188e-08, 1.2257416181615723e-08,
      1.062883344218939e-08, 8.334181903970185e-09, 5.546564934767426e-09,
      2.467168409360913e-09, -6.890432812800944e-10, -3.708143544814954e-09,
      -6.391563613909967e-09, -8.568970007688274e-09
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_48_40_1000_rs_20_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<48>(20.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.7869002854635163, -0.37320258912983034, -0.27295936980298163, -0.1849402134536004,
      -0.11027320738808, -0.049461036073862166, -0.002415884396793193, 0.03148179202269712,
      0.05330500621888626, 0.06448755855932792, 0.06672240464844582, 0.06185664394347605,
      0.05178851294326773, 0.03837131441027834, 0.023328534176446345, 0.008183537242378622,
      -0.005793750005448834, -0.017621815645996082, -0.02662389788991428,
      -0.032426389443604674, -0.03494092478808423, -0.03433252489115066,
      -0.030976756054935203, -0.025409242076046414, -0.018271042218671082,
      -0.010253374322568391, -0.0020449367044027642, 0.005715311588758025,
      0.012477582909230638, 0.01781120453319835, 0.021424057124760615, 0.02317118978956522,
      0.0230529638867301, 0.02120368335859761, 0.017872178441639817, 0.013396198003747407,
      0.008172717550326244, 0.002626378176142974, -0.0028217617102272614,
      -0.007783145009263003, -0.011926566975855962, -0.014997590331950934,
      -0.01683158865544801, -0.01735994782335485, -0.016609423414265606,
      -0.014695093611541837, -0.011807736331411502, -0.008196774581127846,
      -0.004150159590015967, 2.7312477478492548e-05, 0.004035730345192723,
      0.0076003986634449, 0.010489488598801779, 0.01252796441812759, 0.013607036427190048,
      0.013688719062351577, 0.012805413384886895, 0.01105476342038725, 0.008590335066970196,
      0.005608916853691875, 0.0023354296934520575, -0.0009934514670187058,
      -0.00414582198397945, -0.0069101124438378046, -0.00910869601047211,
      -0.010608708043624526, -0.011329463436514753, -0.01124610453892268,
      -0.010389374573189721, -0.008841670620208708, -0.0067297698822004785,
      -0.004214828208392714, -0.0014804087238178912, 0.0012805978343139231,
      0.003879255612983126, 0.006143180363466635, 0.0079276361919336, 0.009124443381478196,
      0.00966817457720308, 0.009539311762991973, 0.008764246876097352, 0.007412220441545841,
      0.005589491470862981, 0.00343120551163643, 0.0010915656218047367,
      -0.0012669947294158363, -0.0034848921085240733, -0.005415986532099135,
      -0.0069370001588226985, -0.00795516980272473, -0.008413674099471143,
      -0.008294534887133977, -0.007618866472881213, -0.00644452419189983,
      -0.004861373351625025, -0.0029845504532708114, -0.0009462111645811383,
      0.001113653373562183, 0.003056703457254419, 0.004755407909436465,
      0.006101275248010851, 0.007011637858554438, 0.007434575401389068,
      0.007351695493272727, 0.0067786368509953785, 0.00576331262148913,
      0.004382059490172327, 0.0027339918342999753, 0.0009339712908407406,
      -0.0008953160844849615, -0.002631635048613465, -0.004161277259017652,
      -0.0053864114458561105, -0.006231239533687646, -0.006646578544035565,
      -0.006612599052690012, -0.006139577188207226, -0.005266650106676693,
      -0.0040586957708274906, -0.0026015782236383437, -0.000996101760483572,
      0.000648904814851024, 0.0022239038883532345, 0.0036258775532727002,
      0.00476499673992532, 0.00557030418491394, 0.005994056864942591, 0.0060144676600520815,
      0.005636695360104276, 0.004892049292389482, 0.0038354920656774663,
      0.0025416335768664745, 0.001099504522439166, -0.00039352771787930913,
      -0.0018382882846978187, -0.0031403346506972407, -0.0042160792925874675,
      -0.0049981019362173255, -0.005439317557866906, -0.0055157465103608735,
      -0.005227728482155674, -0.004599526043174536, -0.003677369381124476,
      -0.002526094584615082, -0.0012246170291588707, 0.00013944653031809683,
      0.0014756430571786546, 0.002696645393831006, 0.0037239211052763014,
      0.0044927427480664535, 0.0049562227745542815, 0.0050881245832651075,
      0.004884284621638227, 0.004362573295347762, 0.0035614185730911485,
      0.0025370093140250883, 0.001359379494329855, 0.0001076443502662966,
      -0.0011352893253716826, -0.002288186941461959, -0.0032767658349252527,
      -0.0040384499122429335, -0.004526297072055038, -0.004711855242158988,
      -0.004586775852224524, -0.004163096631037805, -0.003472193242012474,
      -0.0025624857149309193, -0.0014960653147899968, -0.0003444753451520641,
      0.0008160688162968851, 0.0019097025415096224, 0.0028658481552733548,
      0.003623744970637027, 0.004136284114900811, 0.004372907934822409,
      0.004321397522922382, 0.00398844626227308, 0.0033989972966639364,
      0.0025944032482551737, 0.001629542119993418, 0.0005690893071707789,
      -0.0005168021421882281, -0.0015571256360786961, -0.0024846459292647387,
      -0.0032402248499339872, -0.0037765709208017837, -0.004061176574902031,
      -0.00407826210158659, -0.00382961192408558, -0.0033342618777991435,
      -0.0026270710279664633, -0.001756283378398128, -0.000780248977546095,
      0.00023647362814057304, 0.0012273741592702476, 0.002128326872337197,
      0.0028817246497724732, 0.003440145487376732, 0.003769319180337072,
      0.0038502098606431195, 0.003680089261055172, 0.003272542222315488,
      0.0026564156364218905, 0.0018737901991988724, 0.0009771166475512356,
      2.571062641131092e-05, -0.000918160308690707, -0.0017933401900958506,
      -0.002543734289409255, -0.0031218907282897137, -0.0034919863084867196,
      -0.0036320296915940036, -0.003535147556879191, -0.0032098799818350617,
      -0.0026794760306476594, -0.0019802451835088403, -0.001159080628369207,
      -0.00027032271847269955, 0.0006278282114329813, 0.001477113497218799,
      0.0022229846175983304, 0.002818095448414005, 0.003225295495566368,
      0.0034199357001074805, 0.003391344609464253, 0.003143387618120148,
      0.002694081975564822, 0.0020743014243457506, 0.0013256627159513607,
      0.0004977381246536193, -0.00035521983693189416, -0.001177825616034371,
      -0.001917148359632987, -0.0025261083896434486, -0.002966465108741835,
      -0.0032112073936479127, -0.003246197796246228, -0.003070971334296328,
      -0.0026986450427289245, -0.0021549521536112825, -0.001476471043651793,
      -0.0007081703253827983, 9.95655878135869e-05, 0.0008942341287090956,
      0.0016246200638265317, 0.002244088427048358, 0.002713553710864065,
      0.003003936841259873, 0.003097956102013628, 0.00299114240450784, 0.002692020190149757,
      0.0022214494725430554, 0.001611178560150593, 0.0009017073751947501,
      0.00013960479480173478, -0.0006255426508110749, -0.0013443511767439339,
      -0.001970820503684043, -0.002465270557949632, -0.002796847109415148,
      -0.0029454386412563335, -0.002902885933000122, -0.0026734123155473287,
      -0.002273253275782549, -0.0017295157548697644, -0.0010783467712902532,
      -0.00036253476098465547, 0.00037129750224522233, 0.001075724572063226,
      0.0017055777926577081, 0.002220835567370812, 0.002589159894907721,
      0.0027879188444778387, 0.002805568955571459, 0.0026423136823100655,
      0.002310001188140211, 0.0018312739641428918, 0.0012380307211866384,
      0.0005693047223270043, -0.00013130059495213768, -0.0008184505056593109,
      -0.0014480078546067687, -0.0019798629831644324, -0.0023804836241220805,
      -0.0026250230293803772, -0.0026988541951654373, -0.002598435904906891,
      -0.002331459928370772, -0.0019162752544102045, -0.001380631685824469,
      -0.0007598285091344976, -9.439150993446687e-05, 0.0005725690291170828,
      0.0011981473574354188, 0.0017423981486310385, 0.002170882537345554,
      0.0024568423405591988, 0.0025828655428612973, 0.0025419397648622885,
      0.002337830453144852, 0.0019847643161051026, 0.0015064432478614615,
      0.0009344567584339454, 0.0003061990344952009, -0.00033757221774135637,
      -0.0009553759852533044, -0.0015076764061744247, -0.0019594080492701324,
      -0.002282196973124571, -0.0024561371567677548, -0.002471011383544742,
      -0.0023268820542269694, -0.002034018322921083, -0.0016121687366350743,
      -0.0010892304618129456, -0.0004994045202264838, 0.00011904119918379789,
      0.0007262550671624337, 0.001283370103474843, 0.0017549923714636705,
      0.0021114503585447425, 0.0023306627082128367, 0.0023995070822615595,
      0.002314605684390657, 0.0020824809208954192, 0.0017190753456605501,
      0.0012486708123321986, 0.0007022800245176222, 0.00011561700149808116,
      -0.0004732207387791596, -0.001026207871926135, -0.0015078265696631447,
      -0.0018873254775396756, -0.0021406587334674137, -0.002251982811794461,
      -0.0022146180844011, -0.0020314168715435932, -0.001714518140783205,
      -0.0012845084227792315, -0.0007690464190317106, -0.00020104276250850373,
      0.0003834856923923543, 0.0009477475765779081, 0.0014565441925109698,
      0.0018785203230621038, 0.002188155194134359, 0.00236736764008298,
      0.0024066349903586336, 0.00230555693743951, 0.0020728315901095296,
      0.001725648736880466, 0.0012885426108120396, 0.0007917807787812885,
      0.0002693949975322798, -0.00024301785178874955, -0.0007105827010311654,
      -0.0011013742887314396, -0.0013884440489226528, -0.0015515174537228391,
      -0.0015782552210058549, -0.0014650003370837304, -0.0012169662034848447,
      -0.0008478572343025949, -0.0003789495870781188, 0.00016230592104686664,
      0.0007440664648671908, 0.0013321490673332639, 0.0018922187666947242,
      0.0023919722673599055, 0.0028031773676735474, 0.00310343850728531,
      0.003277577060573677, 0.003318540303802052, 0.003227783644084446,
      0.0030151047268042815, 0.0026979432401966893, 0.002300194354454933,
      0.0018506145933161636, 0.0013809245846855471, 0.0009237319637603301,
      0.0005104085426476032, 0.00016905806681633418, -7.729564168200214e-05,
      -0.00021218513605006937, -0.00022674742613242732, -0.00012027859818052099,
      9.973823506412088e-05, 0.00041813102882491703, 0.0008130287085145771,
      0.0012572773982533311, 0.0017201905986164734, 0.0021695200835037793,
      0.002573520773704113, 0.002902977495408316, 0.0031330646421555736,
      0.0032449210833291513, 0.0032268414331642174, 0.0030750097720357683,
      0.0027937314679533963, 0.0023951509688677685, 0.0018984762541308447,
      0.0013287619482639805, 0.0007153309216246709, 8.993677416031136e-05,
      -0.0005152144914557836, -0.0010694570310241939, -0.0015455452337192577,
      -0.0019213025354295123, -0.0021809356781967285, -0.0023159331134411367,
      -0.002325493303490324, -0.002216459043508699, -0.0020027656462480057,
      -0.001704441871208816, -0.0013462308582578067, -0.0009559222443346631,
      -0.0005625045957553309, -0.00019425816173896748, 0.0001230889108593318,
      0.0003680225264063111, 0.0005246166967003108, 0.0005835326957969205,
      0.0005425808295507615, 0.00040681074339963153, 0.00018812664715402746,
      -9.55456179222281e-05, -0.0004214840594649259, -0.0007637079525979969,
      -0.0010947268551840133, -0.0013873876491386473, -0.0016167001274592324,
      -0.0017615234011924474, -0.0018060046739406949, -0.0017406780992327115,
      -0.0015631534369231978, -0.0012783506304748535, -0.0008982655350356708,
      -0.00044128196978929647, 6.892586436530441e-05, 0.0006048306032640602,
      0.0011367371683712025, 0.0016346095264547595, 0.002069923180909916,
      0.0024174265310808827, 0.0026567003749645786, 0.0027734179691997537,
      0.0027602273308675674, 0.0026172016150570092, 0.002351830872877184,
      0.0019785575255877054, 0.0015178866303175974, 0.000995128637907337,
      0.00043885517404135927, -0.0001208340186133834, -0.00065412354695888,
      -0.0011332605162356793, -0.0015341875684915139, -0.0018379299546933542,
      -0.002031652051381759, -0.0021093202589067455, -0.002071934603355713,
      -0.0019273189700174703, -0.0016894879519810104, -0.0013776350137708615,
      -0.001014810352634741, -0.00062637599793285, -0.00023833912762628688,
      0.00012432852275698727, 0.0004392773298701765, 0.0006881716470045766,
      0.0008577993371950331, 0.0009408303277269983, 0.0009361786980364323,
      0.000848948744981173, 0.0006899724968971169, 0.0004749725317752532,
      0.00022340800608779734, -4.2918012515474576e-05, -0.0003013967703790392,
      -0.0005301955112934119, -0.0007097781892696609, -0.0008242652053629845,
      -0.0008625430280350311, -0.0008190511390958548, -0.0006941949609050269,
      -0.0004943578860347503, -0.00023151166558325675, 7.754946697759914e-05,
      0.00041230113026189015, 0.000749836607129903, 0.0010663825845674197,
      0.0013388843586229233, 0.0015465574726619994, 0.0016723048113015733,
      0.001703906705452769, 0.0016349060584883084, 0.0014651299458615726,
      0.0012008123210901422, 0.0008543078953559798, 0.00044341332173098835,
      -9.663152128798849e-06, -0.00047961998767435444, -0.0009395866705820682,
      -0.0013627589236182023, -0.001724042562330203, -0.0020016030666808455,
      -0.002178223769439256, -0.0022423875079275197, -0.002189013881637321,
      -0.002019805799955014, -0.0017431834222391691, -0.0013738093397630772,
      -0.0009317342996787305, -0.0004412163236549008, 7.071374769998008e-05,
      0.000575851706465829, 0.0010464858914665115, 0.0014570272707916574,
      0.0017855040438366234, 0.0020148299696573753, 0.002133770109587139,
      0.0021375468414126905, 0.002028051631814944, 0.0018136527032328138,
      0.0015086138410572128, 0.001132163576855598, 0.0007072753524795747,
      0.00025923669179909233, -0.00018590218812715236, -0.0006029032526419215,
      -0.000968841436636305, -0.0012644393942517443, -0.0014751556155498061,
      -0.00159196163506977, -0.0016117642753075534, -0.0015374516747364319,
      -0.001377565780831458, -0.0011456275182909555, -0.0008591624820608528,
      -0.0005384933952614889, -0.000205379571315124, 0.0001184076273097205,
      0.0004124813488230667, 0.0006591187571242882, 0.0008443429906812908,
      0.0009587407409189988, 0.000997966432981322, 0.0009629047939927997,
      0.00085948602278818, 0.0006981703766766304, 0.0004931403095745242,
      0.0002612569676568057, 2.085268779841254e-05, -0.00020955878179750574,
      -0.00041256793063970004, -0.0005730655633711348, -0.0006792703912035844,
      -0.0007235208565155579, -0.000702779869310037, -0.0006188203637029987,
      -0.00047808081946921387, -0.000291201750933413, -7.227522145048117e-05,
      0.00016214166849487234, 0.00039418286831927003, 0.0006059214694859587,
      0.0007806262102808483, 0.000903942255402844, 0.000964917070557291,
      0.0009568023443564329, 0.0008775775533828061, 0.0007301589684535623,
      0.0005222784797980705, 0.00026603824285360996, -2.2831584645560194e-05,
      -0.00032596520523331374, -0.0006235402906563076, -0.0008955680044937515,
      -0.0011232105003881592, -0.0012900402228368233, -0.001383158624677732,
      -0.0013941005225675217, -0.0013194636958515078, -0.0011612206462458374,
      -0.0009266895750336726, -0.000628163319053287, -0.0002822168351408539,
      9.126555807653444e-05, 0.0004702838978210422, 0.0008320635964960289,
      0.001154460350887988, 0.0014173410237881385, 0.0016038536190061826,
      0.001701505997780101, 0.0017029845973820445, 0.0016066603866866796,
      0.0014167486282524056, 0.0011431104993450496, 0.0008007069069513312,
      0.0004087365153992192, -1.0490271225578932e-05, -0.0004328731034748694,
      -0.0008339586965085816, -0.001190405204557743, -0.001481384277177939,
      -0.0016898348538668027, -0.0018034918273700565, -0.0018156265441920047,
      -0.0017254538462335987, -0.0015381808807240459, -0.0012646949352743994,
      -0.0009209097182581396, -0.0005268104240741108, -0.00010525630171163563,
      0.000319385850820489, 0.0007226937157411959, 0.001081638519468485,
      0.0013759431807348356, 0.0015892675524904992, 0.0017101497566208775,
      0.0017326479246298726, 0.001656645325582681, 0.0014878027096428292,
      0.0012371634164452302, 0.0009204380396465844, 0.000557014886850171,
      0.00016875893163556044, -0.00022132558087220393, -0.0005904859888467575,
      -0.0009175801051494018, -0.0011843204903122702, -0.001376329315502559,
      -0.0014839414524225577, -0.0015027096100650005, -0.0014335842358535055,
      -0.0012827613090878533, -0.001061211790393787, -0.0007839260606220438,
      -0.00046892397210992576, -0.00013609508317557204, 0.0001940565893956257,
      0.0005016839577311268, 0.0007688050653877006, 0.0009803737720147417,
      0.001125148189680466, 0.0011963057023883228, 0.0011917700263050237,
      0.0011142343769992538, 0.0009708842046107402, 0.0007728419024240588,
      0.0005343731926298297, 0.0002719094642769311, 2.951284795019442e-06,
      -0.0002550750310581568, -0.000485933912709376, -0.0006755989491450826,
      -0.0008131093569693536, -0.0008912119046317324, -0.0009067502176548391,
      -0.000860780193908138, -0.0007584082432333967, -0.0006083670637676054,
      -0.00042236051880661734, -0.0002142238069206962, 1.0434000949320079e-06,
      0.00020830555630179607, 0.00039331298317847184, 0.0005436493582311408,
      0.0006495431383635609, 0.0007044906756349647, 0.0007056516871916127,
      0.000653993115351281, 0.0005541742392364, 0.00041418306926977925,
      0.00024475044766825426, 5.858282601869095e-05, -0.00013053354516191356,
      -0.00030869605475562946, -0.0004628516711355071, -0.0005817004051899065,
      -0.0006564757501633624, -0.0006815499633860513, -0.0006548238795185572,
      -0.0005778753971086793, -0.0004558569053077415, -0.0002971486542391185,
      -0.00011279132206287886, 8.426427046240152e-05, 0.0002800401628413596,
      0.00046048796569953833, 0.0006124552855923567, 0.0007245971006639147,
      0.0007881708215657048, 0.000797661309249989, 0.0007511932082880521,
      0.0006507018702486501, 0.0005018499810749927, 0.0003136937382773946,
      9.811895808757034e-05, -0.00013091724899700084, -0.00035829061082055124,
      -0.0005687011504871849, -0.0007476873984544957, -0.0008825968877389817,
      -0.000963448877137382, -0.0009836318427763925, -0.0009403886404039333,
      -0.0008350557136609189, -0.0006730384487217712, -0.00046352174715343244,
      -0.0002189320173524983, 4.5817032263994914e-05, 0.00031424822350809765,
      0.0005693565079398311, 0.0007946908517576511, 0.0009754134481020982,
      0.0010992682221774904, 0.001157395876770116, 0.0011449420495074519,
      0.0010614179422782034, 0.0009107882383521064, 0.0007012782720011652,
      0.00044491017571634026, 0.0001567949757086069, -0.00014577675963209794,
      -0.0004443900896514711, -0.0007206414833065813, -0.0009572844958339315,
      -0.001139313544647373, -0.001254917429161992, -0.0012962419992576324,
      -0.0012599129847292825, -0.0011472847371526754, -0.0009643975906099357,
      -0.0007216446611437125, -0.0004331670434576404, -0.00011601338963617656,
      0.000210885301963838, 0.0005278631349120994, 0.0008157185837959256,
      0.0010568916675148554, 0.0012365462021118165, 0.001343489935515915,
      0.0013708751873963967, 0.0013166360280506637, 0.0011836342019294053,
      0.0009795039317513825, 0.0007162043151346725, 0.0004093060930027311,
      7.705600433605101e-05, -0.00026072427718084695, -0.0005838373598442368,
      -0.000872934120745249, -0.0011106874927142433, -0.0012828441252247923,
      -0.0013790894786570895, -0.0013936733738374799, -0.001325757746699032,
      -0.0011794654375155685, -0.0009636272166218818, -0.0006912427759988955,
      -0.0003786889526076851, -4.472391210326291e-05, 0.00029065154185711306,
      0.0006074057201224726, 0.000886686718265316, 0.001111958102763907,
      0.0012699905016666114, 0.001351649018728945, 0.001352429091184928,
      0.001272708987942995, 0.0011177046261800043, 0.0008971306843227401,
      0.0006245899755136601, 0.00031672960859949277, -7.783413516549429e-06,
      -0.00032940368753861066, -0.0006288956599512093, -0.0008884957952897334,
      -0.0010929778172944949, -0.0012305565220323868, -0.0012935759435954242,
      -0.0012789412159436948, -0.0011882694630280253, -0.0010277524618082401,
      -0.0008077415745903438, -0.0005420824386060278, -0.000247242085707201,
      5.8716384643553985e-05, 0.00035724749311671016, 0.0006304563995882888,
      0.0008621815790451771, 0.0010389611433771118, 0.0011508245128959438,
      0.001191862400038555, 0.001160542145933694, 0.0010597514538377769,
      0.0008965704839509222, 0.0006817890540843623, 0.0004292012888402483,
      0.0001547235165196962, -0.00012460829126799346, -0.00039169833567269196,
      -0.0006304419427687867, -0.0008267027505390269, -0.0009691564721347667,
      -0.0010499504817918343, -0.0010651404487685384, -0.0010148795223023234,
      -0.0009033512341545224, -0.0007384533431308393, -0.0005312552901431263,
      -0.0002952658022041828, -4.555862560864032e-05, 0.00020218731132407887,
      0.0004326722988302748, 0.0006319229694099369, 0.0007881433594858487,
      0.0008924178367170152, 0.0009392237330364101, 0.0009267239796448322,
      0.0008568242301567044, 0.0007349939699887274, 0.0005698659886020922,
      0.0003726423983386211, 0.00015634725775940848, -6.5024932680265e-05,
      -0.0002774096049249944, -0.0004675636867541161, -0.0006238919344554131,
      -0.0007371564423523322, -0.0008010257881086423, -0.000812431003413705,
      -0.0007717082599788157, -0.0006825220022756747, -0.0005515763476282988,
      -0.0003881360100679371, -0.0002033899356319983, -9.700516162563936e-06,
      0.00018021192063173762, 0.0003540960743550687, 0.0005009547003336544,
      0.0006117376272320046, 0.0006798991841334447, 0.0007017856906635172,
      0.000676830015066745, 0.0006075429247178558, 0.0004993042099599304,
      0.00035996949638771996, 0.00019932044146843956, 2.8395888430876137e-05,
      -0.00014125109798736118, -0.0002983210169974304, -0.0004325101066371443,
      -0.0005351786261182762, -0.0005999022327944179, -0.0006228714633700324,
      -0.0006031145633621482, -0.0005425306742480728, -0.00044573290872601773,
      -0.00031971330176333064, -0.00017335320868590038, -1.681268329196641e-05,
      0.00013915992950564956, 0.0002839519985031412, 0.00040779612147699403,
      0.0005024183255788015, 0.0005615824500223724, 0.0005814952929821089,
      0.0005610464747637732, 0.0005018680014173859, 0.0004082104781701795,
      0.00028664503383645114, 0.00014561148284744543, -5.15667691540348e-06,
      -0.00015529180872132488, -0.00029449214482883207, -0.0004132156361842895,
      -0.0005033215535227327, -0.0005586173103160608, -0.0005752743281629413,
      -0.000552085482417835, -0.0004905471743570373, -0.00039476068444807544,
      -0.0002711594072439588, -0.00012808006914181581, 2.479366706864436e-05,
      0.0001770783760213921, 0.0003183859788979021, 0.0004390207517431852,
      0.000530632027519612, 0.0005867792520808314, 0.0006033717681870982,
      0.0005789538915354578, 0.000514815974687712, 0.0004149235681295786,
      0.0002856687380216306, 0.00013545930753426036, -2.5827511844534742e-05,
      -0.00018749164101811063, -0.00033871465400610215, -0.00046927619143685375,
      -0.0005702352067601215, -0.0006345311037852797, -0.0006574648838358284,
      -0.0006370280998673148, -0.0005740572209650184, -0.0004722023122703705,
      -0.0003377110026689977, -0.00017904076417628838, -6.323780555957353e-06,
      0.0001692815944388147, 0.0003363112324105963, 0.0004837410299035611,
      0.0006017097608215236, 0.0006821718531001999, 0.0007194372417831032,
      0.0007105625246750505, 0.0006555670683861283, 0.0005574588832715176,
      0.0004220672921802493, 0.0002576918774978358, 7.4589102061225e-05,
      -0.0001156714071256924, -0.00030094033521118105, -0.00046926531664472115,
      -0.0006096610765004814, -0.0007128235360856017, -0.0007717416407428937,
      -0.0007821669494980679, -0.0007429099028362688, -0.0006559425996874053,
      -0.0005263001782937703, -0.0003617857296766045, -0.00017249625901805232,
      2.9801255889791434e-05, 0.00023240492019538524, 0.0004224779866097108,
      0.0005878634095951127, 0.0007178611510196066, 0.0008039185686571221,
      0.000840189459556937, 0.0008239254229077303, 0.0007556736497222989,
      0.0006392673862467345, 0.0004816083908834921, 0.0002922538848368214,
      8.283294889386989e-05, -0.00013367174996118205, -0.00034373230727203195,
      -0.0005341234804829897, -0.0006927568526555749, -0.0008094485686414915,
      -0.000876571878322402, -0.0008895527452852835, -0.0008471764688319991,
      -0.000751685021054537, -0.0006086578849058453, -0.00042668277333875117,
      -0.00021683585833485406, 7.996794346321599e-06, 0.00023391476811882955,
      0.0004468664694091964, 0.0006335261288802457, 0.0007821297343124081,
      0.0008832173516197242, 0.0009302349505374409, 0.000919957474366184,
      0.0008527059464361977, 0.000732344203056199, 0.0005660545855990303,
      0.0003639057535086668, 0.0001382388282338139, -9.70904748939781e-05,
      -0.0003275669458202659, -0.0005389152057416708, -0.0007179873304450782,
      -0.0008535834056361636, -0.0009371536752981588, -0.000963338188948284,
      -0.000930309870890299, -0.0008398991037332178, -0.000697491483231902,
      -0.0005117045168862967, -0.00029386282379498106, -5.730398628938326e-05,
      0.00018344218364516496, 0.00041355023411745984, 0.0006188159720475395,
      0.0007865367588049472, 0.0009063004692720587, 0.0009706339716875344,
      0.0009754706444629769, 0.0009204076367934692, 0.000808736607563671,
      0.000647245731793236, 0.00044580497093484614, 0.00021676007784791575,
      -2.5827290573300578e-05, -0.00026704639258938613, -0.0004920575174938292,
      -0.0006870084184351258, -0.0008398902774762202, -0.0009412801420449887,
      -0.0009849237939328714, -0.0009681228959881996, -0.0008919023931910692,
      -0.0007609477694972708, -0.0005833160324032312, -0.0003699383262432064,
      -0.00013394499065835195, 0.00011014512006575868, 0.00034732084099111727,
      0.0005630049280210298, 0.0007439529876395943, 0.0008790695007025583,
      0.0009600905100872303, 0.0009820908409536983, 0.000943784628167305,
      0.0008476007583379773, 0.0006995287950238829, 0.0005087451766881624,
      0.00028704307456106366
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_1_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<1>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 1.2632778318671395e-05), "design.b()[0] == 1.2632778318671395e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 1.2632778318671395e-05));
    static_assert(almost_equal(design.b()[1], 1.2632778318671395e-05), "design.b()[1] == 1.2632778318671395e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - 1.2632778318671395e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.9999747344433627), "design.a()[1] == -0.9999747344433627");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.9999747344433627));
    std::cout << "max_deviation(cheby2,lowpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      1.2632778318671395e-05, 2.5265237463166694e-05, 2.5264599122878615e-05, 2.526396079871856e-05,
      2.5263322490686118e-05, 2.5262684198780883e-05, 2.5262045923002447e-05,
      2.5261407663350404e-05, 2.5260769419824347e-05, 2.526013119242387e-05,
      2.5259492981148562e-05, 2.5258854785998017e-05, 2.5258216606971828e-05,
      2.525757844406959e-05, 2.525694029729089e-05, 2.5256302166635324e-05,
      2.5255664052102485e-05, 2.5255025953691966e-05, 2.5254387871403357e-05,
      2.525374980523625e-05, 2.5253111755190243e-05, 2.5252473721264925e-05,
      2.5251835703459887e-05, 2.5251197701774727e-05, 2.5250559716209033e-05,
      2.52499217467624e-05, 2.5249283793434423e-05, 2.524864585622469e-05,
      2.5248007935132792e-05, 2.524737003015833e-05, 2.524673214130089e-05,
      2.5246094268560065e-05, 2.5245456411935453e-05, 2.5244818571426643e-05,
      2.5244180747033227e-05, 2.52435429387548e-05, 2.5242905146590953e-05,
      2.5242267370541282e-05, 2.524162961060538e-05, 2.5240991866782835e-05,
      2.5240354139073242e-05, 2.5239716427476195e-05, 2.5239078731991287e-05,
      2.523844105261811e-05, 2.523780338935626e-05, 2.5237165742205326e-05,
      2.52365281111649e-05, 2.523589049623458e-05, 2.5235252897413956e-05,
      2.523461531470262e-05, 2.5233977748100166e-05, 2.5233340197606187e-05,
      2.5232702663220278e-05, 2.5232065144942028e-05, 2.523142764277103e-05,
      2.5230790156706884e-05, 2.5230152686749177e-05, 2.5229515232897503e-05,
      2.5228877795151456e-05, 2.5228240373510626e-05, 2.522760296797461e-05,
      2.5226965578543e-05, 2.5226328205215388e-05, 2.522569084799137e-05,
      2.5225053506870535e-05, 2.5224416181852477e-05, 2.522377887293679e-05,
      2.5223141580123072e-05, 2.522250430341091e-05, 2.5221867042799897e-05,
      2.5221229798289628e-05, 2.5220592569879696e-05, 2.5219955357569696e-05,
      2.521931816135922e-05, 2.521868098124786e-05, 2.521804381723521e-05,
      2.5217406669320864e-05, 2.5216769537504415e-05, 2.5216132421785455e-05,
      2.521549532216358e-05, 2.521485823863838e-05, 2.521422117120945e-05,
      2.5213584119876383e-05, 2.5212947084638774e-05, 2.5212310065496213e-05,
      2.5211673062448298e-05, 2.521103607549462e-05, 2.521039910463477e-05,
      2.520976214986834e-05, 2.520912521119493e-05, 2.520848828861413e-05,
      2.5207851382125533e-05, 2.5207214491728735e-05, 2.5206577617423326e-05,
      2.52059407592089e-05, 2.520530391708505e-05, 2.5204667091051376e-05,
      2.5204030281107464e-05, 2.520339348725291e-05, 2.5202756709487304e-05,
      2.5202119947810243e-05, 2.5201483202221323e-05, 2.5200846472720133e-05,
      2.5200209759306268e-05, 2.5199573061979323e-05, 2.519893638073889e-05,
      2.5198299715584563e-05, 2.5197663066515935e-05, 2.51970264335326e-05,
      2.5196389816634153e-05, 2.5195753215820185e-05, 2.5195116631090292e-05,
      2.5194480062444068e-05, 2.5193843509881102e-05, 2.519320697340099e-05,
      2.5192570453003328e-05, 2.5191933948687708e-05, 2.5191297460453723e-05,
      2.519066098830097e-05, 2.519002453222904e-05, 2.5189388092237524e-05,
      2.5188751668326022e-05, 2.5188115260494122e-05, 2.518747886874142e-05,
      2.5186842493067513e-05, 2.5186206133471992e-05, 2.518556978995445e-05,
      2.518493346251448e-05, 2.5184297151151678e-05, 2.5183660855865635e-05,
      2.5183024576655946e-05, 2.5182388313522207e-05, 2.5181752066464008e-05,
      2.5181115835480945e-05, 2.5180479620572614e-05, 2.5179843421738606e-05,
      2.5179207238978515e-05, 2.5178571072291935e-05, 2.5177934921678462e-05,
      2.5177298787137687e-05, 2.5176662668669206e-05, 2.5176026566272613e-05,
      2.51753904799475e-05, 2.5174754409693464e-05, 2.5174118355510095e-05,
      2.517348231739699e-05, 2.517284629535374e-05, 2.5172210289379943e-05,
      2.517157429947519e-05, 2.5170938325639076e-05, 2.5170302367871197e-05,
      2.5169666426171144e-05, 2.5169030500538512e-05, 2.5168394590972896e-05,
      2.516775869747389e-05, 2.5167122820041086e-05, 2.5166486958674077e-05,
      2.516585111337246e-05, 2.5165215284135832e-05, 2.5164579470963782e-05,
      2.5163943673855905e-05, 2.5163307892811794e-05, 2.5162672127831047e-05,
      2.5162036378913256e-05, 2.5161400646058015e-05, 2.5160764929264918e-05,
      2.516012922853356e-05, 2.5159493543863534e-05, 2.5158857875254435e-05,
      2.515822222270586e-05, 2.5157586586217398e-05, 2.5156950965788647e-05,
      2.51563153614192e-05, 2.515567977310865e-05, 2.5155044200856593e-05,
      2.5154408644662623e-05, 2.5153773104526335e-05, 2.515313758044732e-05,
      2.5152502072425175e-05, 2.5151866580459494e-05, 2.5151231104549872e-05,
      2.51505956446959e-05, 2.514996020089718e-05, 2.51493247731533e-05,
      2.5148689361463855e-05, 2.514805396582844e-05, 2.514741858624665e-05,
      2.5146783222718075e-05, 2.5146147875242317e-05, 2.5145512543818965e-05,
      2.5144877228447616e-05, 2.5144241929127863e-05, 2.51436066458593e-05,
      2.5142971378641522e-05, 2.5142336127474125e-05, 2.51417008923567e-05,
      2.5141065673288848e-05, 2.5140430470270157e-05, 2.5139795283300224e-05,
      2.5139160112378645e-05, 2.5138524957505013e-05, 2.513788981867892e-05,
      2.5137254695899967e-05, 2.513661958916774e-05, 2.513598449848184e-05,
      2.513534942384186e-05, 2.5134714365247393e-05, 2.5134079322698035e-05,
      2.513344429619338e-05, 2.5132809285733025e-05, 2.513217429131656e-05,
      2.5131539312943585e-05, 2.513090435061369e-05, 2.5130269404326475e-05,
      2.512963447408153e-05, 2.512899955987845e-05, 2.5128364661716832e-05,
      2.512772977959627e-05, 2.5127094913516356e-05, 2.5126460063476688e-05,
      2.512582522947686e-05, 2.5125190411516464e-05, 2.5124555609595098e-05,
      2.5123920823712358e-05, 2.5123286053867835e-05, 2.5122651300061125e-05,
      2.5122016562291826e-05, 2.512138184055953e-05, 2.512074713486383e-05,
      2.5120112445204325e-05, 2.5119477771580607e-05, 2.511884311399227e-05,
      2.511820847243891e-05, 2.511757384692012e-05, 2.51169392374355e-05,
      2.511630464398464e-05, 2.511567006656714e-05, 2.5115035505182588e-05,
      2.5114400959830585e-05, 2.5113766430510723e-05, 2.5113131917222597e-05,
      2.5112497419965802e-05, 2.5111862938739933e-05, 2.5111228473544585e-05,
      2.5110594024379357e-05, 2.5109959591243837e-05, 2.5109325174137623e-05,
      2.510869077306031e-05, 2.5108056388011496e-05, 2.5107422018990773e-05,
      2.5106787665997737e-05, 2.510615332903198e-05, 2.51055190080931e-05,
      2.510488470318069e-05, 2.510425041429435e-05, 2.510361614143367e-05,
      2.5102981884598247e-05, 2.5102347643787677e-05, 2.5101713419001554e-05,
      2.510107921023947e-05, 2.5100445017501026e-05, 2.5099810840785815e-05,
      2.5099176680093432e-05, 2.5098542535423473e-05, 2.5097908406775532e-05,
      2.5097274294149203e-05, 2.509664019754408e-05, 2.5096006116959764e-05,
      2.5095372052395846e-05, 2.5094738003851922e-05, 2.5094103971327588e-05,
      2.5093469954822438e-05, 2.5092835954336067e-05, 2.5092201969868072e-05,
      2.509156800141805e-05, 2.5090934048985593e-05, 2.5090300112570295e-05,
      2.5089666192171754e-05, 2.5089032287789565e-05, 2.5088398399423323e-05,
      2.5087764527072623e-05, 2.508713067073706e-05, 2.508649683041623e-05,
      2.5085863006109732e-05, 2.5085229197817156e-05, 2.50845954055381e-05,
      2.508396162927216e-05, 2.508332786901893e-05, 2.5082694124778002e-05,
      2.5082060396548976e-05, 2.5081426684331448e-05, 2.508079298812501e-05,
      2.5080159307929262e-05, 2.5079525643743794e-05, 2.5078891995568205e-05,
      2.507825836340209e-05, 2.5077624747245044e-05, 2.5076991147096663e-05,
      2.5076357562956543e-05, 2.507572399482428e-05, 2.507509044269947e-05,
      2.5074456906581703e-05, 2.507382338647058e-05, 2.5073189882365696e-05,
      2.5072556394266645e-05, 2.5071922922173023e-05, 2.5071289466084428e-05,
      2.5070656026000452e-05, 2.5070022601920693e-05, 2.5069389193844748e-05,
      2.506875580177221e-05, 2.5068122425702674e-05, 2.5067489065635736e-05,
      2.5066855721570992e-05, 2.506622239350804e-05, 2.5065589081446473e-05,
      2.5064955785385888e-05, 2.506432250532588e-05, 2.5063689241266048e-05,
      2.5063055993205983e-05, 2.5062422761145283e-05, 2.5061789545083545e-05,
      2.506115634502036e-05, 2.506052316095533e-05, 2.5059889992888047e-05,
      2.5059256840818106e-05, 2.5058623704745107e-05, 2.505799058466864e-05,
      2.5057357480588308e-05, 2.50567243925037e-05, 2.5056091320414415e-05,
      2.505545826432005e-05, 2.50548252242202e-05, 2.505419220011446e-05,
      2.5053559192002428e-05, 2.5052926199883695e-05, 2.5052293223757863e-05,
      2.5051660263624524e-05, 2.5051027319483276e-05, 2.5050394391333714e-05,
      2.5049761479175434e-05, 2.504912858300803e-05, 2.5048495702831103e-05,
      2.5047862838644245e-05, 2.5047229990447052e-05, 2.504659715823912e-05,
      2.5045964342020048e-05, 2.504533154178943e-05, 2.504469875754686e-05,
      2.5044065989291938e-05, 2.504343323702426e-05, 2.5042800500743415e-05,
      2.5042167780449007e-05, 2.5041535076140628e-05, 2.504090238781788e-05,
      2.504026971548035e-05, 2.503963705912764e-05, 2.5039004418759346e-05,
      2.5038371794375062e-05, 2.5037739185974387e-05, 2.5037106593556916e-05,
      2.503647401712224e-05, 2.5035841456669964e-05, 2.5035208912199677e-05,
      2.503457638371098e-05, 2.5033943871203468e-05, 2.5033311374676737e-05,
      2.503267889413038e-05, 2.5032046429563997e-05, 2.5031413980977182e-05,
      2.5030781548369536e-05, 2.503014913174065e-05, 2.5029516731090124e-05,
      2.502888434641755e-05, 2.5028251977722526e-05, 2.5027619625004652e-05,
      2.502698728826352e-05, 2.5026354967498728e-05, 2.502572266270987e-05,
      2.5025090373896546e-05, 2.502445810105835e-05, 2.5023825844194883e-05,
      2.5023193603305734e-05, 2.5022561378390505e-05, 2.502192916944879e-05,
      2.5021296976480184e-05, 2.5020664799484286e-05, 2.502003263846069e-05,
      2.5019400493408997e-05, 2.50187683643288e-05, 2.5018136251219698e-05,
      2.5017504154081283e-05, 2.5016872072913156e-05, 2.501624000771491e-05,
      2.5015607958486143e-05, 2.501497592522645e-05, 2.5014343907935432e-05,
      2.5013711906612683e-05, 2.50130799212578e-05, 2.5012447951870374e-05,
      2.5011815998450008e-05, 2.5011184060996298e-05, 2.501055213950884e-05,
      2.5009920233987228e-05, 2.5009288344431062e-05, 2.5008656470839936e-05,
      2.500802461321345e-05, 2.5007392771551197e-05, 2.5006760945852778e-05,
      2.5006129136117785e-05, 2.5005497342345816e-05, 2.500486556453647e-05,
      2.5004233802689343e-05, 2.500360205680403e-05, 2.5002970326880127e-05,
      2.5002338612917232e-05, 2.500170691491494e-05, 2.5001075232872852e-05,
      2.500044356679056e-05, 2.499981191666767e-05, 2.499918028250377e-05,
      2.4998548664298456e-05, 2.499791706205133e-05, 2.4997285475761985e-05,
      2.499665390543002e-05, 2.499602235105503e-05, 2.4995390812636614e-05,
      2.4994759290174366e-05, 2.4994127783667885e-05, 2.4993496293116767e-05,
      2.499286481852061e-05, 2.4992233359879008e-05, 2.499160191719156e-05,
      2.4990970490457867e-05, 2.499033907967752e-05, 2.4989707684850117e-05,
      2.4989076305975255e-05, 2.4988444943052534e-05, 2.4987813596081548e-05,
      2.4987182265061892e-05, 2.498655094999317e-05, 2.498591965087497e-05,
      2.4985288367706896e-05, 2.4984657100488544e-05, 2.4984025849219507e-05,
      2.4983394613899386e-05, 2.4982763394527777e-05, 2.4982132191104277e-05,
      2.4981501003628483e-05, 2.4980869832099992e-05, 2.49802386765184e-05,
      2.4979607536883305e-05, 2.4978976413194303e-05, 2.4978345305450995e-05,
      2.4977714213652973e-05, 2.4977083137799838e-05, 2.4976452077891187e-05,
      2.4975821033926614e-05, 2.4975190005905717e-05, 2.4974558993828095e-05,
      2.4973927997693344e-05, 2.4973297017501065e-05, 2.497266605325085e-05,
      2.4972035104942296e-05, 2.4971404172575005e-05, 2.497077325614857e-05,
      2.497014235566259e-05, 2.496951147111666e-05, 2.496888060251038e-05,
      2.496824974984335e-05, 2.496761891311516e-05, 2.4966988092325413e-05,
      2.4966357287473703e-05, 2.496572649855963e-05, 2.496509572558279e-05,
      2.496446496854278e-05, 2.4963834227439198e-05, 2.4963203502271642e-05,
      2.4962572793039707e-05, 2.4961942099742992e-05, 2.4961311422381095e-05,
      2.4960680760953612e-05, 2.496005011546014e-05, 2.495941948590028e-05,
      2.4958788872273624e-05, 2.4958158274579773e-05, 2.4957527692818324e-05,
      2.4956897126988874e-05, 2.4956266577091022e-05, 2.4955636043124362e-05,
      2.4955005525088495e-05, 2.4954375022983017e-05, 2.4953744536807525e-05,
      2.495311406656162e-05, 2.4952483612244893e-05, 2.4951853173856947e-05,
      2.4951222751397377e-05, 2.495059234486578e-05, 2.494996195426176e-05,
      2.4949331579584906e-05, 2.4948701220834818e-05, 2.4948070878011097e-05,
      2.4947440551113338e-05, 2.494681024014114e-05, 2.4946179945094098e-05,
      2.4945549665971812e-05, 2.4944919402773878e-05, 2.4944289155499895e-05,
      2.494365892414946e-05, 2.4943028708722172e-05, 2.4942398509217625e-05,
      2.494176832563542e-05, 2.4941138157975156e-05, 2.4940508006236427e-05,
      2.4939877870418834e-05, 2.493924775052197e-05, 2.4938617646545438e-05,
      2.4937987558488834e-05, 2.4937357486351755e-05, 2.49367274301338e-05,
      2.4936097389834563e-05, 2.4935467365453648e-05, 2.493483735699065e-05,
      2.4934207364445167e-05, 2.4933577387816795e-05, 2.4932947427105134e-05,
      2.493231748230978e-05, 2.4931687553430333e-05, 2.493105764046639e-05,
      2.4930427743417546e-05, 2.4929797862283404e-05, 2.4929167997063558e-05,
      2.4928538147757607e-05, 2.492790831436515e-05, 2.4927278496885784e-05,
      2.4926648695319108e-05, 2.492601890966472e-05, 2.4925389139922216e-05,
      2.4924759386091194e-05, 2.4924129648171255e-05, 2.4923499926161993e-05,
      2.4922870220063008e-05, 2.49222405298739e-05, 2.4921610855594264e-05,
      2.49209811972237e-05, 2.4920351554761805e-05, 2.4919721928208176e-05,
      2.4919092317562415e-05, 2.4918462722824115e-05, 2.4917833143992878e-05,
      2.49172035810683e-05, 2.491657403404998e-05, 2.4915944502937515e-05,
      2.4915314987730504e-05, 2.4914685488428545e-05, 2.4914056005031236e-05,
      2.4913426537538176e-05, 2.4912797085948963e-05, 2.4912167650263194e-05,
      2.4911538230480468e-05, 2.4910908826600382e-05, 2.4910279438622537e-05,
      2.490965006654653e-05, 2.490902071037196e-05, 2.490839137009842e-05,
      2.4907762045725517e-05, 2.4907132737252844e-05, 2.490650344468e-05,
      2.490587416800658e-05, 2.4905244907232186e-05, 2.4904615662356417e-05,
      2.490398643337887e-05, 2.4903357220299143e-05, 2.4902728023116835e-05,
      2.4902098841831543e-05, 2.4901469676442867e-05, 2.4900840526950404e-05,
      2.4900211393353755e-05, 2.4899582275652516e-05, 2.4898953173846287e-05,
      2.4898324087934665e-05, 2.4897695017917247e-05, 2.4897065963793634e-05,
      2.4896436925563424e-05, 2.4895807903226216e-05, 2.4895178896781606e-05,
      2.4894549906229194e-05, 2.4893920931568577e-05, 2.4893291972799355e-05,
      2.489266302992113e-05, 2.4892034102933495e-05, 2.489140519183605e-05,
      2.4890776296628394e-05, 2.4890147417310124e-05, 2.488951855388084e-05,
      2.4888889706340143e-05, 2.488826087468763e-05, 2.4887632058922894e-05,
      2.488700325904554e-05, 2.4886374475055167e-05, 2.488574570695137e-05,
      2.4885116954733753e-05, 2.488448821840191e-05, 2.4883859497955435e-05,
      2.4883230793393937e-05, 2.4882602104717006e-05, 2.4881973431924247e-05,
      2.4881344775015257e-05, 2.4880716133989632e-05, 2.4880087508846973e-05,
      2.4879458899586876e-05, 2.4878830306208945e-05, 2.4878201728712773e-05,
      2.487757316709796e-05, 2.4876944621364108e-05, 2.4876316091510815e-05,
      2.487568757753768e-05, 2.4875059079444297e-05, 2.487443059723027e-05,
      2.4873802130895194e-05, 2.487317368043867e-05, 2.4872545245860297e-05,
      2.4871916827159676e-05, 2.4871288424336402e-05, 2.4870660037390073e-05,
      2.4870031666320293e-05, 2.4869403311126658e-05, 2.4868774971808765e-05,
      2.4868146648366214e-05, 2.4867518340798605e-05, 2.4866890049105536e-05,
      2.4866261773286606e-05, 2.4865633513341416e-05, 2.4865005269269562e-05,
      2.4864377041070645e-05, 2.486374882874426e-05, 2.4863120632290014e-05,
      2.4862492451707498e-05, 2.4861864286996316e-05, 2.4861236138156065e-05,
      2.4860608005186344e-05, 2.4859979888086752e-05, 2.4859351786856888e-05,
      2.4858723701496352e-05, 2.485809563200474e-05, 2.4857467578381656e-05,
      2.4856839540626696e-05, 2.4856211518739458e-05, 2.4855583512719543e-05,
      2.485495552256655e-05, 2.4854327548280077e-05, 2.4853699589859724e-05,
      2.485307164730509e-05, 2.4852443720615774e-05, 2.4851815809791374e-05,
      2.4851187914831492e-05, 2.4850560035735727e-05, 2.4849932172503676e-05,
      2.484930432513494e-05, 2.4848676493629113e-05, 2.4848048677985803e-05,
      2.4847420878204603e-05, 2.4846793094285116e-05, 2.4846165326226937e-05,
      2.4845537574029667e-05, 2.4844909837692906e-05, 2.4844282117216254e-05,
      2.4843654412599308e-05, 2.484302672384167e-05, 2.4842399050942935e-05,
      2.4841771393902708e-05, 2.4841143752720585e-05, 2.4840516127396165e-05,
      2.483988851792905e-05, 2.4839260924318834e-05, 2.4838633346565123e-05,
      2.4838005784667513e-05, 2.4837378238625604e-05, 2.4836750708438993e-05,
      2.4836123194107284e-05, 2.4835495695630073e-05, 2.483486821300696e-05,
      2.4834240746237544e-05, 2.4833613295321426e-05, 2.4832985860258204e-05,
      2.483235844104748e-05, 2.483173103768885e-05, 2.4831103650181916e-05,
      2.4830476278526276e-05, 2.482984892272153e-05, 2.4829221582767277e-05,
      2.4828594258663118e-05, 2.482796695040865e-05, 2.4827339658003476e-05,
      2.4826712381447193e-05, 2.4826085120739402e-05, 2.48254578758797e-05,
      2.4824830646867693e-05, 2.4824203433702973e-05, 2.4823576236385142e-05,
      2.4822949054913803e-05, 2.4822321889288553e-05, 2.482169473950899e-05,
      2.4821067605574715e-05, 2.4820440487485327e-05, 2.4819813385240428e-05,
      2.4819186298839617e-05, 2.4818559228282492e-05, 2.4817932173568654e-05,
      2.4817305134697704e-05, 2.4816678111669238e-05, 2.481605110448286e-05,
      2.4815424113138166e-05, 2.4814797137634756e-05, 2.4814170177972232e-05,
      2.4813543234150193e-05, 2.481291630616824e-05, 2.481228939402597e-05,
      2.4811662497722985e-05, 2.4811035617258885e-05, 2.4810408752633267e-05,
      2.4809781903845733e-05, 2.480915507089588e-05, 2.4808528253783314e-05,
      2.480790145250763e-05, 2.480727466706843e-05, 2.4806647897465312e-05,
      2.4806021143697876e-05, 2.4805394405765724e-05, 2.4804767683668454e-05,
      2.4804140977405668e-05, 2.4803514286976964e-05, 2.480288761238194e-05,
      2.48022609536202e-05, 2.4801634310691346e-05, 2.4801007683594973e-05,
      2.4800381072330683e-05, 2.4799754476898072e-05, 2.4799127897296745e-05,
      2.47985013335263e-05, 2.479787478558634e-05, 2.4797248253476458e-05,
      2.479662173719626e-05, 2.4795995236745347e-05, 2.4795368752123314e-05,
      2.4794742283329766e-05, 2.47941158303643e-05, 2.4793489393226517e-05,
      2.4792862971916016e-05, 2.4792236566432397e-05, 2.4791610176775263e-05,
      2.4790983802944212e-05, 2.4790357444938843e-05, 2.478973110275876e-05,
      2.478910477640356e-05, 2.4788478465872842e-05, 2.478785217116621e-05,
      2.4787225892283264e-05, 2.47865996292236e-05, 2.4785973381986823e-05,
      2.478534715057253e-05, 2.4784720934980322e-05, 2.47840947352098e-05,
      2.4783468551260565e-05, 2.4782842383132214e-05, 2.478221623082435e-05,
      2.4781590094336573e-05, 2.4780963973668484e-05, 2.478033786881968e-05,
      2.4779711779789766e-05, 2.4779085706578337e-05, 2.4778459649185e-05,
      2.4777833607609346e-05, 2.4777207581850984e-05, 2.477658157190951e-05,
      2.477595557778453e-05, 2.4775329599475635e-05, 2.477470363698243e-05,
      2.4774077690304518e-05, 2.4773451759441496e-05, 2.4772825844392965e-05,
      2.477219994515853e-05, 2.4771574061737786e-05, 2.4770948194130334e-05,
      2.4770322342335775e-05, 2.476969650635371e-05, 2.476907068618374e-05,
      2.4768444881825464e-05, 2.4767819093278486e-05, 2.4767193320542404e-05,
      2.4766567563616818e-05, 2.476594182250133e-05, 2.476531609719554e-05,
      2.4764690387699045e-05, 2.476406469401145e-05, 2.4763439016132353e-05,
      2.4762813354061356e-05, 2.476218770779806e-05, 2.4761562077342066e-05,
      2.4760936462692974e-05, 2.4760310863850385e-05, 2.4759685280813897e-05,
      2.4759059713583112e-05, 2.4758434162157634e-05, 2.4757808626537058e-05,
      2.475718310672099e-05, 2.4756557602709026e-05, 2.475593211450077e-05,
      2.4755306642095822e-05, 2.4754681185493785e-05, 2.4754055744694255e-05,
      2.4753430319696836e-05, 2.4752804910501125e-05, 2.4752179517106725e-05,
      2.475155413951324e-05, 2.475092877772027e-05, 2.475030343172741e-05,
      2.4749678101534264e-05, 2.4749052787140435e-05, 2.4748427488545523e-05,
      2.4747802205749127e-05, 2.474717693875085e-05, 2.474655168755029e-05,
      2.4745926452147052e-05, 2.4745301232540733e-05, 2.4744676028730936e-05,
      2.4744050840717262e-05, 2.474342566849931e-05, 2.4742800512076682e-05,
      2.474217537144898e-05, 2.47415502466158e-05, 2.4740925137576752e-05,
      2.474030004433143e-05, 2.4739674966879434e-05, 2.473904990522037e-05,
      2.4738424859353837e-05, 2.4737799829279434e-05, 2.4737174814996765e-05,
      2.473654981650543e-05, 2.473592483380503e-05, 2.4735299866895166e-05,
      2.473467491577544e-05, 2.473404998044545e-05, 2.4733425060904797e-05,
      2.4732800157153087e-05, 2.473217526918992e-05, 2.4731550397014892e-05,
      2.4730925540627607e-05, 2.4730300700027668e-05, 2.4729675875214675e-05,
      2.4729051066188228e-05, 2.4728426272947927e-05, 2.4727801495493376e-05,
      2.4727176733824175e-05, 2.4726551987939928e-05, 2.472592725784023e-05,
      2.472530254352469e-05, 2.47246778449929e-05, 2.472405316224447e-05,
      2.4723428495278997e-05, 2.4722803844096082e-05, 2.4722179208695326e-05,
      2.4721554589076332e-05, 2.47209299852387e-05, 2.472030539718203e-05,
      2.4719680824905928e-05, 2.471905626840999e-05, 2.471843172769382e-05,
      2.471780720275702e-05, 2.471718269359919e-05, 2.471655820021993e-05,
      2.4715933722618842e-05, 2.471530926079553e-05, 2.4714684814749593e-05,
      2.4714060384480633e-05, 2.4713435969988252e-05, 2.471281157127205e-05,
      2.4712187188331628e-05, 2.471156282116659e-05, 2.4710938469776536e-05,
      2.471031413416107e-05, 2.4709689814319788e-05, 2.4709065510252293e-05,
      2.4708441221958188e-05, 2.4707816949437077e-05, 2.4707192692688556e-05,
      2.470656845171223e-05, 2.47059442265077e-05, 2.4705320017074568e-05,
      2.4704695823412434e-05, 2.4704071645520902e-05, 2.4703447483399572e-05,
      2.4702823337048043e-05, 2.470219920646592e-05, 2.4701575091652803e-05,
      2.4700950992608295e-05, 2.4700326909331996e-05, 2.4699702841823507e-05,
      2.469907879008243e-05, 2.4698454754108373e-05, 2.4697830733900928e-05,
      2.4697206729459703e-05, 2.4696582740784296e-05, 2.469595876787431e-05,
      2.469533481072935e-05, 2.4694710869349013e-05, 2.46940869437329e-05,
      2.469346303388062e-05, 2.4692839139791765e-05, 2.4692215261465943e-05,
      2.4691591398902755e-05, 2.4690967552101802e-05, 2.4690343721062686e-05,
      2.4689719905785006e-05, 2.4689096106268367e-05, 2.468847232251237e-05,
      2.468784855451662e-05, 2.4687224802280712e-05, 2.4686601065804253e-05,
      2.468597734508684e-05, 2.468535364012808e-05, 2.4684729950927576e-05,
      2.4684106277484923e-05, 2.468348261979973e-05, 2.4682858977871595e-05,
      2.468223535170012e-05, 2.4681611741284907e-05, 2.4680988146625557e-05,
      2.4680364567721675e-05, 2.467974100457286e-05, 2.4679117457178714e-05,
      2.4678493925538843e-05, 2.4677870409652842e-05, 2.467724690952032e-05,
      2.4676623425140876e-05, 2.467599995651411e-05, 2.4675376503639626e-05,
      2.4674753066517027e-05, 2.4674129645145915e-05, 2.467350623952589e-05,
      2.4672882849656557e-05, 2.4672259475537512e-05, 2.4671636117168365e-05,
      2.467101277454871e-05, 2.4670389447678156e-05, 2.4669766136556303e-05,
      2.466914284118275e-05, 2.4668519561557102e-05, 2.4667896297678962e-05,
      2.466727304954793e-05, 2.466664981716361e-05, 2.4666026600525602e-05,
      2.466540339963351e-05, 2.4664780214486933e-05, 2.466415704508548e-05,
      2.4663533891428745e-05, 2.4662910753516334e-05, 2.466228763134785e-05,
      2.4661664524922895e-05, 2.466104143424107e-05, 2.466041835930198e-05,
      2.4659795300105224e-05, 2.4659172256650406e-05, 2.4658549228937127e-05,
      2.465792621696499e-05, 2.4657303220733598e-05, 2.465668024024255e-05,
      2.4656057275491454e-05, 2.465543432647991e-05, 2.4654811393207517e-05,
      2.465418847567388e-05, 2.4653565573878603e-05, 2.4652942687821284e-05,
      2.465231981750153e-05, 2.465169696291894e-05, 2.4651074124073116e-05,
      2.4650451300963664e-05, 2.4649828493590184e-05, 2.4649205701952278e-05,
      2.464858292604955e-05, 2.4647960165881603e-05, 2.4647337421448038e-05,
      2.4646714692748458e-05, 2.4646091979782465e-05, 2.464546928254966e-05,
      2.464484660104965e-05, 2.4644223935282034e-05, 2.4643601285246414e-05,
      2.4642978650942395e-05, 2.4642356032369577e-05, 2.4641733429527563e-05,
      2.4641110842415958e-05, 2.4640488271034364e-05, 2.4639865715382382e-05,
      2.4639243175459616e-05, 2.4638620651265665e-05, 2.4637998142800137e-05,
      2.4637375650062632e-05, 2.463675317305275e-05, 2.4636130711770098e-05,
      2.4635508266214276e-05, 2.463488583638489e-05, 2.4634263422281535e-05,
      2.463364102390382e-05, 2.463301864125135e-05, 2.4632396274323723e-05,
      2.463177392312054e-05, 2.463115158764141e-05, 2.4630529267885933e-05,
      2.4629906963853708e-05, 2.4629284675544342e-05, 2.4628662402957435e-05,
      2.4628040146092592e-05, 2.4627417904949415e-05, 2.462679567952751e-05,
      2.4626173469826473e-05, 2.462555127584591e-05, 2.4624929097585427e-05,
      2.4624306935044624e-05, 2.4623684788223103e-05, 2.4623062657120467e-05,
      2.462244054173632e-05, 2.4621818442070264e-05, 2.4621196358121905e-05
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      1.2632778318671395e-05, 2.5265237463166694e-05, 2.5264599122878615e-05, 2.526396079871856e-05,
      2.5263322490686118e-05, 2.5262684198780883e-05, 2.5262045923002447e-05,
      2.5261407663350404e-05, 2.5260769419824347e-05, 2.526013119242387e-05,
      2.5259492981148562e-05, 2.5258854785998017e-05, 2.5258216606971828e-05,
      2.525757844406959e-05, 2.525694029729089e-05, 2.5256302166635324e-05,
      2.5255664052102485e-05, 2.5255025953691966e-05, 2.5254387871403357e-05,
      2.525374980523625e-05, 2.5253111755190243e-05, 2.5252473721264925e-05,
      2.5251835703459887e-05, 2.5251197701774727e-05, 2.5250559716209033e-05,
      2.52499217467624e-05, 2.5249283793434423e-05, 2.524864585622469e-05,
      2.5248007935132792e-05, 2.524737003015833e-05, 2.524673214130089e-05,
      2.5246094268560065e-05, 2.5245456411935453e-05, 2.5244818571426643e-05,
      2.5244180747033227e-05, 2.52435429387548e-05, 2.5242905146590953e-05,
      2.5242267370541282e-05, 2.524162961060538e-05, 2.5240991866782835e-05,
      2.5240354139073242e-05, 2.5239716427476195e-05, 2.5239078731991287e-05,
      2.523844105261811e-05, 2.523780338935626e-05, 2.5237165742205326e-05,
      2.52365281111649e-05, 2.523589049623458e-05, 2.5235252897413956e-05,
      2.523461531470262e-05, 2.5233977748100166e-05, 2.5233340197606187e-05,
      2.5232702663220278e-05, 2.5232065144942028e-05, 2.523142764277103e-05,
      2.5230790156706884e-05, 2.5230152686749177e-05, 2.5229515232897503e-05,
      2.5228877795151456e-05, 2.5228240373510626e-05, 2.522760296797461e-05,
      2.5226965578543e-05, 2.5226328205215388e-05, 2.522569084799137e-05,
      2.5225053506870535e-05, 2.5224416181852477e-05, 2.522377887293679e-05,
      2.5223141580123072e-05, 2.522250430341091e-05, 2.5221867042799897e-05,
      2.5221229798289628e-05, 2.5220592569879696e-05, 2.5219955357569696e-05,
      2.521931816135922e-05, 2.521868098124786e-05, 2.521804381723521e-05,
      2.5217406669320864e-05, 2.5216769537504415e-05, 2.5216132421785455e-05,
      2.521549532216358e-05, 2.521485823863838e-05, 2.521422117120945e-05,
      2.5213584119876383e-05, 2.5212947084638774e-05, 2.5212310065496213e-05,
      2.5211673062448298e-05, 2.521103607549462e-05, 2.521039910463477e-05,
      2.520976214986834e-05, 2.520912521119493e-05, 2.520848828861413e-05,
      2.5207851382125533e-05, 2.5207214491728735e-05, 2.5206577617423326e-05,
      2.52059407592089e-05, 2.520530391708505e-05, 2.5204667091051376e-05,
      2.5204030281107464e-05, 2.520339348725291e-05, 2.5202756709487304e-05,
      2.5202119947810243e-05, 2.5201483202221323e-05, 2.5200846472720133e-05,
      2.5200209759306268e-05, 2.5199573061979323e-05, 2.519893638073889e-05,
      2.5198299715584563e-05, 2.5197663066515935e-05, 2.51970264335326e-05,
      2.5196389816634153e-05, 2.5195753215820185e-05, 2.5195116631090292e-05,
      2.5194480062444068e-05, 2.5193843509881102e-05, 2.519320697340099e-05,
      2.5192570453003328e-05, 2.5191933948687708e-05, 2.5191297460453723e-05,
      2.519066098830097e-05, 2.519002453222904e-05, 2.5189388092237524e-05,
      2.5188751668326022e-05, 2.5188115260494122e-05, 2.518747886874142e-05,
      2.5186842493067513e-05, 2.5186206133471992e-05, 2.518556978995445e-05,
      2.518493346251448e-05, 2.5184297151151678e-05, 2.5183660855865635e-05,
      2.5183024576655946e-05, 2.5182388313522207e-05, 2.5181752066464008e-05,
      2.5181115835480945e-05, 2.5180479620572614e-05, 2.5179843421738606e-05,
      2.5179207238978515e-05, 2.5178571072291935e-05, 2.5177934921678462e-05,
      2.5177298787137687e-05, 2.5176662668669206e-05, 2.5176026566272613e-05,
      2.51753904799475e-05, 2.5174754409693464e-05, 2.5174118355510095e-05,
      2.517348231739699e-05, 2.517284629535374e-05, 2.5172210289379943e-05,
      2.517157429947519e-05, 2.5170938325639076e-05, 2.5170302367871197e-05,
      2.5169666426171144e-05, 2.5169030500538512e-05, 2.5168394590972896e-05,
      2.516775869747389e-05, 2.5167122820041086e-05, 2.5166486958674077e-05,
      2.516585111337246e-05, 2.5165215284135832e-05, 2.5164579470963782e-05,
      2.5163943673855905e-05, 2.5163307892811794e-05, 2.5162672127831047e-05,
      2.5162036378913256e-05, 2.5161400646058015e-05, 2.5160764929264918e-05,
      2.516012922853356e-05, 2.5159493543863534e-05, 2.5158857875254435e-05,
      2.515822222270586e-05, 2.5157586586217398e-05, 2.5156950965788647e-05,
      2.51563153614192e-05, 2.515567977310865e-05, 2.5155044200856593e-05,
      2.5154408644662623e-05, 2.5153773104526335e-05, 2.515313758044732e-05,
      2.5152502072425175e-05, 2.5151866580459494e-05, 2.5151231104549872e-05,
      2.51505956446959e-05, 2.514996020089718e-05, 2.51493247731533e-05,
      2.5148689361463855e-05, 2.514805396582844e-05, 2.514741858624665e-05,
      2.5146783222718075e-05, 2.5146147875242317e-05, 2.5145512543818965e-05,
      2.5144877228447616e-05, 2.5144241929127863e-05, 2.51436066458593e-05,
      2.5142971378641522e-05, 2.5142336127474125e-05, 2.51417008923567e-05,
      2.5141065673288848e-05, 2.5140430470270157e-05, 2.5139795283300224e-05,
      2.5139160112378645e-05, 2.5138524957505013e-05, 2.513788981867892e-05,
      2.5137254695899967e-05, 2.513661958916774e-05, 2.513598449848184e-05,
      2.513534942384186e-05, 2.5134714365247393e-05, 2.5134079322698035e-05,
      2.513344429619338e-05, 2.5132809285733025e-05, 2.513217429131656e-05,
      2.5131539312943585e-05, 2.513090435061369e-05, 2.5130269404326475e-05,
      2.512963447408153e-05, 2.512899955987845e-05, 2.5128364661716832e-05,
      2.512772977959627e-05, 2.5127094913516356e-05, 2.5126460063476688e-05,
      2.512582522947686e-05, 2.5125190411516464e-05, 2.5124555609595098e-05,
      2.5123920823712358e-05, 2.5123286053867835e-05, 2.5122651300061125e-05,
      2.5122016562291826e-05, 2.512138184055953e-05, 2.512074713486383e-05,
      2.5120112445204325e-05, 2.5119477771580607e-05, 2.511884311399227e-05,
      2.511820847243891e-05, 2.511757384692012e-05, 2.51169392374355e-05,
      2.511630464398464e-05, 2.511567006656714e-05, 2.5115035505182588e-05,
      2.5114400959830585e-05, 2.5113766430510723e-05, 2.5113131917222597e-05,
      2.5112497419965802e-05, 2.5111862938739933e-05, 2.5111228473544585e-05,
      2.5110594024379357e-05, 2.5109959591243837e-05, 2.5109325174137623e-05,
      2.510869077306031e-05, 2.5108056388011496e-05, 2.5107422018990773e-05,
      2.5106787665997737e-05, 2.510615332903198e-05, 2.51055190080931e-05,
      2.510488470318069e-05, 2.510425041429435e-05, 2.510361614143367e-05,
      2.5102981884598247e-05, 2.5102347643787677e-05, 2.5101713419001554e-05,
      2.510107921023947e-05, 2.5100445017501026e-05, 2.5099810840785815e-05,
      2.5099176680093432e-05, 2.5098542535423473e-05, 2.5097908406775532e-05,
      2.5097274294149203e-05, 2.509664019754408e-05, 2.5096006116959764e-05,
      2.5095372052395846e-05, 2.5094738003851922e-05, 2.5094103971327588e-05,
      2.5093469954822438e-05, 2.5092835954336067e-05, 2.5092201969868072e-05,
      2.509156800141805e-05, 2.5090934048985593e-05, 2.5090300112570295e-05,
      2.5089666192171754e-05, 2.5089032287789565e-05, 2.5088398399423323e-05,
      2.5087764527072623e-05, 2.508713067073706e-05, 2.508649683041623e-05,
      2.5085863006109732e-05, 2.5085229197817156e-05, 2.50845954055381e-05,
      2.508396162927216e-05, 2.508332786901893e-05, 2.5082694124778002e-05,
      2.5082060396548976e-05, 2.5081426684331448e-05, 2.508079298812501e-05,
      2.5080159307929262e-05, 2.5079525643743794e-05, 2.5078891995568205e-05,
      2.507825836340209e-05, 2.5077624747245044e-05, 2.5076991147096663e-05,
      2.5076357562956543e-05, 2.507572399482428e-05, 2.507509044269947e-05,
      2.5074456906581703e-05, 2.507382338647058e-05, 2.5073189882365696e-05,
      2.5072556394266645e-05, 2.5071922922173023e-05, 2.5071289466084428e-05,
      2.5070656026000452e-05, 2.5070022601920693e-05, 2.5069389193844748e-05,
      2.506875580177221e-05, 2.5068122425702674e-05, 2.5067489065635736e-05,
      2.5066855721570992e-05, 2.506622239350804e-05, 2.5065589081446473e-05,
      2.5064955785385888e-05, 2.506432250532588e-05, 2.5063689241266048e-05,
      2.5063055993205983e-05, 2.5062422761145283e-05, 2.5061789545083545e-05,
      2.506115634502036e-05, 2.506052316095533e-05, 2.5059889992888047e-05,
      2.5059256840818106e-05, 2.5058623704745107e-05, 2.505799058466864e-05,
      2.5057357480588308e-05, 2.50567243925037e-05, 2.5056091320414415e-05,
      2.505545826432005e-05, 2.50548252242202e-05, 2.505419220011446e-05,
      2.5053559192002428e-05, 2.5052926199883695e-05, 2.5052293223757863e-05,
      2.5051660263624524e-05, 2.5051027319483276e-05, 2.5050394391333714e-05,
      2.5049761479175434e-05, 2.504912858300803e-05, 2.5048495702831103e-05,
      2.5047862838644245e-05, 2.5047229990447052e-05, 2.504659715823912e-05,
      2.5045964342020048e-05, 2.504533154178943e-05, 2.504469875754686e-05,
      2.5044065989291938e-05, 2.504343323702426e-05, 2.5042800500743415e-05,
      2.5042167780449007e-05, 2.5041535076140628e-05, 2.504090238781788e-05,
      2.504026971548035e-05, 2.503963705912764e-05, 2.5039004418759346e-05,
      2.5038371794375062e-05, 2.5037739185974387e-05, 2.5037106593556916e-05,
      2.503647401712224e-05, 2.5035841456669964e-05, 2.5035208912199677e-05,
      2.503457638371098e-05, 2.5033943871203468e-05, 2.5033311374676737e-05,
      2.503267889413038e-05, 2.5032046429563997e-05, 2.5031413980977182e-05,
      2.5030781548369536e-05, 2.503014913174065e-05, 2.5029516731090124e-05,
      2.502888434641755e-05, 2.5028251977722526e-05, 2.5027619625004652e-05,
      2.502698728826352e-05, 2.5026354967498728e-05, 2.502572266270987e-05,
      2.5025090373896546e-05, 2.502445810105835e-05, 2.5023825844194883e-05,
      2.5023193603305734e-05, 2.5022561378390505e-05, 2.502192916944879e-05,
      2.5021296976480184e-05, 2.5020664799484286e-05, 2.502003263846069e-05,
      2.5019400493408997e-05, 2.50187683643288e-05, 2.5018136251219698e-05,
      2.5017504154081283e-05, 2.5016872072913156e-05, 2.501624000771491e-05,
      2.5015607958486143e-05, 2.501497592522645e-05, 2.5014343907935432e-05,
      2.5013711906612683e-05, 2.50130799212578e-05, 2.5012447951870374e-05,
      2.5011815998450008e-05, 2.5011184060996298e-05, 2.501055213950884e-05,
      2.5009920233987228e-05, 2.5009288344431062e-05, 2.5008656470839936e-05,
      2.500802461321345e-05, 2.5007392771551197e-05, 2.5006760945852778e-05,
      2.5006129136117785e-05, 2.5005497342345816e-05, 2.500486556453647e-05,
      2.5004233802689343e-05, 2.500360205680403e-05, 2.5002970326880127e-05,
      2.5002338612917232e-05, 2.500170691491494e-05, 2.5001075232872852e-05,
      2.500044356679056e-05, 2.499981191666767e-05, 2.499918028250377e-05,
      2.4998548664298456e-05, 2.499791706205133e-05, 2.4997285475761985e-05,
      2.499665390543002e-05, 2.499602235105503e-05, 2.4995390812636614e-05,
      2.4994759290174366e-05, 2.4994127783667885e-05, 2.4993496293116767e-05,
      2.499286481852061e-05, 2.4992233359879008e-05, 2.499160191719156e-05,
      2.4990970490457867e-05, 2.499033907967752e-05, 2.4989707684850117e-05,
      2.4989076305975255e-05, 2.4988444943052534e-05, 2.4987813596081548e-05,
      2.4987182265061892e-05, 2.498655094999317e-05, 2.498591965087497e-05,
      2.4985288367706896e-05, 2.4984657100488544e-05, 2.4984025849219507e-05,
      2.4983394613899386e-05, 2.4982763394527777e-05, 2.4982132191104277e-05,
      2.4981501003628483e-05, 2.4980869832099992e-05, 2.49802386765184e-05,
      2.4979607536883305e-05, 2.4978976413194303e-05, 2.4978345305450995e-05,
      2.4977714213652973e-05, 2.4977083137799838e-05, 2.4976452077891187e-05,
      2.4975821033926614e-05, 2.4975190005905717e-05, 2.4974558993828095e-05,
      2.4973927997693344e-05, 2.4973297017501065e-05, 2.497266605325085e-05,
      2.4972035104942296e-05, 2.4971404172575005e-05, 2.497077325614857e-05,
      2.497014235566259e-05, 2.496951147111666e-05, 2.496888060251038e-05,
      2.496824974984335e-05, 2.496761891311516e-05, 2.4966988092325413e-05,
      2.4966357287473703e-05, 2.496572649855963e-05, 2.496509572558279e-05,
      2.496446496854278e-05, 2.4963834227439198e-05, 2.4963203502271642e-05,
      2.4962572793039707e-05, 2.4961942099742992e-05, 2.4961311422381095e-05,
      2.4960680760953612e-05, 2.496005011546014e-05, 2.495941948590028e-05,
      2.4958788872273624e-05, 2.4958158274579773e-05, 2.4957527692818324e-05,
      2.4956897126988874e-05, 2.4956266577091022e-05, 2.4955636043124362e-05,
      2.4955005525088495e-05, 2.4954375022983017e-05, 2.4953744536807525e-05,
      2.495311406656162e-05, 2.4952483612244893e-05, 2.4951853173856947e-05,
      2.4951222751397377e-05, 2.495059234486578e-05, 2.494996195426176e-05,
      2.4949331579584906e-05, 2.4948701220834818e-05, 2.4948070878011097e-05,
      2.4947440551113338e-05, 2.494681024014114e-05, 2.4946179945094098e-05,
      2.4945549665971812e-05, 2.4944919402773878e-05, 2.4944289155499895e-05,
      2.494365892414946e-05, 2.4943028708722172e-05, 2.4942398509217625e-05,
      2.494176832563542e-05, 2.4941138157975156e-05, 2.4940508006236427e-05,
      2.4939877870418834e-05, 2.493924775052197e-05, 2.4938617646545438e-05,
      2.4937987558488834e-05, 2.4937357486351755e-05, 2.49367274301338e-05,
      2.4936097389834563e-05, 2.4935467365453648e-05, 2.493483735699065e-05,
      2.4934207364445167e-05, 2.4933577387816795e-05, 2.4932947427105134e-05,
      2.493231748230978e-05, 2.4931687553430333e-05, 2.493105764046639e-05,
      2.4930427743417546e-05, 2.4929797862283404e-05, 2.4929167997063558e-05,
      2.4928538147757607e-05, 2.492790831436515e-05, 2.4927278496885784e-05,
      2.4926648695319108e-05, 2.492601890966472e-05, 2.4925389139922216e-05,
      2.4924759386091194e-05, 2.4924129648171255e-05, 2.4923499926161993e-05,
      2.4922870220063008e-05, 2.49222405298739e-05, 2.4921610855594264e-05,
      2.49209811972237e-05, 2.4920351554761805e-05, 2.4919721928208176e-05,
      2.4919092317562415e-05, 2.4918462722824115e-05, 2.4917833143992878e-05,
      2.49172035810683e-05, 2.491657403404998e-05, 2.4915944502937515e-05,
      2.4915314987730504e-05, 2.4914685488428545e-05, 2.4914056005031236e-05,
      2.4913426537538176e-05, 2.4912797085948963e-05, 2.4912167650263194e-05,
      2.4911538230480468e-05, 2.4910908826600382e-05, 2.4910279438622537e-05,
      2.490965006654653e-05, 2.490902071037196e-05, 2.490839137009842e-05,
      2.4907762045725517e-05, 2.4907132737252844e-05, 2.490650344468e-05,
      2.490587416800658e-05, 2.4905244907232186e-05, 2.4904615662356417e-05,
      2.490398643337887e-05, 2.4903357220299143e-05, 2.4902728023116835e-05,
      2.4902098841831543e-05, 2.4901469676442867e-05, 2.4900840526950404e-05,
      2.4900211393353755e-05, 2.4899582275652516e-05, 2.4898953173846287e-05,
      2.4898324087934665e-05, 2.4897695017917247e-05, 2.4897065963793634e-05,
      2.4896436925563424e-05, 2.4895807903226216e-05, 2.4895178896781606e-05,
      2.4894549906229194e-05, 2.4893920931568577e-05, 2.4893291972799355e-05,
      2.489266302992113e-05, 2.4892034102933495e-05, 2.489140519183605e-05,
      2.4890776296628394e-05, 2.4890147417310124e-05, 2.488951855388084e-05,
      2.4888889706340143e-05, 2.488826087468763e-05, 2.4887632058922894e-05,
      2.488700325904554e-05, 2.4886374475055167e-05, 2.488574570695137e-05,
      2.4885116954733753e-05, 2.488448821840191e-05, 2.4883859497955435e-05,
      2.4883230793393937e-05, 2.4882602104717006e-05, 2.4881973431924247e-05,
      2.4881344775015257e-05, 2.4880716133989632e-05, 2.4880087508846973e-05,
      2.4879458899586876e-05, 2.4878830306208945e-05, 2.4878201728712773e-05,
      2.487757316709796e-05, 2.4876944621364108e-05, 2.4876316091510815e-05,
      2.487568757753768e-05, 2.4875059079444297e-05, 2.487443059723027e-05,
      2.4873802130895194e-05, 2.487317368043867e-05, 2.4872545245860297e-05,
      2.4871916827159676e-05, 2.4871288424336402e-05, 2.4870660037390073e-05,
      2.4870031666320293e-05, 2.4869403311126658e-05, 2.4868774971808765e-05,
      2.4868146648366214e-05, 2.4867518340798605e-05, 2.4866890049105536e-05,
      2.4866261773286606e-05, 2.4865633513341416e-05, 2.4865005269269562e-05,
      2.4864377041070645e-05, 2.486374882874426e-05, 2.4863120632290014e-05,
      2.4862492451707498e-05, 2.4861864286996316e-05, 2.4861236138156065e-05,
      2.4860608005186344e-05, 2.4859979888086752e-05, 2.4859351786856888e-05,
      2.4858723701496352e-05, 2.485809563200474e-05, 2.4857467578381656e-05,
      2.4856839540626696e-05, 2.4856211518739458e-05, 2.4855583512719543e-05,
      2.485495552256655e-05, 2.4854327548280077e-05, 2.4853699589859724e-05,
      2.485307164730509e-05, 2.4852443720615774e-05, 2.4851815809791374e-05,
      2.4851187914831492e-05, 2.4850560035735727e-05, 2.4849932172503676e-05,
      2.484930432513494e-05, 2.4848676493629113e-05, 2.4848048677985803e-05,
      2.4847420878204603e-05, 2.4846793094285116e-05, 2.4846165326226937e-05,
      2.4845537574029667e-05, 2.4844909837692906e-05, 2.4844282117216254e-05,
      2.4843654412599308e-05, 2.484302672384167e-05, 2.4842399050942935e-05,
      2.4841771393902708e-05, 2.4841143752720585e-05, 2.4840516127396165e-05,
      2.483988851792905e-05, 2.4839260924318834e-05, 2.4838633346565123e-05,
      2.4838005784667513e-05, 2.4837378238625604e-05, 2.4836750708438993e-05,
      2.4836123194107284e-05, 2.4835495695630073e-05, 2.483486821300696e-05,
      2.4834240746237544e-05, 2.4833613295321426e-05, 2.4832985860258204e-05,
      2.483235844104748e-05, 2.483173103768885e-05, 2.4831103650181916e-05,
      2.4830476278526276e-05, 2.482984892272153e-05, 2.4829221582767277e-05,
      2.4828594258663118e-05, 2.482796695040865e-05, 2.4827339658003476e-05,
      2.4826712381447193e-05, 2.4826085120739402e-05, 2.48254578758797e-05,
      2.4824830646867693e-05, 2.4824203433702973e-05, 2.4823576236385142e-05,
      2.4822949054913803e-05, 2.4822321889288553e-05, 2.482169473950899e-05,
      2.4821067605574715e-05, 2.4820440487485327e-05, 2.4819813385240428e-05,
      2.4819186298839617e-05, 2.4818559228282492e-05, 2.4817932173568654e-05,
      2.4817305134697704e-05, 2.4816678111669238e-05, 2.481605110448286e-05,
      2.4815424113138166e-05, 2.4814797137634756e-05, 2.4814170177972232e-05,
      2.4813543234150193e-05, 2.481291630616824e-05, 2.481228939402597e-05,
      2.4811662497722985e-05, 2.4811035617258885e-05, 2.4810408752633267e-05,
      2.4809781903845733e-05, 2.480915507089588e-05, 2.4808528253783314e-05,
      2.480790145250763e-05, 2.480727466706843e-05, 2.4806647897465312e-05,
      2.4806021143697876e-05, 2.4805394405765724e-05, 2.4804767683668454e-05,
      2.4804140977405668e-05, 2.4803514286976964e-05, 2.480288761238194e-05,
      2.48022609536202e-05, 2.4801634310691346e-05, 2.4801007683594973e-05,
      2.4800381072330683e-05, 2.4799754476898072e-05, 2.4799127897296745e-05,
      2.47985013335263e-05, 2.479787478558634e-05, 2.4797248253476458e-05,
      2.479662173719626e-05, 2.4795995236745347e-05, 2.4795368752123314e-05,
      2.4794742283329766e-05, 2.47941158303643e-05, 2.4793489393226517e-05,
      2.4792862971916016e-05, 2.4792236566432397e-05, 2.4791610176775263e-05,
      2.4790983802944212e-05, 2.4790357444938843e-05, 2.478973110275876e-05,
      2.478910477640356e-05, 2.4788478465872842e-05, 2.478785217116621e-05,
      2.4787225892283264e-05, 2.47865996292236e-05, 2.4785973381986823e-05,
      2.478534715057253e-05, 2.4784720934980322e-05, 2.47840947352098e-05,
      2.4783468551260565e-05, 2.4782842383132214e-05, 2.478221623082435e-05,
      2.4781590094336573e-05, 2.4780963973668484e-05, 2.478033786881968e-05,
      2.4779711779789766e-05, 2.4779085706578337e-05, 2.4778459649185e-05,
      2.4777833607609346e-05, 2.4777207581850984e-05, 2.477658157190951e-05,
      2.477595557778453e-05, 2.4775329599475635e-05, 2.477470363698243e-05,
      2.4774077690304518e-05, 2.4773451759441496e-05, 2.4772825844392965e-05,
      2.477219994515853e-05, 2.4771574061737786e-05, 2.4770948194130334e-05,
      2.4770322342335775e-05, 2.476969650635371e-05, 2.476907068618374e-05,
      2.4768444881825464e-05, 2.4767819093278486e-05, 2.4767193320542404e-05,
      2.4766567563616818e-05, 2.476594182250133e-05, 2.476531609719554e-05,
      2.4764690387699045e-05, 2.476406469401145e-05, 2.4763439016132353e-05,
      2.4762813354061356e-05, 2.476218770779806e-05, 2.4761562077342066e-05,
      2.4760936462692974e-05, 2.4760310863850385e-05, 2.4759685280813897e-05,
      2.4759059713583112e-05, 2.4758434162157634e-05, 2.4757808626537058e-05,
      2.475718310672099e-05, 2.4756557602709026e-05, 2.475593211450077e-05,
      2.4755306642095822e-05, 2.4754681185493785e-05, 2.4754055744694255e-05,
      2.4753430319696836e-05, 2.4752804910501125e-05, 2.4752179517106725e-05,
      2.475155413951324e-05, 2.475092877772027e-05, 2.475030343172741e-05,
      2.4749678101534264e-05, 2.4749052787140435e-05, 2.4748427488545523e-05,
      2.4747802205749127e-05, 2.474717693875085e-05, 2.474655168755029e-05,
      2.4745926452147052e-05, 2.4745301232540733e-05, 2.4744676028730936e-05,
      2.4744050840717262e-05, 2.474342566849931e-05, 2.4742800512076682e-05,
      2.474217537144898e-05, 2.47415502466158e-05, 2.4740925137576752e-05,
      2.474030004433143e-05, 2.4739674966879434e-05, 2.473904990522037e-05,
      2.4738424859353837e-05, 2.4737799829279434e-05, 2.4737174814996765e-05,
      2.473654981650543e-05, 2.473592483380503e-05, 2.4735299866895166e-05,
      2.473467491577544e-05, 2.473404998044545e-05, 2.4733425060904797e-05,
      2.4732800157153087e-05, 2.473217526918992e-05, 2.4731550397014892e-05,
      2.4730925540627607e-05, 2.4730300700027668e-05, 2.4729675875214675e-05,
      2.4729051066188228e-05, 2.4728426272947927e-05, 2.4727801495493376e-05,
      2.4727176733824175e-05, 2.4726551987939928e-05, 2.472592725784023e-05,
      2.472530254352469e-05, 2.47246778449929e-05, 2.472405316224447e-05,
      2.4723428495278997e-05, 2.4722803844096082e-05, 2.4722179208695326e-05,
      2.4721554589076332e-05, 2.47209299852387e-05, 2.472030539718203e-05,
      2.4719680824905928e-05, 2.471905626840999e-05, 2.471843172769382e-05,
      2.471780720275702e-05, 2.471718269359919e-05, 2.471655820021993e-05,
      2.4715933722618842e-05, 2.471530926079553e-05, 2.4714684814749593e-05,
      2.4714060384480633e-05, 2.4713435969988252e-05, 2.471281157127205e-05,
      2.4712187188331628e-05, 2.471156282116659e-05, 2.4710938469776536e-05,
      2.471031413416107e-05, 2.4709689814319788e-05, 2.4709065510252293e-05,
      2.4708441221958188e-05, 2.4707816949437077e-05, 2.4707192692688556e-05,
      2.470656845171223e-05, 2.47059442265077e-05, 2.4705320017074568e-05,
      2.4704695823412434e-05, 2.4704071645520902e-05, 2.4703447483399572e-05,
      2.4702823337048043e-05, 2.470219920646592e-05, 2.4701575091652803e-05,
      2.4700950992608295e-05, 2.4700326909331996e-05, 2.4699702841823507e-05,
      2.469907879008243e-05, 2.4698454754108373e-05, 2.4697830733900928e-05,
      2.4697206729459703e-05, 2.4696582740784296e-05, 2.469595876787431e-05,
      2.469533481072935e-05, 2.4694710869349013e-05, 2.46940869437329e-05,
      2.469346303388062e-05, 2.4692839139791765e-05, 2.4692215261465943e-05,
      2.4691591398902755e-05, 2.4690967552101802e-05, 2.4690343721062686e-05,
      2.4689719905785006e-05, 2.4689096106268367e-05, 2.468847232251237e-05,
      2.468784855451662e-05, 2.4687224802280712e-05, 2.4686601065804253e-05,
      2.468597734508684e-05, 2.468535364012808e-05, 2.4684729950927576e-05,
      2.4684106277484923e-05, 2.468348261979973e-05, 2.4682858977871595e-05,
      2.468223535170012e-05, 2.4681611741284907e-05, 2.4680988146625557e-05,
      2.4680364567721675e-05, 2.467974100457286e-05, 2.4679117457178714e-05,
      2.4678493925538843e-05, 2.4677870409652842e-05, 2.467724690952032e-05,
      2.4676623425140876e-05, 2.467599995651411e-05, 2.4675376503639626e-05,
      2.4674753066517027e-05, 2.4674129645145915e-05, 2.467350623952589e-05,
      2.4672882849656557e-05, 2.4672259475537512e-05, 2.4671636117168365e-05,
      2.467101277454871e-05, 2.4670389447678156e-05, 2.4669766136556303e-05,
      2.466914284118275e-05, 2.4668519561557102e-05, 2.4667896297678962e-05,
      2.466727304954793e-05, 2.466664981716361e-05, 2.4666026600525602e-05,
      2.466540339963351e-05, 2.4664780214486933e-05, 2.466415704508548e-05,
      2.4663533891428745e-05, 2.4662910753516334e-05, 2.466228763134785e-05,
      2.4661664524922895e-05, 2.466104143424107e-05, 2.466041835930198e-05,
      2.4659795300105224e-05, 2.4659172256650406e-05, 2.4658549228937127e-05,
      2.465792621696499e-05, 2.4657303220733598e-05, 2.465668024024255e-05,
      2.4656057275491454e-05, 2.465543432647991e-05, 2.4654811393207517e-05,
      2.465418847567388e-05, 2.4653565573878603e-05, 2.4652942687821284e-05,
      2.465231981750153e-05, 2.465169696291894e-05, 2.4651074124073116e-05,
      2.4650451300963664e-05, 2.4649828493590184e-05, 2.4649205701952278e-05,
      2.464858292604955e-05, 2.4647960165881603e-05, 2.4647337421448038e-05,
      2.4646714692748458e-05, 2.4646091979782465e-05, 2.464546928254966e-05,
      2.464484660104965e-05, 2.4644223935282034e-05, 2.4643601285246414e-05,
      2.4642978650942395e-05, 2.4642356032369577e-05, 2.4641733429527563e-05,
      2.4641110842415958e-05, 2.4640488271034364e-05, 2.4639865715382382e-05,
      2.4639243175459616e-05, 2.4638620651265665e-05, 2.4637998142800137e-05,
      2.4637375650062632e-05, 2.463675317305275e-05, 2.4636130711770098e-05,
      2.4635508266214276e-05, 2.463488583638489e-05, 2.4634263422281535e-05,
      2.463364102390382e-05, 2.463301864125135e-05, 2.4632396274323723e-05,
      2.463177392312054e-05, 2.463115158764141e-05, 2.4630529267885933e-05,
      2.4629906963853708e-05, 2.4629284675544342e-05, 2.4628662402957435e-05,
      2.4628040146092592e-05, 2.4627417904949415e-05, 2.462679567952751e-05,
      2.4626173469826473e-05, 2.462555127584591e-05, 2.4624929097585427e-05,
      2.4624306935044624e-05, 2.4623684788223103e-05, 2.4623062657120467e-05,
      2.462244054173632e-05, 2.4621818442070264e-05, 2.4621196358121905e-05
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_2_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<2>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.00010293144153579262), "design.b()[0] == 0.00010293144153579262");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.00010293144153579262));
    static_assert(almost_equal(design.b()[1], -0.00019312780890404268), "design.b()[1] == -0.00019312780890404268");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.00019312780890404268));
    static_assert(almost_equal(design.b()[2], 0.00010293144153579265), "design.b()[2] == 0.00010293144153579265");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.00010293144153579265));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -1.994947092341058), "design.a()[1] == -1.994947092341058");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -1.994947092341058));
    static_assert(almost_equal(design.a()[2], 0.9949598274152255), "design.a()[2] == 0.9949598274152255");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.9949598274152255));
    std::cout << "max_deviation(cheby2,lowpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.00010293144153579262, 1.2214971098260428e-05, 2.4887013305244744e-05, 3.749486929454406e-05,
      5.003870201379196e-05, 6.251867440467891e-05, 7.493494940090717e-05,
      8.728768992615606e-05, 9.957705889205764e-05, 0.00011180321919618272,
      0.00012396633372003727, 0.00013606656532706902, 0.00014810407686068443,
      0.0001600790311422759, 0.00017199159096925907, 0.00018384191911312062,
      0.0001956301783174759, 0.00020735653129613687, 0.0002190211407311902,
      0.00023062416927108542, 0.00024216577952873298, 0.00025364613407961265,
      0.00026506539545989165, 0.0002764237261645529, 0.0002877212886455333,
      0.0002989582453098718, 0.00031013475851786733, 0.00032125099058124683,
      0.00033230710376134305, 0.000343303260267282, 0.0003542396222541803,
      0.0003651163518213526, 0.00037593361101052826, 0.0003866915618040779,
      0.00039739036612325, 0.0004080301858264167, 0.00041861118270732935,
      0.0004291335184933841, 0.00043959735484389636, 0.00045000285334838546,
      0.0004603501755248683, 0.000470639482818163, 0.00048087093659820193,
      0.0004910446981583538, 0.0005011609287137555, 0.0005112197893996535,
      0.0005212214412697544, 0.0005311660452945849, 0.000541053762359861,
      0.0005508847532648665, 0.0005606591787208409, 0.0005703771993493765,
      0.0005800389756808247, 0.0005896446681527115, 0.0005991944371081623,
      0.0006086884427943356, 0.0006181268453608658, 0.0006275098048583156,
      0.0006368374812366365, 0.0006461100343436395, 0.0006553276239234738,
      0.0006644904096151155, 0.0006735985509508638, 0.0006826522073548478,
      0.000691651538141541, 0.0007005967025142855, 0.0007094878595638242,
      0.0007183251682668422, 0.0007271087874845179, 0.0007358388759610811,
      0.0007445155923223813, 0.0007531390950744643, 0.0007617095426021571,
      0.0007702270931676625, 0.0007786919049091608, 0.0007871041358394218,
      0.0007954639438444238, 0.0008037714866819826, 0.0008120269219803881,
      0.0008202304072370498, 0.0008283820998171507, 0.0008364821569523096,
      0.0008445307357392523, 0.0008525279931384903, 0.0008604740859730087,
      0.0008683691709269625, 0.0008762134045443803, 0.0008840069432278778,
      0.0008917499432373776, 0.0008994425606888396, 0.0009070849515529979,
      0.0009146772716541062, 0.0009222196766686924, 0.0009297123221243196,
      0.0009371553633983572, 0.0009445489557167587, 0.0009518932541528481,
      0.0009591884136261143, 0.0009664345889010136, 0.0009736319345857803,
      0.0009807806051312447, 0.0009878807548296597, 0.0009949325378135355,
      0.0010019361080544813, 0.001008891619362056, 0.0010157992253826257,
      0.0010226590795982292, 0.0010294713353254529, 0.001036236145714311,
      0.001042953663747135, 0.0010496240422374714, 0.0010562474338289848,
      0.0010628239909943715, 0.0010693538660342787, 0.0010758372110762325,
      0.0010822741780735729, 0.001088664918804397, 0.0010950095848705087,
      0.0011013083276963768, 0.0011075612985281009, 0.0011137686484323835,
      0.0011199305282955114, 0.0011260470888223419, 0.0011321184805352996,
      0.001138144853773378, 0.00114412635869115, 0.001150063145257785,
      0.0011559553632560728, 0.0011618031622814566, 0.0011676066917410716,
      0.0011733661008527915, 0.001179081538644282, 0.0011847531539520616,
      0.0011903810954205698, 0.0011959655115012418, 0.001201506550451591,
      0.0012070043603342987, 0.0012124590890163099, 0.001217870884167937,
      0.00122323989326197, 0.0012285662635727942, 0.0012338501421755152,
      0.0012390916759450893, 0.0012442910115554625, 0.0012494482954787153,
      0.0012545636739842148, 0.001259637293137774, 0.0012646692988008176,
      0.0012696598366295545, 0.0012746090520741565, 0.0012795170903779458,
      0.0012843840965765867, 0.0012892102154972859, 0.001293995591757998,
      0.0012987403697666395, 0.0013034446937203075, 0.0013081087076045066,
      0.001312732555192381, 0.0013173163800439542, 0.001321860325505375,
      0.00132636453470817, 0.001330829150568502, 0.0013352543157864366,
      0.0013396401728452128, 0.0013439868640105213, 0.0013482945313297904,
      0.0013525633166314764, 0.0013567933615243608, 0.0013609848073968544,
      0.001365137795416308, 0.0013692524665283273, 0.0013733289614560973,
      0.00137736742069971, 0.0013813679845354999, 0.0013853307930153853,
      0.0013892559859662158, 0.0013931437029891267, 0.0013969940834588977,
      0.0014008072665233197, 0.001404583391102566, 0.001408322595888571,
      0.0014120250193444142, 0.0014156907997037104, 0.0014193200749700056,
      0.001422912982916179, 0.0014264696610838507, 0.0014299902467827974,
      0.0014334748770903705, 0.0014369236888509222, 0.0014403368186752376,
      0.0014437144029399722, 0.001447056577787095, 0.0014503634791233372,
      0.0014536352426196472, 0.001456872003710652, 0.0014600738975941224,
      0.001463241059230446, 0.0014663736233421045, 0.0014694717244131568,
      0.0014725354966887284, 0.001475565074174506, 0.001478560590636238,
      0.0014815221795992392, 0.0014844499743479039, 0.0014873441079252213,
      0.0014902047131322984, 0.0014930319225278884, 0.0014958258684279236,
      0.001498586682905054, 0.0015013144977881916, 0.0015040094446620608,
      0.0015066716548667524, 0.0015093012594972848, 0.0015118983894031688,
      0.001514463175187979, 0.0015169957472089312, 0.0015194962355764617,
      0.0015219647701538162, 0.0015244014805566408, 0.0015268064961525803,
      0.001529179946060879, 0.00153152195915199, 0.001533832664047187,
      0.0015361121891181826, 0.0015383606624867511, 0.0015405782120243565,
      0.001542764965351786, 0.0015449210498387881, 0.0015470465926037155,
      0.0015491417205131738, 0.0015512065601816743, 0.0015532412379712923,
      0.0015552458799913307, 0.001557220612097987, 0.0015591655598940271,
      0.001561080848728462, 0.0015629666036962313, 0.0015648229496378911,
      0.0015666500111393051, 0.0015684479125313427, 0.0015702167778895802,
      0.0015719567310340074, 0.0015736678955287394, 0.0015753503946817325,
      0.0015770043515445046, 0.001578629888911861, 0.0015802271293216246,
      0.0015817961950543703, 0.0015833372081331643, 0.001584850290323308,
      0.0015863355631320865, 0.001587793147808522, 0.0015892231653431314,
      0.0015906257364676874, 0.0015920009816549868, 0.0015933490211186194,
      0.0015946699748127457, 0.001595963962431875, 0.001597231103410651,
      0.0015984715169236404, 0.001599685321885125, 0.0016008726369489009,
      0.0016020335805080783, 0.0016031682706948898, 0.0016042768253804992,
      0.0016053593621748168, 0.001606415998426319, 0.0016074468512218703,
      0.001608452037386552, 0.0016094316734834926, 0.001610385875813705,
      0.001611314760415925, 0.0016122184430664576, 0.0016130970392790227,
      0.0016139506643046094, 0.0016147794331313318, 0.0016155834604842892,
      0.0016163628608254319, 0.0016171177483534282, 0.0016178482370035384,
      0.0016185544404474907, 0.001619236472093362, 0.001619894445085463,
      0.0016205284723042259, 0.0016211386663660971, 0.0016217251396234344,
      0.0016222880041644057, 0.0016228273718128946, 0.0016233433541284071,
      0.0016238360624059847, 0.0016243056076761186, 0.00162475210070467,
      0.0016251756519927935, 0.0016255763717768629, 0.0016259543700284029,
      0.0016263097564540227, 0.0016266426404953553, 0.001626953131328998,
      0.0016272413378664585, 0.0016275073687541037, 0.001627751332373113,
      0.001627973336839434, 0.0016281734900037428, 0.0016283518994514073,
      0.0016285086725024548, 0.0016286439162115417, 0.0016287577373679284,
      0.001628850242495457, 0.0016289215378525316, 0.0016289717294321045,
      0.0016290009229616626, 0.0016290092239032205, 0.001628996737453314,
      0.0016289635685430002, 0.001628909821837857, 0.0016288356017379903,
      0.0016287410123780415, 0.0016286261576271993, 0.0016284911410892149,
      0.0016283360661024208, 0.0016281610357397522, 0.0016279661528087722,
      0.0016277515198516999, 0.001627517239145442, 0.0016272634127016275,
      0.0016269901422666455, 0.0016266975293216864, 0.0016263856750827863,
      0.0016260546805008744, 0.0016257046462618235, 0.0016253356727865035,
      0.0016249478602308382, 0.0016245413084858655, 0.0016241161171778001,
      0.0016236723856681002, 0.001623210213053535, 0.0016227296981662584,
      0.0016222309395738832, 0.0016217140355795593, 0.0016211790842220546,
      0.0016206261832758396, 0.001620055430251174, 0.0016194669223941961,
      0.0016188607566870164, 0.0016182370298478124, 0.0016175958383309278,
      0.001616937278326974, 0.0016162614457629339, 0.001615568436302269,
      0.0016148583453450297, 0.0016141312680279679, 0.001613387299224652,
      0.0016126265335455858, 0.0016118490653383292, 0.0016110549886876222,
      0.0016102443974155113, 0.0016094173850814786, 0.0016085740449825732,
      0.0016077144701535473, 0.0016068387533669916, 0.0016059469871334761,
      0.0016050392637016924, 0.0016041156750585988, 0.0016031763129295688,
      0.0016022212687785396, 0.001601250633808167, 0.0016002644989599798,
      0.0015992629549145374, 0.001598246092091591, 0.0015972140006502466,
      0.0015961667704891302, 0.0015951044912465558, 0.0015940272523006964,
      0.0015929351427697563, 0.0015918282515121462, 0.001590706667126662,
      0.0015895704779526644, 0.0015884197720702612, 0.0015872546373004934,
      0.001586075161205521, 0.0015848814310888137, 0.0015836735339953426,
      0.0015824515567117745, 0.001581215585766669, 0.0015799657074306772,
      0.0015787020077167426, 0.0015774245723803046, 0.0015761334869195053,
      0.0015748288365753965, 0.0015735107063321499, 0.0015721791809172698,
      0.001570834344801808, 0.0015694762822005808, 0.0015681050770723864,
      0.001566720813120228, 0.0015653235737915364, 0.001563913442278395,
      0.001562490501517768, 0.0015610548341917295, 0.0015596065227276952,
      0.0015581456492986569, 0.0015566722958234177, 0.0015551865439668302,
      0.0015536884751400364, 0.0015521781705007092, 0.0015506557109532975,
      0.0015491211771492708, 0.0015475746494873679, 0.001546016208113847,
      0.001544445932922737, 0.0015428639035560926, 0.001541270199404248,
      0.0015396648996060763, 0.0015380480830492482, 0.0015364198283704937,
      0.0015347802139558655, 0.0015331293179410036, 0.001531467218211404,
      0.0015297939924026854, 0.0015281097179008617, 0.0015264144718426138,
      0.0015247083311155638, 0.0015229913723585513, 0.0015212636719619116,
      0.001519525306067755, 0.0015177763505702482, 0.0015160168811158975,
      0.001514246973103834, 0.0015124667016861, 0.0015106761417679369, 0.001508875368008076,
      0.00150706445481903, 0.001505243476367385, 0.0015034125065740978,
      0.0015015716191147904, 0.0014997208874200497, 0.001497860384675727,
      0.0014959901838232385, 0.0014941103575598698, 0.00149222097833908,
      0.0014903221183708076, 0.0014884138496217786, 0.001486496243815816,
      0.0014845693724341502, 0.0014826333067157317, 0.0014806881176575451,
      0.0014787338760149243, 0.0014767706523018697, 0.0014747985167913656,
      0.0014728175395157016, 0.0014708277902667926, 0.001468829338596502,
      0.0014668222538169653, 0.001464806605000917, 0.001462782460982016,
      0.0014607498903551751, 0.0014587089614768905, 0.0014566597424655724,
      0.0014546023012018785, 0.0014525367053290464, 0.0014504630222532304,
      0.0014483813191438371, 0.0014462916629338631, 0.0014441941203202349,
      0.0014420887577641485, 0.0014399756414914119, 0.0014378548374927875,
      0.001435726411524337, 0.0014335904291077662, 0.0014314469555307724,
      0.001429296055847392, 0.00142713779487835, 0.0014249722372114096,
      0.0014227994472017253, 0.0014206194889721945, 0.001418432426413812,
      0.0014162383231860255, 0.0014140372427170912, 0.0014118292482044317,
      0.0014096144026149943, 0.0014073927686856114, 0.0014051644089233604,
      0.0014029293856059272, 0.0014006877607819672, 0.0013984395962714712,
      0.00139618495366613, 0.0013939238943297, 0.0013916564793983717, 0.0013893827697811377,
      0.001387102826160162, 0.0013848167089911504, 0.0013825244785037223,
      0.001380226194701783, 0.0013779219173638965, 0.0013756117060436614,
      0.0013732956200700854, 0.001370973718547962, 0.0013686460603582473,
      0.0013663127041584392, 0.0013639737083829563, 0.001361629131243518,
      0.0013592790307295258, 0.001356923464608445, 0.0013545624904261879,
      0.0013521961655074974, 0.001349824546956332, 0.0013474476916562508,
      0.001345065656270801, 0.0013426784972439042, 0.0013402862708002444,
      0.0013378890329456582, 0.0013354868394675234, 0.0013330797459351498,
      0.0013306678077001713, 0.0013282510798969373, 0.0013258296174429066,
      0.0013234034750390401, 0.001320972707170196, 0.0013185373681055255,
      0.001316097511898868, 0.0013136531923891481, 0.001311204463200774,
      0.001308751377744035, 0.0013062939892155008, 0.0013038323505984207,
      0.0013013665146631252, 0.001298896533967426, 0.001296422460857018,
      0.001293944347465882, 0.0012914622457166885, 0.0012889762073212002,
      0.001286486283780677, 0.0012839925263862816, 0.0012814949862194843,
      0.0012789937141524704, 0.0012764887608485462, 0.001273980176762547,
      0.0012714680121412455, 0.0012689523170237604, 0.0012664331412419656,
      0.0012639105344209004, 0.00126138454597918, 0.001258855225129406,
      0.0012563226208785786, 0.001253786782028509, 0.0012512477571762315,
      0.0012487055947144167, 0.001246160342831786, 0.0012436120495135249,
      0.0012410607625416984, 0.001238506529495666, 0.0012359493977524972,
      0.0012333894144873885, 0.001230826626674079, 0.0012282610810852687,
      0.0012256928242930353, 0.001223121902669253, 0.0012205483623860096,
      0.0012179722494160274, 0.0012153936095330813, 0.001212812488312419,
      0.0012102289311311813, 0.0012076429831688218, 0.0012050546894075294,
      0.0012024640946326484, 0.0011998712434331009, 0.001197276180201809,
      0.001194678949136117, 0.0011920795942382148, 0.0011894781593155609,
      0.0011868746879813055, 0.0011842692236547154, 0.0011816618095615969,
      0.001179052488734722, 0.0011764413040142522, 0.0011738282980481639,
      0.0011712135132926741, 0.0011685969920126665, 0.0011659787762821165,
      0.001163358907984519, 0.001160737428813314, 0.0011581143802723145,
      0.0011554898036761326, 0.0011528637401506075, 0.0011502362306332339,
      0.0011476073158735885, 0.0011449770364337594, 0.001142345432688774,
      0.001139712544827028, 0.0011370784128507138, 0.0011344430765762494,
      0.0011318065756347083, 0.0011291689494722485, 0.0011265302373505424,
      0.0011238904783472067, 0.0011212497113562323, 0.0011186079750884143,
      0.0011159653080717823, 0.0011133217486520314, 0.001110677334992953,
      0.0011080321050768644, 0.0011053860967050412, 0.0011027393474981476,
      0.0011000918948966677, 0.0010974437761613366, 0.0010947950283735723,
      0.0010921456884359071, 0.0010894957930724196, 0.0010868453788291659,
      0.0010841944820746115, 0.0010815431390000631, 0.0010788913856201012,
      0.001076239257773012, 0.0010735867911212194, 0.001070934021151717,
      0.0010682809831765007, 0.001065627712333001, 0.0010629742435845151,
      0.0010603206117206399, 0.0010576668513577032, 0.0010550129969391978,
      0.0010523590827362127, 0.0010497051428478663, 0.0010470512112017384,
      0.0010443973215543032, 0.0010417435074913616, 0.0010390898024284737,
      0.001036436239611391, 0.0010337828521164896, 0.001031129672851202,
      0.0010284767345544498, 0.0010258240697970757, 0.0010231717109822768,
      0.0010205196903460357, 0.0010178680399575537, 0.0010152167917196826,
      0.001012565977369357, 0.001009915628478026, 0.0010072657764520856,
      0.0010046164525333106, 0.0010019676877992864, 0.0009993195131638404,
      0.0009966719593774744, 0.0009940250570277954, 0.0009913788365399484,
      0.000988733328177046, 0.0009860885620406007, 0.0009834445680709564,
      0.000980801376047718, 0.000978159015590184, 0.0009755175161577761,
      0.0009728769070504701, 0.0009702372174092268, 0.0009675984762164217,
      0.0009649607122962761, 0.0009623239543152859, 0.0009596882307826529,
      0.0009570535700507133, 0.0009544200003153679, 0.0009517875496165119,
      0.0009491562458384628, 0.0009465261167103909, 0.0009438971898067468,
      0.000941269492547691, 0.0009386430521995222, 0.0009360178958751051,
      0.000933394050534299, 0.0009307715429843853, 0.0009281503998804949,
      0.0009255306477260365, 0.0009229123128731227, 0.0009202954215229978,
      0.0009176799997264641, 0.0009150660733843081, 0.0009124536682477279,
      0.0009098428099187577, 0.0009072335238506948, 0.0009046258353485246,
      0.0009020197695693454, 0.0008994153515227945, 0.000896812606071472,
      0.0008942115579313657, 0.0008916122316722753, 0.0008890146517182358,
      0.0008864188423479419, 0.0008838248276951705, 0.0008812326317492047,
      0.000878642278355256, 0.0008760537912148867, 0.0008734671938864325,
      0.000870882509785424, 0.0008682997621850084, 0.0008657189742163706,
      0.0008631401688691546, 0.0008605633689918836, 0.0008579885972923803,
      0.0008554158763381874, 0.000852845228556987, 0.0008502766762370195,
      0.0008477102415275026, 0.0008451459464390508, 0.0008425838128440926,
      0.0008400238624772895, 0.0008374661169359524, 0.0008349105976804595,
      0.0008323573260346734, 0.0008298063231863569, 0.0008272576101875898,
      0.0008247112079551841, 0.0008221671372711, 0.0008196254187828602,
      0.0008170860730039651, 0.0008145491203143072, 0.0008120145809605842,
      0.0008094824750567133, 0.0008069528225842437, 0.0008044256433927694,
      0.0008019009572003419, 0.0007993787835938817, 0.0007968591420295897,
      0.0007943420518333588, 0.0007918275322011839, 0.0007893156021995725,
      0.0007868062807659546, 0.0007842995867090918, 0.0007817955387094866,
      0.0007792941553197905, 0.0007767954549652128, 0.0007742994559439279,
      0.0007718061764274824, 0.0007693156344612021, 0.0007668278479645985,
      0.0007643428347317743, 0.000761860612431829, 0.0007593811986092647,
      0.0007569046106843895, 0.0007544308659537223, 0.0007519599815903962,
      0.0007494919746445616, 0.0007470268620437895, 0.0007445646605934728,
      0.0007421053869772291, 0.0007396490577573012, 0.0007371956893749582,
      0.0007347452981508961, 0.0007322979002856373, 0.00072985351185993,
      0.0007274121488351475, 0.0007249738270536861, 0.0007225385622393635,
      0.0007201063699978156, 0.000717677265816894, 0.0007152512650670621,
      0.0007128283830017912, 0.0007104086347579554, 0.0007079920353562273,
      0.0007055785997014719, 0.0007031683425831402, 0.0007007612786756635,
      0.0006983574225388454, 0.0006959567886182542, 0.0006935593912456152,
      0.0006911652446392014, 0.0006887743629042245, 0.0006863867600332256,
      0.0006840024499064638, 0.0006816214462923063, 0.0006792437628476162,
      0.0006768694131181417, 0.0006744984105389025, 0.0006721307684345776,
      0.0006697665000198912, 0.0006674056183999988, 0.0006650481365708726,
      0.0006626940674196863, 0.0006603434237251994, 0.0006579962181581409,
      0.0006556524632815921, 0.0006533121715513694, 0.0006509753553164066,
      0.0006486420268191357, 0.0006463121981958683, 0.0006439858814771756,
      0.0006416630885882683, 0.0006393438313493762, 0.0006370281214761256,
      0.0006347159705799186, 0.00063240739016831, 0.0006301023916453838,
      0.00062780098631213, 0.0006255031853668203, 0.0006232089999053828,
      0.0006209184409217767, 0.0006186315193083665, 0.0006163482458562951,
      0.0006140686312558566, 0.000611792686096868, 0.0006095204208690416,
      0.0006072518459623553, 0.0006049869716674237, 0.0006027258081758666,
      0.0006004683655806796, 0.0005982146538766015, 0.0005959646829604831,
      0.0005937184626316539, 0.0005914760025922893, 0.0005892373124477763,
      0.0005870024017070792, 0.0005847712797831046, 0.0005825439559930653,
      0.0005803204395588447, 0.0005781007396073589, 0.0005758848651709197,
      0.0005736728251875966, 0.0005714646285015772, 0.0005692602838635284,
      0.0005670597999309561, 0.0005648631852685645, 0.0005626704483486148,
      0.0005604815975512829, 0.0005582966411650176, 0.0005561155873868964,
      0.0005539384443229825, 0.0005517652199886797, 0.0005495959223090876,
      0.0005474305591193555, 0.0005452691381650365, 0.0005431116671024398,
      0.0005409581534989834, 0.0005388086048335458, 0.0005366630284968167,
      0.0005345214317916477, 0.0005323838219334018, 0.0005302502060503023,
      0.0005281205911837817, 0.0005259949842888295, 0.0005238733922343387,
      0.0005217558218034524, 0.00051964227969391, 0.0005175327725183925,
      0.0005154273068048662, 0.0005133258889969271, 0.0005112285254541442,
      0.0005091352224524018, 0.0005070459861842412, 0.000504960822759202,
      0.0005028797382041629, 0.0005008027384636813, 0.0004987298294003328,
      0.0004966610167950491, 0.0004945963063474567, 0.0004925357036762133,
      0.0004904792143193451, 0.0004884268437345823, 0.0004863785972996944,
      0.00048433448031282424, 0.0004822944979928227, 0.0004802586554795812,
      0.0004782269578343647, 0.0004761994100401433, 0.00047417601700192323,
      0.0004721567835470777, 0.0004701417144256763, 0.0004681308143108146,
      0.0004661240877989422, 0.0004641215394101907, 0.00046212317358870064,
      0.00046012899470294823, 0.0004581390070460708, 0.0004561532148361918,
      0.0004541716222167454, 0.00045219423325680005, 0.0004502210519513814,
      0.0004482520822217947, 0.0004462873279159464, 0.0004443267928086652,
      0.0004423704806020222, 0.0004404183949256503, 0.0004384705393370635,
      0.00043652691732197463, 0.0004345875322946131, 0.00043265238759804183,
      0.0004307214865044729, 0.00042879483221558353, 0.00042687242786283047,
      0.00042495427650776407, 0.0004230403811423418, 0.0004211307446892408,
      0.0004192253700021697, 0.0004173242598661802, 0.00041542741699797733,
      0.0004135348440462297, 0.0004116465435918783, 0.00040976251814844536,
      0.0004078827701623417, 0.0004060073020131742, 0.000404136116014052,
      0.0004022692144118924, 0.00040040659938772556, 0.0003985482730569992,
      0.0003966942374698818, 0.0003948444946115658, 0.00039299904640256955,
      0.0003911578946990392, 0.00038932104129304915, 0.0003874884879129024,
      0.00038566023622342983, 0.00038383628782628877, 0.00038201664426026135,
      0.0003802013070015516, 0.0003783902774640821, 0.00037658355699978977,
      0.00037478114689892133, 0.0003729830483903275, 0.0003711892626417569,
      0.00036939979076014917, 0.00036761463379192757, 0.0003658337927232903,
      0.00036405726848050165, 0.00036228506193018234, 0.00036051717387959906,
      0.0003587536050769533, 0.00035699435621166945, 0.0003552394279146824,
      0.0003534888207587243, 0.00035174253525861054, 0.00035000057187152523,
      0.0003482629309973058, 0.00034652961297872674, 0.0003448006181017831,
      0.0003430759465959729, 0.000341355598634579, 0.00033963957433495024,
      0.00033792787375878187, 0.00033622049691239527, 0.0003345174437470169,
      0.0003328187141590566, 0.00033112430799038533, 0.00032943422502861193,
      0.0003277484650073594, 0.0003260670276065403, 0.00032438991245263164,
      0.000322717119118949, 0.00032104864712591974, 0.0003193844959413557,
      0.00031772466498072524, 0.0003160691536074245, 0.00031441796113304804,
      0.0003127710868176584, 0.0003111285298700557, 0.0003094902894480457,
      0.0003078563646587078, 0.0003062267545586618, 0.00030460145815433456,
      0.00030298047440222535, 0.000301363802209171, 0.0002997514404326101,
      0.0002981433878808464, 0.0002965396433133117, 0.00029494020544082813,
      0.00029334507292586926, 0.0002917542443828209, 0.00029016771837824136,
      0.00028858549343112056, 0.0002870075680131386, 0.0002854339405489239,
      0.00028386460941631016, 0.000282299572946593, 0.00028073882942478585,
      0.0002791823770898748, 0.00027763021413507313, 0.00027608233870807524,
      0.0002745387489113093, 0.0002729994428021899, 0.00027146441839336944,
      0.0002699336736529892, 0.0002684072065049294, 0.0002668850148290588,
      0.0002653670964614836, 0.00026385344919479555, 0.00026234407077831915,
      0.0002608389589183588, 0.00025933811127844443, 0.00025784152547957714,
      0.0002563491991004736, 0.00025486112967781015, 0.00025337731470646623,
      0.00025189775163976665, 0.0002504224378897235, 0.00024895137082727744,
      0.0002474845477825383, 0.0002460219660450247, 0.00024456362286390303,
      0.00024310951544822618, 0.0002416596409671711, 0.00024021399655027576,
      0.00023877257928767566, 0.00023733538623033935, 0.00023590241439030345,
      0.00023447366074090686, 0.0002330491222170245, 0.00023162879571530005,
      0.00023021267809437824, 0.0002288007661751364, 0.00022739305674091519,
      0.00022598954653774888, 0.00022459023227459476, 0.00022319511062356194,
      0.00022180417822013944, 0.00022041743166342366, 0.000219034867516345,
      0.00021765648230589405, 0.00021628227252334687, 0.0002149122346244897,
      0.00021354636502984297, 0.00021218466012488471, 0.00021082711626027308,
      0.00020947372975206838, 0.00020812449688195438, 0.00020677941389745896,
      0.0002054384770121739, 0.00020410168240597436, 0.00020276902622523726,
      0.00020144050458305939
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.00010293144153579262, 1.2214971098260428e-05, 2.4887013305244744e-05, 3.749486929454406e-05,
      5.003870201379196e-05, 6.251867440467891e-05, 7.493494940090717e-05,
      8.728768992615606e-05, 9.957705889205764e-05, 0.00011180321919618272,
      0.00012396633372003727, 0.00013606656532706902, 0.00014810407686068443,
      0.0001600790311422759, 0.00017199159096925907, 0.00018384191911312062,
      0.0001956301783174759, 0.00020735653129613687, 0.0002190211407311902,
      0.00023062416927108542, 0.00024216577952873298, 0.00025364613407961265,
      0.00026506539545989165, 0.0002764237261645529, 0.0002877212886455333,
      0.0002989582453098718, 0.00031013475851786733, 0.00032125099058124683,
      0.00033230710376134305, 0.000343303260267282, 0.0003542396222541803,
      0.0003651163518213526, 0.00037593361101052826, 0.0003866915618040779,
      0.00039739036612325, 0.0004080301858264167, 0.00041861118270732935,
      0.0004291335184933841, 0.00043959735484389636, 0.00045000285334838546,
      0.0004603501755248683, 0.000470639482818163, 0.00048087093659820193,
      0.0004910446981583538, 0.0005011609287137555, 0.0005112197893996535,
      0.0005212214412697544, 0.0005311660452945849, 0.000541053762359861,
      0.0005508847532648665, 0.0005606591787208409, 0.0005703771993493765,
      0.0005800389756808247, 0.0005896446681527115, 0.0005991944371081623,
      0.0006086884427943356, 0.0006181268453608658, 0.0006275098048583156,
      0.0006368374812366365, 0.0006461100343436395, 0.0006553276239234738,
      0.0006644904096151155, 0.0006735985509508638, 0.0006826522073548478,
      0.000691651538141541, 0.0007005967025142855, 0.0007094878595638242,
      0.0007183251682668422, 0.0007271087874845179, 0.0007358388759610811,
      0.0007445155923223813, 0.0007531390950744643, 0.0007617095426021571,
      0.0007702270931676625, 0.0007786919049091608, 0.0007871041358394218,
      0.0007954639438444238, 0.0008037714866819826, 0.0008120269219803881,
      0.0008202304072370498, 0.0008283820998171507, 0.0008364821569523096,
      0.0008445307357392523, 0.0008525279931384903, 0.0008604740859730087,
      0.0008683691709269625, 0.0008762134045443803, 0.0008840069432278778,
      0.0008917499432373776, 0.0008994425606888396, 0.0009070849515529979,
      0.0009146772716541062, 0.0009222196766686924, 0.0009297123221243196,
      0.0009371553633983572, 0.0009445489557167587, 0.0009518932541528481,
      0.0009591884136261143, 0.0009664345889010136, 0.0009736319345857803,
      0.0009807806051312447, 0.0009878807548296597, 0.0009949325378135355,
      0.0010019361080544813, 0.001008891619362056, 0.0010157992253826257,
      0.0010226590795982292, 0.0010294713353254529, 0.001036236145714311,
      0.001042953663747135, 0.0010496240422374714, 0.0010562474338289848,
      0.0010628239909943715, 0.0010693538660342787, 0.0010758372110762325,
      0.0010822741780735729, 0.001088664918804397, 0.0010950095848705087,
      0.0011013083276963768, 0.0011075612985281009, 0.0011137686484323835,
      0.0011199305282955114, 0.0011260470888223419, 0.0011321184805352996,
      0.001138144853773378, 0.00114412635869115, 0.001150063145257785,
      0.0011559553632560728, 0.0011618031622814566, 0.0011676066917410716,
      0.0011733661008527915, 0.001179081538644282, 0.0011847531539520616,
      0.0011903810954205698, 0.0011959655115012418, 0.001201506550451591,
      0.0012070043603342987, 0.0012124590890163099, 0.001217870884167937,
      0.00122323989326197, 0.0012285662635727942, 0.0012338501421755152,
      0.0012390916759450893, 0.0012442910115554625, 0.0012494482954787153,
      0.0012545636739842148, 0.001259637293137774, 0.0012646692988008176,
      0.0012696598366295545, 0.0012746090520741565, 0.0012795170903779458,
      0.0012843840965765867, 0.0012892102154972859, 0.001293995591757998,
      0.0012987403697666395, 0.0013034446937203075, 0.0013081087076045066,
      0.001312732555192381, 0.0013173163800439542, 0.001321860325505375,
      0.00132636453470817, 0.001330829150568502, 0.0013352543157864366,
      0.0013396401728452128, 0.0013439868640105213, 0.0013482945313297904,
      0.0013525633166314764, 0.0013567933615243608, 0.0013609848073968544,
      0.001365137795416308, 0.0013692524665283273, 0.0013733289614560973,
      0.00137736742069971, 0.0013813679845354999, 0.0013853307930153853,
      0.0013892559859662158, 0.0013931437029891267, 0.0013969940834588977,
      0.0014008072665233197, 0.001404583391102566, 0.001408322595888571,
      0.0014120250193444142, 0.0014156907997037104, 0.0014193200749700056,
      0.001422912982916179, 0.0014264696610838507, 0.0014299902467827974,
      0.0014334748770903705, 0.0014369236888509222, 0.0014403368186752376,
      0.0014437144029399722, 0.001447056577787095, 0.0014503634791233372,
      0.0014536352426196472, 0.001456872003710652, 0.0014600738975941224,
      0.001463241059230446, 0.0014663736233421045, 0.0014694717244131568,
      0.0014725354966887284, 0.001475565074174506, 0.001478560590636238,
      0.0014815221795992392, 0.0014844499743479039, 0.0014873441079252213,
      0.0014902047131322984, 0.0014930319225278884, 0.0014958258684279236,
      0.001498586682905054, 0.0015013144977881916, 0.0015040094446620608,
      0.0015066716548667524, 0.0015093012594972848, 0.0015118983894031688,
      0.001514463175187979, 0.0015169957472089312, 0.0015194962355764617,
      0.0015219647701538162, 0.0015244014805566408, 0.0015268064961525803,
      0.001529179946060879, 0.00153152195915199, 0.001533832664047187,
      0.0015361121891181826, 0.0015383606624867511, 0.0015405782120243565,
      0.001542764965351786, 0.0015449210498387881, 0.0015470465926037155,
      0.0015491417205131738, 0.0015512065601816743, 0.0015532412379712923,
      0.0015552458799913307, 0.001557220612097987, 0.0015591655598940271,
      0.001561080848728462, 0.0015629666036962313, 0.0015648229496378911,
      0.0015666500111393051, 0.0015684479125313427, 0.0015702167778895802,
      0.0015719567310340074, 0.0015736678955287394, 0.0015753503946817325,
      0.0015770043515445046, 0.001578629888911861, 0.0015802271293216246,
      0.0015817961950543703, 0.0015833372081331643, 0.001584850290323308,
      0.0015863355631320865, 0.001587793147808522, 0.0015892231653431314,
      0.0015906257364676874, 0.0015920009816549868, 0.0015933490211186194,
      0.0015946699748127457, 0.001595963962431875, 0.001597231103410651,
      0.0015984715169236404, 0.001599685321885125, 0.0016008726369489009,
      0.0016020335805080783, 0.0016031682706948898, 0.0016042768253804992,
      0.0016053593621748168, 0.001606415998426319, 0.0016074468512218703,
      0.001608452037386552, 0.0016094316734834926, 0.001610385875813705,
      0.001611314760415925, 0.0016122184430664576, 0.0016130970392790227,
      0.0016139506643046094, 0.0016147794331313318, 0.0016155834604842892,
      0.0016163628608254319, 0.0016171177483534282, 0.0016178482370035384,
      0.0016185544404474907, 0.001619236472093362, 0.001619894445085463,
      0.0016205284723042259, 0.0016211386663660971, 0.0016217251396234344,
      0.0016222880041644057, 0.0016228273718128946, 0.0016233433541284071,
      0.0016238360624059847, 0.0016243056076761186, 0.00162475210070467,
      0.0016251756519927935, 0.0016255763717768629, 0.0016259543700284029,
      0.0016263097564540227, 0.0016266426404953553, 0.001626953131328998,
      0.0016272413378664585, 0.0016275073687541037, 0.001627751332373113,
      0.001627973336839434, 0.0016281734900037428, 0.0016283518994514073,
      0.0016285086725024548, 0.0016286439162115417, 0.0016287577373679284,
      0.001628850242495457, 0.0016289215378525316, 0.0016289717294321045,
      0.0016290009229616626, 0.0016290092239032205, 0.001628996737453314,
      0.0016289635685430002, 0.001628909821837857, 0.0016288356017379903,
      0.0016287410123780415, 0.0016286261576271993, 0.0016284911410892149,
      0.0016283360661024208, 0.0016281610357397522, 0.0016279661528087722,
      0.0016277515198516999, 0.001627517239145442, 0.0016272634127016275,
      0.0016269901422666455, 0.0016266975293216864, 0.0016263856750827863,
      0.0016260546805008744, 0.0016257046462618235, 0.0016253356727865035,
      0.0016249478602308382, 0.0016245413084858655, 0.0016241161171778001,
      0.0016236723856681002, 0.001623210213053535, 0.0016227296981662584,
      0.0016222309395738832, 0.0016217140355795593, 0.0016211790842220546,
      0.0016206261832758396, 0.001620055430251174, 0.0016194669223941961,
      0.0016188607566870164, 0.0016182370298478124, 0.0016175958383309278,
      0.001616937278326974, 0.0016162614457629339, 0.001615568436302269,
      0.0016148583453450297, 0.0016141312680279679, 0.001613387299224652,
      0.0016126265335455858, 0.0016118490653383292, 0.0016110549886876222,
      0.0016102443974155113, 0.0016094173850814786, 0.0016085740449825732,
      0.0016077144701535473, 0.0016068387533669916, 0.0016059469871334761,
      0.0016050392637016924, 0.0016041156750585988, 0.0016031763129295688,
      0.0016022212687785396, 0.001601250633808167, 0.0016002644989599798,
      0.0015992629549145374, 0.001598246092091591, 0.0015972140006502466,
      0.0015961667704891302, 0.0015951044912465558, 0.0015940272523006964,
      0.0015929351427697563, 0.0015918282515121462, 0.001590706667126662,
      0.0015895704779526644, 0.0015884197720702612, 0.0015872546373004934,
      0.001586075161205521, 0.0015848814310888137, 0.0015836735339953426,
      0.0015824515567117745, 0.001581215585766669, 0.0015799657074306772,
      0.0015787020077167426, 0.0015774245723803046, 0.0015761334869195053,
      0.0015748288365753965, 0.0015735107063321499, 0.0015721791809172698,
      0.001570834344801808, 0.0015694762822005808, 0.0015681050770723864,
      0.001566720813120228, 0.0015653235737915364, 0.001563913442278395,
      0.001562490501517768, 0.0015610548341917295, 0.0015596065227276952,
      0.0015581456492986569, 0.0015566722958234177, 0.0015551865439668302,
      0.0015536884751400364, 0.0015521781705007092, 0.0015506557109532975,
      0.0015491211771492708, 0.0015475746494873679, 0.001546016208113847,
      0.001544445932922737, 0.0015428639035560926, 0.001541270199404248,
      0.0015396648996060763, 0.0015380480830492482, 0.0015364198283704937,
      0.0015347802139558655, 0.0015331293179410036, 0.001531467218211404,
      0.0015297939924026854, 0.0015281097179008617, 0.0015264144718426138,
      0.0015247083311155638, 0.0015229913723585513, 0.0015212636719619116,
      0.001519525306067755, 0.0015177763505702482, 0.0015160168811158975,
      0.001514246973103834, 0.0015124667016861, 0.0015106761417679369, 0.001508875368008076,
      0.00150706445481903, 0.001505243476367385, 0.0015034125065740978,
      0.0015015716191147904, 0.0014997208874200497, 0.001497860384675727,
      0.0014959901838232385, 0.0014941103575598698, 0.00149222097833908,
      0.0014903221183708076, 0.0014884138496217786, 0.001486496243815816,
      0.0014845693724341502, 0.0014826333067157317, 0.0014806881176575451,
      0.0014787338760149243, 0.0014767706523018697, 0.0014747985167913656,
      0.0014728175395157016, 0.0014708277902667926, 0.001468829338596502,
      0.0014668222538169653, 0.001464806605000917, 0.001462782460982016,
      0.0014607498903551751, 0.0014587089614768905, 0.0014566597424655724,
      0.0014546023012018785, 0.0014525367053290464, 0.0014504630222532304,
      0.0014483813191438371, 0.0014462916629338631, 0.0014441941203202349,
      0.0014420887577641485, 0.0014399756414914119, 0.0014378548374927875,
      0.001435726411524337, 0.0014335904291077662, 0.0014314469555307724,
      0.001429296055847392, 0.00142713779487835, 0.0014249722372114096,
      0.0014227994472017253, 0.0014206194889721945, 0.001418432426413812,
      0.0014162383231860255, 0.0014140372427170912, 0.0014118292482044317,
      0.0014096144026149943, 0.0014073927686856114, 0.0014051644089233604,
      0.0014029293856059272, 0.0014006877607819672, 0.0013984395962714712,
      0.00139618495366613, 0.0013939238943297, 0.0013916564793983717, 0.0013893827697811377,
      0.001387102826160162, 0.0013848167089911504, 0.0013825244785037223,
      0.001380226194701783, 0.0013779219173638965, 0.0013756117060436614,
      0.0013732956200700854, 0.001370973718547962, 0.0013686460603582473,
      0.0013663127041584392, 0.0013639737083829563, 0.001361629131243518,
      0.0013592790307295258, 0.001356923464608445, 0.0013545624904261879,
      0.0013521961655074974, 0.001349824546956332, 0.0013474476916562508,
      0.001345065656270801, 0.0013426784972439042, 0.0013402862708002444,
      0.0013378890329456582, 0.0013354868394675234, 0.0013330797459351498,
      0.0013306678077001713, 0.0013282510798969373, 0.0013258296174429066,
      0.0013234034750390401, 0.001320972707170196, 0.0013185373681055255,
      0.001316097511898868, 0.0013136531923891481, 0.001311204463200774,
      0.001308751377744035, 0.0013062939892155008, 0.0013038323505984207,
      0.0013013665146631252, 0.001298896533967426, 0.001296422460857018,
      0.001293944347465882, 0.0012914622457166885, 0.0012889762073212002,
      0.001286486283780677, 0.0012839925263862816, 0.0012814949862194843,
      0.0012789937141524704, 0.0012764887608485462, 0.001273980176762547,
      0.0012714680121412455, 0.0012689523170237604, 0.0012664331412419656,
      0.0012639105344209004, 0.00126138454597918, 0.001258855225129406,
      0.0012563226208785786, 0.001253786782028509, 0.0012512477571762315,
      0.0012487055947144167, 0.001246160342831786, 0.0012436120495135249,
      0.0012410607625416984, 0.001238506529495666, 0.0012359493977524972,
      0.0012333894144873885, 0.001230826626674079, 0.0012282610810852687,
      0.0012256928242930353, 0.001223121902669253, 0.0012205483623860096,
      0.0012179722494160274, 0.0012153936095330813, 0.001212812488312419,
      0.0012102289311311813, 0.0012076429831688218, 0.0012050546894075294,
      0.0012024640946326484, 0.0011998712434331009, 0.001197276180201809,
      0.001194678949136117, 0.0011920795942382148, 0.0011894781593155609,
      0.0011868746879813055, 0.0011842692236547154, 0.0011816618095615969,
      0.001179052488734722, 0.0011764413040142522, 0.0011738282980481639,
      0.0011712135132926741, 0.0011685969920126665, 0.0011659787762821165,
      0.001163358907984519, 0.001160737428813314, 0.0011581143802723145,
      0.0011554898036761326, 0.0011528637401506075, 0.0011502362306332339,
      0.0011476073158735885, 0.0011449770364337594, 0.001142345432688774,
      0.001139712544827028, 0.0011370784128507138, 0.0011344430765762494,
      0.0011318065756347083, 0.0011291689494722485, 0.0011265302373505424,
      0.0011238904783472067, 0.0011212497113562323, 0.0011186079750884143,
      0.0011159653080717823, 0.0011133217486520314, 0.001110677334992953,
      0.0011080321050768644, 0.0011053860967050412, 0.0011027393474981476,
      0.0011000918948966677, 0.0010974437761613366, 0.0010947950283735723,
      0.0010921456884359071, 0.0010894957930724196, 0.0010868453788291659,
      0.0010841944820746115, 0.0010815431390000631, 0.0010788913856201012,
      0.001076239257773012, 0.0010735867911212194, 0.001070934021151717,
      0.0010682809831765007, 0.001065627712333001, 0.0010629742435845151,
      0.0010603206117206399, 0.0010576668513577032, 0.0010550129969391978,
      0.0010523590827362127, 0.0010497051428478663, 0.0010470512112017384,
      0.0010443973215543032, 0.0010417435074913616, 0.0010390898024284737,
      0.001036436239611391, 0.0010337828521164896, 0.001031129672851202,
      0.0010284767345544498, 0.0010258240697970757, 0.0010231717109822768,
      0.0010205196903460357, 0.0010178680399575537, 0.0010152167917196826,
      0.001012565977369357, 0.001009915628478026, 0.0010072657764520856,
      0.0010046164525333106, 0.0010019676877992864, 0.0009993195131638404,
      0.0009966719593774744, 0.0009940250570277954, 0.0009913788365399484,
      0.000988733328177046, 0.0009860885620406007, 0.0009834445680709564,
      0.000980801376047718, 0.000978159015590184, 0.0009755175161577761,
      0.0009728769070504701, 0.0009702372174092268, 0.0009675984762164217,
      0.0009649607122962761, 0.0009623239543152859, 0.0009596882307826529,
      0.0009570535700507133, 0.0009544200003153679, 0.0009517875496165119,
      0.0009491562458384628, 0.0009465261167103909, 0.0009438971898067468,
      0.000941269492547691, 0.0009386430521995222, 0.0009360178958751051,
      0.000933394050534299, 0.0009307715429843853, 0.0009281503998804949,
      0.0009255306477260365, 0.0009229123128731227, 0.0009202954215229978,
      0.0009176799997264641, 0.0009150660733843081, 0.0009124536682477279,
      0.0009098428099187577, 0.0009072335238506948, 0.0009046258353485246,
      0.0009020197695693454, 0.0008994153515227945, 0.000896812606071472,
      0.0008942115579313657, 0.0008916122316722753, 0.0008890146517182358,
      0.0008864188423479419, 0.0008838248276951705, 0.0008812326317492047,
      0.000878642278355256, 0.0008760537912148867, 0.0008734671938864325,
      0.000870882509785424, 0.0008682997621850084, 0.0008657189742163706,
      0.0008631401688691546, 0.0008605633689918836, 0.0008579885972923803,
      0.0008554158763381874, 0.000852845228556987, 0.0008502766762370195,
      0.0008477102415275026, 0.0008451459464390508, 0.0008425838128440926,
      0.0008400238624772895, 0.0008374661169359524, 0.0008349105976804595,
      0.0008323573260346734, 0.0008298063231863569, 0.0008272576101875898,
      0.0008247112079551841, 0.0008221671372711, 0.0008196254187828602,
      0.0008170860730039651, 0.0008145491203143072, 0.0008120145809605842,
      0.0008094824750567133, 0.0008069528225842437, 0.0008044256433927694,
      0.0008019009572003419, 0.0007993787835938817, 0.0007968591420295897,
      0.0007943420518333588, 0.0007918275322011839, 0.0007893156021995725,
      0.0007868062807659546, 0.0007842995867090918, 0.0007817955387094866,
      0.0007792941553197905, 0.0007767954549652128, 0.0007742994559439279,
      0.0007718061764274824, 0.0007693156344612021, 0.0007668278479645985,
      0.0007643428347317743, 0.000761860612431829, 0.0007593811986092647,
      0.0007569046106843895, 0.0007544308659537223, 0.0007519599815903962,
      0.0007494919746445616, 0.0007470268620437895, 0.0007445646605934728,
      0.0007421053869772291, 0.0007396490577573012, 0.0007371956893749582,
      0.0007347452981508961, 0.0007322979002856373, 0.00072985351185993,
      0.0007274121488351475, 0.0007249738270536861, 0.0007225385622393635,
      0.0007201063699978156, 0.000717677265816894, 0.0007152512650670621,
      0.0007128283830017912, 0.0007104086347579554, 0.0007079920353562273,
      0.0007055785997014719, 0.0007031683425831402, 0.0007007612786756635,
      0.0006983574225388454, 0.0006959567886182542, 0.0006935593912456152,
      0.0006911652446392014, 0.0006887743629042245, 0.0006863867600332256,
      0.0006840024499064638, 0.0006816214462923063, 0.0006792437628476162,
      0.0006768694131181417, 0.0006744984105389025, 0.0006721307684345776,
      0.0006697665000198912, 0.0006674056183999988, 0.0006650481365708726,
      0.0006626940674196863, 0.0006603434237251994, 0.0006579962181581409,
      0.0006556524632815921, 0.0006533121715513694, 0.0006509753553164066,
      0.0006486420268191357, 0.0006463121981958683, 0.0006439858814771756,
      0.0006416630885882683, 0.0006393438313493762, 0.0006370281214761256,
      0.0006347159705799186, 0.00063240739016831, 0.0006301023916453838,
      0.00062780098631213, 0.0006255031853668203, 0.0006232089999053828,
      0.0006209184409217767, 0.0006186315193083665, 0.0006163482458562951,
      0.0006140686312558566, 0.000611792686096868, 0.0006095204208690416,
      0.0006072518459623553, 0.0006049869716674237, 0.0006027258081758666,
      0.0006004683655806796, 0.0005982146538766015, 0.0005959646829604831,
      0.0005937184626316539, 0.0005914760025922893, 0.0005892373124477763,
      0.0005870024017070792, 0.0005847712797831046, 0.0005825439559930653,
      0.0005803204395588447, 0.0005781007396073589, 0.0005758848651709197,
      0.0005736728251875966, 0.0005714646285015772, 0.0005692602838635284,
      0.0005670597999309561, 0.0005648631852685645, 0.0005626704483486148,
      0.0005604815975512829, 0.0005582966411650176, 0.0005561155873868964,
      0.0005539384443229825, 0.0005517652199886797, 0.0005495959223090876,
      0.0005474305591193555, 0.0005452691381650365, 0.0005431116671024398,
      0.0005409581534989834, 0.0005388086048335458, 0.0005366630284968167,
      0.0005345214317916477, 0.0005323838219334018, 0.0005302502060503023,
      0.0005281205911837817, 0.0005259949842888295, 0.0005238733922343387,
      0.0005217558218034524, 0.00051964227969391, 0.0005175327725183925,
      0.0005154273068048662, 0.0005133258889969271, 0.0005112285254541442,
      0.0005091352224524018, 0.0005070459861842412, 0.000504960822759202,
      0.0005028797382041629, 0.0005008027384636813, 0.0004987298294003328,
      0.0004966610167950491, 0.0004945963063474567, 0.0004925357036762133,
      0.0004904792143193451, 0.0004884268437345823, 0.0004863785972996944,
      0.00048433448031282424, 0.0004822944979928227, 0.0004802586554795812,
      0.0004782269578343647, 0.0004761994100401433, 0.00047417601700192323,
      0.0004721567835470777, 0.0004701417144256763, 0.0004681308143108146,
      0.0004661240877989422, 0.0004641215394101907, 0.00046212317358870064,
      0.00046012899470294823, 0.0004581390070460708, 0.0004561532148361918,
      0.0004541716222167454, 0.00045219423325680005, 0.0004502210519513814,
      0.0004482520822217947, 0.0004462873279159464, 0.0004443267928086652,
      0.0004423704806020222, 0.0004404183949256503, 0.0004384705393370635,
      0.00043652691732197463, 0.0004345875322946131, 0.00043265238759804183,
      0.0004307214865044729, 0.00042879483221558353, 0.00042687242786283047,
      0.00042495427650776407, 0.0004230403811423418, 0.0004211307446892408,
      0.0004192253700021697, 0.0004173242598661802, 0.00041542741699797733,
      0.0004135348440462297, 0.0004116465435918783, 0.00040976251814844536,
      0.0004078827701623417, 0.0004060073020131742, 0.000404136116014052,
      0.0004022692144118924, 0.00040040659938772556, 0.0003985482730569992,
      0.0003966942374698818, 0.0003948444946115658, 0.00039299904640256955,
      0.0003911578946990392, 0.00038932104129304915, 0.0003874884879129024,
      0.00038566023622342983, 0.00038383628782628877, 0.00038201664426026135,
      0.0003802013070015516, 0.0003783902774640821, 0.00037658355699978977,
      0.00037478114689892133, 0.0003729830483903275, 0.0003711892626417569,
      0.00036939979076014917, 0.00036761463379192757, 0.0003658337927232903,
      0.00036405726848050165, 0.00036228506193018234, 0.00036051717387959906,
      0.0003587536050769533, 0.00035699435621166945, 0.0003552394279146824,
      0.0003534888207587243, 0.00035174253525861054, 0.00035000057187152523,
      0.0003482629309973058, 0.00034652961297872674, 0.0003448006181017831,
      0.0003430759465959729, 0.000341355598634579, 0.00033963957433495024,
      0.00033792787375878187, 0.00033622049691239527, 0.0003345174437470169,
      0.0003328187141590566, 0.00033112430799038533, 0.00032943422502861193,
      0.0003277484650073594, 0.0003260670276065403, 0.00032438991245263164,
      0.000322717119118949, 0.00032104864712591974, 0.0003193844959413557,
      0.00031772466498072524, 0.0003160691536074245, 0.00031441796113304804,
      0.0003127710868176584, 0.0003111285298700557, 0.0003094902894480457,
      0.0003078563646587078, 0.0003062267545586618, 0.00030460145815433456,
      0.00030298047440222535, 0.000301363802209171, 0.0002997514404326101,
      0.0002981433878808464, 0.0002965396433133117, 0.00029494020544082813,
      0.00029334507292586926, 0.0002917542443828209, 0.00029016771837824136,
      0.00028858549343112056, 0.0002870075680131386, 0.0002854339405489239,
      0.00028386460941631016, 0.000282299572946593, 0.00028073882942478585,
      0.0002791823770898748, 0.00027763021413507313, 0.00027608233870807524,
      0.0002745387489113093, 0.0002729994428021899, 0.00027146441839336944,
      0.0002699336736529892, 0.0002684072065049294, 0.0002668850148290588,
      0.0002653670964614836, 0.00026385344919479555, 0.00026234407077831915,
      0.0002608389589183588, 0.00025933811127844443, 0.00025784152547957714,
      0.0002563491991004736, 0.00025486112967781015, 0.00025337731470646623,
      0.00025189775163976665, 0.0002504224378897235, 0.00024895137082727744,
      0.0002474845477825383, 0.0002460219660450247, 0.00024456362286390303,
      0.00024310951544822618, 0.0002416596409671711, 0.00024021399655027576,
      0.00023877257928767566, 0.00023733538623033935, 0.00023590241439030345,
      0.00023447366074090686, 0.0002330491222170245, 0.00023162879571530005,
      0.00023021267809437824, 0.0002288007661751364, 0.00022739305674091519,
      0.00022598954653774888, 0.00022459023227459476, 0.00022319511062356194,
      0.00022180417822013944, 0.00022041743166342366, 0.000219034867516345,
      0.00021765648230589405, 0.00021628227252334687, 0.0002149122346244897,
      0.00021354636502984297, 0.00021218466012488471, 0.00021082711626027308,
      0.00020947372975206838, 0.00020812449688195438, 0.00020677941389745896,
      0.0002054384770121739, 0.00020410168240597436, 0.00020276902622523726,
      0.00020144050458305939
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_3_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<3>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 3.799187055141574e-05), "design.b()[0] == 3.799187055141574e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 3.799187055141574e-05));
    static_assert(almost_equal(design.b()[1], -3.482555787252862e-05), "design.b()[1] == -3.482555787252862e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -3.482555787252862e-05));
    static_assert(almost_equal(design.b()[2], -3.4825557872528615e-05), "design.b()[2] == -3.4825557872528615e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - -3.4825557872528615e-05));
    static_assert(almost_equal(design.b()[3], 3.799187055141575e-05), "design.b()[3] == 3.799187055141575e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 3.799187055141575e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.96279468697131), "design.a()[1] == -2.96279468697131");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.96279468697131));
    static_assert(almost_equal(design.a()[2], 2.9262782896733284), "design.a()[2] == 2.9262782896733284");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.9262782896733284));
    static_assert(almost_equal(design.a()[3], -0.9634772700766605), "design.a()[3] == -0.9634772700766605");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.9634772700766605));
    std::cout << "max_deviation(cheby2,lowpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      3.799187055141574e-05, 7.773655434530771e-05, 8.431710634651822e-05, 9.6931657684974e-05,
      0.00011535068580425227, 0.00013934900901725616, 0.00016870574491345504,
      0.0002032042687765837, 0.00024263217201357613, 0.0002867812205957369,
      0.000335447313513371, 0.0003884304412453036, 0.00044553464424492025,
      0.0005065679714445517, 0.0005713424387802099, 0.0006396739877388587,
      0.0007113824439305692, 0.0007862914756880696, 0.0008642285526963521,
      0.0009450249046551429, 0.0010285154799771791, 0.0011145389045253658,
      0.00120293744039201, 0.001293556944723441, 0.0013862468285934398,
      0.0014808600159290052, 0.0015772529024920662, 0.0016752853149208605,
      0.0017748204698347651, 0.001875724933006452, 0.0019778685786053128,
      0.0020811245485161545, 0.002185369211737241, 0.0022904821238617992,
      0.0023963459866471653, 0.002502846607675785, 0.0026098728601123295,
      0.0027173166425612117, 0.002825072839028827, 0.0029330392789948655,
      0.003041116697597053, 0.0031492086959337123, 0.003257221701488535,
      0.003365064928681964, 0.0034726503395535874, 0.003579892604579956,
      0.0036867090636322148, 0.0037930196870779483, 0.003898747037031613,
      0.004003816228757928, 0.004108154892232562, 0.004211693133864453,
      0.0043143634983840475, 0.004416100930901744, 0.004516842739140775,
      0.004616528555848732, 0.0047151003013919095, 0.0048125021465366055,
      0.004908680475421454, 0.005003583848724846, 0.005097162967031438,
      0.005189370634401698, 0.005280161722148388, 0.005369493132823831,
      0.005457323764421757, 0.005543614474797457, 0.005628328046309928,
      0.005711429150689621, 0.005792884314135343, 0.0058726618826438134,
      0.005950731987575297, 0.006027066511458654, 0.006101639054039126,
      0.006174424898572058, 0.006245400978365713, 0.0063145458435762535,
      0.006381839628257913, 0.0064472640176712614, 0.006510802215852452,
      0.006572438913446213, 0.006632160255805292, 0.006689953811358985,
      0.006745808540253306, 0.006799714763265258, 0.006851664130993616,
      0.006901649593328521, 0.006949665369202135, 0.006995706916622489,
      0.007039770902992631, 0.00708185517571704, 0.0071219587330972264,
      0.007160081695518364, 0.007196225276928689, 0.007230391756613327,
      0.007262584451264167, 0.007292807687347261, 0.007321066773769175,
      0.007347367974843659, 0.007371718483559877, 0.007394126395153387,
      0.007414600680980973, 0.00743315116270035, 0.00744978848675568, 0.007464524099169766,
      0.007477370220643712, 0.007488339821964738, 0.00749744659972278, 0.007504704952336438,
      0.007510129956388724, 0.007513737343273005, 0.007515543476149467,
      0.007515565327212344, 0.007513820455268064, 0.007510326983624405,
      0.007505103578290708, 0.00749816942648905, 0.007489544215476287, 0.007479248111676743,
      0.007467301740125288, 0.007453726164220468, 0.007438542865787276,
      0.007421773725449089, 0.0074034410033082185, 0.007383567319934474,
      0.007362175637661068, 0.007339289242187115, 0.0073149317244859124,
      0.007289126963018162, 0.00726189910624917, 0.0072332725554690655,
      0.007203271947914966, 0.007171922140193989, 0.007139248192005954,
      0.007105275350164529, 0.007070029032915561, 0.007033534814551247,
      0.006995818410318759, 0.006956905661621882, 0.006916822521514165,
      0.0068755950404820534, 0.0068332493525164045, 0.006789811661470736,
      0.0067453082277045325, 0.006699765355009862, 0.006653209377819519,
      0.006605666648694889, 0.006557163526091637, 0.006507726362401323, 0.006457381492267,
      0.0064061552211707815, 0.006354073814291372, 0.006301163485629469,
      0.006247450387398944, 0.006192960599681659, 0.0061377201203437395,
      0.006081754855211098, 0.006025090608501961, 0.0059677530735141315,
      0.0059097678235646885, 0.0058511603031797775, 0.005791955819532136,
      0.005732179534123975, 0.005671856454712788, 0.00561101142747767, 0.005549669129423656,
      0.005487854061021608, 0.005425590539081156, 0.005362902689854135,
      0.0052998144423659944, 0.005236349521972602, 0.00517253144413986,
      0.005108383508443526, 0.005043928792786629, 0.00497919014783184, 0.004914190191646158,
      0.0048489513045552445, 0.004783495624204742, 0.00471784504082589,
      0.004652021192702735, 0.004586045461838259, 0.004519938969816685,
      0.004453722573859264, 0.004387416863070807, 0.004321042154874232,
      0.004254618491630394, 0.004188165637440469, 0.004121703075128123,
      0.004055250003398746, 0.003988825334172989, 0.003922447690091872,
      0.003856135402190701, 0.00378990650773906, 0.0037237787482441217,
      0.0036577695676145473, 0.0035918961104822317, 0.0035261752206791524,
      0.0034606234398666044, 0.0033952570063140895, 0.0033300918538251394,
      0.0032651436108073646, 0.00320042759948402, 0.0031359588352443983,
      0.0030717520261303553, 0.0030078215724562976, 0.0029441815665599506,
      0.002880845792681261, 0.002817827726966782, 0.0027551405375969094,
      0.0026927970850333383, 0.0026308099223841426, 0.002569191295883875,
      0.002507953145486099, 0.002447107105565798, 0.002386664505729094,
      0.002326636371727756, 0.002267033426475963, 0.002207866091166821,
      0.0021491444864861504, 0.0020908784339210692, 0.002033077457160917,
      0.0019757507835880955, 0.0019189073458563992, 0.0018625557835544467,
      0.001806704444951832, 0.0017513613888256391, 0.0016965343863649847,
      0.0016422309231512717, 0.0015884582012118563, 0.0015352231411448558,
      0.0014825323843128436, 0.001430392295103201, 0.0013788089632529137,
      0.0013277882062356335, 0.0012773355717088314, 0.001227456340018908,
      0.0011781555267621423, 0.001129437885399382, 0.0010813079099224058,
      0.001033769837569911, 0.0009868276515911, 0.0009404850840548725,
      0.0008947456187026412, 0.0008496124938428293, 0.0008050887052851179,
      0.000761177009312546, 0.0007178799256895862, 0.0006751997407043473,
      0.0006331385102430766, 0.0005916980628951642, 0.0005508800030868727,
      0.000510685714242046, 0.000471116361968072, 0.00043217289726540226,
      0.0003938560597589574, 0.0003561663809497712, 0.0003191041874852546,
      0.0002826696044464841, 0.0002468625586509465, 0.00021168278196919798,
      0.00017712981465392065, 0.00014320300867988575, 0.00010990153109335915,
      7.722436736951017e-05, 4.5170324776410846e-05, 1.373803574423847e-05,
      -1.7074038761679812e-05, -4.7267605865315904e-05, -7.684453740319291e-05,
      -0.00010580686654772481, -0.00013415678443190216, -0.000161896636776557,
      -0.00018902892052141446, -0.00021555628046111375, -0.0002414815058873551,
      -0.00026680752723830513, -0.0002915374127563671, -0.0003156743651553987,
      -0.000339221718298434, -0.0003621829338869419, -0.00038456159816263017,
      -0.00040636141862277733, -0.00042758622075005233, -0.0004482399447577573,
      -0.0004683266423514042, -0.0004878504735075131, -0.0005068157032704953,
      -0.0005252266985684621, -0.0005430879250487763, -0.0005604039439341391,
      -0.0005771794088999843, -0.0005934190629739275, -0.0006091277354579952,
      -0.0006243103388743378, -0.0006389718659351059, -0.0006531173865371501,
      -0.0006667520447821808, -0.0006798810560230029, -0.0006925097039364185,
      -0.0007046433376233733, -0.0007162873687368955, -0.0007274472686383602,
      -0.0007381285655825881, -0.0007483368419322696, -0.0007580777314021847,
      -0.0007673569163336683, -0.0007761801249997514, -0.0007845531289413896,
      -0.0007924817403351706, -0.000799971809392875, -0.0008070292217932421,
      -0.00081365989614628, -0.0008198697814904348, -0.0008256648548229202,
      -0.0008310511186634879, -0.0008360345986519061, -0.0008406213411793911,
      -0.0008448174110542218, -0.0008486288892017527, -0.000852061870399021,
      -0.0008551224610441285, -0.0008578167769605642, -0.0008601509412366156,
      -0.0008621310821000021, -0.0008637633308278493, -0.0008650538196921091,
      -0.0008660086799405094, -0.000866634039813114, -0.0008669360225945473,
      -0.0008669207447019329, -0.0008665943138085755, -0.0008659628270034081,
      -0.0008650323689862074, -0.0008638090102985711, -0.0008622988055906368,
      -0.0008605077919235098, -0.000858441987107355, -0.0008561073880750964,
      -0.0008535099692916555, -0.0008506556811986479, -0.0008475504486944482,
      -0.0008442001696495204, -0.0008406107134569011, -0.0008367879196177126,
      -0.0008327375963615713, -0.000828465519301749, -0.0008239774301249338,
      -0.0008192790353154268, -0.0008143760049136033, -0.0008092739713084574,
      -0.0008039785280640405, -0.0007984952287795944, -0.0007928295859831727,
      -0.0007869870700585363, -0.0007809731082051002, -0.0007747930834306994,
      -0.0007684523335769397, -0.0007619561503768848, -0.0007553097785448304,
      -0.0007485184148979056, -0.0007415872075092374, -0.0007345212548924055,
      -0.0007273256052169109, -0.0007200052555543751, -0.0007125651511551805,
      -0.0007050101847552569, -0.0006973451959127169, -0.0006895749703740308,
      -0.0006817042394694365, -0.0006737376795372676, -0.0006656799113768813,
      -0.0006575354997298626, -0.0006493089527891799, -0.0006410047217359589,
      -0.0006326272003035417, -0.0006241807243684931, -0.0006156695715682124,
      -0.0006070979609448062, -0.0005984700526148767, -0.0005897899474648729,
      -0.0005810616868716543, -0.0005722892524479108, -0.0005634765658120821,
      -0.0005546274883824174, -0.000545745821194814, -0.0005368353047440723,
      -0.0005278996188482015, -0.0005189423825354121, -0.000509967153953426,
      -0.0005009774303007379, -0.0004919766477794565, -0.0004829681815693579,
      -0.0004739553458227788, -0.00046494139367997834, -0.0004559295173045979,
      -0.00044692284793884673, -0.0004379244559780404, -0.0004289373510641217,
      -0.00041996448219779113, -0.00041100873786887606, -0.0004020729462045669,
      -0.00039315987513515024, -0.00038427223257686896, -0.0003754126666315403,
      -0.00036658376580256304, -0.00035778805922694686, -0.0003490280169229983,
      -0.0003403060500532976, -0.00033162451120260345, -0.0003229856946703224,
      -0.0003143918367771836, -0.00030584511618575927, -0.00029734765423447356,
      -0.0002889015152847444, -0.0002805087070809043, -0.00027217118112254945,
      -0.0002638908330489664, -0.0002556695030352903, -0.00024750897620004833,
      -0.0002394109830237464, -0.00023137719977815843, -0.00022340924896598004,
      -0.00021550869977051172, -0.00020767706851503866, -0.00019991581913157697,
      -0.000192226363638659, -0.00018461006262783346, -0.00017706822575855866,
      -0.00016960211226117023, -0.00016221293144760737, -0.00015490184322958526,
      -0.0001476699586439043, -0.00014051834038458913, -0.00013344800334155505,
      -0.0001264599151455012, -0.00011955499671873425, -0.00011273412283162933,
      -0.00010599812266443798, -9.934778037415704e-05, -9.278383566617497e-05,
      -8.630698437041631e-05, -7.991787902170819e-05, -7.361712944409617e-05,
      -6.740530333884084e-05, -6.128292687582963e-05, -5.5250485288142206e-05,
      -4.930842346951149e-05, -4.3457146574425856e-05, -3.769702062062206e-05,
      -3.2028373093721796e-05, -2.6451493553768813e-05, -2.0966634243427155e-05,
      -1.5574010697604874e-05, -1.0273802354271363e-05, -5.066153166240249e-06,
      4.882778630647776e-08, 5.071065682773494e-06, 1.0000519348803008e-05,
      1.4837180642834264e-05, 1.9581073842780673e-05, 2.4232255033029757e-05,
      2.879081149196721e-05, 3.3256861080222595e-05, 3.763055162983037e-05,
      4.1912060334496054e-05, 4.6101593141153636e-05, 5.019938414299634e-05,
      5.4205694974159235e-05, 5.81208142062283e-05, 6.194505674674675e-05,
      6.567876323988566e-05, 6.932229946944208e-05, 7.287605576432438e-05,
      7.634044640668028e-05, 7.971590904281989e-05, 8.300290409708197e-05,
      8.620191418878798e-05, 8.9313443552425e-05, 9.233801746119473e-05,
      9.527618165406217e-05, 9.812850176643434e-05, 0.00010089556276459503,
      0.00010357796838401869, 0.00010617634057168271, 0.000108691318932494,
      0.0001111235601799419, 0.00011347373759108636, 0.00011574254046598664,
      0.00011793067359167279, 0.00012003885671075777, 0.00012206782399478593,
      0.0001240183235224094, 0.0001258911167624809, 0.00012768697806214815,
      0.00012940669414003206, 0.00013105106358456684, 0.00013262089635757835,
      0.00013411701330317253, 0.00013554024566200335, 0.00013689143459098623,
      0.00013817143068852052, 0.00013938109352528067, 0.00014052129118063332,
      0.00014159289978473452, 0.0001425968030663583, 0.0001435338919065048,
      0.0001444050638978336, 0.00014521122290996475, 0.00014595327866068772,
      0.0001466321462931151, 0.00014724874595881555, 0.00014780400240695828,
      0.0001482988445794976, 0.0001487342052124245, 0.00014911102044310923,
      0.00014943022942375634, 0.00014969277394099142, 0.00014989959804159595,
      0.0001500516476644048, 0.00015014987027837782, 0.00015019521452685542,
      0.00015018862987800549, 0.00015013106628146628, 0.00015002347383118853,
      0.00014986680243447717, 0.00014966200148723162, 0.00014941001955538053,
      0.00014911180406250603, 0.00014876830098364949, 0.0001483804545452893,
      0.00014794920693147958, 0.00014747549799613597, 0.00014696026498145373,
      0.0001464044422424408, 0.0001458089609775472, 0.00014517474896537038,
      0.00014450273030741417, 0.00014379382517687748, 0.00014304894957344738,
      0.0001422690150840695, 0.000141454928649667, 0.00014060759233777822,
      0.00013972790312108153, 0.00013881675266177394, 0.00013787502710176986,
      0.0001369036068586836, 0.00013590336642755886, 0.00013487517418830697,
      0.00013381989221881416, 0.0001327383761136773, 0.000131631474808526,
      0.00013050003040988812, 0.00012934487803055445, 0.0001281668456303974,
      0.00012696675386259757, 0.0001257454159252306, 0.0001245036374181663,
      0.00012324221620523126, 0.00012196194228158416, 0.00012066359764625369,
      0.00011934795617978678, 0.00011801578352695508, 0.00011666783698446604,
      0.00011530486539362489, 0.0001139276090378927, 0.00011253679954528533,
      0.00011113315979555691, 0.00010971740383211175, 0.00010829023677858728,
      0.00010685235476005014, 0.00010540444482874756, 0.0001039471848943551,
      0.00010248124365866152, 0.00010100728055463163, 9.952594568978656e-05,
      9.803787979384158e-05, 9.654371417054046e-05, 9.50440706536255e-05,
      9.353956156688193e-05, 9.20307896881951e-05, 9.051834821755856e-05,
      8.900282074897125e-05, 8.748478124616133e-05, 8.596479402207458e-05,
      8.444341372206455e-05, 8.292118531072208e-05, 8.139864406228131e-05,
      7.987631555453968e-05, 7.835471566622882e-05, 7.683435057777353e-05,
      7.53157167753762e-05, 7.379930105836361e-05, 7.228558054973356e-05,
      7.077502270983838e-05, 6.926808535314281e-05, 6.776521666799375e-05,
      6.626685523933941e-05, 6.477343007433561e-05, 6.328536063077711e-05,
      6.180305684829197e-05, 6.032691918223741e-05, 5.885733864023537e-05,
      5.7394696821286775e-05, 5.593936595740317e-05, 5.449170895769511e-05,
      5.3052079454856844e-05, 5.162082185398688e-05, 5.019827138368481e-05,
      4.878475414936455e-05, 4.7380587188724995e-05, 4.5986078529319024e-05,
      4.460152724816246e-05, 4.322722353332478e-05, 4.186344874744388e-05,
      4.0510475493107565e-05, 3.916856768004478e-05, 3.783798059407019e-05,
      3.6518960967725985e-05, 3.5211747052565356e-05, 3.39165686930225e-05,
      3.263364740181449e-05, 3.136319643682078e-05, 3.0105420879386814e-05,
      2.886051771399838e-05, 2.7628675909274162e-05, 2.641007650022426e-05,
      2.5204892671723078e-05, 2.4013289843145506e-05, 2.283542575411585e-05,
      2.1671450551319496e-05, 2.0521506876327907e-05, 1.9385729954388003e-05,
      1.8264247684127724e-05, 1.7157180728129977e-05, 1.6064642604327823e-05,
      1.4986739778174397e-05, 1.3923571755541548e-05, 1.2875231176301874e-05,
      1.1841803908549346e-05, 1.0823369143414391e-05, 9.819999490429903e-06,
      8.831761073405199e-06, 7.85871362676565e-06, 6.90091059231626e-06,
      5.958399216388145e-06, 5.031220647327459e-06, 4.119410033286932e-06,
      3.2229966202808604e-06, 2.3420038504649796e-06, 1.4764494606032978e-06,
      6.263455806846046e-07, -2.083011673479934e-07, -1.0274895707905259e-06,
      -1.8312237273299743e-06, -2.6195129461891906e-06, -3.3923716492990186e-06,
      -4.149819272531076e-06, -4.89188016702403e-06, -5.618583500635545e-06,
      -6.3299631595514585e-06, -7.0260576500830955e-06, -7.706910000683003e-06,
      -8.372567664208765e-06, -9.023082420463888e-06, -9.658510279044172e-06,
      -1.0278911382517302e-05, -1.0884349909962793e-05, -1.1474893980898825e-05,
      -1.2050615559621818e-05, -1.2611590359984031e-05, -1.3157897750633859e-05,
      -1.3689620660742806e-05, -1.4206845486242622e-05, -1.470966199659541e-05,
      -1.5198163242118898e-05, -1.567244546188853e-05, -1.613260799223736e-05,
      -1.6578753175874224e-05, -1.7010986271639982e-05, -1.7429415364921113e-05,
      -1.783415127873935e-05, -1.82253074855354e-05, -1.8603000019664342e-05,
      -1.8967347390619617e-05, -1.9318470497002063e-05, -1.9656492541249746e-05,
      -1.9981538945143942e-05, -2.0293737266106005e-05, -2.059321711429928e-05,
      -2.0880110070549758e-05, -2.1154549605098555e-05, -2.1416670997198884e-05,
      -2.1666611255569488e-05, -2.1904509039716194e-05, -2.213050458213258e-05,
      -2.2344739611390322e-05, -2.2547357276129227e-05, -2.273850206995657e-05,
      -2.2918319757264727e-05, -2.3086957299975715e-05, -2.3244562785220732e-05,
      -2.3391285353962336e-05, -2.352727513056645e-05, -2.365268315333083e-05,
      -2.3767661305976374e-05, -2.3872362250106977e-05, -2.396693935864334e-05,
      -2.4051546650235695e-05, -2.4126338724659912e-05, -2.4191470699201146e-05,
      -2.4247098146028617e-05, -2.4293377030564883e-05, -2.433046365085239e-05,
      -2.435851457791984e-05, -2.4377686597150385e-05, -2.4388136650653457e-05,
      -2.4390021780641434e-05, -2.438349907381221e-05, -2.436872560673819e-05,
      -2.4345858392261932e-05, -2.4315054326898435e-05, -2.4276470139243477e-05,
      -2.423026233938729e-05, -2.4176587169332463e-05, -2.4115600554414543e-05,
      -2.4047458055723636e-05, -2.3972314823524923e-05, -2.389032555167568e-05,
      -2.3801644433036155e-05, -2.370642511587131e-05, -2.360482066124019e-05,
      -2.349698350136932e-05, -2.3383065399006438e-05, -2.3263217407750362e-05,
      -2.3137589833352766e-05, -2.3006332195987186e-05, -2.2869593193480475e-05,
      -2.27275206655016e-05, -2.258026155870247e-05, -2.2427961892805296e-05,
      -2.227076672763064e-05, -2.210882013106023e-05, -2.1942265147928354e-05,
      -2.1771243769835384e-05, -2.1595896905876885e-05, -2.141636435428146e-05,
      -2.123278477495043e-05, -2.104529566289213e-05, -2.0854033322543537e-05,
      -2.0659132842971676e-05, -2.0460728073947178e-05, -2.025895160288214e-05,
      -2.0053934732624344e-05, -1.9845807460099655e-05, -1.9634698455794397e-05,
      -1.942073504406925e-05, -1.9204043184296187e-05, -1.8984747452809716e-05,
      -1.8762971025663727e-05, -1.8538835662185024e-05, -1.831246168931451e-05,
      -1.8083967986726957e-05, -1.7853471972720136e-05, -1.762108959086401e-05,
      -1.738693529740057e-05, -1.715112204938488e-05, -1.691376129355776e-05,
      -1.667496295594046e-05, -1.643483543214163e-05, -1.6193485578366814e-05,
      -1.595101870312066e-05, -1.5707538559591933e-05, -1.54631473387114e-05,
      -1.5217945662872601e-05, -1.4972032580305476e-05, -1.4725505560092778e-05,
      -1.4478460487819157e-05, -1.4230991661842795e-05, -1.3983191790179419e-05,
      -1.3735151987988489e-05, -1.3486961775651382e-05, -1.3238709077431324e-05,
      -1.2990480220704865e-05, -1.2742359935754624e-05, -1.2494431356113093e-05,
      -1.2246776019447213e-05, -1.1999473868973505e-05, -1.175260325539352e-05,
      -1.1506240939339377e-05, -1.1260462094319156e-05, -1.1015340310151988e-05,
      -1.0770947596882621e-05, -1.0527354389165328e-05, -1.0284629551107048e-05,
      -1.0042840381559602e-05, -9.802052619850973e-06, -9.562330451945576e-06,
      -9.323736517023543e-06, -9.086331914469055e-06, -8.850176211257803e-06,
      -8.615327449733725e-06, -8.381842155765185e-06, -8.14977534727083e-06,
      -7.919180543105395e-06, -7.690109772295812e-06, -7.462613583617997e-06,
      -7.236741055504783e-06, -7.012539806275522e-06, -6.790056004677913e-06,
      -6.569334380732736e-06, -6.350418236872168e-06, -6.133349459362503e-06,
      -5.9181685300021095e-06, -5.704914538085556e-06, -5.4936251926249275e-06,
      -5.284336834819404e-06, -5.077084450764265e-06, -4.871901684390554e-06,
      -4.668820850626747e-06, -4.467872948773817e-06, -4.269087676085189e-06,
      -4.072493441543171e-06, -3.87811737982352e-06, -3.685985365439899e-06,
      -3.496122027060073e-06, -3.3085507619857833e-06, -3.1232937507883156e-06,
      -2.9403719720918923e-06, -2.7598052174971016e-06, -2.5816121066366804e-06,
      -2.4058101023560447e-06, -2.2324155260110824e-06, -2.061443572875801e-06,
      -1.8929083276525376e-06, -1.7268227800775223e-06, -1.5631988406146966e-06,
      -1.4020473562307844e-06, -1.2433781262447166e-06, -1.0871999182446065e-06,
      -9.335204840655813e-07, -7.823465758218733e-07, -6.336839619866785e-07,
      -4.875374435133934e-07, -3.4391086999194286e-07, -2.028071558340168e-07,
      -6.422829648113705e-08, 7.182461537042151e-08, 2.0535137353372555e-07,
      3.363526420900609e-07, 4.648299391482558e-07, 5.907856206100077e-07,
      7.142228639466676e-07, 8.351456519928323e-07, 9.535587567619891e-07,
      1.0694677232893566e-06, 1.1828788535069572e-06, 1.2937991901558562e-06,
      1.4022365007403989e-06, 1.508199261529172e-06, 1.6116966416073152e-06,
      1.7127384869847035e-06, 1.811335304764421e-06, 1.9074982473758413e-06,
      2.001239096876534e-06, 2.0925702493271106e-06, 2.1815046992430226e-06,
      2.2680560241272304e-06, 2.3522383690875534e-06, 2.434066431542416e-06,
      2.5135554460186096e-06, 2.5907211690445874e-06, 2.665579864142714e-06,
      2.738148286923791e-06, 2.808443670287091e-06, 2.8764837097290307e-06,
      2.942286548763521e-06, 3.0058707644569376e-06, 3.06725535308056e-06,
      3.126459715883242e-06, 3.183503644986974e-06, 3.2384073094079153e-06,
      3.2911912412053765e-06, 3.3418763217611507e-06, 3.390483768191496e-06,
      3.4370351198939894e-06, 3.481552225231386e-06, 3.524057228354519e-06,
      3.564572556166207e-06, 3.6031209054280466e-06, 3.6397252300118766e-06,
      3.6744087282976205e-06, 3.707194830719142e-06, 3.7381071874596574e-06,
      3.767169656298171e-06, 3.7944062906083223e-06, 3.8198413275109565e-06,
      3.843499176181652e-06, 3.865404406314364e-06, 3.885581736742261e-06,
      3.9040560242167745e-06, 3.920852252345789e-06, 3.935995520691846e-06,
      3.949511034031143e-06, 3.961424091774065e-06, 3.9717600775479e-06,
      3.980544448942323e-06, 3.987802727418171e-06, 3.993560488379972e-06,
      3.997843351412608e-06, 4.000676970682444e-06, 4.0020870255031994e-06,
      4.002099211066745e-06, 4.000739229338991e-06, 3.998032780120928e-06,
      3.994005552274875e-06, 3.988683215115875e-06, 3.982091409968174e-06,
      3.974255741886625e-06, 3.965201771542835e-06, 3.954955007275798e-06,
      3.943540897306712e-06, 3.9309848221176405e-06, 3.9173120869936024e-06,
      3.902547914727655e-06, 3.886717438488458e-06, 3.869845694849788e-06,
      3.8519576169814115e-06, 3.8330780280006735e-06, 3.813231634484138e-06,
      3.7924430201385544e-06, 3.770736639630382e-06, 3.748136812573088e-06,
      3.7246677176713598e-06, 3.7003533870213636e-06, 3.6752177005661376e-06,
      3.649284380705152e-06, 3.6225769870570607e-06, 3.595118911374615e-06,
      3.566933372610693e-06, 3.5380434121343413e-06, 3.5084718890957253e-06,
      3.478241475938829e-06, 3.4473746540607297e-06, 3.4158937096162306e-06,
      3.3838207294666303e-06, 3.3511775972713548e-06, 3.3179859897211682e-06,
      3.2842673729116504e-06, 3.250042998855603e-06, 3.215333902133022e-06,
      3.180160896677263e-06, 3.1445445726959846e-06, 3.108505293725453e-06,
      3.0720631938167638e-06, 3.0352381748525234e-06, 2.9980499039924984e-06,
      2.960517811246747e-06, 2.922661087174714e-06, 2.884498680708767e-06,
      2.8460492971006215e-06, 2.807331395989109e-06, 2.7683631895877102e-06,
      2.7291626409902756e-06, 2.689747462593341e-06, 2.6501351146334302e-06,
      2.6103428038377357e-06, 2.570387482186548e-06, 2.530285845785813e-06,
      2.4900543338481675e-06, 2.4497091277808104e-06, 2.409266150378562e-06,
      2.3687410651204448e-06, 2.328149275568126e-06, 2.2875059248645576e-06,
      2.246825895331138e-06, 2.206123808161723e-06, 2.16541402321181e-06,
      2.1247106388812167e-06, 2.0840274920885735e-06, 2.0433781583359506e-06,
      2.002775951861941e-06, 1.9622339258815137e-06, 1.9217648729109666e-06,
      1.8813813251762991e-06, 1.8410955551033263e-06, 1.800919575887868e-06,
      1.7608651421443424e-06, 1.7209437506310997e-06, 1.6811666410508335e-06,
      1.6415447969244185e-06, 1.602088946536519e-06, 1.5628095639513287e-06,
      1.523716870096803e-06, 1.4848208339157462e-06, 1.4461311735821352e-06,
      1.4076573577810625e-06, 1.3694086070506851e-06, 1.3313938951845812e-06,
      1.2936219506929238e-06, 1.2561012583208864e-06, 1.2188400606227078e-06,
      1.1818463595898517e-06, 1.1451279183317096e-06, 1.1086922628073035e-06,
      1.0725466836064535e-06, 1.0366982377788955e-06, 1.0011537507098348e-06,
      9.659198180404395e-07, 9.310028076317906e-07, 8.964088615708135e-07,
      8.621438982167309e-07, 8.28213614286593e-07, 7.94623486978447e-07,
      7.613787761307278e-07, 7.284845264164635e-07, 6.959455695709019e-07,
      6.637665266511797e-07, 6.319518103266698e-07, 6.005056271986578e-07,
      5.69431980148012e-07, 5.387346707095284e-07, 5.084173014716435e-07,
      4.784832785002272e-07, 4.48935813785182e-07, 4.1977792770858866e-07
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      3.799187055141574e-05, 7.77365543453077e-05, 8.43171063465182e-05, 9.6931657684974e-05,
      0.00011535068580425228, 0.00013934900901725616, 0.00016870574491345504,
      0.00020320426877658363, 0.00024263217201357608, 0.00028678122059573683,
      0.0003354473135133708, 0.0003884304412453032, 0.0004455346442449195,
      0.0005065679714445503, 0.0005713424387802077, 0.0006396739877388551,
      0.0007113824439305636, 0.0007862914756880613, 0.0008642285526963403,
      0.0009450249046551268, 0.001028515479977158, 0.0011145389045253394,
      0.0012029374403919773, 0.0012935569447234004, 0.0013862468285933903,
      0.0014808600159289453, 0.0015772529024919942, 0.001675285314920774,
      0.0017748204698346624, 0.0018757249330063313, 0.001977868578605172,
      0.0020811245485159915, 0.002185369211737054, 0.0022904821238615854,
      0.0023963459866469224, 0.00250284660767551, 0.00260987286011202, 0.002717316642560864,
      0.0028250728390284384, 0.0029330392789944323, 0.00304111669759657,
      0.003149208695933175, 0.003257221701487941, 0.003365064928681309,
      0.003472650339552868, 0.0035798926045791687, 0.0036867090636313565,
      0.0037930196870770145, 0.0038987470370306, 0.004003816228756831, 0.004108154892231376,
      0.004211693133863172, 0.004314363498382667, 0.004416100930900259,
      0.004516842739139181, 0.0046165285558470255, 0.004715100301390086,
      0.004812502146534662, 0.004908680475419382, 0.00500358384872264, 0.005097162967029092,
      0.0051893706343992055, 0.005280161722145742, 0.005369493132821026,
      0.005457323764418788, 0.005543614474794318, 0.005628328046306613,
      0.005711429150686121, 0.005792884314131649, 0.005872661882639919,
      0.005950731987571193, 0.006027066511454333, 0.006101639054034581,
      0.006174424898567283, 0.006245400978360695, 0.006314545843570985,
      0.006381839628252384, 0.006447264017665465, 0.006510802215846382,
      0.006572438913439862, 0.006632160255798649, 0.0066899538113520405,
      0.006745808540246047, 0.006799714763257673, 0.006851664130985692,
      0.006901649593320246, 0.006949665369193494, 0.00699570691661347, 0.007039770902983221,
      0.007081855175707226, 0.0071219587330869985, 0.007160081695507712,
      0.007196225276917601, 0.007230391756601794, 0.007262584451252178, 0.0072928076873348,
      0.007321066773756229, 0.007347367974830215, 0.007371718483545922, 0.00739412639513891,
      0.007414600680965962, 0.007433151162684792, 0.007449788486739562,
      0.007464524099153079, 0.007477370220626447, 0.007488339821946885,
      0.007497446599704331, 0.007504704952317385, 0.007510129956369057,
      0.007513737343252714, 0.007515543476128546, 0.007515565327190785,
      0.007513820455245855, 0.007510326983601538, 0.0075051035782671745,
      0.007498169426464843, 0.007489544215451399, 0.007479248111651163,
      0.007467301740099007, 0.007453726164193479, 0.007438542865759572,
      0.007421773725420657, 0.007403441003279044, 0.00738356731990454,
      0.0073621756376303586, 0.0073392892421556095, 0.007314931724453593,
      0.007289126962985008, 0.007261899106215161, 0.007233272555434182,
      0.007203271947879183, 0.007171922140157285, 0.0071392481919683075,
      0.007105275350125919, 0.0070700290328759696, 0.007033534814510658,
      0.006995818410277159, 0.0069569056615792525, 0.0069168225214704905,
      0.006875595040437319, 0.0068332493524705966, 0.006789811661423842,
      0.006745308227656542, 0.006699765354960763, 0.006653209377769304,
      0.006605666648643552, 0.006557163526039172, 0.006507726362347727,
      0.006457381492212268, 0.006406155221114913, 0.006354073814234365, 0.00630116348557132,
      0.006247450387339653, 0.006192960599621227, 0.0061377201202821655,
      0.00608175485514838, 0.006025090608438097, 0.0059677530734491245,
      0.005909767823498541, 0.00585116030311249, 0.005791955819463711, 0.005732179534054414,
      0.005671856454642096, 0.00561101142740585, 0.005549669129350709, 0.005487854060947538,
      0.005425590539005967, 0.005362902689777831, 0.005299814442288583,
      0.005236349521894093, 0.005172531444060264, 0.005108383508362853,
      0.005043928792704888, 0.004979190147749042, 0.004914190191562311,
      0.004848951304470359, 0.00478349562411883, 0.00471784504073896, 0.004652021192614797,
      0.004586045461749322, 0.00451993896972676, 0.004453722573768359, 0.004387416862978929,
      0.004321042154781388, 0.004254618491536594, 0.004188165637345721,
      0.004121703075032435, 0.004055250003302125, 0.003988825334075443,
      0.003922447689993411, 0.003856135402091335, 0.0037899065076387986,
      0.0037237787481429765, 0.0036577695675125304, 0.003591896110379355,
      0.00352617522057543, 0.0034606234397620518, 0.0033952570062087215,
      0.0033300918537189704, 0.003265143610700409, 0.0032004275993762926,
      0.003135958835135915, 0.0030717520260211345, 0.0030078215723463564,
      0.002944181566449306, 0.0028808457925699298, 0.0028178277268547814,
      0.0027551405374842547, 0.002692797084920046, 0.002630809922270231,
      0.0025691912957693623, 0.002507953145371004, 0.002447107105450139,
      0.00238666450561289, 0.002326636371611025, 0.0022670334263587234,
      0.002207866091049092, 0.002149144486367951, 0.0020908784338024176,
      0.0020330774570418322, 0.001975750783468596, 0.0019189073457365046,
      0.0018625557834341753, 0.0018067044448312022, 0.0017513613887046695,
      0.0016965343862436946, 0.0016422309230296804, 0.0015884582010899828,
      0.0015352231410227194, 0.0014825323841904635, 0.0014303922949805957,
      0.001378808963130102, 0.0013277882061126336, 0.0012773355715856608,
      0.0012274563398955848, 0.0011781555266386844, 0.0011294378852758082,
      0.0010813079097987351, 0.001033769837446162, 0.0009868276514672914,
      0.0009404850839310221, 0.0008947456185787677, 0.0008496124937189512,
      0.0008050887051612537, 0.0007611770091887144, 0.0007178799255658057,
      0.0006751997405806364, 0.000633138510119454, 0.0005916980627716482,
      0.0005508800029634819, 0.0005106857141187989, 0.0004711163618449869,
      0.0004321728971424976, 0.0003938560596362514, 0.0003561663808272821,
      0.0003191041873630005, 0.0002826696043244829, 0.0002468625585292159,
      0.00021168278184775557, 0.00017712981453278382, 0.00014320300855907175,
      0.00010990153097288514, 7.722436724939323e-05, 4.517032465666796e-05,
      1.3738035624886523e-05, -1.7074038880624072e-05, -4.726760598383585e-05,
      -7.684453752127208e-05, -0.00010580686666534688, -0.00013415678454905102,
      -0.0001618966368932166, -0.00018902892063756897, -0.00021555628057674738,
      -0.0002414815060024522, -0.0002668075273528501, -0.0002915374128703448,
      -0.0003156743652687941, -0.00033922171841123215, -0.0003621829339991282,
      -0.00038456159827419023, -0.00040636141873369685, -0.00042758622086031727,
      -0.0004482399448673537, -0.00046832664246031816, -0.0004878504736157307,
      -0.0005068157033780028, -0.0005252266986752463, -0.000543087925154824,
      -0.0005604039440394372, -0.0005771794090045204, -0.0005934190630776892,
      -0.0006091277355609706, -0.000624310338976515, -0.0006389718660364733,
      -0.0006531173866376966, -0.0006667520448818952, -0.0006798810561218741,
      -0.0006925097040344356, -0.0007046433377205257, -0.0007162873688331731,
      -0.0007274472687337531, -0.0007381285656770867, -0.0007483368420258648,
      -0.0007580777314948676, -0.0007673569164254305, -0.0007761801250905846,
      -0.0007845531290312858, -0.000792481740424122, -0.0007999718094808738,
      -0.0008070292218802812, -0.0008136598962323522, -0.0008198697815755329,
      -0.0008256648549070367, -0.0008310511187466158, -0.0008360345987340391,
      -0.0008406213412605226, -0.0008448174111343456, -0.000848628889280863,
      -0.0008520618704771121, -0.0008551224611211954, -0.0008578167770366023,
      -0.0008601509413116203, -0.0008621310821739688, -0.0008637633309007743,
      -0.0008650538197639882, -0.000866008680011339, -0.0008666340398828909,
      -0.0008669360226632682, -0.0008669207447695946, -0.0008665943138751754,
      -0.0008659628270689433, -0.0008650323690506755, -0.00086380901036197,
      -0.0008622988056529646, -0.0008605077919847654, -0.0008584419871675375,
      -0.0008561073881342054, -0.0008535099693496905, -0.0008506556812556084,
      -0.0008475504487503341, -0.0008442001697043316, -0.0008406107135106379,
      -0.0008367879196703756, -0.0008327375964131612, -0.0008284655193522672,
      -0.0008239774301743818, -0.0008192790353638065, -0.0008143760049609168,
      -0.000809273971354707, -0.0008039785281092286, -0.0007984952288237234,
      -0.0007928295860262454, -0.0007869870701005562, -0.0007809731082460709,
      -0.0007747930834706251, -0.0007684523336158248, -0.0007619561504147337,
      -0.0007553097785816477, -0.0007485184149336962, -0.0007415872075440064,
      -0.0007345212549261579, -0.0007273256052496517, -0.0007200052555861096,
      -0.0007125651511859138, -0.0007050101847849945, -0.000697345195941464,
      -0.0006895749704017931, -0.0006817042394962198, -0.0006737376795630783,
      -0.0006656799114017256, -0.0006575354997537475, -0.0006493089528121123,
      -0.0006410047217579459, -0.0006326272003245902, -0.0006241807243886101,
      -0.0006156695715874048, -0.0006070979609630814, -0.0005984700526322421,
      -0.0005897899474813363, -0.0005810616868872234, -0.0005722892524625935,
      -0.0005634765658258865, -0.0005546274883953519, -0.0005457458212068869,
      -0.0005368353047552921, -0.0005278996188585764, -0.0005189423825449506,
      -0.0005099671539621364, -0.0005009774303086288, -0.0004919766477865367,
      -0.00048296818157563627, -0.00047395534582826405, -0.00046494139368467944,
      -0.00045592951730852386, -0.00044692284794200653, -0.0004379244559804432,
      -0.00042893735106577666, -0.0004199644821987075, -0.00041100873786906303,
      -0.0004020729462040338, -0.0003931598751339066, -0.0003842722325749245,
      -0.00037541266662890484, -0.0003665837657992465, -0.0003577880592229593,
      -0.00034902801691834995, -0.0003403060500479987, -0.00033162451119666403,
      -0.00032298569466375254, -0.0003143918367699935, -0.0003058451161779593,
      -0.0002973476542260742, -0.00028890151527575603, -0.00028050870707133747,
      -0.00027217118111241465, -0.0002638908330382743, -0.00025566950302405154,
      -0.00024750897618827373, -0.0002394109830114467, -0.00023137719976534435,
      -0.00022340924895266235, -0.0002155086997567012, -0.0002076770685007461,
      -0.00019991581911681311, -0.00019222636362343452, -0.00018461006261215898,
      -0.00017706822574244484, -0.00016960211224462763, -0.00016221293143064654,
      -0.00015490184321221683, -0.00014766995862613882, -0.0001405183403664372,
      -0.00013344800332302717, -0.0001264599151266078, -0.0001195549966994858,
      -0.00011273412281203621, -0.00010599812264451058, -9.934778035390574e-05,
      -9.278383564561013e-05, -8.630698434954828e-05, -7.991787900054722e-05,
      -7.361712942265247e-05, -6.740530331712457e-05, -6.128292685385089e-05,
      -5.525048526591101e-05, -4.9308423447037786e-05, -4.345714655171954e-05,
      -3.7697020597692946e-05, -3.202837307057965e-05, -2.645149353042332e-05,
      -2.0966634219887933e-05, -1.5574010673881474e-05, -1.0273802330373267e-05,
      -5.0661531421768625e-06, 4.8827810525831064e-08, 5.071065707139574e-06,
      1.0000519373306657e-05, 1.4837180667466407e-05, 1.9581073867532324e-05,
      2.423225505789202e-05, 2.8790811516931274e-05, 3.325686110527975e-05,
      3.7630551654971985e-05, 4.1912060359713594e-05, 4.610159316643864e-05,
      5.0199384168340435e-05, 5.420569499955413e-05, 5.812081423166582e-05,
      6.194505677221882e-05, 6.567876326538429e-05, 6.93222994949594e-05,
      7.287605578985263e-05, 7.634044643221183e-05, 7.971590906834724e-05,
      8.300290412259774e-05, 8.62019142142849e-05, 8.931344357789588e-05,
      9.233801748663249e-05, 9.527618167945985e-05, 9.812850179178509e-05,
      0.0001008955627898921, 0.00010357796840925539, 0.0001061763405968525,
      0.00010869131895759044, 0.00011112356020495863, 0.00011347373761601714,
      0.0001157425404908254, 0.00011793067361641355, 0.00012003885673539467,
      0.00012206782401931324, 0.00012401832354682151, 0.00012589111678677233,
      0.0001276869780863135, 0.0001294066941640661, 0.00013105106360846436,
      0.0001326208963813344, 0.00013411701332678223, 0.00013554024568546185,
      0.00013689143461428885, 0.00013817143071166276, 0.00013938109354825811,
      0.00014052129120344166, 0.00014159289980736957, 0.00014259680308881603,
      0.00014353389192878126, 0.00014440506391992492, 0.00014521122293186716,
      0.00014595327868239754, 0.00014663214631462874, 0.00014724874598012955,
      0.0001478040024280693, 0.00014829884460040242, 0.00014873420523311997,
      0.00014911102046359228, 0.000149430229444024, 0.00014969277396104086,
      0.00014989959806142446, 0.00015005164768400978, 0.00015014987029775682,
      0.00015019521454600615, 0.0001501886298969257, 0.00015013106630015386,
      0.0001500234738496414, 0.00014986680245269345, 0.00014966200150520945,
      0.00014941001957311816, 0.0001491118040800018, 0.00014876830100090183,
      0.00014838045456229672, 0.00014794920694824075, 0.0001474754980126496,
      0.0001469602649977187, 0.00014640444225845595, 0.00014580896099331155,
      0.00014517474898088293, 0.00014450273032267405, 0.0001437938251918839,
      0.00014304894958819966, 0.00014226901509856703, 0.00014145492866390926,
      0.00014060759235176478, 0.00013972790313481202, 0.0001388167526752481,
      0.00013787502711498756, 0.00013690360687164477, 0.0001359033664402635,
      0.00013487517420075512, 0.00013381989223100593, 0.00013273837612561284,
      0.0001316314748202055, 0.00013050003042131193, 0.000129344878041723,
      0.0001281668456413112, 0.0001269667538732572, 0.0001257454159356367,
      0.00012450363742831964, 0.00012324221621513265, 0.00012196194229123452,
      0.00012066359765565399, 0.00011934795618893807, 0.00011801578353585844,
      0.00011666783699312264, 0.00011530486540203597, 0.0001139276090460596,
      0.00011253679955320946, 0.00011113315980323973, 0.00010971740383955485,
      0.00010829023678579228, 0.00010685235476701873, 0.00010540444483548146,
      0.00010394718490085603, 0.0001024812436649313, 0.00010100728056067212,
      9.952594569559973e-05, 9.803787979942942e-05, 9.654371417590499e-05,
      9.504407065876879e-05, 9.353956157180602e-05, 9.203078969290205e-05,
      9.051834822205048e-05, 8.900282075325023e-05, 8.748478125022958e-05,
      8.596479402593427e-05, 8.444341372571787e-05, 8.292118531417126e-05,
      8.139864406552862e-05, 7.987631555758746e-05, 7.835471566907938e-05,
      7.683435058042926e-05, 7.531571677783947e-05, 7.379930106063685e-05,
      7.228558055181919e-05, 7.077502271173882e-05, 6.926808535486051e-05,
      6.77652166695312e-05, 6.626685524069913e-05, 6.47734300755201e-05,
      6.328536063178885e-05, 6.180305684913352e-05, 6.032691918291129e-05,
      5.885733864074415e-05, 5.739469682163302e-05, 5.593936595758946e-05,
      5.449170895772405e-05, 5.3052079454731016e-05, 5.162082185370892e-05,
      5.019827138325735e-05, 4.878475414879024e-05, 4.73805871880065e-05,
      4.5986078528458994e-05, 4.4601527247163554e-05, 4.322722353218963e-05,
      4.186344874617511e-05, 4.0510475491707785e-05, 3.9168567678516596e-05,
      3.7837980592416196e-05, 3.651896096594878e-05, 3.521174705066755e-05,
      3.3916568691006685e-05, 3.263364739968324e-05, 3.136319643457668e-05,
      3.0105420877032438e-05, 2.8860517711536318e-05, 2.7628675906706995e-05,
      2.6410076497554537e-05, 2.5204892668953335e-05, 2.401328984027827e-05,
      2.283542575115363e-05, 2.16714505482648e-05, 2.0521506873183222e-05,
      1.9385729951155816e-05, 1.826424768081051e-05, 1.715718072473019e-05,
      1.606464260084791e-05, 1.4986739774616785e-05, 1.3923571751908647e-05,
      1.2875231172596077e-05, 1.1841803904773026e-05, 1.0823369139569917e-05,
      9.819999486519628e-06, 8.831761069431457e-06, 7.858713622730756e-06,
      6.900910588222511e-06, 5.958399212237814e-06, 5.031220643122798e-06,
      4.119410029030172e-06, 3.2229966159742132e-06, 2.3420038461106364e-06,
      1.4764494562034277e-06, 6.263455762413562e-07, -2.083011718324932e-07,
      -1.0274895753141716e-06, -1.8312237318906824e-06, -2.6195129507849004e-06,
      -3.3923716539276907e-06, -4.149819277190696e-06, -4.891880171712606e-06,
      -5.618583505351109e-06, -6.329963164292066e-06, -7.026057654846823e-06,
      -7.706910005467957e-06, -8.372567669013073e-06, -9.023082425285706e-06,
      -9.658510283881681e-06, -1.02789113873687e-05, -1.0884349914826313e-05,
      -1.1474893985772724e-05, -1.2050615564504383e-05, -1.261159036487358e-05,
      -1.3157897755528725e-05, -1.3689620665641345e-05, -1.4206845491143214e-05,
      -1.4709662001496453e-05, -1.519816324701882e-05, -1.567244546678578e-05,
      -1.613260799713042e-05, -1.65787531807616e-05, -1.7010986276520213e-05,
      -1.7429415369792762e-05, -1.7834151283601002e-05, -1.822530749038566e-05,
      -1.8603000024501842e-05, -1.8967347395443016e-05, -1.931847050181004e-05,
      -1.9656492546041e-05, -1.998153894991721e-05, -2.0293737270860035e-05,
      -2.0593217119032853e-05, -2.0880110075261673e-05, -2.1154549609787655e-05,
      -2.141667100186403e-05, -2.166661126020957e-05, -2.1904509044330118e-05,
      -2.2130504586719287e-05, -2.2344739615948762e-05, -2.2547357280658393e-05,
      -2.2738502074455475e-05, -2.29183197617324e-05, -2.3086957304411203e-05,
      -2.3244562789623114e-05, -2.3391285358330715e-05, -2.3527275134899937e-05,
      -2.3652683157628578e-05, -2.376766131023757e-05, -2.387236225433083e-05,
      -2.3966939362829083e-05, -2.4051546654382582e-05, -2.4126338728767216e-05,
      -2.419147070326816e-05, -2.424709815005467e-05, -2.429337703454931e-05,
      -2.433046365479455e-05, -2.435851458181911e-05, -2.4377686601006174e-05,
      -2.4388136654465187e-05, -2.439002178440857e-05, -2.438349907753423e-05,
      -2.4368725610414593e-05, -2.4345858395892254e-05, -2.4315054330482228e-05,
      -2.4276470142780324e-05, -2.42302623428768e-05, -2.4176587172774266e-05,
      -2.4115600557808296e-05, -2.404745805906902e-05, -2.3972314826821636e-05,
      -2.3890325554923443e-05, -2.3801644436234717e-05, -2.3706425119020434e-05,
      -2.3604820664339653e-05, -2.3496983504418927e-05, -2.338306540200602e-05,
      -2.3263217410699772e-05, -2.313758983625188e-05, -2.3006332198835907e-05,
      -2.286959319627872e-05, -2.2727520668249303e-05, -2.258026156139958e-05,
      -2.2427961895451776e-05, -2.227076673022646e-05, -2.2108820133605396e-05,
      -2.1942265150422886e-05, -2.1771243772279325e-05, -2.1595896908270285e-05,
      -2.141636435662438e-05, -2.123278477724295e-05, -2.104529566513434e-05,
      -2.0854033324735543e-05, -2.0659132845113595e-05, -2.0460728076039136e-05,
      -2.0258951604924276e-05, -2.005393473461681e-05, -1.984580746204262e-05,
      -1.963469845768805e-05, -1.9420735045913795e-05, -1.920404318609183e-05,
      -1.8984747454556677e-05, -1.876297102736224e-05, -1.853883566383534e-05,
      -1.8312461690916882e-05, -1.8083967988281656e-05, -1.7853471974227445e-05,
      -1.7621089592324224e-05, -1.7386935298813993e-05, -1.7151122050751835e-05,
      -1.691376129487859e-05, -1.6674962957215513e-05, -1.6434835433371265e-05,
      -1.6193485579551393e-05, -1.5951018704260563e-05, -1.5707538560687536e-05,
      -1.546314733976309e-05, -1.5217945663880773e-05, -1.4972032581270535e-05,
      -1.4725505561015132e-05, -1.4478460488699228e-05, -1.4230991662681014e-05,
      -1.3983191790976221e-05, -1.3735151988744317e-05, -1.3486961776366686e-05,
      -1.323870907810656e-05, -1.2990480221340494e-05, -1.274235993635112e-05,
      -1.2494431356670927e-05, -1.2246776019966856e-05, -1.199947386945543e-05,
      -1.1752603255838204e-05, -1.1506240939747298e-05, -1.1260462094690793e-05,
      -1.1015340310487828e-05, -1.0770947597183153e-05, -1.0527354389431052e-05,
      -1.028462955133846e-05, -1.004284038175721e-05, -9.80205262001528e-06,
      -9.56233045207709e-06, -9.32373651712277e-06, -9.086331914536499e-06,
      -8.850176211293973e-06, -8.615327449739127e-06, -8.381842155740334e-06,
      -8.14977534721624e-06, -7.919180543021583e-06, -7.690109772183294e-06,
      -7.46261358347729e-06, -7.236741055336405e-06, -7.012539806079991e-06,
      -6.790056004455748e-06, -6.5693343804844534e-06, -6.3504182365982855e-06,
      -6.1333494590635395e-06, -5.918168529678577e-06, -5.704914537737967e-06,
      -5.493625192253797e-06, -5.284336834425244e-06, -5.077084450347584e-06,
      -4.871901683951861e-06, -4.66882085016655e-06, -4.46787294829262e-06,
      -4.269087675583498e-06, -4.072493441021487e-06, -3.87811737928234e-06,
      -3.685985364879717e-06, -3.496122026481385e-06, -3.3085507613890807e-06,
      -3.1232937501740867e-06, -2.9403719714606215e-06, -2.759805216849272e-06,
      -2.5816121059727713e-06, -2.405810101676533e-06, -2.232415525316441e-06,
      -2.061443572166501e-06, -1.892908326929046e-06, -1.7268227793403036e-06,
      -1.5631988398642117e-06, -1.4020473554674913e-06, -1.24337812546907e-06,
      -1.0871999174570577e-06, -9.335204832665772e-07, -7.823465750118575e-07,
      -6.33683961166091e-07, -4.875374426826704e-07, -3.4391086915151645e-07,
      -2.0280715498431526e-07, -6.422829562258454e-08, 7.182461623740496e-08,
      2.05351374408724e-07, 3.363526429726627e-07, 4.6482994003805355e-07,
      5.907856215065984e-07, 7.142228648496525e-07, 8.351456529018172e-07,
      9.535587576765847e-07, 1.069467724209178e-06, 1.182878854431624e-06,
      1.2937991910849923e-06, 1.402236501673634e-06, 1.5081992624661401e-06,
      1.6116966425476558e-06, 1.712738487928061e-06, 1.8113353057104444e-06,
      1.907498248324184e-06, 2.001239097826854e-06, 2.0925702502790698e-06,
      2.1815047001962888e-06, 2.268056025081476e-06, 2.352238370042455e-06,
      2.434066432497656e-06, 2.5135554469738743e-06, 2.5907211699995692e-06,
      2.6655798650971103e-06, 2.7381482878773047e-06, 2.808443671239431e-06,
      2.8764837106799124e-06, 2.9422865497126647e-06, 3.0058707654040695e-06,
      3.0672553540254117e-06, 3.1264597168255505e-06, 3.1835036459264818e-06,
      3.2384073103443687e-06, 3.291191242138527e-06, 3.341876322690753e-06,
      3.3904837691173093e-06, 3.4370351208157798e-06, 3.481552226148922e-06,
      3.5240572292675727e-06, 3.5645725570745567e-06, 3.603120906331477e-06,
      3.6397252309101766e-06, 3.6744087291905834e-06, 3.707194831606565e-06,
      3.7381071883413446e-06, 3.7671696571739302e-06, 3.7944062914779664e-06,
      3.819841328374303e-06, 3.843499177038524e-06, 3.865404407164589e-06,
      3.88558173758567e-06, 3.904056025053204e-06, 3.920852253175082e-06,
      3.935995521513847e-06, 3.949511034845702e-06, 3.96142409258104e-06,
      3.971760078347151e-06, 3.980544449733714e-06, 3.9878027282015726e-06,
      3.993560489155257e-06, 3.997843352179653e-06, 4.000676971441132e-06,
      4.002087026253419e-06, 4.002099211808388e-06, 4.000739230071951e-06,
      3.998032780845107e-06, 3.994005552990179e-06, 3.988683215822214e-06,
      3.982091410665462e-06, 3.9742557425747804e-06, 3.965201772221782e-06,
      3.954955007945461e-06, 3.943540897967022e-06, 3.930984822768533e-06,
      3.917312087635018e-06, 3.902547915359537e-06, 3.886717439110752e-06,
      3.869845695462445e-06, 3.8519576175843846e-06, 3.833078028593922e-06,
      3.813231635067626e-06, 3.792443020712249e-06, 3.7707366401942544e-06,
      3.748136813127112e-06, 3.7246677182155115e-06, 3.7003533875556246e-06,
      3.6752177010904925e-06, 3.6492843812195886e-06, 3.6225769875615705e-06,
      3.5951189118691945e-06, 3.5669333730953403e-06, 3.538043412609058e-06,
      3.508471889560517e-06, 3.4782414763937053e-06, 3.447374654505703e-06,
      3.415893710051317e-06, 3.38382072989185e-06, 3.3511775976867304e-06,
      3.3179859901267255e-06, 3.2842673733074177e-06, 3.250042999241611e-06,
      3.2153339025093043e-06, 3.180160897043854e-06, 3.144544573052921e-06,
      3.1085052940727736e-06, 3.072063194154511e-06, 3.035238175180742e-06,
      2.9980499043112343e-06, 2.9605178115560485e-06, 2.922661087474631e-06,
      2.8844986809993523e-06, 2.84604929738193e-06, 2.8073313962611976e-06,
      2.7683631898506373e-06, 2.7291626412441017e-06, 2.689747462838128e-06,
      2.6501351148692417e-06, 2.6103428040646363e-06, 2.570387482404605e-06,
      2.5302858459950943e-06, 2.490054334048743e-06, 2.4497091279727544e-06,
      2.4092661505619494e-06, 2.368741065295352e-06, 2.3281492757346307e-06,
      2.2875059250227394e-06, 2.2468258954810764e-06, 2.2061238083035003e-06,
      2.165414023345509e-06, 2.124710639006922e-06, 2.0840274922063708e-06,
      2.0433781584459277e-06, 2.0027759519641855e-06, 1.9622339259761154e-06,
      1.9217648729980174e-06, 1.8813813252558912e-06, 1.8410955551755528e-06,
      1.8009195759528229e-06, 1.7608651422021206e-06, 1.7209437506817963e-06,
      1.6811666410945444e-06, 1.6415447969612394e-06, 1.6020889465665465e-06,
      1.5628095639746609e-06, 1.5237168701135377e-06, 1.4848208339259817e-06,
      1.4461311735859707e-06, 1.4076573577785976e-06, 1.3694086070420191e-06,
      1.3313938951698143e-06, 1.2936219506721566e-06, 1.25610125829422e-06,
      1.218840060590243e-06, 1.1818463595516897e-06, 1.145127918287952e-06,
      1.1086922627580517e-06, 1.072546683551809e-06, 1.03669823771896e-06,
      1.0011537506447104e-06, 9.659198179702285e-07, 9.310028075565956e-07,
      8.964088614907368e-07, 8.62143898131875e-07, 8.282136141970599e-07,
      7.946234868843387e-07, 7.613787760321461e-07, 7.284845263135105e-07,
      6.959455694636793e-07, 6.637665265397889e-07, 6.319518102112117e-07,
      6.005056270792331e-07, 5.694319800247215e-07, 5.387346705824722e-07,
      5.084173013409213e-07, 4.784832783659385e-07, 4.4893581364742614e-07,
      4.197779275674644e-07
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_4_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<4>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.00010688761689138197), "design.b()[0] == 0.00010688761689138197");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.00010688761689138197));
    static_assert(almost_equal(design.b()[1], -0.00037768909481264657), "design.b()[1] == -0.00037768909481264657");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.00037768909481264657));
    static_assert(almost_equal(design.b()[2], 0.0005446874763283452), "design.b()[2] == 0.0005446874763283452");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.0005446874763283452));
    static_assert(almost_equal(design.b()[3], -0.0003776890948126467), "design.b()[3] == -0.0003776890948126467");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.0003776890948126467));
    static_assert(almost_equal(design.b()[4], 0.000106887616891382), "design.b()[4] == 0.000106887616891382");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.000106887616891382));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -3.8893064154995103), "design.a()[1] == -3.8893064154995103");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -3.8893064154995103));
    static_assert(almost_equal(design.a()[2], 5.674005151861995), "design.a()[2] == 5.674005151861995");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 5.674005151861995));
    static_assert(almost_equal(design.a()[3], -3.6798965409222673), "design.a()[3] == -3.6798965409222673");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -3.6798965409222673));
    static_assert(almost_equal(design.a()[4], 0.8952008890802685), "design.a()[4] == 0.8952008890802685");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.8952008890802685));
    std::cout << "max_deviation(cheby2,lowpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.00010688761689138197, 3.802959930045911e-05, 8.611535195454407e-05, 0.00013479512532912853,
      0.00018678731321311321, 0.00024449631472301195, 0.00031003048374320856,
      0.00038521947181601357, 0.00047163097507628253, 0.0005705868958210585,
      0.0006831789292990153, 0.0008102835862973986, 0.000952576662095654,
      0.0011105471623449456, 0.0012845106964212301, 0.0014746223487863905,
      0.0016808890388770271, 0.0019031813800237853, 0.002141245047885418,
      0.002394711668861047, 0.002663109238921166, 0.0029458720832726704,
      0.003242350367245541, 0.003551819168758545, 0.003873487122688382,
      0.004206504647430963, 0.0045499717639048, 0.004902945517204788, 0.005264447011069732,
      0.00563346806527887, 0.006008977506041121, 0.006389927099385878, 0.006775257137505694,
      0.007163901687939178, 0.0075547935154167585, 0.007946868686122523,
      0.00833907086405225, 0.00873035530907082, 0.009119692586191438, 0.009506071995514637,
      0.009888504732176576, 0.010266026785564007, 0.010637701586957336, 0.01100262241466338,
      0.011359914565595972, 0.011708737302155332, 0.01204828558314628, 0.012377791587360958,
      0.01269652603833376, 0.013003799338654788, 0.013298962522103434, 0.013581408031735659,
      0.013850570331927464, 0.014105926362242789, 0.014346995840856996,
      0.014573341425127194, 0.014784568736757958, 0.014980326258865959,
      0.015160305112099363, 0.01532423871681804, 0.015471902348188633, 0.015603112590894697,
      0.01571772670000622, 0.015815641874395547, 0.01589679444892768, 0.015961159011492775,
      0.016008747450787154, 0.016039607940586648, 0.016053823866092838,
      0.016051512697768763, 0.01603282481791607, 0.01599794230508081, 0.015947077681209967,
      0.01588047262631572, 0.015798396665239516, 0.01570114583094339, 0.015589041308591851,
      0.015462428064523949, 0.015321673464052554, 0.01516716588186584, 0.014999313308645297,
      0.014818541957355033, 0.014625294872498924, 0.014420030545485511,
      0.014203221539085473, 0.013975353123813303, 0.01373692192891341, 0.013488434610481548,
      0.01323040653910526, 0.012963360509262133, 0.012687825472572044, 0.012404335296859519,
      0.012113427552844738, 0.01181564233014687, 0.011511521084151266, 0.011201605515162825,
      0.010886436481141362, 0.010566552945191467, 0.010242490958858961,
      0.009914782682168846, 0.00958395544122554, 0.009250530824085366, 0.008915023815503652,
      0.008577941971054534, 0.008239784631020573, 0.007901042174351787,
      0.0075621953128994675, 0.00722371442603938, 0.006886058935711651,
      0.006549676721820708, 0.006215003577858199, 0.0058824627065347836,
      0.0055524642551331126, 0.005225404890224172, 0.004901667411322405,
      0.0045816204029917075, 0.004265617924854378, 0.003953999238898524,
      0.0036470885734260685, 0.0033451949229335066, 0.003048611883170736,
      0.0027576175205797325, 0.002472474275274387, 0.002193428896685506,
      0.001920712410960708, 0.0016545401191776846, 0.001395111625400976,
      0.0011426108935869827, 0.0008972063323193268, 0.0006590509063368211,
      0.0004282822737991655, 0.00020502294822095013, -1.0619516007424738e-05,
      -0.00021855231560278946, -0.00041869716897416636, -0.0006109900665123551,
      -0.0007953810016893311, -0.0009718336840729485, -0.0011403252353606413,
      -0.0013008458695319839, -0.0014533985582142052, -0.0015979986823471109,
      -0.0017346736712244397, -0.0018634626299775517, -0.001984415956554586,
      -0.002097594949233933, -0.002203071405695085, -0.0023009272146527976,
      -0.0023912539410420163, -0.0024741524057213613, -0.0025497322606421197,
      -0.002618111560407796, -0.0026794163311263898, -0.0027337801374337466,
      -0.002781343648541681, -0.0028222542041391498, -0.0028566653809486316,
      -0.0028847365607131362, -0.002906632500361961, -0.0029225229050755374,
      -0.0029325820049415016, -0.0029369881358655824, -0.0029359233253720314,
      -0.002929572883899275, -0.002918125002167213, -0.0029017703551632423,
      -0.0028807017132647, -0.0028551135609860157, -0.002825201723809522,
      -0.002791163003529669, -0.0027531948225112905, -0.00271149487723373,
      -0.0026662608014640116, -0.0026176898393739352, -0.0025659785288879872,
      -0.002511322395521357, -0.0024539156569401664, -0.002393950938449279,
      -0.002331618999586796, -0.00226710847197861, -0.002200605608581197,
      -0.0021322940444161945, -0.0020623545688762965, -0.0019909649096585963,
      -0.001918299528358743, -0.0018445294277371956, -0.0017698219706474387,
      -0.0016943407105953281, -0.0016182452338787219, -0.0015416910132372954,
      -0.0014648292729239117, -0.0013878068650911212, -0.001310766157369355,
      -0.001233844931497102, -0.001157176292847865, -0.0010808885906839634,
      -0.001005105348953296, -0.0009299452074319906, -0.0008555218730034579,
      -0.00078194408085272, -0.0007093155653440071, -0.0006377350403394943,
      -0.0005672961887076876, -0.0004980876607613483, -0.0004301930813569608,
      -0.00036369106538059934, -0.00029865524133861434, -0.0002351542827658303,
      -0.00017325194715891448, -0.00011300712213822394, -5.447387853775392e-05,
      2.298469880220315e-06, 5.726530039161104e-05, 0.00011038660926566995,
      0.00016162693401756663, 0.00021095527026771617, 0.0002583449835171876,
      0.00030377371614798273, 0.00034722328995589915, 0.0003886796045220987,
      0.0004281325317274183, 0.0004655758067108964, 0.0005010069155709678,
      0.0005344269801043253, 0.0005658406398735736, 0.0005952559318905288,
      0.0006226841681973756, 0.0006481398116228864, 0.000671640349985572,
      0.0006932061690099781, 0.0007128604242163882, 0.0007306289120379704,
      0.0007465399404129203, 0.0007606241990924328, 0.0007729146298983977,
      0.0007834462971575817, 0.0007922562585317384, 0.0007993834364556224,
      0.0008048684903872554, 0.0008087536900670614, 0.0008110827899746307,
      0.000811900905163942, 0.0008112543886498575, 0.0008091907105106438,
      0.000805758338863163, 0.0008010066228592502, 0.000794985677843656,
      0.0007877462728057977, 0.0007793397202494499, 0.0007698177685964286,
      0.0007592324972322847, 0.0007476362142940585, 0.0007350813572922373,
      0.0007216203966512475, 0.0007073057422450875, 0.0006921896529970893,
      0.0006763241496052985, 0.0006597609304475885, 0.0006425512907133773,
      0.000624746044801724, 0.0006063954520186296, 0.0005875491455995837,
      0.0005682560650767722, 0.0005485643920039105, 0.0005285214890454006,
      0.0005081738424304125, 0.00048756700776660025, 0.0004667455592024495,
      0.0004457530419217483, 0.00042463192794836265, 0.0004034235752343933,
      0.0003821681899998941, 0.00036090479228764066, 0.0003396711846919613,
      0.0003185039242163722, 0.0002974382972107065, 0.0002765082973345842,
      0.0002557466064904406, 0.00023518457866591753, 0.00021485222662221662,
      0.00019477821136202255, 0.00017498983430782255, 0.0001555130321188742,
      0.00013637237407270613, 0.00011759106193487266, 9.919093223872169e-05,
      8.119246089517137e-05, 6.361477005092274e-05, 4.647563711215999e-05,
      2.97915058496024e-05, 1.3577499499769152e-05, -2.152564223503987e-06,
      -1.7386156293902793e-05, -3.211201780090766e-05, -4.632013972888793e-05,
      -6.0001741174547053e-05, -7.314924609023348e-05, -8.575625864046439e-05,
      -9.78175372586939e-05, -0.00010932896749089903, -0.00012028753371196092,
      -0.0001306912898000911, -0.0001405393288536976, -0.00014983175203411067,
      -0.00015856963661649564, -0.00016675500333007985, -0.00017439078306751346,
      -0.00018148078304177924, -0.00018802965246756764, -0.00019404284784244746,
      -0.00019952659790149242, -0.00020448786831727967, -0.00020893432621535782,
      -0.0002128743045734004, -0.00021631676657031626, -0.00021927126994958986,
      -0.0002217479314590759, -0.0002237573914273789, -0.0002253107785348149,
      -0.00022641967483478511, -0.00022709608107919217, -0.00022735238239930786,
      -0.00022720131439125674, -0.00022665592965302197, -0.0002257295648176083,
      -0.0002244358081247206, -0.00022278846757103486, -0.0002208015396768609,
      -0.00021848917890472175, -0.00021586566776311074, -0.00021294538762643418,
      -0.00020974279029991434, -0.00020627237035601004, -0.00020254863826672082,
      -0.00019858609435397358, -0.0001943992035781534, -0.000190002371182736,
      -0.00018540991921090757, -0.00018063606390802457, -0.0001756948940217736,
      -0.00017060035000993794, -0.00016536620416377076, -0.00016000604165311322,
      -0.0001545332424975807, -0.00014896096446637684, -0.0001433021269075808,
      -0.00013756939550609292, -0.00013177516796781575, -0.00012593156062609516,
      -0.00012005039596494987, -0.00011414319105217742, -0.00010822114687404193,
      -0.00010229513856192476, -9.637570650005355e-05, -9.047304830221773e-05,
      -8.459701164423132e-05, -7.87570879378155e-05, -7.296240683054444e-05,
      -6.722173151552864e-05, -6.15434548335995e-05, -5.593559614990791e-05,
      -5.0405798986056545e-05, -4.496132938815116e-05, -3.9609075010479375e-05,
      -3.435554489390519e-05, -2.9206869917503746e-05, -2.4168803901452815e-05,
      -1.9246725338743832e-05, -1.444563973287548e-05, -9.770182518345655e-06,
      -5.224622540462265e-06, -8.128660707485258e-07, 3.4615386659770764e-06,
      7.595396476913142e-06, 1.1585859723147285e-05, 1.5430422402309493e-05,
      1.9126913816239034e-05, 2.267349184786443e-05, 2.6068635871421755e-05,
      2.9311139320022388e-05, 3.2400101934428266e-05, 3.533492171670281e-05,
      3.8115286612179936e-05, 4.0741165942933746e-05, 4.321280161563915e-05,
      4.5530699126390114e-05, 4.769561838468937e-05, 4.970856437844245e-05,
      5.157077770138151e-05, 5.328372496391236e-05, 5.4849089107922446e-05,
      5.626875964561033e-05, 5.754482284189955e-05, 5.8679551859483524e-05,
      5.967539688501452e-05, 6.053497525440035e-05, 6.126106159460895e-05,
      6.185657799880425e-05, 6.232458425104907e-05, 6.266826811621238e-05,
      6.289093571011206e-05, 6.299600196430952e-05, 6.298698119935341e-05,
      6.286747781964375e-05, 6.264117714246031e-05, 6.231183637306809e-05,
      6.188327573718085e-05, 6.13593697814322e-05, 6.0744038851873e-05,
      6.004124075988554e-05, 5.925496264427987e-05, 5.8389213037716726e-05,
      5.744801414498603e-05, 5.643539434006014e-05, 5.535538088823888e-05,
      5.4211992899108255e-05, 5.300923451544932e-05, 5.175108834265638e-05,
      5.044150912265788e-05, 4.9084417655777116e-05, 4.7683694973425946e-05,
      4.624317676399226e-05, 4.476664805376249e-05, 4.325783814421386e-05,
      4.1720415806518124e-05, 4.015798473361963e-05, 3.857407924978596e-05,
      3.697216027708007e-05, 3.5355611557767795e-05, 3.3727736131255816e-05,
      3.20917530637514e-05, 3.0450794428447703e-05, 2.88079025336669e-05,
      2.7166027396037916e-05, 2.552802445544657e-05, 2.3896652528173276e-05,
      2.2274571994327212e-05, 2.0664343215396225e-05, 1.90684251774584e-05,
      1.7489174355344447e-05, 1.5928843792799657e-05, 1.4389582393469897e-05,
      1.2873434417328164e-05, 1.138233917696617e-05, 9.91813092799928e-06,
      8.48253894767258e-06, 7.077187795610839e-06, 5.703597750525245e-06,
      4.3631854165749385e-06, 3.0572644929811986e-06, 1.787046700406329e-06,
      5.536428575376745e-07, -6.419358987406945e-07, -1.798776756250493e-06,
      -2.916063740189079e-06, -3.993076102278351e-06, -5.029186593110533e-06,
      -6.0238596244028185e-06, -6.9766493278553925e-06, -7.887197517278613e-06,
      -8.755231560615619e-06, -9.580562168436717e-06, -1.0363081105421918e-05,
      -1.1102758831278544e-05, -1.1799642077462108e-05, -1.2453851365981312e-05,
      -1.3065578476472315e-05, -1.3635083867623872e-05, -1.4162694058923958e-05,
      -1.4648798978580432e-05, -1.5093849283343798e-05, -1.5498353655829305e-05,
      -1.586287608479922e-05, -1.6188033133724254e-05, -1.6474491202796467e-05,
      -1.672296378941482e-05, -1.693420875200932e-05, -1.7109025581910764e-05,
      -1.7248252687810863e-05, -1.7352764697192516e-05, -1.7423469778942322e-05,
      -1.7461306991187734e-05, -1.7467243658229756e-05, -1.744227278026913e-05,
      -1.7387410479450013e-05, -1.730369348557038e-05, -1.7192176664633383e-05,
      -1.705393059323859e-05, -1.689003918163722e-05, -1.6701597348100937e-05,
      -1.648970874708031e-05, -1.6255483553456458e-05, -1.600003630501845e-05,
      -1.5724483805129335e-05, -1.5429943087376277e-05, -1.5117529443834698e-05,
      -1.4788354518413223e-05, -1.4443524466585582e-05, -1.4084138182657858e-05,
      -1.3711285595564489e-05, -1.3326046034034766e-05, -1.2929486661823007e-05,
      -1.2522660983550601e-05, -1.2106607421566695e-05, -1.1682347964096577e-05,
      -1.1250886884813022e-05, -1.081320953383596e-05, -1.0370281200040044e-05,
      -9.923046044428042e-06, -9.472426104210706e-06, -9.019320367120618e-06,
      -8.564603915378922e-06, -8.10912713862959e-06, -7.653715015056179e-06,
      -7.19916645980076e-06, -6.7462537397140845e-06, -6.2957219533798604e-06,
      -5.848288575274569e-06, -5.404643062847165e-06, -4.96544652523064e-06,
      -4.531331452229562e-06, -4.102901502164293e-06, -3.680731347093768e-06,
      -3.2653665738842726e-06, -2.857323639541644e-06, -2.45708987917868e-06,
      -2.0651235649481766e-06, -1.681854014234896e-06, -1.3076817453668097e-06,
      -9.429786790771253e-07, -5.880883839237562e-07, -2.4332636385199474e-07,
      9.101961393089932e-08, 4.1468915261378327e-07, 7.274488228266066e-07,
      1.0290917249325675e-06, 1.3194370184303464e-06, 1.5983294203285594e-06,
      1.8656386743505758e-06, 2.1212589928206926e-06, 2.365108473072491e-06,
      2.5971284902071037e-06, 2.817283068013225e-06, 3.025558229842113e-06,
      3.2219613312096866e-06, 3.4065203758742145e-06, 3.579283317112154e-06,
      3.7403173458865633e-06, 3.889708167572244e-06, 4.027559268869577e-06,
      4.1539911765049135e-06, 4.269140709279602e-06, 4.373160224992254e-06,
      4.466216863719952e-06, 4.548491788903754e-06, 4.620179427642252e-06,
      4.681486711554199e-06, 4.732632319527377e-06, 4.7738459236261655e-06,
      4.805367439384653e-06, 4.827446281665878e-06, 4.840340627220821e-06,
      4.844316685033352e-06, 4.8396479754894905e-06, 4.826614619361117e-06,
      4.805502637545908e-06, 4.776603262456714e-06, 4.740212261905005e-06,
      4.696629276274498e-06, 4.646157169732635e-06, 4.589101396179389e-06,
      4.52576938058497e-06, 4.456469916320406e-06, 4.381512579037891e-06,
      4.301207157611147e-06, 4.215863102600005e-06, 4.125788992657973e-06,
      4.03129201925685e-06, 3.9326774900584545e-06, 3.830248351220364e-06,
      3.7243047288802335e-06, 3.615143490021848e-06, 3.5030578228855756e-06,
      3.3883368370464114e-06, 3.2712651832443224e-06, 3.1521226930142224e-06,
      3.0311840381265795e-06, 2.9087184098144696e-06, 2.784989217728865e-06,
      2.6602538085310735e-06, 2.5347632039995763e-06, 2.4087618584980427e-06,
      2.2824874356220915e-06, 2.1561706038143527e-06, 2.0300348507106615e-06,
      1.904296315954723e-06, 1.779163642194371e-06, 1.6548378439495934e-06,
      1.5315121940208061e-06, 1.4093721270854426e-06, 1.2885951601117627e-06,
      1.1693508292008836e-06, 1.0518006424513756e-06, 9.360980484253451e-07,
      8.223884197807395e-07, 7.108090516216218e-07, 6.014891741063784e-07,
      4.945499788432182e-07, 3.901046585928765e-07, 2.8825845979013524e-07,
      1.8910874738858704e-07, 9.274508152698814e-08, -7.506944894698798e-10,
      -9.130435540360035e-08, -1.7884918492994542e-07, -2.6332585690329946e-07,
      -3.4468230716852455e-07, -4.2287359672818887e-07, -4.978617666636856e-07,
      -5.696156853437398e-07, -6.381108884316096e-07, -7.033294121988707e-07,
      -7.65259620649469e-07, -8.238960269527732e-07, -8.792391096786736e-07,
      -9.312951243214138e-07, -9.80075910591817e-07, -1.0255986959499203e-06,
      -1.0678858958418018e-06, -1.1069649110955894e-06, -1.1428679229223274e-06,
      -1.175631685957569e-06, -1.2052973197693001e-06, -1.2319100992471116e-06,
      -1.2555192442764491e-06, -1.2761777090903345e-06, -1.2939419716791657e-06,
      -1.3088718236271367e-06, -1.321030160731473e-06, -1.3304827747481018e-06,
      -1.3372981465945804e-06, -1.3415472413281426e-06, -1.3433033052036038e-06,
      -1.3426416651026158e-06, -1.3396395306124335e-06, -1.3343757990189366e-06,
      -1.3269308634652021e-06, -1.3173864245134538e-06, -1.3058253053347407e-06,
      -1.2923312707372723e-06, -1.2769888502309408e-06, -1.2598831653122551e-06,
      -1.2410997611406936e-06, -1.2207244427643786e-06, -1.1988431160400121e-06,
      -1.175541633379193e-06, -1.1509056444405935e-06, -1.125020451875018e-06,
      -1.0979708722181153e-06, -1.0698411020134747e-06, -1.040714589237045e-06,
      -1.0106739100822532e-06, -9.798006511539066e-07, -9.481752971079384e-07,
      -9.158771237633128e-07, -8.829840967019525e-07, -8.495727753624038e-07,
      -8.157182226231087e-07, -7.814939198616321e-07, -7.469716874669922e-07,
      -7.122216107733652e-07, -6.773119713749029e-07, -6.423091837732044e-07,
      -6.072777373011267e-07, -5.722801432591132e-07, -5.373768871930566e-07,
      -5.026263862359066e-07, -4.6808495142876845e-07, -4.3380675493113815e-07,
      -3.9984380202415636e-07, -3.6624590780536207e-07, -3.330606784683674e-07,
      -3.0033349705616334e-07, -2.681075135723991e-07, -2.3642363933095214e-07,
      -2.0532054542041555e-07, -1.748346651567736e-07, -1.4500020039450821e-07,
      -1.1584913156367453e-07, -8.741123129809718e-08, -5.971408151776512e-08,
      -3.278309382673439e-08, -6.64153308637964e-09, 1.8689455977340945e-08,
      4.319081927483274e-08, 6.684556110486166e-08, 8.963870930078063e-08,
      1.1155727791424456e-07, 1.325902275794972e-07, 1.5272842370089225e-07,
      1.7196459260565227e-07, 1.902932758029802e-07, 2.0771078248953145e-07,
      2.242151404399328e-07, 2.398060454195145e-07, 2.5448480925470473e-07,
      2.682543066946376e-07, 2.8111892119544996e-07, 2.930844897565016e-07,
      3.041582469353568e-07, 3.1434876816581854e-07, 3.23665912500624e-07,
      3.321207648975969e-07, 3.397255781651182e-07, 3.4649371467973086e-07,
      3.5243958798554796e-07, 3.57578604381891e-07, 3.6192710460225836e-07,
      3.65502305684321e-07, 3.683222431271702e-07, 3.704057134285097e-07,
      3.7177221709090304e-07, 3.724419021825557e-07, 3.7243550853445077e-07,
      3.7177431265196314e-07, 3.7048007341536264e-07, 3.6857497863988916e-07,
      3.6608159256234847e-07, 3.6302280431744115e-07, 3.594217774633088e-07,
      3.553019006120655e-07, 3.5068673921738375e-07, 3.4559998856753355e-07,
      3.4006542802862875e-07, 3.341068765792302e-07, 3.2774814967388895e-07,
      3.2101301746969255e-07, 3.1392516444641123e-07, 3.065081504474249e-07,
      2.9878537316525993e-07, 2.907800320922741e-07, 2.8251509395380553e-07,
      2.7401325963794855e-07, 2.65296932633043e-07, 2.5638818898096254e-07,
      2.4730874875136737e-07, 2.3807994903925034e-07, 2.28722718485351e-07,
      2.1925755331634958e-07, 2.0970449489917616e-07, 2.0008310880128525e-07,
      1.9041246534635433e-07, 1.807111216525666e-07, 1.7099710513843368e-07,
      1.612878984790076e-07, 1.5160042599331862e-07, 1.4195104144196246e-07,
      1.3235551721194235e-07, 1.2282903486415232e-07, 1.1338617701726554e-07,
      1.0404092054026649e-07, 9.480663102443758e-08, 8.569605850427829e-08,
      7.67213343955991e-08, 6.789396961789032e-08, 5.922485386701792e-08,
      5.07242560033434e-08, 4.24018255195007e-08, 3.426659505128958e-08,
      2.632698389445942e-08, 1.859080248955948e-08, 1.1065257836518574e-08,
      3.756959800188123e-09, -3.3280717322652466e-09, -1.018439888149922e-08,
      -1.6807157033239217e-08, -2.319204536231218e-08, -2.933531666319838e-08,
      -3.52337665267989e-08, -4.0884721903017675e-08, -4.6286029088591594e-08,
      -5.1436041179372595e-08, -5.6333605025974586e-08, -6.09780477313473e-08,
      -6.536916272843194e-08, -6.950719547559207e-08, -7.339282880699951e-08,
      -7.70271679745926e-08, -8.041172541761485e-08, -8.35484052950884e-08,
      -8.643948781588163e-08, -8.908761340029621e-08, -9.149576670632784e-08,
      -9.366726055295044e-08, -9.560571977193694e-08, -9.731506501886424e-08,
      -9.87994965730578e-08, -1.000634781553148e-07, -1.0111172079130652e-07,
      -1.0194916674760274e-07, -1.025809735662853e-07, -1.0301249822312857e-07,
      -1.0324928143332121e-07, -1.0329703212768975e-07, -1.0316161212136315e-07,
      -1.0284902099578818e-07, -1.0236538121397318e-07, -1.017169234878023e-07,
      -1.009099724152258e-07, -9.995093240409807e-08, -9.884627389840274e-08,
      -9.760251992157762e-08, -9.62262329506319e-08, -9.472400213373539e-08,
      -9.310243086295678e-08, -9.136812471283596e-08, -8.95276797544959e-08,
      -8.7587671254034e-08, -8.55546427629821e-08, -8.343509560768977e-08,
      -8.12354787835679e-08, -7.896217925923176e-08, -7.662151269470221e-08,
      -7.421971457696571e-08, -7.176293177535537e-08, -6.92572145183995e-08,
      -6.670850879299133e-08, -6.412264916596393e-08, -6.15053520274088e-08,
      -5.8862209254355555e-08, -5.619868229273461e-08, -5.352009665487415e-08,
      -5.083163682913868e-08, -4.813834159769802e-08, -4.5445099757824347e-08,
      -4.275664624154942e-08, -4.007755862797671e-08, -3.741225404203156e-08,
      -3.476498643294875e-08, -3.213984422533947e-08, -2.9540748335249816e-08,
      -2.697145054321958e-08, -2.4435532215973567e-08, -2.1936403368027846e-08,
      -1.947730205416967e-08, -1.7061294083472163e-08, -1.4691273045233366e-08,
      -1.2369960636982737e-08, -1.0099907284477112e-08, -7.883493043411524e-09,
      -5.7229287723980565e-09, -3.6202575666173675e-09, -1.5773564414223903e-09,
      4.04061744928715e-10, 2.322446140313399e-09, 4.176405530520828e-09,
      5.964705764762066e-09, 7.686266985929948e-09, 9.340160676621159e-09,
      1.092560653191066e-08, 1.2441969169827644e-08, 1.3888754690423213e-08,
      1.5265607094243694e-08, 1.6572304570930702e-08, 1.7808755668560196e-08,
      1.8974995354208722e-08, 2.0071180976096495e-08, 2.1097588137504426e-08,
      2.2054606492496754e-08, 2.2942735473302847e-08, 2.3762579959022e-08,
      2.4514845895114347e-08, 2.520033587292984e-08, 2.5819944678306523e-08,
      2.6374654818039683e-08, 2.6865532032785595e-08, 2.729372080471797e-08,
      2.7660439868002825e-08, 2.7966977729898903e-08, 2.821468821002645e-08,
      2.8404986005078026e-08, 2.853934228597141e-08, 2.8619280334167504e-08,
      2.864637122359576e-08, 2.8622229554346787e-08, 2.8548509244007063e-08,
      2.8426899382224436e-08, 2.8259120153806162e-08, 2.8046918835363963e-08,
      2.7792065870233457e-08, 2.7496351026108983e-08, 2.7161579639549683e-08,
      2.6789568951229195e-08, 2.6382144535519942e-08, 2.59411368277241e-08,
      2.5468377751987517e-08, 2.4965697452660164e-08, 2.443492113159791e-08,
      2.3877865993635633e-08, 2.3296338302201233e-08, 2.2692130546784488e-08,
      2.206701872372411e-08, 2.1422759731530944e-08, 2.0761088881725655e-08,
      2.0083717525935134e-08, 1.9392330799764113e-08, 1.8688585483736823e-08,
      1.797410798138835e-08, 1.725049241437684e-08, 1.6519298834285895e-08,
      1.578205155059176e-08, 1.504023757408204e-08, 1.4295305174832164e-08,
      1.354866255367238e-08, 1.2801676625912065e-08, 1.2055671915929505e-08,
      1.1311929561084077e-08, 1.0571686423264074e-08, 9.83613430624711e-09,
      9.106419276921375e-09, 8.383641088294627e-09, 7.668852702104111e-09,
      6.963059908734129e-09, 6.267221042049048e-09, 5.582246786657804e-09,
      4.909000075041542e-09, 4.248296071898768e-09, 3.6009022429922414e-09,
      2.9675385057185947e-09, 2.3488774585654104e-09, 1.7455446865708766e-09,
      1.1581191398582457e-09, 5.871335822808865e-10, 3.3075107183647696e-11,
      -5.036142827376015e-10, -1.0225370345141865e-09, -1.5233393459684293e-09,
      -2.0057104118170346e-09, -2.4693816178686527e-09, -2.914125686365423e-09,
      -3.339755775508299e-09, -3.74612453619091e-09, -4.133123128946849e-09,
      -4.50068020409072e-09, -4.848760848004265e-09, -5.177365498485607e-09,
      -5.4865288320422804e-09, -5.77631862596743e-09, -6.046834597993632e-09,
      -6.2982072262702846e-09, -6.530596552358805e-09, -6.744190969884937e-09,
      -6.939206001429722e-09, -7.115883066180168e-09, -7.274488240797563e-09,
      -7.415311015896066e-09, -7.538663050456599e-09, -7.644876926431625e-09,
      -7.734304905725077e-09, -7.807317691658819e-09, -7.864303196962762e-09,
      -7.905665320250155e-09, -7.931822732862975e-09, -7.943207677894851e-09,
      -7.940264783120607e-09, -7.923449889482746e-09, -7.893228896705874e-09,
      -7.850076627530548e-09, -7.794475711978387e-09, -7.726915492980603e-09,
      -7.647890954622696e-09, -7.557901674178827e-09, -7.457450799030657e-09,
      -7.347044049487242e-09, -7.227188748445025e-09, -7.098392878750262e-09,
      -6.961164169050337e-09, -6.816009208845607e-09, -6.663432593379667e-09,
      -6.503936098933381e-09, -6.3380178890167895e-09, -6.166171751883098e-09,
      -5.988886369720536e-09, -5.8066446198109686e-09, -5.619922907878846e-09,
      -5.429190533790409e-09, -5.234909089701184e-09, -5.037531890689599e-09,
      -4.837503437856262e-09, -4.635258913811985e-09, -4.431223710423085e-09,
      -4.225812988629909e-09, -4.019431270103902e-09, -3.8124720604599276e-09,
      -3.6053175036939687e-09, -3.3983380674717927e-09, -3.1918922588516723e-09,
      -2.986326369983873e-09, -2.781974253291248e-09, -2.5791571255990445e-09,
      -2.3781834006478334e-09, -2.1793485493913624e-09, -1.982934987451092e-09,
      -1.7892119890711591e-09, -1.5984356268915594e-09, -1.4108487368333906e-09,
      -1.2266809073680402e-09, -1.04614849242222e-09, -8.694546471527173e-10,
      -6.967893858086051e-10, -5.283296608844121e-10, -3.6423946275536514e-10,
      -2.046699389752349e-10, -4.975953240851246e-11, 1.0036586263842894e-10,
      2.4559272712791165e-10, 3.8581972768772853e-10, 5.209575115407017e-10,
      6.509284868141861e-10, 7.75666589075745e-10, 8.951170349388315e-10,
      1.0092360635785074e-09, 1.117990666992071e-09, 1.2213583098330044e-09
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.00010688761689138197, 3.8029599300459124e-05, 8.611535195454407e-05, 0.00013479512532912853,
      0.00018678731321311335, 0.0002444963147230126, 0.0003100304837432105,
      0.00038521947181601796, 0.00047163097507629093, 0.000570586895821073,
      0.0006831789292990389, 0.000810283586297435, 0.0009525766620957079,
      0.0011105471623450228, 0.001284510696421339, 0.0014746223487865414,
      0.0016808890388772325, 0.0019031813800240594, 0.002141245047885777,
      0.00239471166886151, 0.002663109238921755, 0.002945872083273412,
      0.0032423503672464643, 0.0035518191687596806, 0.0038734871226897647,
      0.00420650464743263, 0.004549971763906796, 0.0049029455172071605,
      0.005264447011072536, 0.005633468065282167, 0.006008977506044979,
      0.0063899270993903745, 0.006775257137510915, 0.007163901687945224,
      0.007554793515423743, 0.007946868686130579, 0.008339070864061524,
      0.008730355309081474, 0.00911969258620366, 0.009506071995528638, 0.009888504732192587,
      0.010266026785582284, 0.01063770158697816, 0.011002622414687056, 0.011359914565622823,
      0.0117087373021857, 0.012048285583180517, 0.012377791587399439, 0.012696526038376881,
      0.013003799338702972, 0.01329896252215713, 0.013581408031795339, 0.013850570331993623,
      0.01410592636231593, 0.014346995840937637, 0.01457334142521585, 0.014784568736855144,
      0.014980326258972195, 0.015160305112215167, 0.01532423871694391, 0.015471902348325064,
      0.015603112591042176, 0.01571772670016523, 0.01581564187456656, 0.01589679444911116,
      0.01596115901168918, 0.01600874745099693, 0.016039607940810226, 0.016053823866330634,
      0.01605151269802119, 0.01603282481818354, 0.015997942305363735, 0.015947077681508763,
      0.01588047262663079, 0.015798396665571236, 0.015701145831292136, 0.015589041308957975,
      0.015462428064907803, 0.015321673464454476, 0.015167165882286142, 0.01499931330908427,
      0.01481854195781295, 0.014625294872976032, 0.014420030545982038, 0.014203221539601633,
      0.013975353124349298, 0.013736921929469431, 0.013488434611057764,
      0.013230406539701816, 0.012963360509879151, 0.012687825473209634,
      0.012404335297517777, 0.012113427553523744, 0.011815642330846681, 0.01151152108487193,
      0.011201605515904373, 0.010886436481903817, 0.01056655294597483, 0.010242490959663213,
      0.00991478268299395, 0.009583955442071435, 0.009250530824951966, 0.00891502381639085,
      0.008577941971962193, 0.00823978463194853, 0.007901042175299858, 0.007562195313867443,
      0.007223714427027025, 0.0068860589367187065, 0.006549676722846899,
      0.006215003578903229, 0.0058824627075983365, 0.005552464256214847,
      0.0052254048913237235, 0.004901667412439392, 0.004581620404125724,
      0.004265617926004999, 0.003953999240065301, 0.003647088574608532,
      0.003345194924131161, 0.0030486118843830617, 0.002757617521806184,
      0.0024724742765143966, 0.0021934288979384843, 0.0019207124122260443,
      0.0016545401204547472, 0.0013951116266891137, 0.0011426108948855262,
      0.0008972063336275881, 0.0006590509076540951, 0.00042828227512473044,
      0.000205022949554068, -1.0619514667507496e-05, -0.00021855231425684118,
      -0.0004186971676229696, -0.0006109900651567057, -0.0007953810003300372,
      -0.0009718336827108297, -0.0011403252339965268, -0.0013008458681667118,
      -0.0014533985568486217, -0.00159799868098207, -0.0017346736698608024,
      -0.0018634626286161856, -0.001984415955196365, -0.0020975949478797356,
      -0.002203071404345794, -0.002300927213309297, -0.002391253939705189,
      -0.0024741524043920887, -0.0025497322593212766, -0.0026181115590962513,
      -0.0026794163298250067, -0.002733780136143381, -0.0027813436472631818,
      -0.002822254202873357, -0.0028566653796963768, -0.002884736559475239,
      -0.0029066324991392292, -0.002922522903868765, -0.0029325820037514696,
      -0.002936988134693056, -0.0029359233242177585, -0.0029295728827639844,
      -0.002918125001051612, -0.0029017703540680177, -0.0028807017121905156,
      -0.0028551135599335104, -0.0028252017227793098, -0.002791163002522337,
      -0.002753194821527399, -0.00271149487627381, -0.002666260800528566,
      -0.0026176898384634387, -0.002565978528002883, -0.0025113223946620585,
      -0.002453915656107055, -0.002393950937642704, -0.002331618998807073,
      -0.0022671084712260225, -0.002200605607855997, -0.0021322940437186015,
      -0.0020623545682064994, -0.0019909649090167525, -0.0019182995277449793,
      -0.0018445294271516076, -0.0017698219700900924, -0.0016943407100662585,
      -0.0016182452333779321, -0.0015416910127647588, -0.0014648292724795701,
      -0.0013878068646748858, -0.0013107661569811073, -0.0012338449311366938,
      -0.001157176292515119, -0.0010808885903786738, -0.0010051053486752292,
      -0.0009299452071808848, -0.000855521872779024, -0.0007819440806546413,
      -0.0007093155651719395, -0.0006377350401930671, -0.0005672961885865048,
      -0.000498087660664989, -0.0004301930812849805, -0.00036369106533253086,
      -0.0002986552413139688, -0.0002351542827640981, -0.00017325194717956622,
      -0.00011300712218071137, -5.4473878601511184e-05, 2.2984697957757186e-06,
      5.726530028707729e-05, 0.00011038660914165988, 0.00016162693387470676,
      0.00021095527010664563, 0.0002583449833385572, 0.000303773715952454,
      0.0003472232897441432, 0.000388679604294795, 0.00042813253148525404,
      0.0004655758064545651, 0.0005010069153011684, 0.0005344269798217609,
      0.0005658406395789503, 0.0005952559315845551, 0.0006226841678807609,
      0.0006481398112963404, 0.0006716403496498039, 0.0006932061686656953,
      0.0007128604238642948, 0.0007306289116787665, 0.0007465399400473,
      0.0007606241987210834, 0.0007729146295219987, 0.0007834462967768033,
      0.0007922562581472408, 0.0007993834360680549, 0.000804868489997257,
      0.0008087536896752592, 0.0008110827895816406, 0.0008119009047703677,
      0.0008112543882562908, 0.0008091907101176636, 0.000805758338471335,
      0.0008010066224691265, 0.0007949856774557746, 0.0007877462724206818,
      0.0007793397198676075, 0.000769817768218351, 0.0007592324968584472,
      0.000747636213924919, 0.0007350813569282369, 0.0007216203962928105,
      0.00070730574189262, 0.0006921896526509791, 0.0006763241492659153,
      0.0006597609301152832, 0.0006425512903884821, 0.0006247460444845524,
      0.0006063954517094762, 0.0005875491452987242, 0.0005682560647844631,
      0.0005485643917203895, 0.0005285214887708857, 0.000508173842165103,
      0.000487567007510676, 0.00046674555895607177, 0.0004457530416850596,
      0.00042463192772148695, 0.0004034235750174365, 0.00038216818979294384,
      0.0003609047920907674, 0.00033967118450521834, 0.0003185039240397962,
      0.00029743829704431793, 0.0002765082971783873, 0.00025574660634442367,
      0.00023518457853005347, 0.00021485222649646313, 0.00019477821124632265,
      0.00017498983420210514, 0.00015551303202305456, 0.00013637237398668635,
      0.00011759106185854215, 9.919093217195772e-05, 8.119246083783938e-05,
      6.361477000287677e-05, 4.6475637073243204e-05, 2.979150581964756e-05,
      1.357749947859917e-05, -2.152564236075594e-06, -1.73861562980714e-05,
      -3.211201779687703e-05, -4.6320139716869723e-05, -6.00017411547603e-05,
      -7.31492460629041e-05, -8.575625860582464e-05, -9.781753721698193e-05,
      -0.00010932896744235842, -0.00012028753365684019, -0.00013069128973864315,
      -0.0001405393287861793, -0.00014983175196078214, -0.00015856963653762006,
      -0.00016675500324592286, -0.00017439078297834258, -0.00018148078294786356,
      -0.00018802965236917727, -0.00019404284773985318, -0.00019952659779496522,
      -0.00020448786820709026, -0.00020893432610177625, -0.00021287430445669574,
      -0.00021631676645075603, -0.0002192712698274397, -0.0002217479313345992,
      -0.00022375739130083634, -0.0002253107784064642, -0.0002264196747048806,
      -0.00022709608094798446, -0.00022735238226704343, -0.00022720131425817762,
      -0.00022665592951936545, -0.00022572956468360677, -0.00022443580799060123,
      -0.00022278846743701937, -0.00022080153954316545, -0.00021848917877155687,
      -0.00021586566763068092, -0.00021294538749493775, -0.00020974279016954314,
      -0.00020627237022694935, -0.00020254863813914904, -0.00019858609422806204,
      -0.00019439920345406617, -0.00019000237106062988, -0.00018540991909093185,
      -0.00018063606379032092, -0.00017569489390647613, -0.00017060034989717314,
      -0.00016536620405365764, -0.00016000604154576328, -0.00015453324239309802,
      -0.00014896096436485808, -0.00014330212680911528, -0.00013756939541076266,
      -0.00013177516787569554, -0.00012593156053725265, -0.00012005039587944575,
      -0.00011414319097006547, -0.00010822114679536903, -0.00010229513848673102,
      -9.63757064283724e-05, -9.047304823407602e-05, -8.459701157964954e-05,
      -7.875708787680791e-05, -7.296240677311923e-05, -6.72217314616881e-05,
      -6.154345478334017e-05, -5.5935596103220745e-05, -5.040579894292701e-05,
      -4.496132934855942e-05, -3.96090749744005e-05, -3.435554486130926e-05,
      -2.9206869888355987e-05, -2.4168803875713767e-05, -1.924672531636953e-05,
      -1.444563971381761e-05, -9.770182502551716e-06, -5.224622527875759e-06,
      -8.128660613091457e-07, 3.4615386723332608e-06, 7.59539648025349e-06,
      1.1585859723542394e-05, 1.5430422399832996e-05, 1.9126913810967406e-05,
      2.2673491839876784e-05, 2.6068635860799647e-05, 2.931113930684961e-05,
      3.240010191879065e-05, 3.5334921698688046e-05, 3.8115286591877376e-05,
      4.0741165920434234e-05, 4.321280159103484e-05, 4.5530699099774286e-05,
      4.769561835615625e-05, 4.9708564348087006e-05, 5.15707776692993e-05,
      5.328372493019936e-05, 5.4849089072674844e-05, 5.6268759608924376e-05,
      5.7544822803871386e-05, 5.867955182020901e-05, 5.967539684458906e-05,
      6.0534975212918754e-05, 6.12610615521653e-05, 6.185657795549177e-05,
      6.232458420696e-05, 6.266826807143781e-05, 6.28909356647418e-05,
      6.299600191843207e-05, 6.298698115305573e-05, 6.286747777301121e-05,
      6.26411770955766e-05, 6.231183632601516e-05, 6.188327569003885e-05,
      6.135936973427937e-05, 6.074403880478563e-05, 6.004124071293789e-05,
      5.925496259754407e-05, 5.8389212991262776e-05, 5.7448014098881706e-05,
      5.643539429437094e-05, 5.535538084302796e-05, 5.421199285443641e-05,
      5.3009234471374886e-05, 5.175108829923526e-05, 5.0441509079943504e-05,
      4.9084417613820417e-05, 4.7683694932275296e-05, 4.6243176723693484e-05,
      4.476664801435884e-05, 4.325783810574603e-05, 4.1720415769024224e-05,
      4.0157984697135174e-05, 3.8574079214343906e-05, 3.697216024271082e-05,
      3.5355611524499255e-05, 3.372773609911339e-05, 3.209175303275799e-05,
      3.0450794398623754e-05, 2.8807902505030396e-05, 2.7166027368604416e-05,
      2.552802442922925e-05, 2.3896652503182954e-05, 2.2274571970572414e-05,
      2.0664343192883198e-05, 1.9068425156191165e-05, 1.7489174335324834e-05,
      1.5928843774027364e-05, 1.4389582375942547e-05, 1.2873434401041365e-05,
      1.1382339161913588e-05, 9.9181309141727e-06, 8.482538935061976e-06,
      7.077187784204433e-06, 5.703597740309578e-06, 4.363185407534942e-06,
      3.0572644851002618e-06, 1.787046693666368e-06, 5.536428519192004e-07,
      -6.419359032585091e-07, -1.7987767596897446e-06, -2.916063742573063e-06,
      -3.993076103631494e-06, -5.0291865934583185e-06, -6.0238596237717205e-06,
      -6.976649326272801e-06, -7.88719751477276e-06, -8.755231557215514e-06,
      -9.580562164172074e-06, -1.0363081100323091e-05, -1.1102758825376461e-05,
      -1.1799642070788201e-05, -1.2453851358567446e-05, -1.3065578468350731e-05,
      -1.363508385882712e-05, -1.4162694049484826e-05, -1.4648798968531891e-05,
      -1.5093849272718936e-05, -1.5498353644661288e-05, -1.5862876073121232e-05,
      -1.618803312156944e-05, -1.647449119019788e-05, -1.6722963776405373e-05,
      -1.6934208738621742e-05, -1.7109025568177558e-05, -1.7248252673764268e-05,
      -1.7352764682864456e-05, -1.7423469764364356e-05, -1.746130697639101e-05,
      -1.746724364324497e-05, -1.7442272765126475e-05, -1.738741046417912e-05,
      -1.730369347020029e-05, -1.7192176649192504e-05, -1.705393057775469e-05,
      -1.6890039166137374e-05, -1.6701597332611506e-05, -1.648970873162692e-05,
      -1.6255483538064002e-05, -1.6000036289711036e-05, -1.572448378993027e-05,
      -1.542994307230806e-05, -1.5117529428918994e-05, -1.4788354503670859e-05,
      -1.4443524452036531e-05, -1.4084138168321222e-05, -1.3711285581458499e-05,
      -1.3326046020176769e-05, -1.2929486648229453e-05, -1.2522660970237042e-05,
      -1.2106607408547775e-05, -1.1682347951386046e-05, -1.1250886872423749e-05,
      -1.0813209521779932e-05, -1.0370281188328354e-05, -9.923046033070903e-06,
      -9.472426093217448e-06, -9.019320356499704e-06, -8.56460390513795e-06,
      -8.109127128775312e-06, -7.653715005594516e-06, -7.1991664507368175e-06,
      -6.74625373105216e-06, -6.295721945123464e-06, -5.848288567426435e-06,
      -5.4046430554092566e-06, -4.965446518204178e-06, -4.53133144561503e-06,
      -4.102901495961467e-06, -3.680731341301729e-06, -3.265366568501427e-06,
      -2.857323634565744e-06, -2.457089874606848e-06, -2.0651235607769273e-06,
      -1.6818540104601568e-06, -1.3076817419839443e-06, -9.429786760809572e-07,
      -5.880883813085918e-07, -2.4332636161164803e-07, 9.101961580308232e-08,
      4.1468915412489974e-07, 7.274488239841722e-07, 1.0290917257444915e-06,
      1.319437018904907e-06, 1.5983294204743791e-06, 1.865638674176596e-06,
      2.121258992336151e-06, 2.3651084722869e-06, 2.5971284891302262e-06,
      2.8172830666550507e-06, 3.0255582282128352e-06, 3.2219613293196787e-06,
      3.4065203737340074e-06, 3.579283314732414e-06, 3.740317343278069e-06,
      3.889708164745865e-06, 4.0275592658362495e-06, 4.153991173275626e-06,
      4.269140705865369e-06, 4.373160221404096e-06, 4.466216859968875e-06,
      4.54849178500073e-06, 4.620179423598206e-06, 4.6814867073799935e-06,
      4.7326323152337945e-06, 4.773845919223893e-06, 4.805367434884268e-06,
      4.827446277077829e-06, 4.840340622555418e-06, 4.844316680300756e-06,
      4.839647970699696e-06, 4.826614614523943e-06, 4.805502632670982e-06,
      4.776603257553459e-06, 4.7402122569826314e-06, 4.696629271341991e-06,
      4.646157164798747e-06, 4.589101391252631e-06, 4.525769375673604e-06,
      4.4564699114324334e-06, 4.381512574181053e-06, 4.3012071527929144e-06,
      4.215863097827576e-06, 4.125788987938263e-06, 4.031292014596492e-06,
      3.9326774854637954e-06, 3.830248346697457e-06, 3.7243047244348386e-06,
      3.6151434856594295e-06, 3.5030578186112987e-06, 3.3883368328651404e-06,
      3.271265179160623e-06, 3.1521226890323625e-06, 3.0311840342505297e-06,
      2.9087184060479055e-06, 2.7849892140751696e-06, 2.660253804993341e-06,
      2.5347632005806108e-06, 2.4087618552003664e-06, 2.2824874324479473e-06,
      2.15617060076571e-06, 2.0300348477892203e-06, 1.9042963131619194e-06,
      1.7791636395313825e-06, 1.654837841417343e-06, 1.5315121916199688e-06,
      1.4093721248164507e-06, 1.2885951579748133e-06, 1.1693508271959437e-06,
      1.051800640578188e-06, 9.360980466834356e-07, 8.223884181694236e-07,
      7.108090501400127e-07, 6.014891727533941e-07, 4.945499776175883e-07,
      3.9010465749314966e-07, 2.8825845881468633e-07, 1.8910874653562479e-07,
      9.274508079456287e-08, -7.506951034586362e-10, -9.130435590139614e-08,
      -1.7884918531392708e-07, -2.633258571759733e-07, -3.4468230733251664e-07,
      -4.228735967862374e-07, -4.978617666186332e-07, -5.696156851985257e-07,
      -6.381108881892621e-07, -7.033294118624993e-07, -7.652596202222579e-07,
      -8.23896026437973e-07, -8.792391090795943e-07, -9.312951236414174e-07,
      -9.8007590983431e-07, -1.025598695118347e-06, -1.0678858949396376e-06,
      -1.1069649101263336e-06, -1.1428679218894967e-06, -1.17563168486469e-06,
      -1.2052973186199025e-06, -1.2319100980447223e-06, -1.2555192430245867e-06,
      -1.2761777077925032e-06, -1.2939419703388492e-06, -1.3088718222477926e-06,
      -1.3210301593165285e-06, -1.3304827733009481e-06, -1.3372981451185677e-06,
      -1.3415472398265764e-06, -1.3433033036797398e-06, -1.3426416635596574e-06,
      -1.3396395290535255e-06, -1.3343757974471623e-06, -1.3269308618835799e-06,
      -1.3173864229249326e-06, -1.3058253037421985e-06, -1.2923312691435131e-06,
      -1.2769888486386925e-06, -1.2598831637241668e-06, -1.2410997595593328e-06,
      -1.2207244411922308e-06, -1.1988431144794774e-06, -1.175541631832584e-06,
      -1.150905642910134e-06, -1.1250204503628421e-06, -1.0979708707262659e-06,
      -1.0698411005439024e-06, -1.040714587791607e-06, -1.0106739086627128e-06,
      -9.798006497619324e-07, -9.481752957451044e-07, -9.15877122431098e-07,
      -8.82984095401741e-07, -8.495727740954851e-07, -8.157182213906779e-07,
      -7.814939186647915e-07, -7.469716863067514e-07, -7.122216096506419e-07,
      -6.773119702905234e-07, -6.423091827279049e-07, -6.072777362955547e-07,
      -5.722801422938285e-07, -5.373768862685334e-07, -5.026263853525348e-07,
      -4.680849505868559e-07, -4.3380675413091177e-07, -3.998438012657643e-07,
      -3.662459070888757e-07, -3.3306067779378333e-07, -3.003334964234055e-07,
      -2.681075129813208e-07, -2.3642363878133896e-07, -2.0532054491198757e-07,
      -1.748346646891882e-07, -1.4500019996736252e-07, -1.1584913117650797e-07,
      -8.741123095039401e-08, -5.971408120895696e-08, -3.278309355620282e-08,
      -6.641532853458708e-09, 1.868945617336217e-08, 4.319081943470762e-08,
      6.684556122938345e-08, 8.963870939078002e-08, 1.1155727797058705e-07,
      1.3259022760308058e-07, 1.5272842369264424e-07, 1.7196459256652792e-07,
      1.9029327573395967e-07, 2.0771078239161737e-07, 2.242151403141479e-07,
      2.398060452668992e-07, 2.544848090763148e-07, 2.6825430649154215e-07,
      2.81118920968729e-07, 2.93084489507244e-07, 3.041582466646579e-07,
      3.1434876787477797e-07, 3.2366591219034374e-07, 3.3212076456917946e-07,
      3.397255778196646e-07, 3.464937143183386e-07, 3.5243958760930927e-07,
      3.5757860399189116e-07, 3.6192710419957403e-07, 3.6550230527001884e-07,
      3.6832224270230534e-07, 3.704057129941247e-07, 3.7177221664802615e-07,
      3.7244190173219956e-07, 3.7243550807761143e-07, 3.7177431218961857e-07,
      3.7048007294847125e-07, 3.685749781693889e-07, 3.660815920891559e-07,
      3.630228038424506e-07, 3.594217769873917e-07, 3.553019001360695e-07,
      3.5068673874213204e-07, 3.4559998809382397e-07, 3.400654275572333e-07,
      3.3410687611089463e-07, 3.277481492093318e-07, 3.2101301700960485e-07,
      3.139251639914559e-07, 3.0650814999823645e-07, 2.987853727224442e-07,
      2.9078003165640826e-07, 2.8251509352543826e-07, 2.7401325921759987e-07,
      2.6529693222120405e-07, 2.5638818857809557e-07, 2.473087483579058e-07,
      2.3807994865559878e-07, 2.287227181118853e-07, 2.1925755295341717e-07,
      2.0970449454709623e-07, 2.0008310846034915e-07, 1.9041246501682598e-07,
      1.8071112133468275e-07, 1.709971048324044e-07, 1.6128789818501654e-07,
      1.516004257115235e-07, 1.4195104117249544e-07, 1.323555169549108e-07,
      1.2282903461963916e-07, 1.1338617678532982e-07, 1.040409203209441e-07,
      9.480663081774177e-08, 8.569605831020034e-08, 7.672133421410897e-08,
      6.789396944893731e-08, 5.922485371053131e-08, 5.0724255859233137e-08,
      4.2401825387658166e-08, 3.4266594931588304e-08, 2.6326983786755852e-08,
      1.85908023936937e-08, 1.106525775231504e-08, 3.756959727456416e-09,
      -3.328071793729679e-09, -1.0184398931914314e-08, -1.680715707283554e-08,
      -2.319204539133218e-08, -2.9335316681895625e-08, -3.523376653543732e-08,
      -4.088472190187083e-08, -4.628602907794196e-08, -5.1436041159510844e-08,
      -5.633360499719884e-08, -6.097804769396237e-08, -6.536916268274866e-08,
      -6.950719542192657e-08, -7.339282874567256e-08, -7.702716790592895e-08,
      -8.041172534194258e-08, -8.354840521273822e-08, -8.643948772718619e-08,
      -8.908761330558946e-08, -9.149576660594442e-08, -9.366726044722514e-08,
      -9.560571966120413e-08, -9.731506490345728e-08, -9.879949645330854e-08,
      -1.0006347803155301e-07, -1.0111172066385947e-07, -1.0194916661679462e-07,
      -1.0258097343243685e-07, -1.0301249808655665e-07, -1.0324928129433838e-07,
      -1.0329703198660393e-07, -1.0316161197847715e-07, -1.0284902085139926e-07,
      -1.0236538106837284e-07, -1.0171692334127584e-07, -1.0090997226805206e-07,
      -9.995093225654911e-08, -9.884627375074353e-08, -9.76025197740658e-08,
      -9.622623280351755e-08, -9.472400198726084e-08, -9.310243071735637e-08,
      -9.136812456833579e-08, -8.95276796113137e-08, -8.758767111237899e-08,
      -8.555464262305492e-08, -8.343509546968228e-08, -8.123547864766318e-08,
      -7.896217912560395e-08, -7.66215125635166e-08, -7.421971444837872e-08,
      -7.176293164951449e-08, -6.925721439544328e-08, -6.670850867304938e-08,
      -6.412264904915701e-08, -6.150535191384885e-08, -5.8862209144145776e-08,
      -5.61986821859695e-08, -5.352009655163963e-08, -5.083163672951214e-08,
      -4.813834150174849e-08, -4.5445099665612535e-08, -4.2756646153127844e-08,
      -4.007755854338984e-08, -3.741225396131599e-08, -3.476498635613335e-08,
      -3.213984415244559e-08, -2.9540748266291448e-08, -2.6971450478203553e-08,
      -2.443553215489974e-08, -2.1936403310889326e-08, -1.947730200095296e-08,
      -1.7061294034157385e-08, -1.4691272999794459e-08, -1.236996059538769e-08,
      -1.0099907246688196e-08, -7.883493009385527e-09, -5.722928742086527e-09,
      -3.6202575399668436e-09, -1.5773564183746412e-09, 4.040617644364549e-10,
      2.32244615634819e-09, 4.176405543153789e-09, 5.964705774068134e-09,
      7.686266991987638e-09, 9.340160679512322e-09, 1.0925606531720249e-08,
      1.2441969166643479e-08, 1.3888754684335738e-08, 1.5265607085345746e-08,
      1.6572304559317284e-08, 1.7808755654328262e-08, 1.8974995337456948e-08,
      2.007118095692506e-08, 2.1097588116014793e-08, 2.2054606468791465e-08,
      2.2942735447485306e-08, 2.3762579931196282e-08, 2.4514845865385e-08,
      2.5200335841401672e-08, 2.5819944645084412e-08, 2.637465478322841e-08,
      2.6865531996489667e-08, 2.7293720767041445e-08, 2.7660439829049143e-08,
      2.7966977689770727e-08, 2.8214688168825513e-08, 2.8404985962904984e-08,
      2.853934224292571e-08, 2.861928029034726e-08, 2.8646371179097632e-08,
      2.8622229509265847e-08, 2.8548509198436674e-08, 2.8426899336256137e-08,
      2.825912010752959e-08, 2.8046918788866758e-08, 2.7792065823601176e-08,
      2.7496350979425003e-08, 2.7161579592895104e-08, 2.6789568904682756e-08,
      2.638214448915793e-08, 2.59411367816203e-08, 2.5468377706213145e-08,
      2.4965697407283824e-08, 2.443492108668556e-08, 2.3877865949250538e-08,
      2.3296338258403925e-08, 2.269213050363274e-08, 2.2067018681272938e-08,
      2.142275968983259e-08, 2.0761088840829594e-08, 2.0083717485888064e-08,
      1.9392330760609962e-08, 1.8688585445516748e-08, 1.797410794414075e-08,
      1.725049237813735e-08, 1.651929879908742e-08, 1.578205151646448e-08,
      1.5040237541053453e-08, 1.4295305142927115e-08, 1.3548662522913088e-08,
      1.2801676596318157e-08, 1.2055671887518057e-08, 1.1311929533869661e-08,
      1.05716863972588e-08, 9.836134281460688e-09, 9.10641925336115e-09,
      8.383641065965634e-09, 7.668852681009128e-09, 6.963059888873736e-09,
      6.267221023421701e-09, 5.582246769259902e-09, 4.9090000588674865e-09,
      4.248296056941036e-09, 3.6009022292414473e-09, 2.967538493163562e-09,
      2.3488774471932387e-09, 1.7455446763670113e-09, 1.1581191308065511e-09,
      5.871335743637185e-10, 3.307510038192753e-11, -5.036142884443135e-10,
      -1.0225370391476168e-09, -1.523339349551517e-09, -2.0057104143738578e-09,
      -2.469381619424353e-09, -2.9141256869461337e-09, -3.3397557751410715e-09,
      -3.746124534903643e-09, -4.133123126768218e-09, -4.500680201050105e-09,
      -4.848760844131674e-09, -5.177365493811612e-09, -5.486528826597946e-09,
      -5.77631861978425e-09, -6.046834591103457e-09, -6.29820721870526e-09,
      -6.530596544151303e-09, -6.744190961067499e-09, -6.9392059920350006e-09,
      -7.115883056240861e-09, -7.274488230346362e-09, -7.415311004965596e-09,
      -7.53866303907937e-09, -7.644876914639967e-09, -7.73430489355109e-09,
      -7.807317679134321e-09, -7.864303184119246e-09, -7.905665307118738e-09,
      -7.93182271947437e-09, -7.943207664279317e-09, -7.940264769307917e-09,
      -7.923449875502152e-09, -7.893228882586071e-09, -7.85007661329965e-09,
      -7.794475697663886e-09, -7.726915478609347e-09, -7.647890940220858e-09,
      -7.557901659771878e-09, -7.457450784643346e-09, -7.347044035143567e-09,
      -7.2271887341682194e-09, -7.098392864562774e-09, -6.96116415497382e-09,
      -6.816009194900907e-09, -6.663432579586808e-09, -6.5039360853115605e-09,
      -6.338017875584365e-09, -6.1661717386575784e-09, -5.9888863567185736e-09,
      -5.806644607048352e-09, -5.619922895370497e-09, -5.429190521550389e-09,
      -5.234909077742692e-09, -5.0375318790249734e-09, -4.8375034264969845e-09,
      -4.635258902768684e-09, -4.431223699705542e-09, -4.2258129782470665e-09,
      -4.019431260063873e-09, -3.8124720507700055e-09, -3.6053174943606397e-09,
      -3.398338058500743e-09, -3.191892250247805e-09, -2.98632636175132e-09,
      -2.7819742454333883e-09, -2.579157118118518e-09, -2.378183393546559e-09,
      -2.179348542670556e-09, -1.9829349811112834e-09, -1.7892119831122112e-09,
      -1.5984356213126883e-09, -1.4108487316331849e-09, -1.2266809025444804e-09,
      -1.0461484879727007e-09, -8.694546430740687e-10, -6.967893820971138e-10,
      -5.283296575358435e-10, -3.642394597649852e-10, -2.0466993633783213e-10,
      -4.9759530118420674e-11, 1.0036586458730798e-10, 2.455927287420854e-10,
      3.858197289740905e-10, 5.209575125065084e-10, 6.509284874670346e-10,
      7.756665894235496e-10, 8.951170349898012e-10, 1.0092360633411229e-09,
      1.1179906664750625e-09, 1.221358309045328e-09
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_5_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<5>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 6.0123930158088445e-05), "design.b()[0] == 6.0123930158088445e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 6.0123930158088445e-05));
    static_assert(almost_equal(design.b()[1], -0.0001655834679007154), "design.b()[1] == -0.0001655834679007154");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.0001655834679007154));
    static_assert(almost_equal(design.b()[2], 0.00010619596067440401), "design.b()[2] == 0.00010619596067440401");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.00010619596067440401));
    static_assert(almost_equal(design.b()[3], 0.00010619596067440398), "design.b()[3] == 0.00010619596067440398");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - 0.00010619596067440398));
    static_assert(almost_equal(design.b()[4], -0.0001655834679007154), "design.b()[4] == -0.0001655834679007154");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - -0.0001655834679007154));
    static_assert(almost_equal(design.b()[5], 6.012393015808847e-05), "design.b()[5] == 6.012393015808847e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 6.012393015808847e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -4.776096694350296), "design.a()[1] == -4.776096694350296");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -4.776096694350296));
    static_assert(almost_equal(design.a()[2], 9.129253285496375), "design.a()[2] == 9.129253285496375");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 9.129253285496375));
    static_assert(almost_equal(design.a()[3], -8.72948635387403), "design.a()[3] == -8.72948635387403");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -8.72948635387403));
    static_assert(almost_equal(design.a()[4], 4.175670371680451), "design.a()[4] == 4.175670371680451");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 4.175670371680451));
    static_assert(almost_equal(design.a()[5], -0.7993391361066369), "design.a()[5] == -0.7993391361066369");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.7993391361066369));
    std::cout << "max_deviation(cheby2,lowpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      6.0123930158088445e-05, 0.00012157423617867891, 0.00013795968127287107, 0.0001800737711457756,
      0.00024522032359574546, 0.0003321034696841938, 0.0004405362581339648,
      0.0005711824045535616, 0.0007253287918824111, 0.0009046864385317769,
      0.0011112177580752279, 0.0013469880390265974, 0.001614039175237168,
      0.001914283776752736, 0.0022494178876010656, 0.0026208506309373953,
      0.003029649193267184, 0.0034764976480990157, 0.003961668205365226,
      0.004485003556293065, 0.005045909064125793, 0.005643353629192899,
      0.006275878132324608, 0.006941610433512456, 0.007638285973050572,
      0.008363273090168495, 0.00911360223940448, 0.009885998347688461, 0.010676915615327652,
      0.011482574121838729, 0.012298997652873588, 0.013122052217367494,
      0.013947484774527619, 0.01477096173840678, 0.015588106873603735, 0.016394538239131562,
      0.017185903878735212, 0.017957915994955803, 0.01870638338107211, 0.01942724191973992,
      0.020116582989740714, 0.020770679652786853, 0.021386010520857632,
      0.021959281231107006, 0.022487443480039185, 0.022967711591443618, 0.02339757661356852,
      0.023774817960245803, 0.02409751262821533, 0.024364042038788628, 0.024573096566299232,
      0.024723677828566368, 0.02481509882591028, 0.024846982025160294, 0.024819255493651438,
      0.02473214719547244, 0.024586177568268808, 0.02438215050377998, 0.02412114285906143,
      0.023804492628071633, 0.023433785905051602, 0.023010842771951825,
      0.022537702242128005, 0.022016606391693186, 0.021449983808338277,
      0.020840432485174212, 0.02019070228426388, 0.01950367709105702, 0.0187823567769715,
      0.018029839082933277, 0.017249301531847352, 0.016443983472774426,
      0.015617168354081334, 0.014772166317066085, 0.013912297195575851, 0.01304087400098318,
      0.012161186965603955, 0.011276488211270842, 0.010389977103356499,
      0.009504786344108243, 0.00862396885274444, 0.0077504854734051845,
      0.006887193545775945, 0.0060368363670412276, 0.00520203356780187,
      0.004385272418728586, 0.003588900079047639, 0.002815116792482069,
      0.0020659700310215624, 0.0013433495818817587, 0.0006489835682534405,
      -1.55646100543751e-05, -0.0006488984341958153, -0.0012497895441524643,
      -0.0018171781625903579, -0.0023501726937771254, -0.002848048529687749,
      -0.0033102460981901775, -0.003736368190666514, -0.00412617660859315,
      -0.004479588170476761, -0.004796670122126621, -0.0050776349945424945,
      -0.005322834954717796, -0.00553275569540726, -0.005708009910395367,
      -0.005849330402035516, -0.0059575628678205095, -0.006033658412503088,
      -0.006078665831822389, -0.00609372371322027, -0.006080052398062828,
      -0.006038945848829996, -0.005971763463512834, -0.005879921878077489,
      -0.005764886796330193, -0.00562816488486273, -0.005471295768986171,
      -0.005295844163685889, -0.005103392171666419, -0.00489553177851397,
      -0.0046738575729003695, -0.004439959717597832, -0.004195417194881666,
      -0.0039417913476800445, -0.0036806197355980508, -0.0034134103227087265,
      -0.00314163601177753, -0.0028667295373789713, -0.0025900787281849576,
      -0.002313022146562845, -0.0020368451115260738, -0.0017627761090396772,
      -0.0014919835917043857, -0.0012255731679334447, -0.0009645851789018946,
      -0.0007099926597945736, -0.000462699680211585, -0.00022354005701282365,
      6.723568599789143e-06, 0.00022740029934924203, 0.00043787120637191787,
      0.0006375892219834226, 0.0008260787138574281, 0.0010029347547285995,
      0.0011678221026012112, 0.001320473907210848, 0.001460690159148242,
      0.0015883358986128714, 0.001703339201220985, 0.0018056889586501226,
      0.0018954324721622944, 0.0019726728772134754, 0.0020375664174309364,
      0.0020903195862255336, 0.0021311861542070085, 0.0021604641003904277,
      0.0021784924649252656, 0.0021856481407495024, 0.0021823426211739546,
      0.00216901871994144, 0.0021461472797859923, 0.0021142238849439655,
      0.002073765592446297, 0.002025307696354381, 0.0019694005383957165,
      0.0019066063777146772, 0.00183749633168322, 0.0017626473989208538,
      0.0016826395748574443, 0.001598053069341054, 0.0015094656349504704,
      0.0014174500138227448, 0.0013225715099541646, 0.0012253856930826623,
      0.0011264362394146346, 0.0010262529136232006, 0.0009253496957215973,
      0.0008242230556079989, 0.0007233503772896849, 0.0006231885340280564,
      0.0005241726149041843, 0.00042671480258984866, 0.0003312034014236022,
      0.0002380020142372884, 0.0001474488657574435, 5.9856269819668186e-05,
      -2.448976291629588e-05, -0.00010532978057629199, -0.0001824310133070248,
      -0.00025558736887418623, -0.00032461930575811366, -0.00038937358923960344,
      -0.000449722936286915, -0.0005055655553339857, -0.0005568245872797227,
      -0.0006034474542393879, -0.0006454051227421636, -0.0006826912881947428,
      -0.000715321487520135, -0.0007433321469348564, -0.0007667795718474431,
      -0.0007857388858480592, -0.0008003029257142385, -0.0008105810992829741,
      -0.0008166982129359959, -0.0008187932753147597, -0.0008170182837261017,
      -0.0008115369995204107, -0.0008025237185232945, -0.0007901620423808771,
      -0.0007746436564398606, -0.0007561671195281572, -0.0007349366707320682,
      -0.0007111610579834836, -0.0006850523929772031, -0.0006568250366360343,
      -0.0006266945190315405, -0.0005948764973529438, -0.0005615857551973858,
      -0.0005270352461331589, -0.0004914351841652041, -0.0004549921834106534,
      -0.00041790844897292116, -0.0003803810206871967, -0.0003426010710994847,
      -0.00030475325873679853, -0.0002670151374289001, -0.0002295566221531761,
      -0.0001925395115948349, -0.00015611706734551469, -0.00012043364940544205,
      -8.562440740820729e-05, -5.1815026753695645e-05, -1.9121528614298746e-05,
      1.2349877427275788e-05, 4.2502889543070775e-05, 7.125116024074611e-05,
      9.85182951370291e-05, 0.00012423780584963032, 0.00014835301906774786,
      0.00017081694398064264, 0.00019159210034829356, 0.00021065030958794387,
      0.00022797245132560743, 0.0002435481879225509, 0.0002573756595336974,
      0.0002694611522881538, 0.0002798187422020455, 0.0002884699174409849,
      0.00029544318154428725, 0.0003007736402060007, 0.00030450257417948445,
      0.000306677000833241, 0.0003073492268365844, 0.00030657639439514786,
      0.00030442002338884264, 0.00030094555168934324, 0.0002962218758511667,
      0.00029032089428061847, 0.0002833170548909791, 0.0002752869091509928,
      0.0002663086743276764, 0.0002564618056143707, 0.0002458265797214824,
      0.0002344836913911626, 0.00022251386417889395, 0.00020999747672523325,
      0.0001970142056203941, 0.00018364268584354258, 0.0001699601896381868,
      0.00015604232456541156, 0.00014196275135845628, 0.00012779292208575427,
      0.00011360183901549885, 9.945583446351492e-05, 8.54183717980925e-05,
      7.154986767085575e-05, 5.7907535442035e-05, 4.454524967199136e-05,
      3.1513431458789426e-05, 1.885895431427012e-05, 6.625070188655613e-06,
      -5.148644823594835e-06, -1.6426325636014273e-05, -2.7175834786453928e-05,
      -3.7368761184720505e-05, -4.698040171440909e-05, -5.598972646191628e-05,
      -6.43793283901414e-05, -7.213535831334918e-05, -7.924744606311679e-05,
      -8.57086087632903e-05, -9.151514715451863e-05, -9.666653092632805e-05,
      -0.00010116527402697734, -0.00010501680092864148, -0.0001082293048279766,
      -0.00011081359876000064, -0.00011278296059667975, -0.0001141529728908463,
      -0.00011494135851131007, -0.00011516781299648784, -0.00011485383453180623,
      -0.00011402255243077102, -0.00011269855497119199, -0.00011090771740685933,
      -0.00010867703094124203, -0.00010603443341377673, -0.00010300864241129552,
      -9.96289914773587e-05, -9.59252700509682e-05, -9.19275677235909e-05,
      -8.76661233598638e-05, -8.31711795830277e-05, -7.847284308127727e-05,
      -7.360095114605168e-05, -6.858494480804246e-05, -6.345374889157521e-05,
      -5.823565926323267e-05, -5.295823750632253e-05, -4.7648213209235655e-05,
      -4.2331394013063765e-05, -3.703258352221001e-05, -3.1775507141282934e-05,
      -2.6582745862451456e-05, -2.147567798978391e-05, -1.6474428751012428e-05,
      -1.1597827712758797e-05, -6.863373882620642e-06, -2.287208350726971e-06,
      2.1159057055020273e-06, 6.332595856558538e-06, 1.0350886324067099e-05,
      1.4160197202908828e-05, 1.7751337273898676e-05, 2.1116490697338928e-05,
      2.4249197894357928e-05, 2.7144330937446957e-05, 2.9798063784047287e-05,
      3.2207837697439056e-05, 3.437232220757753e-05, 3.629137197095218e-05,
      3.796597989305932e-05, 3.939822687973538e-05, 4.059122858445779e-05,
      4.154907951785201e-05, 4.227679488311999e-05, 4.278025049700467e-05,
      4.306612115031016e-05, 4.314181775499305e-05, 4.301542361651617e-05,
      4.269563016060299e-05, 4.219167243284258e-05, 4.1513264677866125e-05,
      4.067053629214264e-05, 3.967396843091955e-05, 3.853433153556049e-05,
      3.7262624032603135e-05, 3.587001244037002e-05, 3.436777310300847e-05,
      3.2767235755505104e-05, 3.1079729106605296e-05, 2.9316528609757463e-05,
      2.748880657528065e-05, 2.560758476000496e-05, 2.3683689553736468e-05,
      2.1727709865128027e-05, 1.974995779296617e-05, 1.7760432152581697e-05,
      1.5768784911120937e-05, 1.3784290569837196e-05, 1.1815818516433215e-05,
      9.871808355857587e-06, 7.960248213878235e-06, 6.0886559942674516e-06,
      4.264063557573879e-06, 2.4930037772615046e-06, 7.815004174937281e-07,
      -8.649392339429199e-07, -2.441329054124693e-06, -3.943206180723224e-06,
      -5.366630609340882e-06, -6.708182394546851e-06, -7.964956563672056e-06,
      -9.134555858598792e-06, -1.0215081426179062e-05, -1.120512158254061e-05,
      -1.2103738780401081e-05, -1.2910454911621519e-05, -1.3625235079606232e-05,
      -1.4248469977815525e-05, -1.4780957011621877e-05, -1.522388030103244e-05,
      -1.557878970144671e-05, -1.5847578978645557e-05, -1.603246327264568e-05,
      -1.6135955982932986e-05, -1.6160845204941444e-05, -1.6110169844504028e-05,
      -1.5987195533403672e-05, -1.5795390465129773e-05, -1.553840126553519e-05,
      -1.5220029008325832e-05, -1.4844205480236066e-05, -1.4414969795384163e-05,
      -1.3936445452699043e-05, -1.3412817924498028e-05, -1.2848312858310855e-05,
      -1.2247174967921695e-05, -1.1613647683372821e-05, -1.0951953623373461e-05,
      -1.0266275947217353e-05, -9.560740636963329e-06, -8.839399754304699e-06,
      -8.10621571027353e-06, -7.365046579722238e-06, -6.619632486422718e-06,
      -5.873583078646641e-06, -5.130366109262152e-06, -4.393297128722834e-06,
      -3.6655302938538587e-06, -2.9500502900754594e-06, -2.2496653596611254e-06,
      -1.5670014238217102e-06, -9.04497281849592e-07, -2.644008662601576e-07,
      3.512334711593952e-07, 9.405466712338799e-07, 1.5018757095229135e-06,
      2.0337534041672956e-06, 2.534907327830616e-06, 3.004257864701875e-06,
      3.44091545582596e-06, 3.844177078037889e-06, 4.213522003496342e-06,
      4.548606888245724e-06, 4.8492602393888124e-06, 5.1154763113297445e-06,
      5.347408482156864e-06, 5.545362161584527e-06, 5.709787281971324e-06,
      5.841270423788855e-06, 5.940526626540635e-06, 6.008390935535799e-06,
      6.045809734118699e-06, 6.053831909955316e-06, 6.033599902793085e-06,
      5.986340679755162e-06, 5.9133566827164495e-06, 5.81601679065021e-06,
      5.695747338044204e-06, 5.554023228577642e-06, 5.3923591812382275e-06,
      5.212301143955825e-06, 5.0154179076490095e-06, 4.803292951336198e-06,
      4.577516546667111e-06, 4.339678147895671e-06, 4.091359090954395e-06,
      3.834125622914863e-06, 3.5695222807404616e-06, 3.299065635867428e-06,
      3.0242384187988097e-06, 2.7464840355734977e-06, 2.4672014856884244e-06,
      2.187740688815433e-06, 1.9093982254736063e-06, 1.6334134947007795e-06,
      1.3609652897218279e-06, 1.0931687906426554e-06, 8.310729713136197e-07,
      5.756584157097584e-07, 3.27835537472351e-07, 8.844319465116278e-08,
      -1.4175230981733483e-07, -3.6205785276051043e-07, -5.718537527073648e-07,
      -7.705936824577756e-07, -9.578042467039864e-07, -1.1330842400919833e-06,
      -1.2961036019674683e-06, -1.4466020847988548e-06, -1.5843876539090362e-06,
      -1.709334636679991e-06, -1.8213816398214331e-06, -1.9205292536189564e-06,
      -2.0068375623010623e-06, -2.0804234797911175e-06, -2.141457930142965e-06,
      -2.190162891901237e-06, -2.2268083254832713e-06, -2.2517090024530638e-06,
      -2.2652212552532472e-06, -2.2677396655831742e-06, -2.259693709164534e-06,
      -2.241544374125333e-06, -2.213780769663453e-06, -2.1769167410273803e-06,
      -2.131487506179079e-06, -2.0780463287874685e-06, -2.0171612414456184e-06,
      -1.9494118322156106e-06, -1.875386106787074e-06, -1.79567743769358e-06,
      -1.7108816111702285e-06, -1.62159398136062e-06, -1.5284067406965905e-06,
      -1.4319063143840511e-06, -1.3326708860373453e-06, -1.2312680606168697e-06,
      -1.1282526699442427e-06, -1.0241647251998415e-06, -9.195275199526214e-07,
      -8.148458864351471e-07, -7.1060460696085e-07, -6.072669815885795e-07,
      -5.052735523742673e-07, -4.0504098381339097e-07, -3.069610983731649e-07,
      -2.1140006534197867e-07, -1.1869774058731897e-07, -2.91671542137631e-08,
      5.690585744907252e-08, 1.3926287962144187e-07, 2.176730111868898e-07,
      2.919328261621924e-07, 3.6186620994328025e-07, 4.2732407610695083e-07,
      4.88183969867391e-07, 5.443495645647989e-07, 5.957500578010736e-07,
      6.423394740351625e-07, 6.840958806089123e-07, 7.210205242940215e-07,
      7.531368955329084e-07, 7.804897275921477e-07, 8.031439378578106e-07,
      8.211835184789459e-07, 8.347103835100145e-07, 8.438431796168995e-07,
      8.487160672957839e-07, 8.494774794114236e-07, 8.462888636928948e-07,
      8.39323415632585e-07, 8.287648080198585e-07, 8.148059231063346e-07,
      7.976475931469669e-07, 7.77497354791995e-07, 7.54568222521265e-07,
      7.290774860162582e-07, 7.012455360583082e-07, 6.712947232257676e-07,
      6.394482533401182e-07, 6.05929123282983e-07, 5.709591004743986e-07,
      5.347577489692462e-07, 4.975415047950015e-07, 4.5952280282151897e-07,
      4.209092571238943e-07, 3.819028964739463e-07, 3.426994562758768e-07,
      3.034877279484516e-07, 2.644489664507718e-07, 2.2575635635246406e-07,
      1.875745365629117e-07, 1.5005918355889892e-07, 1.1335665268657371e-07,
      7.760367686269554e-08, 4.292712176237932e-08, 9.443796356541383e-09,
      -2.2739682547518797e-08, -5.3526973304110194e-08, -8.28320416876242e-08,
      -1.1057914429842484e-07, -1.3670276515278672e-07, -1.6114750762780652e-07,
      -1.8386794405110343e-07, -2.0482842532867792e-07, -2.240028530926552e-07,
      -2.413744169240006e-07, -2.56935299263922e-07, -2.706863506718905e-07,
      -2.8263673811839013e-07, -2.9280356901707185e-07, -3.0121149370440747e-07,
      -3.0789228906572756e-07, -3.128844259852348e-07, -3.162326232647877e-07,
      -3.179873906125693e-07, -3.1820456324882346e-07, -3.1694483061232274e-07,
      -3.1427326157880174e-07, -3.1025882852193806e-07, -3.0497393245929804e-07,
      -2.984939314306869e-07, -2.908966741552682e-07, -2.8226204090735776e-07,
      -2.7267149343965815e-07, -2.6220763566757934e-07, -2.509537867098863e-07,
      -2.3899356775989657e-07, -2.264105041384891e-07, -2.1328764375592195e-07,
      -1.9970719308451453e-07, -1.8575017161924076e-07, -1.7149608567877446e-07,
      -1.5702262227608578e-07, -1.4240536366583458e-07, -1.2771752305603948e-07,
      -1.1302970185429146e-07, -9.840966870456423e-08, -8.392216045985935e-08,
      -6.962870512888473e-08, -5.558746673204489e-08, -4.1853111903528645e-08,
      -2.8476697982492187e-08, -1.5505582247496753e-08, -2.983351864681008e-09,
      9.050225958191366e-09, 2.055923419252165e-08, 3.151161723246729e-08,
      4.1879173870860864e-08, 5.1637532772802525e-08, 6.076611126231994e-08,
      6.924805828176764e-08, 7.707018242217267e-08, 8.422286595557822e-08,
      9.069996582766746e-08, 9.649870259066699e-08, 1.0161953827285276e-07,
      1.060660441920536e-07, 1.0984475972652635e-07, 1.1296504305764139e-07,
      1.1543891489515714e-07, 1.1728089618768648e-07, 1.1850784080848286e-07,
      1.191387641901327e-07, 1.1919466886136992e-07, 1.1869836781527634e-07,
      1.1767430661085456e-07, 1.1614838507961412e-07, 1.1414777947566182e-07,
      1.1170076587209935e-07, 1.0883654556857047e-07, 1.0558507323483401e-07,
      1.0197688847353086e-07, 9.804295144212685e-08, 9.381448312960782e-08,
      8.932281083812966e-08, 8.45992193737358e-08, 7.967480840368637e-08,
      7.458035639113355e-08, 6.934619147104997e-08, 6.400206958468983e-08,
      5.8577060143641186e-08, 5.309943944891163e-08, 4.759659204566228e-08,
      4.209492015034354e-08, 3.661976124425341e-08, 3.119531388608673e-08,
      2.5844571756012623e-08, 2.0589265905333916e-08, 1.5449815148963105e-08,
      1.0445284502896745e-08, 5.593351535675294e-09, 9.102804715569393e-10,
      -3.589096146121714e-09, -7.89138845012336e-09, -1.1984653146849086e-08,
      -1.5858390583027542e-08, -1.9503535269156234e-08, -2.291244016594824e-08,
      -2.6078855056527612e-08, -2.8997899341455813e-08, -3.166602960588014e-08,
      -3.408100231820212e-08, -3.624183202770723e-08, -3.814874543462243e-08,
      -3.980313171012863e-08, -4.1207489446010155e-08, -4.236537061394109e-08,
      -4.3281321912958926e-08, -4.3960823880539055e-08, -4.44102281379396e-08,
      -4.463669313422283e-08, -4.46481187456656e-08, -4.445308007824036e-08,
      -4.4060760810575845e-08, -4.348088640338901e-08, -4.2723657488916634e-08,
      -4.1799683740464746e-08, -4.071991850793784e-08, -3.9495594490205927e-08,
      -3.8138160699516275e-08, -3.665922095695571e-08, -3.507047414131578e-08,
      -3.3383656396701686e-08, -3.1610485486949304e-08, -2.9762607467464226e-08,
      -2.785154582755833e-08, -2.58886532388191e-08, -2.388506602758472e-08,
      -2.1851661472291652e-08, -1.9799018009384467e-08, -1.7737378414699843e-08,
      -1.5676616010823187e-08, -1.3626203934928432e-08, -1.1595187486105984e-08,
      -9.592159556212442e-09, -7.625239133886624e-09, -5.702052857612287e-09,
      -3.829719580607447e-09, -2.014837897917035e-09, -2.6347657440898415e-10,
      1.418832198551345e-09, 3.027096800127211e-09, 4.556867522481973e-09,
      6.004235359008063e-09, 7.365828346386027e-09, 8.6388055754967e-09,
      9.820848992350525e-09, 1.091015311553349e-08, 1.1905412801206908e-08,
      1.280580919044936e-08, 1.3610993976707726e-08, 1.432107213334781e-08,
      1.4936583242783392e-08, 1.5458481569438403e-08, 1.5888115018885417e-08,
      1.6227203124931562e-08, 1.647781420521992e-08, 1.6642341824111075e-08,
      1.6723480699238117e-08, 1.672420218522292e-08, 1.6647729464636695e-08,
      1.6497512572419357e-08, 1.6277203375676717e-08, 1.599063062608874e-08,
      1.5641775197123406e-08, 1.523474561289662e-08, 1.477375396988625e-08,
      1.4263092346835047e-08, 1.3707109792099754e-08, 1.311018997145813e-08,
      1.247672955300773e-08, 1.1811117399314572e-08, 1.111771463043034e-08,
      1.040083561482607e-08, 9.66472993871998e-09, 8.913565397737549e-09,
      8.151412048362051e-09, 7.382227350240959e-09, 6.609842424134047e-09,
      5.837949444146996e-09, 5.070090176912705e-09, 4.309645674582475e-09,
      3.5598271228902444e-09, 2.8236678401728827e-09, 2.1040164180842316e-09,
      1.4035309898444405e-09, 7.246746072317807e-10, 6.971170316240814e-11,
      -5.592943873763404e-10, -1.1604828790640591e-09, -1.7321959951770372e-09,
      -2.2729784714256956e-09, -2.7815761453092567e-09, -3.2569336741872857e-09,
      -3.6981914275545667e-09, -4.104681600990983e-09, -4.475923600944593e-09,
      -4.8116187508981366e-09, -5.111644370572142e-09, -5.376047280638168e-09,
      -5.605036785961095e-09, -5.798977190668172e-09, -5.958379898364283e-09,
      -6.083895150587717e-09, -6.176303456139659e-09, -6.23650676323513e-09,
      -6.265519425525507e-09, -6.26445901194558e-09, -6.2345370090544684e-09,
      -6.177049463083062e-09, -6.093367607284548e-09, -5.984928518422999e-09,
      -5.8532258443417665e-09, -5.699800642542704e-09, -5.5262323675929105e-09,
      -5.334130042971737e-09, -5.125123650690903e-09, -4.9008557696784e-09,
      -4.662973491525664e-09, -4.4131206397702615e-09, -4.152930316435771e-09,
      -3.884017797088787e-09, -3.607973793211934e-09, -3.326358098242757e-09,
      -3.0406936312020986e-09, -2.7524608894424905e-09, -2.463092819696762e-09,
      -2.173970114308718e-09, -1.886416937289838e-09, -1.6016970826764105e-09,
      -1.3210105655676086e-09, -1.0454906442133659e-09, -7.762012695974947e-10,
      -5.141349571316453e-10, -2.6021107334412525e-10, -1.5274528818328454e-11,
      2.1990513288803508e-10, 4.446342620267594e-10, 6.582952581342247e-10,
      8.603463683780531e-10, 1.0503211440344926e-09, 1.2278275713208383e-09,
      1.392546893658763e-09, 1.5442321431830524e-09, 1.6827063999370151e-09,
      1.807860797712393e-09, 1.9196522958999436e-09, 2.0181012370194867e-09,
      2.103288709797918e-09, 2.1753537377637346e-09, 2.2344903133304965e-09,
      2.2809442972532305e-09, 2.3150102031651598e-09, 2.337027886641682e-09,
      2.3473791578987795e-09, 2.3464843368187724e-09, 2.334798768512423e-09,
      2.3128093170779107e-09, 2.281030854609214e-09, 2.2400027618441764e-09,
      2.190285456131216e-09, 2.1324569616385087e-09, 2.0671095359358093e-09,
      1.9948463662520266e-09, 1.9162783478564547e-09, 1.8320209561331873e-09,
      1.7426912230217652e-09, 1.6489048275873352e-09, 1.5512733095652763e-09,
      1.450401413802982e-09, 1.3468845725996414e-09, 1.2413065320277205e-09,
      1.1342371274114229e-09, 1.0262302122415602e-09, 9.178217439266098e-10,
      8.095280289196863e-10, 7.018441289239006e-10, 5.95242429067054e-10,
      4.901713681535512e-10, 3.870543303492616e-10, 2.862886969360575e-10,
      1.8824505608889688e-10, 9.326656798133835e-11, 1.6684819167866596e-12,
      -8.626219838616716e-11, -1.7026690575418894e-10, -2.5011556165205477e-10,
      -3.256064947392128e-10, -3.9656623162358387e-10, -4.6284916590577085e-10,
      -5.243371119239419e-10, -5.809387498844506e-10, -6.325889692961809e-10,
      -6.792481178182669e-10, -7.209011627820049e-10, -7.575567727593776e-10,
      -7.892463266237158e-10, -8.160228575838453e-10, -8.379599396729291e-10,
      -8.551505241385663e-10, -8.677057331130966e-10, -8.757536178441055e-10,
      -8.794378886365573e-10, -8.78916623501575e-10, -8.743609623244784e-10,
      -8.659537931581702e-10, -8.538884370192413e-10, -8.383673373152071e-10,
      -8.196007597640294e-10, -7.978055083835044e-10, -7.732036628301703e-10,
      -7.46021342057051e-10, -7.164874989387388e-10, -6.848327501829257e-10,
      -6.512882455113929e-10, -6.160845797524682e-10, -5.794507511428504e-10,
      -5.416131687911674e-10, -5.027947119103469e-10, -4.6321384308242097e-10,
      -4.230837774792523e-10, -3.8261170962732427e-10, -3.419980989755038e-10,
      -3.01436015202863e-10, -2.6111054389040565e-10, -2.2119825287699857e-10,
      -1.8186671932695951e-10, -1.4327411725552724e-10, -1.0556886498967264e-10,
      -6.888933178613262e-11, -3.336360258681736e-11, 8.907003355845377e-13,
      3.376654030143019e-11, 6.516753537419566e-11, 9.500797557525455e-11,
      1.2321279016768435e-10, 1.497174671633862e-10, 1.7446792734181054e-10,
      1.9742035518665243e-10, 2.1854098924911275e-10, 2.378058745328766e-10,
      2.5520057956706774e-10, 2.7071988088939344e-10, 2.843674177028396e-10,
      2.961553194960255e-10, 3.0610380943012593e-10, 3.1424078629462474e-10,
      3.2060138782061266e-10, 3.2522753811447067e-10, 3.281674819371969e-10,
      3.2947530850598647e-10, 3.2921046743562633e-10, 3.2743727936851206e-10,
      3.2422444376433754e-10, 3.196445462344693e-10, 3.1377356771242687e-10,
      3.0669039765148145e-10, 2.9847635333389734e-10, 2.892147072645052e-10,
      2.789902245048478e-10, 2.6788871168379586e-10, 2.5599657929701043e-10,
      2.434004187816186e-10, 2.3018659572466402e-10, 2.1644086043494256e-10,
      2.0224797697838563e-10, 1.8769137164782123e-10, 1.7285280170932132e-10,
      1.5781204513999743e-10, 1.4264661194657003e-10, 1.2743147753081926e-10,
      1.1223883844759925e-10, 9.713789078390919e-11, 8.219463127397426e-11,
      6.747168115577337e-11, 5.302813266930348e-11, 3.891941799640256e-11,
      2.5197200346439513e-11, 1.1909286801862503e-11, -9.004375473151336e-13,
      -1.3192054730344803e-11, -2.492963890775255e-11, -3.6081261960171924e-11,
      -4.661898040751091e-11, -5.6518804467873294e-11, -6.576065011558597e-11,
      -7.432827504164685e-11, -8.220919945793921e-11, -8.939461271871995e-11,
      -9.587926675926956e-11, -1.0166135737229902e-10, -1.0674239435787717e-10,
      -1.111270615924223e-10, -1.1482306806686614e-10, -1.1784099094363373e-10,
      -1.201941116767932e-10, -1.2189824622983539e-10, -1.2297157041127172e-10,
      -1.2343444132983292e-10, -1.2330921594876125e-10, -1.2262006769277514e-10,
      -1.2139280203201032e-10, -1.196546719348766e-10, -1.1743419404658744e-10,
      -1.1476096641239723e-10, -1.1166548852459202e-10, -1.0817898443030071e-10,
      -1.0433322959349874e-10, -1.0016038215943484e-10, -9.569281922339048e-11,
      -9.096297865844152e-11, -8.600320700898831e-11, -8.084561390850048e-11,
      -7.552193343142614e-11, -7.006339274077282e-11, -6.450058834470161e-11,
      -5.886337022779542e-11, -5.318073407567011e-11, -4.748072176548113e-11,
      -4.1790330249816625e-11, -3.613542891762546e-11, -3.054068547335977e-11,
      -2.5029500334556364e-11, -1.9623949508768348e-11, -1.434473587320317e-11,
      -9.21114874472817e-12, -4.241031594160574e-12, 5.492422729577011e-13,
      5.14478627652364e-12, 9.53220959787627e-12, 1.3699618951832195e-11,
      1.7636613378022735e-11, 2.1334272355645364e-11, 2.4785137564346264e-11,
      2.7983188630319338e-11, 3.092381321085442e-11, 3.360377178251731e-11,
      3.602115750792972e-11, 3.8175351563780045e-11, 4.0066974318285705e-11,
      4.169783274990228e-11, 4.3070864500697667e-11, 4.419007895755251e-11,
      4.50604957522873e-11, 4.5688081068033663e-11, 4.607968213374957e-11,
      4.624296028181523e-11, 4.618632293523344e-11, 4.5918854881190885e-11
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      6.0123930158088445e-05, 0.00012157423617867888, 0.00013795968127287088,
      0.00018007377114577494, 0.0002452203235957439, 0.00033210346968419045,
      0.0004405362581339582, 0.0005711824045535501, 0.0007253287918823927,
      0.0009046864385317489, 0.0011112177580751867, 0.001346988039026538,
      0.001614039175237083, 0.001914283776752615, 0.0022494178876008943,
      0.0026208506309371533, 0.0030296491932668467, 0.0034764976480985534,
      0.003961668205364604, 0.00448500355629224, 0.005045909064124722, 0.005643353629191539,
      0.006275878132322909, 0.0069416104335103595, 0.007638285973047997,
      0.00836327309016532, 0.009113602239400546, 0.009885998347683568, 0.010676915615321542,
      0.011482574121831094, 0.012298997652864069, 0.013122052217355677, 0.01394748477451303,
      0.014770961738388875, 0.015588106873581888, 0.01639453823910505, 0.01718590387870317,
      0.017957915994917202, 0.018706383381025697, 0.019427241919684205,
      0.020116582989673937, 0.020770679652706993, 0.021386010520762395, 0.02195928123099381,
      0.02248744347990519, 0.022967711591285744, 0.023397576613383472, 0.023774817960030094,
      0.0240975126279653, 0.024364042038500452, 0.02457309656596891, 0.024723677828189728,
      0.024815098825482985, 0.024846982024677854, 0.024819255493109198,
      0.024732147194865613, 0.024586177567592456, 0.02438215050302901, 0.02412114285823053,
      0.023804492627155255, 0.023433785904043956, 0.02301084277084685, 0.022537702240919354,
      0.022016606390374192, 0.021449983806901957, 0.020840432483613253,
      0.020190702282570656, 0.019503677089223636, 0.018782356774989867,
      0.018029839080795144, 0.017249301529544396, 0.016443983470298313, 0.0156171683514238,
      0.014772166314219005, 0.013912297192531339, 0.013040873997733692,
      0.012161186962142403, 0.011276488207590685, 0.010389977099451829,
      0.009504786339973856, 0.008623968848375905, 0.007750485468798897, 0.00688719354092917,
      0.00603683636195214, 0.005202033562469591, 0.004385272413153213, 0.003588900073230276,
      0.0028151167864248435, 0.002065970024727632, 0.0013433495753553105,
      0.0006489835614996842, -1.5564617029218296e-05, -0.0006488984413845301,
      -0.0012497895515468623, -0.0018171781701813042, -0.0023501727015545694,
      -0.0028480485376407606, -0.0033102461063069825, -0.0037363681989345363,
      -0.0041261766169990565, -0.0044795881790065046, -0.0047966701307654925,
      -0.0050776350032751705, -0.005322834963528402, -0.005532755704279444,
      -0.0057080099193123675, -0.005849330410980225, -0.00595756287677554,
      -0.006033658421450838, -0.006078665840745108, -0.0060937237221001216,
      -0.006080052406881958, -0.006038945857570593, -0.005971763472157202,
      -0.0058799218866081165, -0.005764886804729826, -0.005628164893114438,
      -0.005471295777073413, -0.005295844171592572, -0.0051033921793769595,
      -0.004895531786013353, -0.004673857580174216, -0.004439959724632457,
      -0.004195417201664136, -0.003941791354198228, -0.0036806197418406687,
      -0.0034134103286653948, -0.0031416360174387962, -0.0028667295427363486,
      -0.002590078733230953, -0.0023130221512909846, -0.002036845115930925,
      -0.001762776113116862, -0.0014919835954505904, -0.001225573171346426,
      -0.000964585181980481, -0.0007099926625386637, -0.00046269968262213813,
      -0.00022354005909184792, 6.723566849254854e-06, 0.00022740029792315012,
      0.000437871205265239, 0.0006375892211901769, 0.0008260787133707205,
      0.0010029347545406572, 0.0011678221027034245, 0.0013204739075938171,
      0.0014606901598018245, 0.0015883358995262336, 0.0017033392023826572,
      0.0018056889600480519, 0.0018954324737839, 0.0019726728790457025,
      0.0020375664194603117, 0.002090319588438226, 0.0021311861565888857,
      0.0021604641029271195, 0.002178492467602224, 0.0021856481435520614,
      0.0021823426240873875, 0.0021690187229510146, 0.0021461472828770266,
      0.00211422388810188, 0.0020737655956566685, 0.002025307699602993,
      0.0019694005416686024, 0.0019066063809981676, 0.001837496334963987,
      0.0017626474021859523, 0.0016826395780943529, 0.001598053072537712,
      0.0015094656380953127, 0.001417450016904735, 0.0013225715129628246,
      0.0012253856960081006, 0.0011264362422475722, 0.001026252916354995,
      0.000925349698344262, 0.0008242230581142191, 0.0007233503796728294,
      0.0006231885362821848, 0.0005241726170240514, 0.000426714804570906,
      0.00033120340326199635, 0.00023800201592985625, 0.0001474488673017052,
      5.985627121381731e-05, -2.448976167340441e-05, -0.00010532977948515621,
      -0.00018243101236751228, -0.00025558736808555264, -0.0003246193051190235,
      -0.00038937358874815243, -0.0004497229359406539, -0.0005055655551299464,
      -0.0005568245872144457, -0.0006034474543089521, -0.0006454051229422158,
      -0.0006826912885205285, -0.0007153214879665292, -0.000743332147496396,
      -0.0007667795725183605, -0.0007857388866223146, -0.000800302926585553,
      -0.0008105811002448633, -0.0008166982139818028, -0.0008187932764376869,
      -0.0008170182849192443, -0.0008115370007767869, -0.0008025237198358772,
      -0.0007901620437426232, -0.0007746436578437401, -0.0007561671209671806,
      -0.0007349366721993135, -0.0007111610594721227, -0.0006850523944805284,
      -0.0006568250381474828, -0.0006266945205447164, -0.0005948764988616407,
      -0.0005615857566956072, -0.0005270352476151376, -0.0004914351856254212,
      -0.0004549921848438544, -0.00041790845037413066, -0.00038038102205173127,
      -0.00034260107242296454, -0.000304753260015157, -0.0002670151386583917,
      -0.00022955662333038306, -0.0001925395127166719, -0.00015611706840923202,
      -0.00012043365040862736, -8.562440834878548e-05, -5.1815027629927186e-05,
      -1.9121529424776373e-05, 1.2349876683631699e-05, 4.2502888867018225e-05,
      7.125115963272873e-05, 9.851829459718464e-05, 0.00012423780537780023,
      0.00014835301866348785, 0.00017081694364323423, 0.00019159210007675624,
      0.0002106503093810479, 0.00022797245118188737, 0.00024354818784031967,
      0.0002573756595110608, 0.00026946115232302564, 0.00027981874229216305,
      0.0002884699175839249, 0.0002954431817374818, 0.0003007736404467532,
      0.0003045025744649859, 0.0003066770011605857, 0.0003073492272027857,
      0.0003065763947971537, 0.00030442002382355084, 0.0003009455521536164,
      0.000296221876341847, 0.0002903208947945423, 0.00028331705542499077,
      0.0002752869097019584, 0.00026630867489249664, 0.0002564618061899935,
      0.00024582658030491457, 0.00023448369197948124, 0.00022251386476925713,
      0.00020999747731489027, 0.00019701420620669473, 0.00018364268642394582,
      0.00016996019021026858, 0.00015604232512687134, 0.0001419627519071232,
      0.00012779292261959216, 0.00011360183953261067, 9.945583496214619e-05,
      8.54183722766343e-05, 7.154986812784685e-05, 5.7907535876163294e-05,
      4.4545250082094594e-05, 3.151343184385515e-05, 1.8858954673434938e-05,
      6.62507052120376e-06, -5.148644518233558e-06, -1.642632535826715e-05,
      -2.7175834536608536e-05, -3.736876096292841e-05, -4.6980401520690076e-05,
      -5.598972629616295e-05, -6.437932825212428e-05, -7.213535820272208e-05,
      -7.924744597942254e-05, -8.570860870596672e-05, -9.151514712290481e-05,
      -9.666653091967076e-05, -0.00010116527404443765, -0.00010501680096930152,
      -0.00010822930489084628, -0.00011081359884402467, -0.00011278296070074472,
      -0.00011415297301378781, -0.00011494135865191971, -0.00011516781315352008,
      -0.0001148538347039853, -0.0001140225526167977, -0.00011269855516975004,
      -0.00011090771761662177, -0.00010867703116087727, -0.00010603443364195464,
      -0.00010300864264669332, -9.962899171866661e-05, -9.592527029689488e-05,
      -9.192756797286854e-05, -8.766612361125294e-05, -8.31711798353217e-05,
      -7.84728433333064e-05, -7.3600951396687e-05, -6.858494505619935e-05,
      -6.345374913621666e-05, -5.823565950337234e-05, -5.2958237741027396e-05,
      -4.764821343762836e-05, -4.2331394234324566e-05, -3.703258373557852e-05,
      -3.177550734605949e-05, -2.658274605799823e-05, -2.1475678175525618e-05,
      -1.6474428926436756e-05, -1.1597827877416537e-05, -6.86337403612552e-06,
      -2.2872084927552122e-06, 2.1159055752123973e-06, 6.3325957382086544e-06,
      1.0350886217798438e-05, 1.4160197108804613e-05, 1.7751337191985474e-05,
      2.1116490627588462e-05, 2.424919783668906e-05, 2.7144330891727802e-05,
      2.9798063750097495e-05, 3.220783767503225e-05, 3.4372322196443844e-05,
      3.6291371970780887e-05, 3.796597990350158e-05, 3.9398226900407e-05,
      4.059122861494203e-05, 4.154907955770246e-05, 4.2276794931863424e-05,
      4.278025055414395e-05, 4.3066121215327114e-05, 4.314181782735144e-05,
      4.301542369566462e-05, 4.2695630245977935e-05, 4.219167252387114e-05,
      4.151326477396904e-05, 4.067053639273702e-05, 3.96739685354216e-05,
      3.853433164338815e-05, 3.72626241431786e-05, 3.5870012553122144e-05,
      3.4367773217375095e-05, 3.2767235870935224e-05, 3.107972922256116e-05,
      2.931652872571655e-05, 2.748880669073753e-05, 2.5607584874473018e-05,
      2.3683689666749538e-05, 2.1727709976241833e-05, 1.974995790175964e-05,
      1.776043225865809e-05, 1.5768785014108817e-05, 1.3784290669391257e-05,
      1.181581861223495e-05, 9.871808447615817e-06, 7.96024830132949e-06,
      6.088656077176186e-06, 4.264063635732581e-06, 2.4930038504906573e-06,
      7.815004856416424e-07, -8.649391710003855e-07, -2.4413289964845253e-06,
      -3.9432061284557545e-06, -5.366630562490391e-06, -6.708182353132256e-06,
      -7.964956527687701e-06, -9.134555828015305e-06, -1.0215081400944295e-05,
      -1.1205121562580655e-05, -1.2103738765621342e-05, -1.2910454901907853e-05,
      -1.362523507482613e-05, -1.4248469977819325e-05, -1.4780957016244017e-05,
      -1.5223880310092731e-05, -1.5578789714751636e-05, -1.5847578995989583e-05,
      -1.6032463293812566e-05, -1.613595600769712e-05, -1.6160845233069182e-05,
      -1.6110169875755034e-05, -1.5987195567532232e-05, -1.579539050188609e-05,
      -1.55384013046666e-05, -1.522002904957802e-05, -1.4844205523354224e-05,
      -1.4414969840114132e-05, -1.3936445498788388e-05, -1.3412817971697115e-05,
      -1.2848312906373865e-05, -1.2247175016607589e-05, -1.161364773244626e-05,
      -1.0951953672605668e-05, -1.0266275996386923e-05, -9.560740685856978e-06,
      -8.839399802717928e-06, -8.106215758011238e-06, -7.365046626599265e-06,
      -6.619632532264314e-06, -5.873583123288876e-06, -5.130366152552265e-06,
      -4.393297170519498e-06, -3.665530334027398e-06, -2.950050328507998e-06,
      -2.24966539624668e-06, -1.56700145846623e-06, -9.044973144709506e-07,
      -2.644008967880902e-07, 3.5123344278340446e-07, 9.405466450567582e-07,
      1.501875685580205e-06, 2.03375338248341e-06, 2.5349073084191173e-06,
      3.004257847565809e-06, 3.4409154409582137e-06, 3.844177065421585e-06,
      4.21352199310526e-06, 4.548606880044756e-06, 4.849260233334432e-06,
      5.1154763073705025e-06, 5.3474084802339e-06, 5.5453621616320904e-06,
      5.709787283917304e-06, 5.841270427555332e-06, 5.9405266320444304e-06,
      6.008390942689033e-06, 6.045809742829346e-06, 6.053831920127764e-06,
      6.033599914328684e-06, 5.986340692552765e-06, 5.913356696672956e-06,
      5.816016805661096e-06, 5.69574735400404e-06, 5.554023245380581e-06,
      5.392359198778476e-06, 5.212301162128101e-06, 5.015417926348988e-06,
      4.8032929704609375e-06, 4.577516566115458e-06, 4.339678167568643e-06,
      4.091359110755547e-06, 3.834125642750629e-06, 3.5695223005204656e-06,
      3.2990656555047752e-06, 3.0242384382103514e-06, 2.7464840546800678e-06,
      2.4672015044150476e-06, 2.1877407070915115e-06, 1.909398243233077e-06,
      1.63341351188225e-06, 1.360965306268684e-06, 1.0931688065031436e-06,
      8.310729864409027e-07, 5.756584300619475e-07, 3.2783555101251625e-07,
      8.844320734732109e-08, -1.4175229799225328e-07, -3.620578418287165e-07,
      -5.718537426862845e-07, -7.705936733601428e-07, -9.578042385379526e-07,
      -1.1330842328612457e-06, -1.2961035956714114e-06, -1.4466020794327075e-06,
      -1.5843876494640404e-06, -1.7093346331435817e-06, -1.8213816371774282e-06,
      -1.9205292518477576e-06, -2.006837561379865e-06, -2.080423479694128e-06,
      -2.1414579308416253e-06, -2.1901628933644518e-06, -2.226808327677637e-06,
      -2.251709005343103e-06, -2.2652212588016423e-06, -2.2677396697510024e-06,
      -2.2596937139115003e-06, -2.241544379409999e-06, -2.213780775443462e-06,
      -2.1769167472596797e-06, -2.1314875128201327e-06, -2.078046335793469e-06,
      -2.0171612487726897e-06, -1.9494118398200043e-06, -1.8753861146253611e-06,
      -1.7956774457228294e-06, -1.710881619348176e-06, -1.621593989645831e-06,
      -1.5284067490486128e-06, -1.431906322763557e-06, -1.3326708944062663e-06,
      -1.2312680689385207e-06, -1.1282526781834376e-06, -1.0241647333229973e-06,
      -9.195275279278524e-07, -8.148458942323495e-07, -7.10604614551773e-07,
      -6.072669889468873e-07, -5.052735594755908e-07, -4.0504099063536775e-07,
      -3.0696110489546907e-07, -2.1140007154634056e-07, -1.1869774645753529e-07,
      -2.9167159735697193e-08, 5.6905852287499955e-08, 1.3926287483027113e-07,
      2.1767300677414914e-07, 2.9193282213393334e-07, 3.6186620630362065e-07,
      4.2732407285812537e-07, 4.881839670098076e-07, 5.443495620971021e-07,
      5.957500557202134e-07, 6.423394723364689e-07, 6.840958792861747e-07,
      7.21020523339571e-07, 7.531368949377046e-07, 7.804897273458683e-07,
      8.031439379489437e-07, 8.211835188948842e-07, 8.347103842371497e-07,
      8.438431806407192e-07, 8.487160686009701e-07, 8.494774809819504e-07,
      8.462888655121272e-07, 8.393234176833771e-07, 8.287648102846495e-07,
      8.148059255672434e-07, 7.976475957858834e-07, 7.774973575906699e-07,
      7.545682254613975e-07, 7.290774890795806e-07, 7.012455392266667e-07,
      6.712947264812003e-07, 6.394482566649295e-07, 6.05929126659813e-07,
      5.709591038862891e-07, 5.347577523997025e-07, 4.975415082280483e-07,
      4.595228062417546e-07, 4.209092605165392e-07, 3.8190289982488683e-07,
      3.4269945957170374e-07, 3.0348773117649414e-07, 2.644489695991269e-07,
      2.2575635941002118e-07, 1.875745395193733e-07, 1.5005918640479688e-07,
      1.133566554132811e-07, 7.760367946243443e-08, 4.2927124228224515e-08,
      9.44379868242034e-09, -2.2739680366829837e-08, -5.3526971272993704e-08,
      -8.283203980963237e-08, -1.1057914257629395e-07, -1.3670276358845466e-07,
      -1.611475062224332e-07, -1.838679428050938e-07, -2.0482842424170772e-07,
      -2.2400285216369917e-07, -2.413744161513627e-07, -2.569352986452675e-07,
      -2.706863502042798e-07, -2.826367377983143e-07, -2.9280356884048893e-07,
      -3.012114936667798e-07, -3.0789228916206025e-07, -3.128844262101153e-07,
      -3.1623262361242547e-07, -3.179873910768358e-07, -3.182045638232921e-07,
      -3.1694483129030925e-07, -3.1427326235340337e-07, -3.102588293860733e-07,
      -3.049739334057454e-07, -2.9849393245212257e-07, -2.9089667524430294e-07,
      -2.8226204205657257e-07, -2.7267149464163867e-07, -2.6220763691494886e-07,
      -2.509537879953374e-07, -2.389935690762208e-07, -2.2641050547860605e-07,
      -2.132876451129055e-07, -1.9970719445161805e-07, -1.8575017298992078e-07,
      -1.7149608704671242e-07, -1.5702262363520848e-07, -1.424053650103327e-07,
      -1.2771752438038423e-07, -1.1302970315324931e-07, -9.840966997320967e-08,
      -8.392216169358583e-08, -6.962870632341371e-08, -5.558746788343304e-08,
      -4.18531130081732e-08, -2.8476699037134653e-08, -1.5505583249224906e-08,
      -2.983352810929226e-09, 9.05022506964333e-09, 2.055923336355142e-08,
      3.151161646461405e-08, 4.187917316533092e-08, 5.163753213047615e-08,
      6.076611068375944e-08, 6.924805776722649e-08, 7.707018197160585e-08,
      8.422286556865341e-08, 9.069996550377722e-08, 9.649870232894165e-08,
      1.0161953807217411e-07, 1.0606604405106913e-07, 1.0984475964366416e-07,
      1.1296504303112546e-07, 1.1543891492302302e-07, 1.17280896267797e-07,
      1.1850784093854429e-07, 1.1913876436771104e-07, 1.1919466908390726e-07,
      1.1869836808010733e-07, 1.1767430691522263e-07, 1.1614838542068738e-07,
      1.1414777985054865e-07, 1.1170076627786359e-07, 1.088365460022464e-07,
      1.0558507369344077e-07, 1.0197688895408635e-07, 9.804295194166121e-08,
      9.381448364517645e-08, 8.932281136682557e-08, 8.459921991270116e-08,
      7.967480895012339e-08, 7.458035694231455e-08, 6.934619202432681e-08,
      6.400207013750257e-08, 5.8577060693526134e-08, 5.30994399935087e-08,
      4.759659258272165e-08, 4.209492067773165e-08, 3.6619761759958205e-08,
      3.119531438822224e-08, 2.5844572242822783e-08, 2.058926637519572e-08,
      1.5449815600389053e-08, 1.0445284934536602e-08, 5.59335194631717e-09,
      9.102808601276857e-10, -3.589095780556732e-09, -7.891388108361116e-09,
      -1.1984652829550326e-08, -1.5858390290718785e-08, -1.9503535002232294e-08,
      -2.2912439924675254e-08, -2.6078854841046543e-08, -2.899789915178638e-08,
      -3.166602944192513e-08, -3.408100217975212e-08, -3.624183191444561e-08,
      -3.814874534613079e-08, -3.980313164589238e-08, -4.1207489405424426e-08,
      -4.236537059631673e-08, -4.328132191752873e-08, -4.396082390646405e-08,
      -4.441022818431541e-08, -4.463669320008609e-08, -4.46481188300004e-08,
      -4.4453080179984674e-08, -4.406076092862801e-08, -4.348088653661415e-08,
      -4.2723657636152983e-08, -4.1799683900529926e-08, -4.071991867963498e-08,
      -3.949559467232966e-08, -3.8138160890858483e-08, -3.6659221156311194e-08,
      -3.507047434748764e-08, -3.3383656608506404e-08, -3.161048570322174e-08,
      -2.9762607687062183e-08, -2.785154604936692e-08, -2.588865346175482e-08,
      -2.3885066250599237e-08, -2.1851661694375293e-08, -1.9799018229569378e-08,
      -1.7737378632062814e-08, -1.567661622448818e-08, -1.3626204144068833e-08,
      -1.1595187689946529e-08, -9.59215975403087e-09, -7.625239325014988e-09,
      -5.702053041437964e-09, -3.829719756573871e-09, -2.0148380655241207e-09,
      -2.6347673321328723e-10, 1.4188320489367445e-09, 3.027096660033078e-09,
      4.556867392183528e-09, 6.00423523872582e-09, 7.365828236286853e-09,
      8.638805475695076e-09, 9.82084890291e-09, 1.0910153036468308e-08,
      1.1905412732483789e-08, 1.2805809131989418e-08, 1.3610993928388523e-08,
      1.4321072095005526e-08, 1.493658321421511e-08, 1.5458481550404507e-08,
      1.588811500911204e-08, 1.622720312411311e-08, 1.6477814213021633e-08,
      1.6642341840171624e-08, 1.672348072317221e-08, 1.672420221662394e-08,
      1.6647729503079315e-08, 1.649751261746216e-08, 1.6277203426864804e-08,
      1.5990630682956288e-08, 1.5641775259196188e-08, 1.5234745679694477e-08,
      1.4773754040925467e-08, 1.4263092421630687e-08, 1.370710987016789e-08,
      1.3110190052318028e-08, 1.2476729636183912e-08, 1.1811117484338793e-08,
      1.1117714716843458e-08, 1.0400835702179798e-08, 9.664730026578536e-09,
      8.913565485679184e-09, 8.151412135980454e-09, 7.382227437146542e-09,
      6.609842509955098e-09, 5.837949528530708e-09, 5.0700902595260765e-09,
      4.309645755113092e-09, 3.559827201046938e-09, 2.8236679156862658e-09,
      2.1040164907071127e-09, 1.4035310593521176e-09, 7.246746734222273e-10,
      6.971176585634619e-11, -5.592943283354721e-10, -1.1604828238102415e-09,
      -1.7321959438219057e-09, -2.27297842405887e-09, -2.781576101998761e-09,
      -3.256933634980052e-09, -3.698191392477018e-09, -4.104681570049685e-09,
      -4.475923574126975e-09, -4.811618728173268e-09, -5.111644351891554e-09,
      -5.376047265936734e-09, -5.6050367751579494e-09, -5.798977183667674e-09,
      -5.958379895057007e-09, -6.083895150851468e-09, -6.1763034598405104e-09,
      -6.23650677022847e-09, -6.265519435657105e-09, -6.2644590250526494e-09,
      -6.234537024966737e-09, -6.177049481623832e-09, -6.093367628271752e-09,
      -5.984928541670231e-09, -5.85322586965929e-09, -5.69980066973844e-09,
      -5.5262323964734004e-09, -5.334130073343066e-09, -5.125123682359589e-09,
      -4.90085580245225e-09, -4.6629735252145876e-09, -4.413120674187063e-09,
      -4.1529303513968965e-09, -3.884017832415023e-09, -3.6079738287290653e-09,
      -3.3263581337821736e-09, -3.040693666601353e-09, -2.752460924545803e-09,
      -2.4630928543554795e-09, -2.1739701483817205e-09, -1.886416970643898e-09,
      -1.6016971151865047e-09, -1.3210105971171814e-09, -1.0454906746945477e-09,
      -7.762012989112695e-10, -5.141349851879719e-10, -2.6021110006201436e-10,
      -1.5274554125874476e-11, 2.199051090536652e-10, 4.4463423971937764e-10,
      6.58295237398712e-10, 8.603463492504869e-10, 1.0503211265423108e-09,
      1.2278275554830355e-09, 1.392546879486119e-09, 1.5442321306783896e-09,
      1.6827063890954818e-09, 1.8078607885217712e-09, 1.9196522883409807e-09,
      2.0181012310662443e-09, 2.10328870541814e-09, 2.17535373491923e-09,
      2.234490311977537e-09, 2.2809442973429605e-09, 2.3150102046440156e-09,
      2.3370278894518196e-09, 2.3473791619785062e-09, 2.346484342102975e-09,
      2.3347987749329933e-09, 2.3128093245641695e-09, 2.2810308630883297e-09,
      2.2400027712415756e-09, 2.1902854663709835e-09, 2.1324569726437807e-09,
      2.067109547629156e-09, 1.9948463785558254e-09, 1.9162783606932436e-09,
      1.8320209694260089e-09, 1.7426912366944937e-09, 1.6489048415649862e-09,
      1.551273323774302e-09, 1.4504014281715458e-09, 1.346884587057874e-09,
      1.2413065465079568e-09, 1.134237141848421e-09, 1.026230226572703e-09,
      9.178217580920853e-10, 8.095280428626496e-10, 7.018441425906153e-10,
      5.952424424070159e-10, 4.901713811195944e-10, 3.870543428976456e-10,
      2.862887090265366e-10, 1.8824506768477072e-10, 9.326657904948479e-11,
      1.6684924276774113e-12, -8.626218845846746e-11, -1.7026689643203968e-10,
      -2.501155529542717e-10, -3.256064866811151e-10, -3.96566224217055e-10,
      -4.628491591593324e-10, -5.243371058428401e-10, -5.809387444707534e-10,
      -6.325889645488863e-10, -6.792481137334213e-10, -7.209011593528303e-10,
      -7.57556769976407e-10, -7.892463244749362e-10, -8.16022856054846e-10,
      -8.379599387470549e-10, -8.55150523797076e-10, -8.677057333353251e-10,
      -8.757536186076294e-10, -8.794378899173623e-10, -8.789166252742241e-10,
      -8.7436096456228e-10, -8.659537958333457e-10, -8.538884401030918e-10,
      -8.38367340778278e-10, -8.1960076357627e-10, -7.978055125144249e-10,
      -7.732036672489949e-10, -7.460213467328679e-10, -7.164875038406445e-10,
      -6.848327552801637e-10, -6.512882507734857e-10, -6.160845851493449e-10,
      -5.794507566449677e-10, -5.416131743696226e-10, -5.027947175369853e-10,
      -4.6321384872993296e-10, -4.2308378312126465e-10, -3.8261171523848323e-10,
      -3.4199810453155076e-10, -3.014360206807022e-10, -2.611105492681648e-10,
      -2.211982581340816e-10, -1.818667244440912e-10, -1.4327412221479055e-10,
      -1.0556886977453884e-10, -6.888933638148391e-11, -3.336360697896251e-11,
      8.906961589015863e-13, 3.37665363510285e-11, 6.516753165946208e-11,
      9.500797210415483e-11, 1.232127869467803e-10, 1.497174641978586e-10,
      1.7446792463548712e-10, 1.9742035274204142e-10, 2.1854098706744095e-10,
      2.3780587261413174e-10, 2.552005779100453e-10, 2.707198794917468e-10,
      2.843674165611333e-10, 2.9615531860579186e-10, 3.061038087859239e-10,
      3.142407858901012e-10, 3.2060138764856566e-10, 3.25227538166914e-10,
      3.281674822054258e-10, 3.2947530898064385e-10, 3.292104681067693e-10,
      3.2743728022567895e-10, 3.242244447966146e-10, 3.196445474305569e-10,
      3.1377356906070485e-10, 3.0669039914007387e-10, 2.9847635495073595e-10,
      2.892147089973918e-10, 2.7899022634151496e-10, 2.678887136119655e-10,
      2.5599658130445e-10, 2.4340042085619487e-10, 2.3018659785439496e-10,
      2.164408626080464e-10, 2.022479791833274e-10, 1.8769137387335607e-10,
      1.7285280394453482e-10, 1.5781204737434288e-10, 1.4264661416990258e-10,
      1.274314797334271e-10, 1.1223884062023144e-10, 9.71378929178004e-11,
      8.219463336086639e-11, 6.747168318793388e-11, 5.30281346395407e-11,
      3.8919419898077837e-11, 2.519720217347644e-11, 1.1909288548753313e-11,
      -9.00435885505979e-13, -1.3192053157979756e-11, -2.4929637428622755e-11,
      -3.6081260577501525e-11, -4.661897912396378e-11, -5.651880328556202e-11,
      -6.576064903608298e-11, -7.432827406599767e-11, -8.22091985866775e-11,
      -8.939461195188444e-11, -9.587926609642263e-11, -1.0166135681254675e-10,
      -1.0674239389989075e-10, -1.1112706123446074e-10, -1.148230678067998e-10,
      -1.1784099077896851e-10, -1.2019411160469545e-10, -1.218982462471576e-10,
      -1.2297157051457875e-10, -1.2343444151542824e-10, -1.2330921621271363e-10,
      -1.2262006803094555e-10, -1.213928024400786e-10, -1.1965467240836783e-10,
      -1.174341945808981e-10, -1.1476096700282103e-10, -1.1166548916634508e-10,
      -1.0817898511854628e-10, -1.0433323032337118e-10, -1.0016038292606293e-10,
      -9.569282002191967e-11, -9.096297948405543e-11, -8.600320785692915e-11,
      -8.084561477408849e-11, -7.552193431007778e-11, -7.006339362801804e-11,
      -6.45005892361998e-11, -5.88633711193502e-11, -5.3180734963242816e-11,
      -4.748072264520325e-11, -4.1790331118000936e-11, -3.613542977077593e-11,
      -3.0540686308180193e-11, -2.502950114795777e-11, -1.9623950297875162e-11,
      -1.4344736635358153e-11, -9.211149477496195e-12, -4.241032295331277e-12,
      5.492416053683789e-13, 5.144785644272979e-12, 9.532209002495341e-12,
      1.3699618394627426e-11, 1.7636612860078428e-11, 2.1334271877827142e-11,
      2.4785137127305364e-11, 2.7983188234497744e-11, 3.0923812856490754e-11,
      3.360377146965342e-11, 3.6021157236417936e-11, 3.8175351333290995e-11,
      4.006697412831666e-11, 4.1697832599785946e-11, 4.3070864389611375e-11,
      4.419007888452778e-11, 4.506049571621969e-11, 4.568808106769288e-11,
      4.607968216778975e-11, 4.6242960348785426e-11, 4.6186323033588096e-11,
      4.5918855009300347e-11
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_9_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<9>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 8.737946553207119e-05), "design.b()[0] == 8.737946553207119e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 8.737946553207119e-05));
    static_assert(almost_equal(design.b()[1], -0.0005437576334036196), "design.b()[1] == -0.0005437576334036196");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.0005437576334036196));
    static_assert(almost_equal(design.b()[2], 0.0014229486551317397), "design.b()[2] == 0.0014229486551317397");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.0014229486551317397));
    static_assert(almost_equal(design.b()[3], -0.00187887383085676), "design.b()[3] == -0.00187887383085676");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.00187887383085676));
    static_assert(almost_equal(design.b()[4], 0.0009123370294813795), "design.b()[4] == 0.0009123370294813795");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.0009123370294813795));
    static_assert(almost_equal(design.b()[5], 0.0009123370294813795), "design.b()[5] == 0.0009123370294813795");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - 0.0009123370294813795));
    static_assert(almost_equal(design.b()[6], -0.00187887383085676), "design.b()[6] == -0.00187887383085676");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - -0.00187887383085676));
    static_assert(almost_equal(design.b()[7], 0.0014229486551317397), "design.b()[7] == 0.0014229486551317397");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - 0.0014229486551317397));
    static_assert(almost_equal(design.b()[8], -0.0005437576334036196), "design.b()[8] == -0.0005437576334036196");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - -0.0005437576334036196));
    static_assert(almost_equal(design.b()[9], 8.737946553207119e-05), "design.b()[9] == 8.737946553207119e-05");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - 8.737946553207119e-05));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -8.068413216912898), "design.a()[1] == -8.068413216912898");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -8.068413216912898));
    static_assert(almost_equal(design.a()[2], 28.977379848494554), "design.a()[2] == 28.977379848494554");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 28.977379848494554));
    static_assert(almost_equal(design.a()[3], -60.797461799474334), "design.a()[3] == -60.797461799474334");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -60.797461799474334));
    static_assert(almost_equal(design.a()[4], 82.1183508917702), "design.a()[4] == 82.1183508917702");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 82.1183508917702));
    static_assert(almost_equal(design.a()[5], -74.04487626357752), "design.a()[5] == -74.04487626357752");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -74.04487626357752));
    static_assert(almost_equal(design.a()[6], 44.56858244753529), "design.a()[6] == 44.56858244753529");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 44.56858244753529));
    static_assert(almost_equal(design.a()[7], -17.26743599314712), "design.a()[7] == -17.26743599314712");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -17.26743599314712));
    static_assert(almost_equal(design.a()[8], 3.907295186998695), "design.a()[8] == 3.907295186998695");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 3.907295186998695));
    static_assert(almost_equal(design.a()[9], -0.3934210343150814), "design.a()[9] == -0.3934210343150814");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.3934210343150814));
    std::cout << "max_deviation(cheby2,lowpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      8.737946553207119e-05, 0.00016125600118212864, 0.00019200074269488422, 0.0003099408178004904,
      0.00047788712852941386, 0.0006879376898277236, 0.0009464072807851102,
      0.0012653567068743599, 0.0016582112743322754, 0.0021377762496341338,
      0.002715545450675153, 0.00340161355872037, 0.004204787424030517, 0.005132681123447301,
      0.006191700534739698, 0.007386896099024695, 0.008721702548794279,
      0.010197602959788318, 0.011813759664398682, 0.013566652035500254,
      0.015449754760683887, 0.017453282453907287, 0.019564018775559383,
      0.021765241434914984, 0.024036748843031586, 0.026354989784841854, 0.02869329413355093,
      0.031022200108446862, 0.0333098716342175, 0.03552259777622624, 0.03762536482972523,
      0.039582490316382335, 0.041358306830715674, 0.04291788237541222, 0.04422776256315414,
      0.04525671890877658, 0.04597648647274233, 0.04636247343503813, 0.04639442486399392,
      0.04605702307130077, 0.04534040756798263, 0.04424059878830727, 0.042759811435880424,
      0.04090664550832951, 0.03869614572853103, 0.036149723182747784, 0.033294936351276394,
      0.030165132311976872, 0.02679895258762277, 0.02323971177519646, 0.01953466061946263,
      0.015734148459152025, 0.011890702875388126, 0.00805804681466965, 0.004290075364588669,
      0.0006398156694825824, -0.0028416058548361815, -0.006105964832795234,
      -0.009108885232761835, -0.011810708402173131, -0.014177264440923279,
      -0.016180527923133264, -0.017799142844242055, -0.01901880491608357,
      -0.01983249286338304, -0.020240544090861373, -0.020250573887771628,
      -0.019877241113148897, -0.019141866960285747, -0.01807191683866055,
      -0.01670035854968474, -0.015064912693492166, -0.013207213563968284,
      -0.011171900618148559, -0.009005661908191326, -0.006756251618361339,
      -0.004471504049734426, -0.0021983660500641197, 1.803098235009931e-05,
      0.002135239748938687, 0.004114288382471307, 0.005920378672185506,
      0.007523477901476047, 0.008898793775738746, 0.010027124853985908,
      0.010895081935076656, 0.011495178911518356, 0.011825794616344837,
      0.011891010080767636, 0.011700328326612372, 0.011268286279184178,
      0.010613970552252605, 0.009760450685272745, 0.008734144871296257,
      0.007564134279806248, 0.006281442739642089, 0.004918298801065979,
      0.0035073970504332433, 0.0020811750226541956, 0.0006711211709391068,
      -0.0006928718569913081, -0.001983095882680714, -0.0031745467835178898,
      -0.004245365913423511, -0.005177196338171923, -0.005955449023078659,
      -0.006569476303065876, -0.007012652140717571, -0.007282360787397094,
      -0.007379897459738688, -0.007310286487082901, -0.007082024038074335,
      -0.006706753965837468, -0.00619888649632986, -0.005575170405686405,
      -0.004854229978423594, -0.0040560784048401105, -0.0032016193649997277,
      -0.0023121483667742776, -0.0014088649708662443, -0.000512406366117114,
      0.0003575881220385423, 0.0011828730702829987, 0.0019469462382962974,
      0.0026353451195962746, 0.0032358862061564464, 0.0037388438745299506,
      0.004137067277920889, 0.004426035084173399, 0.004603849301827438,
      0.004671170755536962, 0.004631099981642982, 0.004489008391471622,
      0.004252325474849952, 0.003930288574476366, 0.003533662342606596,
      0.0030744353889274392, 0.002565501840800878, 0.00202033556685215,
      0.0014526646687641129, 0.0008761535344676465, 0.00030409928236260157,
      -0.0002508511726634294, -0.000776957915861225, -0.0012636139870466296,
      -0.0017015366720381005, -0.0020829212447850062, -0.00240155523561077,
      -0.0026528922671927822, -0.0028340854485554914, -0.002943981227756399,
      -0.002983075457094732, -0.002953434203634177, -0.0028585825280350897,
      -0.0027033650441684667, -0.002493782551528486, -0.0022368093957272836,
      -0.0019401964558861673, -0.0016122647809198101, -0.0012616949016764235,
      -0.0008973167373634815, -0.0005279047997423601, -0.00016198308641722503,
      0.00019235634380635911, 0.0005276175925439555, 0.0008370449515231271,
      0.00111474432901485, 0.0013557802699143955, 0.0015562473902912492,
      0.001713315672095173, 0.0018252496753955114, 0.0018914023107868636,
      0.0019121843613011894, 0.0018890114405772408, 0.0018242305129603544,
      0.0017210284741447403, 0.0015833255922294998, 0.001415656834793888,
      0.0012230442558246579, 0.0010108636868971857, 0.0007847089715296383,
      0.0005502569033526998, 0.00031313588243173616, 7.880109584770508e-05,
      -0.00014758123426282998, -0.0003612383014052747, -0.0005578819773513553,
      -0.000733785375090442, -0.0008858435943108617, -0.0010116179343599438,
      -0.0011093632618677605, -0.001178038612895482, -0.0012173014841235872,
      -0.0012274866165223886, -0.0012095703913406301, -0.0011651222363155515,
      -0.0010962446750618481, -0.0010055038411134875, -0.0008958524177428602,
      -0.000770547054336281, -0.0006330623498079719, -0.000487003484455858,
      -0.000336019526023355, -0.00018371933671180183, -3.359186951538192e-05,
      0.00011106753072748319, 0.0002472234084227302, 0.0003721578730564879,
      0.000483518725572923, 0.000579357345507037, 0.0006581559085314485,
      0.000718843762490682, 0.0007608030415938187, 0.0007838638378241105,
      0.0007882894709083993, 0.0007747525990643355, 0.0007443030885649219,
      0.0006983287079992189, 0.0006385098307889374, 0.0005667694156371861,
      0.0004852195885021206, 0.0003961061715215099, 0.00030175249490002696,
      0.0002045037886152924, 0.00010667338401578862, 1.049186362377867e-05,
      -8.193981617697324e-05, -0.00016869233692698438, -0.00024804441841137954,
      -0.00031851301902712957, -0.0003788769119131498, -0.00042819337953186286,
      -0.0004658079352518642, -0.0004913571415358134, -0.0005047647471520941,
      -0.0005062315072976633, -0.0004962191779218951, -0.0004754292865861015,
      -0.0004447773750536339, -0.00040536348213969856, -0.0003584396883128996,
      -0.000305375575781198, -0.0002476224694445291, -0.00018667731574485745,
      -0.00012404702910875681, -6.121409076058565e-05, 3.958760726866569e-07,
      5.944390511444687e-05, 0.00011470429682849102, 0.00016508757099315517,
      0.0002096593958847545, 0.00024765523381260843, 0.0002784905501474807,
      0.00030176653938346603, 0.0003172714248118268, 0.00032497748587911575,
      0.0003250340572817814, 0.0003177568245970675, 0.0003036138113265206,
      0.000283208510495262, 0.00025726065958233237, 0.00022658519004903777,
      0.00019206990189481123, 0.00015465241962360726, 0.00011529697916120305,
      7.49715763094321e-05, 3.462597718661346e-05, -4.8289490727209815e-06,
      -4.254016397914569e-05, -7.772930447781917e-05, -0.00010970714546639285,
      -0.00013788545253090514, -0.00016178606568039333, -0.00018104712391416532,
      -0.00019542640868178986, -0.0002048018501902599, -0.00020916930268575725,
      -0.00020863775204080898, -0.00020342217012699407, -0.00019383427464583292,
      -0.00018027148961748726, -0.00016320443008209723, -0.0001431632544509631,
      -0.0001207232392569041, -9.648993389490895e-05, -7.108424760245938e-05,
      -4.512780786319404e-05, -1.9228909242597432e-05, 6.0306548702472715e-06,
      3.0107617173117694e-05, 5.250789415129218e-05, 7.279569281991695e-05,
      9.060092535590099e-05, 0.00010562483448240962, 0.0001176437768517154,
      0.0001265111554059526, 0.00013215753382063607, 0.00013458900576910726,
      0.00013388392809663774, 0.00013018815937683708, 0.00012370897317416597,
      0.00011470783821433228, 0.00010349227525915689, 9.040701261615641e-05,
      7.582466883817489e-05, 6.0136192363696933e-05, 4.374128381199222e-05,
      2.7039017686780178e-05, 1.0418866763782297e-05, -5.747685067452796e-06,
      -2.1114776707036505e-05, -3.536890951152312e-05, -4.823467775353507e-05,
      -5.947940243092152e-05, -6.891660934117005e-05, -7.640832085357085e-05,
      -8.186615883640084e-05, -8.525128311740859e-05, -8.65732151116357e-05,
      -8.588761934043277e-05, -8.329313605833779e-05, -7.892737574564327e-05,
      -7.296220054061643e-05, -6.559842858715615e-05, -5.706010465672865e-05,
      -4.758848424697812e-05, -3.743587872340843e-05, -2.685950609092986e-05,
      -1.6115485864599832e-05, -5.45310752155087e-06, 4.890509519484454e-06,
      1.4695260162697796e-05, 2.376231341610426e-05, 3.191771582095287e-05,
      3.9015284444124116e-05, 4.49387536135366e-05, 4.9603157893318164e-05,
      5.2955451748142404e-05, 5.497438354483202e-05, 5.566965762738793e-05,
      5.5080432862148734e-05, 5.327321901127895e-05, 5.03392433332587e-05,
      4.63913687590648e-05, 4.156065173702492e-05, 3.599263231715582e-05,
      2.9843451250063783e-05, 2.327588885066959e-05, 1.6455418216034602e-05,
      9.546361226658265e-06, 2.7082297784398888e-06, -3.90767290151679e-06,
      -1.0161324969855922e-05, -1.5926676909624974e-05, -2.1093915820897575e-05,
      -2.5571269662687392e-05, -2.9286329810072757e-05, -3.2186882051812523e-05,
      -3.424124765053627e-05, -3.543814707147462e-05, -3.578610923015617e-05,
      -3.531245841409484e-05, -3.406191922729145e-05, -3.20948868505763e-05,
      -2.9485415500565804e-05, -2.6318982135329147e-05, -2.269008516082334e-05,
      -1.86997391381845e-05, -1.4452926310441414e-05, -1.0056064221385601e-05,
      -5.614545880583551e-06, -1.2304049531702873e-06, 2.999846541292333e-06,
      6.987166395101757e-06, 1.0651681172736025e-05, 1.392410796827909e-05,
      1.674687837560426e-05, 1.9074951656742044e-05, 2.087631164356056e-05,
      2.213214926805756e-05, 2.283673962903896e-05, 2.299702902397075e-05,
      2.2631953277612752e-05, 2.17715138761415e-05, 2.0455642780138665e-05,
      1.8732890277270778e-05, 1.6658972803397124e-05, 1.429521928939144e-05,
      1.1706955282334992e-05, 8.961863867168349e-06, 6.128361321262779e-06,
      3.2740235304474027e-06, 4.640965573216316e-07, -2.2398785289070033e-06,
      -4.781300276594831e-06, -7.109578904563097e-06, -9.18102833797121e-06,
      -1.095956556470038e-05, -1.2417209520516943e-05, -1.3534376555964317e-05,
      -1.4299974248362858e-05, -1.4711299797791208e-05, -1.477375339526458e-05,
      -1.4500380694435123e-05, -1.3911261787417708e-05, -1.303276682668076e-05,
      -1.1896700608375605e-05, -1.0539360012513956e-05, -9.00052917098763e-06,
      -7.322437608595338e-06, -5.548706391476524e-06, -3.7233065506404406e-06,
      -1.8895527659479723e-06, -8.915354824136922e-08, 1.6386629969768764e-06,
      3.257931236400346e-06, 4.7366240846469945e-06, 6.047212230601364e-06,
      7.167098741659103e-06, 8.078924406191411e-06, 8.770742282422647e-06,
      9.236062935577056e-06, 9.473774700527167e-06, 9.487945946418444e-06,
      9.287518692276272e-06, 8.88590498595745e-06, 8.300499179257308e-06,
      7.5521205849258724e-06, 6.664401971491658e-06, 5.663139933116713e-06,
      4.575623367208705e-06, 3.429956113770483e-06, 2.254389277012259e-06,
      1.0766778883153e-06, -7.652458676193415e-08, -1.1802218077991317e-06,
      -2.211569722719908e-06, -3.150302668236081e-06, -3.979083657741518e-06,
      -4.683774096559845e-06, -5.253620179076448e-06, -5.681355215369097e-06,
      -5.963219062429462e-06, -6.098897656181444e-06, -6.091387318581294e-06,
      -5.946790017203986e-06, -5.674047056224755e-06, -5.28461975659017e-06,
      -4.792126524327891e-06, -4.211946300244576e-06, -3.5607987285297745e-06,
      -2.856311478613946e-06, -2.1165850120886357e-06, -1.3597647177190987e-06,
      -6.036297602557379e-07, 1.3479277545666226e-07, 8.395807896832895e-07,
      1.4962305273445743e-06, 2.091924962167881e-06, 2.6157530151452856e-06,
      3.0588766995963357e-06, 3.414644580180096e-06, 3.6786512109655005e-06,
      3.848743450047602e-06, 3.924975709272463e-06, 3.909517264170007e-06,
      3.8065157010521713e-06, 3.621921398694184e-06, 3.3632786180174495e-06,
      3.0394892954705337e-06, 2.6605559989485298e-06, 2.237310707502745e-06,
      1.781136119865981e-06, 1.3036860875389518e-06, 8.166115146568037e-07,
      3.3129768077625377e-07, -1.4138156170616667e-07, -5.912878702943855e-07,
      -1.0092166207421713e-06, -1.3870658422184712e-06, -1.7179732816031597e-06,
      -1.9964198257377414e-06, -2.2182983426727793e-06, -2.380947821870124e-06,
      -2.4831534810129023e-06, -2.525114247075898e-06, -2.5083796968979807e-06,
      -2.4357591449786225e-06, -2.3112060831144665e-06, -2.1396815996863236e-06,
      -1.9270007302383223e-06, -1.6796659122716665e-06, -1.4046918351631618e-06,
      -1.1094259924316245e-06, -8.013691620580491e-07, -4.879998671099735e-07,
      -1.766066112485115e-07, 1.2586864889065527e-07, 4.129727293476835e-07,
      6.788665270149592e-07, 9.184312847917327e-07, 1.1273542057712745e-06,
      1.3021923409407416e-06, 1.4404142095000865e-06, 1.5404191355824937e-06,
      1.601534788462543e-06, 1.623993884802481e-06, 1.6088914417963996e-06,
      1.5581243512257608e-06, 1.474315369876855e-06, 1.3607238864592426e-06,
      1.2211460256506056e-06, 1.0598067843154914e-06, 8.81246963008314e-07,
      6.902076587888107e-07, 4.915150257842094e-07, 2.899678917608146e-07,
      9.023064731103632e-08, -1.0326639479205193e-07, -2.8641723206697676e-07,
      -4.5551935112419464e-07, -6.073405247996556e-07, -7.391722339303852e-07,
      -8.48869062947543e-07, -9.348737618036083e-07, -9.96228002801961e-07,
      -1.0325691823811516e-06, -1.0441139181747172e-06, -1.0316291648266075e-06,
      -9.963921130538831e-07, -9.401402412080214e-07, -8.650130539772676e-07,
      -7.734871667955559e-07, -6.68306475901431e-07, -5.524091927502877e-07,
      -4.288535185165846e-07, -3.0074369152519063e-07, -1.7115806024467696e-07,
      -4.308072031510346e-08, 8.066189004954969e-08, 1.9745821155582063e-07,
      3.0496156770309375e-07, 4.011321221783772e-07, 4.842701767564089e-07,
      5.530404174110278e-07, 6.06486936770507e-07, 6.440390762203022e-07,
      6.655083362357788e-07, 6.71076794694449e-07, 6.612776462448039e-07,
      6.369686281264681e-07, 5.992992265789274e-07, 5.496726612163024e-07,
      4.897037212114652e-07, 4.2117357620874974e-07, 3.4598270659844265e-07,
      2.661030927820313e-07, 1.8353077255470223e-07, 1.0023982147526409e-07,
      1.8138735291499605e-08, -6.096990125659315e-08, -1.3542568570017713e-07,
      -2.0374195924219796e-07, -2.6463214152985023e-07, -3.170304613364766e-07,
      -3.601068477360082e-07, -3.9327588782348204e-07, -4.1619989476330307e-07,
      -4.2878626098119085e-07, -4.3117939297787115e-07, -4.2374763417663354e-07,
      -4.070656784290964e-07, -3.8189305769223366e-07, -3.4914935176527876e-07,
      -3.098868150696349e-07, -2.6526114492209944e-07, -2.1650112765721067e-07,
      -1.6487789375742455e-07, -1.116744916759338e-07, -5.815645344500002e-08,
      -5.5439749044266274e-09, 4.5013728839893434e-08, 9.246140440923124e-08,
      1.3585766959015614e-07, 1.743915293974601e-07, 2.0739526681675882e-07,
      2.3435356766474177e-07, 2.549088297725047e-07, 2.688626948273806e-07,
      2.7617392482259336e-07, 2.769528224629914e-07, 2.714524645707577e-07,
      2.600570782744334e-07, 2.4326794054885747e-07, 2.2168722176967983e-07,
      1.960002228923658e-07, 1.669564734711187e-07, 1.353501640706532e-07,
      1.0200038201715998e-07, 6.773160444145195e-08, 3.335487795571021e-08,
      -3.499189709050507e-10, -3.2650375703676964e-08, -6.287610311884991e-08,
      -9.043128533100968e-08, -1.1480502929711351e-07, -1.3557937008790004e-07,
      -1.5243484838845482e-07, -1.651536350078111e-07, -1.7362023355236198e-07,
      -1.7781984575431853e-07, -1.7783453316728967e-07, -1.7383735310657052e-07,
      -1.6608468503515315e-07, -1.549069954554391e-07, -1.4069831431035394e-07,
      -1.239047136499174e-07, -1.0501208977783096e-07, -8.453355332360349e-08,
      -6.299672791571573e-08, -4.0931247735428475e-08, -1.885672771808053e-08,
      2.7285418350054236e-09, 2.3357951241768777e-08, 4.260578376623687e-08,
      6.009512387620831e-08, 7.550433708191562e-08, 8.857203437742303e-08,
      9.91004720916722e-08, 1.0695737528534746e-07, 1.1207620887997813e-07,
      1.1445495471676563e-07, 1.141534840318471e-07, 1.1128964280909223e-07,
      1.0603419163741925e-07, 9.860476166971487e-08, 8.925900377814035e-08,
      7.828711886163402e-08, 6.600396343289986e-08, 5.274092614919549e-08,
      3.883776801114621e-08, 2.463461178842581e-08, 1.0464255177144082e-08,
      -3.355032338387177e-09, -1.6526086485278546e-08, -2.8778676653404973e-08,
      -3.9874485344787503e-08, -4.9611161479503454e-08, -5.78253945029318e-08,
      -6.439498052424142e-08, -6.923987564390007e-08, -7.23222546737015e-08,
      -7.36456151331034e-08, -7.325298628808875e-08, -7.12243207093258e-08,
      -6.767316105560989e-08, -6.274268729571773e-08, -5.6601259197558184e-08,
      -4.9437575540763716e-08, -4.145557512196776e-08, -3.2869205264339055e-08,
      -2.389718132309038e-08, -1.4757855765301927e-08, -5.664308017923213e-09,
      3.1802433088117028e-09, 1.1586615696626236e-08, 1.938334840567833e-08,
      2.6419835721944344e-08, 3.256885998006818e-08, 3.772849209481114e-08,
      4.182334293766927e-08, 4.480516422804183e-08, 4.665281233590012e-08,
      4.737160220809934e-08, 4.6992091259481755e-08, 4.556834427702136e-08,
      4.3175739976581814e-08, 3.9908387678001134e-08, 3.587622852178723e-08,
      3.120189968274468e-08, 2.6017442131187195e-08, 2.046093268399957e-08,
      1.4673119450251054e-08, 8.794136422050256e-09, 2.9603680376402842e-09,
      -2.698471773544766e-09, -8.061989064772166e-09, -1.302143935089425e-08,
      -1.74816978061318e-08, -2.1362840626347386e-08, -2.4601317996513915e-08,
      -2.715070912626583e-08, -2.898205963848665e-08, -3.00838110045808e-08,
      -3.046134052030255e-08, -3.013613833448113e-08, -2.9144655131213086e-08,
      -2.7536860102747332e-08, -2.5374553742772106e-08, -2.2729483675173664e-08,
      -1.968131417846164e-08, -1.631550126717689e-08, -1.2721125173163818e-08,
      -8.988730882543866e-09, -5.208225103762937e-09, -1.466874764943724e-09,
      2.1525520198319734e-09, 5.573466485433205e-09, 8.726930740927142e-09,
      1.155289575287572e-08, 1.400118753861189e-08, 1.6032229756883725e-08,
      1.761749731852729e-08, 1.8739701929769347e-08, 1.9392716489513094e-08,
      1.9581250865640516e-08, 1.932029666435881e-08, 1.863436308746216e-08,
      1.7556529769200137e-08, 1.612734553993896e-08, 1.4393604339765756e-08,
      1.2407030982579172e-08, 1.0222910149794047e-08, 7.898691890353363e-09,
      5.492606054956671e-09, 3.0623165473487525e-09, 6.636440978639906e-10,
      -1.6506164704806912e-09, -3.831761720431481e-09, -5.8361086485051945e-09,
      -7.62577199937694e-09, -9.169278600026702e-09, -1.0442011609194085e-08,
      -1.1426481708492659e-08, -1.2112426288265435e-08, -1.249674151740532e-08,
      -1.2583255753286715e-08, -1.2382355976355107e-08, -1.191048176500591e-08,
      -1.118950371275515e-08, -1.024600509596067e-08, -9.110487003387324e-09,
      -7.816518027925904e-09, -6.399849997016713e-09, -4.897521094553717e-09,
      -3.3469671267624406e-09, -1.7851606410369967e-09, -2.4779616188952885e-10,
      1.2314619887735118e-09, 2.6216549137591174e-09, 3.895115363166597e-09,
      5.027955421926956e-09, 6.000448744434154e-09, 6.797303083628521e-09,
      7.407821512619689e-09, 7.82595331397216e-09, 8.05023796004646e-09,
      8.08364787740404e-09, 7.933337735452834e-09, 7.610309787273194e-09,
      7.12900628934294e-09, 6.506841214842561e-09, 5.763684338448402e-09,
      4.921311302996534e-09, 4.002833481815881e-09, 3.0321213339313566e-09,
      2.0332345286148932e-09, 1.0298714130045882e-09, 4.484943925646957e-11,
      -9.003730119240928e-10, -1.7861243406830952e-09, -2.594889413818564e-09,
      -3.3116152923171216e-09, -3.923948754496754e-09, -4.4224030829778e-09,
      -4.800453284134488e-09, -5.054560557409877e-09, -5.184128393860821e-09,
      -5.191394126898357e-09, -5.081261055745678e-09, -4.861077390433452e-09,
      -4.540369207753321e-09, -4.130535347055246e-09, -3.6445127047568104e-09,
      -3.0964207036577167e-09, -2.5011938192799978e-09, -1.8742109468361543e-09,
      -1.230930099770979e-09, -5.865364587686431e-10, 4.438884325470703e-11,
      6.481725883710078e-10, 1.212320272069742e-09, 1.7257490948285275e-09,
      2.178979457839333e-09, 2.5642823627315426e-09, 2.8757812174973798e-09,
      3.109507641301096e-09, 3.2634119153364792e-09, 3.3373297230937937e-09,
      3.3329077412518507e-09, 3.253491464466047e-09, 3.103979359005699e-09,
      2.890648030023959e-09, 2.620953546965344e-09, 2.303314396250498e-09,
      1.9468817181995992e-09, 1.561302537596585e-09, 1.1564816187824115e-09,
      7.423473738934743e-10, 3.286269365211227e-10, -7.536490547864917e-11,
      -4.609187313743514e-10, -8.20101856999663e-10, -1.1459050838914156e-09,
      -1.4323625380935372e-09, -1.6746430104685898e-09, -1.869111918974414e-09,
      -2.0133637124591678e-09, -2.1062252097292436e-09, -2.1477310027752314e-09,
      -2.139072636393962e-09, -2.082523797006741e-09, -1.9813441921048326e-09,
      -1.8396651713139035e-09, -1.662360425499741e-09, -1.4549052986854976e-09,
      -1.2232283579500507e-09, -9.735588900814586e-10, -7.12273933632581e-10,
      -4.4574831599302544e-10, -1.802109535579582e-10, 7.838960318480154e-11,
      3.2450772989958324e-10, 5.531091223111337e-10, 7.597631657648023e-10,
      9.40717860854997e-10, 1.0929563378216618e-09, 1.2142344477775936e-09,
      1.3030993668733459e-09, 1.3588895804283346e-09, 1.3817170188460442e-09,
      1.372432487740172e-09, 1.3325758641838156e-09, 1.2643128136272888e-09,
      1.170360013377895e-09, 1.0539010455035187e-09, 9.184952428725141e-10,
      7.679818363742134e-10, 6.063817600680684e-10, 4.3779942619339715e-10,
      2.663266868642379e-10, 9.595105810380594e-11, -6.952990026676568e-11,
      -2.2658637267454086e-10, -3.7202481367427594e-10, -5.030460497300225e-10,
      -6.172920782356856e-10, -7.128809764624669e-10, -7.884296256485214e-10,
      -8.430642425028323e-10, -8.76418985733062e-10, -8.886231631009299e-10,
      -8.802777998641442e-10, -8.524225379061784e-10, -8.064940127976548e-10,
      -7.442770007257208e-10, -6.67849736784481e-10, -5.795248795248487e-10,
      -4.817876337581746e-10, -3.772325450622772e-10, -2.6850044669497483e-10,
      -1.5821697483432127e-10, -4.8933974025393656e-11, 5.6925005246161256e-11,
      1.571140570337863e-10, 2.4960821876099476e-10, 3.326399924797646e-10,
      4.047285455845273e-10, 4.647012356293472e-10, 5.117072917572809e-10,
      5.452236691068318e-10, 5.650532684297396e-10, 5.713158774010431e-10,
      5.644323395032011e-10, 5.451025881662339e-10, 5.142782958016728e-10,
      4.731309777764817e-10, 4.2301645908753376e-10, 3.6543665593054926e-10,
      3.019996454719644e-10, 2.343789954178825e-10, 1.6427330141556091e-10,
      9.336683635626159e-11, 2.3292153110981504e-11, -4.4404596697400744e-11,
      -1.0829495814127115e-10, -1.6709551702919858e-10, -2.196908394783821e-10,
      -2.65151672075304e-10, -3.0274818846134027e-10, -3.3195818878672225e-10,
      -3.5247027619621877e-10, -3.641821468075102e-10, -3.6719423421011303e-10,
      -3.617990443105585e-10, -3.4846659964480977e-10, -3.27826482669374e-10,
      -3.0064702397515556e-10, -2.678122231481949e-10, -2.3029701679373491e-10,
      -1.891415200611855e-10, -1.4542486521116697e-10, -1.0023924402059924e-10,
      -5.4664731083400504e-11, -9.745423541883996e-12, 3.353261909778485e-11,
      7.426121205423178e-11, 1.1162730392233064e-10, 1.449273744281558e-10,
      1.735787650616445e-10, 1.971278140878851e-10, 2.152547448427389e-10,
      2.2777533156877232e-10, 2.3463943872873126e-10, 2.3592659628119137e-10,
      2.3183883352822709e-10, 2.2269104675784047e-10, 2.0889922012898932e-10,
      1.909668544343174e-10, 1.6946998410589145e-10, 1.4504117891383682e-10,
      1.1835293328356368e-10, 9.010084327632876e-11, 6.098695949283242e-11,
      3.1703684105142965e-11, 2.9185526934347283e-12, -2.4739792508555707e-11,
      -5.069417093214518e-11, -7.442975048924662e-11, -9.550307698795105e-11,
      -1.135491194347273e-10, -1.2828625451369436e-10, -1.3951916319582298e-10,
      -1.4713966064580586e-10, -1.5112552633412972e-10, -1.5153744359742508e-10,
      -1.4851419600757703e-10, -1.4226630112433349e-10, -1.3306828997120736e-10,
      -1.2124986248983905e-10, -1.0718616504169765e-10, -9.128744563415998e-11,
      -7.398834599099654e-11, -5.5737087042892195e-11, -3.698479618729216e-11,
      -1.817521117955867e-11, 2.6502270865826947e-13, 1.7935267985344114e-11,
      3.446885422312111e-11, 4.953994141182309e-11, 6.286917797432301e-11,
      7.422807576183517e-11, 8.344205650346552e-11, 9.039215603782342e-11,
      9.501540349621444e-11, 9.730392178353784e-11, 9.730282262539125e-11,
      9.510699360416999e-11, 9.085689556299645e-11, 8.473350617395042e-11,
      7.695255910002021e-11, 6.775823787775678e-11, 5.741648935410064e-11,
      4.620812326290444e-11, 3.442186244861026e-11, 2.2347502541924016e-11,
      1.0269330843958208e-11, -1.5400578760930713e-12, -1.2825425622873166e-11,
      -2.335392923583969e-11, -3.2919444573881433e-11, -4.134610886381817e-11,
      -4.8491033703913926e-11, -5.424616188872336e-11, -5.853926164543486e-11,
      -6.133407159410491e-11, -6.262962834900708e-11, -6.245882579238924e-11,
      -6.088627035098123e-11, -5.80055098197334e-11, -5.3935724194817226e-11,
      -4.8817975447775994e-11, -4.2811119105241684e-11, -3.608748386514381e-11,
      -2.882842631120613e-11, -2.121986616907178e-11, -1.3447903617603497e-11,
      -5.6946141121771646e-12, 1.8658917821376317e-12, 9.07106565240253e-12,
      1.577310866147163e-11, 2.1841694217839366e-11, 2.7166183734322993e-11,
      3.165730649883391e-11, 3.524828796860669e-11, 3.789542389069443e-11,
      3.957811025916105e-11, 4.0298350978871265e-11, 4.0079775980590626e-11,
      3.8966212217763445e-11, 3.701985830263359e-11, 3.4319120376759624e-11,
      3.0956172065956076e-11, 2.7034304989296703e-11, 2.266513826215451e-11,
      1.7965755778216563e-11, 1.3055838834560763e-11, 8.054858969627977e-12,
      3.079391838084179e-12, -1.7593923035996933e-12, -6.358012213196485e-12,
      -1.0622691230212572e-11, -1.4471070437124668e-11, -1.7833593301283663e-11
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      8.737946553207119e-05, 0.0001612560011821286, 0.000192000742694884, 0.0003099408178004899,
      0.0004778871285294171, 0.0006879376898277585, 0.0009464072807852859,
      0.0012653567068750004, 0.001658211274334191, 0.0021377762496391033,
      0.002715545450686724, 0.003401613558745114, 0.004204787424079932,
      0.005132681123540591, 0.006191700534907752, 0.007386896099315636,
      0.008721702549281007, 0.010197602960578546, 0.01181375966564787, 0.013566652037427823,
      0.01544975476359309, 0.017453282458209308, 0.019564018781802476, 0.02176524144381969,
      0.02403674885553319, 0.026354989802141206, 0.028693294157174632, 0.03102220014031749,
      0.03330987167673434, 0.03552259783235673, 0.03762536490310652, 0.039582490411431526,
      0.04135830695274706, 0.04291788253075984, 0.044227762759297976, 0.04525671915447102,
      0.045976486778145566, 0.0463624738118409, 0.046394425325545705, 0.046057023632731155,
      0.04534040824631508, 0.04424059960256195, 0.04275981240716237, 0.04090664665989745,
      0.03869614708584086, 0.03614972477346357, 0.033294938205241015, 0.030165134461134866,
      0.02679895506588864, 0.023239714618262575, 0.019534663864541987, 0.015734152144652194,
      0.011890707040513374, 0.008058051498949007, 0.004290080607328628,
      0.0006398215091445373, -0.002841599381331792, -0.006105957690833875,
      -0.009108877390862075, -0.01181069983286643, -0.014177255121673712,
      -0.016180517837281697, -0.0177991319819565, -0.01901879327529501,
      -0.019832480450683625, -0.020240530922340166, -0.020250559989761684,
      -0.01987722652285908, -0.01914185172629096, -0.018071901021225308,
      -0.01670034222089721, -0.015064895937188537, -0.013207196475431063,
      -0.011171883303566776, -0.009005644483875273, -0.006756234209709624,
      -0.004471486789956525, -0.002198349078667375, 1.8047521294103802e-05,
      0.002135255708727263, 0.004114303615876232, 0.005920393033698314,
      0.007523491249655256, 0.008898805975616837, 0.010027135779490385,
      0.010895091471416906, 0.011495186957488308, 0.011825801086490836,
      0.011891014907371478, 0.01170033146144132, 0.01126828769496268, 0.010613970243814531,
      0.009760448670358149, 0.008734141190962757, 0.007564128998432275,
      0.006281435944507187, 0.004918290601502068, 0.0035073875765500822,
      0.002081164423651923, 0.0006711096130303201, -0.0006928841930182152,
      -0.0019831088042165618, -0.0031745600891578637, -0.004245379396207476,
      -0.0051772097889793735, -0.005955462234113549, -0.006569489071363794,
      -0.007012664271606364, -0.007282372097842197, -0.007379907781506076,
      -0.007310295669655834, -0.007082031951264743, -0.006706760502038729,
      -0.006198891572364692, -0.0055751739642114165, -0.004854231988860603,
      -0.004056078863813504, -0.0032016182962687372, -0.0023121458206590575,
      -0.001408861023176769, -0.0005124011166041328, 0.0003575945516813658,
      0.0011828805388272477, 0.0019469545877501644, 0.0026353541782844193,
      0.0032358957920471955, 0.003738853798743554, 0.0041370773483488015,
      0.004426045109136315, 0.004603859093699052, 0.004671180134261211,
      0.004631108778074758, 0.0044890164504746794, 0.004252332658090972,
      0.003930294762860686, 0.003533667438308875, 0.0030744393169792545,
      0.002565504550206824, 0.002020337031216136, 0.0014526648864179603,
      0.0008761525281045739, 0.00030409709818849707, -0.0002508544662380781,
      -0.0007769622299564963, -0.0012636192144345948, -0.001701542689602073,
      -0.0020829279162616903, -0.0024015624145551414, -0.0026528998001016245,
      -0.0028340931780830364, -0.002943988995954496, -0.0029830831086104176,
      -0.002953441588799357, -0.002858589505786216, -0.002703371484738491,
      -0.002493788338858934, -0.002236814429554906, -0.0019402006534661243,
      -0.001612268078355567, -0.0012616972548352796, -0.0008973181223657137,
      -0.0005279052130211737, -0.00016198254435583774, 0.0001923578056452901,
      0.0005276199205729335, 0.000837048075637023, 0.0011147481644123041,
      0.0013557847191889472, 0.0015562523457427328, 0.0017133210182080747,
      0.0018252552914283559, 0.0018914080734153435, 0.0019121901472576744,
      0.0018890171292304885, 0.00182423598878167, 0.0017210336290103883,
      0.0015833303275137676, 0.0014156610632127169, 0.0012230479029960379,
      0.0010108666925913745, 0.0007847112905895286, 0.0005502585062721824,
      0.0003131367555875139, 7.880124138755249e-05, -0.00014758179886504013,
      -0.00036123954411050965, -0.0005578838526086294, -0.0007337878251528229,
      -0.0008858465507797917, -0.0010116213199192411, -0.001109366992165437,
      -0.0011780425985292715, -0.0012173056326848454, -0.0012274908346528149,
      -0.0012095745867570665, -0.0011651263197598742, -0.001096248562135629,
      -0.0010055074539605756, -0.0008958556865472308, -0.0007705499186073087,
      -0.0006330647594305998, -0.00048700540048882406, -0.0003360209212345581,
      -0.00018372019584592678, -3.3592189294893406e-05, 0.00011106774186105043,
      0.0002472241308147435, 0.0003721590765749081, 0.00048352037055158847,
      0.0005793593838704365, 0.0006581582850715761, 0.0007188464162640039,
      0.0007608059074045838, 0.0007838668477592247, 0.000788292555888874,
      0.0007747556903788921, 0.0007443061193526506, 0.0006983316146502134,
      0.000638512554234471, 0.0005667719025042167, 0.00048522179211059433,
      0.0003961080527070066, 0.00030175402264863714, 0.0002045049405021261,
      0.00010667414644309679, 1.0492231859198623e-05, -8.193983815714932e-05,
      -0.00016869273678046668, -0.00024804517594557957, -0.0003185141068715784,
      -0.0003788782963293344, -0.0004281950213387125, -0.00046580979084320627,
      -0.0004913591639647799, -0.0005047668872567106, -0.0005062337148416937,
      -0.0004962214027254303, -0.0004754314796213565, -0.0004447794894829016,
      -0.00040536547427435783, -0.0003584415184747261, -0.00030537720904992566,
      -0.00024762387627858033, -0.00018667847246533345, -0.0001240479182400824,
      -6.121470122455554e-05, 3.955489093794544e-07, 5.944385953588051e-05,
      0.00011470452500198986, 0.00016508805932933642, 0.00020966012551335936,
      0.0002476561811601152, 0.00027849168760066164, 0.00030176783602162144,
      0.0003172728471894301, 0.00032497899884004303, 0.0003250356247861733,
      0.0003177584105421663, 0.0003036153803435236, 0.000283210028705304,
      0.0002572620952961284, 0.00022658651439643701, 0.00019207108937249268,
      0.00015465344855132758, 0.00011529783203933755, 7.497224007296785e-05,
      3.462644335320474e-05, -4.828684360598522e-06, -4.2540100015558006e-05,
      -7.772943615364808e-05, -0.00010970746352186565, -0.00013788594389188663,
      -0.00016178671386835817, -0.0001810479095184523, -0.0001954273098817202,
      -0.0002048028433139881, -0.0002091703627923242, -0.0002086388535117795,
      -0.00020342328725427985, -0.0001938353822028065, -0.00018027256340126928,
      -0.00016320544741591764, -0.0001431641946367324, -0.00012072408396954764,
      -9.649066751157919e-05, -7.108485746140746e-05, -4.5128284448808954e-05,
      -1.922924629486938e-05, 6.030460321854254e-06, 3.010756484972437e-05,
      5.250798063534975e-05, 7.279591173193223e-05, 9.060126759112045e-05,
      0.00010562528850030239, 0.00011764432901015111, 0.00012651179033123554,
      0.00013215823480404115, 0.00013458975518027222, 0.00013388470780409663,
      0.0001301889511661288, 0.000123709759154308, 0.0001147086012040011,
      0.00010349299914464373, 9.04076826740484e-05, 7.582527201672167e-05,
      6.0136717517935e-05, 4.37417218888847e-05, 2.7039361857861024e-05,
      1.041911250404284e-05, -5.7475399544577e-06, -2.1114732116683695e-05,
      -3.5368963115900384e-05, -4.823482512613677e-05, -5.947963721395203e-05,
      -6.891692345033291e-05, -7.64087047145495e-05, -8.186660164671746e-05,
      -8.525177312698634e-05, -8.657373991519111e-05, -8.588816617478674e-05,
      -8.329369209785147e-05, -7.892792838925119e-05, -7.296273768433332e-05,
      -6.559893887646208e-05, -5.7060577713874236e-05, -4.758891086897725e-05,
      -3.743625104728166e-05, -2.685981772360697e-05, -1.61157319757645e-05,
      -5.453284898594316e-06, 4.89040245436148e-06, 1.4695223372352505e-05,
      2.3762345303611317e-05, 3.1917813317647076e-05, 3.901544312746407e-05,
      4.493896785116396e-05, 4.960342100922352e-05, 5.295575620649189e-05,
      5.497472114676336e-05, 5.567001971595188e-05, 5.508081053055145e-05,
      5.3273603309668604e-05, 5.03396254694916e-05, 4.639174028917279e-05,
      4.1561004741479376e-05, 3.599295955947215e-05, 2.9843746314802078e-05,
      2.3276146258447528e-05, 1.645563351376366e-05, 9.546531051829211e-06,
      2.7083518969035954e-06, -3.907599584215696e-06, -1.0161300422945701e-05,
      -1.592670001617251e-05, -2.109398443976368e-05, -2.5571380711209536e-05,
      -2.9286479364924156e-05, -3.218706546516796e-05, -3.424145967843134e-05,
      -3.543838201107955e-05, -3.578636106259802e-05, -3.531272094945279e-05,
      -3.406218624845625e-05, -3.209515225280303e-05, -2.9485673423752973e-05,
      -2.6319227086320173e-05, -2.269031212334017e-05, -1.8699943668360313e-05,
      -1.4453104616309865e-05, -1.0056213225098273e-05, -5.614663262554929e-06,
      -1.2304891777808968e-06, 2.999796218378899e-06, 6.987149937542512e-06,
      1.0651697791182246e-05, 1.3924156163916162e-05, 1.6746955998039712e-05,
      1.907505597445435e-05, 2.0876439424900934e-05, 2.213229687062945e-05,
      2.283690309516671e-05, 2.2997204179911182e-05, 2.2632135834160017e-05,
      2.1771699528325238e-05, 2.045582730381503e-05, 1.8733069620551476e-05,
      1.665914317104832e-05, 1.429537721855689e-05, 1.1707097708189565e-05,
      8.961988177382655e-06, 6.1284653984497736e-06, 3.274105782060411e-06,
      4.6415593277361897e-07, -2.239842533838108e-06, -4.781287627726922e-06,
      -7.10958904902382e-06, -9.181060234810149e-06, -1.0959617725330538e-05,
      -1.2417280057734077e-05, -1.3534463240144848e-05, -1.4300074569329856e-05,
      -1.4711411030764487e-05, -1.4773872669275563e-05, -1.4500505061589358e-05,
      -1.3911388291426211e-05, -1.3032892569153516e-05, -1.1896822811473738e-05,
      -1.053947607668786e-05, -9.000636726683096e-06, -7.3225345609841275e-06,
      -5.5487909574572574e-06, -3.7233772875553505e-06, -1.8896085916660627e-06,
      -8.919375246422116e-08, 1.6386387501287476e-06, 3.257922914269308e-06,
      4.736631299956097e-06, 6.047234262811033e-06, 7.167134565019907e-06,
      8.078972723626152e-06, 8.770801564271022e-06, 9.236131462161343e-06,
      9.47385060744862e-06, 9.488027271471598e-06, 9.287603422871794e-06,
      8.88599110597239e-06, 8.300584714283128e-06, 7.55220364495756e-06,
      6.664480790192981e-06, 5.6632129029046615e-06, 4.575689069521162e-06,
      3.4300133440120367e-06, 2.2544370638105714e-06, 1.0767155068610587e-06,
      -7.649760737772944e-08, -1.1802056831992282e-06, -2.2115644176233533e-06,
      -3.1503079063036857e-06, -3.979098936467166e-06, -4.683798706692454e-06,
      -5.25365322797435e-06, -5.681395653621979e-06, -5.9632657130336736e-06,
      -6.098949245522954e-06, -6.09144250846688e-06, -5.946847437185055e-06,
      -5.674105335478761e-06, -5.284677554660936e-06, -4.792182560076821e-06,
      -4.211999378428074e-06, -3.560847763492366e-06, -2.8563555146695512e-06,
      -2.116623240252061e-06, -1.3597964885437332e-06, -6.036545926295513e-07,
      1.3477518960869276e-07, 8.395705847484201e-07, 1.496227667291814e-06,
      2.0919292475230667e-06, 2.6157640933814512e-06, 3.0588940785828027e-06,
      3.4146676442778082e-06, 3.678679239311506e-06, 3.848775636538876e-06,
      3.925011183738754e-06, 3.909555114217126e-06, 3.806554994060852e-06,
      3.6219612034748193e-06, 3.3633180256468504e-06, 3.039527438872396e-06,
      2.6605920708234298e-06, 2.237343976264873e-06, 1.7811659433010717e-06,
      1.3037119239594864e-06, 8.166329313949887e-07, 3.31314359920973e-07,
      -1.4136982035683143e-07, -5.912811490298291e-07, -1.0092148863893914e-06,
      -1.3870689510937775e-06, -1.7179809867629522e-06, -1.996431786281616e-06,
      -2.2183141348151483e-06, -2.380966951467223e-06, -2.4831753972108343e-06,
      -2.525138356732435e-06, -2.508405379426178e-06, -2.435785767263678e-06,
      -2.3112330141663637e-06, -2.1397082247090663e-06, -1.9270264638213546e-06,
      -1.6796902104395566e-06, -1.4047142060549152e-06, -1.1094460054200894e-06,
      -8.013864551618045e-07, -4.880141525938124e-07, -1.7661767935309508e-07,
      1.2586092810522507e-07, 4.1296840601673807e-07, 6.788655732742432e-07,
      9.184335982664548e-07, 1.1273596146092458e-06, 1.3022006102200476e-06,
      1.4404250488170567e-06, 1.5404322076063118e-06, 1.6015497182289115e-06,
      1.6240102695104584e-06, 1.608908860869854e-06, 1.5581423764036776e-06,
      1.474333575104746e-06, 1.360741857366749e-06, 1.2211633684175832e-06,
      1.0598231337498922e-06, 8.812619896834101e-07, 6.9022107511408e-07,
      4.915265909128264e-07, 2.8997741526643056e-07, 9.023799159668324e-08,
      -1.0326131336023052e-07, -2.8641444327954004e-07, -4.5551883225276373e-07,
      -6.07342203051554e-07, -7.39175989936632e-07, -8.488747351676155e-07,
      -9.348811517140928e-07, -9.962368807234994e-07, -1.0325792937891347e-06,
      -1.0441249903340284e-06, -1.0316409135893622e-06, -9.964042496614287e-07,
      -9.40152478944262e-07, -8.650251145293993e-07, -7.734987861902059e-07,
      -6.6831740989862e-07, -5.524192215941709e-07, -4.2886245096010654e-07,
      -3.0075136806514544e-07, -1.7116435552374152e-07, -4.3085544667721366e-08,
      8.065858991046809e-08, 1.9745645269500016e-07, 3.049613319270778e-07,
      4.01133357756186e-07, 4.842728008299614e-07, 5.530443190155671e-07,
      6.064919803744975e-07, 6.440451056859288e-07, 6.655151790953729e-07,
      6.710842666349378e-07, 6.61285555691601e-07, 6.369767808200158e-07,
      5.993074300412323e-07, 5.496807290110848e-07, 4.897114769097616e-07,
      4.211808569817097e-07, 3.4598936637036417e-07, 2.6610900488908446e-07,
      1.8353583186795946e-07, 1.0024394596026485e-07, 1.814186699030185e-08,
      -6.096779582139984e-08, -1.3542461568699326e-07, -2.0374191019271094e-07,
      -2.646330765761071e-07, -3.1703232286672533e-07, -3.6010955946470096e-07,
      -3.9327935720378256e-07, -4.1620401567503723e-07, -4.287909166234898e-07,
      -4.311844588938008e-07, -4.237529813368553e-07, -4.070711763030009e-07,
      -3.818985772379486e-07, -3.4915476827434334e-07, -3.0989201080780406e-07,
      -2.6526601151450933e-07, -2.1650556817381734e-07, -1.6488182446301159e-07,
      -1.1167784341786133e-07, -5.815917266102398e-08, -5.546024242132597e-09,
      4.5012370291436355e-08, 9.246074126628104e-08, 1.358576906820832e-07,
      1.7439220861054188e-07, 2.0739656424238504e-07, 2.3435543101475895e-07,
      2.549111960198109e-07, 2.6886549202638153e-07, 2.76177074061787e-07,
      2.769562399007675e-07, 2.7145606350546875e-07, 2.6006077120086233e-07,
      2.4327164115531636e-07, 2.2169084683303067e-07, 1.9600369403215672e-07,
      1.669597187286559e-07, 1.3535311928405154e-07, 1.0200299196909636e-07,
      6.773382376234213e-08, 3.3356671771192836e-08, -3.485746531091708e-10,
      -3.264949386639908e-08, -6.287568586066022e-08, -9.043132423158312e-08,
      -1.1480550600545272e-07, -1.3558025711172548e-07, -1.5243611005935991e-07,
      -1.6515522859378376e-07, -1.7362211048703205e-07, -1.778219529508254e-07,
      -1.7783681438397792e-07, -1.7383975033180106e-07, -1.6608713985933107e-07,
      -1.5490945039986056e-07, -1.4070071408460166e-07, -1.239070063122153e-07,
      -1.0501422777592544e-07, -8.453549439728102e-08, -6.299843584590423e-08,
      -4.0932692928859726e-08, -1.8857887620616325e-08, 2.7276824991582525e-09,
      2.3357400403701846e-08, 4.260554211374442e-08, 6.009518511427174e-08,
      7.550468834033884e-08, 8.85726567508337e-08, 9.910134129469045e-08,
      1.0695846240378984e-07, 1.120774811975347e-07, 1.1445637659567698e-07,
      1.1415501782571341e-07, 1.1129124978605829e-07, 1.0603583289257579e-07,
      9.860639900660516e-08, 8.926060054072222e-08, 7.828864069987238e-08,
      6.600537898730037e-08, 5.274220764197627e-08, 3.883889173431733e-08,
      2.463555848173935e-08, 1.0465010291625627e-08, -3.354478492876713e-09,
      -1.6525738707333905e-08, -2.877853492856342e-08, -3.987454502919482e-08,
      -4.961141358060906e-08, -5.782582604719555e-08, -6.439557500026424e-08,
      -6.924061350814055e-08, -7.232311390502682e-08, -7.364657182185323e-08,
      -7.325401524510405e-08, -7.122539608050305e-08, -6.767425692796936e-08,
      -6.274377828169936e-08, -5.6602320985254724e-08, -4.943858539903384e-08,
      -4.1456512350806446e-08, -3.287005158247771e-08, -2.389792118651307e-08,
      -1.4758476612154298e-08, -5.66480043711401e-09, 3.1798854862016245e-09,
      1.1586395382245677e-08, 1.9383265312556243e-08, 2.641988649276718e-08,
      3.2569038379553813e-08, 3.77287892594183e-08, 4.1823747674849135e-08,
      4.480566335642066e-08, 4.6653391057188385e-08, 4.737224450115937e-08,
      4.6992780286851405e-08, 4.556906279428063e-08, 4.317647073525143e-08,
      3.990911381316294e-08, 3.587693391629611e-08, 3.120256930073875e-08,
      2.6018062314571918e-08, 2.0461491406655907e-08, 1.467360652586867e-08,
      8.794543662686234e-09, 2.960689361322561e-09, -2.698240286640098e-09,
      -8.061849166866858e-09, -1.3021390670061407e-08, -1.748173793581181e-08,
      -2.1362965257155318e-08, -2.4601521085761755e-08, -2.7150983099950917e-08,
      -2.8982395619969617e-08, -3.008419906379795e-08, -3.0461769937131565e-08,
      -3.0136597869804536e-08, -2.9145133299296657e-08, -2.7537345438764084e-08,
      -2.537503505964607e-08, -2.27299503043795e-08, -1.9681756189980684e-08,
      -1.6315909664461295e-08, -1.2721492059679566e-08, -8.989049597232217e-09,
      -5.208490323559264e-09, -1.4670825733037388e-09, 2.152404098644629e-09,
      5.573379485764834e-09, 8.726904287586329e-09, 1.1552928123467757e-08,
      1.4001275753791172e-08, 1.603236969542916e-08, 1.7617683853704716e-08,
      1.8739929083100323e-08, 1.9392977597825418e-08, 1.9581538757134202e-08,
      1.932060383938104e-08, 1.8634681899743207e-08, 1.755685260345413e-08,
      1.6127664981971572e-08, 1.4393913335546745e-08, 1.2407322983121362e-08,
      1.0223179239120717e-08, 7.8989328943208e-09, 5.49281462921548e-09,
      3.0624892432632376e-09, 6.637784057508765e-10, -1.6505221008973721e-09,
      -3.831707881935351e-09, -5.836094999770473e-09, -7.625797308468764e-09,
      -9.16934080626726e-09, -1.0442107901296997e-08, -1.1426608616582686e-08,
      -1.211257978717977e-08, -1.2496917138519053e-08, -1.2583448702019366e-08,
      -1.2382561252496753e-08, -1.1910694283048091e-08, -1.1189718419519814e-08,
      -1.0246217082985055e-08, -9.11069161173834e-09, -7.816710943377128e-09,
      -6.400027333817365e-09, -4.897679466343777e-09, -3.3471037035329125e-09,
      -1.7852731913904827e-09, -2.4788308021552563e-10, 1.231401670240136e-09,
      2.621621527686875e-09, 3.895108624052671e-09, 5.027974456273743e-09,
      6.000492132989252e-09, 6.7973689142746605e-09, 7.407907442315771e-09,
      7.826056638004358e-09, 8.050355686750671e-09, 8.083776806468433e-09,
      7.933474537901472e-09, 7.61045108526686e-09, 7.129148734009234e-09,
      6.506981560460389e-09, 5.763819511458326e-09, 4.9214384644835825e-09,
      4.002950082310226e-09, 3.0322251595894028e-09, 2.0333237380731864e-09,
      1.0299445644359683e-09, 4.490550739647019e-11, -9.003346287778829e-10,
      -1.786103823470298e-09, -2.5948865348735922e-09, -3.3116294362509077e-09,
      -3.923978946996373e-09, -4.422448026570444e-09, -4.800511399842135e-09,
      -5.054630031129722e-09, -5.184207226245069e-09, -5.191480185475566e-09,
      -5.081352128023975e-09, -4.861171236752471e-09, -4.5404636127050245e-09,
      -4.130628168371557e-09, -3.6446019186617143e-09, -3.096504445799895e-09,
      -2.501270420495751e-09, -1.8742789631377428e-09, -1.2309883361088257e-09,
      -5.865839862734517e-10, 4.435267668571836e-11, 6.48148154124444e-10,
      1.2123076633349683e-09, 1.7257481352781147e-09, 2.178989716037112e-09,
      2.5643031717222473e-09, 2.8758116989363776e-09, 3.1095467334053735e-09,
      3.2634584038798854e-09, 3.3373822746311517e-09, 3.3329649377379606e-09,
      3.2535518384365498e-09, 3.104041428506431e-09, 2.8907103325126544e-09,
      2.621014671462758e-09, 2.3033730130853866e-09, 1.946936605771424e-09,
      1.561352605669137e-09, 1.1565259279183686e-09, 7.423851507417783e-10,
      3.286575847735078e-10, -7.53417985410728e-11, -4.6090339272123043e-10,
      -8.200943299571287e-10, -1.1459052343008661e-09, -1.432370064227805e-09,
      -1.6746574563365603e-09, -1.869132690583032e-09, -2.0133900965517726e-09,
      -2.1062563944819652e-09, -2.147766099909122e-09, -2.13911070414964e-09,
      -2.0825638634303285e-09, -1.981385278108357e-09, -1.8397063129993107e-09,
      -1.6624006952721776e-09, -1.454943824727305e-09, -1.2232643416805616e-09,
      -9.73591621287669e-10, -7.12302803020467e-10, -4.457728249770895e-10,
      -1.8023072117588985e-10, 7.837483627630443e-11, 3.244981003242917e-10,
      5.531046456801756e-10, 7.59763741043201e-10, 9.407232771858912e-10,
      1.0929662835586952e-09, 1.214248521435902e-09, 1.30311708967759e-09,
      1.3589104101127478e-09, 1.381740364346699e-09, 1.3724577244136027e-09,
      1.3326023491885512e-09, 1.2643399011153658e-09, 1.1703870691614687e-09,
      1.0539274608865806e-09, 9.185204473686291e-10, 7.680053090671972e-10,
      6.064030394125941e-10, 4.3781811809559437e-10, 2.663424709273426e-10,
      9.596369196974851e-11, -6.952057850334557e-11, -2.2658044395901558e-10,
      -3.720222793284947e-10, -5.030468345304401e-10, -6.172960350958174e-10,
      -7.12887892551551e-10, -7.884392297524686e-10, -8.430762134131394e-10,
      -8.76432961434575e-10, -8.886387505202959e-10, -8.802945849374753e-10,
      -8.524400957267013e-10, -8.065119176116681e-10, -7.442948355576409e-10,
      -6.678671024886649e-10, -5.795414030826657e-10, -4.81802975662843e-10,
      -3.772464056606512e-10, -2.6851257138404347e-10, -1.5822715803997408e-10,
      -4.8942061921270186e-11, 5.6919113291871455e-11, 1.5711040826657505e-10,
      2.496068080586487e-10, 3.326407645111657e-10, 4.0473139801548063e-10,
      4.6470602326230815e-10, 5.117138314752184e-10, 5.452317454784024e-10,
      5.650626398236194e-10, 5.713262824517338e-10, 5.644435037688644e-10,
      5.451142308210112e-10, 5.14290136210331e-10, 4.731427418078353e-10,
      4.2302788503459934e-10, 3.6544749991941983e-10, 3.0200968625753623e-10,
      2.343880384823742e-10, 1.6428118230476808e-10, 9.337342320820813e-11,
      2.3297348351593847e-11, -4.440085549721994e-11, -1.0829269823368872e-10,
      -1.6709473125108213e-10, -2.196914877583425e-10, -2.651536836230668e-10,
      -3.0275146456345716e-10, -3.319626061219421e-10, -3.5247569057551845e-10,
      -3.641883972379305e-10, -3.672011471781957e-10, -3.6180643818030944e-10,
      -3.484742890666464e-10, -3.2783428290031374e-10, -3.006547550163946e-10,
      -2.678197136140024e-10, -2.3030410743499867e-10, -1.8914806687771315e-10,
      -1.4543074209867935e-10, -1.0024434491094212e-10, -5.4668971549540527e-11,
      -9.748741852429728e-12, 3.3530261476787966e-11, 7.4259830499933e-11,
      1.1162689121600281e-10, 1.4492790180342298e-10, 1.7358018369730922e-10,
      1.9713005699429744e-10, 2.1525772908377064e-10, 2.2777896075615553e-10,
      2.3464360572185204e-10, 2.3593118602341746e-10, 2.3184372595046774e-10,
      2.2269611968123768e-10, 2.0890435210132722e-10, 1.9097192743879987e-10,
      1.6947488608622701e-10, 1.4504580606591707e-10, 1.1835719207124046e-10,
      9.010465213668816e-11, 6.099025020472565e-11, 3.170640280335842e-11,
      2.92066051957641e-12, -2.4738319118878984e-11, -5.069334031800556e-11,
      -7.44295561734348e-11, -9.550349840378746e-11, -1.1355012294180028e-10,
      -1.2828779466830668e-10, -1.3952118423753656e-10, -1.4714209815812406e-10,
      -1.5112830903508238e-10, -1.515404952146312e-10, -1.4851743719223733e-10,
      -1.4226965135951317e-10, -1.330716694316499e-10, -1.2125319381331975e-10,
      -1.0718937497548526e-10, -9.129046652439377e-11, -7.399111708758735e-11,
      -5.5739555597784146e-11, -3.698691832944466e-11, -1.8176952555689868e-11,
      2.636865328188299e-13, 1.7934351362943754e-11, 3.446836149748899e-11,
      4.9539867210433014e-11, 6.286950771006075e-11, 7.4228786322149e-11,
      8.344311710450847e-11, 9.039352921787869e-11, 9.501704622056797e-11,
      9.730578663154562e-11, 9.730485902978526e-11, 9.510914911264451e-11,
      9.085911709278964e-11, 8.473574123144236e-11, 7.695475693925433e-11,
      6.776035057419214e-11, 5.741847277274253e-11, 4.620993790315822e-11,
      3.442347415167437e-11, 2.2348883050191058e-11, 1.02704582056407e-11,
      -1.5391990601434347e-12, -1.2824844109511393e-11, -2.3353627202984528e-11,
      -3.2919417829448826e-11, -4.134634718981229e-11, -4.8491521322624806e-11,
      -5.424687803574492e-11, -5.854018123241434e-11, -6.133516594278713e-11,
      -6.263086597725702e-11, -6.246017323246537e-11, -6.088769298038049e-11,
      -5.800697268541841e-11, -5.393719281253859e-11, -4.8819416559480576e-11,
      -4.281250137916745e-11, -3.608877852509448e-11, -2.8829607683620973e-11,
      -2.122091213880195e-11, -1.3448795985717656e-11, -5.695338851586742e-12,
      1.865344374977019e-12, 9.070700909048063e-12, 1.5772927593343982e-11,
      2.1841693663260538e-11, 2.7166356593692246e-11, 3.1657642049185736e-11,
      3.524877224735201e-11, 3.78960401371903e-11, 3.957883940189918e-11,
      4.0299172155529186e-11, 4.008066707795115e-11, 3.896715041857166e-11,
      3.70208206268126e-11, 3.4320084205027294e-11, 3.0957115634750276e-11,
      2.7035207846997123e-11, 2.2665981677852596e-11, 1.796652309569626e-11,
      1.3056515765673397e-11, 8.055433822836573e-12, 3.0798556795771834e-12,
      -1.7590455572055967e-12, -6.357785769966401e-12, -1.0622585463714856e-11,
      -1.4471082989465168e-11, -1.7833719243590266e-11
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_lowpass_48_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).lowpass(chebyshev2<48>(80.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.00010980079645429328, 0.00017094499592826303, 0.00029889598491867817, 0.0004831943982720549,
      0.0007462013528775499, 0.001082404362128886, 0.0015707966452026764,
      0.0021228229525831503, 0.0028977009778995123, 0.0038179494443886424,
      0.00491303678680225, 0.00625333325484736, 0.007835950905284115, 0.009646880082839546,
      0.011708677656755645, 0.014045981362374631, 0.016652338654977353,
      0.019501208669225802, 0.022568942347722727, 0.02583666387192721, 0.029275581223898207,
      0.03283702587529007, 0.03645624225595155, 0.04006238355212309, 0.04358401247857137,
      0.04694728563612701, 0.0500717120244056, 0.05286934446776092, 0.055249033939946054,
      0.057123084866629176, 0.05841263370534436, 0.05905005317995744, 0.0589792928755369,
      0.05815626400173354, 0.056550738957110866, 0.054149700974068474, 0.05096089103644969,
      0.04701512652790186, 0.04236666379828524, 0.03709181713907264, 0.031286628374900836,
      0.025064367641510397, 0.018553196451475386, 0.011893799601582124,
      0.005236507261102435, -0.0012625034979164393, -0.007446013151456007,
      -0.013161278913224958, -0.018265737705403552, -0.022632342861384817,
      -0.02615414964024436, -0.028748001875377842, -0.03035736204335885,
      -0.03095439857789995, -0.030541395707453095, -0.029151436307989293,
      -0.026848201766278113, -0.023724693756282278, -0.019900732723634604,
      -0.01551920857466079, -0.01074120682373502, -0.005740260371725167,
      -0.0006960499487644303, 0.004212113944642587, 0.0088117342028087,
      0.012943263597460388, 0.016465758805224127, 0.019261908579694443,
      0.021242297947248297, 0.022348758368414674, 0.022556641996040367,
      0.021875863726371444, 0.020350588461269102, 0.018057503959784116, 0.01510270368218534,
      0.011617295062355877, 0.007751931474203421, 0.0036705287957556503,
      -0.00045653611774926824, -0.0044594371271565025, -0.008175822472459432,
      -0.011457374464456362, -0.014175756717506826, -0.016227728387226418,
      -0.017539232165527913, -0.018068291393614044, -0.017806585321511203,
      -0.016779613955750332, -0.015045417084226083, -0.012691875236450115,
      -0.009832689961484342, -0.0066022111181843245, -0.0031493431079555414,
      0.0003691862467996834, 0.003795875983768365, 0.006979488556936193,
      0.009781744957388611, 0.01208337369219538, 0.013789246341488152, 0.01483238032866777,
      0.015176644230129143, 0.014818059418747346, 0.013784651947426915,
      0.012134868921208878, 0.009954633127423876, 0.007353167284146509,
      0.004457773414931476, 0.0014078014777881421, -0.0016519181315071876,
      -0.004577874066854479, -0.007234585527804401, -0.009500905678250515,
      -0.011275613606036156, -0.01248202474585492, -0.013071398042449212,
      -0.013024978767748809, -0.012354585123343587, -0.011101720314465411,
      -0.009335265306686281, -0.007147876865964805, -0.004651277186921807,
      -0.001970672620254928, 0.00076142229424917, 0.003411654339678491,
      0.005852282901604042, 0.007967304919495202, 0.009657962929852729,
      0.010847376090565632, 0.01148407623724446, 0.011544283222449572, 0.011032813963163872,
      0.009982585284718093, 0.00845273892003897, 0.0065254847047817735,
      0.0043018217254205664, 0.0018963535615936723, -0.0005685403189191352,
      -0.0029688821740416348, -0.005185310118530069, -0.007109014896373715,
      -0.008647100491121724, -0.009727100510214725, -0.010300426969178503,
      -0.010344584223668173, -0.009864045212537656, -0.008889756338637523,
      -0.007477307505428204, -0.005703871373659117, -0.003664077378092206,
      -0.0014650384389532927, 0.0007792108517359515, 0.0029535783300625295,
      0.004947781490175526, 0.006661920763124232, 0.00801147858273387, 0.008931494619678723,
      0.009379710483798813, 0.009338530278133046, 0.008815704043907715, 0.00784370639352454,
      0.006477849263343367, 0.00479323239245372, 0.002880694556339772,
      0.0008419796772601348, -0.0012156280012286277, -0.0031849186102397764,
      -0.0049643279554715605, -0.0064631753473688575, -0.007606296362467726,
      -0.008337831743095828, -0.008623979035530513, -0.008454569100080784,
      -0.007843392290533555, -0.006827265494585788, -0.005463897756661052,
      -0.003828675287466812, -0.002010542933368621, -0.00010720566710620315,
      0.001780092036122015, 0.0035519306789053616, 0.005115940291264428,
      0.006391610755065653, 0.00731443748185885, 0.007839188890139574, 0.007942129940953311,
      0.007622092155438465, 0.006900342055661804, 0.005819263594420537,
      0.004439932542339912, 0.0028387187392290673, 0.0011031025965328107,
      -0.0006730673393729528, -0.002394620659428979, -0.003970145372794486,
      -0.0053168319536576495, -0.006364824794928389, -0.007060852137496303,
      -0.0073709450470376605, -0.007282105480242735, -0.006802840276013758,
      -0.005962538984827759, -0.004809735534340985, -0.0034093534831044275,
      -0.001839088818059942, -0.0001851299824307147, 0.0014625503861110695,
      0.003015075540514234, 0.004389452054174305, 0.005513006480359271,
      0.006327233475298854, 0.0067908507964112, 0.006881900732277359, 0.006598790175903535,
      0.005960219800972907, 0.005004013431149117, 0.003784918379351115,
      0.002371503021890913, 0.0008423261559366553, -0.0007184088237161322,
      -0.0022254752394732856, -0.003597266807248785, -0.004760210962238805,
      -0.005652713286719599, -0.006228421543602628, -0.00645863620325245,
      -0.006333741909200916, -0.005863588419958312, -0.005076807211792363,
      -0.004019107980280878, -0.0027506545830996293, -0.001342669536261183,
      0.00012654264925380404, 0.0015759324162173713, 0.002926163130072581,
      0.004103945549941514, 0.005046012394432903, 0.0057025175697627125,
      0.006039677270018496, 0.006041512642324042, 0.00571060367597255, 0.005067818665487467,
      0.004151040003184355, 0.003012962080555078, 0.0017180877056103138,
      0.00033909290866609987, -0.0010472360553285384, -0.0023642671319307946,
      -0.0035397519512495234, -0.004509787095963027, -0.005222289844487022,
      -0.005639798993183834, -0.005741449634854122, -0.0055240172476666086,
      -0.005001978521912122, -0.004206591110227537, -0.0031840488780022456,
      -0.0019928202322666197, -0.0007003218960597291, 0.0006208833959921278,
      0.0018971513500702767, 0.003057855352659801, 0.004039292425629217,
      0.004788179815202683, 0.005264550095124014, 0.005443887204622149,
      0.005318388982098185, 0.004897291046482162, 0.004206239539100272,
      0.0032857533144931713, 0.002188866695660655, 0.0009780890820044385,
      -0.0002781449753221192, -0.0015093341769258537, -0.0026468602306881786,
      -0.0036278079616502484, -0.00439844326149158, -0.004917156660670951,
      -0.005156711224330557, -0.005105673230382676, -0.00476895042010496,
      -0.004167412898218882, -0.0033366231735325034, -0.002324751496561396,
      -0.0011897978023438565, 3.72029487330657e-06, 0.0011884249801045552,
      0.0022978743749216823, 0.00327028384379837, 0.004051964287474388,
      0.004600286180683304, 0.004886005682349037, 0.004894825757861635,
      0.004628108815202809, 0.004102705398519401, 0.003349913291814029,
      0.0024136301604471833, 0.0013478078661144654, 0.0002133553200870796,
      -0.0009253329605939009, -0.002004025227947044, -0.0029622714360735985,
      -0.003746789009851906, -0.004314425839196171, -0.0046345356234973965,
      -0.004690634612412085, -0.004481249948936465, -0.004019915868346791,
      -0.003334322323801444, -0.0024646684586140753, -0.0014613180246618909,
      -0.00038189284286806137, 0.0007120284678028462, 0.0017584177320044488,
      0.002698310911820158, 0.003479129319149331, 0.0040576212615965595,
      0.004402259431539356, 0.004494960976196807, 0.004332036216285752,
      0.003924316167343342, 0.0032964558320342915, 0.0024854570054375987,
      0.001538498412995469, 0.0005101998909259681, -0.0005405211651862436,
      -0.001553820474668875, -0.0024723320413167597, -0.003244414173941789,
      -0.0038270527078209486, -0.004188258164525672, -0.004308823162463676,
      -0.004183343428913218, -0.003820448125485473, -0.0032422304483566327,
      -0.0024829150141167365, -0.001586841797875112, -0.0006058849005936744,
      0.0004035439831977874, 0.0013837346153486143, 0.0022789740372141975,
      0.0030387110999357154, 0.0036204100388438523, 0.0039919320288053835,
      0.0041333113477910344, 0.004037827937749601, 0.0037123187471891066,
      0.0031767139301697857, 0.002462828257019758, 0.0016124804355601955,
      0.0006750510419141427, -0.0002953787309970809, -0.0012431420501104163,
      -0.0021141759878902273, -0.0028591030718501205, -0.0034360293034188445,
      -0.0038129001353273658, -0.003969281898278677, -0.0038974696236668896,
      -0.003602861176637718, -0.0031035798430236097, -0.0024293705775519808,
      -0.001619836554106629, -0.0007221200995447559, 0.00021183658402985505,
      0.001128292064167747, 0.0019747945990995727, 0.002703181967876205,
      0.003272320741770295, 0.0036504292245783474, 0.003816852843050899,
      0.003763192738341388, 0.0034937258336231345, 0.00302509555902169,
      0.002385294344086086, 0.0016119995315413908, 0.000750361203686731,
      -0.00014962855473453778, -0.0010360319645548698, -0.0018579598512454886,
      -0.0025684914527927937, -0.00312735228070556, -0.003503197206771982,
      -0.0036753693005011586, -0.0036350356424939764, -0.0033856375937732666,
      -0.0029426327038809905, -0.002332546294101907, -0.0015913904013652815,
      -0.0007625439359080994, 0.00010578147696866779, 0.0009633421752833571,
      0.001760767144735914, 0.0024523988981449696, 0.002998907132710711,
      0.003369525541181239, 0.0035437845144819994, 0.003512642080520414,
      0.0032789505412327575, 0.0028572348506061924, 0.0022727985812724246,
      0.0015602120548983706, 0.0007612726313103353, -7.744276831680302e-05,
      -0.0009072898033172903, -0.0016803757505319096, -0.0023523221682303706,
      -0.0028848118725202532, -0.0032477740519090146, -0.0034210828765852018,
      -0.003395673603282181, -0.0031740142506287827, -0.002769908432597713,
      -0.0022076437067899695, -0.0015205375733327638, -0.0007489678685094959,
      6.199625394435538e-05, 0.0008652239543676819, 0.001614259668059254,
      0.0022660085562235177, 0.0027832152657204967, 0.0031365934397342282,
      0.0033064842437071397, 0.003283949953919016, 0.0030712417637057204,
      0.00268161745638402, 0.002138522347786201, 0.0014741837235265785,
      0.0007277027577925254, -5.7243341829740194e-05, -0.0008349541112313208,
      -0.0015603644726935814, -0.002191654680685076, -0.0026926604804326892,
      -0.0030349446058118993, -0.003199410960598487, -0.003177369841788417,
      -0.002970994782432946, -0.002593147125549043, -0.0020665812164344325,
      -0.0014225789803365705, -0.0006990955582056783, 6.147429209911481e-05,
      0.0008147777658200838, 0.0015170884374981386, 0.002127843054823771,
      0.002611983595327662, 0.002941969391772204, 0.0030993438453882946,
      0.00307576658739284, 0.0028734533634776393, 0.0025050005593383992,
      0.0019926071332676066, 0.001366741687326822, 0.0006643344635404792,
      -7.339865565716573e-05, -0.0008033721009408658, -0.00148314504401566,
      -0.0020733876602140318, -0.0025401559724691444, -0.002856843727526532,
      -0.003005699065510108, -0.002978819508919067, -0.0027785694941474667,
      -0.0024173984935985057, -0.0019170727497861012, -0.0013073677250795735,
      -0.0006242995816417787, 9.199946055573856e-05, 0.0007996367115333283,
      0.001457407406633195, 0.0020271929029351586, 0.0024761691502738436,
      0.002778697505458675, 0.0029177889636411635, 0.002886058162265214,
      0.002686113574832645, 0.002330363384605543, 0.0018402506737793707,
      0.0012449647872174521, 0.0005797060977925392, -0.00011639284784208874,
      -0.0008025671739557355, -0.0014388054574138167, -0.0019881818932927092,
      -0.0024189989510601706, -0.0027066162042175134, -0.002834859805498042,
      -0.0027969319596006853, -0.0025957692420976526, -0.0022438309882034982,
      -0.0017623323280269957, -0.0011799688246293565, -0.0005312091900581146,
      0.00014574250157769922, 0.0008111947569847094, 0.001426294588154582,
      0.0019552951833527272, 0.002367633005410979, 0.002639693633570851,
      0.0027561643128818955, 0.002710895720389461, 0.0025072244442244807,
      0.0021577393896571396, 0.0016835079107336013, 0.001112809008482044,
      0.0004794495955119979, -0.00017923606424688352, -0.0008245854674319615,
      -0.0014188760834215929, -0.0019275296533097916, -0.002321123797717159,
      -0.0025770939133576438, -0.002681026903827796, -0.0026274725524974476,
      -0.0024202268641077204, -0.0020720727918640477, -0.001603995598754974,
      -0.0010439208086435716, -0.0004250504897553856, 0.00021610313692620517,
      0.0008418704052721977, 0.0014156363821095702, 0.0019039826542881176,
      0.0022786334681156417, 0.0025180928937942313, 0.002608878216128831,
      0.002546278771587057, 0.002334597533485743, 0.0019868632310789994,
      0.0015240318788723839, 0.0009737264644154844, 0.00036859044866506703,
      -0.000255646894774911, -0.0008622787329157233, -0.0014157781879970805,
      -0.0018838783484821772, -0.0022394530234756483, -0.002462088625311404,
      -0.002539256091326578, -0.002467015561183438, -0.002250214195032975,
      -0.0019021674129319206, -0.0014438441947618695, -0.0009026061187877472,
      -0.00031057583583892813, 0.00029726784209675126, 0.0008851553607560863,
      0.0014186304566990312, 0.0018665690864922576, 0.0022029949814088207,
      0.002408585931834191, 0.0024717834566124267, 0.00238944212875458,
      0.0021669821053643514, 0.001818037731157727, 0.0013636247217373833,
      0.0008308766423430472, 0.00025142652741396966, -0.0003404699301715335,
      -0.0009099583478924246, -0.0014236372574444236, -0.0018515166249965605,
      -0.0021687684744794125, -0.0023571674352510946, -0.002406137633661658,
      -0.002313345795690693, -0.0020848073295876577, -0.0017345009194956425,
      -0.0012835160855283426, -0.0007587855509700104, -0.00019147849767601696,
      0.000384849528799487, 0.0009362403245466144, 0.001430333130172641,
      0.001838263367846082, 0.0021363486303478925, 0.002307463453778803,
      0.002342023069925619, 0.0022385196312866167, 0.002003580944554963,
      0.0016515499636627104, 0.0012036115147474964, 0.0006865192912144585,
      0.0001309995089488502, -0.00043007361444532307, -0.0009636222868546016,
      -0.0014383145210784985, -0.0018264036206601078, -0.002105349798810618,
      -0.002259129166309072, -0.0022791540709672722, -0.0021647519327020917,
      -0.0019231759152741716, -0.0015691484548049294, -0.0011239661904727377,
      -0.000614220592879594, -7.021104889429121e-05, 0.00047585497468030874,
      0.000991767840170319, 0.001447214985783408, 0.001815561554045979,
      0.0020754078227459647, 0.002211832377247269, 0.002217248805142322,
      0.0020918267319178356, 0.0018434538774044081, 0.001487242962944065,
      0.0010446141330083436, 0.0005420084907864166, 9.309920384440416e-06,
      -0.0005219306829034412, -0.0010203633131098452, -0.0014566883440044415,
      -0.001805378528101959, -0.0020461723145843882, -0.00216525113358071,
      -0.0021560322410688147, -0.0020195316404582418, -0.0017642771279444522,
      -0.0014057781335683765, -0.000965585173358374, -0.0004699958481485784,
      5.151499586997135e-05, 0.0005680473010259196, 0.0010491059360540672,
      0.0014664005821798968, 0.0017955091594666832, 0.0020173069992495962,
      0.00211907813113336, 0.0020952441096462326, 0.0019476686148906003,
      0.0016855212639673594, 0.0013247101690016263, 0.000886918228385587,
      0.00039830143862779196, -0.0001120727050715946, -0.0006139535484637106,
      -0.0010776996396172555, -0.0014760289482108788, -0.0017856236200643086,
      -0.0019884948838663555, -0.002073028217448486, -0.0020346480478601954,
      -0.0018760639549366572, -0.0016070852189607797, -0.0012440161219255035,
      -0.0008086691646174198, -0.00032705583704396456, 0.00017216654440499864,
      0.0006593992482825943, 0.0011058564595893146, 0.0014852655813364685,
      0.0017754130920805394, 0.0019594450106392553, 0.0020268458351141764,
      0.001974039096440121, 0.0018045752425580668, 0.0015288971016932458,
      0.0011636982042154147, 0.0007309132892511258, 0.000256401964517995,
      -0.00023159554765157483, -0.0007041384102368653, -0.0011333010128618069,
      -0.0014938229522824327, -0.001764595678866615, -0.0019298983225384916,
      -0.001980310346528856, -0.0019132480481108228, -0.0017330943720192766,
      -0.00145091568559744, -0.0010837836472858652, -0.0006537436309625034,
      -0.0001864919696155409, 0.0002901586712817098, 0.0007479341855649624,
      0.0011597757490638698, 0.0015014389628737065, 0.0017529209235777085,
      0.001899631226475716, 0.0019332383510804426, 0.001852142334397555,
      0.0016615469414006572, 0.0013731283630606952, 0.0010043213938761403,
      0.0005772666450324802, 0.0001174823004738286, -0.00034765995299321684,
      -0.0007905638377600423, -0.001185045332439602, -0.0015078803868120072,
      -0.0017401720329401685, -0.0018684564215222476, -0.0018854830498789368,
      -0.0017906239740097898, -0.0015898889423330872, -0.001295546831751273,
      -0.0009253771133343635, -0.0005015969409345293, -4.952854921899116e-05,
      0.0004039131558844874, 0.0008318225207691215, 0.001208899266259158,
      0.0015129441406514289, 0.0017261656978525314, 0.0018362212815587384,
      0.0018369313106014105, 0.00172862553804387, 0.0015181019247852122,
      0.0012182018164428523, 0.0008470278692060302, 0.00042685228668018255,
      -1.721884255821612e-05, -0.0004587450507205654, -0.0008715253135440386,
      -0.0012311525364947, -0.001516456495413443, -0.0017107499358354175,
      -0.001802804490021417, -0.0017874993419265649, -0.0016661051786927622,
      -0.0014461877384424045, -0.001141137898988894, -0.0007693574040473683,
      -0.000353149678862219, 8.261745724018918e-05, 0.0005119970393575523,
      0.0009095074906128816, 0.001251644523545167, 0.0015182707194996042,
      0.001693800643538571, 0.0017681117549450329, 0.001737127879664087,
      0.001603041628041131, 0.0013741636942128017, 0.001064409176287284,
      0.0006924525880974969, 0.0002806028167640889, -0.0001465342419041326,
      -0.0005635252354879603, -0.0009456233567423772, -0.0012702366908878483,
      -0.0015182637990636334, -0.0016752175904256828, -0.0017320713634139985,
      -0.0016857776144374535, -0.001539429814280793, -0.0013020586651931606,
      -0.000988076103000209, -0.0006164012045695704, -0.0002093209621570938,
      0.0002088455185952301, 0.000613199368215855, 0.0009797441423388582,
      0.0012868096376152747, 0.0015163328668472069, 0.001654920480572199,
      0.0016946301519355437, 0.0016334253457939243, 0.0014752774553833483,
      0.0012299103393273102, 0.0009122035721069177, 0.0005412909662359734,
      0.000139408933494925, -0.0002694360385525339, -0.0006609009746976356,
      -0.0010117554805165777, -0.0013012600503828674, -0.0015123918495922408,
      -0.0016328455302983154, -0.001655750246754282, -0.001580061099551812,
      -0.0014106027356334525, -0.001157763593641509, -0.0008368600736392028,
      -0.0004672094894758005, -7.096786981802657e-05, 0.0003281975065717869,
      0.0007065213364631868, 0.0010415549146365354, 0.001313497964885917,
      0.0015063686763319617, 0.0016089428127640517, 0.0016154067180245858,
      0.0015256862373520229, 0.0013454329799360346, 0.0010856698001447613,
      0.0007621176535214843, 0.0003942448822104984, 4.096382159993737e-06,
      -0.0003850269673667362, -0.0007499595320073256, -0.0010690497628719283,
      -0.0013234445946829654, -0.001498203219537547, -0.0015831744452630427,
      -0.0015735861242193103, -0.0014703124396339268, -0.0012798041229793583,
      -0.001013686793199966, -0.0006880523563725172, -0.00032248660776398235,
      6.110824222245402e-05, 0.00043982536108433975, 0.0007911208636487067,
      0.0010941555311072958, 0.001331030839718681, 0.00148784599627694,
      0.0015555135612527566, 0.0015302858099259398, 0.0014139613580814816,
      0.0012137607185352642, 0.0009418792124889096, 0.0006147448566098895,
      0.0002520263407684906, -0.00012454903470469764, -0.0004924964505140779,
      -0.0008299157984028759, -0.0011167949425400323, -0.0013361964682900797,
      -0.0014752575506972588, -0.0015259439233404584, -0.001485513759992577,
      -0.001356664702616499, -0.001147356233807539, -0.0008703189650576811,
      -0.0005422810383168621, -0.00018295860929440916, 0.00018612869740048467,
      0.0005429462202998733, 0.000866259459492669, 0.0011368975557773833,
      0.0013388898829256304, 0.0014604083747719275, 0.0014944599920623208,
      0.0014392887969104276, 0.0012984645376830967, 0.001080653407728826,
      0.0007990856051186131, 0.0004707523561696368, 0.00011538110025684781,
      -0.0002457493830174058, -0.0005910827624108023, -0.0009000716267936943,
      -0.0011543998780100856, -0.0013390683328464103, -0.0014432791967988346,
      -0.0014610672595833536, -0.0013916409241638335, -0.001239413598243268,
      -0.001013724504525698, -0.0007282664952521762, -0.0004002558822662312,
      -4.939457989678914e-05, 0.0003033129013946251, 0.0006368165987486745,
      0.0009312771536086051, 0.0011692458446965338, 0.0013366984183611971,
      0.0014238614683989793, 0.0014257826767005988, 0.0013426116536761293,
      0.0011795754844996812, 0.0009466513518676133, 0.0006579566756864504,
      0.0003308940071700304, -1.4897559462657208e-05, -0.0003587213004195307,
      -0.000680061352109529, -0.0009598066815770172, -0.0011813875271156837,
      -0.001331756738285686, -0.0014021579014953914, -0.0013886350353963257,
      -0.0012922541997429748, -0.0011190246456291054, -0.0008795251073883938,
      -0.000588258422087318, -0.0002627738127510736, 7.739007375218195e-05,
      0.00041187773813741794, 0.0007207346582811011, 0.0009855975305130382,
      0.001190785937555846, 0.0013242305523693525, 0.0013781829383385825,
      0.0013496652089730202, 0.001240633466824288, 0.0010578461096943316,
      0.0008124457428217654, 0.000519280513165221, 0.00019600616795537843,
      -0.00013797688589028162, -0.0004626875497327031, -0.0007587592104863364,
      -0.001008594649766524, -0.0011974118221088949, -0.0013141183596351131,
      -0.0013519630730414046, -0.001308926191035602, -0.001187825798799549,
      -0.000996134955303079, -0.000745521268928609, -0.0004511372566240703,
      -0.0001307046174107184, 0.00019655226297715187, 0.000511059413750197,
      0.0007940638377053253, 0.0010287515366943902, 0.0012012463571551843,
      0.0013014303247802996, 0.0013235369771544213, 0.0012664829090399587,
      0.001133918489727077, 0.0009339955487994218, 0.0006788667465405407,
      0.0003839473366724969, 6.698413918983893e-05, -0.0002530120681136478,
      -0.0005569065321817924, -0.0008265845359001203, -0.0010460310511598721,
      -0.0012022816930312408, -0.0012861885142684093, -0.0012929554112749418,
      -0.0012224118155320497, -0.001079009079652932, -0.0008715405888519523,
      -0.0006126031405848246, -0.0003178325506882205, -4.9598451329217524e-06,
      0.00030725501283287396, 0.0006001477549162534, 0.0008562653918402236,
      0.001060406078903724, 0.0012005213138182509, 0.0012684269289136446,
      0.0012602809278535055, 0.0011768002798243497, 0.0010232044738273025,
      0.0008088900094063438, 0.0005468560768679991, 0.00025291649930386394,
      -5.5254312039642955e-05, -0.00035918385037193477, -0.0006407085972510769,
      -0.0008830593600370969, -0.001071860018554298, -0.0011959802036895662,
      -0.001248191339370759, -0.0012255873867828015, -0.0011297458150408698,
      -0.0009666199309042785, -0.0007461697938514497, -0.00048175455794611215,
      -0.0001893232857734333, 0.00011354677325970322, 0.000408706465959129,
      0.0006785221172178351, 0.0009069288721623114, 0.0010803870854097215,
      0.0011886848268755966, 0.0012255389447219734, 0.0011889593154199441,
      0.0010813551812187397, 0.0009093779668627349, 0.0006835107498510946,
      0.00041742968680090676, 0.00012717626928518335, -0.0001698095116469621,
      -0.00045573683592222173, -0.0007135296356987344, -0.0009278462740217113,
      -0.0010859924392346127, -0.0011786729399005612, -0.0012005378827061898,
      -0.0011504911493143677, -0.001031743405821336, -0.0008516072181522239,
      -0.0006210472874775599, -0.00035401343719787054, -6.659690476358817e-05,
      0.00022393905092381726, 0.0005001958413792199, 0.0007456812957424109,
      0.0009457940971595944, 0.0010886921531037266, 0.0011659932617112908,
      0.0011732666238726034, 0.001110286390247225, 0.0009810327600102494,
      0.000793441301506807, 0.0005589162346574238, 0.0002916374990637107,
      7.703690017180835e-06, -0.00027583735159461716, -0.0005420119337795435,
      -0.0007749364677197377, -0.0009607651804608248, -0.0010885130461633728,
      -0.0011507050303645823, -0.0011438132820566422, -0.0010684567154379792,
      -0.0009293517236649474, -0.0007350177003318678, -0.0004972557147893917,
      -0.0002304322171186207, 4.938876925411808e-05, 0.0003254125626495499,
      0.0005811216583106478, 0.0008012640140128844, 0.0009727626620388442,
      0.0010854924056869918, 0.0011328774749194807, 0.0011122748710934347,
      0.0010251210670572564, 0.0008768339655632337, 0.0006764766996258038,
      0.00043620410265574907, 0.0001705256320782949, -0.00010457057457150628,
      -0.0003725796440529033, -0.0006174700472064892, -0.0008246424311013423
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}

TEST(signal_generated, cheby2_highpass_1_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<1>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 1, "order");
    static_assert(design.b().size() == 2, "b.size");
    static_assert(design.a().size() == 2, "a.size");

    static_assert(almost_equal(design.b()[0], 0.0007909554071107805), "design.b()[0] == 0.0007909554071107805");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.0007909554071107805));
    static_assert(almost_equal(design.b()[1], -0.0007909554071107805), "design.b()[1] == -0.0007909554071107805");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.0007909554071107805));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], 0.9984180891857783), "design.a()[1] == 0.9984180891857783");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - 0.9984180891857783));
    std::cout << "max_deviation(cheby2,highpass,1,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.0007909554071107805, -0.0015806595933094854, 0.001578159130805226, -0.0015756626238096426,
      0.0015731700660654732, -0.0015706814513253545, 0.0015681967733518056,
      -0.0015657160259172128, 0.0015632392028038142, -0.0015607662978036837,
      0.0015582973047187155, -0.0015558322173606085, 0.0015533710295508514,
      -0.0015509137351207062, 0.0015484603279111938, -0.0015460108017730778,
      0.0015435651505668496, -0.0015411233681627123, 0.001538685448440566,
      -0.0015362513852899924, 0.0015338211726102391, -0.001531394804310205,
      0.0015289722743084238, -0.0015265535765330502, 0.0015241387049218437,
      -0.0015217276534221541, 0.0015193204159909056, -0.0015169169865945817,
      0.0015145173592092112, -0.0015121215278203516, 0.0015097294864230752,
      -0.0015073412290219532, 0.0015049567496310413, -0.0015025760422738641,
      0.0015001991009834007, -0.0014978259198020695, 0.001495456492781713,
      -0.0014930908139835837, 0.001490728877478328, -0.0014883706773459726,
      0.0014860162076759085, -0.0014836654625668773, 0.0014813184361269556,
      -0.0014789751224735404, 0.0014766355157333347, -0.0014742996100423325,
      0.0014719673995458038, -0.0014696388783982807, 0.0014673140407635418,
      -0.0014649928808145986, 0.0014626753927336803, -0.0014603615707122189,
      0.0014580514089508356, -0.001455744901659325, 0.0014534420430566421,
      -0.0014511428273708863, 0.0014488472488392882, -0.001446555301708194,
      0.001444266980233052, -0.0014419822786783981, 0.0014397011913178407,
      -0.0014374237124340473, 0.0014351498363187293, -0.0014328795572726282,
      0.0014306128696055015, -0.0014283497676361079, 0.0014260902456921932,
      -0.0014238342981104767, 0.0014215819192366361, -0.0014193331034252938,
      0.0014170878450400024, -0.0014148461384532315, 0.0014126079780463526,
      -0.0014103733582096253, 0.0014081422733421833, -0.0014059147178520207,
      0.0014036906861559773, -0.0014014701726797248, 0.0013992531718577538,
      -0.001397039678133358, 0.0013948296859586221, -0.0013926231897944067,
      0.0013904201841103351, -0.0013882206633847789, 0.0013860246221048444,
      -0.0013838320547663594, 0.001381642955873858, -0.001379457319940568,
      0.0013772751414883968, -0.0013750964150479176, 0.001372921135158356,
      -0.0013707492963675753, 0.0013685808932320648, -0.001366415920316924,
      0.00136425437219585, -0.0013620962434511242, 0.001359941528673598,
      -0.0013577902224626802, 0.001355642319426322, -0.001353497814181005,
      0.0013513567013517266, -0.0013492189755719875, 0.001347084631483777,
      -0.001344953663737561, 0.0013428260669922675, -0.0013407018359152738,
      0.0013385809651823926, -0.0013364634494778592, 0.0013343492834943182,
      -0.0013322384619328096, 0.0013301309795027561, -0.0013280268309219495,
      0.0013259260109165375, -0.0013238285142210108, 0.0013217343355781896,
      -0.0013196434697392103, 0.001317555911463513, -0.001315471655518827,
      0.0013133906966811598, -0.0013113130297347818, 0.0013092386494722146,
      -0.0013071675506942176, 0.0013050997282097747, -0.001303035176836082,
      0.0013009738913985337, -0.0012989158667307103, 0.001296861097674365,
      -0.0012948095790794106, 0.001292761305803907, -0.0012907162727140485,
      0.0012886744746841503, -0.001286635906596636, 0.0012846005633420248,
      -0.001282568439818919, 0.00128053953093399, -0.0012785138316019672,
      0.001276491336745624, -0.0012744720412957659, 0.001272455940191217,
      -0.001270443028378808, 0.001268433300813363, -0.0012664267524576875,
      0.001264423378282555, -0.0012624231732666952, 0.0012604261323967806,
      -0.0012584322506674146, 0.0012564415230811186, -0.0012544539446483194,
      0.0012524695103873372, -0.0012504882153243726, 0.0012485100544934943,
      -0.0012465350229366266, 0.001244563115703537, -0.001242594327851824,
      0.0012406286544469048, -0.001238666090562002, 0.0012367066312781322,
      -0.0012347502716840936, 0.0012327970068764533, -0.0012308468319595354,
      0.001228899742045408, -0.0012269557322538722, 0.0012250147977124486,
      -0.0012230769335563657, 0.0012211421349285479, -0.0012192103969796027,
      0.0012172817148678092, -0.0012153560837591055, 0.001213433498827077,
      -0.0012115139552529436, 0.0012095974482255484, -0.0012076839729413455,
      0.0012057735246043875, -0.0012038660984263136, 0.0012019616896263381,
      -0.001200060293431238, 0.0011981619050753412, -0.0011962665198005141,
      0.0011943741328561503, -0.0011924847394991587, 0.0011905983349939507,
      -0.0011887149146124294, 0.0011868344736339774, -0.0011849570073454447,
      0.0011830825110411372, -0.0011812109800228047, 0.0011793424095996293,
      -0.0011774767950882134, 0.0011756141318125682, -0.001173754415104102,
      0.0011718976403016085, -0.0011700438027512545, 0.0011681928978065693,
      -0.001166344920828432, 0.001164499867185061, -0.0011626577322520013,
      0.0011608185114121135, -0.001158982200055562, 0.0011571487935798036,
      -0.0011553182873895761, 0.0011534906768968865, -0.0011516659575209994,
      0.001149844124688426, -0.001148025173832912, 0.001146209100395427,
      -0.0011443958998241521, 0.0011425855675744694, -0.0011407780991089498,
      0.0011389734898973422, -0.0011371717354165618, 0.0011353728311506793,
      -0.0011335767725909086, 0.0011317835552355966, -0.0011299931745902111,
      0.0011282056261673302, -0.0011264209054866303, 0.0011246390080748756,
      -0.0011228599294659065, 0.0011210836652006282, -0.001119310210827,
      0.0011175395619000242, -0.001115771713981734, 0.0011140066626411835,
      -0.0011122444034544364, 0.0011104849320045544, -0.0011087282438815862,
      0.001106974334682557, -0.0011052232000114568, 0.00110347483547923,
      -0.0011017292367037639, 0.001099986399309878, -0.0010982463189293129,
      0.0010965089912007195, -0.0010947744117696479, 0.0010930425762885362,
      -0.0010913134804167008, 0.0010895871198203237, -0.0010878634901724433,
      0.0010861425871529426, -0.0010844244064485387, 0.0010827089437527718,
      -0.0010809961947659949, 0.001079286155195362, -0.0010775788207548188,
      0.0010758741871650904, -0.001074172250153672, 0.0010724730054548172,
      -0.0010707764488095274, 0.0010690825759655418, -0.001067391382677326,
      0.0010657028647060617, -0.0010640170178196362, 0.0010623338377926314,
      -0.0010606533204063136, 0.0010589754614486228, -0.0010573002567141618,
      0.0010556277020041863, -0.0010539577931265938, 0.0010522905258959136,
      -0.001050625896133296, 0.0010489638996665014, -0.0010473045323298909,
      0.0010456477899644149, -0.0010439936684176032, 0.0010423421635435545,
      -0.0010406932712029257, 0.001039046987262922, -0.0010374033075972865,
      0.001035762228086289, -0.0010341237446167169, 0.0010324878530818644,
      -0.0010308545493815217, 0.0010292238294219655, -0.0010275956891159482,
      0.0010259701243826881, -0.0010243471311478587, 0.001022726705343579,
      -0.0010211088429084028, 0.0010194935397873086, -0.00101788079193169,
      0.0010162705952993449, -0.0010146629458544654, 0.0010130578395676282,
      -0.0010114552724157842, 0.0010098552403822482, -0.001008257739456689,
      0.00100666276563512, -0.0010050703149198875, 0.0010034803833196626,
      -0.00100189296684943, 0.0010003080615304783, -0.0009987256633903902,
      0.0009971457684630322, -0.000995568372788545, 0.0009939934724133338,
      -0.0009924210633900574, 0.0009908511417776192, -0.0009892837036411574,
      0.0009877187450520342, -0.0009861562620878269, 0.0009845962508323177,
      -0.000983038707375484, 0.0009814836278134883, -0.0009799310082486685,
      0.0009783808447895287, -0.000976833133550729, 0.0009752878706530751,
      -0.0009737450522235097, 0.0009722046743951025, -0.0009706667333070401,
      0.0009691312251046165, -0.0009675981459392237, 0.0009660674919683415,
      -0.0009645392593555288, 0.000963013444270413, -0.0009614900428886807,
      0.0009599690513920687, -0.0009584504659683535, 0.0009569342828113424,
      -0.0009554204981208637, 0.0009539091081027573, -0.000952400108968865,
      0.0009508934969370213, -0.0009493892682310436, 0.0009478874190807229,
      -0.0009463879457218145, 0.0009448908443960281, -0.000943396111351019,
      0.0009419037428403782, -0.0009404137351236232, 0.0009389260844661886,
      -0.0009374407871394167, 0.0009359578394205484, -0.0009344772375927136,
      0.0009329989779449216, -0.0009315230567720528, 0.0009300494703748483,
      -0.0009285782150599012, 0.0009271092871396473, -0.0009256426829323558,
      0.00092417839876212, -0.0009227164309588481, 0.0009212567758582543,
      -0.0009197994298018492, 0.0009183443891369308, -0.0009168916502165753,
      0.0009154412093996282, -0.0009139930630506948, 0.0009125472075401313,
      -0.0009111036392440359, 0.000909662354544239, -0.0009082233498282951,
      0.0009067866214894731, -0.0009053521659267474, 0.0009039199795447889,
      -0.000902490058753956, 0.0009010623999702855, -0.000899636999615484,
      0.0008982138541169184, -0.0008967929599076072, 0.0008953743134262115,
      -0.0008939579111170264, 0.0008925437494299713, -0.000891131824820582,
      0.0008897221337500013, -0.0008883146726849699, 0.0008869094380978178,
      -0.0008855064264664556, 0.0008841056342743655, -0.0008827070580105926,
      0.0008813106941697359, -0.0008799165392519396, 0.0008785245897628845,
      -0.0008771348422137789, 0.0008757472931213503, -0.0008743619390078363,
      0.0008729787764009759, -0.0008715978018340012, 0.0008702190118456282,
      -0.0008688424029800483, 0.0008674679717869198, -0.0008660957148213592,
      0.0008647256286439323, -0.0008633577098206458, 0.0008619919549229389,
      -0.0008606283605276742, 0.0008592669232171296, -0.0008579076395789895,
      0.000856550506206336, -0.0008551955196976413, 0.0008538426766567577,
      -0.0008524919736929104, 0.0008511434074206884, -0.0008497969744600361,
      0.0008484526714362449, -0.0008471104949799446, 0.0008457704417270951,
      -0.000844432508318978, 0.000843096691402188, -0.0008417629876286244,
      0.0008404313936554832, -0.0008391019061452482, 0.0008377745217656831,
      -0.0008364492371898225, 0.0008351260490959645, -0.0008338049541676614,
      0.0008324859490937119, -0.000831169030568153, 0.0008298541952902512,
      -0.0008285414399644943, 0.0008272307613005838, -0.0008259221560134256,
      0.0008246156208231226, -0.0008233111524549665, 0.0008220087476394287,
      -0.0008207084031121531, 0.0008194101156139474, -0.000818113881890775,
      0.0008168196986937472, -0.0008155275627791142, 0.0008142374709082581,
      -0.0008129494198476838, 0.0008116634063690116, -0.0008103794272489685,
      0.0008090974792693806, -0.0008078175592171649, 0.0008065396638843212,
      -0.0008052637900679239, 0.0008039899345701144, -0.0008027180941980926,
      0.0008014482657641092, -0.0008001804460854578, 0.0007989146319844665,
      -0.0007976508202884904, 0.0007963890078299032, -0.0007951291914460898,
      0.0007938713679794379, -0.0007926155342773303, 0.0007913616871921368,
      -0.0007901098235812069, 0.0007888599403068611, -0.0007876120342363834,
      0.0007863661022420137, -0.0007851221412009398, 0.0007838801479952891,
      -0.0007826401195121217, 0.0007814020526434217, -0.0007801659442860901,
      0.0007789317913419365, -0.0007776995907176717, 0.0007764693393248997,
      -0.0007752410340801101, 0.0007740146719046704, -0.0007727902497248182,
      0.0007715677644716534, -0.0007703472130811309, 0.0007691285924940523,
      -0.0007679118996560589, 0.0007666971315176235, -0.000765484285034043,
      0.0007642733571654309, -0.0007630643448767094, 0.000761857245137602,
      -0.0007606520549226257, 0.0007594487712110836, -0.0007582473909870575,
      0.0007570479112393998, -0.0007558503289617262, 0.0007546546411524086,
      -0.0007534608448145671, 0.0007522689369560624, -0.0007510789145894885,
      0.0007498907747321656, -0.0007487045144061317, 0.000747520130638136,
      -0.0007463376204596312, 0.0007451569809067656, -0.0007439782090203765,
      0.0007428013018459819, -0.0007416262564337737, 0.0007404530698386104,
      -0.0007392817391200092, 0.0007381122613421387, -0.0007369446335738119,
      0.0007357788528884789, -0.000734614916364219, 0.0007334528210837339,
      -0.0007322925641343401, 0.0007311341426079619, -0.0007299775536011237,
      0.000728822794214943, -0.0007276698615551232, 0.0007265187527319459,
      -0.0007253694648602644, 0.0007242219950594958, -0.000723076340453614,
      0.0007219324981711426, -0.0007207904653451476, 0.0007196502391132303,
      -0.0007185118166175198, 0.0007173751950046665, -0.0007162403714258342,
      0.0007151073430366935, -0.0007139761069974145, 0.0007128466604726594,
      -0.0007117190006315758, 0.0007105931246477897, -0.0007094690296993978,
      0.000708346712968961, -0.0007072261716434971, 0.0007061074029144737,
      -0.0007049904039778014, 0.0007038751720338264, -0.000702761704287324,
      0.0007016499979474911, -0.0007005400502279394, 0.0006994318583466884,
      -0.0006983254195261586, 0.0006972207309931642, -0.0006961177899789066,
      0.0006950165937189669, -0.0006939171394532993, 0.0006928194244262244,
      -0.0006917234458864217, 0.0006906292010869234, -0.0006895366872851067,
      0.0006884459017426878, -0.0006873568417257145, 0.0006862695045045593,
      -0.000685183887353913, 0.0006840999875527775, -0.0006830178023844589,
      0.000681937329136561, -0.0006808585651009784, 0.0006797815075738897,
      -0.0006787061538557507, 0.0006776325012512875, -0.0006765605470694901,
      0.0006754902886236051, -0.0006744217232311297, 0.0006733548482138045,
      -0.0006722896608976065, 0.0006712261586127431, -0.0006701643386936451,
      0.0006691041984789598, -0.0006680457353115449, 0.0006669889465384609,
      -0.0006659338295109654, 0.0006648803815845059, -0.0006638286001187136,
      0.0006627784824773962, -0.0006617300260285318, 0.0006606832281442621,
      -0.0006596380862008858, 0.0006585945975788522, -0.0006575527596627542,
      0.0006565125698413224, -0.000655474025507418, 0.0006544371240580263,
      -0.0006534018628942508, 0.0006523682394213058, -0.0006513362510485105,
      0.0006503058951892823, -0.0006492771692611303, 0.0006482500706856488,
      -0.0006472245968885112, 0.0006462007452994631, -0.0006451785133523158,
      0.0006441578984849403, -0.0006431388981392607, 0.0006421215097612476,
      -0.000641105730800912, 0.0006400915587122985, -0.0006390789909534795,
      0.0006380680249865483, -0.000637058658277613, 0.0006360508882967901,
      -0.0006350447125181981, 0.0006340401284199512, -0.0006330371334841532,
      0.0006320357251968908, -0.0006310359010482274, 0.0006300376585321972,
      -0.0006290409951467982, 0.0006280459083939867, -0.0006270523957796706,
      0.0006260604548137031, -0.0006250700830098768, 0.000624081277885917,
      -0.000623094036963476, 0.0006221083577681264, -0.0006211242378293554,
      0.000620141674680558, -0.0006191606658590313, 0.0006181812089059682,
      -0.0006172033013664513, 0.0006162269407894464, -0.0006152521247277969,
      0.0006142788507382172, -0.0006133071163812868, 0.0006123369192214441,
      -0.0006113682568269805, 0.000610401126770034, -0.0006094355266265835,
      0.000608471453976442, -0.0006075089064032515, 0.0006065478814944762,
      -0.0006055883768413968, 0.0006046303900391045, -0.0006036739186864946,
      0.0006027189603862609, -0.0006017655127448894, 0.0006008135733726526,
      -0.0005998631398836032, 0.0005989142098955685, -0.0005979667810301437,
      0.0005970208509126867, -0.0005960764171723122, 0.0005951334774418848,
      -0.0005941920293580142, 0.0005932520705610484, -0.0005923135986950685,
      0.0005913766114078822, -0.0005904411063510183, 0.0005895070811797207,
      -0.0005885745335529422, 0.0005876434611333393, -0.0005867138615872658,
      0.0005857857325847672, -0.0005848590717995746, 0.0005839338769090992,
      -0.0005830101455944263, 0.0005820878755403095, -0.000581167064435165,
      0.0005802477099710657, -0.0005793298098437351, 0.0005784133617525424,
      -0.0005774983634004958, 0.0005765848124942372, -0.0005756727067440366,
      0.000574762043863786, -0.0005738528215709938, 0.000572945037586779,
      -0.0005720386896358659, 0.0005711337754465776, -0.0005702302927508314,
      0.0005693282392841321, -0.0005684276127855668, 0.0005675284109977991,
      -0.0005666306316670636, 0.0005657342725431603, -0.0005648393313794484,
      0.0005639458059328416, -0.0005630536939638015, 0.0005621629932363326,
      -0.0005612737015179769, 0.0005603858165798074, -0.0005594993361964233,
      0.0005586142581459443, -0.0005577305802100048, 0.0005568483001737485,
      -0.0005559674158258227, 0.0005550879249583729, -0.0005542098253670374,
      0.0005533331148509414, -0.0005524577912126917, 0.0005515838522583713,
      -0.0005507112957975338, 0.0005498401196431976, -0.0005489703216118411,
      0.0005481018995233966, -0.0005472348512012451, 0.0005463691744722109,
      -0.0005455048671665559, 0.0005446419271179746, -0.0005437803521635882,
      0.0005429201401439394, -0.000542061288902987, 0.0005412037962881004,
      -0.0005403476601500545, 0.0005394928783430237, -0.0005386394487245773,
      0.0005377873691556734, -0.0005369366375006543, 0.0005360872516272402,
      -0.0005352392094065246, 0.000534392508712969, -0.0005335471474243969,
      0.0005327031234219891, -0.0005318604345902783, 0.0005310190788171432,
      -0.0005301790539938043, 0.0005293403580148177, -0.0005285029887780701,
      0.0005276669441847735, -0.0005268322221394603, 0.0005259988205499775,
      -0.0005251667373274817, 0.0005243359703864339, -0.0005235065176445942,
      0.0005226783770230167, -0.0005218515464460442, 0.0005210260238413029,
      -0.0005202018071396974, 0.0005193788942754055, -0.0005185572831858728,
      0.0005177369718118077, -0.0005169179580971762, 0.0005161002399891969,
      -0.0005152838154383356, 0.0005144686823983003, -0.0005136548388260361,
      0.0005128422826817199, -0.0005120310119287556, 0.0005112210245337686,
      -0.0005104123184666012, 0.0005096048917003069, -0.0005087987422111459,
      0.0005079938679785797, -0.0005071902669852662, 0.0005063879372170543,
      -0.0005055868766629792, 0.0005047870833152575, -0.0005039885551692817,
      0.0005031912902236155, -0.0005023952864799886, 0.0005016005419432919,
      -0.0005008070546215724, 0.000500014822526028, -0.000499223843671003,
      0.0004984341160739825, -0.000497645637755588, 0.0004968584067395722,
      -0.000496072421052814, 0.0004952876787253134, -0.0004945041777901871,
      0.000493721916283663, -0.0004929408922450757, 0.0004921611037168611,
      -0.0004913825487445521, 0.0004906052253767733, -0.0004898291316652361,
      0.0004890542656647341, -0.0004882806254331378, 0.00048750820903139023,
      -0.00048673701452350165, 0.00048596703997654493, -0.00048519828346065073,
      0.00048443074304900253, -0.0004836644168178319, 0.00048289930284641354,
      -0.0004821353992170607, 0.00048137270401512017, -0.00048061121532896753,
      0.00047985093125000244, -0.00047909184987264373, 0.00047833396929432477,
      -0.0004775772876154885, 0.0004768218029395829, -0.00047606751337305614,
      0.0004753144170253517, -0.00047456251200890385, 0.0004738117964391328,
      -0.00047306226843443994, 0.0004723139261162033, -0.0004715667676087726,
      0.0004708207910394647, -0.000470075994538559, 0.00046933237623929247,
      -0.0004685899342778552, 0.0004678486667933857, -0.000467108571927966,
      0.00046636964782661755, -0.0004656318926372959, 0.00046489530451088645,
      -0.0004641598816011998, 0.00046342562206496703, -0.00046269252406183506,
      0.00046196058575436214, -0.00046122980530801316, 0.00046050018089115505,
      -0.0004597717106750523, 0.00045904439283386226, -0.00045831822554463054,
      0.0004575932069872866, -0.00045686933534463904, 0.0004561466088023711,
      -0.00045542502554903606, 0.00045470458377605284, -0.00045398528167770136,
      0.00045326711745111793, -0.0004525500892962909, 0.00045183419541605614,
      -0.0004511194340160923, 0.0004504058033049167, -0.00044969330149388046,
      0.00044898192679716423, -0.00044827167743177374, 0.00044756255161753516,
      -0.00044685454757709077, 0.00044614766353589445, -0.0004454418977222073,
      0.0004447372483670931, -0.000444033713704414, 0.00044333129197082603,
      -0.0004426299814057745, 0.00044192978025148997, -0.00044123068675298356,
      0.00044053269915804254, -0.00043983581571722615, 0.00043914003468386106,
      -0.00043844535431403697, 0.00043775177286660237, -0.00043705928860316,
      0.00043636789978806264, -0.0004356776046884087, 0.00043498840157403794,
      -0.000434300288717527, 0.00043361326439418516, -0.00043292732688205,
      0.00043224247446188325, -0.00043155870541716605, 0.0004308760180340951,
      -0.0004301944106015782, 0.00042951388141122983, -0.0004288344287573671,
      0.0004281560509370052, -0.00042747874624985354, 0.000426802512998311,
      -0.00042612734948746197, 0.00042545325402507214, -0.0004247802249215841,
      0.0004241082604901131, -0.00042343735904644305, 0.00042276751890902203,
      -0.00042209873839895817, 0.00042143101584001555, -0.0004207643495586098,
      0.0004200987378838041, -0.00041943417914730484, 0.00041877067168345756,
      -0.0004181082138292426, 0.0004174468039242712, -0.00041678644031078115,
      0.00041612712133363256, -0.00041546884534030394, 0.0004148116106808879,
      -0.00041415541570808713, 0.00041350025877721, -0.0004128461382461669,
      0.0004121930524754657, -0.0004115409998282077, 0.0004108899786700839,
      -0.00041023998736937036, 0.0004095910242969246, -0.00040894308782618116,
      0.00040829617633314773, -0.00040765028819640095, 0.0004070054217970825,
      -0.00040636157551889485, 0.00040571874774809733, -0.00040507693687350215,
      0.0004044361412864702, -0.000403796359380907, 0.00040315758955325904,
      -0.0004025198302025092, 0.0004018830797301732, -0.00040124733654029534,
      0.00040061259903944463, -0.0003999788656367107, 0.0003993461347436999,
      -0.0003987144047745312, 0.00039808367414583245, -0.00039745394127673606,
      0.00039682520458887536, -0.0003961974625063805, 0.0003955707134558745,
      -0.00039494495586646925, 0.00039432018816976176, -0.0003936964087998301,
      0.00039307361619322944, -0.00039245180878898813, 0.000391830985028604,
      -0.0003912111433560401, 0.0003905922822177212, -0.00038997440006252945,
      0.00038935749534180095, -0.0003887415665093215, 0.0003881266120213229,
      -0.00038751263033647915, 0.0003868996199159024, -0.0003862875792231392,
      0.00038567650672416664, -0.00038506640088738843, 0.00038445726018363125,
      -0.00038384908308614074, 0.0003832418680705777, -0.00038263561361501436,
      0.00038203031819993043, -0.0003814259803082094, 0.00038082259842513476,
      -0.00038022017103838605, 0.0003796186966380352, -0.0003790181737165428,
      0.000378418600768754, -0.0003778199762918953, 0.0003772222987855702,
      -0.0003766255667517558, 0.0003760297786947988, -0.0003754349331214121,
      0.0003748410285406708, -0.00037424806346400834, 0.0003736560364052131,
      -0.0003730649458804245, 0.0003724747904081292, -0.00037188556850915763,
      0.00037129727870668, -0.00037070991952620284, 0.0003701234894955651,
      -0.0003695379871449346, 0.0003689534110068043, -0.00036836975961598866,
      0.0003677870315096199, -0.00036720522522714434, 0.00036662433931031885,
      -0.000366044372303207, 0.00036546532275217556, -0.0003648871892058909,
      0.00036430997021531515, -0.0003637336643337028, 0.0003631582701165968,
      -0.00036258378612182533, 0.0003620102109094978, -0.0003614375430420014,
      0.00036086578108399754, -0.0003602949236024182, 0.0003597249691664624,
      -0.0003591559163475924, 0.0003585877637195305, -0.000358020509858255,
      0.0003574541533419971, -0.00035688869275123694, 0.0003563241266687003,
      -0.000355760453679355, 0.0003551976723704072, -0.0003546357813312981,
      0.0003540747791537002, -0.0003535146644315138, 0.00035295543576086366,
      -0.00035239709174009524, 0.00035183963096977134, -0.0003512830520526685,
      0.0003507273535937736, -0.0003501725342002803, 0.0003496185924815855,
      -0.0003490655270492859, 0.00034851333651717464, -0.00034796201950123765,
      0.00034741157461965025, -0.00034686200049277366, 0.0003463132957431516,
      -0.00034576545899550674, 0.00034521848887673743, -0.0003446723840159141,
      0.00034412714304427576, -0.0003435827645952268, 0.00034303924730433343,
      -0.0003424965898093203, 0.0003419547907500669, -0.00034141384876860444,
      0.00034087376250911233, -0.00034033453061791476, 0.0003397961517434772,
      -0.00033925862453640333, 0.00033872194764943126, -0.0003381861197374304,
      0.0003376511394573981, -0.0003371170054684562, 0.00033658371643184766,
      -0.0003360512710109332, 0.00033551966787118804, -0.0003349889056801986,
      0.0003344589831076588, -0.0003339298988253672, 0.00033340165150722343,
      -0.00033287423982922477, 0.0003323476624694631, -0.00033182191810812137,
      0.00033129700542747036, -0.0003307729231118654, 0.00033024966984774304,
      -0.00032972724432361774, 0.00032920564523007873, -0.00032868487125978647,
      0.0003281649211074696, -0.0003276457934699215, 0.0003271274870459972,
      -0.00032661000053661, 0.0003260933326447282, -0.0003255774820753719,
      0.0003250624475356098, -0.00032454822773455585, 0.00032403482138336606,
      -0.00032352222719523536, 0.00032301044388539414, -0.0003224994701711053,
      0.0003219893047716609, -0.00032147994640837886, 0.00032097139380460007,
      -0.00032046364568568477, 0.0003199567007790097, -0.00031945055781396466,
      0.00031894521552194963, -0.0003184406726363712, 0.00031793692789263973,
      -0.00031743398002816593, 0.00031693182778235796, -0.000316430469896618,
      0.00031592990511433933, -0.00031543013218090295, 0.0003149311498436746,
      -0.0003144329568520016, 0.00031393555195720975, -0.0003134389339126
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 1, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.0007909554071107805, -0.0015806595933094854, 0.001578159130805226, -0.0015756626238096426,
      0.0015731700660654732, -0.0015706814513253545, 0.0015681967733518056,
      -0.0015657160259172128, 0.0015632392028038142, -0.0015607662978036837,
      0.0015582973047187155, -0.0015558322173606085, 0.0015533710295508514,
      -0.0015509137351207062, 0.0015484603279111938, -0.0015460108017730778,
      0.0015435651505668496, -0.0015411233681627123, 0.001538685448440566,
      -0.0015362513852899924, 0.0015338211726102391, -0.001531394804310205,
      0.0015289722743084238, -0.0015265535765330502, 0.0015241387049218437,
      -0.0015217276534221541, 0.0015193204159909056, -0.0015169169865945817,
      0.0015145173592092112, -0.0015121215278203516, 0.0015097294864230752,
      -0.0015073412290219532, 0.0015049567496310413, -0.0015025760422738641,
      0.0015001991009834007, -0.0014978259198020695, 0.001495456492781713,
      -0.0014930908139835837, 0.001490728877478328, -0.0014883706773459726,
      0.0014860162076759085, -0.0014836654625668773, 0.0014813184361269556,
      -0.0014789751224735404, 0.0014766355157333347, -0.0014742996100423325,
      0.0014719673995458038, -0.0014696388783982807, 0.0014673140407635418,
      -0.0014649928808145986, 0.0014626753927336803, -0.0014603615707122189,
      0.0014580514089508356, -0.001455744901659325, 0.0014534420430566421,
      -0.0014511428273708863, 0.0014488472488392882, -0.001446555301708194,
      0.001444266980233052, -0.0014419822786783981, 0.0014397011913178407,
      -0.0014374237124340473, 0.0014351498363187293, -0.0014328795572726282,
      0.0014306128696055015, -0.0014283497676361079, 0.0014260902456921932,
      -0.0014238342981104767, 0.0014215819192366361, -0.0014193331034252938,
      0.0014170878450400024, -0.0014148461384532315, 0.0014126079780463526,
      -0.0014103733582096253, 0.0014081422733421833, -0.0014059147178520207,
      0.0014036906861559773, -0.0014014701726797248, 0.0013992531718577538,
      -0.001397039678133358, 0.0013948296859586221, -0.0013926231897944067,
      0.0013904201841103351, -0.0013882206633847789, 0.0013860246221048444,
      -0.0013838320547663594, 0.001381642955873858, -0.001379457319940568,
      0.0013772751414883968, -0.0013750964150479176, 0.001372921135158356,
      -0.0013707492963675753, 0.0013685808932320648, -0.001366415920316924,
      0.00136425437219585, -0.0013620962434511242, 0.001359941528673598,
      -0.0013577902224626802, 0.001355642319426322, -0.001353497814181005,
      0.0013513567013517266, -0.0013492189755719875, 0.001347084631483777,
      -0.001344953663737561, 0.0013428260669922675, -0.0013407018359152738,
      0.0013385809651823926, -0.0013364634494778592, 0.0013343492834943182,
      -0.0013322384619328096, 0.0013301309795027561, -0.0013280268309219495,
      0.0013259260109165375, -0.0013238285142210108, 0.0013217343355781896,
      -0.0013196434697392103, 0.001317555911463513, -0.001315471655518827,
      0.0013133906966811598, -0.0013113130297347818, 0.0013092386494722146,
      -0.0013071675506942176, 0.0013050997282097747, -0.001303035176836082,
      0.0013009738913985337, -0.0012989158667307103, 0.001296861097674365,
      -0.0012948095790794106, 0.001292761305803907, -0.0012907162727140485,
      0.0012886744746841503, -0.001286635906596636, 0.0012846005633420248,
      -0.001282568439818919, 0.00128053953093399, -0.0012785138316019672,
      0.001276491336745624, -0.0012744720412957659, 0.001272455940191217,
      -0.001270443028378808, 0.001268433300813363, -0.0012664267524576875,
      0.001264423378282555, -0.0012624231732666952, 0.0012604261323967806,
      -0.0012584322506674146, 0.0012564415230811186, -0.0012544539446483194,
      0.0012524695103873372, -0.0012504882153243726, 0.0012485100544934943,
      -0.0012465350229366266, 0.001244563115703537, -0.001242594327851824,
      0.0012406286544469048, -0.001238666090562002, 0.0012367066312781322,
      -0.0012347502716840936, 0.0012327970068764533, -0.0012308468319595354,
      0.001228899742045408, -0.0012269557322538722, 0.0012250147977124486,
      -0.0012230769335563657, 0.0012211421349285479, -0.0012192103969796027,
      0.0012172817148678092, -0.0012153560837591055, 0.001213433498827077,
      -0.0012115139552529436, 0.0012095974482255484, -0.0012076839729413455,
      0.0012057735246043875, -0.0012038660984263136, 0.0012019616896263381,
      -0.001200060293431238, 0.0011981619050753412, -0.0011962665198005141,
      0.0011943741328561503, -0.0011924847394991587, 0.0011905983349939507,
      -0.0011887149146124294, 0.0011868344736339774, -0.0011849570073454447,
      0.0011830825110411372, -0.0011812109800228047, 0.0011793424095996293,
      -0.0011774767950882134, 0.0011756141318125682, -0.001173754415104102,
      0.0011718976403016085, -0.0011700438027512545, 0.0011681928978065693,
      -0.001166344920828432, 0.001164499867185061, -0.0011626577322520013,
      0.0011608185114121135, -0.001158982200055562, 0.0011571487935798036,
      -0.0011553182873895761, 0.0011534906768968865, -0.0011516659575209994,
      0.001149844124688426, -0.001148025173832912, 0.001146209100395427,
      -0.0011443958998241521, 0.0011425855675744694, -0.0011407780991089498,
      0.0011389734898973422, -0.0011371717354165618, 0.0011353728311506793,
      -0.0011335767725909086, 0.0011317835552355966, -0.0011299931745902111,
      0.0011282056261673302, -0.0011264209054866303, 0.0011246390080748756,
      -0.0011228599294659065, 0.0011210836652006282, -0.001119310210827,
      0.0011175395619000242, -0.001115771713981734, 0.0011140066626411835,
      -0.0011122444034544364, 0.0011104849320045544, -0.0011087282438815862,
      0.001106974334682557, -0.0011052232000114568, 0.00110347483547923,
      -0.0011017292367037639, 0.001099986399309878, -0.0010982463189293129,
      0.0010965089912007195, -0.0010947744117696479, 0.0010930425762885362,
      -0.0010913134804167008, 0.0010895871198203237, -0.0010878634901724433,
      0.0010861425871529426, -0.0010844244064485387, 0.0010827089437527718,
      -0.0010809961947659949, 0.001079286155195362, -0.0010775788207548188,
      0.0010758741871650904, -0.001074172250153672, 0.0010724730054548172,
      -0.0010707764488095274, 0.0010690825759655418, -0.001067391382677326,
      0.0010657028647060617, -0.0010640170178196362, 0.0010623338377926314,
      -0.0010606533204063136, 0.0010589754614486228, -0.0010573002567141618,
      0.0010556277020041863, -0.0010539577931265938, 0.0010522905258959136,
      -0.001050625896133296, 0.0010489638996665014, -0.0010473045323298909,
      0.0010456477899644149, -0.0010439936684176032, 0.0010423421635435545,
      -0.0010406932712029257, 0.001039046987262922, -0.0010374033075972865,
      0.001035762228086289, -0.0010341237446167169, 0.0010324878530818644,
      -0.0010308545493815217, 0.0010292238294219655, -0.0010275956891159482,
      0.0010259701243826881, -0.0010243471311478587, 0.001022726705343579,
      -0.0010211088429084028, 0.0010194935397873086, -0.00101788079193169,
      0.0010162705952993449, -0.0010146629458544654, 0.0010130578395676282,
      -0.0010114552724157842, 0.0010098552403822482, -0.001008257739456689,
      0.00100666276563512, -0.0010050703149198875, 0.0010034803833196626,
      -0.00100189296684943, 0.0010003080615304783, -0.0009987256633903902,
      0.0009971457684630322, -0.000995568372788545, 0.0009939934724133338,
      -0.0009924210633900574, 0.0009908511417776192, -0.0009892837036411574,
      0.0009877187450520342, -0.0009861562620878269, 0.0009845962508323177,
      -0.000983038707375484, 0.0009814836278134883, -0.0009799310082486685,
      0.0009783808447895287, -0.000976833133550729, 0.0009752878706530751,
      -0.0009737450522235097, 0.0009722046743951025, -0.0009706667333070401,
      0.0009691312251046165, -0.0009675981459392237, 0.0009660674919683415,
      -0.0009645392593555288, 0.000963013444270413, -0.0009614900428886807,
      0.0009599690513920687, -0.0009584504659683535, 0.0009569342828113424,
      -0.0009554204981208637, 0.0009539091081027573, -0.000952400108968865,
      0.0009508934969370213, -0.0009493892682310436, 0.0009478874190807229,
      -0.0009463879457218145, 0.0009448908443960281, -0.000943396111351019,
      0.0009419037428403782, -0.0009404137351236232, 0.0009389260844661886,
      -0.0009374407871394167, 0.0009359578394205484, -0.0009344772375927136,
      0.0009329989779449216, -0.0009315230567720528, 0.0009300494703748483,
      -0.0009285782150599012, 0.0009271092871396473, -0.0009256426829323558,
      0.00092417839876212, -0.0009227164309588481, 0.0009212567758582543,
      -0.0009197994298018492, 0.0009183443891369308, -0.0009168916502165753,
      0.0009154412093996282, -0.0009139930630506948, 0.0009125472075401313,
      -0.0009111036392440359, 0.000909662354544239, -0.0009082233498282951,
      0.0009067866214894731, -0.0009053521659267474, 0.0009039199795447889,
      -0.000902490058753956, 0.0009010623999702855, -0.000899636999615484,
      0.0008982138541169184, -0.0008967929599076072, 0.0008953743134262115,
      -0.0008939579111170264, 0.0008925437494299713, -0.000891131824820582,
      0.0008897221337500013, -0.0008883146726849699, 0.0008869094380978178,
      -0.0008855064264664556, 0.0008841056342743655, -0.0008827070580105926,
      0.0008813106941697359, -0.0008799165392519396, 0.0008785245897628845,
      -0.0008771348422137789, 0.0008757472931213503, -0.0008743619390078363,
      0.0008729787764009759, -0.0008715978018340012, 0.0008702190118456282,
      -0.0008688424029800483, 0.0008674679717869198, -0.0008660957148213592,
      0.0008647256286439323, -0.0008633577098206458, 0.0008619919549229389,
      -0.0008606283605276742, 0.0008592669232171296, -0.0008579076395789895,
      0.000856550506206336, -0.0008551955196976413, 0.0008538426766567577,
      -0.0008524919736929104, 0.0008511434074206884, -0.0008497969744600361,
      0.0008484526714362449, -0.0008471104949799446, 0.0008457704417270951,
      -0.000844432508318978, 0.000843096691402188, -0.0008417629876286244,
      0.0008404313936554832, -0.0008391019061452482, 0.0008377745217656831,
      -0.0008364492371898225, 0.0008351260490959645, -0.0008338049541676614,
      0.0008324859490937119, -0.000831169030568153, 0.0008298541952902512,
      -0.0008285414399644943, 0.0008272307613005838, -0.0008259221560134256,
      0.0008246156208231226, -0.0008233111524549665, 0.0008220087476394287,
      -0.0008207084031121531, 0.0008194101156139474, -0.000818113881890775,
      0.0008168196986937472, -0.0008155275627791142, 0.0008142374709082581,
      -0.0008129494198476838, 0.0008116634063690116, -0.0008103794272489685,
      0.0008090974792693806, -0.0008078175592171649, 0.0008065396638843212,
      -0.0008052637900679239, 0.0008039899345701144, -0.0008027180941980926,
      0.0008014482657641092, -0.0008001804460854578, 0.0007989146319844665,
      -0.0007976508202884904, 0.0007963890078299032, -0.0007951291914460898,
      0.0007938713679794379, -0.0007926155342773303, 0.0007913616871921368,
      -0.0007901098235812069, 0.0007888599403068611, -0.0007876120342363834,
      0.0007863661022420137, -0.0007851221412009398, 0.0007838801479952891,
      -0.0007826401195121217, 0.0007814020526434217, -0.0007801659442860901,
      0.0007789317913419365, -0.0007776995907176717, 0.0007764693393248997,
      -0.0007752410340801101, 0.0007740146719046704, -0.0007727902497248182,
      0.0007715677644716534, -0.0007703472130811309, 0.0007691285924940523,
      -0.0007679118996560589, 0.0007666971315176235, -0.000765484285034043,
      0.0007642733571654309, -0.0007630643448767094, 0.000761857245137602,
      -0.0007606520549226257, 0.0007594487712110836, -0.0007582473909870575,
      0.0007570479112393998, -0.0007558503289617262, 0.0007546546411524086,
      -0.0007534608448145671, 0.0007522689369560624, -0.0007510789145894885,
      0.0007498907747321656, -0.0007487045144061317, 0.000747520130638136,
      -0.0007463376204596312, 0.0007451569809067656, -0.0007439782090203765,
      0.0007428013018459819, -0.0007416262564337737, 0.0007404530698386104,
      -0.0007392817391200092, 0.0007381122613421387, -0.0007369446335738119,
      0.0007357788528884789, -0.000734614916364219, 0.0007334528210837339,
      -0.0007322925641343401, 0.0007311341426079619, -0.0007299775536011237,
      0.000728822794214943, -0.0007276698615551232, 0.0007265187527319459,
      -0.0007253694648602644, 0.0007242219950594958, -0.000723076340453614,
      0.0007219324981711426, -0.0007207904653451476, 0.0007196502391132303,
      -0.0007185118166175198, 0.0007173751950046665, -0.0007162403714258342,
      0.0007151073430366935, -0.0007139761069974145, 0.0007128466604726594,
      -0.0007117190006315758, 0.0007105931246477897, -0.0007094690296993978,
      0.000708346712968961, -0.0007072261716434971, 0.0007061074029144737,
      -0.0007049904039778014, 0.0007038751720338264, -0.000702761704287324,
      0.0007016499979474911, -0.0007005400502279394, 0.0006994318583466884,
      -0.0006983254195261586, 0.0006972207309931642, -0.0006961177899789066,
      0.0006950165937189669, -0.0006939171394532993, 0.0006928194244262244,
      -0.0006917234458864217, 0.0006906292010869234, -0.0006895366872851067,
      0.0006884459017426878, -0.0006873568417257145, 0.0006862695045045593,
      -0.000685183887353913, 0.0006840999875527775, -0.0006830178023844589,
      0.000681937329136561, -0.0006808585651009784, 0.0006797815075738897,
      -0.0006787061538557507, 0.0006776325012512875, -0.0006765605470694901,
      0.0006754902886236051, -0.0006744217232311297, 0.0006733548482138045,
      -0.0006722896608976065, 0.0006712261586127431, -0.0006701643386936451,
      0.0006691041984789598, -0.0006680457353115449, 0.0006669889465384609,
      -0.0006659338295109654, 0.0006648803815845059, -0.0006638286001187136,
      0.0006627784824773962, -0.0006617300260285318, 0.0006606832281442621,
      -0.0006596380862008858, 0.0006585945975788522, -0.0006575527596627542,
      0.0006565125698413224, -0.000655474025507418, 0.0006544371240580263,
      -0.0006534018628942508, 0.0006523682394213058, -0.0006513362510485105,
      0.0006503058951892823, -0.0006492771692611303, 0.0006482500706856488,
      -0.0006472245968885112, 0.0006462007452994631, -0.0006451785133523158,
      0.0006441578984849403, -0.0006431388981392607, 0.0006421215097612476,
      -0.000641105730800912, 0.0006400915587122985, -0.0006390789909534795,
      0.0006380680249865483, -0.000637058658277613, 0.0006360508882967901,
      -0.0006350447125181981, 0.0006340401284199512, -0.0006330371334841532,
      0.0006320357251968908, -0.0006310359010482274, 0.0006300376585321972,
      -0.0006290409951467982, 0.0006280459083939867, -0.0006270523957796706,
      0.0006260604548137031, -0.0006250700830098768, 0.000624081277885917,
      -0.000623094036963476, 0.0006221083577681264, -0.0006211242378293554,
      0.000620141674680558, -0.0006191606658590313, 0.0006181812089059682,
      -0.0006172033013664513, 0.0006162269407894464, -0.0006152521247277969,
      0.0006142788507382172, -0.0006133071163812868, 0.0006123369192214441,
      -0.0006113682568269805, 0.000610401126770034, -0.0006094355266265835,
      0.000608471453976442, -0.0006075089064032515, 0.0006065478814944762,
      -0.0006055883768413968, 0.0006046303900391045, -0.0006036739186864946,
      0.0006027189603862609, -0.0006017655127448894, 0.0006008135733726526,
      -0.0005998631398836032, 0.0005989142098955685, -0.0005979667810301437,
      0.0005970208509126867, -0.0005960764171723122, 0.0005951334774418848,
      -0.0005941920293580142, 0.0005932520705610484, -0.0005923135986950685,
      0.0005913766114078822, -0.0005904411063510183, 0.0005895070811797207,
      -0.0005885745335529422, 0.0005876434611333393, -0.0005867138615872658,
      0.0005857857325847672, -0.0005848590717995746, 0.0005839338769090992,
      -0.0005830101455944263, 0.0005820878755403095, -0.000581167064435165,
      0.0005802477099710657, -0.0005793298098437351, 0.0005784133617525424,
      -0.0005774983634004958, 0.0005765848124942372, -0.0005756727067440366,
      0.000574762043863786, -0.0005738528215709938, 0.000572945037586779,
      -0.0005720386896358659, 0.0005711337754465776, -0.0005702302927508314,
      0.0005693282392841321, -0.0005684276127855668, 0.0005675284109977991,
      -0.0005666306316670636, 0.0005657342725431603, -0.0005648393313794484,
      0.0005639458059328416, -0.0005630536939638015, 0.0005621629932363326,
      -0.0005612737015179769, 0.0005603858165798074, -0.0005594993361964233,
      0.0005586142581459443, -0.0005577305802100048, 0.0005568483001737485,
      -0.0005559674158258227, 0.0005550879249583729, -0.0005542098253670374,
      0.0005533331148509414, -0.0005524577912126917, 0.0005515838522583713,
      -0.0005507112957975338, 0.0005498401196431976, -0.0005489703216118411,
      0.0005481018995233966, -0.0005472348512012451, 0.0005463691744722109,
      -0.0005455048671665559, 0.0005446419271179746, -0.0005437803521635882,
      0.0005429201401439394, -0.000542061288902987, 0.0005412037962881004,
      -0.0005403476601500545, 0.0005394928783430237, -0.0005386394487245773,
      0.0005377873691556734, -0.0005369366375006543, 0.0005360872516272402,
      -0.0005352392094065246, 0.000534392508712969, -0.0005335471474243969,
      0.0005327031234219891, -0.0005318604345902783, 0.0005310190788171432,
      -0.0005301790539938043, 0.0005293403580148177, -0.0005285029887780701,
      0.0005276669441847735, -0.0005268322221394603, 0.0005259988205499775,
      -0.0005251667373274817, 0.0005243359703864339, -0.0005235065176445942,
      0.0005226783770230167, -0.0005218515464460442, 0.0005210260238413029,
      -0.0005202018071396974, 0.0005193788942754055, -0.0005185572831858728,
      0.0005177369718118077, -0.0005169179580971762, 0.0005161002399891969,
      -0.0005152838154383356, 0.0005144686823983003, -0.0005136548388260361,
      0.0005128422826817199, -0.0005120310119287556, 0.0005112210245337686,
      -0.0005104123184666012, 0.0005096048917003069, -0.0005087987422111459,
      0.0005079938679785797, -0.0005071902669852662, 0.0005063879372170543,
      -0.0005055868766629792, 0.0005047870833152575, -0.0005039885551692817,
      0.0005031912902236155, -0.0005023952864799886, 0.0005016005419432919,
      -0.0005008070546215724, 0.000500014822526028, -0.000499223843671003,
      0.0004984341160739825, -0.000497645637755588, 0.0004968584067395722,
      -0.000496072421052814, 0.0004952876787253134, -0.0004945041777901871,
      0.000493721916283663, -0.0004929408922450757, 0.0004921611037168611,
      -0.0004913825487445521, 0.0004906052253767733, -0.0004898291316652361,
      0.0004890542656647341, -0.0004882806254331378, 0.00048750820903139023,
      -0.00048673701452350165, 0.00048596703997654493, -0.00048519828346065073,
      0.00048443074304900253, -0.0004836644168178319, 0.00048289930284641354,
      -0.0004821353992170607, 0.00048137270401512017, -0.00048061121532896753,
      0.00047985093125000244, -0.00047909184987264373, 0.00047833396929432477,
      -0.0004775772876154885, 0.0004768218029395829, -0.00047606751337305614,
      0.0004753144170253517, -0.00047456251200890385, 0.0004738117964391328,
      -0.00047306226843443994, 0.0004723139261162033, -0.0004715667676087726,
      0.0004708207910394647, -0.000470075994538559, 0.00046933237623929247,
      -0.0004685899342778552, 0.0004678486667933857, -0.000467108571927966,
      0.00046636964782661755, -0.0004656318926372959, 0.00046489530451088645,
      -0.0004641598816011998, 0.00046342562206496703, -0.00046269252406183506,
      0.00046196058575436214, -0.00046122980530801316, 0.00046050018089115505,
      -0.0004597717106750523, 0.00045904439283386226, -0.00045831822554463054,
      0.0004575932069872866, -0.00045686933534463904, 0.0004561466088023711,
      -0.00045542502554903606, 0.00045470458377605284, -0.00045398528167770136,
      0.00045326711745111793, -0.0004525500892962909, 0.00045183419541605614,
      -0.0004511194340160923, 0.0004504058033049167, -0.00044969330149388046,
      0.00044898192679716423, -0.00044827167743177374, 0.00044756255161753516,
      -0.00044685454757709077, 0.00044614766353589445, -0.0004454418977222073,
      0.0004447372483670931, -0.000444033713704414, 0.00044333129197082603,
      -0.0004426299814057745, 0.00044192978025148997, -0.00044123068675298356,
      0.00044053269915804254, -0.00043983581571722615, 0.00043914003468386106,
      -0.00043844535431403697, 0.00043775177286660237, -0.00043705928860316,
      0.00043636789978806264, -0.0004356776046884087, 0.00043498840157403794,
      -0.000434300288717527, 0.00043361326439418516, -0.00043292732688205,
      0.00043224247446188325, -0.00043155870541716605, 0.0004308760180340951,
      -0.0004301944106015782, 0.00042951388141122983, -0.0004288344287573671,
      0.0004281560509370052, -0.00042747874624985354, 0.000426802512998311,
      -0.00042612734948746197, 0.00042545325402507214, -0.0004247802249215841,
      0.0004241082604901131, -0.00042343735904644305, 0.00042276751890902203,
      -0.00042209873839895817, 0.00042143101584001555, -0.0004207643495586098,
      0.0004200987378838041, -0.00041943417914730484, 0.00041877067168345756,
      -0.0004181082138292426, 0.0004174468039242712, -0.00041678644031078115,
      0.00041612712133363256, -0.00041546884534030394, 0.0004148116106808879,
      -0.00041415541570808713, 0.00041350025877721, -0.0004128461382461669,
      0.0004121930524754657, -0.0004115409998282077, 0.0004108899786700839,
      -0.00041023998736937036, 0.0004095910242969246, -0.00040894308782618116,
      0.00040829617633314773, -0.00040765028819640095, 0.0004070054217970825,
      -0.00040636157551889485, 0.00040571874774809733, -0.00040507693687350215,
      0.0004044361412864702, -0.000403796359380907, 0.00040315758955325904,
      -0.0004025198302025092, 0.0004018830797301732, -0.00040124733654029534,
      0.00040061259903944463, -0.0003999788656367107, 0.0003993461347436999,
      -0.0003987144047745312, 0.00039808367414583245, -0.00039745394127673606,
      0.00039682520458887536, -0.0003961974625063805, 0.0003955707134558745,
      -0.00039494495586646925, 0.00039432018816976176, -0.0003936964087998301,
      0.00039307361619322944, -0.00039245180878898813, 0.000391830985028604,
      -0.0003912111433560401, 0.0003905922822177212, -0.00038997440006252945,
      0.00038935749534180095, -0.0003887415665093215, 0.0003881266120213229,
      -0.00038751263033647915, 0.0003868996199159024, -0.0003862875792231392,
      0.00038567650672416664, -0.00038506640088738843, 0.00038445726018363125,
      -0.00038384908308614074, 0.0003832418680705777, -0.00038263561361501436,
      0.00038203031819993043, -0.0003814259803082094, 0.00038082259842513476,
      -0.00038022017103838605, 0.0003796186966380352, -0.0003790181737165428,
      0.000378418600768754, -0.0003778199762918953, 0.0003772222987855702,
      -0.0003766255667517558, 0.0003760297786947988, -0.0003754349331214121,
      0.0003748410285406708, -0.00037424806346400834, 0.0003736560364052131,
      -0.0003730649458804245, 0.0003724747904081292, -0.00037188556850915763,
      0.00037129727870668, -0.00037070991952620284, 0.0003701234894955651,
      -0.0003695379871449346, 0.0003689534110068043, -0.00036836975961598866,
      0.0003677870315096199, -0.00036720522522714434, 0.00036662433931031885,
      -0.000366044372303207, 0.00036546532275217556, -0.0003648871892058909,
      0.00036430997021531515, -0.0003637336643337028, 0.0003631582701165968,
      -0.00036258378612182533, 0.0003620102109094978, -0.0003614375430420014,
      0.00036086578108399754, -0.0003602949236024182, 0.0003597249691664624,
      -0.0003591559163475924, 0.0003585877637195305, -0.000358020509858255,
      0.0003574541533419971, -0.00035688869275123694, 0.0003563241266687003,
      -0.000355760453679355, 0.0003551976723704072, -0.0003546357813312981,
      0.0003540747791537002, -0.0003535146644315138, 0.00035295543576086366,
      -0.00035239709174009524, 0.00035183963096977134, -0.0003512830520526685,
      0.0003507273535937736, -0.0003501725342002803, 0.0003496185924815855,
      -0.0003490655270492859, 0.00034851333651717464, -0.00034796201950123765,
      0.00034741157461965025, -0.00034686200049277366, 0.0003463132957431516,
      -0.00034576545899550674, 0.00034521848887673743, -0.0003446723840159141,
      0.00034412714304427576, -0.0003435827645952268, 0.00034303924730433343,
      -0.0003424965898093203, 0.0003419547907500669, -0.00034141384876860444,
      0.00034087376250911233, -0.00034033453061791476, 0.0003397961517434772,
      -0.00033925862453640333, 0.00033872194764943126, -0.0003381861197374304,
      0.0003376511394573981, -0.0003371170054684562, 0.00033658371643184766,
      -0.0003360512710109332, 0.00033551966787118804, -0.0003349889056801986,
      0.0003344589831076588, -0.0003339298988253672, 0.00033340165150722343,
      -0.00033287423982922477, 0.0003323476624694631, -0.00033182191810812137,
      0.00033129700542747036, -0.0003307729231118654, 0.00033024966984774304,
      -0.00032972724432361774, 0.00032920564523007873, -0.00032868487125978647,
      0.0003281649211074696, -0.0003276457934699215, 0.0003271274870459972,
      -0.00032661000053661, 0.0003260933326447282, -0.0003255774820753719,
      0.0003250624475356098, -0.00032454822773455585, 0.00032403482138336606,
      -0.00032352222719523536, 0.00032301044388539414, -0.0003224994701711053,
      0.0003219893047716609, -0.00032147994640837886, 0.00032097139380460007,
      -0.00032046364568568477, 0.0003199567007790097, -0.00031945055781396466,
      0.00031894521552194963, -0.0003184406726363712, 0.00031793692789263973,
      -0.00031743398002816593, 0.00031693182778235796, -0.000316430469896618,
      0.00031592990511433933, -0.00031543013218090295, 0.0003149311498436746,
      -0.0003144329568520016, 0.00031393555195720975, -0.0003134389339126
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_2_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<2>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 2, "order");
    static_assert(design.b().size() == 3, "b.size");
    static_assert(design.a().size() == 3, "a.size");

    static_assert(almost_equal(design.b()[0], 0.010788853526797955), "design.b()[0] == 0.010788853526797955");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.010788853526797955));
    static_assert(almost_equal(design.b()[1], -0.021236072108229847), "design.b()[1] == -0.021236072108229847");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.021236072108229847));
    static_assert(almost_equal(design.b()[2], 0.010788853526797954), "design.b()[2] == 0.010788853526797954");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.010788853526797954));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], 1.6867678372493875), "design.a()[1] == 1.6867678372493875");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - 1.6867678372493875));
    static_assert(almost_equal(design.a()[2], 0.7295816164112133), "design.a()[2] == 0.7295816164112133");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.7295816164112133));
    std::cout << "max_deviation(cheby2,highpass,2,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.010788853526797955, -0.039434363238027265, 0.06943411992380688, -0.08834865382184748,
      0.09836581028287145, -0.10146273140702443, 0.09937818515106599, -0.09360258285159911,
      0.08538132927902087, -0.07572775643231765, 0.06544249571036272, -0.05513671800848587,
      0.04525720078585275, -0.03611165484127374, 0.0278931562325224, -0.020702879302010768,
      0.01457061693415361, -0.00947280786788432, 0.0053479733850618286,
      -0.002109603024184124, -0.0003433725362397347, 0.0021183173346941715,
      -0.003322591259228971, 0.0040589546872753035, -0.004422412717766586,
      0.004498244813689144, -0.004360983656739059, 0.004074130248772984,
      -0.0036904183629685484, 0.003252468468280272, -0.0027936978094747246,
      0.002339378409601609, -0.0019077576968705829, 0.00151117684287163,
      -0.0011571395507481634, 0.0008492989337057293, -0.0005883423817368336,
      0.00037276411793504653, -0.00019952273914269192, 6.458669148264073e-05,
      3.662536862725071e-05, -0.00010889975659840662, 0.00015696741126975294,
      -0.00018531632038026313, 0.00019806507129676098, -0.0001988864113754726,
      0.0001909705671028048, -0.00017701914095674426, 0.00015926157850952157,
      -0.00013948739734448334, 0.00011908853566112204, -9.910727091472604e-05,
      8.028615067283574e-05, -6.311725381942775e-05, 4.788885413479508e-05,
      -3.472819085228475e-05, 2.363956776774771e-05, -1.4537412980067116e-05,
      7.274246588333193e-06, -1.6637359249867952e-06, -2.500820336145799e-06,
      5.432134455183207e-06, -7.338197143417971e-06, 8.414649488537155e-06,
      -8.839746385552449e-06, 8.771426317210667e-06, -8.346043342037261e-06,
      7.678366086895427e-06, -6.862501165880053e-06, 5.9734515086186885e-06,
      -5.069071188880231e-06, 4.192225838918666e-06, -3.373010559887087e-06,
      2.630914823200952e-06, -1.9768560098635116e-06, 1.4150300469597573e-06,
      -9.445493688647668e-07, 5.608555871639618e-07, -2.569073104532433e-07,
      2.4153062570430743e-08, 1.4669424171346004e-07, -2.6506075926336787e-07,
      3.4007054165482815e-07, -3.8023659486879074e-07, 3.932616432955353e-07,
      -3.859274620316822e-07, 3.64053565078239e-07, -3.325082630433984e-07,
      2.9525745525121715e-07, -2.5543886320456584e-07, 2.1545164737736316e-07,
      -1.7705341056750257e-07, 1.4145843726853882e-07, -1.0943262881917464e-07,
      8.138196332044942e-08, -5.7432444039121676e-08, 3.7500415073764197e-08,
      -2.1352838673418616e-08, 8.657668062689091e-09, 9.7516252059545e-10,
      -7.961348235359893e-09, 1.2717485496507572e-08, -1.5642992191828098e-08,
      1.710765248229078e-08, -1.74437984491458e-08, 1.694220943244887e-08,
      -1.5850899293718745e-08, 1.437606257682046e-08, -1.2684555252582622e-08,
      1.0907388857443724e-08, -9.143814388471841e-09, 7.465661626813028e-09,
      -5.92167903418976e-09, 4.541688260115885e-09, -3.3404255223440463e-09,
      2.320990071765744e-09, -1.4778583515365637e-09, 7.994522471490452e-10,
      -2.7027205296690037e-10, -1.2737945646664673e-10, 4.120450915686165e-10,
      -6.020906982079031e-10, 7.149667009031808e-10, -7.6670853096311e-10,
      7.716327292481648e-10, -7.421888205284365e-10, 6.889311777527524e-10,
      -6.205796333482149e-10, 5.441422437228524e-10, -4.650781435903561e-10,
      3.87482676682922e-10, -3.1428085276187757e-10, 2.474185967163756e-10,
      -1.880441987134541e-10, 1.3667484664865963e-10, -9.334514503383805e-11,
      5.773613286577363e-11, -2.9284550167217563e-11, 7.273016208835052e-12,
      9.097579626017418e-12, -2.0651763631808324e-11, 2.8197303827631375e-11,
      -3.249515810136062e-11, 3.423955304670758e-11, -3.4046306867852e-11,
      3.244766694480129e-11, -2.989212139879126e-11, 2.6747847664274454e-11,
      -2.330866690765395e-11, 1.9801571734567572e-11, -1.6395079449978417e-11,
      1.3207829991783568e-11, -1.0316994263692845e-11, 7.76618414639356e-12,
      -5.572660284882506e-12, 3.733718953583867e-12, -2.232206545878554e-12,
      1.041161498304592e-12, -1.2762086881680181e-13, -5.443455119961803e-13,
      1.0112943417453731e-12, -1.3086742911200232e-12, 1.4696079431782937e-12,
      -1.524102707248226e-12, 1.4986084885762484e-12, -1.4158472824284647e-12,
      1.2948484549942597e-12, -1.1511325790907953e-12, 9.969957820180159e-13,
      -8.418552512246192e-13, 6.92624567185325e-13, -5.540947282442581e-13,
      4.29303015098668e-13, -3.1987719082524353e-13, 2.2634696966781198e-13,
      -1.4841827055916865e-13, 8.520857723936122e-14, -3.544384580561965e-14,
      -2.3810723810470498e-15, 2.987549462520677e-14, -4.8655836819159314e-14,
      6.02744889812696e-14, -6.617066534588568e-14, 6.763939097551804e-14,
      -6.581504824658358e-14, 6.16662503883654e-14, -5.5999198514937855e-14,
      4.94670843303786e-14, -4.2583501080724996e-14, 3.573820467553404e-14,
      -2.9213914656802515e-14, 2.3203154508432057e-14, -1.78243996705421e-14,
      1.3137029110448005e-14, -9.154763857319021e-15, 5.857426298897049e-15,
      -3.2009708771524924e-15, 1.125824176393925e-15, 4.363654954990812e-16,
      -1.5574279055015453e-15, 2.3086550562823853e-15, -2.7578943275005545e-15,
      2.9675751624620405e-15, -2.9935013373119253e-15, 2.884253492689961e-15,
      -2.6810624815384746e-15, 2.4180316381786997e-15, -2.1226040977509795e-15,
      1.8161888921842378e-15, -1.514876081067743e-15, 1.2301862232955976e-15,
      -9.698128153942192e-16, 7.383278118804388e-16, -5.378300049550164e-16,
      3.6852395583271556e-16, -2.2922347158500667e-16, 1.1777847602955094e-16,
      -3.142771436851548e-17, -3.2917753125016755e-17, 7.845368989488522e-17,
      -1.0831697329465468e-16, 1.254672168946899e-16, -1.326079936260715e-16,
      1.3214032370198505e-16, -1.261416936854742e-16, 1.163646008852268e-16,
      -1.0424940539166576e-16, 9.09470704601452e-17, -7.734814364866743e-17,
      6.411505030334046e-17, -5.171542106569976e-17, 4.045474690683442e-17,
      -3.050714545201269e-17, 2.194343211494915e-17, -1.4756023039390118e-17,
      8.880460396519873e-18, -4.213551835937318e-18, 6.282630668734425e-19,
      2.0143960247618002e-18, -3.856187609912218e-18, 5.034826926961481e-18,
      -5.6791805368911466e-18, 5.906141903837436e-18, -5.8188644896277066e-18,
      5.50606091346087e-18, -5.042109898741387e-18, 4.487747987772354e-18,
      -3.891158277408345e-18, 3.289302201014002e-18, -2.7093716139205855e-18,
      2.1702664808369513e-18, -1.6840279765933447e-18, 1.2571777008137197e-18,
      -8.91931058195038e-19, 5.872668829313955e-19, -3.398463868450793e-19,
      1.447828332218308e-19, 3.7306497815171714e-21, -1.1192363355408307e-19,
      1.8606737180925024e-19, -2.3219503284636243e-19, 2.5590777948833024e-19,
      -2.622517843561201e-19, 2.556522637018651e-19, -2.3989193519504204e-19,
      2.181228089117188e-19, -1.9290179279916853e-19, 1.6624214833941699e-19,
      -1.396743072151319e-19, 1.1431091379943e-19, -9.091216601433338e-20,
      6.994857638442338e-20, -5.165916387444549e-20, 3.610382069839928e-20,
      -2.320918727390893e-20, 1.2807826758568603e-20, -4.6708338745265566e-21,
      -1.4657425965449361e-21, 5.880121997703739e-21, -8.849021811999261e-21,
      1.063621647181882e-20, -1.1484744217429638e-20, 1.1612109158987052e-20,
      -1.1207874001786742e-20, 1.0433100020000232e-20, -9.421158725785547e-21,
      8.279509551504849e-21, -7.092106208052255e-21, 5.922158688420268e-21,
      -4.81503649168356e-21, 3.801150580812587e-21, -2.8986964375750318e-21,
      2.116178335879271e-21, -1.4546659224336688e-21, 9.097588809986347e-22,
      -4.732545050930251e-22, 1.345271230808506e-22, 1.183617623491895e-22,
      -2.9779732979924563e-22, 4.1596039202811457e-22, -4.843611536047934e-22,
      5.135277603346619e-22, -5.128211162934343e-22, 4.9034975176910015e-22,
      -4.529613313321724e-22, 4.062904407062344e-22, -3.5484538768005393e-22,
      3.0211975067212635e-22, -2.5071720691186938e-22, 2.024807048188184e-22,
      -1.5861927547110367e-22, 1.1982769231866309e-22, -8.639579002275305e-23,
      5.830555843145564e-23, -3.5315160559120264e-23, 1.702981343224231e-23,
      -2.9600496473194365e-24, -7.431722269316918e-24, 1.4695187905602564e-23,
      -1.9365322375539145e-23, 2.19434639953893e-23, -2.2884946104192522e-23,
      2.2592043114320228e-23, -2.141109573280657e-23, 1.9632808308988153e-23,
      -1.7494847776607504e-23, 1.5186010526392416e-23, -1.2851354812323945e-23,
      1.059781785582509e-23, -8.499946087183699e-24, 6.605462596530754e-24,
      -4.940477452286254e-24, 3.5142143888515304e-24, -2.3231822788316162e-24,
      1.3547629337670647e-24, -5.902194615680502e-25, 7.153073619865331e-27,
      4.1854769428870825e-25, -7.11211540094972e-25, 8.9428404796846e-25,
      -9.895627044455887e-25, 1.0167093415527485e-24, -9.929858597125141e-25,
      9.331641661760664e-25, -8.495670737768972e-25, 7.522029948971912e-25,
      -6.489632999393539e-25, 5.458569450064811e-25, -4.472622452148311e-25,
      3.5618037777721054e-25, -2.7447929367039027e-25, 2.0312018880148979e-25,
      -1.4236155481892475e-25, 9.193813625783607e-26, -5.1213917976764967e-26,
      1.9309615601908948e-26, 4.7938945132904924e-27, -2.2174127643304625e-26,
      3.390506801987748e-26, -4.101214236717135e-26, 4.444144835116325e-26,
      -4.504070059879432e-26, 4.354954141352836e-26, -4.0597098636138007e-26,
      3.6704935446629466e-26, -3.229380773513053e-26, 2.7692910096512504e-26,
      -2.315054162316665e-26, 1.8845350913516732e-26, -1.489752222437339e-26,
      1.1379439761460917e-26, -8.325514650568804e-27, 5.7409802861073446e-27,
      -3.60955846467143e-27, 1.8999734479559408e-27, -5.713466044541444e-28,
      -4.224566229831832e-28, 1.1294302234897366e-27, -1.5968699895401822e-27,
      1.869537410547825e-27, -1.988428586479292e-27, 1.990037260411816e-27,
      -1.9060099035487093e-27, 1.7631016016149748e-27, -1.583353289080174e-27,
      1.384422886620017e-27, -1.1800145463054755e-27, 9.803610967775941e-28,
      -7.927246468526867e-28, 6.2188900445232365e-28, -4.7062504182942925e-28,
      3.4011639886534236e-28, -2.3033802378563374e-28, 1.4038409816505397e-28,
      -6.874499393158666e-29, 1.3535187478014178e-29, 2.732436488373108e-29,
      -5.596488381778258e-29, 7.446441173995205e-29, -8.477322434460326e-29,
      8.866488240205923e-29, -8.770808588356667e-29, 8.325491011330276e-29,
      -7.644149760094177e-29, 6.819780768981108e-29, -5.926355720150329e-29,
      5.020799543845163e-29, -4.145163002099299e-29, 3.3288445852219757e-29,
      -2.5907532581946423e-29, 1.9413354569038173e-29, -1.3844162601809388e-29,
      9.18826160393999e-30, -5.398017624871681e-30, 2.4016157615272554e-30,
      -1.1267379980527011e-31, -1.562120167681496e-30, 2.71713878975289e-30,
      -3.443488162932279e-30, 3.825990570941626e-30, -3.9412521806787445e-30,
      3.8566050317362654e-30, -3.629732191843067e-30, 3.308807386115846e-30,
      -2.933003998888743e-30, 2.533251770693609e-30, -2.1331418120112388e-30,
      1.749901079153225e-30, -1.3953758074421503e-30, 1.0769793749809772e-30,
      -7.985736340041143e-31, 5.6126396827334414e-31, -3.6409736717033923e-31,
      2.0465985536387084e-31, -7.957491593268578e-32, -1.5091659243779793e-32,
      8.351252121509048e-32, -1.2985563764781766e-31, 1.581071128511681e-31,
      -1.7194970678250607e-31, 1.7468719206512873e-31, -1.6920539213905062e-31,
      1.5796164939610825e-31, -1.4299548621791775e-31, 1.259542715268277e-31,
      -1.0812873620125347e-31, 9.049415349225804e-32, -7.375388943163802e-32,
      5.838281778468846e-32, -4.4668777419055644e-32, 3.2750826509720427e-32,
      -2.2653521967423704e-32, 1.4316831311307726e-32, -7.62157741283893e-33,
      2.4105347190925432e-33, 1.4945503337239313e-33, -4.279641250846754e-33,
      6.128364768607818e-33, -7.214781005167071e-33, 7.6985182784752e-33,
      -7.721841438805781e-33, 7.408256373735917e-33, -6.86229502272051e-33,
      6.170170874102587e-33, -5.40104148580213e-33, 4.6086598260395236e-33,
      -3.833238589871286e-33, 3.103390080526745e-33, -2.4380381677831672e-33,
      1.8482280160978444e-33, -1.3387837461336111e-33, 9.097841805292689e-34,
      -5.578426850258417e-34, 2.77189286330535e-34, -6.056220516813278e-35,
      -1.0007782774239735e-34, 2.1299313259765417e-34, -2.862550222894959e-34,
      3.274498908839438e-34, -3.4348554238605952e-34, 3.404789447721833e-34,
      -3.237081960744256e-34, 2.9761339491148585e-34, -2.6583315353375745e-34,
      2.3126555173016977e-34, -1.9614431267133582e-34, 1.621228230218684e-34,
      -1.3036027886874255e-34, 1.0160569437321207e-34, -7.627675437725146e-35,
      5.453152927592742e-35, -3.6331911945501527e-35, 2.1498299260942275e-35,
      -9.755544704410832e-36, 7.705751173585147e-37, 5.817684750270892e-36,
      -1.0375280963701861e-35, 1.3256214388124625e-35, -1.4790541817353093e-35,
      1.5276719912221755e-35, -1.497737239990083e-35, 1.4117736043639276e-35,
      -1.2886127528074805e-35, 1.1435864778265344e-35, -9.888167147897232e-36,
      8.335645604432167e-36, -6.846073937158291e-36, 5.466203534717245e-36,
      -4.22544662507734e-36, 3.139305854702733e-36, -2.2124719682180378e-36,
      1.4415467169228293e-36, -8.173757631608611e-37, 3.269971643820777e-37,
      4.477403075081042e-38, -3.1409451476624157e-37, 4.9713821563572745e-37,
      -6.093991690128454e-37, 6.652120153940709e-37, -6.774518017505212e-37,
      6.573774530320604e-37, -6.145867641455652e-37, 5.570546821844974e-37,
      -4.9123071668773095e-37, 4.221753181202302e-37, -3.5371884797385936e-37,
      2.886302251881359e-37, -2.2878541184551514e-37, 1.753285680949773e-37,
      -1.288209590280407e-37, 8.937455033832317e-38, -5.676871346398927e-38,
      3.0549611131224194e-38, -1.0112691765982544e-38, -5.230671450976477e-39,
      1.620096237561962e-38, -2.3511060535563197e-38, 2.783777641358955e-38,
      -2.980262836590437e-38, 2.996018507998315e-38, -2.879242681445536e-38,
      2.6707739248346917e-38, -2.404333027406281e-38, 2.1070040635155505e-38,
      -1.7998695107658557e-38, 1.4987305715609656e-38, -1.2148588178176156e-38,
      9.557385077292161e-39, -7.257703156435753e-39, 5.2691678032239626e-39,
      -3.592775979243028e-39, 2.2158910052112528e-39, -1.1164703721010478e-39,
      2.6655297352880926e-40, 3.6494327608112847e-40, -8.100467298004352e-40,
      1.1001048652347458e-39, -1.2646263017831221e-39, 1.3305146861876022e-39,
      -1.3216212782381439e-39, 1.258549209748916e-39, -1.1586497401396658e-39,
      1.0361587495232796e-39, -9.024297027148824e-40, 7.662270225821739e-40,
      -6.340509765187565e-40, 5.104716446949514e-40, -3.984552157635783e-40,
      2.996707148656358e-40, -2.147693232166162e-40, 1.4363174228683196e-40,
      -8.558165330959975e-41, 3.956530155567478e-41, -4.298677178423527e-42,
      -2.1615246255503543e-41, 3.9596138022272863e-41, -5.101940579304073e-41,
      5.716927838534485e-41, -5.920847951233e-41, 5.816130440039501e-41,
      -5.490719944720165e-41, 5.018227958395228e-41, -4.4586571876765023e-41,
      3.8595126760875967e-41, -3.257147531472374e-41, 2.6782222004842814e-41,
      -2.141184107882759e-41, 1.6576988046684418e-41, -1.2339844650983772e-41,
      8.720187339603939e-42, -5.706007732505221e-42, 3.2626219476492737e-42,
      -1.3402874216627086e-42, -1.1959527877409347e-43, 1.1795785332753116e-42,
      -1.9024206146354492e-42, 2.348343092696317e-42, -2.5731384924671597e-42,
      2.6269793004244937e-42, -2.5537896524918293e-42, 2.3910544446410068e-42,
      -2.169955751693427e-42, 1.9157422035623893e-42, -1.648252508569007e-42,
      1.3825290256175938e-42, -1.1294707650198783e-42, 8.964871983034874e-43,
      -6.881246661717237e-43, 5.066459756862168e-43, -3.5255103042135294e-43,
      2.2503214921448217e-43, -1.2236224099984403e-43, 4.221737344390398e-44,
      1.8062333878041012e-44, -6.126798340897888e-44, 9.016691712049447e-44,
      -1.0739066141300303e-43, 1.1535898855280611e-43, -1.1623357928732556e-43,
      1.118952658143184e-43, -1.0393945285835528e-43, 9.36849972011998e-44,
      -8.219252608648676e-44, 7.028885777343578e-44, -5.859482857012823e-44,
      4.755441379119267e-44, -3.746354596070041e-44, 2.8497478314557615e-44,
      -2.0735915445204084e-44, 1.4185438956514618e-44, -8.798999480835131e-45,
      4.492433840850226e-45, -1.1581046496877724e-45, -1.32414346796564e-45,
      3.078454475960853e-45, -4.226567266768463e-45, 4.883253934936241e-45,
      -5.153289900212305e-45, 5.129671360503021e-45, -4.89281909132333e-45,
      4.510535953869865e-45, -4.0385161142893556e-45, 3.5212349796913865e-45,
      -2.993078796574971e-45, 2.4796007401688158e-45, -1.9988155112852373e-45,
      1.562466600964323e-45, -1.1772193576517037e-45, 8.457488415541923e-46,
      -5.6770434249843975e-46, 3.4054261909415992e-46, -1.6022968525702138e-46,
      2.1816645168510702e-47, 8.010101737995152e-47, -1.5102884309416836e-46,
      1.9631036529197973e-46, -2.20942142823831e-46, 2.2945366678020034e-46,
      -2.2583973956901233e-46, 2.1353403197680938e-46, -1.9541381505201685e-46,
      1.73827233975498e-46, -1.5063586045316166e-46, 1.2726657020864603e-46,
      -1.0476800282607355e-46, 8.386794753193864e-47, -6.502894762297195e-47,
      4.850022461516146e-47, -3.436469425993741e-47, 2.258038874353465e-47,
      -1.301602429954008e-47, 5.480774638619118e-48, 2.5145766407122036e-49,
      -4.4228231202145145e-48, 7.276816900008755e-48, -9.04749026334057e-48,
      9.951983747793042e-48, -1.0185803531813196e-47, 9.920301404790744e-48,
      -9.301870340233628e-48, 8.452426181976439e-48, -7.470807032007322e-48,
      6.434782263443675e-48, -5.403420291371444e-48, 4.4196167136086244e-48,
      -3.512631215156938e-48, 2.7005222520123613e-48, -1.992402918660053e-48,
      1.390469772259957e-48, -8.917791485771553e-49, 4.8976320173323735e-49,
      -1.754911438511717e-49, -6.130941120900443e-50, 2.3144985534483636e-49,
      -3.45671952600608e-49, 4.142067723052731e-49, -4.464747595690431e-49,
      4.509016181177626e-49, -4.3482657043155735e-49, 4.044819423966176e-49,
      -3.65025659068774e-49, 3.2061095214509676e-49, -2.744802319732871e-49,
      2.2907257054813382e-49, -1.861365130806378e-49, 1.4684194730619053e-49,
      -1.1188649578863283e-49, 8.15933572461842e-50, -5.59987202840056e-50,
      3.492782683409688e-50, -1.8059498067006517e-50, 4.979480136942722e-51,
      4.776650850084639e-51, -1.1690038190890916e-50, 1.6233423788375066e-50,
      -1.8853180175451158e-50, 1.9957330382407853e-50, -1.9908449339508086e-50,
      1.9020430675741311e-50, -1.7558212065113016e-50, 1.573967083379201e-50,
      -1.373902179157659e-50, 1.1691165584601447e-50, -9.696544361455322e-51,
      7.826159676420065e-51, -6.126493922529829e-51, 4.6241506766123465e-51,
      -3.330091296971912e-51, 2.243395569664478e-51, -1.3545141018961276e-51,
      6.480106562135632e-52, -1.0481494518274874e-52, -2.959781836146643e-52,
      5.75717537779192e-52, -7.551615844423087e-52, 8.537493407543471e-52,
      -8.89124919628228e-52, 8.76867493688277e-52, -8.303826898290132e-52,
      7.60916410388671e-52, -6.776573827935234e-52, 5.8790005332552696e-52,
      -4.972445327552076e-52, 4.098150139061072e-52, -3.2848231471954935e-52,
      2.5507990329896534e-52, -1.9060591867779295e-52, 1.3540632505219835e-52,
      -8.933645981169572e-53, 5.189990160020578e-53, -2.236484602176278e-53,
      -1.4091114651667564e-55, 1.6554664901199847e-53, -2.7821070129739216e-53,
      3.4849707114940386e-53, -3.848562378349773e-53, 3.949060674610849e-53,
      -3.853308172424138e-53, 3.6184742219667134e-53, -3.292223132561713e-53,
      2.9132438212487414e-53, -2.512020505107118e-53, 2.111746258419011e-53,
      -1.7293016885587578e-53, 1.376239220494296e-53, -1.0597293322896072e-53,
      7.834385188391416e-54, -5.483198568299349e-54, 3.533059580924554e-54,
      -1.959010393625848e-54, 7.267404048772828e-55, 2.0341562857131478e-55,
      -8.73331379169669e-55, 1.3246989785476847e-54, -1.5972931117741095e-54,
      1.7277866255734558e-54, -1.7490192192763035e-54, 1.689628006706745e-54,
      -1.5739579094948463e-54, 1.422180046653426e-54, -1.250556805700368e-54,
      1.0718025812435312e-54, -8.95498866205544e-55, 7.285312261114377e-55,
      -5.755235303359845e-55, 4.392515909985349e-55, -3.2102406861173568e-55,
      2.2102318814530815e-55, -1.3860154616517153e-55, 7.253417539303387e-56,
      -2.1227174066096222e-56, -1.7114286437918692e-56, 4.435478388793931e-56,
      -6.232995412722214e-56, 7.277572699449523e-56, -7.728096694378109e-56,
      7.725921693615803e-56, -7.393558947831918e-56, 6.834526998515624e-56,
      -6.134055635717947e-56, 5.360382503244272e-56, -4.566426575963385e-56,
      3.791664948196543e-56, -3.0640776017293044e-56, 2.402058507638256e-56,
      -1.816220344396413e-56, 1.3110443335688498e-56, -8.863464404483275e-57,
      5.385468243367949e-57, -2.617413934214853e-57, 4.858310148743523e-58,
      1.0901329587134193e-57, -2.1932545902180405e-57, 2.904170335558101e-57,
      -3.298502886780575e-57, 3.4449792927457563e-57, -3.404353203119259e-57,
      3.2289599287538897e-57, -2.962752242822694e-57, 2.6416853887845086e-57,
      -2.294340379588824e-57, 1.942694463993693e-57, -1.6029659767290684e-57,
      1.2864772865180086e-57, -1.0004940018962689e-57, 7.490109255854339e-58,
      -5.334655079127009e-58, 3.533678592307726e-58, -2.0684291210555907e-58,
      9.108527757730183e-59, -2.73093050714922e-60, -6.184769830088945e-59,
      1.0631514499555654e-58, -1.3420602349333398e-58, 1.4880882865884078e-58,
      -1.5309169852809966e-58, 1.4966196747790155e-58, -1.4075210432991904e-58,
      1.2822550246106785e-58, -1.1359650567616936e-58, 9.805996284779406e-59,
      -8.252646922364366e-59, 6.7660247808476446e-59, -5.391733505076524e-59,
      4.158235367093838e-59, -3.080268031034559e-59, 2.1619249643139945e-59,
      -1.399358567289397e-59, 7.830923140591785e-60, -2.9994864349034087e-60,
      -6.53860316244032e-61, 3.2912807130744827e-60, -5.074581983740799e-60,
      6.158383774951242e-60, -6.685441954717392e-60, 6.783744878005457e-60,
      -6.565027128578817e-60, 6.124381057739938e-60, -5.540685887003113e-60,
      4.877614918874324e-60, -4.185021402178462e-60, 3.5005413226511845e-60,
      -2.851285836693564e-60, 2.2555266476453154e-60, -1.7243040757217605e-60,
      1.2629098791178636e-60, -8.72215210690999e-61, 5.498287335647743e-61,
      -2.91081240498238e-61, 8.984153831556334e-62, 6.082570466998488e-62,
      -1.68145577060499e-61, 2.3924523542890947e-61, -2.8087524643244707e-61,
      2.992224063788424e-61, -2.9979731496211467e-61, 2.8738130165949084e-61,
      -2.6601892702029193e-61, 2.3904405560633067e-61, -2.0912930591097152e-61,
      1.783504385541563e-61, -1.4825888646699228e-61, 1.1995712003094091e-61,
      -9.417285388134059e-62, 7.132923153682366e-62, -5.160907065522338e-62,
      3.501202444955647e-62, -2.1404127568382654e-62, 1.0559664574994472e-62,
      -2.1956445880299688e-63, -4.000594476265062e-63, 8.349976020040902e-63,
      -1.1165710807809405e-62, 1.274197286894447e-62, -1.33464526788981e-62,
      1.3216057958143908e-62, -1.2555094980194712e-62, 1.1535337478516763e-62,
      -1.0297469760732753e-62, 8.953470634027043e-63, -7.589581664252704e-63,
      6.26957467177536e-63, -5.038097651093668e-63, 3.923934655541816e-63,
      -2.9430633445137336e-63, 2.101434003831204e-63, -1.3974263776737594e-63,
      8.239662514873552e-64, -3.70303176548923e-64, 2.3464858605572122e-65,
      2.3058662130728657e-64, -4.060656259914491e-64, 5.167066778387448e-64,
      -5.753061896905029e-64, 5.93428284112376e-64, -5.812429235490743e-64,
      5.474675023245431e-64, -4.993864231697807e-64, 4.4292673168324856e-64,
      -3.827714114312701e-64, 3.2249530496761865e-64, -2.6471172301528417e-64,
      2.1122057464174737e-64, -1.6315126511054465e-64, 1.2109565832858348e-64,
      -8.522809798030998e-65, 5.541084835937841e-65, -3.1284383359174676e-65,
      1.234275534568386e-65, 2.0051482394772413e-66, -1.2387266955339617e-65,
      1.943152419798711e-65, -2.373894779770397e-65, 2.5865210801608196e-65,
      -2.630910577767787e-65, 2.5506571147124983e-65, -2.3829023929871824e-65,
      2.158490575132674e-65, -1.90235069951399e-65, 1.6340289322954064e-65,
      -1.3683073497984293e-65, 1.1158593594251663e-65, -8.839037903587933e-66,
      6.768300096630437e-66, -4.967751354628478e-66, 3.441415883583586e-66,
      -2.180489563789136e-66, 1.167185902569325e-66, -3.7792654002777545e-67,
      -2.140830448871143e-67, 6.368366505741628e-67, -9.180045258351494e-67,
      1.0838361957123038e-66, -1.1584208099426287e-66, 1.1632400006188488e-66,
      -1.1169532930435019e-66, 1.0353623704898885e-66, -9.315073574461225e-67,
      8.158552988679299e-67, -6.965478344354308e-67, 5.7968145652567816e-67,
      -4.695995417622612e-67, 3.6918046937602195e-67, -2.8011054913923065e-67,
      2.031341815675098e-67, -1.382766968992204e-67, 8.503772043429436e-68,
      -4.2554755745836104e-68, 9.738035783702563e-69, 1.4621361925098358e-68,
      -3.1767534919782647e-68, 4.291697930393953e-68, -4.921397088560812e-68,
      5.170110410111674e-68, -5.130215111930975e-68, 4.881464338942218e-68,
      -4.490986411707742e-68, 4.013824793933497e-68, -3.4938494412266437e-68,
      2.9649000845034407e-68, -2.452049780370846e-68, 1.972902108714204e-68,
      -1.5388573807368913e-68, 1.1563020264440233e-68, -8.27691013087722e-69,
      5.525058785441393e-69, -3.2808099860189576e-69, 1.5029834450940835e-69,
      -1.4156548236521953e-70, -8.577609887926879e-70, 1.550127221394788e-69,
      -1.9888980919956394e-69, 2.223865009316686e-69, -2.3000804872643384e-69,
      2.25721076082478e-69, -2.1292940734782515e-69, 1.9448052837255212e-69,
      -1.726941190357799e-69, 1.4940546742111733e-69, -1.260178826443171e-69,
      1.0355942894093025e-69, -8.27403834651151e-70, 6.400876210929109e-70,
      -4.7602058517137184e-70, 3.359400516939285e-70, -2.1935700646687415e-70,
      1.249086574515063e-70, -5.065306663397487e-71, -5.691096550985606e-72,
      4.655510485188372e-71, -7.437553410311001e-71, 9.148851015334009e-71,
      -1.0005685401212378e-70, 1.0202434812328016e-70, -9.909174774749782e-71,
      9.270968422022568e-71, -8.408419604959206e-71, 7.419123624705847e-71,
      -6.379710743881044e-71, 5.348234687265399e-71, -4.3667105797840934e-71,
      3.4636532524748246e-71, -2.656507142459941e-71, 1.9538930686961667e-71
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 2, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.010788853526797955, -0.039434363238027265, 0.06943411992380688, -0.08834865382184748,
      0.09836581028287145, -0.10146273140702443, 0.09937818515106599, -0.09360258285159911,
      0.08538132927902087, -0.07572775643231765, 0.06544249571036272, -0.05513671800848587,
      0.04525720078585275, -0.03611165484127374, 0.0278931562325224, -0.020702879302010768,
      0.01457061693415361, -0.00947280786788432, 0.0053479733850618286,
      -0.002109603024184124, -0.0003433725362397347, 0.0021183173346941715,
      -0.003322591259228971, 0.0040589546872753035, -0.004422412717766586,
      0.004498244813689144, -0.004360983656739059, 0.004074130248772984,
      -0.0036904183629685484, 0.003252468468280272, -0.0027936978094747246,
      0.002339378409601609, -0.0019077576968705829, 0.00151117684287163,
      -0.0011571395507481634, 0.0008492989337057293, -0.0005883423817368336,
      0.00037276411793504653, -0.00019952273914269192, 6.458669148264073e-05,
      3.662536862725071e-05, -0.00010889975659840662, 0.00015696741126975294,
      -0.00018531632038026313, 0.00019806507129676098, -0.0001988864113754726,
      0.0001909705671028048, -0.00017701914095674426, 0.00015926157850952157,
      -0.00013948739734448334, 0.00011908853566112204, -9.910727091472604e-05,
      8.028615067283574e-05, -6.311725381942775e-05, 4.788885413479508e-05,
      -3.472819085228475e-05, 2.363956776774771e-05, -1.4537412980067116e-05,
      7.274246588333193e-06, -1.6637359249867952e-06, -2.500820336145799e-06,
      5.432134455183207e-06, -7.338197143417971e-06, 8.414649488537155e-06,
      -8.839746385552449e-06, 8.771426317210667e-06, -8.346043342037261e-06,
      7.678366086895427e-06, -6.862501165880053e-06, 5.9734515086186885e-06,
      -5.069071188880231e-06, 4.192225838918666e-06, -3.373010559887087e-06,
      2.630914823200952e-06, -1.9768560098635116e-06, 1.4150300469597573e-06,
      -9.445493688647668e-07, 5.608555871639618e-07, -2.569073104532433e-07,
      2.4153062570430743e-08, 1.4669424171346004e-07, -2.6506075926336787e-07,
      3.4007054165482815e-07, -3.8023659486879074e-07, 3.932616432955353e-07,
      -3.859274620316822e-07, 3.64053565078239e-07, -3.325082630433984e-07,
      2.9525745525121715e-07, -2.5543886320456584e-07, 2.1545164737736316e-07,
      -1.7705341056750257e-07, 1.4145843726853882e-07, -1.0943262881917464e-07,
      8.138196332044942e-08, -5.7432444039121676e-08, 3.7500415073764197e-08,
      -2.1352838673418616e-08, 8.657668062689091e-09, 9.7516252059545e-10,
      -7.961348235359893e-09, 1.2717485496507572e-08, -1.5642992191828098e-08,
      1.710765248229078e-08, -1.74437984491458e-08, 1.694220943244887e-08,
      -1.5850899293718745e-08, 1.437606257682046e-08, -1.2684555252582622e-08,
      1.0907388857443724e-08, -9.143814388471841e-09, 7.465661626813028e-09,
      -5.92167903418976e-09, 4.541688260115885e-09, -3.3404255223440463e-09,
      2.320990071765744e-09, -1.4778583515365637e-09, 7.994522471490452e-10,
      -2.7027205296690037e-10, -1.2737945646664673e-10, 4.120450915686165e-10,
      -6.020906982079031e-10, 7.149667009031808e-10, -7.6670853096311e-10,
      7.716327292481648e-10, -7.421888205284365e-10, 6.889311777527524e-10,
      -6.205796333482149e-10, 5.441422437228524e-10, -4.650781435903561e-10,
      3.87482676682922e-10, -3.1428085276187757e-10, 2.474185967163756e-10,
      -1.880441987134541e-10, 1.3667484664865963e-10, -9.334514503383805e-11,
      5.773613286577363e-11, -2.9284550167217563e-11, 7.273016208835052e-12,
      9.097579626017418e-12, -2.0651763631808324e-11, 2.8197303827631375e-11,
      -3.249515810136062e-11, 3.423955304670758e-11, -3.4046306867852e-11,
      3.244766694480129e-11, -2.989212139879126e-11, 2.6747847664274454e-11,
      -2.330866690765395e-11, 1.9801571734567572e-11, -1.6395079449978417e-11,
      1.3207829991783568e-11, -1.0316994263692845e-11, 7.76618414639356e-12,
      -5.572660284882506e-12, 3.733718953583867e-12, -2.232206545878554e-12,
      1.041161498304592e-12, -1.2762086881680181e-13, -5.443455119961803e-13,
      1.0112943417453731e-12, -1.3086742911200232e-12, 1.4696079431782937e-12,
      -1.524102707248226e-12, 1.4986084885762484e-12, -1.4158472824284647e-12,
      1.2948484549942597e-12, -1.1511325790907953e-12, 9.969957820180159e-13,
      -8.418552512246192e-13, 6.92624567185325e-13, -5.540947282442581e-13,
      4.29303015098668e-13, -3.1987719082524353e-13, 2.2634696966781198e-13,
      -1.4841827055916865e-13, 8.520857723936122e-14, -3.544384580561965e-14,
      -2.3810723810470498e-15, 2.987549462520677e-14, -4.8655836819159314e-14,
      6.02744889812696e-14, -6.617066534588568e-14, 6.763939097551804e-14,
      -6.581504824658358e-14, 6.16662503883654e-14, -5.5999198514937855e-14,
      4.94670843303786e-14, -4.2583501080724996e-14, 3.573820467553404e-14,
      -2.9213914656802515e-14, 2.3203154508432057e-14, -1.78243996705421e-14,
      1.3137029110448005e-14, -9.154763857319021e-15, 5.857426298897049e-15,
      -3.2009708771524924e-15, 1.125824176393925e-15, 4.363654954990812e-16,
      -1.5574279055015453e-15, 2.3086550562823853e-15, -2.7578943275005545e-15,
      2.9675751624620405e-15, -2.9935013373119253e-15, 2.884253492689961e-15,
      -2.6810624815384746e-15, 2.4180316381786997e-15, -2.1226040977509795e-15,
      1.8161888921842378e-15, -1.514876081067743e-15, 1.2301862232955976e-15,
      -9.698128153942192e-16, 7.383278118804388e-16, -5.378300049550164e-16,
      3.6852395583271556e-16, -2.2922347158500667e-16, 1.1777847602955094e-16,
      -3.142771436851548e-17, -3.2917753125016755e-17, 7.845368989488522e-17,
      -1.0831697329465468e-16, 1.254672168946899e-16, -1.326079936260715e-16,
      1.3214032370198505e-16, -1.261416936854742e-16, 1.163646008852268e-16,
      -1.0424940539166576e-16, 9.09470704601452e-17, -7.734814364866743e-17,
      6.411505030334046e-17, -5.171542106569976e-17, 4.045474690683442e-17,
      -3.050714545201269e-17, 2.194343211494915e-17, -1.4756023039390118e-17,
      8.880460396519873e-18, -4.213551835937318e-18, 6.282630668734425e-19,
      2.0143960247618002e-18, -3.856187609912218e-18, 5.034826926961481e-18,
      -5.6791805368911466e-18, 5.906141903837436e-18, -5.8188644896277066e-18,
      5.50606091346087e-18, -5.042109898741387e-18, 4.487747987772354e-18,
      -3.891158277408345e-18, 3.289302201014002e-18, -2.7093716139205855e-18,
      2.1702664808369513e-18, -1.6840279765933447e-18, 1.2571777008137197e-18,
      -8.91931058195038e-19, 5.872668829313955e-19, -3.398463868450793e-19,
      1.447828332218308e-19, 3.7306497815171714e-21, -1.1192363355408307e-19,
      1.8606737180925024e-19, -2.3219503284636243e-19, 2.5590777948833024e-19,
      -2.622517843561201e-19, 2.556522637018651e-19, -2.3989193519504204e-19,
      2.181228089117188e-19, -1.9290179279916853e-19, 1.6624214833941699e-19,
      -1.396743072151319e-19, 1.1431091379943e-19, -9.091216601433338e-20,
      6.994857638442338e-20, -5.165916387444549e-20, 3.610382069839928e-20,
      -2.320918727390893e-20, 1.2807826758568603e-20, -4.6708338745265566e-21,
      -1.4657425965449361e-21, 5.880121997703739e-21, -8.849021811999261e-21,
      1.063621647181882e-20, -1.1484744217429638e-20, 1.1612109158987052e-20,
      -1.1207874001786742e-20, 1.0433100020000232e-20, -9.421158725785547e-21,
      8.279509551504849e-21, -7.092106208052255e-21, 5.922158688420268e-21,
      -4.81503649168356e-21, 3.801150580812587e-21, -2.8986964375750318e-21,
      2.116178335879271e-21, -1.4546659224336688e-21, 9.097588809986347e-22,
      -4.732545050930251e-22, 1.345271230808506e-22, 1.183617623491895e-22,
      -2.9779732979924563e-22, 4.1596039202811457e-22, -4.843611536047934e-22,
      5.135277603346619e-22, -5.128211162934343e-22, 4.9034975176910015e-22,
      -4.529613313321724e-22, 4.062904407062344e-22, -3.5484538768005393e-22,
      3.0211975067212635e-22, -2.5071720691186938e-22, 2.024807048188184e-22,
      -1.5861927547110367e-22, 1.1982769231866309e-22, -8.639579002275305e-23,
      5.830555843145564e-23, -3.5315160559120264e-23, 1.702981343224231e-23,
      -2.9600496473194365e-24, -7.431722269316918e-24, 1.4695187905602564e-23,
      -1.9365322375539145e-23, 2.19434639953893e-23, -2.2884946104192522e-23,
      2.2592043114320228e-23, -2.141109573280657e-23, 1.9632808308988153e-23,
      -1.7494847776607504e-23, 1.5186010526392416e-23, -1.2851354812323945e-23,
      1.059781785582509e-23, -8.499946087183699e-24, 6.605462596530754e-24,
      -4.940477452286254e-24, 3.5142143888515304e-24, -2.3231822788316162e-24,
      1.3547629337670647e-24, -5.902194615680502e-25, 7.153073619865331e-27,
      4.1854769428870825e-25, -7.11211540094972e-25, 8.9428404796846e-25,
      -9.895627044455887e-25, 1.0167093415527485e-24, -9.929858597125141e-25,
      9.331641661760664e-25, -8.495670737768972e-25, 7.522029948971912e-25,
      -6.489632999393539e-25, 5.458569450064811e-25, -4.472622452148311e-25,
      3.5618037777721054e-25, -2.7447929367039027e-25, 2.0312018880148979e-25,
      -1.4236155481892475e-25, 9.193813625783607e-26, -5.1213917976764967e-26,
      1.9309615601908948e-26, 4.7938945132904924e-27, -2.2174127643304625e-26,
      3.390506801987748e-26, -4.101214236717135e-26, 4.444144835116325e-26,
      -4.504070059879432e-26, 4.354954141352836e-26, -4.0597098636138007e-26,
      3.6704935446629466e-26, -3.229380773513053e-26, 2.7692910096512504e-26,
      -2.315054162316665e-26, 1.8845350913516732e-26, -1.489752222437339e-26,
      1.1379439761460917e-26, -8.325514650568804e-27, 5.7409802861073446e-27,
      -3.60955846467143e-27, 1.8999734479559408e-27, -5.713466044541444e-28,
      -4.224566229831832e-28, 1.1294302234897366e-27, -1.5968699895401822e-27,
      1.869537410547825e-27, -1.988428586479292e-27, 1.990037260411816e-27,
      -1.9060099035487093e-27, 1.7631016016149748e-27, -1.583353289080174e-27,
      1.384422886620017e-27, -1.1800145463054755e-27, 9.803610967775941e-28,
      -7.927246468526867e-28, 6.2188900445232365e-28, -4.7062504182942925e-28,
      3.4011639886534236e-28, -2.3033802378563374e-28, 1.4038409816505397e-28,
      -6.874499393158666e-29, 1.3535187478014178e-29, 2.732436488373108e-29,
      -5.596488381778258e-29, 7.446441173995205e-29, -8.477322434460326e-29,
      8.866488240205923e-29, -8.770808588356667e-29, 8.325491011330276e-29,
      -7.644149760094177e-29, 6.819780768981108e-29, -5.926355720150329e-29,
      5.020799543845163e-29, -4.145163002099299e-29, 3.3288445852219757e-29,
      -2.5907532581946423e-29, 1.9413354569038173e-29, -1.3844162601809388e-29,
      9.18826160393999e-30, -5.398017624871681e-30, 2.4016157615272554e-30,
      -1.1267379980527011e-31, -1.562120167681496e-30, 2.71713878975289e-30,
      -3.443488162932279e-30, 3.825990570941626e-30, -3.9412521806787445e-30,
      3.8566050317362654e-30, -3.629732191843067e-30, 3.308807386115846e-30,
      -2.933003998888743e-30, 2.533251770693609e-30, -2.1331418120112388e-30,
      1.749901079153225e-30, -1.3953758074421503e-30, 1.0769793749809772e-30,
      -7.985736340041143e-31, 5.6126396827334414e-31, -3.6409736717033923e-31,
      2.0465985536387084e-31, -7.957491593268578e-32, -1.5091659243779793e-32,
      8.351252121509048e-32, -1.2985563764781766e-31, 1.581071128511681e-31,
      -1.7194970678250607e-31, 1.7468719206512873e-31, -1.6920539213905062e-31,
      1.5796164939610825e-31, -1.4299548621791775e-31, 1.259542715268277e-31,
      -1.0812873620125347e-31, 9.049415349225804e-32, -7.375388943163802e-32,
      5.838281778468846e-32, -4.4668777419055644e-32, 3.2750826509720427e-32,
      -2.2653521967423704e-32, 1.4316831311307726e-32, -7.62157741283893e-33,
      2.4105347190925432e-33, 1.4945503337239313e-33, -4.279641250846754e-33,
      6.128364768607818e-33, -7.214781005167071e-33, 7.6985182784752e-33,
      -7.721841438805781e-33, 7.408256373735917e-33, -6.86229502272051e-33,
      6.170170874102587e-33, -5.40104148580213e-33, 4.6086598260395236e-33,
      -3.833238589871286e-33, 3.103390080526745e-33, -2.4380381677831672e-33,
      1.8482280160978444e-33, -1.3387837461336111e-33, 9.097841805292689e-34,
      -5.578426850258417e-34, 2.77189286330535e-34, -6.056220516813278e-35,
      -1.0007782774239735e-34, 2.1299313259765417e-34, -2.862550222894959e-34,
      3.274498908839438e-34, -3.4348554238605952e-34, 3.404789447721833e-34,
      -3.237081960744256e-34, 2.9761339491148585e-34, -2.6583315353375745e-34,
      2.3126555173016977e-34, -1.9614431267133582e-34, 1.621228230218684e-34,
      -1.3036027886874255e-34, 1.0160569437321207e-34, -7.627675437725146e-35,
      5.453152927592742e-35, -3.6331911945501527e-35, 2.1498299260942275e-35,
      -9.755544704410832e-36, 7.705751173585147e-37, 5.817684750270892e-36,
      -1.0375280963701861e-35, 1.3256214388124625e-35, -1.4790541817353093e-35,
      1.5276719912221755e-35, -1.497737239990083e-35, 1.4117736043639276e-35,
      -1.2886127528074805e-35, 1.1435864778265344e-35, -9.888167147897232e-36,
      8.335645604432167e-36, -6.846073937158291e-36, 5.466203534717245e-36,
      -4.22544662507734e-36, 3.139305854702733e-36, -2.2124719682180378e-36,
      1.4415467169228293e-36, -8.173757631608611e-37, 3.269971643820777e-37,
      4.477403075081042e-38, -3.1409451476624157e-37, 4.9713821563572745e-37,
      -6.093991690128454e-37, 6.652120153940709e-37, -6.774518017505212e-37,
      6.573774530320604e-37, -6.145867641455652e-37, 5.570546821844974e-37,
      -4.9123071668773095e-37, 4.221753181202302e-37, -3.5371884797385936e-37,
      2.886302251881359e-37, -2.2878541184551514e-37, 1.753285680949773e-37,
      -1.288209590280407e-37, 8.937455033832317e-38, -5.676871346398927e-38,
      3.0549611131224194e-38, -1.0112691765982544e-38, -5.230671450976477e-39,
      1.620096237561962e-38, -2.3511060535563197e-38, 2.783777641358955e-38,
      -2.980262836590437e-38, 2.996018507998315e-38, -2.879242681445536e-38,
      2.6707739248346917e-38, -2.404333027406281e-38, 2.1070040635155505e-38,
      -1.7998695107658557e-38, 1.4987305715609656e-38, -1.2148588178176156e-38,
      9.557385077292161e-39, -7.257703156435753e-39, 5.2691678032239626e-39,
      -3.592775979243028e-39, 2.2158910052112528e-39, -1.1164703721010478e-39,
      2.6655297352880926e-40, 3.6494327608112847e-40, -8.100467298004352e-40,
      1.1001048652347458e-39, -1.2646263017831221e-39, 1.3305146861876022e-39,
      -1.3216212782381439e-39, 1.258549209748916e-39, -1.1586497401396658e-39,
      1.0361587495232796e-39, -9.024297027148824e-40, 7.662270225821739e-40,
      -6.340509765187565e-40, 5.104716446949514e-40, -3.984552157635783e-40,
      2.996707148656358e-40, -2.147693232166162e-40, 1.4363174228683196e-40,
      -8.558165330959975e-41, 3.956530155567478e-41, -4.298677178423527e-42,
      -2.1615246255503543e-41, 3.9596138022272863e-41, -5.101940579304073e-41,
      5.716927838534485e-41, -5.920847951233e-41, 5.816130440039501e-41,
      -5.490719944720165e-41, 5.018227958395228e-41, -4.4586571876765023e-41,
      3.8595126760875967e-41, -3.257147531472374e-41, 2.6782222004842814e-41,
      -2.141184107882759e-41, 1.6576988046684418e-41, -1.2339844650983772e-41,
      8.720187339603939e-42, -5.706007732505221e-42, 3.2626219476492737e-42,
      -1.3402874216627086e-42, -1.1959527877409347e-43, 1.1795785332753116e-42,
      -1.9024206146354492e-42, 2.348343092696317e-42, -2.5731384924671597e-42,
      2.6269793004244937e-42, -2.5537896524918293e-42, 2.3910544446410068e-42,
      -2.169955751693427e-42, 1.9157422035623893e-42, -1.648252508569007e-42,
      1.3825290256175938e-42, -1.1294707650198783e-42, 8.964871983034874e-43,
      -6.881246661717237e-43, 5.066459756862168e-43, -3.5255103042135294e-43,
      2.2503214921448217e-43, -1.2236224099984403e-43, 4.221737344390398e-44,
      1.8062333878041012e-44, -6.126798340897888e-44, 9.016691712049447e-44,
      -1.0739066141300303e-43, 1.1535898855280611e-43, -1.1623357928732556e-43,
      1.118952658143184e-43, -1.0393945285835528e-43, 9.36849972011998e-44,
      -8.219252608648676e-44, 7.028885777343578e-44, -5.859482857012823e-44,
      4.755441379119267e-44, -3.746354596070041e-44, 2.8497478314557615e-44,
      -2.0735915445204084e-44, 1.4185438956514618e-44, -8.798999480835131e-45,
      4.492433840850226e-45, -1.1581046496877724e-45, -1.32414346796564e-45,
      3.078454475960853e-45, -4.226567266768463e-45, 4.883253934936241e-45,
      -5.153289900212305e-45, 5.129671360503021e-45, -4.89281909132333e-45,
      4.510535953869865e-45, -4.0385161142893556e-45, 3.5212349796913865e-45,
      -2.993078796574971e-45, 2.4796007401688158e-45, -1.9988155112852373e-45,
      1.562466600964323e-45, -1.1772193576517037e-45, 8.457488415541923e-46,
      -5.6770434249843975e-46, 3.4054261909415992e-46, -1.6022968525702138e-46,
      2.1816645168510702e-47, 8.010101737995152e-47, -1.5102884309416836e-46,
      1.9631036529197973e-46, -2.20942142823831e-46, 2.2945366678020034e-46,
      -2.2583973956901233e-46, 2.1353403197680938e-46, -1.9541381505201685e-46,
      1.73827233975498e-46, -1.5063586045316166e-46, 1.2726657020864603e-46,
      -1.0476800282607355e-46, 8.386794753193864e-47, -6.502894762297195e-47,
      4.850022461516146e-47, -3.436469425993741e-47, 2.258038874353465e-47,
      -1.301602429954008e-47, 5.480774638619118e-48, 2.5145766407122036e-49,
      -4.4228231202145145e-48, 7.276816900008755e-48, -9.04749026334057e-48,
      9.951983747793042e-48, -1.0185803531813196e-47, 9.920301404790744e-48,
      -9.301870340233628e-48, 8.452426181976439e-48, -7.470807032007322e-48,
      6.434782263443675e-48, -5.403420291371444e-48, 4.4196167136086244e-48,
      -3.512631215156938e-48, 2.7005222520123613e-48, -1.992402918660053e-48,
      1.390469772259957e-48, -8.917791485771553e-49, 4.8976320173323735e-49,
      -1.754911438511717e-49, -6.130941120900443e-50, 2.3144985534483636e-49,
      -3.45671952600608e-49, 4.142067723052731e-49, -4.464747595690431e-49,
      4.509016181177626e-49, -4.3482657043155735e-49, 4.044819423966176e-49,
      -3.65025659068774e-49, 3.2061095214509676e-49, -2.744802319732871e-49,
      2.2907257054813382e-49, -1.861365130806378e-49, 1.4684194730619053e-49,
      -1.1188649578863283e-49, 8.15933572461842e-50, -5.59987202840056e-50,
      3.492782683409688e-50, -1.8059498067006517e-50, 4.979480136942722e-51,
      4.776650850084639e-51, -1.1690038190890916e-50, 1.6233423788375066e-50,
      -1.8853180175451158e-50, 1.9957330382407853e-50, -1.9908449339508086e-50,
      1.9020430675741311e-50, -1.7558212065113016e-50, 1.573967083379201e-50,
      -1.373902179157659e-50, 1.1691165584601447e-50, -9.696544361455322e-51,
      7.826159676420065e-51, -6.126493922529829e-51, 4.6241506766123465e-51,
      -3.330091296971912e-51, 2.243395569664478e-51, -1.3545141018961276e-51,
      6.480106562135632e-52, -1.0481494518274874e-52, -2.959781836146643e-52,
      5.75717537779192e-52, -7.551615844423087e-52, 8.537493407543471e-52,
      -8.89124919628228e-52, 8.76867493688277e-52, -8.303826898290132e-52,
      7.60916410388671e-52, -6.776573827935234e-52, 5.8790005332552696e-52,
      -4.972445327552076e-52, 4.098150139061072e-52, -3.2848231471954935e-52,
      2.5507990329896534e-52, -1.9060591867779295e-52, 1.3540632505219835e-52,
      -8.933645981169572e-53, 5.189990160020578e-53, -2.236484602176278e-53,
      -1.4091114651667564e-55, 1.6554664901199847e-53, -2.7821070129739216e-53,
      3.4849707114940386e-53, -3.848562378349773e-53, 3.949060674610849e-53,
      -3.853308172424138e-53, 3.6184742219667134e-53, -3.292223132561713e-53,
      2.9132438212487414e-53, -2.512020505107118e-53, 2.111746258419011e-53,
      -1.7293016885587578e-53, 1.376239220494296e-53, -1.0597293322896072e-53,
      7.834385188391416e-54, -5.483198568299349e-54, 3.533059580924554e-54,
      -1.959010393625848e-54, 7.267404048772828e-55, 2.0341562857131478e-55,
      -8.73331379169669e-55, 1.3246989785476847e-54, -1.5972931117741095e-54,
      1.7277866255734558e-54, -1.7490192192763035e-54, 1.689628006706745e-54,
      -1.5739579094948463e-54, 1.422180046653426e-54, -1.250556805700368e-54,
      1.0718025812435312e-54, -8.95498866205544e-55, 7.285312261114377e-55,
      -5.755235303359845e-55, 4.392515909985349e-55, -3.2102406861173568e-55,
      2.2102318814530815e-55, -1.3860154616517153e-55, 7.253417539303387e-56,
      -2.1227174066096222e-56, -1.7114286437918692e-56, 4.435478388793931e-56,
      -6.232995412722214e-56, 7.277572699449523e-56, -7.728096694378109e-56,
      7.725921693615803e-56, -7.393558947831918e-56, 6.834526998515624e-56,
      -6.134055635717947e-56, 5.360382503244272e-56, -4.566426575963385e-56,
      3.791664948196543e-56, -3.0640776017293044e-56, 2.402058507638256e-56,
      -1.816220344396413e-56, 1.3110443335688498e-56, -8.863464404483275e-57,
      5.385468243367949e-57, -2.617413934214853e-57, 4.858310148743523e-58,
      1.0901329587134193e-57, -2.1932545902180405e-57, 2.904170335558101e-57,
      -3.298502886780575e-57, 3.4449792927457563e-57, -3.404353203119259e-57,
      3.2289599287538897e-57, -2.962752242822694e-57, 2.6416853887845086e-57,
      -2.294340379588824e-57, 1.942694463993693e-57, -1.6029659767290684e-57,
      1.2864772865180086e-57, -1.0004940018962689e-57, 7.490109255854339e-58,
      -5.334655079127009e-58, 3.533678592307726e-58, -2.0684291210555907e-58,
      9.108527757730183e-59, -2.73093050714922e-60, -6.184769830088945e-59,
      1.0631514499555654e-58, -1.3420602349333398e-58, 1.4880882865884078e-58,
      -1.5309169852809966e-58, 1.4966196747790155e-58, -1.4075210432991904e-58,
      1.2822550246106785e-58, -1.1359650567616936e-58, 9.805996284779406e-59,
      -8.252646922364366e-59, 6.7660247808476446e-59, -5.391733505076524e-59,
      4.158235367093838e-59, -3.080268031034559e-59, 2.1619249643139945e-59,
      -1.399358567289397e-59, 7.830923140591785e-60, -2.9994864349034087e-60,
      -6.53860316244032e-61, 3.2912807130744827e-60, -5.074581983740799e-60,
      6.158383774951242e-60, -6.685441954717392e-60, 6.783744878005457e-60,
      -6.565027128578817e-60, 6.124381057739938e-60, -5.540685887003113e-60,
      4.877614918874324e-60, -4.185021402178462e-60, 3.5005413226511845e-60,
      -2.851285836693564e-60, 2.2555266476453154e-60, -1.7243040757217605e-60,
      1.2629098791178636e-60, -8.72215210690999e-61, 5.498287335647743e-61,
      -2.91081240498238e-61, 8.984153831556334e-62, 6.082570466998488e-62,
      -1.68145577060499e-61, 2.3924523542890947e-61, -2.8087524643244707e-61,
      2.992224063788424e-61, -2.9979731496211467e-61, 2.8738130165949084e-61,
      -2.6601892702029193e-61, 2.3904405560633067e-61, -2.0912930591097152e-61,
      1.783504385541563e-61, -1.4825888646699228e-61, 1.1995712003094091e-61,
      -9.417285388134059e-62, 7.132923153682366e-62, -5.160907065522338e-62,
      3.501202444955647e-62, -2.1404127568382654e-62, 1.0559664574994472e-62,
      -2.1956445880299688e-63, -4.000594476265062e-63, 8.349976020040902e-63,
      -1.1165710807809405e-62, 1.274197286894447e-62, -1.33464526788981e-62,
      1.3216057958143908e-62, -1.2555094980194712e-62, 1.1535337478516763e-62,
      -1.0297469760732753e-62, 8.953470634027043e-63, -7.589581664252704e-63,
      6.26957467177536e-63, -5.038097651093668e-63, 3.923934655541816e-63,
      -2.9430633445137336e-63, 2.101434003831204e-63, -1.3974263776737594e-63,
      8.239662514873552e-64, -3.70303176548923e-64, 2.3464858605572122e-65,
      2.3058662130728657e-64, -4.060656259914491e-64, 5.167066778387448e-64,
      -5.753061896905029e-64, 5.93428284112376e-64, -5.812429235490743e-64,
      5.474675023245431e-64, -4.993864231697807e-64, 4.4292673168324856e-64,
      -3.827714114312701e-64, 3.2249530496761865e-64, -2.6471172301528417e-64,
      2.1122057464174737e-64, -1.6315126511054465e-64, 1.2109565832858348e-64,
      -8.522809798030998e-65, 5.541084835937841e-65, -3.1284383359174676e-65,
      1.234275534568386e-65, 2.0051482394772413e-66, -1.2387266955339617e-65,
      1.943152419798711e-65, -2.373894779770397e-65, 2.5865210801608196e-65,
      -2.630910577767787e-65, 2.5506571147124983e-65, -2.3829023929871824e-65,
      2.158490575132674e-65, -1.90235069951399e-65, 1.6340289322954064e-65,
      -1.3683073497984293e-65, 1.1158593594251663e-65, -8.839037903587933e-66,
      6.768300096630437e-66, -4.967751354628478e-66, 3.441415883583586e-66,
      -2.180489563789136e-66, 1.167185902569325e-66, -3.7792654002777545e-67,
      -2.140830448871143e-67, 6.368366505741628e-67, -9.180045258351494e-67,
      1.0838361957123038e-66, -1.1584208099426287e-66, 1.1632400006188488e-66,
      -1.1169532930435019e-66, 1.0353623704898885e-66, -9.315073574461225e-67,
      8.158552988679299e-67, -6.965478344354308e-67, 5.7968145652567816e-67,
      -4.695995417622612e-67, 3.6918046937602195e-67, -2.8011054913923065e-67,
      2.031341815675098e-67, -1.382766968992204e-67, 8.503772043429436e-68,
      -4.2554755745836104e-68, 9.738035783702563e-69, 1.4621361925098358e-68,
      -3.1767534919782647e-68, 4.291697930393953e-68, -4.921397088560812e-68,
      5.170110410111674e-68, -5.130215111930975e-68, 4.881464338942218e-68,
      -4.490986411707742e-68, 4.013824793933497e-68, -3.4938494412266437e-68,
      2.9649000845034407e-68, -2.452049780370846e-68, 1.972902108714204e-68,
      -1.5388573807368913e-68, 1.1563020264440233e-68, -8.27691013087722e-69,
      5.525058785441393e-69, -3.2808099860189576e-69, 1.5029834450940835e-69,
      -1.4156548236521953e-70, -8.577609887926879e-70, 1.550127221394788e-69,
      -1.9888980919956394e-69, 2.223865009316686e-69, -2.3000804872643384e-69,
      2.25721076082478e-69, -2.1292940734782515e-69, 1.9448052837255212e-69,
      -1.726941190357799e-69, 1.4940546742111733e-69, -1.260178826443171e-69,
      1.0355942894093025e-69, -8.27403834651151e-70, 6.400876210929109e-70,
      -4.7602058517137184e-70, 3.359400516939285e-70, -2.1935700646687415e-70,
      1.249086574515063e-70, -5.065306663397487e-71, -5.691096550985606e-72,
      4.655510485188372e-71, -7.437553410311001e-71, 9.148851015334009e-71,
      -1.0005685401212378e-70, 1.0202434812328016e-70, -9.909174774749782e-71,
      9.270968422022568e-71, -8.408419604959206e-71, 7.419123624705847e-71,
      -6.379710743881044e-71, 5.348234687265399e-71, -4.3667105797840934e-71,
      3.4636532524748246e-71, -2.656507142459941e-71, 1.9538930686961667e-71
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_3_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<3>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 3, "order");
    static_assert(design.b().size() == 4, "b.size");
    static_assert(design.a().size() == 4, "a.size");

    static_assert(almost_equal(design.b()[0], 0.06596879012328873), "design.b()[0] == 0.06596879012328873");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.06596879012328873));
    static_assert(almost_equal(design.b()[1], -0.19478531739279117), "design.b()[1] == -0.19478531739279117");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.19478531739279117));
    static_assert(almost_equal(design.b()[2], 0.19478531739279117), "design.b()[2] == 0.19478531739279117");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.19478531739279117));
    static_assert(almost_equal(design.b()[3], -0.06596879012328871), "design.b()[3] == -0.06596879012328871");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.06596879012328871));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], 0.9499102822725822), "design.a()[1] == 0.9499102822725822");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - 0.9499102822725822));
    static_assert(almost_equal(design.a()[2], 0.5750230432489347), "design.a()[2] == 0.5750230432489347");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.5750230432489347));
    static_assert(almost_equal(design.a()[3], 0.10360454594419265), "design.a()[3] == 0.10360454594419265");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - 0.10360454594419265));
    std::cout << "max_deviation(cheby2,highpass,3,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.06596879012328873, -0.2574497494399851, 0.40140590709818924, -0.3060635167813667,
      0.08658819973560314, 0.05215507685054668, -0.06762328220824786, 0.02527474896141957,
      0.009472698553772148, -0.016525697373803595, 0.00763233101692987,
      0.0012712124524760608, -0.0038841666151741487, 0.0021678891632702924,
      4.248171158821156e-05, -0.0008845227201995413, 0.0005911860913234272,
      -5.7354098932723904e-05, -0.0001938238022489707, 0.00015584558465647462,
      -3.0644025310721414e-05, -4.0424700608018396e-05, 3.98745484211745e-05,
      -1.145724885198018e-05, -7.857242938845377e-06, 9.920673476143365e-06,
      -3.718630930737362e-06, -1.3582040091943742e-06, 2.400643557313369e-06,
      -1.1141303273304704e-06, -1.8138540068718518e-07, 5.642328828350853e-07,
      -3.16240865211548e-07, -5.254107770621886e-09, 1.2837962407619067e-07,
      -8.616390065520034e-08, 8.571082515559849e-09, 2.8103756300315253e-08,
      -2.269764522802473e-08, 4.512415998667413e-09, 5.853601767757556e-09,
      -5.80356045962891e-09, 1.6793990412755527e-09, 1.1354428265419931e-09,
      -1.4429867171289716e-09, 5.438087550997529e-10, 1.9554404690270934e-10,
      -3.48951882461302e-10, 1.6268958907656942e-10, 2.5855607726362863e-11,
      -8.195776891063162e-11, 4.612957615434004e-11, 6.298884923996115e-13,
      -1.8632709385082607e-11, 1.255796804161125e-11, -1.2799650238443538e-12,
      -4.074835667659563e-12, 3.3056751056112416e-12, -6.643601711958738e-13,
      -8.475853023244159e-13, 8.446694328796388e-13, -2.4614836557791097e-13,
      -1.6407183401046112e-13, 2.0988291135678538e-13, -7.952276061638133e-14,
      -2.814943456523859e-14, 5.072203341830252e-14, -2.3755888046489933e-14,
      -3.683966309372061e-15, 1.1904587274722533e-14, -6.7287063454709384e-15,
      -7.206900262168277e-17, 2.704250927273941e-15, -1.8302298587369215e-15,
      1.9101424011995256e-16, 5.90805263026167e-16, -4.814294503390287e-16,
      9.779820113658424e-17, 1.2272339977894128e-16, -1.2293415896075785e-16,
      3.6075300597698887e-17, 2.3706973120210028e-17, -3.0527088944095633e-17,
      1.162837470781739e-17, 4.0517166992600665e-18, -7.37260557695975e-18,
      3.468730896230844e-18, 5.246586818498539e-19, -1.729143419508483e-18,
      9.814639923042147e-19, 7.637548820832506e-21, -3.9247227899972114e-19,
      2.667375554796186e-19, -2.8487427134787415e-20, -8.565782868839771e-20,
      7.011295595190031e-20, -1.4394365495318472e-20, -1.776866906402066e-20,
      1.7891712332765642e-20, -5.286805651383667e-21, -3.4252409354847714e-21,
      4.440043926201949e-21, -1.70031381365108e-21, -5.831114640559642e-22,
      1.0716144640752024e-21, -5.064748288162964e-22, -7.468436424888168e-23,
      2.5115401294219284e-22, -1.4315545424263123e-22, -6.968672505884132e-25,
      5.695894885005662e-23, -3.8873620616690527e-23, 4.2459424400184e-24,
      1.2418757214334289e-23, -1.021073610106311e-23, 2.118312706612256e-24,
      2.5725618231831553e-24, -2.6039028692260274e-24, 7.747249548677002e-25,
      4.948558520207372e-25, -6.457771888572332e-25, 2.48611846573357e-25,
      8.390849918618776e-26, -1.5575763431869854e-25, 7.394914034471219e-26,
      1.0625878157488753e-26, -3.647889166570283e-26, 2.088008237546987e-26,
      4.110907503835364e-29, -8.266199436332242e-27, 5.665237720666222e-27,
      -6.324714934504712e-28, -1.8004352207079077e-27, 1.4869932299326995e-27,
      -3.1169149709717953e-28, -3.7244314083354324e-28, 3.7895810384604907e-28,
      -1.1352015508316843e-28, -7.14888770826329e-29, 9.392294217408617e-29,
      -3.634941273104702e-29, -1.2072602481838895e-29, 2.2638795382517631e-29,
      -1.0796835491738728e-29, -1.511027468241397e-30, 5.298287614467299e-30,
      -3.0454210314433225e-30, 2.7885982944131897e-33, 1.199611668703234e-30,
      -8.256075039414443e-31, 9.415979320059952e-32, 2.6101476146230295e-31,
      -2.1654796600189445e-31, 4.5856254420717723e-32, 5.391842699299523e-32,
      -5.51507174808435e-32, 1.6632979215096033e-32, 1.0326901275316619e-32,
      -1.3660110988898658e-32, 5.314421427396442e-33, 1.7367411161014254e-33,
      -3.290413429567032e-33, 1.576333168815825e-33, 2.14754183715026e-34,
      -7.695233138397047e-34, 4.441742217826178e-34, -1.6815323100299757e-36,
      -1.7408699438706405e-34, 1.2031547723653307e-34, -1.4010661249534633e-35,
      -3.7839096679867214e-35, 3.153496968859967e-35, -6.7454712345712e-36,
      -7.80543932415233e-36, 8.026102253167086e-36, -2.4369080983482125e-36,
      -1.4916706863952294e-36, 1.986690953960555e-36, -7.769583902117518e-37,
      -2.4980845041919147e-37, 4.782343794526071e-37, -2.3013771775351575e-37,
      -3.050431274759125e-38, 1.1176359542349646e-37, -6.478139197570925e-38,
      4.302530443489687e-40, 2.526287481202649e-38, -1.7533223257361536e-38,
      2.0836777266192857e-39, 5.4853518238080256e-39, -4.5922331723114486e-39,
      9.921273251942802e-40, 1.1299005614758184e-39, -1.1680240024278971e-39,
      3.570102493733501e-40, 2.1545017507365607e-40, -2.8893486026215794e-40,
      1.1358549454689715e-40, 3.592655589943489e-41, -6.950631659389636e-41,
      3.359819372031168e-41, 4.330309500836441e-42, -1.6231970750024124e-41,
      9.44796256467705e-42, -8.959931773858396e-44, -3.6659789139024525e-42,
      2.555020865658386e-42, -3.0973534352006664e-43, -7.95163005326623e-43,
      6.68726698010715e-43, -1.4590332564042145e-43, -1.63555689629847e-43,
      1.6997787972531093e-43, -5.229919751360873e-44, -3.1116539251178507e-44,
      4.202068324768784e-44, -1.6604717377867248e-44, -5.166054468545667e-45,
      1.0101849569220004e-44, -4.904926209214468e-45, -6.143297142780836e-46,
      2.357406170216717e-45, -1.3778979659238213e-45, 1.6963926689487699e-47,
      5.319708773906289e-46, -3.723227619364025e-46, 4.602016712845517e-47,
      1.1526453648470665e-46, -9.737929424612622e-47, 2.1453929817109267e-47,
      2.3674099632448695e-47, -2.4735837112755973e-47, 7.660948539777323e-48,
      4.493718200933853e-48, -6.111105895602164e-48, 2.4273017159195263e-48,
      7.427382177669168e-49, -1.468150738134273e-48, 7.160403996148028e-49,
      8.709531146632945e-50, -3.4236537097325404e-49, 2.009495346496886e-49,
      -3.039521859875803e-51, -7.719273107913383e-50, 5.425467878358119e-50,
      -6.834569813919851e-51, -1.6707944509830164e-50, 1.4180052058503957e-50,
      -3.154231652761481e-51, -3.4266006038797757e-51, 3.599601175963546e-51,
      -1.1221311236995112e-51, -6.4891833052768936e-52, 8.887304027815649e-52,
      -3.548132689696774e-52, -1.0676879936507822e-52, 2.133700762038494e-52,
      -1.0452764175380065e-52, -1.2339095894128934e-53, 4.972072686550774e-53,
      -2.9305426357110218e-53, 5.2534857572069086e-55, 1.120096810280257e-53,
      -7.905826917607402e-54, 1.0145830124448754e-54, 2.4217986033952303e-54,
      -2.0648203982911417e-54, 4.636887119955362e-55, 4.9594728921651716e-55,
      -5.238123439625751e-55, 1.6435335350926633e-55, 9.370083398075457e-56,
      -1.2924501110269539e-55, 5.186327170357479e-56, 1.534557218632364e-56,
      -3.100912244413402e-56, 1.5258555918927224e-56, 1.746829757666758e-57,
      -7.220666757320576e-57, 4.273662476606773e-57, -8.852566029525576e-59,
      -1.6252690673512484e-57, 1.1519932327175415e-57, -1.5055139082085186e-58,
      -3.510270765681862e-58, 3.0066301249688754e-58, -6.815642075156705e-59,
      -7.177767468157852e-59, 7.6223808803215615e-59, -2.407064777827313e-59,
      -1.3528997286191735e-59, 1.8795377668233107e-59, -7.580608780987974e-60,
      -2.205211417938058e-60, 4.5064911622406543e-60, -2.2273293806980575e-60,
      -2.471032540867203e-61, 1.0485986699812924e-60, -6.23223144275541e-61,
      1.4638694979144358e-62, 2.358226330836541e-61, -1.6785918001027847e-61,
      2.233107757633836e-62, 5.087807949879464e-62, -4.377952091763162e-62,
      1.0016947811826662e-62, 1.0387831301609792e-62, -1.109172619240894e-62,
      3.5251010607221885e-63, 1.9532418610647594e-63, -2.7332656113853333e-63,
      1.1079815344827989e-63, 3.1684292155828616e-64, -6.549085202629711e-64,
      3.2512043256474866e-64, 3.4925881477428217e-65, -1.522766946118062e-64,
      9.088205651388396e-65, -2.385671697216455e-66, -3.421654483488396e-65,
      2.4458669762427946e-65, -3.3110737246591856e-66, -7.374086152798417e-66,
      6.374634573346892e-66, -1.4720191763594718e-66, -1.5032867730254864e-66,
      1.613991388880536e-66, -5.162146023081736e-67, -2.8197733807665858e-67,
      3.974716193928498e-67, -1.619367316228281e-67, -4.551583966423445e-68,
      9.5173449681972e-68, -4.745620026102906e-68, -4.932146185406899e-69,
      2.2113103030074153e-68, -1.325268815165854e-68, 3.8431370905145334e-70,
      4.96451952950152e-69, -3.563798647665023e-69, 4.907592039169907e-70,
      1.0687423383010413e-69, -9.281814464631117e-70, 2.1629274350134737e-70,
      2.1754045430852646e-70, -2.3485340864408953e-70, 7.558998215005964e-71,
      4.070424048163916e-71, -5.779947737464804e-71, 2.3666975854684452e-71,
      6.537383310402914e-72, -1.3830695496956566e-71, 6.926767530210712e-72,
      6.958582855128502e-73, -3.211130958458323e-72, 1.9325071613293298e-72,
      -6.1328208820620075e-74, -7.202920879374696e-73, 5.1926146686100256e-73,
      -7.271337689684606e-74, -1.5489058982528782e-73, 1.351461826699875e-73,
      -3.177765379868363e-74, -3.147887992262756e-74, 3.4173236015943027e-74,
      -1.1068117545910557e-74, -5.875324448074051e-75, 8.404951138323936e-75,
      -3.458795271285129e-75, -9.387850677305723e-76, 2.0098574251814562e-75,
      -1.0110142738832551e-75, -9.807907815684249e-77, 4.662924634049732e-76,
      -2.8179260074502584e-76, 9.71021592392697e-78, 1.0450338594794027e-76,
      -7.565744430480774e-77, 1.076990674618098e-77, 2.244730286050609e-77,
      -1.967741318468005e-77, 4.668249410775548e-78, 4.554905276678307e-78,
      -4.972432881568521e-78, 1.6205377676483872e-78, 8.479891066012778e-79,
      -1.2221934795358252e-78, 5.054657968151464e-79, 1.3478672995483641e-79,
      -2.920649809376281e-79, 1.4756149846684344e-79, 1.3809391547719214e-80,
      -6.770968520164166e-80, 4.10893657817915e-80, -1.5272975471746233e-81,
      -1.516150532152322e-80, 1.102325599821101e-80, -1.5946543177096479e-81,
      -3.2530468028737316e-81, 2.865006152941913e-81, -6.857084945098125e-82,
      -6.59052570468118e-82, 7.235113369376536e-82, -2.3725792634248464e-82,
      -1.223811046908954e-82, 1.7772078099324463e-82, -7.386584225309778e-83,
      -1.93483824867219e-83, 4.2441108054349505e-83, -2.1536642104991527e-83,
      -1.9421569488214539e-84, 9.831848610708716e-84, -5.9912950634310045e-84,
      2.3886956482454285e-85, 2.199603853523088e-84, -1.6060564168284811e-84,
      2.3603862965677086e-85, 4.7141496860834024e-85, -4.1713483122154184e-85,
      1.0071152033823275e-85, 9.535449760758726e-86, -1.0527259786728578e-85,
      3.4734318417901454e-86, 1.766052395510278e-86, -2.5842227074706873e-86,
      1.0793955696685372e-86, 2.7768759886468526e-87, -6.167184105351959e-87,
      3.1432010337284353e-87, 2.7281701540040405e-88, -1.4276164030762521e-87,
      8.735815140667478e-88, -3.717681693265844e-89, -3.191073108549791e-88,
      2.339938260302979e-88, -3.492739708570943e-89, -6.831298027206844e-89,
      6.0732436438497055e-89, -1.4790190914867721e-89, -1.379566069479745e-89,
      1.5317184033536769e-89, -5.084796798403067e-90, -2.548339852613892e-90,
      3.75763966110489e-90, -1.5772583503591806e-90, -3.984558752134e-91,
      8.96148678599798e-91, -4.587283990556595e-91, -3.827347730827598e-92,
      2.0729069273833446e-91, -1.273730815581585e-91, 5.761381119491327e-93,
      4.6293403720458836e-92, -3.409107681976089e-92, 5.16678524024921e-93,
      9.898965241855848e-93, -8.84215890509963e-93, 2.171822104247665e-93,
      1.995831175209505e-93, -2.228620452262231e-93, 7.443299237246578e-94,
      3.67684284068581e-94, -5.463787299496086e-94, 2.304678738340777e-94,
      5.716279367188028e-95, -1.302165434255342e-94, 6.694659052079051e-95,
      5.361933099839925e-96, -3.0098161744776174e-95, 1.857134711668073e-95,
      -8.894976633004872e-97, -6.7157031785171096e-96, 4.966721169682229e-96,
      -7.640994274699365e-97, -1.434375840621062e-96, 1.2873282461615203e-96,
      -3.188830024128456e-97, -2.8872530525333174e-97, 3.2425515227552353e-97,
      -1.089518708623295e-97, -5.3046427892287086e-98, 7.944487582206558e-98,
      -3.36746769066785e-98, -8.198861344135128e-99, 1.8921047601886187e-98,
      -9.769913856386223e-99, -7.500574375773903e-100, 4.370106324647057e-99,
      -2.7077011330346634e-99, 1.3687066972304984e-100, 9.742128077218184e-100,
      -7.235884057716331e-100, 1.1296882971767634e-100, 2.078368786242923e-100,
      -1.8741902006673057e-100, 4.6816175500192087e-101, 4.176624335686628e-101,
      -4.717710125066373e-101, 1.5947092600138285e-101, 7.652440420812634e-102,
      -1.1551315404074113e-101, 4.920192409079507e-102, 1.1757035618715842e-102,
      -2.7492681272682656e-102, 1.4257471222096556e-102, 1.047524402489266e-103,
      -6.345061931975371e-103, 3.947750068765134e-103, -2.0997985052021327e-104,
      -1.413207978998218e-103, 1.0541591895315851e-103, -1.6697463339037648e-104,
      -3.011401331082487e-104, 2.7285468649765097e-104, -6.872562540947816e-105,
      -6.0415067206282285e-105, 6.863872591224691e-105, -2.334028848780786e-105,
      -1.1038393426917908e-105, 1.6795403100240528e-105, -7.18863552792011e-106,
      -1.6855572608624045e-106, 3.9946791393743366e-106, -2.080577203331579e-106,
      -1.460394823448801e-107, 9.212373226436326e-107, -5.755594811669925e-107,
      3.21275346572227e-108, 2.049973143971201e-107, -1.535725508245901e-107,
      2.467340688014833e-108, 4.363157896261699e-108, -3.972304860224696e-108,
      1.0087891876933603e-108, 8.738646146785978e-109, -9.986211701059357e-109,
      3.4159308171427927e-109, 1.592110569930821e-109, -2.4419842059025786e-109,
      1.0502596799368356e-109, 2.415948279249901e-110, -5.804162636933282e-110,
      3.0360910643054737e-110, 2.032099186051208e-111, -1.3375158799348886e-110,
      8.391168650757371e-111, -4.903675783828117e-112, -2.9735828748366074e-111,
      2.237246387226392e-111, -3.6450036285797023e-112, -6.3214887993485775e-112,
      5.782919327792727e-112, -1.4806138578537526e-112, -1.263926566332094e-112,
      1.4528671966280843e-112, -4.9990826177648407e-113, -2.2961558077549447e-113,
      3.550493249567671e-113, -1.5343798598037278e-113, -3.4620004778210566e-114,
      8.433155205963151e-114, -4.4303235048502316e-114, -2.821697321091604e-115,
      1.9418608182221414e-114, -1.2233378047954235e-114, 7.468050918234384e-116,
      4.31322035518552e-115, -3.2591689236902858e-115, 5.383445749874602e-116,
      9.158489493202466e-116, -8.418701532993318e-116, 2.1729191970986755e-116,
      1.828007942356874e-116, -2.1137064002050012e-116, 7.315604463739957e-117,
      3.311231638157903e-117, -5.162118203491989e-117, 2.2415847875547103e-117,
      4.959738303112711e-118, -1.2252746348079807e-117, 6.464662188244509e-118,
      3.9091097430187864e-119, -2.819219857041049e-118, 1.7834547214121963e-118,
      -1.1350575005060611e-119, -6.256232891274001e-119, 4.7478040036772526e-119,
      -7.949126479330162e-120, -1.326826841142307e-119, 1.2255654710948375e-119,
      -3.188646705788111e-120, -2.6437026523037923e-120, 3.075084123726028e-120,
      -1.0705057892778974e-120, -4.774601617006309e-121, 7.5051711936230785e-121,
      -3.274640672638637e-121, -7.103611015795896e-122, 1.7802033058955848e-121,
      -9.432917623507863e-122, -5.4018738932286706e-123, 4.092903002101147e-122,
      -2.599977302194563e-122, 1.7219750223461604e-123, 9.074313256054427e-123,
      -6.916264105645891e-123, 1.1734867246578356e-123, 1.922164023430132e-123,
      -1.784108875400132e-123, 4.6787619978023445e-124, 3.823183711404114e-124,
      -4.473659581585242e-124, 1.566415490940473e-124, 6.884039534262349e-125,
      -1.0911555266505155e-124, 4.783639523412904e-125, 1.0171495557401806e-125,
      -2.5864170492341277e-125, 1.376372915547701e-125, 7.443730016148606e-127,
      -5.941903353434337e-126, 3.790258553344251e-126, -2.6079465015586722e-127,
      -1.3161462893227368e-126, 1.007495810167917e-126, -1.7319667346382361e-127,
      -2.7845326714319757e-127, 2.5971655389435386e-127, -6.864641723209389e-128,
      -5.52860413234696e-128, 6.508223522383043e-128, -2.2919455813364816e-128,
      -9.9244730102727e-129, 1.5863758760607196e-128, -6.987787076351958e-129,
      -1.4560355257684095e-129, 3.75768418414014e-129, -2.0082423577417223e-129,
      -1.022530306926081e-130, 8.6260367367899e-130, -5.525352126437597e-130,
      3.9435769067696405e-131, 1.908903750085758e-130, -1.4676004612554964e-130,
      2.5556787528877667e-131, 4.033664246705083e-131, -3.7806925230739804e-131,
      1.0070888744221089e-131, 7.99435290459407e-132, -9.467941796036206e-132,
      3.3533682724079834e-132, 1.430634399855429e-132, -2.306316544925623e-132,
      1.0207218565722522e-132, 2.083707440509935e-133, -5.45927222135108e-133,
      2.9301247782491846e-133, 1.3997010819053242e-134, -1.252242892390126e-133,
      8.05458114598202e-134, -5.954596563254103e-135, -2.7685559496568535e-134,
      2.137791564938059e-134, -3.770343939919494e-135, -5.842955817939291e-135,
      5.503469212665299e-135, -1.4773429853320426e-135, -1.15592153839386e-135,
      1.3773435852727348e-135, -4.906118639093619e-136, -2.0620831973809835e-136,
      3.3529347348723734e-136, -1.49094563090202e-136, -2.981089565943553e-137,
      7.931255763195472e-137, -4.2750987552157314e-137, -1.9084012952962076e-138,
      1.8178471456111729e-137, -1.1741345577590645e-137, 8.97903963240277e-139,
      4.0152437775184304e-138, -3.1139800422433324e-138, 5.561170321705552e-139,
      8.463514850764425e-139, -8.011155979761629e-139, 2.1670008458973168e-139,
      1.6712842930078084e-139, -2.0036533778883638e-139, 7.177528267669815e-140,
      2.971934223724726e-140, -4.874439040377936e-140, 2.177724545930509e-140,
      4.2636593716775024e-141, -1.1522371399742953e-140, 6.237295053773983e-141,
      2.590238693135053e-142, -2.638867763206851e-141, 1.7115308062548593e-141,
      -1.3522698972599435e-142, -5.823174484316681e-142, 4.5358559492207674e-142,
      -8.200953830311304e-143, -1.2258973064727309e-142, 1.1661309032463889e-142,
      -3.178349258010679e-143, -2.4162894291627394e-143, 2.914717609134195e-143,
      -1.0500066941818814e-143, -4.282790653790339e-144, 7.086267381559637e-144,
      -3.1807602654449256e-144, -6.0961357236989976e-145, 1.67391913378289e-144,
      -9.099899222244359e-145, -3.4974553208238377e-146, 3.830622303108791e-145,
      -2.494844845946452e-145, 2.0341790461583655e-146, 8.444946321598382e-146,
      -6.606868495106609e-146, 1.2091433867587234e-146, 1.7755890634054268e-146,
      -1.697434007849372e-146, 4.6613263916980256e-147, 3.4932038335993757e-147,
      -4.239981530406171e-147, 1.5359947489839468e-147, 6.1711808028631065e-148,
      -1.0301578235459216e-147, 4.645643538384945e-148, 8.713379173155573e-149,
      -2.431754596690556e-148, 1.32759952503405e-148, 4.693991976611191e-150,
      -5.5604820069797106e-149, 3.6365902178152204e-149, -3.0566104547039817e-150,
      -1.2246813905509103e-149, 9.623323116593946e-150, -1.7824146377469264e-150,
      -2.571672959059413e-150, 2.4707680538126103e-150, -6.835705090398256e-151,
      -5.049809010300325e-151, 6.16772542274333e-151, -2.2468191302699965e-151,
      -8.891244786424237e-152, 1.4975568664686891e-151, -6.784969264000785e-152,
      -1.2450116201977092e-152, 3.5326260223499022e-152, -1.936813751485387e-152,
      -6.255320504328952e-154, 8.07136355209038e-153, -5.300748793790017e-153,
      4.5882371413222193e-154, 1.7759813831337317e-153, -1.4016755134336623e-153,
      2.62699540366229e-154, 3.724549800350659e-154, -3.596371492500361e-154,
      1.002359632674325e-154, 7.299644677470978e-155, -8.971802044897374e-155,
      3.286452969726832e-155, 1.2808810747717993e-155, -2.1769888142781392e-155,
      9.909164577244628e-156, 1.7783189887927206e-156, -5.131782087587806e-156,
      2.825523677867248e-156, 8.265702750656394e-158, -1.1715820312806445e-156,
      7.726310248365455e-157, -6.880713365618678e-158, -2.5753881506913193e-157,
      2.0415636940009564e-157, -3.871074944864296e-158, -5.3940685897110234e-158,
      5.23468571675946e-158, -1.4697070888875052e-158, -1.0551250086107687e-158,
      1.3050523008535275e-158, -4.806930704096835e-159, -1.8450410800500196e-159,
      3.1646259046777943e-159, -1.4471496766467951e-159, -2.5391581727104016e-160,
      7.454720268221864e-160, -4.121928122864668e-160, -1.0810569894063242e-161,
      1.7005514597288852e-160, -1.1261575575487293e-160, 1.0309260965251711e-161,
      3.7345295414427285e-161, -2.9735238481412373e-161, 5.703317057761423e-162,
      7.81166543252291e-162, -7.61921416578533e-162, 2.154792674919429e-162,
      1.525039948499185e-162, -1.898321345360758e-162, 7.030555360646061e-163,
      2.6573776294631048e-163, -4.60025446289425e-163, 2.113378147942824e-163,
      3.6241628520909035e-164, -1.0828968150931233e-163, 6.0130152062728895e-164,
      1.3960150277556892e-165, -2.4683008775990216e-164, 1.6414145922041881e-164,
      -1.543300666241999e-165, -5.415243052150224e-165, 4.330848366678371e-165,
      -8.401348899097595e-166, -1.131241039640383e-165, 1.108978837835783e-165,
      -3.1589894181983215e-166, -2.204110189719337e-166, 2.761246151762803e-166,
      -1.0282362981817393e-166, -3.826920976804857e-167, 6.6870507009710505e-167,
      -3.0862309246103987e-167, -5.170793455110863e-168, 1.5730240339103024e-167,
      -8.77151611593153e-168, -1.7737961309718674e-169, 3.5825942013107823e-168,
      -2.392376759668524e-168, 2.308463969900712e-169, 7.852153532870718e-169,
      -6.307650276930738e-169, 1.2373652730767224e-169, 1.63813946071094e-169,
      -1.6140978195447404e-169, 4.630835101309046e-170, 3.1853695745163914e-170,
      -4.016373487375635e-170, 1.503757998480572e-170, 5.510533522965245e-171,
      -9.720321945216236e-171, 4.506788360034706e-171, 7.374481795172239e-172,
      -2.2849472248671407e-171, 1.27952140521915e-171, 2.2063783904524097e-173,
      -5.199819877892136e-172, 3.486848184175386e-172, -3.450357754722321e-173,
      -1.1385400458979834e-172, 9.186610951215677e-173, -1.822115832744245e-173,
      -2.372087176351194e-173, 2.3492539341929504e-173, -6.787961972527715e-174,
      -4.603206444203199e-174, 5.841933812076271e-174, -2.199099500148102e-174,
      -7.933862186087158e-175, 1.412927713815966e-174, -6.581025003665851e-175,
      -1.0512924306436554e-175, 3.31901717243032e-175, -1.8664270589653694e-175,
      -2.6654425731974686e-177, 7.546926133886779e-176, -5.0819303643055694e-176,
      5.153366709182617e-177, 1.650807605749076e-176, -1.3379384916501401e-176,
      2.6827789519153765e-177, 3.4347435956481243e-177, -3.419192876483914e-177,
      9.949216601140342e-178, 6.651733276309832e-178, -8.497139387394604e-178,
      3.215836094104029e-178, 1.1421453717233604e-178, -2.0537732218159939e-178,
      9.60965155017455e-179, 1.498047938553959e-179, -4.8209797979269876e-179,
      2.7224826105814093e-179, 3.08556732695111e-181, -1.0953249342636272e-179,
      7.406561196313835e-180, -7.691657463814283e-181, -2.393498483096911e-180,
      1.9485434381926996e-180, -3.9493559772224667e-181, -4.973266690611091e-181,
      4.97634827712614e-181, -1.4581702164957047e-181, -9.611310112866191e-182,
      1.2358974019847038e-181, -4.702461077189006e-182, -1.644003302946195e-182,
      2.985233229261238e-182, -1.4031676123632073e-182, -2.1336833782946886e-183,
      7.00250755409929e-183, -3.971091384188795e-183, -3.33633688499378e-185,
      1.5896696442644384e-183, -1.0794357148524845e-183, 1.1472700466610774e-184,
      3.470230466641113e-184, -2.837769844645008e-184, 5.8130187818852427e-185,
      7.200667690941297e-185, -7.242549466790297e-185, 2.1369671878402824e-185,
      1.3886838240511064e-185, -1.7975693699816292e-185, 6.8760491383353095e-186,
      2.3660687473542264e-186, -4.339076148929022e-186, 2.048799048924388e-186,
      3.037580109200917e-187, -1.0171015077866196e-186, 5.792224293162377e-187,
      3.1767521718567503e-189, -2.30707533682356e-187, 1.573146759511083e-187,
      -1.7101806086195082e-188, -5.031203299335275e-188, 4.1327334470887855e-188,
      -8.554856774550123e-189, -1.0425267889496567e-188, 1.0540609217799431e-188,
      -3.1315417571562593e-189, -2.006304329590259e-189, 2.6144627513216136e-189,
      -1.005391866959108e-189, -3.404820064951856e-190, 6.306806236564509e-190,
      -2.9914184182269976e-190, -4.322249644262629e-191, 1.4772956639459425e-190,
      -8.448344797768968e-191, -2.181618117041414e-193, 3.3481708859586756e-191,
      -2.2926302177363296e-191, 2.547778606595256e-192, 7.294133709280035e-192,
      -6.0185348913400105e-192, 1.2588117684226988e-192, 1.5093325958415874e-192,
      -1.5340287514485223e-192, 4.588700400704387e-193, 2.8984279352861426e-193,
      -3.802531444533431e-193, 1.469990644352244e-193, 4.898936651834013e-194,
      -9.166739798914035e-194, 4.3676017951811497e-194, 6.147046543052869e-195,
      -2.1456700329949317e-194, 1.232221284833342e-194, -3.761529166172256e-198,
      -4.858971521232784e-195, 3.3411127080577936e-195, -3.7934701289519176e-196,
      -1.0574596309134641e-195, 8.764705852285558e-196, -1.8520269091102524e-196,
      -2.185072179202622e-196, 2.2325173098273714e-196, -6.723458867580769e-197,
      -4.186972155461103e-197, 5.530402259284676e-197, -2.1491995972160764e-197,
      -7.047725924254903e-198, 1.332335210187524e-197, -6.376715862829713e-198,
      -8.737500623432211e-199, 3.1163828847648443e-198, -1.797200974265269e-198,
      5.712192916285829e-201, 7.051344690021457e-199, -4.869009341350894e-199,
      5.64518263642739e-200, 1.5329995010005134e-199, -1.2763714966398858e-199,
      2.7244171191154853e-200, 3.1632212161550794e-200, -3.2490000875869247e-200,
      9.850715015317046e-201, 6.047962719808469e-201, -8.043298312162046e-201,
      3.1421149851205e-201, 1.0137581092965551e-201, -1.936445503214841e-201,
      9.309778251004378e-202, 1.2412542910272819e-202, -4.52617166476459e-202,
      2.6211718352819596e-202, -1.5824660220759567e-204, -1.0232702379516525e-202,
      7.095491470162146e-203, -8.396455749852861e-204, -2.2223286495644282e-203,
      1.858703216571692e-203, -4.007200153923386e-204, -4.57905766479135e-204,
      4.728225358341802e-204, -1.4431620587154288e-204, -8.73552865948051e-205,
      1.16978264700386e-204, -4.593573871796297e-205, -1.4579962426535992e-205,
      2.8144284495982367e-205, -1.3591579512491e-205, -1.76228060261837e-206,
      6.573604062378725e-206, -3.822832711210165e-206, 3.3954568384468425e-208,
      1.4849078416934626e-206, -1.0339910390309127e-206, 1.2482464603818875e-207,
      3.221532564953502e-207, -2.706675665407184e-207
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 3, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.06596879012328873, -0.2574497494399851, 0.40140590709818924, -0.3060635167813666,
      0.08658819973560301, 0.05215507685054679, -0.06762328220824788, 0.025274748961419537,
      0.009472698553772184, -0.01652569737380361, 0.007632331016929865,
      0.0012712124524760708, -0.0038841666151741535, 0.002167889163270291,
      4.248171158821471e-05, -0.0008845227201995431, 0.0005911860913234272,
      -5.7354098932723084e-05, -0.00019382380224897133, 0.00015584558465647473,
      -3.064402531072121e-05, -4.042470060801859e-05, 3.987454842117455e-05,
      -1.1457248851980134e-05, -7.857242938845435e-06, 9.920673476143387e-06,
      -3.718630930737354e-06, -1.358204009194389e-06, 2.400643557313376e-06,
      -1.1141303273304687e-06, -1.8138540068718918e-07, 5.642328828350874e-07,
      -3.1624086521154785e-07, -5.25410777062293e-09, 1.2837962407619133e-07,
      -8.616390065520036e-08, 8.571082515559593e-09, 2.8103756300315445e-08,
      -2.269764522802476e-08, 4.512415998667356e-09, 5.8536017677576084e-09,
      -5.803560459628924e-09, 1.6793990412755417e-09, 1.1354428265420063e-09,
      -1.4429867171289765e-09, 5.438087550997509e-10, 1.9554404690271265e-10,
      -3.489518824613035e-10, 1.6268958907656906e-10, 2.5855607726363754e-11,
      -8.195776891063211e-11, 4.6129576154340025e-11, 6.298884923998247e-13,
      -1.8632709385082755e-11, 1.2557968041611264e-11, -1.2799650238443037e-12,
      -4.074835667659603e-12, 3.305675105611249e-12, -6.643601711958625e-13,
      -8.47585302324427e-13, 8.44669432879642e-13, -2.461483655779087e-13,
      -1.6407183401046404e-13, 2.098829113567865e-13, -7.952276061638094e-14,
      -2.814943456523931e-14, 5.072203341830286e-14, -2.3755888046489877e-14,
      -3.683966309372241e-15, 1.1904587274722633e-14, -6.728706345470937e-15,
      -7.206900262172458e-17, 2.70425092727397e-15, -1.830229858736925e-15,
      1.910142401199433e-16, 5.908052630261749e-16, -4.814294503390304e-16,
      9.779820113658237e-17, 1.227233997789433e-16, -1.229341589607585e-16,
      3.607530059769853e-17, 2.3706973120210546e-17, -3.052708894409585e-17,
      1.162837470781733e-17, 4.051716699260196e-18, -7.372605576959817e-18,
      3.4687308962308385e-18, 5.246586818498839e-19, -1.7291434195085015e-18,
      9.814639923042152e-19, 7.637548820839632e-21, -3.924722789997264e-19,
      2.667375554796194e-19, -2.8487427134785826e-20, -8.565782868839914e-20,
      7.011295595190069e-20, -1.4394365495318153e-20, -1.776866906402103e-20,
      1.7891712332765768e-20, -5.286805651383605e-21, -3.4252409354848654e-21,
      4.44004392620199e-21, -1.7003138136510702e-21, -5.831114640559869e-22,
      1.071614464075214e-21, -5.064748288162953e-22, -7.468436424888714e-23,
      2.511540129421962e-22, -1.4315545424263134e-22, -6.968672505896945e-25,
      5.695894885005756e-23, -3.887362061669067e-23, 4.245942440018115e-24,
      1.2418757214334549e-23, -1.0210736101063178e-23, 2.1183127066121988e-24,
      2.5725618231832225e-24, -2.6039028692260513e-24, 7.747249548676895e-25,
      4.948558520207543e-25, -6.457771888572408e-25, 2.486118465733554e-25,
      8.390849918619191e-26, -1.557576343187008e-25, 7.394914034471209e-26,
      1.0625878157489723e-26, -3.647889166570346e-26, 2.0880082375469918e-26,
      4.110907503857175e-29, -8.266199436332414e-27, 5.665237720666254e-27,
      -6.324714934504238e-28, -1.800435220707953e-27, 1.4869932299327116e-27,
      -3.1169149709716957e-28, -3.7244314083355494e-28, 3.789581038460532e-28,
      -1.135201550831666e-28, -7.14888770826358e-29, 9.392294217408745e-29,
      -3.6349412731046735e-29, -1.2072602481839607e-29, 2.263879538251801e-29,
      -1.0796835491738707e-29, -1.5110274682415638e-30, 5.2982876144674056e-30,
      -3.045421031443329e-30, 2.7885982943750043e-33, 1.199611668703263e-30,
      -8.256075039414492e-31, 9.415979320059129e-32, 2.6101476146231057e-31,
      -2.165479660018964e-31, 4.585625442071597e-32, 5.391842699299722e-32,
      -5.515071748084417e-32, 1.6632979215095693e-32, 1.0326901275317121e-32,
      -1.3660110988898871e-32, 5.3144214273963885e-33, 1.736741116101548e-33,
      -3.290413429567096e-33, 1.5763331688158203e-33, 2.147541837150547e-34,
      -7.695233138397227e-34, 4.441742217826187e-34, -1.68153231002339e-36,
      -1.7408699438706899e-34, 1.2031547723653384e-34, -1.40106612495332e-35,
      -3.783909667986852e-35, 3.15349696886e-35, -6.745471234570906e-36,
      -7.805439324152668e-36, 8.026102253167204e-36, -2.4369080983481584e-36,
      -1.491670686395314e-36, 1.986690953960592e-36, -7.769583902117436e-37,
      -2.4980845041921185e-37, 4.7823437945261795e-37, -2.301377177535151e-37,
      -3.050431274759603e-38, 1.1176359542349948e-37, -6.478139197570944e-38,
      4.3025304434788285e-40, 2.526287481202731e-38, -1.7533223257361663e-38,
      2.0836777266190456e-39, 5.485351823808243e-39, -4.592233172311503e-39,
      9.921273251942312e-40, 1.129900561475874e-39, -1.1680240024279162e-39,
      3.570102493733412e-40, 2.154501750736698e-40, -2.8893486026216385e-40,
      1.1358549454689573e-40, 3.5926555899438235e-41, -6.950631659389809e-41,
      3.3598193720311544e-41, 4.330309500837221e-42, -1.6231970750024606e-41,
      9.447962564677073e-42, -8.959931773840936e-44, -3.6659789139025825e-42,
      2.5550208656584064e-42, -3.0973534352002936e-43, -7.951630053266567e-43,
      6.687266980107234e-43, -1.4590332564041385e-43, -1.6355568962985561e-43,
      1.6997787972531384e-43, -5.229919751360731e-44, -3.1116539251180623e-44,
      4.202068324768874e-44, -1.6604717377867026e-44, -5.166054468546175e-45,
      1.0101849569220267e-44, -4.904926209214448e-45, -6.143297142782025e-46,
      2.357406170216791e-45, -1.3778979659238254e-45, 1.696392668946094e-47,
      5.319708773906491e-46, -3.7232276193640576e-46, 4.602016712844945e-47,
      1.1526453648471188e-46, -9.737929424612754e-47, 2.145392981710809e-47,
      2.3674099632450027e-47, -2.473583711275642e-47, 7.660948539777102e-48,
      4.493718200934184e-48, -6.111105895602304e-48, 2.4273017159194908e-48,
      7.42738217766997e-49, -1.4681507381343138e-48, 7.160403996147988e-49,
      8.709531146634836e-50, -3.423653709732655e-49, 2.0094953464968898e-49,
      -3.039521859871492e-51, -7.719273107913695e-50, 5.425467878358164e-50,
      -6.834569813918916e-51, -1.6707944509830988e-50, 1.4180052058504157e-50,
      -3.154231652761292e-51, -3.4266006038799834e-51, 3.5996011759636134e-51,
      -1.122131123699475e-51, -6.489183305277413e-52, 8.887304027815863e-52,
      -3.5481326896967155e-52, -1.067687993650908e-52, 2.1337007620385576e-52,
      -1.0452764175380002e-52, -1.2339095894131892e-53, 4.972072686550953e-53,
      -2.930542635711028e-53, 5.253485757200209e-55, 1.1200968102803056e-53,
      -7.905826917607474e-54, 1.0145830124447317e-54, 2.4217986033953572e-54,
      -2.0648203982911718e-54, 4.636887119955065e-55, 4.959472892165496e-55,
      -5.238123439625857e-55, 1.643533535092607e-55, 9.370083398076269e-56,
      -1.2924501110269876e-55, 5.186327170357389e-56, 1.5345572186325604e-56,
      -3.100912244413502e-56, 1.5258555918927133e-56, 1.7468297576672177e-57,
      -7.220666757320857e-57, 4.2736624766067835e-57, -8.852566029515219e-59,
      -1.6252690673513243e-57, 1.1519932327175527e-57, -1.5055139082082936e-58,
      -3.510270765682062e-58, 3.0066301249689235e-58, -6.8156420751562455e-59,
      -7.177767468158363e-59, 7.622380880321731e-59, -2.4070647778272277e-59,
      -1.3528997286192993e-59, 1.8795377668233634e-59, -7.580608780987835e-60,
      -2.205211417938363e-60, 4.5064911622408097e-60, -2.2273293806980437e-60,
      -2.471032540867916e-61, 1.0485986699813359e-60, -6.232231442755426e-61,
      1.463869497912819e-62, 2.358226330836659e-61, -1.678591800102802e-61,
      2.2331077576334836e-62, 5.087807949879778e-62, -4.377952091763239e-62,
      1.0016947811825953e-62, 1.0387831301610578e-62, -1.1091726192409198e-62,
      3.5251010607220546e-63, 1.9532418610649554e-63, -2.7332656113854154e-63,
      1.1079815344827777e-63, 3.168429215583331e-64, -6.549085202629952e-64,
      3.251204325647465e-64, 3.4925881477439214e-65, -1.522766946118129e-64,
      9.088205651388421e-65, -2.385671697213967e-66, -3.421654483488578e-65,
      2.445866976242821e-65, -3.311073724658646e-66, -7.374086152798893e-66,
      6.374634573347007e-66, -1.472019176359362e-66, -1.5032867730256076e-66,
      1.6139913888805757e-66, -5.162146023081529e-67, -2.8197733807668855e-67,
      3.9747161939286234e-67, -1.6193673162282487e-67, -4.551583966424165e-68,
      9.517344968197568e-68, -4.745620026102875e-68, -4.932146185408579e-69,
      2.211310303007519e-68, -1.325268815165859e-68, 3.8431370905107653e-70,
      4.964519529501799e-69, -3.5637986476650665e-69, 4.907592039169104e-70,
      1.0687423383011137e-69, -9.281814464631298e-70, 2.1629274350133128e-70,
      2.175404543085447e-70, -2.3485340864409568e-70, 7.558998215005665e-71,
      4.0704240481643665e-71, -5.779947737464997e-71, 2.3666975854684e-71,
      6.53738331040399e-72, -1.3830695496957127e-71, 6.926767530210672e-72,
      6.958582855131005e-73, -3.2111309584584797e-72, 1.932507161329339e-72,
      -6.132820882056428e-74, -7.202920879375115e-73, 5.1926146686100935e-73,
      -7.271337689683406e-74, -1.548905898252988e-73, 1.3514618266999033e-73,
      -3.177765379868121e-74, -3.1478879922630354e-74, 3.4173236015943993e-74,
      -1.1068117545910117e-74, -5.875324448074739e-75, 8.404951138324237e-75,
      -3.458795271285062e-75, -9.387850677307377e-76, 2.0098574251815439e-75,
      -1.0110142738832499e-75, -9.807907815688078e-77, 4.662924634049976e-76,
      -2.817926007450275e-76, 9.710215923918472e-78, 1.0450338594794679e-76,
      -7.565744430480886e-77, 1.076990674617917e-77, 2.244730286050778e-77,
      -1.9677413184680498e-77, 4.66824941077519e-78, 4.554905276678731e-78,
      -4.972432881568671e-78, 1.6205377676483215e-78, 8.479891066013828e-79,
      -1.2221934795358717e-78, 5.054657968151368e-79, 1.3478672995486146e-79,
      -2.920649809376415e-79, 1.475614984668428e-79, 1.3809391547724951e-80,
      -6.770968520164536e-80, 4.108936578179178e-80, -1.5272975471733424e-81,
      -1.5161505321524213e-80, 1.1023255998211186e-80, -1.5946543177093773e-81,
      -3.2530468028739867e-81, 2.865006152941981e-81, -6.857084945097584e-82,
      -6.590525704681821e-82, 7.235113369376763e-82, -2.3725792634247484e-82,
      -1.2238110469091123e-82, 1.7772078099325168e-82, -7.386584225309637e-83,
      -1.934838248672566e-83, 4.244110805435154e-83, -2.153664210499144e-83,
      -1.9421569488223207e-84, 9.83184861070928e-84, -5.99129506343105e-84,
      2.3886956482435083e-85, 2.199603853523238e-84, -1.6060564168285081e-84,
      2.3603862965673006e-85, 4.71414968608379e-85, -4.1713483122155236e-85,
      1.0071152033822463e-85, 9.535449760759702e-86, -1.052725978672893e-85,
      3.473431841790001e-86, 1.7660523955105168e-86, -2.5842227074707944e-86,
      1.0793955696685163e-86, 2.7768759886474214e-87, -6.167184105352268e-87,
      3.143201033728422e-87, 2.7281701540053576e-88, -1.4276164030763374e-87,
      8.735815140667543e-88, -3.7176816932629194e-89, -3.191073108550018e-88,
      2.3399382603030187e-88, -3.4927397085703154e-89, -6.831298027207434e-89,
      6.073243643849864e-89, -1.4790190914866472e-89, -1.3795660694798941e-89,
      1.5317184033537302e-89, -5.084796798402842e-90, -2.5483398526142578e-90,
      3.757639661105053e-90, -1.5772583503591472e-90, -3.984558752134874e-91,
      8.96148678599845e-91, -4.587283990556572e-91, -3.827347730829615e-92,
      2.0729069273834743e-91, -1.2737308155815944e-91, 5.761381119486844e-93,
      4.62934037204623e-92, -3.40910768197615e-92, 5.16678524024826e-93,
      9.898965241856742e-93, -8.842158905099869e-93, 2.171822104247474e-93,
      1.9958311752097316e-93, -2.2286204522623118e-93, 7.443299237246237e-94,
      3.6768428406863635e-94, -5.463787299496331e-94, 2.304678738340726e-94,
      5.716279367189353e-95, -1.3021654342554134e-94, 6.694659052079019e-95,
      5.361933099842965e-96, -3.009816174477814e-95, 1.857134711668088e-95,
      -8.894976632998135e-97, -6.715703178517633e-96, 4.966721169682322e-96,
      -7.640994274697935e-97, -1.4343758406211974e-96, 1.2873282461615566e-96,
      -3.188830024128169e-97, -2.887253052533659e-97, 3.242551522755357e-97,
      -1.0895187086232432e-97, -5.304642789229548e-98, 7.944487582206932e-98,
      -3.367467690667776e-98, -8.19886134413712e-99, 1.892104760188726e-98,
      -9.769913856386173e-99, -7.500574375778499e-100, 4.3701063246473535e-99,
      -2.7077011330346853e-99, 1.3687066972294792e-100, 9.74212807721897e-100,
      -7.235884057716468e-100, 1.1296882971765462e-100, 2.0783687862431264e-100,
      -1.8741902006673597e-100, 4.6816175500187747e-101, 4.1766243356871415e-101,
      -4.7177101250665544e-101, 1.5947092600137505e-101, 7.652440420813888e-102,
      -1.1551315404074666e-101, 4.920192409079391e-102, 1.1757035618718836e-102,
      -2.7492681272684262e-102, 1.4257471222096476e-102, 1.047524402489956e-103,
      -6.345061931975815e-103, 3.947750068765166e-103, -2.099798505200596e-104,
      -1.4132079789983365e-103, 1.0541591895316059e-103, -1.6697463339034383e-104,
      -3.011401331082794e-104, 2.7285468649765918e-104, -6.872562540947164e-105,
      -6.041506720629004e-105, 6.863872591224967e-105, -2.3340288487806686e-105,
      -1.1038393426919805e-105, 1.6795403100241368e-105, -7.188635527919936e-106,
      -1.6855572608628585e-106, 3.99467913937458e-106, -2.080577203331567e-106,
      -1.460394823449849e-107, 9.212373226437e-107, -5.755594811669974e-107,
      3.2127534657199344e-108, 2.0499731439713816e-107, -1.535725508245933e-107,
      2.4673406880143384e-108, 4.3631578962621665e-108, -3.9723048602248216e-108,
      1.008789187693262e-108, 8.738646146787154e-109, -9.986211701059777e-109,
      3.4159308171426164e-109, 1.592110569931108e-109, -2.441984205902706e-109,
      1.0502596799368096e-109, 2.4159482792505864e-110, -5.80416263693365e-110,
      3.0360910643054566e-110, 2.032099186052786e-111, -1.3375158799349908e-110,
      8.391168650757451e-111, -4.903675783824623e-112, -2.9735828748368796e-111,
      2.2372463872264412e-111, -3.6450036285789636e-112, -6.321488799349279e-112,
      5.782919327792917e-112, -1.4806138578536058e-112, -1.2639265663322703e-112,
      1.4528671966281475e-112, -4.999082617764578e-113, -2.2961558077553752e-113,
      3.550493249567864e-113, -1.53437985980369e-113, -3.4620004778220795e-114,
      8.433155205963705e-114, -4.430323504850208e-114, -2.821697321093959e-115,
      1.9418608182222943e-114, -1.2233378047954354e-114, 7.468050918229136e-116,
      4.313220355185928e-115, -3.2591689236903592e-115, 5.38344574987349e-116,
      9.158489493203521e-116, -8.418701532993604e-116, 2.1729191970984557e-116,
      1.8280079423571383e-116, -2.1137064002050962e-116, 7.315604463739563e-117,
      3.3112316381585496e-117, -5.162118203492278e-117, 2.241584787554653e-117,
      4.9597383031142504e-118, -1.225274634808064e-117, 6.464662188244473e-118,
      3.909109743022326e-119, -2.8192198570412794e-118, 1.783454721412215e-118,
      -1.1350575005052796e-119, -6.256232891274614e-119, 4.747804003677365e-119,
      -7.949126479328511e-120, -1.3268268411424646e-119, 1.2255654710948807e-119,
      -3.188646705787786e-120, -2.6437026523041878e-120, 3.0750841237261713e-120,
      -1.0705057892778397e-120, -4.7746016170072756e-121, 7.5051711936235145e-121,
      -3.2746406726385553e-121, -7.103611015798183e-122, 1.78020330589571e-121,
      -9.432917623507816e-122, -5.4018738932339374e-123, 4.0929030021014905e-122,
      -2.599977302194591e-122, 1.7219750223449915e-123, 9.074313256055343e-123,
      -6.91626410564606e-123, 1.1734867246575884e-123, 1.922164023430369e-123,
      -1.7841088754001978e-123, 4.678761997801861e-124, 3.823183711404708e-124,
      -4.473659581585459e-124, 1.5664154909403878e-124, 6.884039534263799e-125,
      -1.0911555266505816e-124, 4.783639523412787e-125, 1.0171495557405228e-125,
      -2.5864170492343166e-125, 1.3763729155476954e-125, 7.443730016156426e-127,
      -5.941903353434854e-126, 3.790258553344298e-126, -2.607946501556947e-127,
      -1.3161462893228739e-126, 1.007495810167943e-126, -1.7319667346378737e-127,
      -2.7845326714323284e-127, 2.5971655389436378e-127, -6.864641723208673e-128,
      -5.528604132347846e-128, 6.508223522383369e-128, -2.2919455813363553e-128,
      -9.92447301027486e-129, 1.5863758760608183e-128, -6.987787076351783e-129,
      -1.4560355257689214e-129, 3.7576841841404225e-129, -2.0082423577417147e-129,
      -1.0225303069272518e-130, 8.626036736790678e-130, -5.525352126437667e-130,
      3.943576906767046e-131, 1.9089037500859646e-130, -1.4676004612555363e-130,
      2.555678752887225e-131, 4.033664246705614e-131, -3.7806925230741316e-131,
      1.007088874422003e-131, 7.994352904595394e-132, -9.467941796036697e-132,
      3.3533682724077964e-132, 1.430634399855752e-132, -2.306316544925772e-132,
      1.020721856572227e-132, 2.0837074405107e-133, -5.459272221351507e-133,
      2.9301247782491764e-133, 1.3997010819070682e-134, -1.2522428923902426e-133,
      8.05458114598213e-134, -5.954596563250251e-135, -2.768555949657162e-134,
      2.1377915649381187e-134, -3.770343939918684e-135, -5.842955817940087e-135,
      5.503469212665526e-135, -1.4773429853318844e-135, -1.1559215383940589e-135,
      1.377343585272809e-135, -4.906118639093344e-136, -2.0620831973814677e-136,
      3.3529347348725975e-136, -1.490945630901983e-136, -2.9810895659446966e-137,
      7.931255763196114e-137, -4.275098755215721e-137, -1.9084012952988138e-138,
      1.8178471456113478e-137, -1.174134557759082e-137, 8.979039632397054e-139,
      4.015243777518892e-138, -3.113980042243424e-138, 5.5611703217043524e-139,
      8.463514850765614e-139, -8.011155979761973e-139, 2.1670008458970837e-139,
      1.6712842930081056e-139, -2.0036533778884764e-139, 7.177528267669413e-140,
      2.9719342237254474e-140, -4.874439040378274e-140, 2.1777245459304558e-140,
      4.263659371679204e-141, -1.1522371399743913e-140, 6.237295053773971e-141,
      2.5902386931389395e-142, -2.6388677632071146e-141, 1.711530806254887e-141,
      -1.3522698972590928e-142, -5.823174484317375e-142, 4.535855949220908e-142,
      -8.200953830309523e-143, -1.225897306472909e-142, 1.166130903246441e-142,
      -3.178349258010332e-143, -2.416289429163184e-143, 2.914717609134364e-143,
      -1.0500066941818218e-143, -4.2827906537914157e-144, 7.086267381560141e-144,
      -3.180760265444847e-144, -6.0961357237015355e-145, 1.6739191337830334e-144,
      -9.09989922224434e-145, -3.4974553208296347e-146, 3.830622303109183e-145,
      -2.4948448459464924e-145, 2.0341790461570888e-146, 8.444946321599422e-146,
      -6.606868495106819e-146, 1.2091433867584553e-146, 1.7755890634056942e-146,
      -1.69743400784945e-146, 4.661326391697503e-147, 3.493203833600045e-147,
      -4.2399815304064253e-147, 1.535994748983857e-147, 6.1711808028647305e-148,
      -1.030157823545998e-147, 4.645643538384829e-148, 8.7133791731594e-149,
      -2.4317545966907733e-148, 1.3275995250340482e-148, 4.6939919766199257e-150,
      -5.5604820069803044e-149, 3.6365902178152838e-149, -3.0566104547020715e-150,
      -1.2246813905510666e-149, 9.623323116594264e-150, -1.7824146377465264e-150,
      -2.5716729590598144e-150, 2.4707680538127286e-150, -6.835705090397482e-151,
      -5.049809010301327e-151, 6.167725422743714e-151, -2.246819130269865e-151,
      -8.891244786426665e-152, 1.4975568664688041e-151, -6.784969264000616e-152,
      -1.2450116201982807e-152, 3.5326260223502283e-152, -1.9368137514853854e-152,
      -6.255320504341989e-154, 8.071363552091273e-153, -5.300748793790115e-153,
      4.5882371413193735e-154, 1.7759813831339667e-153, -1.4016755134337113e-153,
      2.626995403661698e-154, 3.724549800351259e-154, -3.59637149250054e-154,
      1.0023596326742107e-154, 7.2996446774724696e-155, -8.971802044897947e-155,
      3.2864529697266368e-155, 1.2808810747721603e-155, -2.1769888142783102e-155,
      9.909164577244377e-156, 1.7783189887935693e-156, -5.131782087588292e-156,
      2.825523677867247e-156, 8.265702750675646e-158, -1.1715820312807767e-156,
      7.726310248365604e-157, -6.880713365614473e-158, -2.5753881506916677e-157,
      2.04156369400103e-157, -3.871074944863426e-158, -5.394068589711914e-158,
      5.2346857167597284e-158, -1.4697070888873374e-158, -1.0551250086109903e-158,
      1.3050523008536134e-158, -4.806930704096548e-159, -1.8450410800505573e-159,
      3.164625904678051e-159, -1.4471496766467593e-159, -2.539158172711665e-160,
      7.454720268222592e-160, -4.121928122864668e-160, -1.0810569894092081e-161,
      1.7005514597290836e-160, -1.1261575575487517e-160, 1.0309260965245418e-161,
      3.73452954144325e-161, -2.973523848141347e-161, 5.703317057760114e-162,
      7.811665432524246e-162, -7.619214165785733e-162, 2.1547926749191788e-162,
      1.5250399484995168e-162, -1.8983213453608871e-162, 7.030555360645636e-163,
      2.657377629463908e-163, -4.600254462894635e-163, 2.1133781479427716e-163,
      3.624162852092785e-164, -1.0828968150932318e-163, 6.013015206272891e-164,
      1.396015027759977e-165, -2.4683008775993174e-164, 1.641414592204222e-164,
      -1.543300666241062e-165, -5.415243052151004e-165, 4.3308483666785373e-165,
      -8.401348899095652e-166, -1.1312410396405826e-165, 1.1089788378358438e-165,
      -3.158989418197951e-166, -2.2041101897198324e-166, 2.7612461517629976e-166,
      -1.0282362981816772e-166, -3.826920976806053e-167, 6.687050700971629e-167,
      -3.086230924610324e-167, -5.170793455113661e-168, 1.573024033910465e-167,
      -8.771516115931542e-168, -1.7737961309782405e-169, 3.582594201311226e-168,
      -2.3923767596685776e-168, 2.3084639698993234e-169, 7.852153532871884e-169,
      -6.307650276930993e-169, 1.2373652730764365e-169, 1.6381394607112372e-169,
      -1.614097819544832e-169, 4.6308351013085006e-170, 3.1853695745171283e-170,
      -4.016373487375926e-170, 1.503757998480481e-170, 5.510533522967021e-171,
      -9.720321945217097e-171, 4.506788360034595e-171, 7.374481795176399e-172,
      -2.284947224867383e-171, 1.279521405219152e-171, 2.206378390461844e-173,
      -5.199819877892793e-172, 3.4868481841754655e-172, -3.4503577547202644e-173,
      -1.1385400458981563e-172, 9.186610951216054e-173, -1.8221158327438214e-173,
      -2.3720871763516344e-173, 2.3492539341930854e-173, -6.787961972526904e-174,
      -4.60320644420429e-174, 5.8419338120767e-174, -2.1990995001479653e-174,
      -7.933862186089798e-175, 1.4129277138160936e-174, -6.581025003665685e-175,
      -1.0512924306442765e-175, 3.319017172430682e-175, -1.866427058965373e-175,
      -2.6654425732115243e-177, 7.546926133887761e-176, -5.08193036430569e-176,
      5.153366709179563e-177, 1.6508076057493342e-176, -1.337938491650197e-176,
      2.682778951914749e-177, 3.43474359564878e-177, -3.4191928764841168e-177,
      9.949216601139147e-178, 6.651733276311457e-178, -8.49713938739525e-178,
      3.2158360941038314e-178, 1.1421453717237519e-178, -2.053773221816185e-178,
      9.609651550174318e-179, 1.4980479385548755e-179, -4.820979797927526e-179,
      2.7224826105814168e-179, 3.0855673269718635e-181, -1.0953249342637729e-179,
      7.406561196314016e-180, -7.691657463809745e-181, -2.3934984830972944e-180,
      1.9485434381927844e-180, -3.9493559772215345e-181, -4.973266690612067e-181,
      4.976348277126442e-181, -1.4581702164955268e-181, -9.611310112868613e-182,
      1.2358974019848e-181, -4.70246107718871e-182, -1.6440033029467802e-182,
      2.9852332292615236e-182, -1.4031676123631724e-182, -2.133683378296058e-183,
      7.002507554100094e-183, -3.971091384188808e-183, -3.336336885024716e-185,
      1.5896696442646562e-183, -1.0794357148525119e-183, 1.1472700466604044e-184,
      3.470230466641684e-184, -2.837769844645135e-184, 5.813018781883855e-185,
      7.200667690942752e-185, -7.24254946679075e-185, 2.1369671878400175e-185,
      1.3886838240514671e-185, -1.7975693699817726e-185, 6.876049138334871e-186,
      2.366068747355096e-186, -4.339076148929447e-186, 2.0487990489243357e-186,
      3.037580109202956e-187, -1.0171015077867393e-186, 5.792224293162393e-187,
      3.1767521719029343e-189, -2.307075336823884e-187, 1.5731467595111232e-187,
      -1.7101806086185028e-188, -5.031203299336125e-188, 4.1327334470889724e-188,
      -8.554856774548043e-189, -1.0425267889498739e-188, 1.0540609217800104e-188,
      -3.1315417571558646e-189, -2.0063043295907963e-189, 2.6144627513218273e-189,
      -1.0053918669590427e-189, -3.404820064953153e-190, 6.306806236565143e-190,
      -2.9914184182269214e-190, -4.322249644265656e-191, 1.4772956639461204e-190,
      -8.448344797768994e-191, -2.1816181171099385e-193, 3.3481708859591584e-191,
      -2.292630217736391e-191, 2.547778606593772e-192, 7.2941337092813e-192,
      -6.018534891340294e-192, 1.2588117684223939e-192, 1.5093325958419092e-192,
      -1.5340287514486235e-192, 4.588700400703812e-193, 2.8984279352869373e-193,
      -3.80253144453375e-193, 1.4699906443521494e-193, 4.898936651835928e-194,
      -9.166739798914976e-194, 4.3676017951810395e-194, 6.1470465430573526e-195,
      -2.145670032995197e-194, 1.2322212848333474e-194, -3.761529165162396e-198,
      -4.858971521233501e-195, 3.3411127080578876e-195, -3.7934701289497314e-196,
      -1.0574596309136514e-195, 8.764705852285982e-196, -1.8520269091098032e-196,
      -2.1850721792030986e-196, 2.2325173098275216e-196, -6.723458867579917e-197,
      -4.1869721554622845e-197, 5.530402259285153e-197, -2.1491995972159374e-197,
      -7.047725924257742e-198, 1.3323352101876644e-197, -6.3767158628295554e-198,
      -8.73750062343885e-199, 3.1163828847652394e-198, -1.797200974265278e-198,
      5.7121929161360064e-201, 7.051344690022526e-199, -4.869009341351038e-199,
      5.645182636424155e-200, 1.5329995010007928e-199, -1.27637149663995e-199,
      2.724417119114823e-200, 3.1632212161557895e-200, -3.249000087587151e-200,
      9.850715015315796e-201, 6.0479627198102254e-201, -8.043298312162761e-201,
      3.142114985120298e-201, 1.0137581092969761e-201, -1.936445503215051e-201,
      9.309778251004157e-202, 1.2412542910282645e-202, -4.526171664765178e-202,
      2.6211718352819764e-202, -1.5824660220538378e-204, -1.0232702379518114e-202,
      7.095491470162365e-203, -8.396455749848085e-204, -2.222328649564843e-203,
      1.8587032165717884e-203, -4.00720015392241e-204, -4.5790576647924016e-204,
      4.7282253583421396e-204, -1.443162058715245e-204, -8.735528659483111e-205,
      1.1697826470039664e-204, -4.593573871796001e-205, -1.4579962426542246e-205,
      2.8144284495985497e-205, -1.3591579512490676e-205, -1.7622806026198307e-206,
      6.573604062379602e-206, -3.822832711210191e-206, 3.395456838413977e-208,
      1.484907841693699e-206, -1.0339910390309458e-206, 1.2482464603811806e-207,
      3.2215325649541183e-207, -2.7066756654073285e-207
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_4_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<4>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 4, "order");
    static_assert(design.b().size() == 5, "b.size");
    static_assert(design.a().size() == 5, "a.size");

    static_assert(almost_equal(design.b()[0], 0.16160401632345284), "design.b()[0] == 0.16160401632345284");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.16160401632345284));
    static_assert(almost_equal(design.b()[1], -0.6362216971641653), "design.b()[1] == -0.6362216971641653");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -0.6362216971641653));
    static_assert(almost_equal(design.b()[2], 0.9493163849472388), "design.b()[2] == 0.9493163849472388");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 0.9493163849472388));
    static_assert(almost_equal(design.b()[3], -0.6362216971641652), "design.b()[3] == -0.6362216971641652");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -0.6362216971641652));
    static_assert(almost_equal(design.b()[4], 0.16160401632345275), "design.b()[4] == 0.16160401632345275");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 0.16160401632345275));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -0.7023953733003654), "design.a()[1] == -0.7023953733003654");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -0.7023953733003654));
    static_assert(almost_equal(design.a()[2], 0.6489200138373641), "design.a()[2] == 0.6489200138373641");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 0.6489200138373641));
    static_assert(almost_equal(design.a()[3], -0.16497220359229986), "design.a()[3] == -0.16497220359229986");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -0.16497220359229986));
    static_assert(almost_equal(design.a()[4], 0.028680221192445877), "design.a()[4] == 0.028680221192445877");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.028680221192445877));
    std::cout << "max_deviation(cheby2,highpass,4,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.16160401632345284, -0.5227117837918154, 0.47729796593349816, 0.06488849444658346,
      -0.19341456180449376, -0.08422854926533777, 0.06336462349770702, 0.06539556688917389,
      -0.0035332257029135894, -0.03204911856531556, -0.011247232369422908,
      0.010438867130777636, 0.009444886141724836, -0.0010762503744765322,
      -0.0048402329035960095, -0.0014426021281147851, 0.001679214122899935,
      0.0013479688344358528, -0.00024203888089124306, -0.000726333142506118,
      -0.00017889200831750916, 0.00026708946205519107, 0.00019080595649742028,
      -4.7979290001441666e-05, -0.0001083252357621727, -2.1134928627377283e-05,
      4.206173117130753e-05, 2.6764247346616354e-05, -8.875499693619913e-06,
      -1.605679477288309e-05, -2.3097118659788493e-06, 6.565429281492963e-06,
      3.715971885177378e-06, -1.5708828311976396e-06, -2.3653929764743666e-06,
      -2.1732966778695942e-07, 1.0165725920303014e-06, 5.098946316690655e-07,
      -2.69540030760397e-07, -3.46265218401043e-07, -1.3342252660250035e-08,
      1.5623639012625008e-07, 6.900410394217782e-08, -4.5186894862157004e-08,
      -5.035988965204688e-08, 8.529918048268256e-10, 2.384504320387608e-08,
      9.183112739841725e-09, -7.438297152715014e-09, -7.27442582304922e-09,
      5.484140808373964e-10, 3.6152380419133845e-09, 1.1967035508316731e-09,
      -1.2063360618176297e-09, -1.0432046040893048e-09, 1.4381052173125064e-10,
      5.446345502862267e-10, 1.5172548525987745e-10, -1.9320890358573217e-10,
      -1.4844169961320833e-10, 3.052260964837082e-11, 8.154011050913885e-11,
      1.8519183885657898e-11, -3.061249760913704e-11, -2.0943089233397844e-11,
      5.871295560851554e-12, 1.2133015114167189e-11, 2.1351181056028526e-12,
      -4.8044062586666835e-12, -2.926893413943614e-12, 1.0660965653625127e-12,
      1.7943118626932538e-12, 2.2344033068555818e-13, -7.476011741365611e-13,
      -4.0467081165453245e-13, 1.8629464106399628e-13, 2.6370975143956553e-13,
      1.9020119758101024e-14, -1.1542740559335909e-13, -5.52564047263753e-14,
      3.1665847677026874e-14, 3.851111712217249e-14, 6.961408482838948e-16,
      -1.7692917965063534e-14, -7.434083108922165e-15, 5.269959522594962e-15,
      5.586915361876589e-15, -2.145389765111821e-16, -2.69354439521956e-15,
      -9.821723516258673e-16, 8.62394614578302e-16, 8.048863541943676e-16,
      -7.905636211527777e-17, -4.073956268541947e-16, -1.2680134061587336e-16,
      1.391760798994085e-16, 1.150989619586088e-16, -1.8703665231597624e-17,
      -6.123051282457441e-17, -1.5874317582606567e-17, 2.2197009448565068e-17,
      1.6327331751335426e-17, -3.798557898623699e-18, -9.146053337773494e-18,
      -1.902244547268874e-18, 3.504001336498109e-18, 2.295697792169974e-18,
      -7.128357300195725e-19, -1.3577971455000298e-18, -2.1290627092472894e-19,
      5.481181611509498e-19, 3.196002999752334e-19, -1.2738076691623132e-19,
      -2.0033623259435577e-19, -2.1050298194538094e-20, 8.503606565890861e-20,
      4.39922976985143e-20, -2.2008645155525772e-20, -2.937393861615219e-20,
      -1.5316151407493001e-21, 1.3093013746566866e-20, 5.9756974259901555e-21,
      -3.709239305356753e-21, -4.279191792454078e-21, 1.1628546912714601e-23,
      2.0017153289093297e-21, 7.988836930049384e-22, -6.1317437502127895e-22,
      -6.192085816834446e-22, 3.735584589274256e-23, 3.03986525859008e-22,
      1.0471154577696375e-22, -9.979231998100895e-23, -8.896512846979599e-23,
      1.0824632687903843e-23, 4.5868315092181263e-23, 1.3378664032040878e-23,
      -1.603045287674047e-23, -1.2684854625322424e-23, 2.384292766697692e-24,
      6.877890067554416e-24, 1.6508913808935448e-24, -2.546475581868637e-24,
      -1.793650488086705e-24, 4.676989461954177e-25, 1.024999657350155e-24,
      1.9358681977544464e-25, -4.0056868677683224e-25, -2.5129721112241416e-25,
      8.596626670016476e-26, 1.5181928595019932e-25, 2.0883276916630757e-26,
      -6.246095200182518e-26, -3.4843429436763386e-26, 1.514924771985285e-26,
      2.2348102328245427e-26, 1.9097502218175733e-27, -9.662209109660338e-27,
      -4.773634203161514e-27, 2.5911294754099034e-27, 3.268936141145893e-27,
      1.0424718695142557e-28, -1.483682119961764e-27, -6.44810110394321e-28,
      4.333234601751991e-28, 4.750384381880757e-28, -1.1350878080373597e-29,
      -2.262551314422595e-28, -8.56144202962962e-29, 7.118952347059952e-29,
      6.855984080253589e-29, -5.675143941573365e-30, -3.4276314618652444e-29,
      -1.1124073581424325e-29, 1.1526536339904065e-29, 9.822945007594109e-30,
      -1.4323196423950397e-30, -5.1597613095001554e-30, -1.4048023171070596e-30,
      1.8435285691872293e-30, 1.3963523275236701e-30, -2.992814084847622e-31,
      -7.719138367025415e-31, -1.7049249842726756e-31, 2.917363884486296e-31,
      1.967894142781896e-31, -5.707747070882273e-32, -1.1477338334503743e-31,
      -1.947986119089359e-32, 4.5736021087266e-32, 2.7468217919267974e-32,
      -1.0307379862507399e-32, -1.6960673368470522e-32, -2.004660181417172e-33,
      7.109830625624357e-33, 3.792354523417693e-33, -1.794256460599743e-33,
      -2.490793663355945e-33, -1.634714501992079e-34, 1.0967362595176818e-33,
      5.1697032296966075e-34, -3.0410827786866883e-34, -3.6345724164970213e-34,
      -4.1176421852850345e-36, 1.6796622951741048e-34, 6.94122735167857e-35,
      -5.04970506345995e-35, -5.26840543208099e-35, 2.397297897903485e-36,
      2.555021913474472e-35, 9.14756316826136e-36, -8.248364659986628e-36,
      -7.583329073246248e-36, 8.023413710997301e-37, 3.8614298449837104e-36,
      1.1771214989495625e-36, -1.3290988345448787e-36, -1.0833933088807944e-36,
      1.8495405198597911e-37, 5.799220028912567e-37, 1.4670321277003308e-37,
      -2.1169509898624714e-37, -1.535258213317848e-37, 3.710702094532837e-38,
      8.655849037063464e-38, 1.7462763821752186e-38, -3.337899072697387e-38,
      -2.156167826535057e-38, 6.913826048824196e-39, 1.284060240385063e-38,
      1.932898884229236e-39, -5.215881835787808e-39, -2.997855626189585e-39,
      1.2296134624611527e-39, 1.89313183374063e-39, 1.8683605205214006e-40,
      -8.084271522886852e-40, -4.120286006826275e-40, 2.1172489154215835e-40,
      2.773616814316032e-40, 1.26376455670699e-41, -1.2436312905858847e-40,
      -5.586825653970212e-41, 3.5590184385363364e-41, 4.037350073735482e-41,
      -3.869701645969831e-43, -1.8997273610860698e-41, -7.452713382100146e-42,
      5.871199404072303e-42, 5.837194468268565e-42, -3.94564951140178e-43,
      -2.882682739565429e-42, -9.741543887566578e-43, 9.538847097614595e-43,
      8.379061725000007e-43, -1.0848587778775145e-43, -4.346306377921765e-43,
      -1.2401028855176132e-43, 1.530077778867351e-43, 1.1935413833550446e-43,
      -2.3448962533981963e-44, -6.512305910224535e-44, -1.5223816021447804e-44,
      2.4274988367439285e-44, 1.6858705286943919e-44, -4.554811930277618e-45,
      -9.697909360121867e-45, -1.7710523193354794e-45, 3.814259763455459e-45,
      2.3591372422593938e-45, -8.321386327826773e-46, -1.4353406869896237e-45,
      -1.8838698882049484e-46, 5.94158827249357e-46, 3.2665710267031715e-46,
      -1.4603184511336692e-46, -2.111237524227463e-46, -1.6680624486244372e-47,
      9.182624163899615e-47, 4.468139329835858e-47, -2.490064552995737e-47,
      -3.0857567139200227e-47, -7.780941574933575e-49, 1.4088176551810413e-47,
      6.023906072860354e-48, -4.154298024921915e-48, -4.480519481276529e-48,
      1.3843601755473383e-49, 2.1466249238544577e-48, 7.979305264890972e-49,
      -6.811847806175784e-49, -6.4609105818902004e-49, 5.829374689656318e-50,
      3.2494529822477327e-49, 1.0336155959635502e-49, -1.1011594384231617e-49,
      -9.248324982499597e-50, 1.422891424182695e-50, 4.887805298837524e-50,
      1.299927515547366e-50, -1.7587500697319618e-50, -1.31334372304704e-50,
      2.930701345994559e-51, 7.306790502762358e-51, 1.5682264143889288e-51,
      -2.779853472498428e-51, -1.848845556485362e-51, 5.544353885045719e-52,
      1.085610102310949e-51, 1.774619800096573e-52, -4.35333921616275e-52,
      -2.5774100166637978e-52, 9.960156339185424e-53, 1.603053264802839e-52,
      1.7929643904231173e-53, -6.760807742238724e-53, -3.55331774618067e-53,
      1.7274195731343732e-53, 2.3523825503296697e-53, 1.3904828911874054e-54,
      -1.041955089732416e-53, -4.835606943435054e-54, 2.9196696761923396e-54,
      3.4298689679115457e-54, 1.55862987088019e-56, -1.5944122570370547e-54,
      -6.4792578410286745e-55, 4.8374785628611256e-55, 4.967535429124379e-55,
      -2.6157923546667603e-56, -2.423389157758925e-55, -8.516680200486382e-56,
      7.887547311386681e-56, 7.143923979907345e-56, -8.10510288917594e-57,
      -3.6596475919693575e-56, -1.0922309089046334e-56, 1.2690396407076362e-56,
      1.0196435554342642e-56, -1.8254054290513585e-57, -5.492010528437559e-57,
      -1.3548556028006206e-57, 2.0186540580583998e-57, 1.4434101396338654e-57,
      -3.621018530310078e-58, -8.191170273960893e-58, -1.601417642284204e-58,
      3.1792453579059137e-58, 2.0248153908664098e-58, -6.701198013497687e-59,
      -1.2142161548276513e-58, -1.7514886176388152e-59, 4.9628212026711185e-59,
      2.811511363555939e-59, -1.1863884876263382e-59, -1.7887991467790092e-59,
      -1.650865954147976e-60, 7.684756153547241e-60, 3.85825459717379e-60,
      -2.0360873337334013e-60, -2.6187185919916904e-60, -1.0201374558811297e-61,
      1.1811315126211944e-60, 5.221997293126461e-61, -3.413932076532696e-61,
      -3.808792199456958e-61, 6.282410178898477e-63, 1.802756910190332e-61,
      6.950477808220904e-62, -5.620454603666676e-62, -5.502055756149013e-62,
      4.122079430608371e-63, 2.7333670273674183e-62, 9.059239882953987e-63,
      -9.116167224768382e-63, -7.890802083641553e-63, 1.0837875433735237e-63,
      4.1180115543462217e-63, 1.1488715199121472e-63, -1.4601933063250564e-63,
      -1.122884571016149e-63, 2.302661171462178e-64, 6.165589299449528e-64,
      1.4027777278436223e-64, -2.3137488414223112e-64, -1.5843470023106404e-64,
      4.431887940892261e-65, 9.174720166824866e-65, 1.6181963358710525e-65,
      -3.6315133738007905e-65, -2.214371903682203e-65, 8.050215404749818e-66,
      1.3568846593188744e-65, 1.6951771192402155e-66, -5.651263018816455e-66,
      -3.0618547931651193e-66, 1.407084619153517e-66, 1.99430921305024e-66,
      1.4466673473358886e-67, -8.725893939914863e-67, -4.1812980522820414e-67,
      2.392170416511082e-67, 2.912556731554465e-67, 5.390172767240758e-69,
      -1.337593852421301e-67, -5.626147177462067e-68, 3.98172962021397e-68,
      4.225550779043494e-68, -1.6034974546951566e-69, -2.0364395342687705e-68,
      -7.434300106537252e-69, 6.516615890423782e-69, 6.087936466188798e-69,
      -5.950215748522216e-70, -3.0802463621960046e-69, -9.599870758515981e-70,
      1.0517776466282286e-69, 8.70628899680123e-70, -1.4102289033527222e-70,
      -4.629756255978792e-70, -1.2021500888224117e-70, 1.6776099693426277e-70,
      1.2351093181781366e-70, -2.8663852962415615e-71, -6.915837889956317e-71,
      -1.4411529412820743e-71, 2.648460477985141e-71, 1.7367469206299263e-71,
      -5.381584243994951e-72, -1.0267548768595527e-71, -1.614095685613265e-72,
      4.143169877414879e-72, 2.418047227973591e-72, -9.619660211090884e-73,
      -1.5149992373116758e-72, -1.5980590004520154e-73, 6.428186175866922e-73,
      3.32870705377919e-73, -1.6624404109961423e-73, -2.221450356324304e-73,
      -1.1676326140613018e-74, 9.898051088516932e-74, 4.522061443867654e-74,
      -2.8022784628244763e-74, -3.2363723407305887e-74, 7.377767047595943e-77,
      1.5133371180219231e-74, 6.046318987088315e-75, -4.633070942837851e-75,
      -4.683355363715479e-75, 2.8037145542647385e-76, 2.2983169517353934e-75,
      7.92642589424714e-76, -7.541022160497664e-76, -6.72922250922832e-76,
      8.154230092711933e-77, 3.4680858217296857e-76, 1.0129666427018668e-76,
      -1.2114894955674114e-76, -9.595276963007765e-77, 1.7983783652263025e-77,
      5.200597911927384e-77, 1.2503760804720262e-77, -1.9246365876555446e-77,
      -1.3568736896698994e-77, 3.5299639818372353e-78, 7.750729288105064e-78,
      1.4669377204071906e-78, -3.0277327769684386e-78, -1.9011759976520729e-78,
      6.490904888282953e-79, 1.1480654645079777e-78, 1.5838291352980112e-79,
      -4.7214719503031525e-79, -2.6362901699080922e-79, 1.1441596932116008e-79,
      1.6900577265925277e-79, 1.4511886506826578e-80, -7.304175328727749e-80,
      -3.612146373220941e-80, 1.9573641504189555e-80, 2.4722312867131183e-80,
      7.989266310919965e-82, -1.121656289763842e-80, -4.879783300429919e-81,
      3.2738742232344726e-81, 3.592808663554246e-81, -8.424542301070968e-83,
      -1.7105675336945239e-81, -6.48008054885568e-82, 5.379229477722901e-82,
      5.185600675897839e-82, -4.267863598749784e-83, -2.5915393428679093e-82,
      -8.421325544140513e-83, 8.710596756557109e-83, 7.430133260264227e-83,
      -1.0796147591431951e-83, -3.9013467689603785e-83, -1.0637606804819054e-83,
      1.393277127788436e-83, 1.0562768204235446e-83, -2.2580091672556264e-84,
      -5.836797985222934e-84, -1.291504375035146e-84, 2.205017055159117e-84,
      1.4887275913371217e-84, -4.308659911125147e-85, -8.678962541452344e-85,
      -1.4765045408508535e-85, 3.4570830481260234e-85, 2.078158229134383e-85,
      -7.783492966051814e-86, -1.282598326279001e-85, -1.5211625788496449e-86,
      5.374499315846359e-86, 2.8694378727882423e-86, -1.3552377902561646e-86,
      -1.883678143141383e-86, -1.2441022715562653e-87, 8.2909860122742e-87,
      3.9120129329950608e-87, -2.2974062086095597e-87, -2.7488076173979233e-87,
      -3.233080256986845e-89, 1.2698417099709918e-87, 5.253243150968469e-88,
      -3.8153760486083575e-88, -3.9846787053974195e-88, 1.7949967890585317e-89,
      1.9317223347966366e-88, 6.924164987124713e-89, -6.2328921490886474e-89,
      -5.7358598490084905e-89, 6.040795573095636e-90, 2.9195764027553153e-89,
      8.912009293210616e-90, -1.004434085326269e-89, -8.195041563080996e-90,
      1.394707368917471e-90, 4.38492704555453e-90, 1.1110187961320805e-90,
      -1.599968904296978e-90, -1.161382526904937e-90, 2.800286714369638e-91,
      6.545205479953333e-91, 1.3230762269738023e-91, -2.5229356627030515e-91,
      -1.6312048515109325e-91, 5.219855643150385e-92, 9.71001345476716e-92,
      1.4655486690948064e-92, -3.942663213510332e-92, -2.2681565601739114e-92,
      9.286198530281486e-93, 1.4316483763821683e-92, 1.4187685511371263e-93,
      -6.111239423033822e-93, -3.1176819573800643e-93, 1.5993176418968489e-93,
      2.0976043008640454e-93, 9.645916543547099e-95, -9.401661766545996e-94,
      -4.227850355331666e-94, 2.688837212605548e-94, 3.0534859677122696e-94,
      -2.792191558817693e-96, -1.4362412973188743e-94, -5.640662896061938e-95,
      4.436271775707458e-95, 4.41496496458661e-95, -2.9636998442589993e-96,
      -2.1794910416530106e-95, -7.374307662184757e-96, 7.208324174360829e-96,
      6.3378745480757585e-96, -8.174049972264527e-97, -3.286245229456698e-96,
      -9.38976184049776e-97, 1.156357024907626e-96, 9.028445016011385e-97,
      -1.7688414599961815e-97, -4.924196610408836e-97, -1.1530995748902614e-97,
      1.8347304526628326e-97, 1.2753507718834857e-97, -3.437951590731615e-98,
      -7.33330092995723e-98, -1.3421515305927492e-98, 2.8830648434626534e-98,
      1.784810794827794e-98, -6.28332636424934e-99, -1.0854186192985204e-98,
      -1.4289816077062374e-99, 4.491326704738036e-99, 2.471550037527556e-99,
      -1.102948259984387e-99, -1.5966164672323133e-99, -1.268060067480599e-100,
      6.941680209004183e-100, 3.3810282499624486e-100, -1.8810581467325284e-100,
      -2.3337109139909105e-100, -5.9844713038565314e-102, 1.0650661234260688e-100,
      4.5588368106216615e-101, -3.1387350418098406e-101, -3.38872676801134e-101,
      1.0318001795433814e-102, 1.622933303968508e-101, 6.0395915817643085e-102,
      -5.1472451550690695e-102, -4.886816457959303e-102, 4.385769976701557e-103,
      2.456838259380524e-102, 7.825056848977987e-103, -8.321551539282297e-103,
      -6.995539936421608e-103, 1.0726766794188825e-103, 3.695739952999118e-103,
      9.843835784379162e-104, -1.329217682108873e-103, -9.934927958468596e-104,
      2.2113250225008265e-104, 5.525034964558956e-104, 1.1880215457474274e-104,
      -2.1011018353387296e-104, -1.398679263626256e-104, 4.185524959970103e-105,
      8.209241833169204e-105, 1.3452312184423268e-105, -3.2906175577036008e-105,
      -1.950007075336437e-105, 7.52154530309216e-106, 1.2122665218325969e-105,
      1.3608094310190733e-106, -5.110701587385259e-106, -2.6886064126278727e-106,
      1.304786850550011e-106, 1.7790147391991837e-106, 1.059001482241241e-107,
      -7.876911064664734e-107, -3.659249081567732e-107, 2.2057260583154488e-107,
      2.594007970182001e-107, 1.291657944509517e-109, -1.2053995808447609e-107,
      -4.903704157413176e-108, 3.65508155675402e-108, 3.757145390015119e-108,
      -1.961176501961772e-109, -1.8322127899737234e-108, -6.446771116169324e-109,
      5.960316067963483e-109, 5.403542393210376e-109, -6.104005650834709e-110,
      -2.767028039920084e-109, -8.269554372857013e-110, 9.590562835224209e-110,
      7.712883401624021e-110, -1.3766713969463882e-110, -4.15266309028408e-110,
      -1.0261098121926747e-110, 1.525691689459958e-110, 1.0919112366793793e-110,
      -2.732787724156843e-111, -6.193870237870432e-111, -1.2134068729585633e-111,
      2.4030384162598013e-111, 1.531847604729117e-111, -5.059538893946337e-112,
      -9.181909195114517e-112, -1.3281684715674513e-112, 3.7514046906919676e-112,
      2.127193302574949e-112, -8.960025427606778e-113, -1.352756683906816e-112,
      -1.2539940324957327e-113, 5.809270370417988e-113, 2.9194494558221024e-113,
      -1.53804456849526e-113, -1.9804716096130952e-113, -7.798934206153563e-115,
      8.929232534428996e-114, 3.951826996987635e-114, -2.579269798906537e-114,
      -2.880644119410811e-114, 4.623793574004988e-116, 1.3629378391907914e-114,
      5.260643306465983e-115, -4.246870048926154e-115, -4.161511155937712e-115,
      3.0981912063145683e-116, 2.066611469801478e-115, 6.857980134605732e-116,
      -6.888995884140171e-116, -5.968601727220914e-116, 8.167564204598493e-117,
      3.113649827523496e-116, 8.699281917099712e-117, -1.1035532279728857e-116,
      -8.494035772585892e-117, 1.73714438219484e-117, 4.6620585802911896e-117,
      1.0625623282841088e-117, -1.7487728937401604e-117, -1.198559558146902e-117,
      3.3453541959326035e-118, 6.937719755162496e-118, 1.226416785802349e-118,
      -2.7449557375348445e-118, -1.675305189963439e-118, 6.078794434147912e-119,
      1.0260954741564433e-118, 1.2860672561784268e-119, -4.271897855271708e-119,
      -2.316684924707716e-119, 1.0627701404312311e-119, 1.5081989468378677e-119,
      1.1002950638346468e-120, -6.596456971883981e-120, -3.1640201351636644e-120,
      1.8071431528116677e-120, 2.2027362309572302e-120, 4.171284862852673e-122,
      -1.01122752812905e-120, -4.257888548164704e-121, 3.0084015814416897e-121,
      3.1959087736883703e-121, -1.1983142434356869e-122, -1.539638380124585e-121,
      -5.627193751281146e-122, 4.924224487046988e-122, 4.6047436982565344e-122,
      -4.47836013589564e-123, -2.3289189622419383e-122, -7.267852843454453e-123,
      7.948459422867267e-123, 6.585587718617521e-123, -1.063282643857539e-123,
      -3.500645989749759e-123, -9.103768152939406e-124, 1.2679065878349114e-123,
      9.34319355140412e-124, -2.162959363026192e-124, -5.229446416134397e-124,
      -1.0918225329705063e-124, 2.001808314998985e-124, 1.3138872460169708e-124,
      -4.0628384609530563e-125, -7.764231829668273e-125, -1.223677634207897e-125,
      3.1317787355460984e-125, 1.8294564729581705e-125, -7.26465047683487e-126,
      -1.1456848237203042e-125, -1.2131665178761108e-126, 4.85929800686406e-126,
      2.518686753723685e-126, -1.2557356194128206e-126, -1.680006148062402e-126,
      -8.900900774610132e-128, 7.482721321494394e-127, 3.422030691591426e-127,
      -2.117079740583012e-127, -2.447682212856039e-127, 4.508594264678838e-130,
      1.144112884040835e-127, 4.5761266612442677e-128, -3.500688690893688e-128,
      -3.5422325546069997e-128, 2.1041878961390266e-129, 1.7376621303544944e-128,
      6.000114926631846e-129, -5.6985317271959365e-129, -5.0899060478605015e-129,
      6.142516674043511e-130, 2.6222054726833253e-129, 7.669669249588391e-130,
      -9.155735096192308e-130, -7.25820643218645e-130, 1.356437036128337e-130,
      3.9323409118813824e-130, 9.47025120983941e-131, -1.4546472827531197e-130,
      -1.026457044523531e-130, 2.6642346979686595e-131, 5.860858744296621e-131,
      1.1115921014737629e-131, -2.2885365685496523e-131, -1.4383239177043463e-131,
      4.9009618993958e-132, 8.681728448037744e-132, 1.2011963186776509e-132,
      -3.568995642641589e-132, -1.994643156725985e-132, 8.641346885556425e-133,
      1.2780924201199395e-132, 1.1027081600808782e-133, -5.521610292690548e-133,
      -2.733261427912167e-133, 1.4786097085048955e-133, 1.8696985304878193e-133,
      6.121700855442346e-135, -8.479662085056169e-134, -3.692910504769747e-134,
      2.4734965588179357e-134, 2.7173103612928253e-134, -6.250419498599245e-136,
      -1.2932480666137093e-134, -4.904709857228949e-135, 4.064654851812764e-135,
      3.922185658366523e-135, -3.2094521007684665e-136, -1.9593919710050252e-135,
      -6.375236740138081e-136, 6.582587951620901e-136, 5.6201937197671386e-136,
      -8.137539009671963e-137, -2.94984592186405e-136, -8.055112706960451e-137,
      1.0529914935042059e-136, 7.990247979765095e-137, -1.7036066910688125e-137,
      -4.41347160268435e-137, -9.783290293801119e-138, 1.6666064403603489e-137,
      1.1262336210424453e-137, -3.252507436881343e-138, -6.562877245310387e-138,
      -1.1191314329689156e-138, 2.6131300394860398e-138, 1.5722675461904282e-138,
      -5.877597388995559e-139, -9.699248411169972e-139, -1.1542636875531695e-139,
      4.062716936407083e-139, 2.171122796877051e-139, -1.0236365574265746e-139,
      -1.4245427138253453e-139, -9.467867055815121e-141, 6.2677255681049095e-140,
      2.9602920050057377e-140, -1.735588642295042e-140, -2.0789076105314504e-140,
      -2.5350741706471352e-142, 9.600127993613375e-141, 3.975742488254288e-141,
      -2.8827584374057113e-141, -3.013750140598267e-141, 1.3438869492176373e-142,
      1.4604765946658532e-141, 5.241176369966379e-142, -4.7098926893789324e-142,
      -4.338473630074789e-142, 4.548003215692808e-143, 2.2074525364575903e-142,
      6.747286265655414e-143, -7.590760703785282e-143, -6.198918940604597e-143,
      1.0517169709307332e-143, 3.315545516324011e-143, 8.413990177852972e-144,
      -1.2092386325190793e-143, -8.785549083810425e-144, 2.113231185924279e-144,
      4.949219722574351e-144, 1.0024319465980726e-144, -1.9069482730554674e-144,
      -1.2340540509222404e-144, 3.940917347760909e-145, 7.342671542618583e-145,
      1.1111892007700046e-145, -2.9802411150830116e-145, -1.7160701586881005e-145,
      7.013042529902192e-146, 1.0826590376416103e-145, 1.0773443213631656e-146,
      -4.619739712724716e-146, -2.359043231197464e-146, 1.2080833672650124e-146,
      1.5863554200914936e-146, 7.361782867224752e-148, -7.107509020107437e-147,
      -3.199437764010724e-147, 2.0314132798905256e-147, 2.3093793059501014e-147,
      -2.0100761362289195e-149, -1.0858338250000553e-147, -4.2691885767920724e-148,
      3.352038941278356e-148, 3.339259508169723e-148, -2.226026316421183e-149,
      -1.6478328614334056e-148, -5.5823109388994585e-149, 5.44718837681598e-149,
      4.793929949196603e-149, -6.158793678031379e-150, -2.48473132502575e-149,
      -7.109687186535306e-150, 8.739167994967471e-150, 6.82948901834705e-150,
      -1.3342938496880095e-150, -3.72336673211987e-150, -8.733910007063301e-151,
      1.3867087410502474e-150, 9.647945322573462e-151, -2.5949409631408515e-151,
      -5.545244900329107e-151, -1.0171135703253326e-151, 2.179206196750306e-151,
      1.3503019123325486e-151, -4.744413162611409e-152, -8.208038305451556e-152,
      -1.0839218120328808e-152, 3.3950527955488764e-152, 1.8700205854786967e-152,
      -8.330325155458851e-153, -1.2074355106148701e-152, -9.639509308642916e-154,
      5.247617870835628e-153, 2.5584121639645225e-153, -1.420997328410846e-153,
      -1.7649493961115584e-153, -4.60146328052346e-155, 8.05189634029793e-154,
      3.450082163159101e-154, -2.3714348986282526e-154, -2.5629760851115953e-154,
      7.688651214284144e-156, 1.2270012465398835e-154, 4.571402670006739e-155,
      -3.8894159902587696e-155, -3.6962227075030446e-155, 3.299578502171257e-156,
      1.8575593915398519e-155, 5.92400175404973e-156, -6.288659652443625e-156,
      -5.291504724372706e-156, 8.08652153661329e-157, 2.794401129145312e-156,
      7.454328126507225e-157, -1.0045876070149262e-156, -7.515377689811435e-157,
      1.66852003300824e-157, 4.1777576540924393e-157, 8.999911335442706e-158,
      -1.5880788254181414e-157, -1.0581211155835107e-157, 3.1597126429441127e-158,
      6.2077191501352845e-158, 1.019731236608488e-158, -2.487322460342329e-158,
      -1.4753279462451741e-158, 5.679983526887314e-159, 9.167440615127896e-159,
      1.032801444469856e-159, -3.863334017592799e-159, -2.034323771449102e-159,
      9.855544648509011e-160, 1.3453986061945705e-159, 8.065013803600926e-161,
      -5.954738507671283e-160, -2.7690611366569493e-160, 1.666360277763791e-160,
      1.961845969061538e-160, 1.062209723937501e-162, -9.112997885384101e-161,
      -3.711271753743559e-161, 2.761688349495093e-161, 2.8416778535090507e-161,
      -1.470273495197984e-162, -1.3852510546177174e-161, -4.879929172733732e-162,
      4.503977909996563e-162, 4.0871455306916116e-162, -4.596888993802791e-163,
      -2.0921252815933194e-162, -6.261074693131148e-163, 7.247908484830681e-163,
      5.834248676536242e-163, -1.0382407277832207e-163, -3.1399437741961884e-163,
      -7.771295500329938e-164, 1.153111753745301e-163, 8.260088092285652e-164,
      -2.062430216587849e-164, -4.683581577093268e-164, -9.19403852657719e-165,
      1.816339998372792e-164, 1.1588985533145631e-164, -3.820043188650887e-165,
      -6.9433621354077915e-165, -1.0071528085585815e-165, 2.835691568912473e-165,
      1.6094361843747935e-165, -6.766915389294641e-166, -1.0230047049747553e-165,
      -9.525111638550923e-167, 4.39150003764577e-166, 2.209076091425636e-166,
      -1.1618252927616092e-166, -1.4977807288810823e-166, -5.961561086982128e-168,
      6.750404923902291e-167, 2.990603007176528e-167, -1.948669501923565e-167,
      -2.1786715225425297e-167, 3.400510458513058e-169, 1.0304211251345037e-167,
      3.9816446827601736e-168, -3.2089733224192154e-168, -3.1475812401405353e-168,
      2.3285415196051564e-169, 1.5624982904173807e-168, 5.191585019824664e-169,
      -5.205940936835052e-169, -4.5146474756548873e-169, 6.1551102082269394e-170,
      2.3542458407850348e-169, 6.5871016111176186e-170, -8.340189764197765e-170,
      -6.425291452166835e-170, 1.3105068226024422e-170
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 4, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.16160401632345284, -0.5227117837918154, 0.477297965933498, 0.06488849444658328,
      -0.19341456180449376, -0.08422854926533771, 0.06336462349770705, 0.06539556688917389,
      -0.0035332257029135907, -0.03204911856531556, -0.011247232369422912,
      0.010438867130777631, 0.009444886141724835, -0.0010762503744765298,
      -0.004840232903596008, -0.0014426021281147858, 0.0016792141228999336,
      0.0013479688344358528, -0.00024203888089124222, -0.0007263331425061177,
      -0.00017889200831750946, 0.00026708946205519074, 0.00019080595649742025,
      -4.7979290001441524e-05, -0.00010832523576217265, -2.1134928627377334e-05,
      4.206173117130748e-05, 2.676424734661636e-05, -8.875499693619885e-06,
      -1.6056794772883082e-05, -2.3097118659788603e-06, 6.565429281492956e-06,
      3.715971885177381e-06, -1.570882831197635e-06, -2.365392976474366e-06,
      -2.173296677869618e-07, 1.0165725920303e-06, 5.098946316690662e-07,
      -2.6954003076039616e-07, -3.4626521840104306e-07, -1.3342252660250487e-08,
      1.5623639012624995e-07, 6.900410394217799e-08, -4.518689486215686e-08,
      -5.0359889652046906e-08, 8.529918048267429e-10, 2.384504320387606e-08,
      9.183112739841755e-09, -7.4382971527149935e-09, -7.274425823049227e-09,
      5.484140808373828e-10, 3.6152380419133816e-09, 1.1967035508316781e-09,
      -1.2063360618176268e-09, -1.043204604089306e-09, 1.4381052173124873e-10,
      5.446345502862264e-10, 1.5172548525987823e-10, -1.932089035857317e-10,
      -1.4844169961320854e-10, 3.0522609648370507e-11, 8.15401105091388e-11,
      1.8519183885658028e-11, -3.0612497609136965e-11, -2.094308923339787e-11,
      5.871295560851506e-12, 1.2133015114167182e-11, 2.135118105602872e-12,
      -4.804406258666674e-12, -2.9268934139436194e-12, 1.0660965653625059e-12,
      1.7943118626932534e-12, 2.234403306855613e-13, -7.476011741365596e-13,
      -4.0467081165453326e-13, 1.862946410639953e-13, 2.6370975143956553e-13,
      1.9020119758101503e-14, -1.1542740559335886e-13, -5.525640472637544e-14,
      3.16658476770267e-14, 3.851111712217249e-14, 6.9614084828398e-16,
      -1.76929179650635e-14, -7.434083108922192e-15, 5.269959522594934e-15,
      5.586915361876591e-15, -2.145389765111675e-16, -2.693544395219554e-15,
      -9.821723516258716e-16, 8.623946145782973e-16, 8.048863541943677e-16,
      -7.905636211527541e-17, -4.073956268541938e-16, -1.2680134061587413e-16,
      1.3917607989940775e-16, 1.1509896195860888e-16, -1.8703665231597248e-17,
      -6.12305128245743e-17, -1.5874317582606702e-17, 2.2197009448564966e-17,
      1.632733175133545e-17, -3.798557898623639e-18, -9.146053337773482e-18,
      -1.902244547268898e-18, 3.504001336498092e-18, 2.2956977921699783e-18,
      -7.128357300195631e-19, -1.357797145500028e-18, -2.129062709247327e-19,
      5.481181611509476e-19, 3.196002999752343e-19, -1.2738076691622993e-19,
      -2.0033623259435562e-19, -2.1050298194538696e-20, 8.503606565890827e-20,
      4.399229769851445e-20, -2.200864515552555e-20, -2.937393861615218e-20,
      -1.5316151407494024e-21, 1.309301374656682e-20, 5.9756974259901856e-21,
      -3.7092393053567166e-21, -4.2791917924540774e-21, 1.162854691269805e-23,
      2.001715328909323e-21, 7.988836930049435e-22, -6.131743750212737e-22,
      -6.192085816834448e-22, 3.735584589273988e-23, 3.03986525859007e-22,
      1.0471154577696459e-22, -9.979231998100817e-23, -8.896512846979606e-23,
      1.082463268790345e-23, 4.586831509218114e-23, 1.3378664032041007e-23,
      -1.6030452876740358e-23, -1.268485462532244e-23, 2.384292766697633e-24,
      6.8778900675544e-24, 1.6508913808935669e-24, -2.54647558186862e-24,
      -1.7936504880867086e-24, 4.676989461954081e-25, 1.024999657350153e-24,
      1.935868197754483e-25, -4.0056868677682985e-25, -2.512972111224149e-25,
      8.596626670016334e-26, 1.518192859501991e-25, 2.0883276916631365e-26,
      -6.246095200182482e-26, -3.4843429436763524e-26, 1.5149247719852624e-26,
      2.2348102328245398e-26, 1.9097502218176666e-27, -9.662209109660287e-27,
      -4.773634203161538e-27, 2.591129475409869e-27, 3.26893614114589e-27,
      1.0424718695144064e-28, -1.4836821199617564e-27, -6.44810110394325e-28,
      4.333234601751939e-28, 4.7503843818807555e-28, -1.1350878080371221e-29,
      -2.2625513144225844e-28, -8.561442029629687e-29, 7.118952347059874e-29,
      6.85598408025359e-29, -5.675143941572984e-30, -3.427631461865229e-29,
      -1.1124073581424446e-29, 1.1526536339903941e-29, 9.822945007594118e-30,
      -1.4323196423949788e-30, -5.159761309500135e-30, -1.4048023171070803e-30,
      1.843528569187212e-30, 1.396352327523673e-30, -2.992814084847531e-31,
      -7.719138367025391e-31, -1.7049249842727087e-31, 2.9173638844862706e-31,
      1.967894142781901e-31, -5.707747070882134e-32, -1.1477338334503708e-31,
      -1.94798611908941e-32, 4.5736021087265627e-32, 2.7468217919268073e-32,
      -1.0307379862507177e-32, -1.696067336847048e-32, -2.0046601814172597e-33,
      7.109830625624303e-33, 3.792354523417712e-33, -1.7942564605997094e-33,
      -2.4907936633559406e-33, -1.634714501992221e-34, 1.096736259517674e-33,
      5.1697032296966426e-34, -3.0410827786866366e-34, -3.6345724164970166e-34,
      -4.117642185287301e-36, 1.6796622951740935e-34, 6.941227351678631e-35,
      -5.049705063459871e-35, -5.268405432080988e-35, 2.3972978979031268e-36,
      2.555021913474456e-35, 9.147563168261462e-36, -8.248364659986513e-36,
      -7.58332907324625e-36, 8.023413710996747e-37, 3.86142984498369e-36,
      1.17712149894958e-36, -1.3290988345448618e-36, -1.083393308880796e-36,
      1.849540519859705e-37, 5.799220028912539e-37, 1.4670321277003597e-37,
      -2.1169509898624463e-37, -1.5352582133178514e-37, 3.7107020945327063e-38,
      8.655849037063428e-38, 1.7462763821752666e-38, -3.337899072697351e-38,
      -2.1561678265350655e-38, 6.91382604882399e-39, 1.2840602403850586e-38,
      1.932898884229315e-39, -5.215881835787756e-39, -2.997855626189601e-39,
      1.2296134624611214e-39, 1.8931318337406253e-39, 1.868360520521527e-40,
      -8.084271522886777e-40, -4.120286006826304e-40, 2.117248915421537e-40,
      2.773616814316027e-40, 1.2637645567071897e-41, -1.2436312905858743e-40,
      -5.586825653970265e-41, 3.559018438536266e-41, 4.037350073735479e-41,
      -3.869701645966645e-43, -1.8997273610860552e-41, -7.452713382100237e-42,
      5.871199404072198e-42, 5.837194468268565e-42, -3.945649511401295e-43,
      -2.8826827395654096e-42, -9.741543887566731e-43, 9.538847097614442e-43,
      8.379061725000017e-43, -1.0848587778774388e-43, -4.3463063779217395e-43,
      -1.2401028855176383e-43, 1.5300777788673288e-43, 1.1935413833550474e-43,
      -2.344896253398079e-44, -6.5123059102245e-44, -1.5223816021448212e-44,
      2.4274988367438957e-44, 1.6858705286943978e-44, -4.5548119302774376e-45,
      -9.697909360121822e-45, -1.7710523193355454e-45, 3.814259763455411e-45,
      2.3591372422594056e-45, -8.3213863278265e-46, -1.4353406869896184e-45,
      -1.883869888205055e-46, 5.941588272493502e-46, 3.2665710267031948e-46,
      -1.4603184511336278e-46, -2.111237524227457e-46, -1.6680624486246093e-47,
      9.182624163899518e-47, 4.4681393298359e-47, -2.4900645529956737e-47,
      -3.0857567139200164e-47, -7.780941574936273e-49, 1.4088176551810274e-47,
      6.023906072860425e-48, -4.1542980249218224e-48, -4.480519481276526e-48,
      1.3843601755469129e-49, 2.146624923854439e-48, 7.979305264891095e-49,
      -6.8118478061756476e-49, -6.460910581890202e-49, 5.829374689655676e-50,
      3.2494529822477076e-49, 1.03361559596357e-49, -1.1011594384231423e-49,
      -9.248324982499612e-50, 1.4228914241825977e-50, 4.887805298837491e-50,
      1.299927515547399e-50, -1.7587500697319333e-50, -1.313343723047044e-50,
      2.9307013459944064e-51, 7.306790502762315e-51, 1.5682264143889837e-51,
      -2.7798534724983856e-51, -1.8488455564853707e-51, 5.544353885045489e-52,
      1.085610102310944e-51, 1.7746198000966617e-52, -4.353339216162692e-52,
      -2.577410016663816e-52, 9.960156339185076e-53, 1.6030532648028336e-52,
      1.7929643904232592e-53, -6.760807742238643e-53, -3.5533177461807047e-53,
      1.7274195731343215e-53, 2.3523825503296655e-53, 1.3904828911876314e-54,
      -1.0419550897324046e-53, -4.835606943435113e-54, 2.9196696761922625e-54,
      3.429868967911542e-54, 1.5586298708836964e-56, -1.5944122570370388e-54,
      -6.4792578410287745e-55, 4.837478562861011e-55, 4.967535429124381e-55,
      -2.6157923546662206e-56, -2.4233891577589044e-55, -8.516680200486554e-56,
      7.887547311386515e-56, 7.14392397990736e-56, -8.105102889175111e-57,
      -3.6596475919693312e-56, -1.0922309089046615e-56, 1.2690396407076126e-56,
      1.0196435554342679e-56, -1.8254054290512323e-57, -5.492010528437525e-57,
      -1.3548556028006656e-57, 2.018654058058366e-57, 1.4434101396338728e-57,
      -3.6210185303098896e-58, -8.191170273960853e-58, -1.601417642284276e-58,
      3.179245357905867e-58, 2.0248153908664254e-58, -6.701198013497402e-59,
      -1.214216154827647e-58, -1.7514886176389315e-59, 4.962821202671051e-59,
      2.8115113635559667e-59, -1.1863884876262953e-59, -1.788799146779005e-59,
      -1.6508659541481594e-60, 7.684756153547148e-60, 3.858254597173839e-60,
      -2.0360873337333385e-60, -2.618718591991688e-60, -1.0201374558814185e-61,
      1.1811315126211813e-60, 5.221997293126542e-61, -3.413932076532602e-61,
      -3.808792199456958e-61, 6.282410178894107e-63, 1.802756910190315e-61,
      6.950477808221042e-62, -5.620454603666538e-62, -5.502055756149021e-62,
      4.122079430607693e-63, 2.7333670273673954e-62, 9.059239882954215e-63,
      -9.116167224768182e-63, -7.890802083641579e-63, 1.0837875433734195e-63,
      4.1180115543461915e-63, 1.1488715199121836e-63, -1.4601933063250276e-63,
      -1.1228845710161545e-63, 2.3026611714620194e-64, 6.16558929944949e-64,
      1.4027777278436818e-64, -2.3137488414222697e-64, -1.584347002310652e-64,
      4.431887940892021e-65, 9.174720166824824e-65, 1.6181963358711482e-65,
      -3.6315133738007323e-65, -2.214371903682225e-65, 8.050215404749455e-66,
      1.3568846593188701e-65, 1.695177119240369e-66, -5.651263018816373e-66,
      -3.0618547931651584e-66, 1.4070846191534626e-66, 1.9943092130502365e-66,
      1.4466673473361297e-67, -8.725893939914751e-67, -4.1812980522821106e-67,
      2.3921704165110018e-67, 2.9125567315544657e-67, 5.390172767244563e-69,
      -1.3375938524212859e-67, -5.6261471774621845e-68, 3.9817296202138524e-68,
      4.225550779043501e-68, -1.6034974546945739e-69, -2.0364395342687507e-68,
      -7.434300106537444e-69, 6.516615890423611e-69, 6.087936466188819e-69,
      -5.95021574852133e-70, -3.080246362195979e-69, -9.599870758516294e-70,
      1.0517776466282038e-69, 8.706288996801277e-70, -1.410228903352587e-70,
      -4.62975625597876e-70, -1.2021500888224618e-70, 1.677609969342592e-70,
      1.2351093181781457e-70, -2.8663852962413596e-71, -6.915837889956278e-71,
      -1.4411529412821533e-71, 2.6484604779850903e-71, 1.7367469206299428e-71,
      -5.38158424399465e-72, -1.0267548768595483e-71, -1.6140956856133888e-72,
      4.143169877414808e-72, 2.4180472279736197e-72, -9.619660211090438e-73,
      -1.514999237311671e-72, -1.5980590004522052e-73, 6.428186175866823e-73,
      3.328707053779239e-73, -1.6624404109960757e-73, -2.2214503563242998e-73,
      -1.1676326140615955e-74, 9.898051088516797e-74, 4.522061443867739e-74,
      -2.8022784628243793e-74, -3.2363723407305895e-74, 7.377767047550583e-77,
      1.5133371180219053e-74, 6.046318987088456e-75, -4.63307094283771e-75,
      -4.683355363715487e-75, 2.803714554264046e-76, 2.29831695173537e-75,
      7.926425894247371e-76, -7.541022160497459e-76, -6.729222509228344e-76,
      8.154230092710869e-77, 3.4680858217296544e-76, 1.0129666427019045e-76,
      -1.2114894955673812e-76, -9.595276963007817e-77, 1.7983783652261407e-77,
      5.200597911927344e-77, 1.2503760804720857e-77, -1.9246365876555016e-77,
      -1.3568736896699101e-77, 3.52996398183699e-78, 7.750729288105015e-78,
      1.4669377204072862e-78, -3.027732776968377e-78, -1.901175997652093e-78,
      6.490904888282583e-79, 1.148065464507972e-78, 1.5838291352981616e-79,
      -4.721471950303064e-79, -2.6362901699081263e-79, 1.1441596932115453e-79,
      1.6900577265925214e-79, 1.4511886506828937e-80, -7.304175328727625e-80,
      -3.612146373221001e-80, 1.9573641504188735e-80, 2.4722312867131142e-80,
      7.989266310923654e-82, -1.121656289763825e-80, -4.879783300430023e-81,
      3.273874223234351e-81, 3.592808663554246e-81, -8.424542301065303e-83,
      -1.7105675336945012e-81, -6.480080548855853e-82, 5.379229477722726e-82,
      5.185600675897849e-82, -4.267863598748915e-83, -2.5915393428678792e-82,
      -8.4213255441408e-83, 8.710596756556853e-83, 7.430133260264257e-83,
      -1.0796147591430627e-83, -3.90134676896034e-83, -1.063760680481952e-83,
      1.393277127788399e-83, 1.0562768204235513e-83, -2.258009167255427e-84,
      -5.8367979852228855e-84, -1.2915043750352196e-84, 2.2050170551590643e-84,
      1.4887275913371354e-84, -4.308659911124843e-85, -8.678962541452287e-85,
      -1.4765045408509732e-85, 3.4570830481259485e-85, 2.078158229134409e-85,
      -7.783492966051359e-86, -1.2825983262789948e-85, -1.5211625788498327e-86,
      5.3744993158462545e-86, 2.8694378727882884e-86, -1.355237790256097e-86,
      -1.883678143141377e-86, -1.2441022715565582e-87, 8.290986012274058e-87,
      3.9120129329951407e-87, -2.297406208609461e-87, -2.748807617397921e-87,
      -3.2330802569913544e-89, 1.2698417099709726e-87, 5.253243150968603e-88,
      -3.8153760486082135e-88, -3.9846787053974245e-88, 1.794996789057837e-89,
      1.931722334796611e-88, 6.924164987124933e-89, -6.232892149088438e-89,
      -5.73585984900851e-89, 6.040795573094583e-90, 2.9195764027552825e-89,
      8.912009293210977e-90, -1.004434085326239e-89, -8.195041563081045e-90,
      1.3947073689173115e-90, 4.384927045554489e-90, 1.111018796132139e-90,
      -1.5999689042969354e-90, -1.1613825269049475e-90, 2.800286714369395e-91,
      6.545205479953282e-91, 1.323076226973896e-91, -2.5229356627029905e-91,
      -1.631204851510952e-91, 5.2198556431500195e-92, 9.710013454767105e-92,
      1.4655486690949556e-92, -3.942663213510247e-92, -2.268156560173947e-92,
      9.286198530280945e-93, 1.431648376382163e-92, 1.418768551137358e-93,
      -6.111239423033703e-93, -3.117681957380125e-93, 1.5993176418967688e-93,
      2.0976043008640416e-93, 9.645916543550686e-95, -9.401661766545834e-94,
      -4.2278503553317695e-94, 2.6888372126054317e-94, 3.053485967712271e-94,
      -2.792191558812184e-96, -1.436241297318853e-94, -5.64066289606211e-95,
      4.4362717757072905e-95, 4.414964964586622e-95, -2.9636998442581643e-96,
      -2.1794910416529827e-95, -7.374307662185035e-96, 7.208324174360585e-96,
      6.33787454807579e-96, -8.174049972263254e-97, -3.2862452294566623e-96,
      -9.389761840498214e-97, 1.1563570249075906e-96, 9.028445016011456e-97,
      -1.7688414599959866e-97, -4.924196610408791e-97, -1.1530995748903347e-97,
      1.834730452662782e-97, 1.2753507718834997e-97, -3.437951590731321e-98,
      -7.333300929957177e-98, -1.3421515305928662e-98, 2.883064843462581e-98,
      1.7848107948278196e-98, -6.2833263642488996e-99, -1.0854186192985147e-98,
      -1.4289816077064202e-99, 4.491326704737935e-99, 2.471550037527601e-99,
      -1.102948259984322e-99, -1.5966164672323078e-99, -1.26806006748088e-100,
      6.941680209004046e-100, 3.3810282499625257e-100, -1.8810581467324327e-100,
      -2.333710913990908e-100, -5.984471303860909e-102, 1.06506612342605e-100,
      4.5588368106217896e-101, -3.138735041809701e-101, -3.388726768011343e-101,
      1.0318001795427168e-102, 1.6229333039684825e-101, 6.039591581764518e-102,
      -5.147245155068865e-102, -4.886816457959319e-102, 4.385769976700538e-103,
      2.4568382593804904e-102, 7.825056848978328e-103, -8.321551539282001e-103,
      -6.995539936421649e-103, 1.0726766794187269e-103, 3.6957399529990743e-103,
      9.843835784379715e-104, -1.32921768210883e-103, -9.934927958468681e-104,
      2.2113250225005917e-104, 5.525034964558901e-104, 1.1880215457475145e-104,
      -2.1011018353386686e-104, -1.398679263626272e-104, 4.185524959969754e-105,
      8.20924183316914e-105, 1.3452312184424647e-105, -3.290617557703515e-105,
      -1.950007075336467e-105, 7.521545303091637e-106, 1.21226652183259e-105,
      1.3608094310192897e-106, -5.110701587385139e-106, -2.688606412627926e-106,
      1.3047868505499336e-106, 1.7790147391991774e-106, 1.0590014822415774e-107,
      -7.876911064664568e-107, -3.659249081567822e-107, 2.205726058315335e-107,
      2.594007970181997e-107, 1.2916579445146453e-109, -1.2053995808447388e-107,
      -4.903704157413328e-108, 3.655081556753855e-108, 3.757145390015124e-108,
      -1.9611765019609815e-109, -1.8322127899736935e-108, -6.446771116169573e-109,
      5.960316067963244e-109, 5.403542393210397e-109, -6.104005650833508e-110,
      -2.7670280399200456e-109, -8.269554372857422e-110, 9.590562835223866e-110,
      7.712883401624075e-110, -1.3766713969462062e-110, -4.1526630902840314e-110,
      -1.0261098121927403e-110, 1.5256916894599092e-110, 1.0919112366793905e-110,
      -2.73278772415657e-111, -6.193870237870374e-111, -1.213406872958668e-111,
      2.4030384162597322e-111, 1.5318476047291381e-111, -5.05953889394593e-112,
      -9.181909195114452e-112, -1.3281684715676162e-112, 3.751404690691871e-112,
      2.1271933025749877e-112, -8.960025427606174e-113, -1.3527566839068097e-112,
      -1.2539940324959907e-113, 5.809270370417854e-113, 2.91944945582217e-113,
      -1.53804456849517e-113, -1.9804716096130902e-113, -7.798934206157574e-115,
      8.929232534428811e-114, 3.951826996987749e-114, -2.5792697989064044e-114,
      -2.8806441194108105e-114, 4.623793573998803e-116, 1.3629378391907664e-114,
      5.260643306466171e-115, -4.246870048925963e-115, -4.161511155937723e-115,
      3.098191206313633e-116, 2.0666114698014454e-115, 6.857980134606039e-116,
      -6.888995884139899e-116, -5.968601727220949e-116, 8.167564204597072e-117,
      3.1136498275234556e-116, 8.699281917100215e-117, -1.1035532279728465e-116,
      -8.49403577258597e-117, 1.737144382194626e-117, 4.66205858029114e-117,
      1.0625623282841894e-117, -1.7487728937401047e-117, -1.1985595581469174e-117,
      3.345354195932283e-118, 6.9377197551624385e-118, 1.2264167858024762e-118,
      -2.744955737534766e-118, -1.6753051899634667e-118, 6.078794434147436e-119,
      1.0260954741564374e-118, 1.286067256178626e-119, -4.2718978552715994e-119,
      -2.3166849247077653e-119, 1.0627701404311607e-119, 1.5081989468378625e-119,
      1.1002950638349556e-120, -6.596456971883833e-120, -3.16402013516375e-120,
      1.8071431528115638e-120, 2.202736230957228e-120, 4.171284862857437e-122,
      -1.0112275281290297e-120, -4.2578885481648454e-121, 3.0084015814415375e-121,
      3.1959087736883746e-121, -1.1983142434349582e-122, -1.5396383801245576e-121,
      -5.627193751281376e-122, 4.924224487046766e-122, 4.604743698256553e-122,
      -4.478360135894527e-123, -2.328918962241902e-122, -7.267852843454827e-123,
      7.948459422866947e-123, 6.585587718617568e-123, -1.06328264385737e-123,
      -3.500645989749713e-123, -9.10376815294001e-124, 1.2679065878348654e-123,
      9.343193551404218e-124, -2.1629593630259376e-124, -5.22944641613434e-124,
      -1.091822532970603e-124, 2.00180831499892e-124, 1.31388724601699e-124,
      -4.0628384609526753e-125, -7.76423182966821e-125, -1.2236776342080504e-125,
      3.1317787355460065e-125, 1.8294564729582052e-125, -7.264650476834299e-126,
      -1.1456848237202975e-125, -1.213166517876351e-126, 4.859298006863932e-126,
      2.518686753723746e-126, -1.2557356194127363e-126, -1.680006148062397e-126,
      -8.900900774613871e-128, 7.482721321494218e-127, 3.4220306915915304e-127,
      -2.1170797405828875e-127, -2.4476822128560373e-127, 4.5085942646212294e-130,
      1.144112884040811e-127, 4.576126661244441e-128, -3.500688690893506e-128,
      -3.542232554607008e-128, 2.1041878961381425e-129, 1.737662130354463e-128,
      6.000114926632133e-129, -5.698531727195673e-129, -5.08990604786053e-129,
      6.142516674042165e-130, 2.622205472683284e-129, 7.669669249588853e-130,
      -9.155735096191929e-130, -7.25820643218651e-130, 1.3564370361281357e-130,
      3.93234091188133e-130, 9.470251209840143e-131, -1.4546472827530663e-130,
      -1.026457044523544e-130, 2.664234697968357e-131, 5.86085874429656e-131,
      1.1115921014738797e-131, -2.288536568549576e-131, -1.4383239177043704e-131,
      4.900961899395348e-132, 8.681728448037674e-132, 1.201196318677833e-132,
      -3.5689956426414836e-132, -1.9946431567260283e-132, 8.641346885555759e-133,
      1.2780924201199326e-132, 1.1027081600811629e-133, -5.5216102926904e-133,
      -2.733261427912241e-133, 1.478609708504797e-133, 1.8696985304878146e-133,
      6.121700855446755e-135, -8.47966208505597e-134, -3.6929105047698734e-134,
      2.473496558817792e-134, 2.717310361292827e-134, -6.250419498592438e-136,
      -1.2932480666136824e-134, -4.904709857229158e-135, 4.064654851812555e-135,
      3.922185658366537e-135, -3.209452100767437e-136, -1.9593919710049907e-135,
      -6.375236740138424e-136, 6.5825879516206e-136, 5.6201937197671775e-136,
      -8.137539009670397e-137, -2.9498459218640045e-136, -8.055112706960999e-137,
      1.0529914935041625e-136, 7.990247979765178e-137, -1.7036066910685762e-137,
      -4.413471602684294e-137, -9.783290293801996e-138, 1.6666064403602873e-137,
      1.1262336210424615e-137, -3.2525074368809893e-138, -6.562877245310321e-138,
      -1.119131432969054e-138, 2.6131300394859536e-138, 1.5722675461904583e-138,
      -5.877597388995035e-139, -9.6992484111699e-139, -1.154263687553385e-139,
      4.0627169364069636e-139, 2.171122796877104e-139, -1.0236365574264972e-139,
      -1.4245427138253388e-139, -9.467867055818477e-141, 6.267725568104744e-140,
      2.9602920050058276e-140, -1.7355886422949282e-140, -2.078907610531447e-140,
      -2.535074170652321e-142, 9.600127993613152e-141, 3.975742488254441e-141,
      -2.882758437405544e-141, -3.013750140598271e-141, 1.3438869492168376e-142,
      1.4604765946658232e-141, 5.241176369966633e-142, -4.7098926893786884e-142,
      -4.3384736300748095e-142, 4.548003215691584e-143, 2.2074525364575506e-142,
      6.747286265655828e-143, -7.590760703784931e-143, -6.198918940604649e-143,
      1.051716970930548e-143, 3.315545516323961e-143, 8.413990177853636e-144,
      -1.209238632519029e-143, -8.785549083810533e-144, 2.113231185924e-144,
      4.94921972257429e-144, 1.0024319465981784e-144, -1.9069482730553962e-144,
      -1.2340540509222613e-144, 3.940917347760493e-145, 7.342671542618515e-145,
      1.1111892007701721e-145, -2.9802411150829127e-145, -1.7160701586881396e-145,
      7.01304252990157e-146, 1.0826590376416036e-145, 1.07734432136343e-146,
      -4.619739712724576e-146, -2.359043231197531e-146, 1.2080833672649204e-146,
      1.586355420091488e-146, 7.361782867228842e-148, -7.107509020107245e-147,
      -3.199437764010838e-147, 2.0314132798903895e-147, 2.3093793059501e-147,
      -2.0100761362225985e-149, -1.0858338250000292e-147, -4.269188576792263e-148,
      3.3520389412781584e-148, 3.339259508169733e-148, -2.2260263164202173e-149,
      -1.6478328614333712e-148, -5.582310938899772e-149, 5.447188376815693e-149,
      4.7939299491966354e-149, -6.158793678029905e-150, -2.4847313250257058e-149,
      -7.109687186535818e-150, 8.739167994967058e-150, 6.829489018347123e-150,
      -1.3342938496877876e-150, -3.7233667321198145e-150, -8.733910007064113e-151,
      1.3867087410501888e-150, 9.647945322573605e-151, -2.5949409631405198e-151,
      -5.5452449003290405e-151, -1.0171135703254608e-151, 2.1792061967502232e-151,
      1.350301912332575e-151, -4.744413162610915e-152, -8.208038305451481e-152,
      -1.0839218120330817e-152, 3.39505279554876e-152, 1.8700205854787438e-152,
      -8.330325155458118e-153, -1.2074355106148627e-152, -9.639509308646048e-154,
      5.247617870835467e-153, 2.5584121639646046e-153, -1.4209973284107375e-153,
      -1.764949396111553e-153, -4.601463280528362e-155, 8.051896340297707e-154,
      3.450082163159241e-154, -2.3714348986280926e-154, -2.5629760851115967e-154,
      7.688651214276592e-156, 1.2270012465398538e-154, 4.571402670006972e-155,
      -3.889415990258537e-155, -3.6962227075030603e-155, 3.299578502170106e-156,
      1.857559391539813e-155, 5.924001754050113e-156, -6.288659652443291e-156,
      -5.291504724372751e-156, 8.086521536611539e-157, 2.794401129145263e-156,
      7.454328126507847e-157, -1.0045876070148779e-156, -7.515377689811531e-157,
      1.6685200330079747e-157, 4.177757654092377e-157, 8.9999113354437e-158,
      -1.5880788254180722e-157, -1.0581211155835295e-157, 3.159712642943714e-158,
      6.207719150135213e-158, 1.0197312366086457e-158, -2.4873224603422333e-158,
      -1.4753279462452097e-158, 5.679983526886721e-159, 9.167440615127826e-159,
      1.0328014444701051e-159, -3.863334017592665e-159, -2.0343237714491645e-159,
      9.855544648508139e-160, 1.3453986061945646e-159, 8.065013803604786e-161,
      -5.954738507671101e-160, -2.7690611366570567e-160, 1.6663602777636628e-160,
      1.9618459690615368e-160, 1.0622097239434394e-162, -9.112997885383858e-161,
      -3.711271753743739e-161, 2.761688349494907e-161, 2.8416778535090605e-161,
      -1.470273495197078e-162, -1.3852510546176856e-161, -4.879929172734028e-162,
      4.503977909996295e-162, 4.087145530691643e-162, -4.5968889938014113e-163,
      -2.0921252815932787e-162, -6.261074693131629e-163, 7.247908484830297e-163,
      5.834248676536314e-163, -1.0382407277830121e-163, -3.1399437741961384e-163,
      -7.77129550033071e-164, 1.1531117537452467e-163, 8.260088092285796e-164,
      -2.0624302165875372e-164, -4.6835815770932095e-164, -9.194038526578415e-165,
      1.8163399983727152e-164, 1.1588985533145895e-164, -3.8200431886504215e-165,
      -6.943362135407728e-165, -1.007152808558774e-165, 2.8356915689123656e-165,
      1.6094361843748408e-165, -6.766915389293946e-166, -1.0230047049747492e-165,
      -9.52511163855393e-167, 4.391500037645621e-166, 2.2090760914257165e-166,
      -1.1618252927615066e-166, -1.4977807288810784e-166, -5.961561086986745e-168,
      6.750404923902088e-167, 2.9906030071766617e-167, -1.9486695019234167e-167,
      -2.1786715225425328e-167, 3.4005104585059977e-169, 1.0304211251344768e-167,
      3.9816446827603953e-168, -3.208973322419001e-168, -3.147581240140552e-168,
      2.3285415196040832e-169, 1.5624982904173454e-168, 5.191585019825023e-169,
      -5.205940936834743e-169, -4.514647475654931e-169, 6.1551102082253156e-170,
      2.35424584078499e-169, 6.5871016111181996e-170, -8.340189764197322e-170,
      -6.4252914521669284e-170, 1.3105068226021973e-170
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_5_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<5>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 5, "order");
    static_assert(design.b().size() == 6, "b.size");
    static_assert(design.a().size() == 6, "a.size");

    static_assert(almost_equal(design.b()[0], 0.24369262561195829), "design.b()[0] == 0.24369262561195829");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.24369262561195829));
    static_assert(almost_equal(design.b()[1], -1.1992472366603957), "design.b()[1] == -1.1992472366603957");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -1.1992472366603957));
    static_assert(almost_equal(design.b()[2], 2.3795828227747955), "design.b()[2] == 2.3795828227747955");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 2.3795828227747955));
    static_assert(almost_equal(design.b()[3], -2.3795828227747955), "design.b()[3] == -2.3795828227747955");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -2.3795828227747955));
    static_assert(almost_equal(design.b()[4], 1.199247236660396), "design.b()[4] == 1.199247236660396");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 1.199247236660396));
    static_assert(almost_equal(design.b()[5], -0.2436926256119584), "design.b()[5] == -0.2436926256119584");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -0.2436926256119584));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -2.2497126486673595), "design.a()[1] == -2.2497126486673595");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -2.2497126486673595));
    static_assert(almost_equal(design.a()[2], 2.4482152939907014), "design.a()[2] == 2.4482152939907014");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 2.4482152939907014));
    static_assert(almost_equal(design.a()[3], -1.4365779066586317), "design.a()[3] == -1.4365779066586317");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -1.4365779066586317));
    static_assert(almost_equal(design.a()[4], 0.4511765064878726), "design.a()[4] == 0.4511765064878726");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 0.4511765064878726));
    static_assert(almost_equal(design.a()[5], -0.05936301428973123), "design.a()[5] == -0.05936301428973123");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -0.05936301428973123));
    std::cout << "max_deviation(cheby2,highpass,5,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.24369262561195829, -0.6510088544342137, 0.31838795550375054, 0.2805918638243139,
      0.005842714932594251, -0.15192215623387995, -0.13528836159092508,
      -0.031724264830615856, 0.05561722601929721, 0.07732888479650334, 0.04425082214322651,
      -0.0035855279727192158, -0.03228941345228331, -0.031881373909520117,
      -0.013197840213200113, 0.006219429323346754, 0.014858382691151304,
      0.011708193814173321, 0.002960227711905787, -0.004248817103294986,
      -0.006320708899678852, -0.003965585615237853, -0.00019128022171245596,
      0.0022907855562624728, 0.002524564493195124, 0.00121038222945862,
      -0.0003158812459036239, -0.0010920883401846222, -0.000947767538348909,
      -0.00030855552890115645, 0.00027167785929503715, 0.00047903851426603936,
      0.00033208984995243703, 4.755439695169742e-05, -0.00015875902899565697,
      -0.00019651596276423452, -0.00010650653639809437, 1.1692997737821584e-05,
      7.919764224000889e-05, 7.577899553558626e-05, 2.9773455096968006e-05,
      -1.6366149117716397e-05, -3.588651398436238e-05, -2.738289175917459e-05,
      -6.191587664652247e-06, 1.0707612201038052e-05, 1.5129340964281056e-05,
      9.151617533439594e-06, 9.891280242896425e-08, -5.646702028493278e-06,
      -5.98897231933502e-06, -2.7379001094995927e-06, 8.895182105009585e-07,
      2.654035029830495e-06, 2.2267556367217127e-06, 6.695261365255916e-07,
      -6.964674224897623e-07, -1.1517215163008602e-06, -7.712221213725065e-07,
      -8.578317921163855e-08, 3.945674325230675e-07, 4.6804365894022953e-07,
      2.4333113843144486e-07, -3.869836257879141e-08, -1.9351793447605914e-07,
      -1.788012751335949e-07, -6.60719466680088e-08, 4.3002194898434975e-08,
      8.665246474941486e-08, 6.393014268698557e-08, 1.2652491725180621e-08,
      -2.6891075965252535e-08, -3.6175403344283e-08, -2.107265588132972e-08,
      6.132085974915489e-10, 1.388486809964633e-08, 1.4188341623200293e-08,
      6.167473377355011e-09, -2.441979027078432e-09, -6.4385200162130335e-09,
      -5.223472306662622e-09, -1.4368780284555465e-09, 1.7740698834140012e-09,
      2.7649550413932147e-09, 1.7873601095230048e-09, 1.38635573908156e-10,
      -9.775948896566671e-10, -1.1132038966143351e-09, -5.541441484387413e-10,
      1.178604547621555e-10, 4.719098842875019e-10, 4.2126109273496345e-10,
      1.4562882016047527e-10, -1.1185107280519206e-10, -2.089072003713209e-10,
      -1.4898763330180676e-10, -2.510931424446675e-11, 6.726313402182402e-11,
      8.637759219653214e-11, 4.839700097917865e-11, -3.4784870684098234e-12,
      -3.406184416032018e-11, -3.3565811948310575e-11, -1.3827777145556538e-11,
      6.577719743087997e-12, 1.559286130629833e-11, 1.2233196120220872e-11,
      3.0421017879375304e-12, -4.493854057465009e-12, -6.6283205825407155e-12,
      -4.133369643316934e-12, -1.7343506020915368e-13, 2.415210526903394e-12,
      2.6440023305279133e-12, 1.2575393464223893e-12, -3.414661428566774e-13,
      -1.1485943041108967e-12, -9.910088166115987e-13, -3.1843790541760933e-13,
      2.884767842848827e-13, 5.028813554169663e-13, 3.465602869369031e-13,
      4.776104169860903e-14, -1.6763471194948804e-13, -2.0596179468025763e-13,
      -1.1084383819268945e-13, 1.3075910655218248e-14, 8.337454075276014e-14,
      7.929412661539225e-14, 3.0838360888791245e-14, -1.7457187763661208e-14,
      -3.77008210239325e-14, -2.8601634896453236e-14, -6.330748986241768e-15,
      1.1327358417300824e-14, 1.5867274645991977e-14, 9.536733562225507e-15,
      3.944445273522027e-17, -5.95111242318874e-15, -6.2711160700267116e-15,
      -2.842760544313279e-15, 9.567441325078581e-16, 2.790486076312275e-15,
      2.327733480724007e-15, 6.897726659888195e-16, -7.386670805159428e-16,
      -1.208736717147713e-15, -8.045490602572079e-16, -8.493723408292776e-17,
      4.163966988794109e-16, 4.904242559052704e-16, 2.531053105157092e-16,
      -4.250242014003352e-17, -2.0365241161391236e-16, -1.8704817346662015e-16,
      -6.835983840007749e-17, 4.578283832320898e-17, 9.100867068609498e-17,
      6.675519947625311e-17, 1.2880420884879894e-17, -2.842699601982633e-17,
      -3.79307380052976e-17, -2.1949955245340093e-17, 7.953730725336407e-19,
      1.4627330157290726e-17, 1.485317008368177e-17, 6.39874777521812e-18,
      -2.6169841713174737e-18, -6.767530547733646e-18, -5.458837696446538e-18,
      -1.4771817849917676e-18, 1.8796612538305708e-18, 2.901109826542023e-18,
      1.863919635113033e-18, 1.3343861860223504e-19, -1.0311566890575103e-18,
      -1.1661571840168881e-18, -5.760681444420281e-19, 1.281226624210257e-19,
      4.96457360816887e-19, 4.405779285055539e-19, 1.504792284222114e-19,
      -1.1889799979470695e-19, -2.1935151447148917e-19, -1.5552204534054354e-19,
      -2.540507842400402e-20, 7.105866896562061e-20, 9.054725990875329e-20,
      5.03885474163341e-20, -4.0082030240054896e-21, -3.586924842788766e-20,
      -3.513002359115951e-20, -1.43338822520372e-20, 7.02939810524048e-21,
      1.6384963012770737e-20, 1.2780774638764543e-20, 3.1191181667969028e-21,
      -4.75709421836528e-21, -6.953013468508365e-21, -4.3087597376859175e-21,
      -1.5350135331569536e-22, 2.546341425015758e-21, 2.769112702481859e-21,
      1.3064585269546884e-21, -3.687347235125587e-22, -1.2079545202052144e-21,
      -1.0361792105800294e-21, -3.2854941986786838e-22, 3.062469896726546e-22,
      5.278867753383357e-22, 3.6164004874055484e-22, 4.7876432562226865e-23,
      -1.769891344989707e-22, -2.1585277149012314e-22, -1.1534752266124873e-22,
      1.4563917143685854e-23, 8.776630384164719e-23, 8.296874738104474e-23,
      3.1935655815980386e-23, -1.8614448274519152e-23, -3.960498762581868e-23,
      -2.9873084319296286e-23, -6.468767046870832e-24, 1.198142318106018e-23,
      1.664051095762473e-23, 9.9373390579755e-24, -2.594883504808686e-26,
      -6.271474652721958e-24, -6.566279980061549e-24, -2.951263518497382e-24,
      1.0283281816724967e-24, 2.9338002748570958e-24, 2.4331764605947784e-24,
      7.10393295719623e-25, -7.832797984399925e-25, -1.268519753233033e-24,
      -8.392648657689059e-25, -8.380985307437855e-26, 4.393940723132855e-25,
      5.138540631249206e-25, 2.632467480856992e-25, -4.658027623086427e-26,
      -2.143050450631526e-25, -1.9566688803718718e-25, -7.071240181245705e-26,
      4.8729236791285136e-26, 9.557949149326981e-26, 6.970136354566758e-26,
      1.31006094596025e-26, -3.004713976765871e-26, -3.9769610581340586e-26,
      -2.2862013706786126e-26, 9.935461339564645e-28, 1.5408436212283674e-26,
      1.5548500388704756e-26, 6.63775474044181e-27, -2.803039333319131e-27,
      -7.112998103454501e-27, -5.704533095310764e-27, -1.5179870379567118e-27,
      1.9912172271477274e-27, 3.043840223010396e-27, 1.9436330447739116e-27,
      1.2742014366209557e-28, -1.087562539882789e-27, -1.2215793973092643e-27,
      -5.987964512987052e-28, 1.390920368847575e-28, 5.22252482501945e-28,
      4.6075994546717775e-28, 1.5545376528748412e-28, -1.26358286817961e-28,
      -2.3030769185884958e-28, -1.6233397337495994e-28, -2.567049035935089e-29,
      7.506044213643744e-29, 9.491432458449407e-29, 5.245769103074637e-29,
      -4.5805090185710025e-30, -3.77701145663953e-29, -3.6765571561561185e-29,
      -1.4856134668691778e-29, 7.508953116012833e-30, 1.7216470595194524e-29,
      1.335219724499442e-29, 3.196400348223149e-30, -5.035038091170661e-30,
      -7.293306497022734e-30, -4.491284612209096e-30, -1.3125383863351874e-31,
      2.6843841317577345e-30, 2.900023851735939e-30, 1.3571231328041808e-30,
      -3.978162766569586e-31, -1.2703144029500844e-30, -1.0833588747743567e-30,
      -3.388850046827354e-31, 3.250445566880269e-31, 5.541113185948879e-31,
      3.7735385701403822e-31, 4.7891273357951545e-32, -1.868475053460408e-31,
      -2.2620951431932822e-31, -1.2002341694659194e-31, 1.6163840268674114e-32,
      9.238374541472006e-32, 8.680991784327422e-32, 3.3065954901752926e-32,
      -1.9841720753230946e-32, -4.1603377829881134e-32, -3.119943871142392e-32,
      -6.605207302643177e-33, 1.267164417411547e-32, 1.745070567802195e-32,
      1.0354017194648603e-32, -9.769539359268765e-35, -6.608604745643007e-33,
      -6.875051411950001e-33, -3.06351277096375e-33, 1.104530549150242e-33,
      3.084315909774993e-33, 2.5432761480814438e-33, 7.313765360957884e-34,
      -8.304380121172951e-34, -1.3312024105690353e-33, -8.754246439124128e-34,
      -8.237606663130068e-35, 4.636203875258844e-34, 5.383812432422373e-34,
      2.737677768332458e-34, -5.094925725311152e-35, -2.2550176572736097e-34,
      -2.0467374887036193e-34, -7.313048304333684e-35, 5.185076334447667e-35,
      1.0037529686394267e-34, 7.277362934405447e-35, 1.3311783745987688e-35,
      -3.175598241501707e-35, -4.1695917935518217e-35, -2.3810109395307191e-35,
      1.208834885317175e-36, 1.6230151415646899e-35, 1.627569951406588e-35,
      6.884694236015654e-36, -3.0007935850705425e-36, -7.475729603024308e-36,
      -5.96099760029286e-36, -1.5592476297606393e-36, 2.109062162259489e-36,
      3.1934576766032085e-36, 2.02662341972559e-36, 1.205136355594988e-37,
      -1.146959594679964e-36, -1.2795831943489164e-36, -6.223548505566404e-37,
      1.5081230748354596e-37, 5.493573480894558e-37, 4.818448450986622e-37,
      1.6055298205680871e-37, -1.3425504537344994e-37, -2.418003369454953e-37,
      -1.694347200046447e-37, -2.5901952882321484e-38, 7.927933126340868e-38,
      9.948794324602865e-38, 5.460720795609205e-38, -5.198245119846277e-39,
      -3.9769167946278923e-38, -3.847563105410161e-38, -1.5394897863189846e-38,
      8.017998446273597e-39, 1.8089306163192613e-38, 1.3948467430885627e-38,
      3.273793825500132e-39, -5.3284784026987054e-39, -7.649934633863702e-39,
      -4.681217573496553e-39, -1.0651755676068828e-40, 2.8296940210618335e-39,
      3.03699884363925e-39, 1.4095859760663266e-39, -4.288206703975954e-40,
      -1.3358224557803104e-39, -1.1326346426163976e-39, -3.4944248705014838e-40,
      3.4492632868579173e-40, 5.816132830726963e-40, 3.937271834806632e-40,
      4.779566725982381e-41, -1.972362177142327e-40, -2.370535069047617e-40,
      -1.2487748605623648e-40, 1.7882918662366428e-41, 9.72382113721951e-41,
      9.082499826532631e-41, 3.422985420793845e-41, -2.1143004473029754e-41,
      -4.37005638444163e-41, -3.25829841075447e-41, -6.739596193730466e-42,
      1.3399954903867921e-41, 1.8299590663921954e-41, 1.0787370800537901e-41,
      -1.7625072158147127e-43, -6.963359590594953e-42, -7.198043544507122e-42,
      -3.179613463038643e-42, 1.1856261546441654e-42, 3.242387618077683e-42,
      2.6582320238781908e-42, 7.52708923350871e-43, -8.802811991484822e-43,
      -1.3969226257468218e-42, -9.130855316165462e-43, -8.060917208235466e-44,
      4.8913957446518614e-43, 5.640561186703501e-43, 2.846810444270947e-43,
      -5.562770877532788e-44, -2.3726977655283037e-43, -2.1408578073164106e-43,
      -7.561485813317779e-44, 5.515730114763752e-44, 1.0540694787326745e-43,
      7.597718653696732e-44, 1.3512566176076255e-44, -3.355823085182671e-44,
      -4.37137348432961e-44, -2.479556159761631e-44, 1.4424150246386453e-45,
      1.7094538777159441e-44, 1.7036194046719586e-44, 7.13976730258339e-45,
      -3.210932324785512e-45, -7.856570771518503e-45, -6.228688212895007e-45,
      -1.600911811644036e-45, 2.2335375370634846e-45, 3.3502880880811955e-45,
      2.11301825629626e-45, 1.126481319619932e-46, -1.2095024497764427e-45,
      -1.3402862505825593e-45, -6.467697128790237e-46, 1.6332973806643082e-46,
      5.778370867527679e-46, 5.0387191704314166e-46, 1.6577719277690355e-46,
      -1.4261263392384722e-46, -2.538552138850668e-46, -1.768360215583749e-46,
      -2.6095595333406485e-47, 8.372677367274693e-47, 1.0427768842143388e-46,
      5.683995881484052e-47, -5.864423803258642e-48, -4.187136798781333e-47,
      -4.026351458946691e-47, -1.5950532373826171e-47, 8.558237131981239e-48,
      1.9005483783928117e-47, 1.4570629054155966e-47, 3.351128677534783e-48,
      -5.638249423076307e-48, -8.023666763172778e-48, -4.878841424911602e-48,
      -7.910620317288772e-50, 2.982644342174741e-48, 3.1803123767651276e-48,
      1.4639008469986694e-48, -4.6186405602323195e-49, -1.404634391642151e-48,
      -1.1840969665760557e-48, -3.602189625596652e-49, 3.659521909811938e-49,
      6.1045369981349865e-49, 4.1078645715371386e-49, 4.75790048113234e-50,
      -2.0818301433318553e-49, -2.4840720164528256e-49, -1.299158637350081e-49,
      1.9728822518669867e-50, 1.023416066125823e-49, 9.502166446245067e-50,
      3.5427929749181954e-50, -2.252251802946329e-50, -4.590133548313703e-50,
      -3.4026097128949595e-50, -6.871418505830747e-51, 1.416838951965218e-50,
      1.918897723250928e-50, 1.1238022866707653e-50, -2.6209908457011227e-52,
      -7.336638939642506e-51, -7.535896470318276e-51, -3.299672071224315e-51,
      1.2719054490088528e-51, 3.40838716479163e-51, 2.778251787194142e-51,
      7.743748573508801e-52, -9.329562436771515e-52, -1.465824766908097e-51,
      -9.523067624277882e-52, -7.848062604425929e-53, 5.160188125370009e-52,
      5.909312658448465e-52, 2.9599952254097665e-52, -6.063505262840467e-53,
      -2.4963761373076928e-52, -2.2392073148851614e-52, -7.816622433611883e-53,
      5.865927042957446e-53, 1.1068581979634397e-52, 7.931742702778339e-53,
      1.3701468348884754e-53, -3.5458835377564987e-53, -4.582732192139357e-53,
      -2.5819731711627658e-53, 1.69553482516029e-54, 1.800376394311935e-53,
      1.7831472698201949e-53, 7.403175694390573e-54, -3.4341792383545876e-54,
      -8.256407969435071e-54, -6.50808052736165e-54, -1.6429218162003124e-54,
      2.3650028296312915e-54, 3.5146724694335985e-54, 2.202949601057611e-54,
      1.0374795119555682e-55, -1.2753535141513366e-54, -1.4038114762214783e-54,
      -6.720679942084483e-55, 1.7669326749203725e-55, 6.077600031415476e-55,
      5.26882103074385e-55, 1.7112645023656968e-55, -1.5145672328486198e-55,
      -2.6649930012211004e-55, -1.8455006321208467e-55, -2.624725578136045e-56,
      8.84147944497399e-56, 1.0929356653110382e-55, 5.915889032096622e-56,
      -6.582239823077282e-57, -4.408191952903003e-56, -4.213267774364161e-56,
      -1.6523394679770165e-56, 9.131466359984421e-57, 1.9967113795423489e-56,
      1.5219767858345663e-56, 3.428218454021363e-57, -5.96522909103844e-57,
      -8.415307217662417e-57, -5.084448737234197e-57, -4.882145078951675e-59,
      3.1436271007711955e-57, 3.3302512820614154e-57, 1.5201224842747547e-57,
      -4.970692128720622e-58, -1.4769134762783986e-57, -1.237840061783907e-57,
      -3.7121073023223666e-58, 3.881852292837391e-58, 6.406964584832063e-58,
      4.285590964754496e-58, 4.722991881915761e-59, -2.197170549773461e-58,
      -2.602940621478343e-58, -1.3514485468304735e-58, 2.170967799950785e-59,
      1.0770642204341544e-58, 9.94079208165901e-59, 3.6660734180759566e-59,
      -2.3984710994813015e-59, -4.8210710316487435e-59, -3.553124831522057e-59,
      -7.000114488461395e-60, 1.4979087930913343e-59, 2.01207597227373e-59,
      1.170661706891924e-59, -3.557552049669479e-61, -7.729387510045237e-60,
      -7.889278339857753e-60, -3.4237962674014706e-60, 1.3636752589105098e-60,
      3.5827042542432385e-60, 2.9035516765324714e-60, 7.963564285061698e-61,
      -9.886178196295898e-61, -1.5380599272345194e-60, -9.9314973374586e-61,
      -7.595993057540563e-62, 5.44328692347197e-61, 6.190616134529356e-61,
      3.077365083231068e-61, -6.5991847086573884e-62, -2.6263521078709623e-61,
      -2.341971015641812e-61, -8.078519076326368e-62, 6.236765681148581e-62,
      1.1622382596255483e-61, 8.279995219489479e-62, 1.3876883637473012e-62,
      -3.7463002008507104e-62, -4.804113390012585e-62, -2.688402419577066e-62,
      1.96951933695024e-63, 1.8960100202898517e-62, 1.8663088919416794e-62,
      7.675121477858115e-63, -3.6712983637153544e-63, -8.67617010723176e-63,
      -6.79966944302144e-63, -1.6852134020341996e-63, 2.5038364437462876e-63,
      3.68696762921038e-63, 2.2965541885824018e-63, 9.373240619978177e-65,
      -1.344683396231651e-63, -1.4702872424861163e-63, -6.98277230187131e-64,
      1.9095465764848224e-64, 6.391977292384309e-64, 5.5091806347667296e-64,
      1.7660052021866193e-64, -1.6081436536109775e-64, -2.7976084235867076e-64,
      -1.9258949454086278e-64, -2.63524621794552e-65, 9.335603598955444e-65,
      1.1454603706380762e-64, 6.156703683869881e-65, -7.355080625828523e-66,
      -4.640628473517111e-65, -4.408672510477107e-65, -1.7113835969992742e-65,
      9.739582503226747e-66, 2.0976407317989183e-65, 1.5897013044117996e-65,
      3.5048589898830333e-66, -6.310341245643329e-66, -8.825697376081527e-66,
      -5.298342123049036e-66, -1.5452234188028578e-68, 3.313053982662664e-66,
      3.4871150426098316e-66, 1.5783065401046124e-66, -5.345659115381468e-67,
      -1.5528308875355546e-66, -1.2939620549377742e-66, -3.824132230389307e-67,
      4.116918961923604e-67, 6.724084384670931e-67, 4.470735422964554e-67,
      4.6736236593490074e-68, -2.3186898731791926e-67, -2.727386075837788e-67,
      -1.405709365919212e-67, 2.3834092969503466e-68, 1.1334576287197671e-67,
      1.039921137998541e-67, 3.792879321612094e-68, -2.553427617589316e-68,
      -5.063394428643974e-68, -3.71010055632725e-68, -7.125076794675608e-69,
      1.5834301180263282e-68, 2.1096919211963586e-68, 1.2193818292418278e-68,
      -4.577660466021427e-70, -8.142597187110129e-69, -8.258886552264649e-69,
      -3.55209478448906e-69, 1.4612596760688508e-69, 3.7657473789994396e-69,
      3.034356801979492e-69, 8.186332331031462e-70, -1.047428793341508e-69,
      -1.6137862315092257e-69, -1.0356780755978849e-69, -7.301451273034463e-71,
      5.7414338533719474e-70, 6.485045448007975e-70, 3.1990562524933006e-70,
      -7.171985029561242e-71, -2.7629396569322316e-70, -2.4493417452166984e-70,
      -8.347226831419531e-71, 6.6294041092805476e-71, 1.2203344269235885e-70,
      8.64305803492789e-71, 1.403707934714991e-71, -3.957620539457859e-71,
      -5.035982825354674e-71, -2.798988751080107e-71, 2.2657748212205306e-72,
      1.9965933735029374e-71, 1.9532663620614363e-71, 7.955806590053996e-72,
      -3.9230962634129216e-72, -9.116830648222004e-72, -7.103969901388456e-72,
      -1.7277153688863038e-72, 2.650436680998284e-72, 3.8675468881628536e-72,
      2.3939735817594517e-72, 8.251550212265017e-74, -1.4176713094675306e-72,
      -1.5398476172810869e-72, -7.254255286753524e-73, 2.061686493951194e-73,
      6.722253833354877e-73, 5.760242459198965e-73, 1.8219885389724148e-73,
      -1.7071406539664364e-73, -2.936694150444773e-73, -2.0096744551119787e-73,
      -2.640641239809017e-74, 9.856378900406187e-74, 1.2004603257494486e-73,
      6.4067521889349466e-74, -8.18653733484891e-75, -4.8850195574987136e-74,
      -4.612941646610692e-74, -1.772220080380471e-74, 1.0384586418062156e-74,
      2.2035680972658574e-74, 1.6603538893135214e-74, 3.580827144822231e-75,
      -6.674557969630215e-75, -9.255717330803116e-75, -5.520834514582494e-75,
      2.1226006623814383e-77, 3.491357322121415e-75, 3.6512163348017433e-75,
      1.6385095397994745e-75, -5.744912963664441e-76, -1.632566091425418e-75,
      -1.352565138674649e-75, -3.938209336283015e-76, 4.3654218615383807e-76,
      7.056596458373796e-76, 4.6635929170072193e-76, 4.608492938586765e-77,
      -2.4467102124755476e-76, -2.857664589293791e-76, -1.4620076197621718e-76,
      2.611118412925089e-77, 1.1927337823547624e-76, 1.0878294602507246e-76,
      3.923260175599501e-77, -2.7176162505793256e-77, -5.317654280544093e-77,
      -3.873803767621687e-77, -7.245647231827777e-78, 1.6736397083869071e-77,
      2.2119527394449264e-77, 1.2700313158634201e-77, -5.687126989986823e-79,
      -8.577309332893718e-78, -8.64544899457057e-78, -3.684677266447791e-78,
      1.5650009933771124e-78, 3.9579447081740436e-78, 3.170901489355909e-78,
      8.411821763506342e-79, -1.1095606465333167e-78, -1.6931691563167308e-78,
      -1.0799577209412575e-78, -6.960959714897872e-80, 6.055408216908784e-79,
      6.793200044859587e-79, 3.3252082329741255e-79, -7.784208711869003e-80,
      -2.906468111374611e-79, -2.5615204881789376e-79, -8.622785885041945e-80,
      7.045063056783997e-80, 1.2812773536447067e-79, 9.021535441663806e-80,
      1.4180188399098313e-80, -4.180420237544099e-80, -5.278827420232648e-80,
      -2.913881505116812e-80, 2.5857934298169543e-81, 2.1023769104066592e-80,
      2.0441888000527424e-80, 8.245432354160443e-81, -4.190424310888443e-81,
      -9.579409703818312e-81, -7.421517648729819e-81, -1.7703490414599393e-81,
      2.8052227617305323e-81, 4.0568008264938533e-81, 2.4953543145893173e-81,
      7.000561665688815e-83, -1.4945054975807856e-81, -1.612632610674859e-81,
      -7.535415601990342e-82, 2.2239312683874082e-82, 7.069217364573393e-82,
      6.022469569136734e-82, 1.8792055826250418e-82, -1.8118585791627674e-82,
      -3.0825598150154887e-82, -2.096975429193063e-82, -2.6403953070250124e-83,
      1.0405202505500426e-82, 1.258049795408975e-82, 6.666355959760951e-83,
      -9.080416336305678e-84, -5.141966689030637e-83, -4.8264673263715825e-83,
      -1.834882565551222e-83, 1.1068589017001745e-83, 2.3147361815901447e-83,
      1.734056644587169e-83, 3.6558794635830157e-84, -7.0589020498902985e-84,
      -9.706287628513115e-84, -5.752249444677628e-84, 6.145212507592991e-86,
      3.678991116931952e-84, 3.8228815917658382e-84, 1.7007888353305737e-84,
      -6.169902882339292e-85, -1.7163072357052046e-84, -1.4137557315831888e-84,
      -4.0542733496617444e-85, 4.62809819305503e-85, 7.405233564489806e-85,
      4.864469326803516e-85, 4.526205886822844e-86, -2.5815700684460654e-85,
      -2.9940438716713407e-85, -1.5204115977629525e-85, 2.8550605620905562e-86,
      1.2550369223279526e-85, 1.1378949084229562e-85, 4.057261970983903e-86,
      -2.891558860159003e-86, -5.584427236104614e-86, -4.044511802452859e-86,
      -7.361113312458937e-87, 1.768786615220411e-86, 2.3190750628532663e-86,
      1.3226810552752716e-86, -6.892123667153563e-88, -9.03461720573688e-87,
      -9.049725331234813e-87, -3.8216541014437108e-87, 1.6752606903086832e-87,
      4.159745016884148e-87, 3.313429636589687e-87, 8.639772623970635e-88,
      -1.175193920640494e-87, -1.776381864470236e-87, -1.1260569774810014e-87,
      -6.570807129543775e-89, 6.386028769080825e-88, 7.11570609547505e-88,
      3.4559637837556513e-88, -8.438291957867932e-89, -3.0572828810268543e-88,
      -2.6787167076807744e-88, -8.905224356172253e-89, 7.485029195009627e-89,
      1.3452038566334453e-88, 9.416054984818474e-89, 1.4304200512329366e-89,
      -4.415304620680785e-89, -5.533156210487838e-89, -3.033234606274378e-89,
      2.9311581429833965e-90, 2.2136235019965544e-89, 2.139252648875674e-89,
      8.544198948852733e-90, -4.4741810963039665e-90, -1.0064976225281645e-89,
      -7.752870024814656e-90, -1.8130277200874198e-90, 2.9686358972436485e-90,
      4.255138064070763e-90, 2.600848037370196e-90, 5.610516217254218e-92,
      -1.5753836804221796e-90, -1.6887884305720068e-90, -7.826545461457421e-91,
      2.3968929037767087e-91, 7.4336938657232e-91, 6.296344359264446e-91,
      1.9376436444917688e-91, -1.9226138654177767e-91, -3.235529577987715e-91,
      -2.1879392728087002e-91, -2.633955718278653e-92, 1.0983543068720632e-91,
      1.318348201047273e-91, 6.935845606800529e-92, -1.0040751498612716e-92,
      -5.412101008653262e-92, -5.049658526791737e-92, -1.899403733522012e-92,
      1.1793817130889997e-92, 2.4313992500300373e-92, 1.8109365234732635e-92,
      3.7297507522758584e-93, -7.464449560791303e-93, -1.0178371087104342e-92,
      -5.992921330558282e-93, 1.0548011186076761e-94, 3.876432092382051e-93,
      4.002451589913993e-93, 1.7652025524012166e-93, -6.622160086658234e-94,
      -1.8042515617751768e-93, -1.4776446440362704e-93, -4.172247955741969e-94,
      4.905724346442212e-94, 7.770762654302689e-94, 5.073681796622498e-94,
      4.425272048777133e-95, -2.723625161518698e-94, -3.1368036352772976e-94,
      -1.580991367060172e-94, 3.1162579183691265e-95, 1.3205183642278424e-94,
      1.1902120750069093e-94, 4.194926748920387e-95, -3.075805702169146e-95,
      -5.864317264873525e-95, -4.222512832197574e-95, -7.470704593748405e-96,
      1.8691327804833883e-95, 2.431285415956662e-95, 1.3774042151010892e-95,
      -8.199204694242117e-97, -9.515668495853185e-96, -9.472508345909051e-96,
      -3.963136236908748e-96, 1.7924204701437994e-96, 4.3716186587219865e-96,
      3.462195082676484e-96, 8.869893705303826e-97, -1.2445186835562164e-96,
      -1.8636055542807792e-96, -1.1740466009822155e-96, -6.127034294014844e-98,
      6.734155674591533e-97, 7.453217652737907e-97, 3.591468909333158e-97,
      -9.136812108526725e-98, -3.215746229027744e-97, -2.8011486876232156e-97,
      -9.194557047341178e-98, 7.950658598513551e-98, 1.4122572005910985e-97,
      9.827268276401283e-98, 1.440695285533738e-98, -4.66291014895135e-98,
      -5.799501325287928e-98, -3.1572066543423714e-98, 3.3035479792101048e-99,
      2.3306090372279666e-98, 2.238641980564184e-98, 8.852304828306159e-99,
      -4.77531495801147e-99, -1.0574650296324544e-98, -8.098606778569969e-99,
      -1.8556560962654572e-99, 3.1411404157803674e-99, 4.462986075012316e-99,
      2.710611664168912e-99, 4.071022864879397e-101, -1.6605135214178527e-99,
      -1.768467748980569e-99, -8.127942445156382e-100, 2.581218389697499e-100,
      7.816549409487191e-100, 6.582369322577703e-100, 1.9972859383664575e-100,
      -2.0397398787705e-100, -3.395942794969622e-100, -2.2827127017698355e-100,
      -2.620730034284008e-101, 1.1592944323903035e-100, 1.3814803474982897e-100,
      7.215561068142755e-101, -1.1071817058828458e-101, -5.6960847472991084e-101,
      -5.282941753770279e-101, -1.965815127732308e-101, 1.256261967520421e-101,
      2.553823667129783e-101, 1.8911255073855907e-101, 3.8021525658601995e-102,
      -7.892332576368674e-102, -1.0672974692004661e-101, -6.243195759993059e-102,
      1.5357998615261463e-103, 4.084180816507335e-102, 4.190282059502406e-102,
      1.8318095305197287e-102, -7.103302263883937e-103, -1.8966058357278313e-102,
      -1.5443472500268572e-102, -4.292044890354075e-103, 5.19911792984997e-103,
      8.153986433466979e-103, 5.291559098872727e-103, 4.304098352360706e-104,
      -2.8732492895279923e-103, -3.286236118553035e-103, -1.643818783172561e-103,
      3.3957925940886524e-104, 1.3893368385701215e-103, 1.2448795689585414e-103,
      4.3362921151366256e-104, -3.2709369258115843e-104, -6.157956925636493e-104,
      -4.408106251874585e-104, -7.573588793349728e-105
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-11), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 5, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.24369262561195829, -0.651008854434214, 0.3183879555037503, 0.28059186382431334,
      0.00584271493259321, -0.15192215623388128, -0.13528836159092628, -0.03172426483061644,
      0.05561722601929737, 0.07732888479650396, 0.04425082214322715, -0.0035855279727189434,
      -0.03228941345228349, -0.03188137390952055, -0.0131978402132005, 0.006219429323346599,
      0.014858382691151376, 0.011708193814173488, 0.0029602277119059085,
      -0.0042488171032949735, -0.0063207088996789255, -0.00396558561523794,
      -0.00019128022171249875, 0.0022907855562624892, 0.002524564493195174,
      0.0012103822294586644, -0.00031588124590360944, -0.0010920883401846374,
      -0.0009477675383489358, -0.0003085555289011757, 0.0002716778592950343,
      0.0004790385142660494, 0.00033208984995245004, 4.755439695170502e-05,
      -0.00015875902899565737, -0.00019651596276424007, -0.00010650653639810017,
      1.1692997737819033e-05, 7.919764224001003e-05, 7.577899553558922e-05,
      2.977345509697046e-05, -1.6366149117715695e-05, -3.588651398436322e-05,
      -2.7382891759175932e-05, -6.1915876646531135e-06, 1.070761220103801e-05,
      1.512934096428158e-05, 9.15161753344018e-06, 9.891280242924583e-08,
      -5.6467020284933635e-06, -5.988972319335296e-06, -2.737900109499831e-06,
      8.895182105008851e-07, 2.6540350298305732e-06, 2.226755636721845e-06,
      6.695261365256821e-07, -6.964674224897517e-07, -1.151721516300908e-06,
      -7.712221213725646e-07, -8.578317921166928e-08, 3.9456743252307283e-07,
      4.680436589402555e-07, 2.433311384314692e-07, -3.8698362578782235e-08,
      -1.9351793447606502e-07, -1.7880127513360696e-07, -6.607194666801779e-08,
      4.300219489843324e-08, 8.665246474941885e-08, 6.393014268699093e-08,
      1.2652491725183755e-08, -2.6891075965252644e-08, -3.617540334428512e-08,
      -2.1072655881331907e-08, 6.132085974905874e-10, 1.3884868099646719e-08,
      1.418834162320133e-08, 6.167473377355868e-09, -2.4419790270781887e-09,
      -6.43852001621333e-09, -5.223472306663097e-09, -1.4368780284558623e-09,
      1.7740698834139712e-09, 2.764955041393386e-09, 1.7873601095232063e-09,
      1.3863557390825964e-10, -9.775948896566874e-10, -1.1132038966144238e-09,
      -5.541441484388226e-10, 1.1786045476212623e-10, 4.719098842875234e-10,
      4.2126109273500533e-10, 1.4562882016050614e-10, -1.1185107280518589e-10,
      -2.0890720037133393e-10, -1.4898763330182447e-10, -2.5109314244477142e-11,
      6.726313402182438e-11, 8.637759219653922e-11, 4.8397000979185954e-11,
      -3.478487068406592e-12, -3.406184416032144e-11, -3.3565811948313994e-11,
      -1.3827777145559355e-11, 6.5777197430872e-12, 1.5592861306299292e-11,
      1.2233196120222404e-11, 3.042101787938537e-12, -4.493854057464923e-12,
      -6.628320582541267e-12, -4.133369643317572e-12, -1.7343506020947518e-13,
      2.4152105269034606e-12, 2.6440023305281888e-12, 1.2575393464226377e-12,
      -3.414661428565914e-13, -1.1485943041109656e-12, -9.910088166117276e-13,
      -3.1843790541770233e-13, 2.8847678428486615e-13, 5.02881355417008e-13,
      3.4656028693695774e-13, 4.776104169864018e-14, -1.6763471194948995e-13,
      -2.0596179468027955e-13, -1.1084383819271137e-13, 1.307591065520911e-14,
      8.337454075276452e-14, 7.929412661540273e-14, 3.0838360888799544e-14,
      -1.7457187763659144e-14, -3.7700821023935646e-14, -2.860163489645791e-14,
      -6.330748986244725e-15, 1.1327358417300666e-14, 1.5867274645993684e-14,
      9.536733562227405e-15, 3.944445273613377e-17, -5.951112423188986e-15,
      -6.271116070027557e-15, -2.842760544314018e-15, 9.567441325076144e-16,
      2.7904860763124887e-15, 2.327733480724389e-15, 6.897726659890885e-16,
      -7.386670805159006e-16, -1.2087367171478393e-15, -8.045490602573684e-16,
      -8.49372340830174e-17, 4.163966988794184e-16, 4.904242559053355e-16,
      2.531053105157734e-16, -4.250242014000714e-17, -2.0365241161392547e-16,
      -1.8704817346665084e-16, -6.835983840010158e-17, 4.5782838323203036e-17,
      9.100867068610399e-17, 6.675519947626636e-17, 1.2880420884888115e-17,
      -2.8426996019826096e-17, -3.7930738005302576e-17, -2.1949955245345473e-17,
      7.953730725311385e-19, 1.462733015729152e-17, 1.4853170083684213e-17,
      6.398747775220204e-18, -2.6169841713168235e-18, -6.767530547734285e-18,
      -5.458837696447629e-18, -1.4771817849925172e-18, 1.8796612538304687e-18,
      2.9011098265423888e-18, 1.8639196351134826e-18, 1.3343861860247655e-19,
      -1.031156689057541e-18, -1.166157184017074e-18, -5.760681444422049e-19,
      1.2812266242095705e-19, 4.964573608169268e-19, 4.405779285056394e-19,
      1.504792284222762e-19, -1.1889799979469302e-19, -2.1935151447151575e-19,
      -1.5552204534058052e-19, -2.5405078424026264e-20, 7.105866896562055e-20,
      9.05472599087673e-20, 5.038854741634888e-20, -4.008203023998809e-21,
      -3.586924842788999e-20, -3.513002359116619e-20, -1.4333882252042767e-20,
      7.029398105238849e-21, 1.6384963012772552e-20, 1.2780774638767494e-20,
      3.1191181667988663e-21, -4.7570942183650836e-21, -6.953013468509406e-21,
      -4.308759737687142e-21, -1.535013533163258e-22, 2.546341425015873e-21,
      2.7691127024823823e-21, 1.3064585269551678e-21, -3.6873472351238435e-22,
      -1.207954520205334e-21, -1.0361792105802654e-21, -3.285494198680414e-22,
      3.0624698967262154e-22, 5.278867753384103e-22, 3.616400487406542e-22,
      4.787643256228418e-23, -1.7698913449897342e-22, -2.1585277149016245e-22,
      -1.1534752266128841e-22, 1.4563917143669092e-23, 8.776630384165482e-23,
      8.296874738106352e-23, 3.193565581599536e-23, -1.8614448274515297e-23,
      -3.960498762582414e-23, -2.98730843193045e-23, -6.468767046876022e-24,
      1.1981423181059935e-23, 1.6640510957627776e-23, 9.937339057978881e-24,
      -2.594883504644851e-26, -6.27147465272237e-24, -6.566279980063021e-24,
      -2.951263518498673e-24, 1.0283281816720677e-24, 2.9338002748574598e-24,
      2.4331764605954334e-24, 7.103932957200833e-25, -7.832797984399217e-25,
      -1.2685197532332495e-24, -8.392648657691786e-25, -8.380985307452916e-26,
      4.393940723132991e-25, 5.1385406312503e-25, 2.6324674808580564e-25,
      -4.658027623082148e-26, -2.14305045063175e-25, -1.9566688803723792e-25,
      -7.071240181249626e-26, 4.872923679127601e-26, 9.557949149328506e-26,
      6.970136354568943e-26, 1.3100609459615896e-26, -3.004713976765839e-26,
      -3.9769610581348697e-26, -2.286201370679485e-26, 9.935461339524208e-28,
      1.540843621228495e-26, 1.554850038870867e-26, 6.637754740445134e-27,
      -2.8030393333181035e-27, -7.112998103455522e-27, -5.704533095312488e-27,
      -1.5179870379578806e-27, 1.9912172271475908e-27, 3.043840223010994e-27,
      1.9436330447746294e-27, 1.2742014366247332e-28, -1.087562539882846e-27,
      -1.2215793973095642e-27, -5.987964512989861e-28, 1.3909203688465041e-28,
      5.222524825020095e-28, 4.607599454673132e-28, 1.5545376528758582e-28,
      -1.263582868179396e-28, -2.3030769185889137e-28, -1.6233397337501748e-28,
      -2.567049035938497e-29, 7.5060442136438e-29, 9.491432458451626e-29,
      5.245769103076942e-29, -4.580509018560745e-30, -3.7770114566399076e-29,
      -3.676557156157165e-29, -1.4856134668700413e-29, 7.508953116010353e-30,
      1.7216470595197366e-29, 1.3352197244998974e-29, 3.1964003482261435e-30,
      -5.035038091170386e-30, -7.293306497024337e-30, -4.4912846122109555e-30,
      -1.3125383863446322e-31, 2.684384131757914e-30, 2.9000238517367233e-30,
      1.3571231328048926e-30, -3.978162766567059e-31, -1.2703144029502698e-30,
      -1.0833588747747123e-30, -3.388850046829927e-31, 3.2504455668798103e-31,
      5.541113185950027e-31, 3.773538570141886e-31, 4.7891273358037725e-32,
      -1.868475053460449e-31, -2.262095143193869e-31, -1.200234169466511e-31,
      1.616384026864898e-32, 9.238374541473105e-32, 8.680991784330172e-32,
      3.306595490177495e-32, -1.984172075322515e-32, -4.1603377829888967e-32,
      -3.119943871143584e-32, -6.605207302650791e-33, 1.267164417411498e-32,
      1.7450705678026239e-32, 1.0354017194653419e-32, -9.769539359033527e-35,
      -6.608604745643579e-33, -6.875051411952094e-33, -3.0635127709655967e-33,
      1.104530549149618e-33, 3.0843159097754995e-33, 2.5432761480823682e-33,
      7.313765360964388e-34, -8.30438012117197e-34, -1.3312024105693441e-33,
      -8.754246439128003e-34, -8.237606663151313e-35, 4.636203875259063e-34,
      5.383812432423952e-34, 2.7376777683339866e-34, -5.094925725305037e-35,
      -2.255017657273932e-34, -2.0467374887043463e-34, -7.313048304339312e-35,
      5.185076334446323e-35, 1.0037529686396399e-34, 7.277362934408534e-35,
      1.3311783746006686e-35, -3.175598241501659e-35, -4.1695917935529726e-35,
      -2.38101093953196e-35, 1.2088348853113805e-36, 1.6230151415648636e-35,
      1.6275699514071363e-35, 6.884694236020324e-36, -3.00079358506909e-36,
      -7.47572960302573e-36, -5.960997600295275e-36, -1.559247629762285e-36,
      2.10906216225928e-36, 3.193457676604027e-36, 2.0266234197265833e-36,
      1.2051363556002801e-37, -1.1469595946800327e-36, -1.2795831943493217e-36,
      -6.22354850557023e-37, 1.508123074833998e-37, 5.493573480895442e-37,
      4.81844845098848e-37, 1.6055298205694853e-37, -1.3425504537342014e-37,
      -2.4180033694555224e-37, -1.6943472000472347e-37, -2.5901952882368383e-38,
      7.927933126340906e-38, 9.948794324605866e-38, 5.46072079561234e-38,
      -5.198245119832235e-39, -3.976916794628393e-38, -3.847563105411574e-38,
      -1.5394897863201534e-38, 8.017998446270235e-39, 1.8089306163196463e-38,
      1.3948467430891797e-38, 3.273793825504183e-39, -5.3284784026983465e-39,
      -7.649934633865886e-39, -4.6812175734990765e-39, -1.0651755676196137e-40,
      2.8296940210620903e-39, 3.036998843640328e-39, 1.4095859760673008e-39,
      -4.288206703972502e-40, -1.3358224557805628e-39, -1.1326346426168818e-39,
      -3.494424870504991e-40, 3.44926328685728e-40, 5.816132830728504e-40,
      3.937271834808655e-40, 4.779566725993915e-41, -1.972362177142393e-40,
      -2.370535069048416e-40, -1.248774860563165e-40, 1.788291866233266e-41,
      9.72382113722101e-41, 9.082499826536346e-41, 3.422985420796813e-41,
      -2.1143004473021944e-41, -4.370056384442681e-41, -3.2582984107560697e-41,
      -6.739596193740677e-42, 1.3399954903867264e-41, 1.8299590663927697e-41,
      1.078737080054435e-41, -1.7625072157831185e-43, -6.963359590595697e-42,
      -7.198043544509898e-42, -3.179613463041092e-42, 1.1856261546433428e-42,
      3.2423876180783645e-42, 2.6582320238794277e-42, 7.527089233517424e-43,
      -8.802811991483458e-43, -1.396922625747228e-42, -9.130855316170593e-43,
      -8.060917208263791e-44, 4.891395744652124e-43, 5.6405611867055686e-43,
      2.8468104442729596e-43, -5.562770877524647e-44, -2.372697765528715e-43,
      -2.140857807317355e-43, -7.561485813325096e-44, 5.515730114762024e-44,
      1.0540694787329547e-43, 7.597718653700771e-44, 1.3512566176101038e-44,
      -3.3558230851826166e-44, -4.3713734843311194e-44, -2.479556159763255e-44,
      1.4424150246310682e-45, 1.70945387771617e-44, 1.7036194046726725e-44,
      7.139767302589465e-45, -3.210932324783633e-45, -7.856570771520361e-45,
      -6.228688212898146e-45, -1.600911811646164e-45, 2.2335375370632258e-45,
      3.3502880880822646e-45, 2.1130182562975454e-45, 1.1264813196266902e-46,
      -1.209502449776544e-45, -1.3402862505830927e-45, -6.4676971287952075e-46,
      1.6332973806624522e-46, 5.778370867528867e-46, 5.038719170433839e-46,
      1.657771927770834e-46, -1.4261263392381083e-46, -2.538552138851419e-46,
      -1.7683602155847674e-46, -2.609559533346613e-47, 8.372677367274848e-47,
      1.0427768842147316e-46, 5.683995881488081e-47, -5.864423803241101e-48,
      -4.187136798782034e-47, -4.026351458948537e-47, -1.595053237384116e-47,
      8.558237131977135e-48, 1.9005483783933278e-47, 1.4570629054164e-47,
      3.351128677539983e-48, -5.638249423075906e-48, -8.023666763175633e-48,
      -4.8788414249148546e-48, -7.910620317450364e-50, 2.9826443421750983e-48,
      3.180312376766527e-48, 1.4639008469999188e-48, -4.6186405602279865e-49,
      -1.4046343916424824e-48, -1.1840969665766774e-48, -3.6021896256011006e-49,
      3.6595219098111806e-49, 6.1045369981369965e-49, 4.1078645715397305e-49,
      4.757900481146918e-50, -2.081830143331957e-49, -2.4840720164538527e-49,
      -1.2991586373510976e-49, 1.9728822518627687e-50, 1.0234160661260203e-49,
      9.5021664462498e-50, 3.542792974921927e-50, -2.252251802945392e-50,
      -4.590133548315074e-50, -3.4026097128969934e-50, -6.87141850584349e-51,
      1.4168389519651613e-50, 1.9188977232516721e-50, 1.1238022866715843e-50,
      -2.6209908456618823e-52, -7.336638939643543e-51, -7.535896470321839e-51,
      -3.2996720712274074e-51, 1.2719054490078469e-51, 3.408387164792522e-51,
      2.7782517871957135e-51, 7.7437485735197e-52, -9.329562436769969e-52,
      -1.4658247669086223e-51, -9.52306762428438e-52, -7.848062604461107e-53,
      5.160188125370412e-52, 5.909312658451108e-52, 2.9599952254122913e-52,
      -6.063505262830585e-53, -2.4963761373082462e-52, -2.2392073148863665e-52,
      -7.816622433621072e-53, 5.865927042955376e-53, 1.1068581979638006e-52,
      7.931742702783434e-53, 1.370146834891554e-53, -3.545883537756474e-53,
      -4.582732192141273e-53, -2.5819731711647965e-53, 1.6955348251510076e-54,
      1.8003763943122391e-53, 1.7831472698211e-53, 7.40317569439817e-54,
      -3.434179238352312e-54, -8.256407969437478e-54, -6.508080527365624e-54,
      -1.6429218162029813e-54, 2.3650028296309886e-54, 3.514672469434963e-54,
      2.202949601059237e-54, 1.0374795119640675e-55, -1.2753535141514674e-54,
      -1.4038114762221517e-54, -6.72067994209074e-55, 1.7669326749180398e-55,
      6.077600031416969e-55, 5.268821030746893e-55, 1.711264502367957e-55,
      -1.5145672328481616e-55, -2.664993001222045e-55, -1.845500632122131e-55,
      -2.624725578143612e-56, 8.841479444974128e-56, 1.0929356653115303e-55,
      5.915889032101715e-56, -6.582239823054743e-57, -4.408191952903845e-56,
      -4.213267774366469e-56, -1.6523394679789141e-56, 9.13146635997902e-57,
      1.9967113795429778e-56, 1.5219767858355688e-56, 3.4282184540279466e-57,
      -5.965229091037833e-57, -8.415307217665924e-57, -5.084448737238264e-57,
      -4.882145079157805e-59, 3.1436271007715957e-57, 3.330251282063137e-57,
      1.5201224842763128e-57, -4.9706921287150896e-58, -1.476913476278799e-57,
      -1.2378400617846765e-57, -3.712107302327926e-58, 3.8818522928364045e-58,
      6.406964584834536e-58, 4.2855909647577225e-58, 4.722991881934127e-59,
      -2.1971705497735644e-58, -2.6029406214796104e-58, -1.3514485468317408e-58,
      2.1709677999454578e-59, 1.0770642204343942e-58, 9.9407920816649e-59,
      3.6660734180806436e-59, -2.398471099480084e-59, -4.8210710316504185e-59,
      -3.553124831524587e-59, -7.000114488477432e-60, 1.4979087930912452e-59,
      2.012075972274649e-59, 1.1706617068929476e-59, -3.5575520496197346e-61,
      -7.729387510046456e-60, -7.889278339862167e-60, -3.4237962674053374e-60,
      1.3636752589092291e-60, 3.5827042542443306e-60, 2.903551676534427e-60,
      7.963564285075372e-61, -9.886178196293844e-61, -1.5380599272351647e-60,
      -9.931497337466678e-61, -7.595993057584836e-62, 5.443286923472403e-61,
      6.1906161345325964e-61, 3.077365083234199e-61, -6.599184708644911e-62,
      -2.6263521078716245e-61, -2.341971015643294e-61, -8.078519076337775e-62,
      6.23676568114594e-62, 1.1622382596259901e-61, 8.279995219495788e-62,
      1.3876883637511452e-62, -3.7463002008506487e-62, -4.804113390014944e-62,
      -2.688402419579584e-62, 1.9695193369386285e-63, 1.8960100202902164e-62,
      1.866308891942793e-62, 7.675121477867509e-63, -3.6712983637125077e-63,
      -8.676170107234694e-63, -6.799669443026323e-63, -1.6852134020374856e-63,
      2.503836443745909e-63, 3.6869676292120526e-63, 2.2965541885843989e-63,
      9.373240620082674e-65, -1.344683396231812e-63, -1.4702872424869443e-63,
      -6.982772301878993e-64, 1.909546576481967e-64, 6.391977292386151e-64,
      5.5091806347704654e-64, 1.7660052021893856e-64, -1.6081436536104256e-64,
      -2.797608423587872e-64, -1.9258949454101995e-64, -2.6352462179546926e-65,
      9.335603598955722e-65, 1.1454603706386846e-64, 6.156703683876105e-65,
      -7.355080625801425e-66, -4.6406284735181836e-65, -4.408672510479942e-65,
      -1.7113835970015796e-65, 9.739582503220365e-66, 2.097640731799699e-65,
      1.5897013044130216e-65, 3.5048589898909526e-66, -6.310341245642714e-66,
      -8.82569737608588e-66, -5.298342123054003e-66, -1.5452234190508103e-68,
      3.313053982663188e-66, 3.4871150426119437e-66, 1.5783065401065016e-66,
      -5.345659115374932e-67, -1.552830887536059e-66, -1.293962054938717e-66,
      -3.824132230396038e-67, 4.116918961922476e-67, 6.724084384673995e-67,
      4.470735422968489e-67, 4.673623659371047e-68, -2.318689873179358e-67,
      -2.727386075839352e-67, -1.4057093659207519e-67, 2.3834092969440262e-68,
      1.1334576287200732e-67, 1.0399211379992607e-67, 3.79287932161773e-68,
      -2.5534276175879275e-68, -5.0633944286460665e-68, -3.710100556330326e-68,
      -7.125076794694769e-69, 1.5834301180262524e-68, 2.1096919211974865e-68,
      1.2193818292430612e-68, -4.577660465962889e-70, -8.142597187111752e-69,
      -8.258886552270045e-69, -3.552094784493707e-69, 1.4612596760673698e-69,
      3.765747379000813e-69, 3.0343568019818693e-69, 8.186332331047795e-70,
      -1.047428793341289e-69, -1.613786231510024e-69, -1.0356780755988617e-69,
      -7.301451273086775e-71, 5.7414338533726024e-70, 6.485045448011957e-70,
      3.19905625249707e-70, -7.171985029546732e-71, -2.762939656933082e-70,
      -2.4493417452185062e-70, -8.347226831433169e-71, 6.6294041092776135e-71,
      1.2203344269241402e-70, 8.643058034935543e-71, 1.4037079347195642e-71,
      -3.9576205394578716e-71, -5.035982825357568e-71, -2.7989887510831394e-71,
      2.2657748212068976e-72, 1.9965933735034156e-71, 1.9532663620627984e-71,
      7.955806590065303e-72, -3.923096263409619e-72, -9.116830648225657e-72,
      -7.103969901394376e-72, -1.7277153688902208e-72, 2.6504366809978977e-72,
      3.867546888164915e-72, 2.3939735817618606e-72, 8.251550212388176e-74,
      -1.4176713094677543e-72, -1.5398476172820978e-72, -7.254255286762741e-73,
      2.061686493947875e-73, 6.722253833357198e-73, 5.760242459203498e-73,
      1.8219885389757206e-73, -1.7071406539658146e-73, -2.9366941504462014e-73,
      -2.0096744551138714e-73, -2.6406412398199223e-74, 9.856378900406643e-74,
      1.2004603257501831e-73, 6.406752188942377e-74, -8.186537334817115e-75,
      -4.885019557500056e-74, -4.612941646614111e-74, -1.7722200803832218e-74,
      1.038458641805478e-74, 2.203568097266816e-74, 1.6603538893149952e-74,
      3.580827144831688e-75, -6.67455796962956e-75, -9.255717330808388e-75,
      -5.52083451458845e-75, 2.12260066208758e-77, 3.4913573221220785e-75,
      3.651216334804292e-75, 1.6385095398017351e-75, -5.744912963656738e-76,
      -1.6325660914260323e-75, -1.35256513867578e-75, -3.9382093362910365e-76,
      4.36542186153707e-76, 7.056596458377468e-76, 4.6635929170119026e-76,
      4.6084929386128565e-77, -2.4467102124757556e-76, -2.8576645892956536e-76,
      -1.4620076197639977e-76, 2.6111184129176364e-77, 1.1927337823551296e-76,
      1.0878294602515802e-76, 3.923260175606176e-77, -2.717616250577705e-77,
      -5.3176542805466e-77, -3.873803767625347e-77, -7.245647231850459e-78,
      1.67363970838683e-77, 2.211952739446276e-77, 1.2700313158648888e-77,
      -5.687126989917386e-79, -8.577309332895668e-78, -8.645448994576992e-78,
      -3.684677266453308e-78, 1.565000993375363e-78, 3.9579447081756837e-78,
      3.1709014893587373e-78, 8.411821763525758e-79, -1.1095606465330573e-78,
      -1.6931691563176817e-78, -1.0799577209424208e-78, -6.960959714960254e-80,
      6.055408216909552e-79, 6.793200044864318e-79, 3.3252082329786115e-79,
      -7.784208711851684e-80, -2.9064681113756184e-79, -2.561520488181089e-79,
      -8.622785885058223e-80, 7.045063056780436e-80, 1.2812773536453583e-79,
      9.021535441672903e-80, 1.4180188399152845e-80, -4.1804202375441e-80,
      -5.278827420236088e-80, -2.913881505120427e-80, 2.585793429800617e-81,
      2.1023769104072188e-80, 2.044188800054359e-80, 8.245432354173909e-81,
      -4.1904243108844656e-81, -9.579409703822608e-81, -7.421517648736834e-81,
      -1.7703490414646003e-81, 2.805222761730059e-81, 4.056800826496297e-81,
      2.4953543145921867e-81, 7.000561665836662e-83, -1.494505497581038e-81,
      -1.6126326106760547e-81, -7.535415602001315e-82, 2.2239312683834065e-82,
      7.069217364576102e-82, 6.022469569142103e-82, 1.879205582628978e-82,
      -1.8118585791620125e-82, -3.082559815017174e-82, -2.0969754291953098e-82,
      -2.6403953070380128e-83, 1.0405202505500911e-82, 1.2580497954098446e-82,
      6.666355959769782e-83, -9.080416336267654e-84, -5.141966689032202e-83,
      -4.8264673263756205e-83, -1.8348825655544807e-83, 1.1068589016992927e-83,
      2.3147361815912698e-83, 1.7340566445889057e-83, 3.6558794635941676e-84,
      -7.058902049889521e-84, -9.706287628519322e-84, -5.75224944468464e-84,
      6.14521250724726e-86, 3.6789911169327363e-84, 3.822881591768841e-84,
      1.7007888353332355e-84, -6.16990288233023e-85, -1.7163072357059295e-84,
      -1.4137557315845215e-84, -4.0542733496711855e-85, 4.6280981930535e-85,
      7.405233564494142e-85, 4.864469326809036e-85, 4.526205886853544e-86,
      -2.581570068446315e-85, -2.9940438716735363e-85, -1.520411597765103e-85,
      2.8550605620817695e-86, 1.2550369223283822e-85, 1.1378949084239603e-85,
      4.057261970991744e-86, -2.891558860157091e-86, -5.584427236107545e-86,
      -4.044511802457143e-86, -7.36111331248549e-87, 1.7687866152203196e-86,
      2.3190750628548443e-86, 1.322681055276989e-86, -6.892123667072393e-88,
      -9.034617205739156e-87, -9.049725331242308e-87, -3.821654101450149e-87,
      1.6752606903066397e-87, 4.159745016886056e-87, 3.31342963659298e-87,
      8.639772623993213e-88, -1.175193920640196e-87, -1.7763818644713456e-87,
      -1.1260569774823551e-87, -6.570807129616082e-89, 6.386028769081761e-88,
      7.115706095480595e-88, 3.4559637837608924e-88, -8.438291957847773e-89,
      -3.057282881028037e-88, -2.678716707683287e-88, -8.905224356191212e-89,
      7.485029195005525e-89, 1.3452038566342073e-88, 9.416054984829058e-89,
      1.4304200512392556e-89, -4.415304620680809e-89, -5.5331562104918394e-89,
      -3.033234606278565e-89, 2.9311581429646025e-90, 2.2136235019972157e-89,
      2.1392526488775527e-89, 8.544198948868313e-90, -4.474181096299418e-90,
      -1.0064976225286674e-89, -7.752870024822804e-90, -1.8130277200928124e-90,
      2.9686358972431144e-90, 4.255138064073598e-90, 2.6008480373735104e-90,
      5.610516217423828e-92, -1.575383680422486e-90, -1.688788430573398e-90,
      -7.82654546147012e-91, 2.3968929037721185e-91, 7.433693865726366e-91,
      6.296344359270657e-91, 1.9376436444962958e-91, -1.922613865416935e-91,
      -3.2355295779896833e-91, -2.187939272811299e-91, -2.6339557182935646e-92,
      1.0983543068721339e-91, 1.3183482010482873e-91, 6.93584560681075e-92,
      -1.0040751498569169e-92, -5.412101008655122e-92, -5.0496585267964345e-92,
      -1.8994037335257755e-92, 1.1793817130880057e-92, 2.4313992500313654e-92,
      1.810936523475287e-92, 3.729750752288765e-93, -7.464449560790477e-93,
      -1.0178371087111594e-92, -5.9929213305664195e-93, 1.0548011185678556e-94,
      3.876432092382993e-93, 4.002451589917492e-93, 1.7652025524043024e-93,
      -6.622160086647821e-94, -1.8042515617760235e-93, -1.4776446440378137e-93,
      -4.172247955752842e-94, 4.90572434644051e-94, 7.770762654307743e-94,
      5.073681796628875e-94, 4.425272048812282e-95, -2.7236251615190204e-94,
      -3.136803635279851e-94, -1.5809913670626524e-94, 3.116257918359144e-95,
      1.3205183642283555e-94, 1.1902120750080771e-94, 4.194926748929427e-95,
      -3.0758057021670035e-95, -5.864317264876969e-95, -4.222512832202543e-95,
      -7.4707045937789555e-96, 1.8691327804833054e-95, 2.431285415958497e-95,
      1.3774042151030673e-95, -8.199204694149939e-97, -9.515668495855961e-96,
      -9.472508345917772e-96, -3.963136236916161e-96, 1.7924204701415057e-96,
      4.3716186587242486e-96, 3.4621950826803094e-96, 8.869893705329802e-97,
      -1.2445186835558947e-96, -1.8636055542820765e-96, -1.1740466009837812e-96,
      -6.127034294097633e-98, 6.734155674592699e-97, 7.453217652744348e-97,
      3.5914689093391925e-97, -9.136812108503892e-98, -3.2157462290291454e-97,
      -2.8011486876261253e-97, -9.19455704736292e-98, 7.950658598509026e-98,
      1.4122572005919917e-97, 9.82726827641351e-98, 1.4406952855409563e-98,
      -4.662910148951471e-98, -5.7995013252926056e-98, -3.157206654347213e-98,
      3.3035479791886772e-99, 2.3306090372287628e-98, 2.2386419805663697e-98,
      8.852304828324114e-99, -4.775314958006366e-99, -1.0574650296330488e-98,
      -8.098606778579426e-99, -1.8556560962716457e-99, 3.1411404157798253e-99,
      4.462986075015647e-99, 2.7106116641727575e-99, 4.071022865073864e-101,
      -1.6605135214182305e-99, -1.7684677489821902e-99, -8.127942445171033e-100,
      2.5812183896923166e-100, 7.816549409490972e-100, 6.582369322584939e-100,
      1.9972859383716796e-100, -2.0397398787695654e-100, -3.3959427949719256e-100,
      -2.282712701772843e-100, -2.6207300343011036e-101, 1.1592944323904005e-100,
      1.3814803474994676e-100, 7.215561068154512e-101, -1.1071817058779158e-101,
      -5.696084747301334e-101, -5.282941753775723e-101, -1.9658151277366256e-101,
      1.2562619675193113e-101, 2.553823667131334e-101, 1.8911255073879187e-101,
      3.802152565874897e-102, -7.892332576367883e-102, -1.0672974692013078e-101,
      -6.2431957600023994e-102, 1.535799861480963e-103, 4.084180816508468e-102,
      4.1902820595064425e-102, 1.8318095305232576e-102, -7.103302263872282e-103,
      -1.8966058357288286e-102, -1.5443472500286385e-102, -4.292044890366509e-103,
      5.199117929848124e-103, 8.153986433472872e-103, 5.291559098880083e-103,
      4.304098352400887e-104, -2.8732492895284057e-103, -3.2862361185560023e-103,
      -1.6438187831754197e-103, 3.395792594077301e-104, 1.3893368385707302e-103,
      1.244879568959897e-103, 4.336292115147049e-104, -3.270936925809159e-104,
      -6.157956925640501e-104, -4.40810625188032e-104, -7.573588793384705e-105
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_9_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<9>(80.0), 40);

  { // polynomial (DF2T)
    constexpr auto design = base_design.poly<double>();
    double max_deviation{};

    static_assert(design.order() == 9, "order");
    static_assert(design.b().size() == 10, "b.size");
    static_assert(design.a().size() == 10, "a.size");

    static_assert(almost_equal(design.b()[0], 0.38141399916796104), "design.b()[0] == 0.38141399916796104");
    max_deviation = std::max(max_deviation, std::abs(design.b()[0] - 0.38141399916796104));
    static_assert(almost_equal(design.b()[1], -3.378589852998629), "design.b()[1] == -3.378589852998629");
    max_deviation = std::max(max_deviation, std::abs(design.b()[1] - -3.378589852998629));
    static_assert(almost_equal(design.b()[2], 13.35451563730729), "design.b()[2] == 13.35451563730729");
    max_deviation = std::max(max_deviation, std::abs(design.b()[2] - 13.35451563730729));
    static_assert(almost_equal(design.b()[3], -30.91469512585748), "design.b()[3] == -30.91469512585748");
    max_deviation = std::max(max_deviation, std::abs(design.b()[3] - -30.91469512585748));
    static_assert(almost_equal(design.b()[4], 46.18891038438281), "design.b()[4] == 46.18891038438281");
    max_deviation = std::max(max_deviation, std::abs(design.b()[4] - 46.18891038438281));
    static_assert(almost_equal(design.b()[5], -46.18891038438281), "design.b()[5] == -46.18891038438281");
    max_deviation = std::max(max_deviation, std::abs(design.b()[5] - -46.18891038438281));
    static_assert(almost_equal(design.b()[6], 30.91469512585748), "design.b()[6] == 30.91469512585748");
    max_deviation = std::max(max_deviation, std::abs(design.b()[6] - 30.91469512585748));
    static_assert(almost_equal(design.b()[7], -13.35451563730729), "design.b()[7] == -13.35451563730729");
    max_deviation = std::max(max_deviation, std::abs(design.b()[7] - -13.35451563730729));
    static_assert(almost_equal(design.b()[8], 3.378589852998629), "design.b()[8] == 3.378589852998629");
    max_deviation = std::max(max_deviation, std::abs(design.b()[8] - 3.378589852998629));
    static_assert(almost_equal(design.b()[9], -0.381413999167961), "design.b()[9] == -0.381413999167961");
    max_deviation = std::max(max_deviation, std::abs(design.b()[9] - -0.381413999167961));
    static_assert(almost_equal(design.a()[0], 1.0), "design.a()[0] == 1.0");
    max_deviation = std::max(max_deviation, std::abs(design.a()[0] - 1.0));
    static_assert(almost_equal(design.a()[1], -6.96289966258225), "design.a()[1] == -6.96289966258225");
    max_deviation = std::max(max_deviation, std::abs(design.a()[1] - -6.96289966258225));
    static_assert(almost_equal(design.a()[2], 21.821182475722), "design.a()[2] == 21.821182475722");
    max_deviation = std::max(max_deviation, std::abs(design.a()[2] - 21.821182475722));
    static_assert(almost_equal(design.a()[3], -40.353375464497965), "design.a()[3] == -40.353375464497965");
    max_deviation = std::max(max_deviation, std::abs(design.a()[3] - -40.353375464497965));
    static_assert(almost_equal(design.a()[4], 48.484506612535625), "design.a()[4] == 48.484506612535625");
    max_deviation = std::max(max_deviation, std::abs(design.a()[4] - 48.484506612535625));
    static_assert(almost_equal(design.a()[5], -39.22111571870036), "design.a()[5] == -39.22111571870036");
    max_deviation = std::max(max_deviation, std::abs(design.a()[5] - -39.22111571870036));
    static_assert(almost_equal(design.a()[6], 21.348122375805602), "design.a()[6] == 21.348122375805602");
    max_deviation = std::max(max_deviation, std::abs(design.a()[6] - 21.348122375805602));
    static_assert(almost_equal(design.a()[7], -7.535227355006563), "design.a()[7] == -7.535227355006563");
    max_deviation = std::max(max_deviation, std::abs(design.a()[7] - -7.535227355006563));
    static_assert(almost_equal(design.a()[8], 1.5643436958167112), "design.a()[8] == 1.5643436958167112");
    max_deviation = std::max(max_deviation, std::abs(design.a()[8] - 1.5643436958167112));
    static_assert(almost_equal(design.a()[9], -0.14547663876128353), "design.a()[9] == -0.14547663876128353");
    max_deviation = std::max(max_deviation, std::abs(design.a()[9] - -0.14547663876128353));
    std::cout << "max_deviation(cheby2,highpass,9,double) = " << max_deviation << "\n";

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);
    static constexpr std::array<double, 1024> expected{{
      0.38141399916796104, -0.7228424468878867, -0.0014682668674605992, 0.2397007298449084,
      0.22815960886256992, 0.11608118354312391, -0.004993939668675451, -0.08929473517671681,
      -0.12289520075576754, -0.11155444021317551, -0.07084508541072354,
      -0.018799021755095402, 0.028963811163361525, 0.06187125631149873, 0.07519915379918357,
      0.06952145418391775, 0.049317305898048946, 0.02120755225574783, -0.007785085844768669,
      -0.03166399225096278, -0.04640427645198991, -0.05035914891738025,
      -0.044166995649640495, -0.030270120023073888, -0.012196812949266694,
      0.006231266229378862, 0.021620574575473943, 0.03154602771774784, 0.03484718409764631,
      0.03166665374773253, 0.023261094019085438, 0.011647818252087716, -0.00083199523318854,
      -0.011949957859629715, -0.019954595635961067, -0.023811798669114537,
      -0.023297131525607223, -0.018942742240380783, -0.011864956201518506,
      -0.003514910489790149, 0.004597943945165876, 0.011161095446995867,
      0.015253677426617832, 0.016455670469890618, 0.014863352168151753,
      0.011018867420216016, 0.005774812662770773, 0.00012291462593740782,
      -0.004981527869682074, -0.008770567958003083, -0.010768162730164989,
      -0.010836459543256183, -0.009162600625385223, -0.006194537708544334,
      -0.0025416364369858224, 0.0011401854127199747, 0.004258675059658186,
      0.0063736056777889336, 0.007251417430859414, 0.006880950370490101,
      0.005451872461134467, 0.0033032137524988056, 0.0008534178161322369,
      -0.00147493234230867, -0.0033231026647547353, -0.004446805135605025,
      -0.004743153288505685, -0.004252170261236886, -0.003135303797250164,
      -0.0016368173740301702, -3.604030137869217e-05, 0.0014009269987833165,
      0.002462281532068418, 0.003018567974857833, 0.0030346122485246443,
      0.0025651424148423925, 0.0017365262054522441, 0.0007190130452095975,
      -0.00030508160879928314, -0.001171741445642352, -0.0017594721959080335,
      -0.0020041689564371957, -0.0019032489437255332, -0.001509530159837241,
      -0.0009169216906297524, -0.00024107850572958542, 0.0004013578565453409,
      0.0009114704674405721, 0.0012219624672990276, 0.0013045316621291478,
      0.0011702407002812457, 0.000863568176301021, 0.00045176132432072844,
      1.1688288764652964e-05, -0.00038344676042907275, -0.0006753917335138872,
      -0.0008285494170319277, -0.0008332472864398949, -0.0007045239927136139,
      -0.00047710277470722727, -0.00019775910129270777, 8.342280880673414e-05,
      0.0003213915983832949, 0.0004827805053858186, 0.0005499877523000092,
      0.0005223080639046671, 0.00041424836937635576, 0.0002515958095972511,
      6.610433896569881e-05, -0.00011020552841625205, -0.0002501833203501051,
      -0.00033536204450287563, -0.00035798080481387997, -0.000321084363555422,
      -0.0002368882679014894, -0.00012385480105044154, -3.083333882507658e-06,
      0.00010533615695003439, 0.00018542075405749152, 0.00022740763143262992,
      0.0002286500654450625, 0.00019328290489003847, 0.00013084173033190132,
      5.416726268541762e-05, -2.2994651875240396e-05, -8.8282223838002e-05,
      -0.00013254265422252948, -0.0001509510525342625, -0.00014331991506121955,
      -0.00011363587133632357, -6.897977977093483e-05, -1.806803172908116e-05,
      3.031194174113851e-05, 6.87111196255938e-05, 9.206493008690793e-05,
      9.8247647175228e-05, 8.8098983793451e-05, 6.497476786691987e-05,
      3.394399569998149e-05, 7.979660345050206e-07, -2.895044389626542e-05,
      -5.0916662291492913e-05, -6.242392225036758e-05, -6.274868088357419e-05,
      -5.3028333159483557e-05, -3.5881856609732993e-05, -1.4834435464957686e-05,
      6.341297789357557e-06, 2.4253441570336265e-05, 3.6391460931733846e-05,
      4.1432974942399645e-05, 3.932836743362301e-05, 3.117335019652955e-05,
      1.8912359382068048e-05, 4.938093600130426e-06, -8.337874064003147e-06,
      -1.8871831867475765e-05, -2.5274851288560954e-05, -2.6964735809010626e-05,
      -2.417310928030773e-05, -1.7821918223449564e-05, -9.302937359654889e-06,
      -2.0576992415882668e-07, 7.956786637516188e-06, 1.3981915824888643e-05,
      1.7135707631689456e-05, 1.7220376490805018e-05, 1.4548800695031149e-05,
      9.84030102817297e-06, 4.062661305515532e-06, -1.7486891311919482e-06,
      -6.663055660461942e-06, -9.991818070246906e-06, -1.1372545688738945e-05,
      -1.0792128875552443e-05, -8.55172191293932e-06, -5.185278174850517e-06,
      -1.3496092368871525e-06, 2.2934644449071498e-06, 5.18322925705677e-06,
      6.93877926700976e-06, 7.400662130864105e-06, 6.632766727059528e-06,
      4.888379467490983e-06, 2.5496349502406997e-06, 5.2850029510201666e-08,
      -2.186845693506049e-06, -3.839484115994073e-06, -4.703843359036875e-06,
      -4.725858038803853e-06, -3.991595191353054e-06, -2.698621247446248e-06,
      -1.1126260103534883e-06, 4.822085566842463e-07, 1.830511645164713e-06,
      2.743400078070342e-06, 3.121541025010094e-06, 2.9614757625061237e-06,
      2.3459757270246883e-06, 1.4216674867624723e-06, 3.6885010312939945e-07,
      -6.308496521363296e-07, -1.423594189212442e-06, -1.904922229285923e-06,
      -2.031163035990549e-06, -1.8199386247636075e-06, -1.3408342695085286e-06,
      -6.987712330287654e-07, -1.3510422787711698e-08, 6.01031701664554e-07,
      1.0543351816139636e-06, 1.2912294950281685e-06, 1.2969359103805849e-06,
      1.0951297359996165e-06, 7.400739018207766e-07, 3.0470932110042174e-07,
      -1.3296799606098742e-07, -5.028875645740356e-07, -7.532402290200776e-07,
      -8.568014990129101e-07, -8.126603325379137e-07, -6.435661746964461e-07,
      -3.897834667610718e-07, -1.0080545510843667e-07, 1.7352311565997102e-07,
      3.9099532840633413e-07, 5.229632989664836e-07, 5.574665604458828e-07,
      4.99365544329413e-07, 3.677773565738569e-07, 1.9150981774911395e-07,
      3.4350689736978166e-09, -1.651868817338589e-07, -2.895237601362651e-07,
      -3.544490674973258e-07, -3.5592311501293837e-07, -3.004584658568724e-07,
      -2.0295877883547283e-07, -8.34488127875013e-08, 3.6664812354593135e-08,
      1.3815565935425522e-07, 2.0681289802625216e-07, 2.3517503510975944e-07,
      2.23002520007001e-07, 1.7654794381687612e-07, 1.0686812987992376e-07,
      2.754928530805837e-08, -4.7729452150310114e-08, -1.0738818825671811e-07,
      -1.435704183584288e-07, -1.5300044535897244e-07, -1.3701881972304585e-07,
      -1.0087756086752339e-07, -5.248631483809626e-08, -8.678692892852363e-10,
      4.539966752348207e-08, 7.950407966596038e-08, 9.729803169174974e-08,
      9.767731411262289e-08, 8.243338143500712e-08, 5.565961435884719e-08,
      2.285348687783897e-08, -1.0109787597162858e-08, -3.795472489797445e-08,
      -5.6783412478409554e-08, -6.455086224353191e-08, -6.119420700735992e-08,
      -4.8431941314389795e-08, -2.930032372904802e-08, -7.5288518855401e-09,
      1.3128442754086962e-08, 2.9494500668938182e-08, 3.9414726111534305e-08,
      4.199198508538756e-08, 3.759600420311964e-08, 2.766966232359986e-08,
      1.4384677530562855e-08, 2.1763523637995776e-10, -1.2477533213261256e-08,
      -2.1832039642857074e-08, -2.6708782278546e-08, -2.6805941273646573e-08,
      -2.261630126426875e-08, -1.5264133111061984e-08, -6.258678750001022e-09,
      2.7875643876723933e-09, 1.0427072703321395e-08, 1.5590681928499853e-08,
      1.771791885699675e-08, 1.6792319284642035e-08, 1.328620197648255e-08,
      8.033338005753099e-09, 2.0574970371558276e-09, -3.6110844333245414e-09,
      -8.10074883468897e-09, -1.0820612710930089e-08, -1.1524973966216558e-08,
      -1.031580146059827e-08, -7.589494412858319e-09, -3.9423319384360404e-09,
      -5.408986025613768e-11, 3.4292862974717182e-09, 5.995134082405693e-09,
      7.331687362613248e-09, 7.356449393623805e-09, 6.204972224210957e-09,
      4.186043098307159e-09, 1.7139996063348977e-09, -7.685961170531559e-10,
      -2.8645627651566073e-09, -4.28063787016915e-09, -4.86321197179959e-09,
      -4.607983193222445e-09, -3.6447654228097356e-09, -2.202516007301124e-09,
      -5.622657943950943e-10, 9.93252678653043e-10, 2.2248916839261207e-09,
      2.970605537648724e-09, 3.1631030252652455e-09, 2.830505993012933e-09,
      2.081716247295369e-09, 1.0804514380997326e-09, 1.3297090092854755e-11,
      -9.424920694988382e-10, -1.646278033109452e-09, -2.012582091498966e-09,
      -2.0188557027430964e-09, -1.702385449007814e-09, -1.1479813820562973e-09,
      -4.693930289989624e-10, 2.1191512553117602e-10, 7.869618360546711e-10,
      1.1753078110646932e-09, 1.3348532436304334e-09, 1.2644769614025603e-09,
      9.99857419107346e-10, 6.038673054640936e-10, 1.5365122300707722e-10,
      -2.7319926748380126e-10, -6.110716928026988e-10, -8.15526190131526e-10,
      -8.681335874360367e-10, -7.766493812834472e-10, -5.709918606482452e-10,
      -2.961122119414854e-10, -3.224590207957642e-12, 2.5903032980256673e-10,
      4.520715320597615e-10, 5.524628595807765e-10, 5.540413048896824e-10,
      4.670633078978556e-10, 3.148223759648126e-10, 1.2854654394429477e-10,
      -5.842736531107804e-11, -2.1619636615517089e-10, -3.2269669011302376e-10,
      -3.663900518154315e-10, -3.4698506857576747e-10, -2.7428769404163564e-10,
      -1.6556303116490775e-10, -4.1987713135160427e-11, 7.514446730724247e-11,
      1.67832107168747e-10, 2.2388790493809216e-10, 2.382646523714774e-10,
      2.13101124017462e-10, 1.5661667600520787e-10, 8.11533375006997e-11,
      7.6840826041026e-13, -7.119057306403903e-11, -1.2413973939405673e-10,
      -1.5165348221770605e-10, -1.5204734642767441e-10, -1.281425606963907e-10,
      -8.633679783572478e-11, -3.520318969430877e-11, 1.610873048150751e-11,
      5.93939896844844e-11, 8.860070037576582e-11, 1.0056657415026697e-10,
      9.521612072858409e-11, 7.524442569503086e-11, 4.5392555057477465e-11,
      1.1473612889293402e-11, -2.0668653952249296e-11, -4.6095392499938944e-11,
      -6.146432910383342e-11, -6.539318843383377e-11, -5.847177776072098e-11,
      -4.295817134983436e-11, -2.2241058346242187e-11, -1.788954399651749e-13,
      1.956560668699427e-11, 3.40889946750915e-11, 4.1629529617580175e-11,
      4.17268291899241e-11, 3.5156921647053385e-11, 2.367695662759712e-11,
      9.640542191033842e-12, -4.4411667287402525e-12, -1.6316837948730162e-11,
      -2.4326495852593573e-11, -2.7603456596365703e-11, -2.6128231280130696e-11,
      -2.0641540148576892e-11, -1.2445297875380206e-11, -3.13523331664794e-12,
      5.684929618102863e-12, 1.2660171144537185e-11, 1.6873899273321332e-11,
      1.7947553052010225e-11, 1.6043779104180316e-11, 1.1782929196709638e-11,
      6.095418211312375e-12, 4.0317410905035124e-14, -5.3772856983434896e-12,
      -9.36089237937203e-12, -1.1427479146602323e-11, -1.1451220045646582e-11,
      -9.645574034977608e-12, -6.4931497095802e-12, -2.6400899662515128e-12,
      1.2244009958764441e-12, 4.482588727580102e-12, 6.679157901594231e-12,
      7.576578255377768e-12, 7.169838458414005e-12, 5.662518365187842e-12,
      3.412128419225686e-12, 8.567047320524297e-13, -1.5636361961912778e-12,
      -3.477132386128759e-12, -4.632415998537234e-12, -4.925811807492901e-12,
      -4.4021705821415696e-12, -3.231918854298495e-12, -1.6705156892280497e-12,
      -8.655421885918913e-15, 1.4778551502770679e-12, 2.5705141919055e-12,
      3.1368892672101978e-12, 3.1425918033288802e-12, 2.646336771958277e-12,
      1.7806745418870862e-12, 7.229925255269591e-13, -3.375523902523119e-13,
      -1.2314624772868219e-12, -1.8338492114631746e-12, -2.0796133080673283e-12,
      -1.967472002798971e-12, -1.553377128731104e-12, -9.355022674055412e-13,
      -2.340906249746852e-13, 4.300748757724447e-13, 9.549980086071256e-13,
      1.2717432674554228e-12, 1.3519176006423485e-12, 1.2078885886920816e-12,
      8.864767017621659e-13, 4.57821936909116e-13, 1.714168812163131e-15,
      -4.061622869489329e-13, -7.058663112560488e-13, -8.610884346930743e-13,
      -8.624303349188655e-13, -7.260423253256516e-13, -4.883298566745124e-13,
      -1.9799156699471945e-13, 9.305713974711083e-14, 3.3830846739143917e-13,
      5.035067434599679e-13, 5.708104212114311e-13, 5.398928577981944e-13,
      4.2613180252774617e-13, 2.564860350484677e-13, 6.396293107528671e-14,
      -1.182905835954229e-13, -2.622909445923109e-13, -3.49133189181621e-13,
      -3.7104148204938065e-13, -3.3142610054987447e-13, -2.431497913895641e-13,
      -1.2547049868689657e-13, -2.8896438333545997e-16, 1.116262392645686e-13,
      1.938316083905746e-13, 2.3637206072212563e-13, 2.3667910129610583e-13,
      1.9919505882773326e-13, 1.3391881593179063e-13, 5.421973282046822e-14,
      -2.5653657440502316e-14, -9.294027408152792e-14, -1.382441353889446e-13,
      -1.5667547845200191e-13, -1.4815163014183532e-13, -1.168989863424353e-13,
      -7.032050896380151e-14, -1.7476887801758116e-14, 3.253524118907019e-14,
      7.203834388767513e-14, 9.584790352489542e-14, 1.0183440891818375e-13,
      9.093819994005564e-14, 6.669298775705092e-14, 3.4386314678419836e-14,
      2.949870848325203e-17, -3.067834769029166e-14, -5.3226319921212205e-14,
      -6.488500521895186e-14, -6.495246480860904e-14, -5.465060548170892e-14,
      -3.6725652213293586e-14, -1.484792750988529e-14, 7.0719640141941714e-15,
      2.5532563942502944e-14, 3.795665206290525e-14, 4.300411323449874e-14,
      4.065417175628728e-14, 3.206840064976882e-14, 1.9279674063356073e-14,
      4.7751956327584525e-15, -8.948611438398524e-15, -1.9785349920317805e-14,
      -2.6313213817030193e-14, -2.7949012311648902e-14, -2.4952026163400014e-14,
      -1.829305089694998e-14, -9.423855595674063e-15, 5.573172237693918e-18,
      8.431340217121406e-15, 1.461598123846235e-14, 1.781116651206296e-14,
      1.7825068119340004e-14, 1.4993781891804415e-14, 1.007156655173589e-14,
      4.0660440544343506e-15, -1.9494945715826396e-15, -7.0142995173167974e-15,
      -1.0421466529471237e-14, -1.1803717168052267e-14, -1.1155874801655861e-14,
      -8.797182740473276e-15, -5.285873544583916e-15, -1.304696480524067e-15,
      2.461246122937435e-15, 5.43404642026009e-15, 7.223787565703893e-15,
      7.670756914836896e-15, 6.846444600803944e-15, 5.01755114756728e-15,
      2.5826799437457707e-15, -5.280873603772798e-18, -2.3171825150025104e-15,
      -4.01355492219739e-15, -4.889226995873023e-15, -4.891776397033972e-15,
      -4.113648640228366e-15, -2.762002892611688e-15, -1.113463761176156e-15,
      5.373971179534141e-16, 1.9269639312200548e-15, 2.8613404505553186e-15,
      3.2398687997877323e-15, 3.061272404162781e-15, 2.4132909431884023e-15,
      1.4492164300978347e-15, 3.564667173800082e-16, -6.769431884160885e-16,
      -1.4924594703632538e-15, -1.983151220477091e-15, -2.1052797471911702e-15,
      -1.8785562198569434e-15, -1.37624948594755e-15, -7.078015866522927e-16,
      2.4788390550702662e-18, 6.368290324072144e-16, 1.1021231905341682e-15,
      1.3421092075892405e-15, 1.342461480798503e-15, 1.1286076612242242e-15,
      7.574445118580332e-16, 3.0491434057305505e-16, -1.4813580002856312e-16,
      -5.293735842979863e-16, -7.856154006306686e-16, -8.892745908175466e-16,
      -8.400403597598984e-16, -6.620267062543591e-16, -3.97327958745727e-16,
      -9.739116863105612e-17, 1.8618607354774878e-16, 4.099032318202013e-16,
      5.444355703434513e-16, 5.778049286419798e-16, 5.154459272812438e-16,
      3.774871973540188e-16, 1.9397753918027067e-16, -9.628519239558194e-19,
      -1.7501869905950368e-16, -3.026430942353993e-16, -3.6841332382956924e-16,
      -3.684146626943875e-16, -3.0964108998242994e-16, -2.0771942352526226e-16,
      -8.349824741176551e-17, 4.0833460671403247e-17, 1.4542877625223618e-16,
      2.1570002729481524e-16, 2.4408673279831523e-16, 2.3051445207811705e-16,
      1.8161055764254628e-16, 1.0893423773875033e-16, 2.6607935589898776e-17,
      -5.120825381674842e-17, -1.1257960841300663e-16, -1.4946411909697516e-16,
      -1.5858149532789638e-16, -1.4143009896193596e-16, -1.0353971837355711e-16,
      -5.31606555731066e-17, 3.417928371761058e-19, 4.809999564607388e-17,
      8.310575399738215e-17, 1.0113060803659445e-16, 1.0110480987678705e-16,
      8.495207183397199e-17, 5.696432883325032e-17, 2.2865179010677257e-17,
      -1.1255476639176378e-17, -3.995193673200486e-17, -5.922296815338229e-17,
      -6.699652793673335e-17, -6.32551654250178e-17, -4.982031062769927e-17,
      -2.986613792326735e-17, -7.269318823281423e-18, 1.4084147097356246e-17,
      3.09198743506536e-17, 4.103242617717367e-17, 4.3523479965414444e-17,
      3.880613545056835e-17, 2.8399547933607366e-17, 1.4568947448826347e-17,
      -1.1508440456537273e-19, -1.3219182968174614e-17, -2.282081327567456e-17,
      -2.776065610682171e-17, -2.7746394969211612e-17, -2.3307149194496593e-17,
      -1.562170567150474e-17, -6.261373027700985e-18, 3.1024386913156717e-18,
      1.0975510511060104e-17, 1.6260350296827518e-17, 1.8389090458755285e-17,
      1.7357759378097718e-17, 1.3666947498994045e-17, 8.188288337645682e-18,
      1.9859444780982155e-18, -3.873637346895472e-18, -8.49210397893369e-18,
      -1.1264638049981571e-17, -1.194523102384642e-17, -1.0647772466140911e-17,
      -7.789607390073178e-18, -3.992684448985226e-18, 3.74247706544363e-20,
      3.63298148756684e-18, 6.266583623908852e-18, 7.620380410950433e-18,
      7.614495749517071e-18, 6.3944637697712776e-18, 4.2840398969994225e-18,
      1.7145978180531853e-18, -8.551340747748523e-19, -3.0151646252529983e-18,
      -4.464464597092919e-18, -5.047403601954975e-18, -4.763116041300169e-18,
      -3.74918073731534e-18, -2.2449495220560294e-18, -5.425393636157887e-19,
      1.0653816134804503e-18, 2.3323433405187386e-18, 3.092481298091523e-18,
      3.2784255961205582e-18, 2.921574369542047e-18, 2.1365812136368512e-18,
      1.0942102028624747e-18, -1.1873902351929337e-20, -9.984371978458935e-19,
      -1.7207994558971183e-18, -2.091815590911581e-18, -2.0896597134588517e-18,
      -1.7543607379234093e-18, -1.1748384491639588e-18, -4.695184486916947e-19,
      2.3569858489931006e-19, 8.283173075468804e-19, 1.225768983504708e-18,
      1.3854014842387767e-18, 1.3070388335555308e-18, 1.0284921553770125e-18,
      6.154877649848587e-19, 1.482129273617883e-19, -2.9301461037244737e-19,
      -6.405739293127268e-19, -8.489785493984841e-19, -8.997791954934333e-19,
      -8.016318176899926e-19, -5.860341653119235e-19, -2.998717048874189e-19,
      3.698625954547045e-21, 2.743957120351327e-19, 4.725299929615736e-19,
      5.7420894979802e-19, 5.734688445632592e-19, 4.813195046682373e-19,
      3.2218282416238916e-19, 1.2857032812859427e-19, -6.496382199207658e-20,
      -2.2755262594875446e-19, -3.3654847828532083e-19, -3.802621462996828e-19,
      -3.5866223524516547e-19, -2.8214044408053787e-19, -1.6874528931367012e-19,
      -4.048848358505808e-20, 8.058815323049924e-20, 1.7593232171565903e-19,
      2.3306987764659676e-19, 2.469485042325993e-19, 2.199544556092269e-19,
      1.6074081266265793e-19, 8.218057427484177e-20, -1.1357945112069603e-21,
      -7.541068581659565e-20, -1.2975622401585167e-19, -1.5762181969299712e-19,
      -1.573779645236141e-19, -1.3205286134428111e-19, -8.835399768531683e-20,
      -3.520679802018514e-20, 1.7905153937960875e-20, 6.25124294125998e-20,
      9.240306850655365e-20, 1.0437353024239165e-19, 9.841983686364054e-20,
      7.739795086955079e-20, 4.62640107352442e-20, 1.1060313695658912e-20,
      -2.216414536807932e-20, -4.831940825332084e-20, -6.398458751365816e-20,
      -6.777611795502611e-20, -6.03518236805756e-20, -4.408888104704193e-20,
      -2.2521733021183802e-20, 3.448451647806271e-22, 2.072466244512987e-20,
      3.563089386562612e-20, 4.326757297226351e-20, 4.318946818413109e-20,
      3.622946859324708e-20, 2.4229787855960015e-20, 9.640731335713384e-21,
      -4.9348791203230166e-21, -1.7173163864995148e-20, -2.537025981679439e-20,
      -2.864820937327273e-20, -2.7007193829030982e-20, -2.1232118771179276e-20,
      -1.2683943223354753e-20, -3.0212996199345485e-21, 6.095771009908187e-21,
      1.3270802295178708e-20, 1.7565656937539746e-20, 1.8601450767243585e-20,
      1.655952398314711e-20, 1.2092934113033164e-20, 6.172106169125353e-21,
      -1.0373385623580524e-22, -5.695620561897143e-21, -9.784191325987762e-21,
      -1.1877049076851388e-20, -1.1852545355261878e-20, -9.93976015265101e-21,
      -6.644657581425055e-21, -2.639922010774571e-21, 1.3600880179640855e-21,
      4.7177363091468096e-21, 6.965674808420143e-21, 7.863292347111206e-21,
      7.410988038271528e-21, 5.824477365825311e-21, 3.477480349766355e-21,
      8.252973980499613e-22, -1.6765023841431008e-21, -3.644788659733932e-21,
      -4.8222887826466106e-21, -5.1052472687620715e-21, -4.5436525699893095e-21,
      -3.3169123033908467e-21, -1.6914685043225737e-21, 3.0964688032547287e-23,
      1.5652857915569408e-21, 2.6867227688048284e-21, 3.260276138067295e-21,
      3.252709156417288e-21, 2.727028261121792e-21, 1.822196401735557e-21,
      7.228860901573091e-22, -3.7484317966535503e-22, -1.2960340912179869e-21,
      -1.9124990844510276e-21, -2.1582969365140165e-21, -2.0336330606994033e-21,
      -1.5977923718969968e-21, -9.533985005290611e-22, -2.254329494696394e-22,
      4.610813884181998e-22, 1.0010300695187785e-21, 1.3238592928440706e-21,
      1.4011562985406459e-21, 1.246700688112315e-21, 9.097791588607881e-22,
      4.635465838158516e-22, -9.182959678799986e-24, -4.3017508253944125e-22,
      -7.37769124187376e-22, -8.949526086729925e-22, -8.926447922845034e-22,
      -7.481749533972843e-22, -4.9970920464316e-22, -1.9794579632401378e-22,
      1.0330572281056133e-22, 3.560398443978154e-22, 5.25096394155851e-22,
      5.9240374802585985e-22, 5.580445938760415e-22, 4.383121196327691e-22,
      2.6138678557693773e-22, 6.157642281824134e-23, -1.26808657211466e-22,
      -2.7492959747450805e-22, -3.6343791989537266e-22, -3.845530165850778e-22,
      -3.420732383789933e-22, -2.495385632818358e-22, -1.270345324292956e-22,
      2.708170240509277e-24, 1.1822133907344504e-22, 2.0258990324933447e-22,
      2.4566625735518507e-22, 2.449694662275448e-22, 2.0526574711095116e-22,
      1.370373961757542e-22, 5.420262649173177e-23, -2.8470256705713365e-23,
      -9.780931006003628e-23, -1.4417056353201533e-22, -1.6260138192303841e-22,
      -1.5313167997424796e-22, -1.2023928066169587e-22, -7.166253611135175e-23,
      -1.6819054162685768e-23, 3.487531339950798e-23, 7.550843526428877e-23,
      9.977424363798354e-23, 1.0554209213996088e-22, 9.385897675291004e-23,
      6.844457768891842e-23, 3.4813616265564163e-23, -7.948258555359354e-25,
      -3.248968619197872e-23, -5.563073777205774e-23, -6.743584431580676e-23,
      -6.722720769629493e-23, -5.631571413520214e-23, -3.758031626992802e-23,
      -1.4841985483261594e-23, 7.846043012323645e-24, 2.686960024681527e-23,
      3.958347484930735e-23, 4.4630371151632343e-23, 4.2020480983481944e-23,
      3.2984432266910404e-23, 1.964717439529843e-23, 4.593869336967197e-24,
      -9.591471633553438e-24, -2.0738103951898273e-23, -2.739090909364194e-23,
      -2.896643261341946e-23, -2.5753268014435685e-23, -1.87732782508312e-23,
      -9.540594013137983e-24, 2.322922392550813e-25, 8.928822317883262e-24,
      1.5276066627194965e-23, 1.8511256892318233e-23, 1.844922074303763e-23,
      1.5450498618147946e-23, 1.030579137573414e-23, 4.064070988220873e-24,
      -2.1622322914206877e-24, -7.381449163782206e-24, -1.0868034210316068e-23,
      -1.2250014317371916e-23, -1.1530730493215834e-23, -9.04839208202047e-24,
      -5.3865092050154855e-24, -1.2547163800913252e-24, 2.6378512115475383e-24,
      5.69563599636662e-24, 7.519591448404579e-24, 7.949945723283102e-24,
      7.066245078663192e-24, 5.149213235247205e-24, 2.614572101675066e-24,
      -6.76365046746852e-26, -2.453815292919454e-24, -4.194768231382234e-24,
      -5.0813701842605054e-24, -5.0630337007462136e-24, -4.2389197574768e-24,
      -2.826193186530571e-24, -1.112828319449532e-24, 5.958630276592567e-25,
      2.02778301072274e-24, 2.9839245523747096e-24, 3.36234695577391e-24,
      3.1641164162916467e-24, 2.4821816587471078e-24, 1.4767741815217832e-24,
      3.426906526734756e-25, -7.254596699072985e-25, -1.5642818568577681e-24,
      -2.0643429125083467e-24, -2.1818915075341377e-24, -1.9388528990555796e-24,
      -1.4123467238081434e-24, -7.1651412580928035e-25, 1.9628721482752813e-26,
      6.74355002965061e-25, 1.1518716752836358e-24, 1.394843814375771e-24,
      1.3894516727601894e-24, 1.1629677815530639e-24, 7.750360883542022e-25,
      3.047141644924733e-25, -1.6420372979530798e-25, -5.570584258085261e-25,
      -8.192650720406396e-25, -9.228864860663227e-25, -8.682562465254883e-25,
      -6.809190217817678e-25, -4.0487424620057445e-25, -9.359412981086071e-26,
      1.9951437473913422e-25, 4.296228723035512e-25, 5.667209044275697e-25,
      5.988278328392792e-25, 5.319867807463476e-25, 3.8738381057417577e-25,
      1.9635764479395383e-25, -5.6796193507577545e-27, -1.8532513644452019e-25,
      -3.1630053801841507e-25, -3.8288658072432012e-25, -3.813079943866517e-25,
      -3.190655851860293e-25, -2.1254044556976162e-25, -8.343623435596568e-26,
      4.5249329248292016e-26, 1.5303100715319479e-25, 2.249369503577684e-25,
      2.533109007831508e-25, 2.3825565039498905e-25, 1.8679150617653852e-25,
      1.110006673439389e-25, 2.556139341840336e-26, -5.486975942325792e-26,
      -1.179938534928371e-25, -1.5558095086066291e-25, -1.643503528222452e-25,
      -1.45967656964982e-25, -1.0625302336684137e-25, -5.381084257723709e-26,
      1.6390486552312526e-27, 5.093063670005665e-26, 8.685512814072137e-26,
      1.0510285888086575e-25, 1.0464252540717882e-25, 8.753707579702937e-26,
      5.828554058697547e-26, 2.2846217968825847e-26, -1.2469064862675695e-26,
      -4.203950058027247e-26, -6.175852668464853e-26, -6.952793064220981e-26,
      -6.537900873898067e-26, -5.124111063259849e-26, -3.0431993449706046e-26,
      -6.980875586744965e-27, 1.5090022108878464e-26, 3.2406414304887415e-26,
      4.2711360673540317e-26, 4.5106501193863705e-26, 4.00508971497973e-26,
      2.9143440147279216e-26, 1.4746558831029593e-26, -4.718678234156792e-28,
      -1.399661178591112e-26, -2.3850127408076673e-26, -2.885085791774983e-26,
      -2.871708479410111e-26, -2.4016178230277622e-26, -1.5983785796141793e-26,
      -6.2556363304547774e-27, 3.435961530124685e-27, 1.1548752746666656e-26,
      1.6956367180351866e-26
    }};
    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-07), expected));
  }

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 9, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.38141399916796104, -0.7228424468878869, -0.001468266867464374, 0.23970072984488977,
      0.22815960886251543, 0.11608118354301122, -0.0049939396688569344,
      -0.08929473517695764, -0.12289520075604457, -0.11155444021347832,
      -0.07084508541109584, -0.01879902175567785, 0.0289638111623064, 0.06187125630959736,
      0.07519915379600589, 0.06952145417906969, 0.04931730589128339, 0.021207552247066122,
      -0.007785085855053598, -0.03166399226222249, -0.04640427646334339,
      -0.05035914892781565, -0.044166995658173856, -0.03027012002891381,
      -0.012196812951952105, 0.006231266229895911, 0.02162057457881724, 0.03154602772318005,
      0.03484718410419341, 0.0316666537543452, 0.02326109402480657, 0.011647818256195246,
      -0.0008319952310881307, -0.01194995785957109, -0.0199545956376539,
      -0.023811798672030395, -0.02329713152909916, -0.018942742243810994,
      -0.011864956204369947, -0.003514910491743115, 0.004597943944203025,
      0.011161095446902901, 0.015253677427117671, 0.016455670470628278,
      0.014863352168779173, 0.011018867420465508, 0.005774812662503843,
      0.00012291462516187765, -0.004981527870826888, -0.00877056795928706,
      -0.010768162731323312, -0.010836459544048441, -0.00916260062564557,
      -0.006194537708213465, -0.0025416364361197184, 0.0011401854139646067,
      0.004258675061057345, 0.006373605679095942, 0.007251417431851564, 0.00688095037100848,
      0.005451872461110054, 0.0033032137519609086, 0.0008534178151988339,
      -0.0014749323434558826, -0.0033231026659052013, -0.004446805136557347,
      -0.004743153289101918, -0.004252170261387344, -0.003135303796944977,
      -0.001636817373336393, -3.604030042438472e-05, 0.00140092699983444,
      0.0024622815330467623, 0.0030185679756167027, 0.0030346122489631755,
      0.002565142414919126, 0.00173652620518769, 0.0007190130446781302,
      -0.0003050816094860439, -0.0011717414463571997, -0.0017594721965307721,
      -0.0020041689568742298, -0.00190324894392333, -0.0015095301597878525,
      -0.000916921690368102, -0.00024107850532367647, 0.00040135785700901825,
      0.0009114704678735304, 0.0012219624676261785, 0.001304531662300561,
      0.0011702407002785722, 0.000863568176137939, 0.0004517613240378407,
      1.1688288420183328e-05, -0.00038344676077083973, -0.0006753917337942577,
      -0.0008285494172075436, -0.0008332472864890678, -0.0007045239926384435,
      -0.00047710277453147615, -0.0001977591010561149, 8.34228090564679e-05,
      0.0003213915985993164, 0.00048278050553016676, 0.0005499877523495762,
      0.0005223080638542058, 0.00041424836923822467, 0.0002515958093981641,
      6.61043387412336e-05, -0.00011020552862829934, -0.0002501833205163078,
      -0.00033536204459958695, -0.0003579808048306246, -0.0003210843634958299,
      -0.00023688826778178341, -0.0001238548008959013, -3.0833337226402264e-06,
      0.00010533615708672002, 0.00018542075414820257, 0.00022740763146374167,
      0.00022865006541380916, 0.00019328290480427702, 0.00013084173020811788,
      5.41672625454296e-05, -2.2994652008245473e-05, -8.828222394338431e-05,
      -0.00013254265428542156, -0.00015095105254761377, -0.0001433199150264075,
      -0.00011363587126233567, -6.897977967236342e-05, -1.8068031623351473e-05,
      3.0311941836792535e-05, 6.871111969689076e-05, 9.206493012458673e-05,
      9.824764717614004e-05, 8.80989837605766e-05, 6.497476780839245e-05,
      3.394399562735684e-05, 7.979659606171614e-07, -2.8950443959480722e-05,
      -5.091666233485092e-05, -6.242392226868939e-05, -6.274868087618916e-05,
      -5.302833312996006e-05, -3.5881856564945435e-05, -1.4834435413696238e-05,
      6.341297837970794e-06, 2.4253441608351483e-05, 3.6391460953560875e-05,
      4.1432974945512776e-05, 3.9328367418710325e-05, 3.1173350167110526e-05,
      1.8912359343687382e-05, 4.938093559295143e-06, -8.337874100949484e-06,
      -1.8871831895354516e-05, -2.5274851304084825e-05, -2.6964735811142052e-05,
      -2.4173109270224054e-05, -1.782191820415557e-05, -9.302937335336358e-06,
      -2.0576989940403352e-07, 7.956786658489811e-06, 1.3981915838878314e-05,
      1.713570763692884e-05, 1.7220376487115817e-05, 1.4548800683704396e-05,
      9.84030101162386e-06, 4.062661286788316e-06, -1.7486891489751576e-06,
      -6.663055674614109e-06, -9.99181807891123e-06, -1.1372545691113218e-05,
      -1.07921288719221e-05, -8.551721904531508e-06, -5.185278163549221e-06,
      -1.3496092248681677e-06, 2.2934644555550896e-06, 5.183229264662254e-06,
      6.938779270551516e-06, 7.4006621300777235e-06, 6.632766722412381e-06,
      4.888379460041349e-06, 2.5496349414143157e-06, 5.2850020837654803e-08,
      -2.1868457006453423e-06, -3.839484120580739e-06, -4.703843360543996e-06,
      -4.725858037238563e-06, -3.9915951872088195e-06, -2.698621241581589e-06,
      -1.1126260038232334e-06, 4.822085628138429e-07, 1.8305116499859145e-06,
      2.7434000809631096e-06, 3.1215410257136e-06, 2.96147576112652e-06,
      2.3459757239838383e-06, 1.421667482701376e-06, 3.6885009878597337e-07,
      -6.308496560532169e-07, -1.4235941921322787e-06, -1.9049222308533932e-06,
      -2.031163036100766e-06, -1.8199386235541139e-06, -1.3408342673134948e-06,
      -6.987712303063203e-07, -1.3510420034577109e-08, 6.01031703996289e-07,
      1.0543351831848555e-06, 1.2912294956548253e-06, 1.2969359100498935e-06,
      1.0951297348543172e-06, 7.400739001214461e-07, 3.0470931917223176e-07,
      -1.3296799788673314e-07, -5.028875660137066e-07, -7.532402298786822e-07,
      -8.568014992068905e-07, -8.126603320978743e-07, -6.435661737513243e-07,
      -3.897834655080797e-07, -1.0080545377495665e-07, 1.7352311685565954e-07,
      3.9099532928909106e-07, 5.229632994281572e-07, 5.574665604561284e-07,
      4.993655439329995e-07, 3.6777735587619107e-07, 1.9150981689343928e-07,
      3.435068114431717e-09, -1.651868824569949e-07, -2.8952376061924524e-07,
      -3.544490676850505e-07, -3.559231149033245e-07, -3.004584654960348e-07,
      -2.029587783056365e-07, -8.344881219029182e-08, 3.6664812916348926e-08,
      1.3815565979315166e-07, 2.0681289828283813e-07, 2.3517503515937407e-07,
      2.2300251986037533e-07, 1.7654794351501594e-07, 1.0686812948465352e-07,
      2.7549284890164697e-08, -4.7729452523206655e-08, -1.073881885306025e-07,
      -1.4357041850014587e-07, -1.5300044535945554e-07, -1.3701881959640222e-07,
      -1.0087756064652841e-07, -5.248631456716566e-08, -8.678690162891254e-10,
      4.539966775515038e-08, 7.950407982382663e-08, 9.729803175833495e-08,
      9.767731408673708e-08, 8.243338133032678e-08, 5.565961420026755e-08,
      2.2853486696398705e-08, -1.0109787769837649e-08, -3.7954725034774884e-08,
      -5.678341256062813e-08, -6.455086226302613e-08, -6.119420696681827e-08,
      -4.843194122584312e-08, -2.930032361103525e-08, -7.528851759511799e-09,
      1.3128442867478976e-08, 2.9494500753061646e-08, 3.941472615604129e-08,
      4.19919850872547e-08, 3.7596004166416883e-08, 2.7669662258148548e-08,
      1.4384677449805563e-08, 2.1763515487929014e-10, -1.2477533282258855e-08,
      -2.183203968940918e-08, -2.6708782297279667e-08, -2.6805941264169737e-08,
      -2.2616301230745498e-08, -1.5264133061101535e-08, -6.2586786931052694e-09,
      2.787564441811425e-09, 1.0427072746387529e-08, 1.5590681954745592e-08,
      1.7717918863909292e-08, 1.679231927302801e-08, 1.3286201950015126e-08,
      8.033337970106656e-09, 2.0574969989068013e-09, -3.6110844678321976e-09,
      -8.100748860329348e-09, -1.0820612724489627e-08, -1.152497396671544e-08,
      -1.031580144922481e-08, -7.589494392565226e-09, -3.942331913296342e-09,
      -5.4089834705020375e-11, 3.429286319377238e-09, 5.995134097593254e-09,
      7.3316873693845354e-09, 7.35644939178645e-09, 6.204972214957613e-09,
      4.186043083886222e-09, 1.713999589586118e-09, -7.685961332106952e-10,
      -2.8645627781977627e-09, -4.280637878325592e-09, -4.863211974265341e-09,
      -4.607983190184935e-09, -3.6447654153188917e-09, -2.202515997013698e-09,
      -5.622657832477259e-10, 9.932526887824479e-10, 2.224891691513242e-09,
      2.9706055417310606e-09, 3.163103025539135e-09, 2.8305059898151157e-09,
      2.0817162414838093e-09, 1.0804514308630634e-09, 1.3297082726263259e-11,
      -9.424920758119594e-10, -1.6462780374757086e-09, -2.0125820934285856e-09,
      -2.0188557021873526e-09, -1.7023854463219955e-09, -1.1479813779017002e-09,
      -4.693930242057721e-10, 2.1191513011420818e-10, 7.869618396983693e-10,
      1.1753078132645344e-09, 1.3348532441650663e-09, 1.2644769603410694e-09,
      9.998574167692372e-10, 6.038673023431443e-10, 1.536512196748558e-10,
      -2.731992704772679e-10, -6.110716950149313e-10, -8.155261912878416e-10,
      -8.681335874569732e-10, -7.766493802782448e-10, -5.709918588788087e-10,
      -2.961122097655253e-10, -3.224588012471538e-12, 2.5903033166588696e-10,
      4.520715333270772e-10, 5.524628601094217e-10, 5.540413046688551e-10,
      4.670633070372262e-10, 3.1482237466506665e-10, 1.285465424561038e-10,
      -5.842736673196821e-11, -2.161963672891942e-10, -3.2269669080818474e-10,
      -3.6639005200481214e-10, -3.4698506827973783e-10, -2.7428769335593103e-10,
      -1.6556303023787432e-10, -4.198771213887265e-11, 7.514446820677655e-11,
      1.6783210783744824e-10, 2.2388790529200516e-10, 2.382646523851575e-10,
      2.1310112372219364e-10, 1.566166754783519e-10, 8.115333684875481e-11,
      7.684075991179496e-13, -7.119057362907463e-11, -1.2413973978318958e-10,
      -1.5165348238733686e-10, -1.5204734637356874e-10, -1.281425604503758e-10,
      -8.63367974569601e-11, -3.5203189257073134e-11, 1.610873090120843e-11,
      5.939399002123146e-11, 8.860070058410281e-11, 1.0056657420993868e-10,
      9.521612064521598e-11, 7.524442549660179e-11, 4.5392554787574286e-11,
      1.1473612598551411e-11, -2.0668654214967727e-11, -4.609539269519011e-11,
      -6.146432920695844e-11, -6.539318843741727e-11, -5.84717776740425e-11,
      -4.295817119570387e-11, -2.2241058155989864e-11, -1.7889524757287115e-13,
      1.9565606850594822e-11, 3.4088994786659254e-11, 4.162952966450944e-11,
      4.172682917119365e-11, 3.515692157222929e-11, 2.367695651424427e-11,
      9.640542061109442e-12, -4.441166852832919e-12, -1.6316838047763236e-11,
      -2.4326495913265416e-11, -2.7603456612828995e-11, -2.6128231254176677e-11,
      -2.064154008858156e-11, -1.2445297794305552e-11, -3.135233229512689e-12,
      5.684929696825477e-12, 1.2660171203171646e-11, 1.6873899304567822e-11,
      1.7947553053664763e-11, 1.6043779078969157e-11, 1.1782929151354246e-11,
      6.095418155052419e-12, 4.0317353770172565e-14, -5.377285747211858e-12,
      -9.360892413086484e-12, -1.1427479161396612e-11, -1.1451220041156641e-11,
      -9.645574013951162e-12, -6.493149677119345e-12, -2.640089928756755e-12,
      1.2244010318616531e-12, 4.482588756429556e-12, 6.679157919404151e-12,
      7.576578260414291e-12, 7.169838451167952e-12, 5.662518348068116e-12,
      3.4121283959772925e-12, 8.567047070203789e-13, -1.5636362188186687e-12,
      -3.477132402974034e-12, -4.632416007491333e-12, -4.925811807923037e-12,
      -4.402170574841768e-12, -3.2319188412170326e-12, -1.6705156730381913e-12,
      -8.655405484637062e-15, 1.4778551642548327e-12, 2.5705142014809846e-12,
      3.136889271309784e-12, 3.142591801863016e-12, 2.6463367657351898e-12,
      1.7806745323919914e-12, 7.229925146157812e-13, -3.375524006870899e-13,
      -1.2314624856220024e-12, -1.833849216576458e-12, -2.0796133094653104e-12,
      -1.9674720006316867e-12, -1.5533771237024068e-12, -9.355022606042764e-13,
      -2.3409061766170135e-13, 4.300748823829551e-13, 9.549980135365146e-13,
      1.2717432700926337e-12, 1.3519176008038721e-12, 1.2078885866076117e-12,
      8.864766979958135e-13, 4.578219322353182e-13, 1.7141640707130698e-15,
      -4.0616229099347414e-13, -7.058663140285766e-13, -8.61088435880272e-13,
      -8.624303344923891e-13, -7.260423235174902e-13, -4.883298539133394e-13,
      -1.9799156381736696e-13, 9.305714279238827e-14, 3.3830846983362723e-13,
      5.03506744972543e-13, 5.708104216496458e-13, 5.398928572035091e-13,
      4.261318011020694e-13, 2.5648603310541527e-13, 6.396292897860403e-14,
      -1.1829058549512097e-13, -2.622909460122039e-13, -3.491331899449007e-13,
      -3.710414821026049e-13, -3.314260999588242e-13, -2.431497903164701e-13,
      -1.2547049735458634e-13, -2.889630333698593e-16, 1.1162624041246198e-13,
      1.9383160917142162e-13, 2.363720610465016e-13, 2.366791011567252e-13,
      1.99195058292234e-13, 1.3391881512427878e-13, 5.4219731895923037e-14,
      -2.565365832413759e-14, -9.294027478887021e-14, -1.3824413582647374e-13,
      -1.5667547857869535e-13, -1.4815162997032624e-13, -1.1689898593148346e-13,
      -7.032050840417285e-14, -1.747688719844661e-14, 3.253524173506168e-14,
      7.20383442950382e-14, 9.584790374295374e-14, 1.0183440893180882e-13,
      9.093819976839675e-14, 6.669298744692002e-14, 3.438631429394039e-14,
      2.9498319042679123e-17, -3.067834802168551e-14, -5.322632014735189e-14,
      -6.488500531435274e-14, -6.495246477134804e-14, -5.465060533130705e-14,
      -3.6725651985388073e-14, -1.484792724887381e-14, 7.0719642631527e-15,
      2.553256414078586e-14, 3.795665218392762e-14, 4.3004113266724365e-14,
      4.06541717035247e-14, 3.20684005289849e-14, 1.9279673900612396e-14,
      4.7751954581134455e-15, -8.948611596100195e-15, -1.978535003792421e-14,
      -2.631321388018927e-14, -2.7949012316188907e-14, -2.4952026114941056e-14,
      -1.8293050808991162e-14, -9.423855486619117e-15, 5.573282531413635e-18,
      8.431340310669794e-15, 1.4615981301838364e-14, 1.7811166538074716e-14,
      1.782506810753855e-14, 1.4993781847860657e-14, 1.0071566485902687e-14,
      4.066043979433755e-15, -1.9494946428501292e-15, -7.014299573856394e-15,
      -1.0421466563759352e-14, -1.1803717176886206e-14, -1.115587478622535e-14,
      -8.797182705722296e-15, -5.2858734980376756e-15, -1.3046964308234319e-15,
      2.4612461675299146e-15, 5.434046453141031e-15, 7.223787582814119e-15,
      7.670756915049906e-15, 6.846444585806616e-15, 5.0175511213037025e-15,
      2.5826799115574998e-15, -5.280905972891696e-18, -2.3171825423643083e-15,
      -4.013554940690972e-15, -4.88922700344577e-15, -4.891776393584752e-15,
      -4.1136486274245154e-15, -2.762002873442312e-15, -1.113463739339997e-15,
      5.373971387108381e-16, 1.926963947708977e-15, 2.861340460593842e-15,
      3.239868802446734e-15, 3.0612723997857238e-15, 2.4132909332059438e-15,
      1.4492164166878608e-15, 3.5646670304323906e-16, -6.769432012884827e-16,
      -1.4924594798601672e-15, -1.9831512254233233e-15, -2.1052797472595203e-15,
      -1.8785562155334204e-15, -1.3762494783703442e-15, -7.078015773631657e-16,
      2.4788483983129925e-18, 6.368290403072896e-16, 1.1021231958769134e-15,
      1.3421092097822623e-15, 1.342461479812358e-15, 1.1286076575395482e-15,
      7.574445063366904e-16, 3.049143342816592e-16, -1.481358060097066e-16,
      -5.293735890485332e-16, -7.856154035205663e-16, -8.892745915776973e-16,
      -8.400403584880145e-16, -6.620267033617372e-16, -3.9732795485950393e-16,
      -9.739116447211191e-17, 1.8618607728926997e-16, 4.099032345916646e-16,
      5.444355718036038e-16, 5.778049286935402e-16, 5.154459260612725e-16,
      3.7748719518795623e-16, 1.9397753651071468e-16, -9.62854619783932e-19,
      -1.7501870134929153e-16, -3.026430957959176e-16, -3.6841332448685495e-16,
      -3.684146624360152e-16, -3.096410889428026e-16, -2.0771942194905132e-16,
      -8.349824560357774e-17, 4.083346240169667e-17, 1.4542877763935605e-16,
      2.1570002815567168e-16, 2.440867330526224e-16, 2.3051445175049503e-16,
      1.8161055684768971e-16, 1.0893423665377851e-16, 2.6607934419619974e-17,
      -5.120825487538822e-17, -1.125796092015379e-16, -1.4946411951671114e-16,
      -1.5858149534949588e-16, -1.4143009862291162e-16, -1.0353971776537015e-16,
      -5.3160654820979175e-17, 3.4179359776284335e-19, 4.809999629210703e-17,
      8.31057544367226e-17, 1.0113060821956537e-16, 1.011048097997923e-16,
      8.495207153538089e-17, 5.69643283829953e-17, 2.286517849586605e-17,
      -1.1255477129930346e-17, -3.9951937122900597e-17, -5.92229683922478e-17,
      -6.699652800096797e-17, -6.32551653222057e-17, -4.982031039133724e-17,
      -2.986613760478617e-17, -7.269318482013416e-18, 1.408414740445112e-17,
      3.0919874577836966e-17, 4.1032426296085105e-17, 4.352347996782647e-17,
      3.8806135347647576e-17, 2.839954775215684e-17, 1.456894722541782e-17,
      -1.1508463041697404e-19, -1.3219183160607452e-17, -2.2820813407818096e-17,
      -2.776065616415436e-17, -2.7746394950605576e-17, -2.330714911102036e-17,
      -1.5621705543404378e-17, -6.2613728802285266e-18, 3.102438832443191e-18,
      1.097551062380877e-17, 1.6260350365980508e-17, 1.8389090477636924e-17,
      1.7357759348757528e-17, 1.366694743097973e-17, 8.188288245705903e-18,
      1.985944379291828e-18, -3.8736374361613235e-18, -8.49210404545643e-18,
      -1.1264638085541443e-17, -1.1945231026005863e-17, -1.0647772438038215e-17,
      -7.789607339347012e-18, -3.9926843860914106e-18, 3.74248344025187e-20,
      3.632981541892739e-18, 6.266583661106601e-18, 7.620380426849482e-18,
      7.614495743783156e-18, 6.394463745563669e-18, 4.28403986010561e-18,
      1.714597775693028e-18, -8.551341152504772e-19, -3.0151646575504136e-18,
      -4.464464616872651e-18, -5.0474036073242785e-18, -4.763116032864018e-18,
      -3.749180717823161e-18, -2.244949495742182e-18, -5.425393353706852e-19,
      1.0653816389587466e-18, 2.3323433594549197e-18, 3.092481308140946e-18,
      3.2784255965964705e-18, 2.9215743613547762e-18, 2.1365811989843492e-18,
      1.0942101847472432e-18, -1.1873920684544863e-20, -9.984372134503018e-19,
      -1.720799466566348e-18, -2.091815595453071e-18, -2.0896597117799647e-18,
      -1.754360730932637e-18, -1.1748384385225996e-18, -4.69518436471055e-19,
      2.3569859659073886e-19, 8.283173169036827e-19, 1.2257689892812914e-18,
      1.3854014858902364e-18, 1.3070388312520987e-18, 1.0284921499028377e-18,
      6.15487757549207e-19, 1.4821291936184297e-19, -2.9301461759430106e-19,
      -6.405739346777791e-19, -8.489785522368561e-19, -8.997791956088914e-19,
      -8.01631815342364e-19, -5.860341611284307e-19, -2.9987169972444444e-19,
      3.698631172049576e-21, 2.7439571646860057e-19, 4.725299959839801e-19,
      5.742089510722793e-19, 5.73468844066191e-19, 4.81319502661892e-19,
      3.2218282112276355e-19, 1.2857032464753714e-19, -6.496382531332823e-20,
      -2.2755262859654163e-19, -3.365484799065278e-19, -3.802621467415303e-19,
      -3.5866223455890636e-19, -2.8214044249219644e-19, -1.6874528716990551e-19,
      -4.048848128536758e-20, 8.05881553030013e-20, 1.7593232325369086e-19,
      2.330698784599113e-19, 2.469485042662528e-19, 2.1995445493837253e-19,
      1.6074081146712266e-19, 8.218057279963105e-20, -1.135796001724685e-21,
      -7.541068708286611e-20, -1.2975622487879665e-19, -1.5762182005635101e-19,
      -1.5737796438074603e-19, -1.3205286077001368e-19, -8.835399681559246e-20,
      -3.520679702407667e-20, 1.7905154888640196e-20, 6.251243017098956e-20,
      9.240306897160078e-20, 1.0437353037024321e-19, 9.84198366687329e-20,
      7.739795041628592e-20, 4.6264010122555076e-20, 1.1060313037663972e-20,
      -2.216414596183948e-20, -4.831940869486681e-20, -6.398458774835364e-20,
      -6.777611796681946e-20, -6.035182349054539e-20, -4.4088880706175474e-20,
      -2.2521732599140805e-20, 3.4484559270930885e-22, 2.0724662810601385e-20,
      3.563089411740578e-20, 4.326757308259861e-20, 4.318946815071696e-20,
      3.622946843693106e-20, 2.422978761499336e-20, 9.640731057827338e-21,
      -4.9348793865260616e-21, -1.71731640778904e-20, -2.5370259947649815e-20,
      -2.8648209409487905e-20, -2.700719377446155e-20, -2.123211864379933e-20,
      -1.268394305090828e-20, -3.0212994344806002e-21, 6.0957711775695346e-21,
      1.3270802420296693e-20, 1.756565700473629e-20, 1.8601450771992128e-20,
      1.6559523931363398e-20, 1.2092934019040446e-20, 6.172106052488604e-21,
      -1.0373397438300535e-22, -5.695620662393477e-21, -9.784191394500978e-21,
      -1.1877049105665966e-20, -1.1852545343823302e-20, -9.939760106909094e-21,
      -6.644657512206191e-21, -2.639921931543882e-21, 1.360088093529851e-21,
      4.7177363693682654e-21, 6.965674845275863e-21, 7.863292357141549e-21,
      7.410988022659798e-21, 5.8244773297286364e-21, 3.4774803010809726e-21,
      8.252973458668759e-22, -1.676502431113221e-21, -3.6447886945118136e-21,
      -4.82228880091886e-21, -5.1052472692931316e-21, -4.543652554499436e-21,
      -3.3169122759751196e-21, -1.6914684705514132e-21, 3.096472215466941e-23,
      1.5652858205936737e-21, 2.686722788695168e-21, 3.2602761466294024e-21,
      3.252709153500174e-21, 2.7270282484173904e-21, 1.8221963823165714e-21,
      7.228860678431101e-22, -3.7484320099575797e-22, -1.2960341082508131e-21,
      -1.9124990949072346e-21, -2.1582969394047343e-21, -2.033633056348834e-21,
      -1.597792361753339e-21, -9.53398486815705e-22, -2.254329347489558e-22,
      4.6108140168972885e-22, 1.0010300793721536e-21, 1.3238592980617498e-21,
      1.4011562987729937e-21, 1.2467006838432756e-21, 9.097791512439442e-22,
      4.635465744205242e-22, -9.182969161506707e-24, -4.301750905795348e-22,
      -7.37769129643775e-22, -8.949526109355703e-22, -8.926447913165948e-22,
      -7.481749496821968e-22, -4.997091990531892e-22, -1.9794578994091103e-22,
      1.0330572888997262e-22, 3.560398492383007e-22, 5.250963971163315e-22,
      5.92403748831289e-22, 5.58044592623404e-22, 4.383121167370711e-22,
      2.6138678167203446e-22, 6.157641863301784e-23, -1.268086609792384e-22,
      -2.74929600266264e-22, -3.634379213664144e-22, -3.8455301663735798e-22,
      -3.420732371511328e-22, -2.495385611024104e-22, -1.2703452974466296e-22,
      2.708172949676844e-24, 1.1822134137243065e-22, 2.0258990481397418e-22,
      2.456662580121129e-22, 2.4496946596619234e-22, 2.0526574606832045e-22,
      1.37037394599222e-22, 5.420262468810486e-23, -2.8470258425332e-23,
      -9.78093114303357e-23, -1.4417056437104925e-22, -1.626013821525865e-22,
      -1.531316796215052e-22, -1.2023927984396168e-22, -7.166253500793044e-23,
      -1.681905297981378e-23, 3.487531446438356e-23, 7.55084360531103e-23,
      9.977424405320982e-23, 1.055420921538351e-22, 9.385897640462438e-23,
      6.844457707138867e-23, 3.4813615505007575e-23, -7.948266232101184e-25,
      -3.2489686843865185e-23, -5.56307382165101e-23, -6.743584450380091e-23,
      -6.722720762480587e-23, -5.631571384288801e-23, -3.7580315826612e-23,
      -1.484198497553678e-23, 7.846043496664928e-24, 2.686960063291945e-23,
      3.9583475085857265e-23, 4.4630371216581686e-23, 4.202048088451793e-23,
      3.2984432037120495e-23, 1.964717408523315e-23, 4.5938690047423184e-24,
      -9.591471932330381e-24, -2.0738104172750627e-23, -2.7390909209170745e-23,
      -2.89664326159045e-23, -2.5753267915024362e-23, -1.8773278075800273e-23,
      -9.540593798129214e-24, 2.3229245589479927e-25, 8.92882250150193e-24,
      1.527606675198196e-23, 1.851125694450666e-23, 1.8449220721853636e-23,
      1.545049853458931e-23, 1.0305791249597881e-23, 4.064070844035197e-24,
      -2.162232428798003e-24, -7.381449273162593e-24, -1.0868034277179928e-23,
      -1.2250014335494122e-23, -1.1530730464799668e-23, -9.048392016472759e-24,
      -5.386509116698713e-24, -1.2547162855172416e-24, 2.637851296577107e-24,
      5.695636059209818e-24, 7.519591481271561e-24, 7.949945723978338e-24,
      7.066245050357795e-24, 5.149213185418005e-24, 2.614572040466064e-24,
      -6.763656634707787e-26, -2.453815345188353e-24, -4.19476826689612e-24,
      -5.081370199095954e-24, -5.0630336946792286e-24, -4.238919733635989e-24,
      -2.826193150551543e-24, -1.1128282783171172e-24, 5.9586306686393105e-25,
      2.02778304196059e-24, 2.983924571502769e-24, 3.362346961008411e-24,
      3.1641164082468617e-24, 2.4821816400878567e-24, 1.4767741563252168e-24,
      3.426906256321699e-25, -7.254596942972991e-25, -1.564281874992877e-24,
      -2.064342922158425e-24, -2.1818915080542557e-24, -1.9388528913228846e-24,
      -1.4123467099226326e-24, -7.16514108630906e-25, 1.9628738869667917e-26,
      6.74355017767043e-25, 1.1518716854128536e-24, 1.394843818708762e-24,
      1.3894516712156242e-24, 1.162967774995147e-24, 7.750360783554283e-25,
      3.047141530083604e-25, -1.6420374077838424e-25, -5.5705843459340275e-25,
      -8.192650774596736e-25, -9.228864876119895e-25, -8.682562443619634e-25,
      -6.809190166481366e-25, -4.0487423923247536e-25, -9.359412231757086e-26,
      1.9951438150193632e-25, 4.29622877328637e-25, 5.667209070909281e-25,
      5.988278329595903e-25, 5.319867785675636e-25, 3.873838066820464e-25,
      1.9635763998673984e-25, -5.6796242119469136e-27, -1.8532514057974e-25,
      -3.1630054084485693e-25, -3.8288658192867194e-25, -3.813079939468725e-25,
      -3.190655833443664e-25, -2.1254044276642557e-25, -8.343623113817231e-26,
      4.5249332324816654e-26, 1.5303100961373904e-25, 2.2493695187584454e-25,
      2.53310901217005e-25, 2.382556497908048e-25, 1.8679150474131599e-25,
      1.1100066539555752e-25, 2.5561391323227714e-26, -5.486976131396741e-26,
      -1.1799385489743736e-25, -1.5558095160481771e-25, -1.6435035285553775e-25,
      -1.4596765635600387e-25, -1.0625302227979098e-25, -5.381084123569629e-26,
      1.639050010219217e-27, 5.093063785031799e-26, 8.685512892341905e-26,
      1.0510285920874233e-25, 1.046425252746214e-25, 8.75370752724698e-26,
      5.828553979426608e-26, 2.284621706171395e-26, -1.2469065728181458e-26,
      -4.203950127101493e-26, -6.175852710917038e-26, -6.952793076098454e-26,
      -6.537900856529364e-26, -5.1241110224913874e-26, -3.043199289762608e-26,
      -6.980874993470579e-27, 1.5090022644422102e-26, 3.2406414703373853e-26,
      4.271136088583544e-26, 4.510650120569485e-26, 4.0050896980373036e-26,
      2.914343984271342e-26, 1.4746558454162895e-26, -4.7186820479621175e-28,
      -1.3996612110406997e-26, -2.3850127629806243e-26, -2.885085801204485e-26,
      -2.871708475922218e-26, -2.4016178085291474e-26, -1.5983785575700537e-26,
      -6.255636077634004e-27, 3.4359617715831115e-27, 1.154875293940676e-26,
      1.6956367298698677e-26
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-14), expected));
  }
}

TEST(signal_generated, cheby2_highpass_48_40_1000_rs_80_0_double) {
  constexpr auto base_design = iirfilter<double>(1000).highpass(chebyshev2<48>(80.0), 40);

  { // DF2T-based SOS
    constexpr auto design = base_design.sos<double>();

    static_assert(design.order() == 48, "order");

    auto filter = design.instance();
    auto impulse = impulse_response(filter, 1024);

    static constexpr std::array<double, 1024> expected{{
      0.45023182008471935, -0.7109126965976428, -0.1269906377870424, 0.13988578231296414,
      0.21141611709044808, 0.1767874881668069, 0.09778587634172077, 0.013955556306238525,
      -0.05244986323389457, -0.09192418327875707, -0.10371460049005816,
      -0.09246281922439996, -0.06551653871632701, -0.030902829055799632,
      0.004080617901216907, 0.03372702652502042, 0.05432322382598388, 0.06419101744276955,
      0.06346634690994932, 0.0537103680394416, 0.037436638135950016, 0.01762499288821373,
      -0.002722977126056282, -0.02094834810154268, -0.03499659324469922,
      -0.04356845541484197, -0.04616398602594283, -0.0430332509210226,
      -0.035053746260501714, -0.023558190771545882, -0.010137283189284467,
      0.0035593867152346496, 0.01600431893691777, 0.025939536685909564,
      0.032480263618435735, 0.03517004206963824, 0.033987594974021276, 0.029310151867233743,
      0.0218414084112289, 0.012514601985487435, 0.0023823077280658196,
      -0.007495462878811441, -0.016154311519093252, -0.022810944653775506,
      -0.02692481229253404, -0.028232315356906262, -0.026752765508745894,
      -0.02276785366927058, -0.016778568761266124, -0.009445160247989465,
      -0.0015167678425252067, 0.006242280890785691, 0.013122753996649299,
      0.018531431328858237, 0.022037948596267606, 0.023404409995614953, 0.02259630652724047,
      0.019774972730690135, 0.015273370065663788, 0.009558283098771127,
      0.0031829672081669104, -0.00326515991408935, -0.00921705381300071,
      -0.014170339625009198, -0.01772951790086393, -0.019635122845044636,
      -0.019779959452428678, -0.018211719471202786, -0.01512243933500472,
      -0.01082632311794389, -0.005728331015014935, -0.0002865689042607922,
      0.005028130006248523, 0.009771977566290477, 0.01356412206072179, 0.01611589163520926,
      0.017251289936480202, 0.016917447057617267, 0.015184597136533966,
      0.012236015621683128, 0.008349136572988337, 0.003869724907289656,
      -0.0008185450136425922, -0.005326483782515802, -0.009291083254970562,
      -0.01240400624073714, -0.014434714416361514, -0.015246587563028477,
      -0.014805004120037362, -0.013177025940207863, -0.010523004404409567,
      -0.0070810483134770286, -0.0031458199918275006, 0.0009564820182920248,
      0.004894862436039765, 0.008359837692280334, 0.01108726731720256, 0.01287792391491173,
      0.013611407720202928, 0.0132534960663247, 0.011856555893708882, 0.009553195625206842,
      0.006543849050966584, 0.003079429994960168, -0.0005594591332848424,
      -0.004085062037454912, -0.007224960977070092, -0.009742797671035485,
      -0.011455679670913552, -0.012247027260326504, -0.01207399961847169,
      -0.010969076594495517, -0.009035829246196992, -0.006439353247353355,
      -0.003392231613359616, -0.0001372088580200415, 0.0030720237870182233,
      0.005990426545311575, 0.008400097518947101, 0.010126274823072259,
      0.011049704332915461, 0.011114525781434877, 0.010331188316643052,
      0.008774292253056558, 0.006575637129736285, 0.00391310881198145,
      0.0009963348128206669, -0.00194974330406368, -0.004702102970679657,
      -0.007056371310706414, -0.008841813374701439, -0.009933496021840486,
      -0.010260780325192481, -0.00981158743921293, -0.008632209233746512,
      -0.00682277073771502, -0.004528771553614703, -0.001929414676353029,
      0.0007763462229261767, 0.003384961018613089, 0.005703492767175629,
      0.0075637564663266176, 0.008834362899570479, 0.009429818883312676,
      0.009316069204411696, 0.008512139691464693, 0.007087834259246754,
      0.005157729529223248, 0.0028719775693901604, 0.00040465143015039394,
      -0.0020594659694556016, -0.004338652302481783, -0.0062675563323071025,
      -0.007709081935683927, -0.008564001368257107, -0.008777634859990044,
      -0.008343159770782448, -0.007301366140273493, -0.005736937586201106,
      -0.0037715879690702484, -0.0015546070326007823, 0.0007484532311510038,
      0.0029680975299116, 0.00494329945296772, 0.006533103778483736, 0.007626589956821852,
      0.008150500603909077, 0.008074019589147788, 0.007410399111912453,
      0.006215367933933542, 0.00458248658621242, 0.002635833067008206,
      0.0005205889159996067, -0.0016077622574350722, -0.0035948231414799628,
      -0.005298427813135681, -0.006598744014670133, -0.0074066206388410435,
      -0.007669605696422301, -0.007375236307463773, -0.006551404269592109,
      -0.0052638136278059565, -0.003610754995155225, -0.0017156103333511108,
      0.0002823416904969521, 0.0022381364449236083, 0.004011604222711162,
      0.005477366950960484, 0.00653364200829627, 0.007109239935362403, 0.007168280632339219,
      0.006712322283868928, 0.005779786173842201, 0.004442755016383013,
      0.0028014085244919933, 0.0009765245654400762, -0.000899393959806955,
      -0.0026917162945879532, -0.004273312244219343, -0.005533526221448717,
      -0.006385867079466325, -0.006773883571375669, -0.006674831166292404,
      -0.006100897913712277, -0.0050979332444189805, -0.0037418013608871725,
      -0.0021326476099557757, -0.0003875103137443099, 0.0013681779035929294,
      0.0030095836448180715, 0.004421318321699719, 0.005505511598642708,
      0.006188550947411269, 0.006426026838779081, 0.006205555548431606,
      0.005547305432997268, 0.00450221671606054, 0.003148067619020997, 0.001583689639862734,
      -7.823845763979412e-05, -0.0017192934431336316, -0.0032237258509433763,
      -0.00448659702122365, -0.005421065193927613, -0.005964317473400337,
      -0.006081745592230132, -0.005769091522221604, -0.0050524347851543545,
      -0.003986046364427587, -0.0026482835949656206, -0.001135835884488779,
      0.0004432567225406106, 0.0019773088551644146, 0.003358870646290464,
      0.004492229576913014, 0.005300011559160045, 0.005728428346568767,
      0.005750818114833165, 0.005369249368925357, 0.0046140963140776665,
      0.0035416366733835762, 0.0022298606167508775, 0.0007728024371456249,
      -0.0007261935384097957, -0.0021617912825295663, -0.00343404845368511,
      -0.0044553524298620445, -0.005156427365075862, -0.005491002453345556,
      -0.005438829193991635, -0.005006853759206656, -0.004228481109216404,
      -0.003161001066756126, -0.001881373829721082, -0.0004806845896575082,
      0.0009423335995424216, 0.0022882487657759167, 0.0034638626451290984,
      0.00438864487506551, 0.005000226081614289, 0.005258576967157834, 0.005148595460802135,
      0.004680937274662589, 0.003891048770432455, 0.002836486209019228,
      0.0015927235406154327, 0.0002477537847658958, -0.00110413022148349,
      -0.0023689367286217856, -0.0034594963849187517, -0.004301452594686617,
      -0.004838310610165543, -0.005035204086237777, -0.00488112981744372,
      -0.004389509725725849, -0.0035970562240070056, -0.0025610346703560096,
      -0.0013551266210707579, -6.419246553946898e-05, 0.001221694623065108,
      0.0024135245148051124, 0.0034294992153572445, 0.004200631404998698,
      0.0046754104333344695, 0.004823221579061853, 0.004636293235478166,
      0.004130050261489236, 0.0033418627676548573, 0.0023282903673828652,
      0.0011610247874003737, -7.817831186266496e-05, -0.0013032203246953246,
      -0.0024296336406622572, -0.003380394710848971, -0.004091177055496151,
      -0.004514687015203267, -0.004623791243201114, -0.004413230570144871,
      -0.0038998138836732338, -0.0031210911276763277, -0.002132609136246755,
      -0.0010039505953605248, 0.00018616159109695394, 0.001355350366585611,
      0.002423279134679983, 0.003317161862274349, 0.003976711524339489,
      0.0043581914043615355, 0.004437298101544428, 0.004210687498718047,
      0.003696049608013815, 0.002930738539939282, 0.001969062910255264,
      0.0008784330294723635, -0.00026536195730855457, -0.0013834163399934981,
      -0.0023991445340506316, -0.0032435181381179293, -0.0038597459320751496,
      -0.004207080357532665, -0.004263496327267407, -0.004027067411711107,
      -0.0035159549921015007, -0.0027670215656608495, -0.0018331734596184067,
      -0.000779624338555233, 0.00032065674988689694, 0.0013919952869312832,
      0.0023612100148420368, 0.0031626038280727197, 0.0037424070690933427,
      0.0040623734632951065, 0.00410228908405782, 0.003861230797243734,
      0.0033574972769914897, 0.0026272269153752754, 0.001721806506077716,
      0.0007042563696896234, -0.0003551539129927765, -0.0013837543520291403,
      -0.002311453707676793, -0.003075508232534892, -0.0036247561037567886,
      -0.003923032442297405, -0.003951537752280392, -0.0037100056034048163,
      -0.0032165983367922046, -0.002506546774393361, -0.0016296353839502942,
      -0.0006467122889204939, 0.00037453133370281895, 0.0013642198946147216,
      0.0022550697342515664, 0.0029869570665759385, 0.00351096789852274,
      0.0037926577219641704, 0.0038143044491408757, 0.0035760080685129044,
      0.0030955699717776855, 0.0024071683730083194, 0.0015589280051185835,
      0.0006095567928319956, -0.00037571554597167037, -0.0013296161686765329,
      -0.002187417794245551, -0.0028913247636776305, -0.003394359713626593,
      -0.0036634900304986055, -0.0036817866454760613, -0.0034494748416622903,
      -0.0029838129218926505, -0.002317814596957392, -0.0014979093436023618,
      -0.0005807064431097918, 0.0003709118546180124, 0.0012920985597883205,
      0.0021204566210624013, 0.002800259822623526, 0.003286194775341324,
      0.0035463732142634397, 0.003564414923922025, 0.003340465917254316,
      0.0028910895469881496, 0.002248045022035257, 0.0014560431088813538,
      0.0005696375288308267, -0.0003505318939616963, -0.0012418857429342552,
      -0.00204415783940857, -0.002703465651138737, -0.0031759237169861803,
      -0.003430558198509596, -0.003451329502991968, -0.003238131506908398,
      -0.002806705994520196, -0.0021874847171416546, -0.001423443960077704,
      -0.0005671227835171954, 0.0003229882603166159, 0.0011864398311263883,
      0.0019649255576364155, 0.002606214779993789, 0.003067651341424656,
      0.0033189844487599533, 0.003344344195880539, 0.003143233291695577,
      0.002730473794799136, 0.0021351186352251334, 0.0013984075831415682,
      0.000570911393439387, -0.0002909381750784675, -0.0011286944768389348,
      -0.001885856267000547, -0.0025116740464810362, -0.0029645463388786757,
      -0.003214778973721041, -0.0032465247869926115, -0.0030587775386679535,
      -0.0026653584104284174, -0.0020939017803670193, -0.0013839144441145446,
      -0.0005840445191746436, 0.0002512512203503734, 0.0010654133598567027,
      0.0018036071411624717, 0.002416412252571491, 0.0028631270896520523,
      0.0031144668819959214, 0.0031544772041745715, 0.0029815382915831627,
      0.0026083975626230074, 0.0020612335849839332, 0.0013778199589025097,
      0.0006049178348666119, -0.00020492298958365858, -0.000996935635233943,
      -0.0017178377489073255, -0.0023194131438424317, -0.0027617329454562144,
      -0.0030158013330976027, -0.003065450903915031, -0.0029083641678652908,
      -0.0025561571826153823, -0.002033524804719158, -0.0013765101770720294,
      -0.0006300196473440643, 0.00015524559497642114, 0.0009262315838667225,
      0.001631113782428703, 0.0022227777232964314, 0.002661964530942571,
      0.002919871581666279, 0.0029800363326132236, 0.0028393804760498556,
      0.0025083486842204534, 0.0020101374213358954, 0.0013790704771401143,
      0.0006582349114989698, -0.00010345981636226823, -0.0008545988793290829,
      -0.0015447304237202757, -0.002127751406996708, -0.0025649839067353832,
      -0.0028277368721647124, -0.0028991839334232103, -0.0027754347072001676,
      -0.0024657318362808693, -0.0019917650532133933, -0.0013861528786228243,
      -0.0006901981706185928, 4.892807745584377e-05, 0.0007813827301062519,
      0.0014580098487762504, 0.00203363709924267, 0.0024700883482687104,
      0.0027387117564823243, 0.00282225621462087, 0.002715973543923468,
      0.0024278764408637134, 0.0019781391251830318, 0.0013976852050481528,
      0.0007260615430708232, 8.744271869969174e-06, -0.0007059395699650808,
      -0.001370066479228619, -0.0019393279618004709, -0.002375983985345964,
      -0.002651361738703146, -0.002747734489237626, -0.0026594576994736713,
      -0.002393289945828899, -0.001967881159222633, -0.0014124665740190365,
      -0.0007648577825492737, -6.886891263768583e-05, 0.0006286469131403806,
      0.001280950452869466, 0.0018445464905068908, 0.0022820817605937603,
      0.0025648177470337227, 0.0026745148639355076, 0.0026046047345136816,
      0.00236057554097529, 0.0019595484543040564, 0.0014290773952245904,
      0.0008052561914746786, 0.00013026312808792133, -0.0005504901058825387,
      -0.0011914124189902407, -0.0017497849736821456, -0.0021886063581066607,
      -0.0024790419354366678, -0.0026023154223742424, -0.002550918832511643,
      -0.0023290630991130183, -0.0019523428383076938, -0.0014466413841120222,
      -0.0008463528931176526, -0.00019204360278755336, 0.00047228876673063,
      0.0011021723763667219, 0.0016556367013280926, 0.002096007075683407,
      0.0023943324236365437, 0.002531285645557995, 0.002498412122270415,
      0.0022986459430489993, 0.0019460627632860556, 0.0014648893390759633,
      0.0008878393438577284, 0.00025388974506187286, -0.0003943511528105069,
      -0.0010135063291390031, -0.0015623310888024777, -0.002004458611750357,
      -0.00231080738233531, -0.0024614912932164673, -0.002447107158608093,
      -0.002269316513123835, -0.0019406860639551418, -0.0014838008109599578,
      -0.0009297123283945269, -0.00031582878439660646, 0.000316609960320137,
      0.0009253018028933476, 0.0014697104883015185, 0.0019137633660332041,
      0.00222823939739514, 0.0023926894777113357, 0.002396763052912948,
      0.002240855183007785, 0.0019360339181867588, 0.0015032560329169746,
      0.0009719265854573377, 0.00037790127671017196, -0.00023893270900884992,
      -0.000837334203368953, -0.0013774642237914614, -0.0018235367037233892,
      -0.0021461875256293477, -0.002324405163203958, -0.0023468961581782142,
      -0.002212796889325284, -0.00193168705126797, -0.0015229069932818405,
      -0.0010142274473131237, -0.0004399631117576202, 0.00016134179142987613,
      0.0007494999167854601, 0.0012853656524731887, 0.0017334391384797934,
      0.002064216321820797, 0.002256129599518623, 0.002296951548849396,
      0.002184570559704521, 0.0019270894102497008, 0.0015422431264475948,
      0.0010561778088501996, 0.0005016744776488117, -8.406142768760676e-05,
      -0.0006618958641656082, -0.0011933799376921273, -0.0016433070862192937,
      -0.001982043706329713, -0.0021874790481482744, -0.002246466206856612,
      -0.002155660458320146, -0.0019217016940877294, -0.001560731585336082,
      -0.0010972804124674137, -0.0005626002875967146, 7.441997807062302e-06,
      0.0005747704533548597, 0.0011016424103405635, 0.0015531583646697827,
      0.001899572318919444, 0.002118249777635128, 0.0021951446321428238,
      0.0021256987128499493, 0.0019151065877077644, 0.0015779306382444594,
      0.0011370947110689498, 0.0006223258430646147, 6.814996267813663e-05,
      -0.0004884233214621525, -0.0010103716303910023, -0.0014631215087635146,
      -0.0018168372912316685, -0.0020483857011782134, -0.0021428469268521457,
      -0.002094473601372911, -0.0019070362156971363, -0.0015935345247112295,
      -0.0011752967231444353, -0.0006805287600948378, -0.0001424124387561457,
      0.00040311948027479754, 0.0009197820239185934, 0.0013733505173984756,
      0.001733926523961983, 0.0019779072734163973, 0.002089528952046752,
      0.0020618830642294946, 0.0018973404878497879, 0.0016073574522597895,
      0.0012116788213555512, 0.0007369940262994959, 0.00021513711412459488,
      -0.0003190477222549188, -0.0008300320492564985, -0.001283965320938492,
      -0.0016509162437978323, -0.0019068450459373315, -0.0020351767841218743,
      -0.002027872832647066, -0.0018859314249632685, -0.0016192862964111024,
      -0.0012461125521719147, -0.0007915881912649347, -0.00028619564994790023,
      0.00023632208423430336, 0.0007412137726710799, 0.0011950303440340622,
      0.0015678398797827513, 0.0018352005621012862, 0.0019797616242595026,
      0.001992387542751936, 0.0018727327580344917, 0.0016292309525488533,
      0.001278501894829527, 0.0008442174823336404, 0.0003555043230253688,
      -0.00015500936958436106, -0.0006533716282509567, -0.0011065640023797136,
      -0.0014846882251331385, -0.0017629375289336677, -0.0019232227117581462,
      -0.0019553464613201797, -0.0018576498167649468, -0.0016370899462555878,
      -0.0013087462839500674, -0.0008947899809552704, -0.0004229870686739175,
      7.516362999102755e-05, 0.0005665329873187793, 0.0010185641520271897,
      0.0014014288330060404, 0.0016899945311692356, 0.0018654730495675754,
      0.0019166422385500442, 0.0018405616345645714, 0.0016427364982575564,
      0.001336721486804202, 0.0009431923619199023, 0.0004885492746114477,
      3.145960383308603e-06, -0.0004807363985131711, -0.0009310354269438175,
      -0.0013180312714489934, -0.0016163071604743196, -0.0018064175422889436,
      -0.0018761543982324933, -0.0018213293640633695, -0.0016460216782642773,
      -0.0013622775474757365, -0.0009892829076771558, -0.000552066352448394,
      -7.981989891597623e-05, 0.00039604976305878563, 0.0008440094729094018,
      0.001234488446121036, 0.0015418294423770588, 0.0017459735713021907,
      0.001833768174357571, 0.0017998125941132948, 0.0016467875575219555,
      0.0013852482901308603, 0.0010328970536468852, 0.0006133852006234993,
      0.00015472579487112837, -0.0003125766809847727, -0.0007575546833574853,
      -0.0011508291897180235, -0.0014665486313828668, -0.0016840872671955854,
      -0.0017893914860801126, -0.0017758862413926337, -0.0016448832549990618,
      -0.0014054658147218924, -0.0010738597153399242, -0.0006723338573558863,
      -0.00022770497522902288, 0.00023045311884341063, 0.0006717762133674283,
      0.0010671215410364395, 0.001390491526612685, 0.001620742499297881,
      0.0017429661232179325, 0.0017494533625476072, 0.001640178743105437,
      0.0014227746296449782, 0.0011119990790451986, 0.0007287343091856517,
      0.00029858372892860346, -0.00014983822764460053, -0.0005868092513657334,
      -0.0009834687389463606, -0.0013137233226388591, -0.0015559625796591151,
      -0.0016944721635503996, -0.0017204520175192783, -0.0016325737769344762,
      -0.0014370421738507924, -0.0011471581749781575, -0.0007824145317593888,
      -0.0003671852192568309, 7.090313829082222e-05, 0.0005028090571031986,
      0.0009000009673198624, 0.001236341433617764, 0.0014898064294427812,
      0.0016439266239021166, 0.001688856421842667, 0.0016220014394633592,
      0.0014481645291087664, 0.0011792024263848808, 0.0008332174593997709,
      0.0004333393937208588, 6.179369952021555e-06, -0.00041994073867192776,
      -0.0008168657552086707, -0.001158466989685657, -0.0014223615795765352,
      -0.0015913782882888232, -0.001654673825625864, -0.0016084271850913196,
      -0.0014560676283410525, -0.0012080229114984902, -0.0008810060859468481,
      -0.0004968896185897726, -8.124265968748498e-05, 0.00033837073628592654,
      0.0007342191925719122, 0.001080236246273035, 0.0013537362147362979,
      0.0015369007843823376, 0.0016179389570483776, 0.00159184490522606,
      0.001460705107161289, 0.0012335360670999286, 0.0009256649873570125,
      0.0005576958925442885, 0.0001541309261327226, -0.00025826094093640123,
      -0.0006522192003510396, -0.0010017933835497362, -0.0012840518949783998,
      -0.0014805856136545473, -0.0015787077203622843, -0.0015722716079838973,
      -0.0014620542180123928, -0.0012556810168320763, -0.000967099163295491,
      -0.0006156352169461564, -0.00022470102931315808, 0.00017976554320572508,
      0.0005710212694703002, 0.0009232853977774078, 0.0012134378988416432,
      0.0014225362655394941, 0.0015370514024512802, 0.0015497420230564237,
      0.0014601111077539694, 0.0012744157505779363, 0.0010052312911074646,
      0.0006706000334444116, 0.00029282215683134737, -0.00010303017125389485,
      -0.0004907764891781336, -0.0008448591661610043, -0.0011420275174402338,
      -0.001362863967894615, -0.0014930521275538958, -0.001524304015087514,
      -0.0014548864364902498, -0.0012897131748014564, -0.001039998401505081,
      -0.0007224956773429227, -0.00035837415913266436, 2.8192621255774083e-05,
      0.0004116313433044197, 0.00076666035933613, 0.0010699561789865866,
      0.0013016851575736634, 0.0014467998371356632, 0.0014960152551438863,
      0.001446401931216399, 0.001301557736493821, 0.0010713487483910446,
      0.0007712376474088748, 0.00042124534462658546, 4.461555421335231e-05,
      -0.00033372862834289577, -0.0006888336737155046, -0.000997361017195401,
      -0.0012391204407780178, -0.001398390727344707, -0.0014649412435351011,
      -0.0014346881182846281, -0.0013099429980375408, -0.001099239359769604,
      -0.0008167492602048199, -0.0004813303521433831, -0.0001152672334795182,
      0.00025720887657043845, 0.0006115238148391366, 0.0009243813902847184,
      0.0011752946483572877, 0.001347926864782955, 0.0014311545309075996,
      0.0014197832116191154, 0.0013148702669303887, 0.0011236344912693504,
      0.0008589600128646259, 0.0005385285070586407, 0.00018363815389837185,
      -0.00018221178615695423, -0.0005348767275644517, -0.0008511598665632517,
      -0.0011103375466134378, -0.00129551660706158, -0.0013947348472730095,
      -0.0014017329619670593, -0.001316348188380802, -0.001144504994566905,
      -0.000897804766976044, -0.00059274286512812, -0.0002496058627682318,
      0.00010887731549333115, 0.00045904068925083124, 0.0007778432729619723,
      0.0010443848018295647, 0.0012412754491294162, 0.001355769801810705,
      0.0013805911882000487, 0.0013143930927567383, 0.0011618284723629631,
      0.0009332237091676523, 0.0006438799833363571, 0.00031304930942454017,
      -3.734625286183965e-05, -0.000384167018632097, -0.0007045835155234144,
      -0.0009775788804586721, -0.001185326967760902, -0.0013143558337931204,
      -0.0013564206955505723, -0.001309029842104505, -0.001175590015750107,
      -0.0009651629450762407, -0.0006918503410126803, -0.0003738490704134151,
      -3.2239797481531266e-05, 0.0003104102795119272, 0.0006315379972660934,
      0.0009100696674855008, 0.0011278036165775192, 0.0012705991508569078,
      0.0013292943152938233, 0.0013002929226472685, 0.0011857832963321144,
      0.0009935755358329483, 0.0007365692661875037, 0.00043188811491977157,
      9.973897560936086e-05, -0.0002379279604941376, -0.000558869561256528,
      -0.000842014682787297, -0.001068847211193724, -0.001224616463667475,
      -0.0012992958554221702, -0.0012882275650814164, -0.001192411799036586,
      -0.0010184227784356436, -0.0007779581941469625, -0.00048705297151637253,
      -0.00016501017424619212, 0.00016687968442363987, 0.0004867459662594611,
      0.0007735788574599254, 0.0010086090243529413, 0.0011765354002060823,
      0.001266520816180465, 0.0012728907258267317, 0.0011954900175875,
      0.0010396755506488315, 0.0008159460871698353, 0.0005392351425197341,
      0.0002279143664902166, -9.742604483710526e-05, -0.0004153389565590299,
      -0.0007049338936499515, -0.0009472494763054525, -0.0011264945484726024,
      -0.0012310767865410868, -0.001254351818002856, -0.0011950444808406073,
      -0.0010573155757332578, -0.0008504708660117995, -0.0005883326199864862,
      -0.00028831611823953854, 2.9727185852600625e-05, 0.0003448230182930832,
      0.0006362572717790789, 0.0008849374531431487, 0.00107464312819007,
      0.001193083490884191, 0.0012326931325624807, 0.0011911145255634862,
      0.0010713365029719998, 0.0008814807356546792, 0.0006342513791591605,
      0.00034608516135814927, 3.6058757510856585e-05, -0.00027537392611909703,
      -0.0005677309904811112, -0.0008218493157283996, -0.0010211403286217832,
      -0.0011526724960871466, -0.0012080099330011446, -0.001183752773878472,
      -0.001081744739930209, -0.0009089353230437944, -0.0006769067538341274,
      -0.00040109792437140917, -9.977725354297297e-05, 0.00020716718127320908,
      0.0004995401308831029, 0.0007581676766179284, 0.0009661543717676231,
      0.0011099866173425873, 0.0011804102394219378, 0.0011730253082898566,
      0.001088560007462644, 0.0009328065780535946, 0.0007162246282897913,
      0.0004532389427387083, 0.0001612789166491609, -0.00014037642999193697,
      -0.0004318713322451553, -0.0006940800252742767, -0.0009098613702276249,
      -0.0010651790774155437, -0.0011500143394060371, -0.001159011562823763,
      -0.0010918156164997676, -0.0009530794177344913, -0.0007521424084110341,
      -0.0005024020964141949, -0.00022042093480386152, 7.517193407348893e-05,
      0.00036491125437931144, 0.0006297772763404358, 0.0008524440497101262,
      0.001018412480728697, 0.0011169540752661302, 0.001141803965555513,
      0.001091558485950625, 0.0009697521165361392, 0.0007846097583025019,
      0.0005484916457379095, 0.0002770683394219413, -1.1719146399906684e-05,
      -0.0002988450870516778, -0.0005654523050138948, -0.0007940904003681425,
      -0.0009698576629978528, -0.001081371961611101, -0.0011215073767847673,
      -0.0010878489340496022, -0.0009828364613591626, -0.0008135891070196442,
      -0.0005914230561336075, -0.0003310950948386094, -4.98225740811588e-05,
      0.00023385515033571424, 0.0005012985202527436, 0.0007349923114360395,
      0.0009196924714612137, 0.0010434201857088257, 0.0010982383698762014,
      0.001080760282159399, 0.0009923577004173202, 0.0008390559429591011,
      0.0006311236169856501, 0.0003823850005796666, 0.00010930108957788041,
      -0.00017011961446184858, -0.00043750851270542377, -0.0006753442321105843,
      -0.0008681005221129156, -0.0010032595377994964, -0.0010721243999557237
    }};

    EXPECT_THAT(impulse, testing::Pointwise(testing::DoubleNear(1e-05), expected));
  }
}
